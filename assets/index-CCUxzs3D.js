function ZS(e,r){for(var o=0;o<r.length;o++){const h=r[o];if(typeof h!="string"&&!Array.isArray(h)){for(const g in h)if(g!=="default"&&!(g in e)){const b=Object.getOwnPropertyDescriptor(h,g);b&&Object.defineProperty(e,g,b.get?b:{enumerable:!0,get:()=>h[g]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const g of document.querySelectorAll('link[rel="modulepreload"]'))h(g);new MutationObserver(g=>{for(const b of g)if(b.type==="childList")for(const w of b.addedNodes)w.tagName==="LINK"&&w.rel==="modulepreload"&&h(w)}).observe(document,{childList:!0,subtree:!0});function o(g){const b={};return g.integrity&&(b.integrity=g.integrity),g.referrerPolicy&&(b.referrerPolicy=g.referrerPolicy),g.crossOrigin==="use-credentials"?b.credentials="include":g.crossOrigin==="anonymous"?b.credentials="omit":b.credentials="same-origin",b}function h(g){if(g.ep)return;g.ep=!0;const b=o(g);fetch(g.href,b)}})();var Kh=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function F0(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var g2={exports:{}},B0={},_2={exports:{}},On={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Wm=Symbol.for("react.element"),WS=Symbol.for("react.portal"),GS=Symbol.for("react.fragment"),HS=Symbol.for("react.strict_mode"),XS=Symbol.for("react.profiler"),KS=Symbol.for("react.provider"),YS=Symbol.for("react.context"),JS=Symbol.for("react.forward_ref"),QS=Symbol.for("react.suspense"),e6=Symbol.for("react.memo"),t6=Symbol.for("react.lazy"),kw=Symbol.iterator;function n6(e){return e===null||typeof e!="object"?null:(e=kw&&e[kw]||e["@@iterator"],typeof e=="function"?e:null)}var y2={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},v2=Object.assign,x2={};function Wf(e,r,o){this.props=e,this.context=r,this.refs=x2,this.updater=o||y2}Wf.prototype.isReactComponent={};Wf.prototype.setState=function(e,r){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,r,"setState")};Wf.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function w2(){}w2.prototype=Wf.prototype;function mx(e,r,o){this.props=e,this.context=r,this.refs=x2,this.updater=o||y2}var gx=mx.prototype=new w2;gx.constructor=mx;v2(gx,Wf.prototype);gx.isPureReactComponent=!0;var Pw=Array.isArray,b2=Object.prototype.hasOwnProperty,_x={current:null},S2={key:!0,ref:!0,__self:!0,__source:!0};function T2(e,r,o){var h,g={},b=null,w=null;if(r!=null)for(h in r.ref!==void 0&&(w=r.ref),r.key!==void 0&&(b=""+r.key),r)b2.call(r,h)&&!S2.hasOwnProperty(h)&&(g[h]=r[h]);var c=arguments.length-2;if(c===1)g.children=o;else if(1<c){for(var D=Array(c),j=0;j<c;j++)D[j]=arguments[j+2];g.children=D}if(e&&e.defaultProps)for(h in c=e.defaultProps,c)g[h]===void 0&&(g[h]=c[h]);return{$$typeof:Wm,type:e,key:b,ref:w,props:g,_owner:_x.current}}function r6(e,r){return{$$typeof:Wm,type:e.type,key:r,ref:e.ref,props:e.props,_owner:e._owner}}function yx(e){return typeof e=="object"&&e!==null&&e.$$typeof===Wm}function i6(e){var r={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(o){return r[o]})}var Aw=/\/+/g;function b1(e,r){return typeof e=="object"&&e!==null&&e.key!=null?i6(""+e.key):r.toString(36)}function N_(e,r,o,h,g){var b=typeof e;(b==="undefined"||b==="boolean")&&(e=null);var w=!1;if(e===null)w=!0;else switch(b){case"string":case"number":w=!0;break;case"object":switch(e.$$typeof){case Wm:case WS:w=!0}}if(w)return w=e,g=g(w),e=h===""?"."+b1(w,0):h,Pw(g)?(o="",e!=null&&(o=e.replace(Aw,"$&/")+"/"),N_(g,r,o,"",function(j){return j})):g!=null&&(yx(g)&&(g=r6(g,o+(!g.key||w&&w.key===g.key?"":(""+g.key).replace(Aw,"$&/")+"/")+e)),r.push(g)),1;if(w=0,h=h===""?".":h+":",Pw(e))for(var c=0;c<e.length;c++){b=e[c];var D=h+b1(b,c);w+=N_(b,r,o,D,g)}else if(D=n6(e),typeof D=="function")for(e=D.call(e),c=0;!(b=e.next()).done;)b=b.value,D=h+b1(b,c++),w+=N_(b,r,o,D,g);else if(b==="object")throw r=String(e),Error("Objects are not valid as a React child (found: "+(r==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":r)+"). If you meant to render a collection of children, use an array instead.");return w}function __(e,r,o){if(e==null)return e;var h=[],g=0;return N_(e,h,"","",function(b){return r.call(o,b,g++)}),h}function s6(e){if(e._status===-1){var r=e._result;r=r(),r.then(function(o){(e._status===0||e._status===-1)&&(e._status=1,e._result=o)},function(o){(e._status===0||e._status===-1)&&(e._status=2,e._result=o)}),e._status===-1&&(e._status=0,e._result=r)}if(e._status===1)return e._result.default;throw e._result}var Hs={current:null},U_={transition:null},o6={ReactCurrentDispatcher:Hs,ReactCurrentBatchConfig:U_,ReactCurrentOwner:_x};function E2(){throw Error("act(...) is not supported in production builds of React.")}On.Children={map:__,forEach:function(e,r,o){__(e,function(){r.apply(this,arguments)},o)},count:function(e){var r=0;return __(e,function(){r++}),r},toArray:function(e){return __(e,function(r){return r})||[]},only:function(e){if(!yx(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};On.Component=Wf;On.Fragment=GS;On.Profiler=XS;On.PureComponent=mx;On.StrictMode=HS;On.Suspense=QS;On.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=o6;On.act=E2;On.cloneElement=function(e,r,o){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var h=v2({},e.props),g=e.key,b=e.ref,w=e._owner;if(r!=null){if(r.ref!==void 0&&(b=r.ref,w=_x.current),r.key!==void 0&&(g=""+r.key),e.type&&e.type.defaultProps)var c=e.type.defaultProps;for(D in r)b2.call(r,D)&&!S2.hasOwnProperty(D)&&(h[D]=r[D]===void 0&&c!==void 0?c[D]:r[D])}var D=arguments.length-2;if(D===1)h.children=o;else if(1<D){c=Array(D);for(var j=0;j<D;j++)c[j]=arguments[j+2];h.children=c}return{$$typeof:Wm,type:e.type,key:g,ref:b,props:h,_owner:w}};On.createContext=function(e){return e={$$typeof:YS,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:KS,_context:e},e.Consumer=e};On.createElement=T2;On.createFactory=function(e){var r=T2.bind(null,e);return r.type=e,r};On.createRef=function(){return{current:null}};On.forwardRef=function(e){return{$$typeof:JS,render:e}};On.isValidElement=yx;On.lazy=function(e){return{$$typeof:t6,_payload:{_status:-1,_result:e},_init:s6}};On.memo=function(e,r){return{$$typeof:e6,type:e,compare:r===void 0?null:r}};On.startTransition=function(e){var r=U_.transition;U_.transition={};try{e()}finally{U_.transition=r}};On.unstable_act=E2;On.useCallback=function(e,r){return Hs.current.useCallback(e,r)};On.useContext=function(e){return Hs.current.useContext(e)};On.useDebugValue=function(){};On.useDeferredValue=function(e){return Hs.current.useDeferredValue(e)};On.useEffect=function(e,r){return Hs.current.useEffect(e,r)};On.useId=function(){return Hs.current.useId()};On.useImperativeHandle=function(e,r,o){return Hs.current.useImperativeHandle(e,r,o)};On.useInsertionEffect=function(e,r){return Hs.current.useInsertionEffect(e,r)};On.useLayoutEffect=function(e,r){return Hs.current.useLayoutEffect(e,r)};On.useMemo=function(e,r){return Hs.current.useMemo(e,r)};On.useReducer=function(e,r,o){return Hs.current.useReducer(e,r,o)};On.useRef=function(e){return Hs.current.useRef(e)};On.useState=function(e){return Hs.current.useState(e)};On.useSyncExternalStore=function(e,r,o){return Hs.current.useSyncExternalStore(e,r,o)};On.useTransition=function(){return Hs.current.useTransition()};On.version="18.3.1";_2.exports=On;var Bt=_2.exports;const Ol=F0(Bt),Mw=ZS({__proto__:null,default:Ol},[Bt]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var a6=Bt,l6=Symbol.for("react.element"),u6=Symbol.for("react.fragment"),c6=Object.prototype.hasOwnProperty,h6=a6.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,d6={key:!0,ref:!0,__self:!0,__source:!0};function C2(e,r,o){var h,g={},b=null,w=null;o!==void 0&&(b=""+o),r.key!==void 0&&(b=""+r.key),r.ref!==void 0&&(w=r.ref);for(h in r)c6.call(r,h)&&!d6.hasOwnProperty(h)&&(g[h]=r[h]);if(e&&e.defaultProps)for(h in r=e.defaultProps,r)g[h]===void 0&&(g[h]=r[h]);return{$$typeof:l6,type:e,key:b,ref:w,props:g,_owner:h6.current}}B0.Fragment=u6;B0.jsx=C2;B0.jsxs=C2;g2.exports=B0;var ft=g2.exports,cv={},I2={exports:{}},Oo={},k2={exports:{}},P2={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function r(Je,nt){var Et=Je.length;Je.push(nt);e:for(;0<Et;){var ct=Et-1>>>1,It=Je[ct];if(0<g(It,nt))Je[ct]=nt,Je[Et]=It,Et=ct;else break e}}function o(Je){return Je.length===0?null:Je[0]}function h(Je){if(Je.length===0)return null;var nt=Je[0],Et=Je.pop();if(Et!==nt){Je[0]=Et;e:for(var ct=0,It=Je.length,St=It>>>1;ct<St;){var Sn=2*(ct+1)-1,cn=Je[Sn],Cn=Sn+1,Nn=Je[Cn];if(0>g(cn,Et))Cn<It&&0>g(Nn,cn)?(Je[ct]=Nn,Je[Cn]=Et,ct=Cn):(Je[ct]=cn,Je[Sn]=Et,ct=Sn);else if(Cn<It&&0>g(Nn,Et))Je[ct]=Nn,Je[Cn]=Et,ct=Cn;else break e}}return nt}function g(Je,nt){var Et=Je.sortIndex-nt.sortIndex;return Et!==0?Et:Je.id-nt.id}if(typeof performance=="object"&&typeof performance.now=="function"){var b=performance;e.unstable_now=function(){return b.now()}}else{var w=Date,c=w.now();e.unstable_now=function(){return w.now()-c}}var D=[],j=[],J=1,G=null,q=3,Ee=!1,Ae=!1,Fe=!1,Ne=typeof setTimeout=="function"?setTimeout:null,se=typeof clearTimeout=="function"?clearTimeout:null,ue=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function he(Je){for(var nt=o(j);nt!==null;){if(nt.callback===null)h(j);else if(nt.startTime<=Je)h(j),nt.sortIndex=nt.expirationTime,r(D,nt);else break;nt=o(j)}}function De(Je){if(Fe=!1,he(Je),!Ae)if(o(D)!==null)Ae=!0,Qn(Ze);else{var nt=o(j);nt!==null&&zt(De,nt.startTime-Je)}}function Ze(Je,nt){Ae=!1,Fe&&(Fe=!1,se(ee),ee=-1),Ee=!0;var Et=q;try{for(he(nt),G=o(D);G!==null&&(!(G.expirationTime>nt)||Je&&!Ue());){var ct=G.callback;if(typeof ct=="function"){G.callback=null,q=G.priorityLevel;var It=ct(G.expirationTime<=nt);nt=e.unstable_now(),typeof It=="function"?G.callback=It:G===o(D)&&h(D),he(nt)}else h(D);G=o(D)}if(G!==null)var St=!0;else{var Sn=o(j);Sn!==null&&zt(De,Sn.startTime-nt),St=!1}return St}finally{G=null,q=Et,Ee=!1}}var je=!1,ve=null,ee=-1,de=5,Te=-1;function Ue(){return!(e.unstable_now()-Te<de)}function Xe(){if(ve!==null){var Je=e.unstable_now();Te=Je;var nt=!0;try{nt=ve(!0,Je)}finally{nt?mt():(je=!1,ve=null)}}else je=!1}var mt;if(typeof ue=="function")mt=function(){ue(Xe)};else if(typeof MessageChannel<"u"){var Kt=new MessageChannel,qn=Kt.port2;Kt.port1.onmessage=Xe,mt=function(){qn.postMessage(null)}}else mt=function(){Ne(Xe,0)};function Qn(Je){ve=Je,je||(je=!0,mt())}function zt(Je,nt){ee=Ne(function(){Je(e.unstable_now())},nt)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(Je){Je.callback=null},e.unstable_continueExecution=function(){Ae||Ee||(Ae=!0,Qn(Ze))},e.unstable_forceFrameRate=function(Je){0>Je||125<Je?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):de=0<Je?Math.floor(1e3/Je):5},e.unstable_getCurrentPriorityLevel=function(){return q},e.unstable_getFirstCallbackNode=function(){return o(D)},e.unstable_next=function(Je){switch(q){case 1:case 2:case 3:var nt=3;break;default:nt=q}var Et=q;q=nt;try{return Je()}finally{q=Et}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(Je,nt){switch(Je){case 1:case 2:case 3:case 4:case 5:break;default:Je=3}var Et=q;q=Je;try{return nt()}finally{q=Et}},e.unstable_scheduleCallback=function(Je,nt,Et){var ct=e.unstable_now();switch(typeof Et=="object"&&Et!==null?(Et=Et.delay,Et=typeof Et=="number"&&0<Et?ct+Et:ct):Et=ct,Je){case 1:var It=-1;break;case 2:It=250;break;case 5:It=1073741823;break;case 4:It=1e4;break;default:It=5e3}return It=Et+It,Je={id:J++,callback:nt,priorityLevel:Je,startTime:Et,expirationTime:It,sortIndex:-1},Et>ct?(Je.sortIndex=Et,r(j,Je),o(D)===null&&Je===o(j)&&(Fe?(se(ee),ee=-1):Fe=!0,zt(De,Et-ct))):(Je.sortIndex=It,r(D,Je),Ae||Ee||(Ae=!0,Qn(Ze))),Je},e.unstable_shouldYield=Ue,e.unstable_wrapCallback=function(Je){var nt=q;return function(){var Et=q;q=nt;try{return Je.apply(this,arguments)}finally{q=Et}}}})(P2);k2.exports=P2;var f6=k2.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var p6=Bt,Do=f6;function lt(e){for(var r="https://reactjs.org/docs/error-decoder.html?invariant="+e,o=1;o<arguments.length;o++)r+="&args[]="+encodeURIComponent(arguments[o]);return"Minified React error #"+e+"; visit "+r+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var A2=new Set,Cm={};function hd(e,r){Of(e,r),Of(e+"Capture",r)}function Of(e,r){for(Cm[e]=r,e=0;e<r.length;e++)A2.add(r[e])}var zu=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),hv=Object.prototype.hasOwnProperty,m6=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,zw={},Dw={};function g6(e){return hv.call(Dw,e)?!0:hv.call(zw,e)?!1:m6.test(e)?Dw[e]=!0:(zw[e]=!0,!1)}function _6(e,r,o,h){if(o!==null&&o.type===0)return!1;switch(typeof r){case"function":case"symbol":return!0;case"boolean":return h?!1:o!==null?!o.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function y6(e,r,o,h){if(r===null||typeof r>"u"||_6(e,r,o,h))return!0;if(h)return!1;if(o!==null)switch(o.type){case 3:return!r;case 4:return r===!1;case 5:return isNaN(r);case 6:return isNaN(r)||1>r}return!1}function Xs(e,r,o,h,g,b,w){this.acceptsBooleans=r===2||r===3||r===4,this.attributeName=h,this.attributeNamespace=g,this.mustUseProperty=o,this.propertyName=e,this.type=r,this.sanitizeURL=b,this.removeEmptyString=w}var os={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){os[e]=new Xs(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var r=e[0];os[r]=new Xs(r,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){os[e]=new Xs(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){os[e]=new Xs(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){os[e]=new Xs(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){os[e]=new Xs(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){os[e]=new Xs(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){os[e]=new Xs(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){os[e]=new Xs(e,5,!1,e.toLowerCase(),null,!1,!1)});var vx=/[\-:]([a-z])/g;function xx(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var r=e.replace(vx,xx);os[r]=new Xs(r,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var r=e.replace(vx,xx);os[r]=new Xs(r,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var r=e.replace(vx,xx);os[r]=new Xs(r,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){os[e]=new Xs(e,1,!1,e.toLowerCase(),null,!1,!1)});os.xlinkHref=new Xs("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){os[e]=new Xs(e,1,!1,e.toLowerCase(),null,!0,!0)});function wx(e,r,o,h){var g=os.hasOwnProperty(r)?os[r]:null;(g!==null?g.type!==0:h||!(2<r.length)||r[0]!=="o"&&r[0]!=="O"||r[1]!=="n"&&r[1]!=="N")&&(y6(r,o,g,h)&&(o=null),h||g===null?g6(r)&&(o===null?e.removeAttribute(r):e.setAttribute(r,""+o)):g.mustUseProperty?e[g.propertyName]=o===null?g.type===3?!1:"":o:(r=g.attributeName,h=g.attributeNamespace,o===null?e.removeAttribute(r):(g=g.type,o=g===3||g===4&&o===!0?"":""+o,h?e.setAttributeNS(h,r,o):e.setAttribute(r,o))))}var Fu=p6.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,y_=Symbol.for("react.element"),_f=Symbol.for("react.portal"),yf=Symbol.for("react.fragment"),bx=Symbol.for("react.strict_mode"),dv=Symbol.for("react.profiler"),M2=Symbol.for("react.provider"),z2=Symbol.for("react.context"),Sx=Symbol.for("react.forward_ref"),fv=Symbol.for("react.suspense"),pv=Symbol.for("react.suspense_list"),Tx=Symbol.for("react.memo"),Ec=Symbol.for("react.lazy"),D2=Symbol.for("react.offscreen"),Lw=Symbol.iterator;function rm(e){return e===null||typeof e!="object"?null:(e=Lw&&e[Lw]||e["@@iterator"],typeof e=="function"?e:null)}var Wr=Object.assign,S1;function dm(e){if(S1===void 0)try{throw Error()}catch(o){var r=o.stack.trim().match(/\n( *(at )?)/);S1=r&&r[1]||""}return`
`+S1+e}var T1=!1;function E1(e,r){if(!e||T1)return"";T1=!0;var o=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(r)if(r=function(){throw Error()},Object.defineProperty(r.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(r,[])}catch(j){var h=j}Reflect.construct(e,[],r)}else{try{r.call()}catch(j){h=j}e.call(r.prototype)}else{try{throw Error()}catch(j){h=j}e()}}catch(j){if(j&&h&&typeof j.stack=="string"){for(var g=j.stack.split(`
`),b=h.stack.split(`
`),w=g.length-1,c=b.length-1;1<=w&&0<=c&&g[w]!==b[c];)c--;for(;1<=w&&0<=c;w--,c--)if(g[w]!==b[c]){if(w!==1||c!==1)do if(w--,c--,0>c||g[w]!==b[c]){var D=`
`+g[w].replace(" at new "," at ");return e.displayName&&D.includes("<anonymous>")&&(D=D.replace("<anonymous>",e.displayName)),D}while(1<=w&&0<=c);break}}}finally{T1=!1,Error.prepareStackTrace=o}return(e=e?e.displayName||e.name:"")?dm(e):""}function v6(e){switch(e.tag){case 5:return dm(e.type);case 16:return dm("Lazy");case 13:return dm("Suspense");case 19:return dm("SuspenseList");case 0:case 2:case 15:return e=E1(e.type,!1),e;case 11:return e=E1(e.type.render,!1),e;case 1:return e=E1(e.type,!0),e;default:return""}}function mv(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case yf:return"Fragment";case _f:return"Portal";case dv:return"Profiler";case bx:return"StrictMode";case fv:return"Suspense";case pv:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case z2:return(e.displayName||"Context")+".Consumer";case M2:return(e._context.displayName||"Context")+".Provider";case Sx:var r=e.render;return e=e.displayName,e||(e=r.displayName||r.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Tx:return r=e.displayName||null,r!==null?r:mv(e.type)||"Memo";case Ec:r=e._payload,e=e._init;try{return mv(e(r))}catch{}}return null}function x6(e){var r=e.type;switch(e.tag){case 24:return"Cache";case 9:return(r.displayName||"Context")+".Consumer";case 10:return(r._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=r.render,e=e.displayName||e.name||"",r.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return r;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return mv(r);case 8:return r===bx?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof r=="function")return r.displayName||r.name||null;if(typeof r=="string")return r}return null}function Nc(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function L2(e){var r=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(r==="checkbox"||r==="radio")}function w6(e){var r=L2(e)?"checked":"value",o=Object.getOwnPropertyDescriptor(e.constructor.prototype,r),h=""+e[r];if(!e.hasOwnProperty(r)&&typeof o<"u"&&typeof o.get=="function"&&typeof o.set=="function"){var g=o.get,b=o.set;return Object.defineProperty(e,r,{configurable:!0,get:function(){return g.call(this)},set:function(w){h=""+w,b.call(this,w)}}),Object.defineProperty(e,r,{enumerable:o.enumerable}),{getValue:function(){return h},setValue:function(w){h=""+w},stopTracking:function(){e._valueTracker=null,delete e[r]}}}}function v_(e){e._valueTracker||(e._valueTracker=w6(e))}function R2(e){if(!e)return!1;var r=e._valueTracker;if(!r)return!0;var o=r.getValue(),h="";return e&&(h=L2(e)?e.checked?"true":"false":e.value),e=h,e!==o?(r.setValue(e),!0):!1}function J_(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function gv(e,r){var o=r.checked;return Wr({},r,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:o??e._wrapperState.initialChecked})}function Rw(e,r){var o=r.defaultValue==null?"":r.defaultValue,h=r.checked!=null?r.checked:r.defaultChecked;o=Nc(r.value!=null?r.value:o),e._wrapperState={initialChecked:h,initialValue:o,controlled:r.type==="checkbox"||r.type==="radio"?r.checked!=null:r.value!=null}}function O2(e,r){r=r.checked,r!=null&&wx(e,"checked",r,!1)}function _v(e,r){O2(e,r);var o=Nc(r.value),h=r.type;if(o!=null)h==="number"?(o===0&&e.value===""||e.value!=o)&&(e.value=""+o):e.value!==""+o&&(e.value=""+o);else if(h==="submit"||h==="reset"){e.removeAttribute("value");return}r.hasOwnProperty("value")?yv(e,r.type,o):r.hasOwnProperty("defaultValue")&&yv(e,r.type,Nc(r.defaultValue)),r.checked==null&&r.defaultChecked!=null&&(e.defaultChecked=!!r.defaultChecked)}function Ow(e,r,o){if(r.hasOwnProperty("value")||r.hasOwnProperty("defaultValue")){var h=r.type;if(!(h!=="submit"&&h!=="reset"||r.value!==void 0&&r.value!==null))return;r=""+e._wrapperState.initialValue,o||r===e.value||(e.value=r),e.defaultValue=r}o=e.name,o!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,o!==""&&(e.name=o)}function yv(e,r,o){(r!=="number"||J_(e.ownerDocument)!==e)&&(o==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+o&&(e.defaultValue=""+o))}var fm=Array.isArray;function Pf(e,r,o,h){if(e=e.options,r){r={};for(var g=0;g<o.length;g++)r["$"+o[g]]=!0;for(o=0;o<e.length;o++)g=r.hasOwnProperty("$"+e[o].value),e[o].selected!==g&&(e[o].selected=g),g&&h&&(e[o].defaultSelected=!0)}else{for(o=""+Nc(o),r=null,g=0;g<e.length;g++){if(e[g].value===o){e[g].selected=!0,h&&(e[g].defaultSelected=!0);return}r!==null||e[g].disabled||(r=e[g])}r!==null&&(r.selected=!0)}}function vv(e,r){if(r.dangerouslySetInnerHTML!=null)throw Error(lt(91));return Wr({},r,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function Fw(e,r){var o=r.value;if(o==null){if(o=r.children,r=r.defaultValue,o!=null){if(r!=null)throw Error(lt(92));if(fm(o)){if(1<o.length)throw Error(lt(93));o=o[0]}r=o}r==null&&(r=""),o=r}e._wrapperState={initialValue:Nc(o)}}function F2(e,r){var o=Nc(r.value),h=Nc(r.defaultValue);o!=null&&(o=""+o,o!==e.value&&(e.value=o),r.defaultValue==null&&e.defaultValue!==o&&(e.defaultValue=o)),h!=null&&(e.defaultValue=""+h)}function Bw(e){var r=e.textContent;r===e._wrapperState.initialValue&&r!==""&&r!==null&&(e.value=r)}function B2(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function xv(e,r){return e==null||e==="http://www.w3.org/1999/xhtml"?B2(r):e==="http://www.w3.org/2000/svg"&&r==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var x_,N2=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(r,o,h,g){MSApp.execUnsafeLocalFunction(function(){return e(r,o,h,g)})}:e}(function(e,r){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=r;else{for(x_=x_||document.createElement("div"),x_.innerHTML="<svg>"+r.valueOf().toString()+"</svg>",r=x_.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;r.firstChild;)e.appendChild(r.firstChild)}});function Im(e,r){if(r){var o=e.firstChild;if(o&&o===e.lastChild&&o.nodeType===3){o.nodeValue=r;return}}e.textContent=r}var _m={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},b6=["Webkit","ms","Moz","O"];Object.keys(_m).forEach(function(e){b6.forEach(function(r){r=r+e.charAt(0).toUpperCase()+e.substring(1),_m[r]=_m[e]})});function U2(e,r,o){return r==null||typeof r=="boolean"||r===""?"":o||typeof r!="number"||r===0||_m.hasOwnProperty(e)&&_m[e]?(""+r).trim():r+"px"}function j2(e,r){e=e.style;for(var o in r)if(r.hasOwnProperty(o)){var h=o.indexOf("--")===0,g=U2(o,r[o],h);o==="float"&&(o="cssFloat"),h?e.setProperty(o,g):e[o]=g}}var S6=Wr({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function wv(e,r){if(r){if(S6[e]&&(r.children!=null||r.dangerouslySetInnerHTML!=null))throw Error(lt(137,e));if(r.dangerouslySetInnerHTML!=null){if(r.children!=null)throw Error(lt(60));if(typeof r.dangerouslySetInnerHTML!="object"||!("__html"in r.dangerouslySetInnerHTML))throw Error(lt(61))}if(r.style!=null&&typeof r.style!="object")throw Error(lt(62))}}function bv(e,r){if(e.indexOf("-")===-1)return typeof r.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Sv=null;function Ex(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Tv=null,Af=null,Mf=null;function Nw(e){if(e=Xm(e)){if(typeof Tv!="function")throw Error(lt(280));var r=e.stateNode;r&&(r=V0(r),Tv(e.stateNode,e.type,r))}}function $2(e){Af?Mf?Mf.push(e):Mf=[e]:Af=e}function V2(){if(Af){var e=Af,r=Mf;if(Mf=Af=null,Nw(e),r)for(e=0;e<r.length;e++)Nw(r[e])}}function q2(e,r){return e(r)}function Z2(){}var C1=!1;function W2(e,r,o){if(C1)return e(r,o);C1=!0;try{return q2(e,r,o)}finally{C1=!1,(Af!==null||Mf!==null)&&(Z2(),V2())}}function km(e,r){var o=e.stateNode;if(o===null)return null;var h=V0(o);if(h===null)return null;o=h[r];e:switch(r){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(h=!h.disabled)||(e=e.type,h=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!h;break e;default:e=!1}if(e)return null;if(o&&typeof o!="function")throw Error(lt(231,r,typeof o));return o}var Ev=!1;if(zu)try{var im={};Object.defineProperty(im,"passive",{get:function(){Ev=!0}}),window.addEventListener("test",im,im),window.removeEventListener("test",im,im)}catch{Ev=!1}function T6(e,r,o,h,g,b,w,c,D){var j=Array.prototype.slice.call(arguments,3);try{r.apply(o,j)}catch(J){this.onError(J)}}var ym=!1,Q_=null,e0=!1,Cv=null,E6={onError:function(e){ym=!0,Q_=e}};function C6(e,r,o,h,g,b,w,c,D){ym=!1,Q_=null,T6.apply(E6,arguments)}function I6(e,r,o,h,g,b,w,c,D){if(C6.apply(this,arguments),ym){if(ym){var j=Q_;ym=!1,Q_=null}else throw Error(lt(198));e0||(e0=!0,Cv=j)}}function dd(e){var r=e,o=e;if(e.alternate)for(;r.return;)r=r.return;else{e=r;do r=e,r.flags&4098&&(o=r.return),e=r.return;while(e)}return r.tag===3?o:null}function G2(e){if(e.tag===13){var r=e.memoizedState;if(r===null&&(e=e.alternate,e!==null&&(r=e.memoizedState)),r!==null)return r.dehydrated}return null}function Uw(e){if(dd(e)!==e)throw Error(lt(188))}function k6(e){var r=e.alternate;if(!r){if(r=dd(e),r===null)throw Error(lt(188));return r!==e?null:e}for(var o=e,h=r;;){var g=o.return;if(g===null)break;var b=g.alternate;if(b===null){if(h=g.return,h!==null){o=h;continue}break}if(g.child===b.child){for(b=g.child;b;){if(b===o)return Uw(g),e;if(b===h)return Uw(g),r;b=b.sibling}throw Error(lt(188))}if(o.return!==h.return)o=g,h=b;else{for(var w=!1,c=g.child;c;){if(c===o){w=!0,o=g,h=b;break}if(c===h){w=!0,h=g,o=b;break}c=c.sibling}if(!w){for(c=b.child;c;){if(c===o){w=!0,o=b,h=g;break}if(c===h){w=!0,h=b,o=g;break}c=c.sibling}if(!w)throw Error(lt(189))}}if(o.alternate!==h)throw Error(lt(190))}if(o.tag!==3)throw Error(lt(188));return o.stateNode.current===o?e:r}function H2(e){return e=k6(e),e!==null?X2(e):null}function X2(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var r=X2(e);if(r!==null)return r;e=e.sibling}return null}var K2=Do.unstable_scheduleCallback,jw=Do.unstable_cancelCallback,P6=Do.unstable_shouldYield,A6=Do.unstable_requestPaint,ui=Do.unstable_now,M6=Do.unstable_getCurrentPriorityLevel,Cx=Do.unstable_ImmediatePriority,Y2=Do.unstable_UserBlockingPriority,t0=Do.unstable_NormalPriority,z6=Do.unstable_LowPriority,J2=Do.unstable_IdlePriority,N0=null,Fl=null;function D6(e){if(Fl&&typeof Fl.onCommitFiberRoot=="function")try{Fl.onCommitFiberRoot(N0,e,void 0,(e.current.flags&128)===128)}catch{}}var Ha=Math.clz32?Math.clz32:O6,L6=Math.log,R6=Math.LN2;function O6(e){return e>>>=0,e===0?32:31-(L6(e)/R6|0)|0}var w_=64,b_=4194304;function pm(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function n0(e,r){var o=e.pendingLanes;if(o===0)return 0;var h=0,g=e.suspendedLanes,b=e.pingedLanes,w=o&268435455;if(w!==0){var c=w&~g;c!==0?h=pm(c):(b&=w,b!==0&&(h=pm(b)))}else w=o&~g,w!==0?h=pm(w):b!==0&&(h=pm(b));if(h===0)return 0;if(r!==0&&r!==h&&!(r&g)&&(g=h&-h,b=r&-r,g>=b||g===16&&(b&4194240)!==0))return r;if(h&4&&(h|=o&16),r=e.entangledLanes,r!==0)for(e=e.entanglements,r&=h;0<r;)o=31-Ha(r),g=1<<o,h|=e[o],r&=~g;return h}function F6(e,r){switch(e){case 1:case 2:case 4:return r+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return r+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function B6(e,r){for(var o=e.suspendedLanes,h=e.pingedLanes,g=e.expirationTimes,b=e.pendingLanes;0<b;){var w=31-Ha(b),c=1<<w,D=g[w];D===-1?(!(c&o)||c&h)&&(g[w]=F6(c,r)):D<=r&&(e.expiredLanes|=c),b&=~c}}function Iv(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function Q2(){var e=w_;return w_<<=1,!(w_&4194240)&&(w_=64),e}function I1(e){for(var r=[],o=0;31>o;o++)r.push(e);return r}function Gm(e,r,o){e.pendingLanes|=r,r!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,r=31-Ha(r),e[r]=o}function N6(e,r){var o=e.pendingLanes&~r;e.pendingLanes=r,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=r,e.mutableReadLanes&=r,e.entangledLanes&=r,r=e.entanglements;var h=e.eventTimes;for(e=e.expirationTimes;0<o;){var g=31-Ha(o),b=1<<g;r[g]=0,h[g]=-1,e[g]=-1,o&=~b}}function Ix(e,r){var o=e.entangledLanes|=r;for(e=e.entanglements;o;){var h=31-Ha(o),g=1<<h;g&r|e[h]&r&&(e[h]|=r),o&=~g}}var hr=0;function e3(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var t3,kx,n3,r3,i3,kv=!1,S_=[],Mc=null,zc=null,Dc=null,Pm=new Map,Am=new Map,Ic=[],U6="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function $w(e,r){switch(e){case"focusin":case"focusout":Mc=null;break;case"dragenter":case"dragleave":zc=null;break;case"mouseover":case"mouseout":Dc=null;break;case"pointerover":case"pointerout":Pm.delete(r.pointerId);break;case"gotpointercapture":case"lostpointercapture":Am.delete(r.pointerId)}}function sm(e,r,o,h,g,b){return e===null||e.nativeEvent!==b?(e={blockedOn:r,domEventName:o,eventSystemFlags:h,nativeEvent:b,targetContainers:[g]},r!==null&&(r=Xm(r),r!==null&&kx(r)),e):(e.eventSystemFlags|=h,r=e.targetContainers,g!==null&&r.indexOf(g)===-1&&r.push(g),e)}function j6(e,r,o,h,g){switch(r){case"focusin":return Mc=sm(Mc,e,r,o,h,g),!0;case"dragenter":return zc=sm(zc,e,r,o,h,g),!0;case"mouseover":return Dc=sm(Dc,e,r,o,h,g),!0;case"pointerover":var b=g.pointerId;return Pm.set(b,sm(Pm.get(b)||null,e,r,o,h,g)),!0;case"gotpointercapture":return b=g.pointerId,Am.set(b,sm(Am.get(b)||null,e,r,o,h,g)),!0}return!1}function s3(e){var r=Yh(e.target);if(r!==null){var o=dd(r);if(o!==null){if(r=o.tag,r===13){if(r=G2(o),r!==null){e.blockedOn=r,i3(e.priority,function(){n3(o)});return}}else if(r===3&&o.stateNode.current.memoizedState.isDehydrated){e.blockedOn=o.tag===3?o.stateNode.containerInfo:null;return}}}e.blockedOn=null}function j_(e){if(e.blockedOn!==null)return!1;for(var r=e.targetContainers;0<r.length;){var o=Pv(e.domEventName,e.eventSystemFlags,r[0],e.nativeEvent);if(o===null){o=e.nativeEvent;var h=new o.constructor(o.type,o);Sv=h,o.target.dispatchEvent(h),Sv=null}else return r=Xm(o),r!==null&&kx(r),e.blockedOn=o,!1;r.shift()}return!0}function Vw(e,r,o){j_(e)&&o.delete(r)}function $6(){kv=!1,Mc!==null&&j_(Mc)&&(Mc=null),zc!==null&&j_(zc)&&(zc=null),Dc!==null&&j_(Dc)&&(Dc=null),Pm.forEach(Vw),Am.forEach(Vw)}function om(e,r){e.blockedOn===r&&(e.blockedOn=null,kv||(kv=!0,Do.unstable_scheduleCallback(Do.unstable_NormalPriority,$6)))}function Mm(e){function r(g){return om(g,e)}if(0<S_.length){om(S_[0],e);for(var o=1;o<S_.length;o++){var h=S_[o];h.blockedOn===e&&(h.blockedOn=null)}}for(Mc!==null&&om(Mc,e),zc!==null&&om(zc,e),Dc!==null&&om(Dc,e),Pm.forEach(r),Am.forEach(r),o=0;o<Ic.length;o++)h=Ic[o],h.blockedOn===e&&(h.blockedOn=null);for(;0<Ic.length&&(o=Ic[0],o.blockedOn===null);)s3(o),o.blockedOn===null&&Ic.shift()}var zf=Fu.ReactCurrentBatchConfig,r0=!0;function V6(e,r,o,h){var g=hr,b=zf.transition;zf.transition=null;try{hr=1,Px(e,r,o,h)}finally{hr=g,zf.transition=b}}function q6(e,r,o,h){var g=hr,b=zf.transition;zf.transition=null;try{hr=4,Px(e,r,o,h)}finally{hr=g,zf.transition=b}}function Px(e,r,o,h){if(r0){var g=Pv(e,r,o,h);if(g===null)F1(e,r,h,i0,o),$w(e,h);else if(j6(g,e,r,o,h))h.stopPropagation();else if($w(e,h),r&4&&-1<U6.indexOf(e)){for(;g!==null;){var b=Xm(g);if(b!==null&&t3(b),b=Pv(e,r,o,h),b===null&&F1(e,r,h,i0,o),b===g)break;g=b}g!==null&&h.stopPropagation()}else F1(e,r,h,null,o)}}var i0=null;function Pv(e,r,o,h){if(i0=null,e=Ex(h),e=Yh(e),e!==null)if(r=dd(e),r===null)e=null;else if(o=r.tag,o===13){if(e=G2(r),e!==null)return e;e=null}else if(o===3){if(r.stateNode.current.memoizedState.isDehydrated)return r.tag===3?r.stateNode.containerInfo:null;e=null}else r!==e&&(e=null);return i0=e,null}function o3(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(M6()){case Cx:return 1;case Y2:return 4;case t0:case z6:return 16;case J2:return 536870912;default:return 16}default:return 16}}var Pc=null,Ax=null,$_=null;function a3(){if($_)return $_;var e,r=Ax,o=r.length,h,g="value"in Pc?Pc.value:Pc.textContent,b=g.length;for(e=0;e<o&&r[e]===g[e];e++);var w=o-e;for(h=1;h<=w&&r[o-h]===g[b-h];h++);return $_=g.slice(e,1<h?1-h:void 0)}function V_(e){var r=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&r===13&&(e=13)):e=r,e===10&&(e=13),32<=e||e===13?e:0}function T_(){return!0}function qw(){return!1}function Fo(e){function r(o,h,g,b,w){this._reactName=o,this._targetInst=g,this.type=h,this.nativeEvent=b,this.target=w,this.currentTarget=null;for(var c in e)e.hasOwnProperty(c)&&(o=e[c],this[c]=o?o(b):b[c]);return this.isDefaultPrevented=(b.defaultPrevented!=null?b.defaultPrevented:b.returnValue===!1)?T_:qw,this.isPropagationStopped=qw,this}return Wr(r.prototype,{preventDefault:function(){this.defaultPrevented=!0;var o=this.nativeEvent;o&&(o.preventDefault?o.preventDefault():typeof o.returnValue!="unknown"&&(o.returnValue=!1),this.isDefaultPrevented=T_)},stopPropagation:function(){var o=this.nativeEvent;o&&(o.stopPropagation?o.stopPropagation():typeof o.cancelBubble!="unknown"&&(o.cancelBubble=!0),this.isPropagationStopped=T_)},persist:function(){},isPersistent:T_}),r}var Gf={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Mx=Fo(Gf),Hm=Wr({},Gf,{view:0,detail:0}),Z6=Fo(Hm),k1,P1,am,U0=Wr({},Hm,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:zx,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==am&&(am&&e.type==="mousemove"?(k1=e.screenX-am.screenX,P1=e.screenY-am.screenY):P1=k1=0,am=e),k1)},movementY:function(e){return"movementY"in e?e.movementY:P1}}),Zw=Fo(U0),W6=Wr({},U0,{dataTransfer:0}),G6=Fo(W6),H6=Wr({},Hm,{relatedTarget:0}),A1=Fo(H6),X6=Wr({},Gf,{animationName:0,elapsedTime:0,pseudoElement:0}),K6=Fo(X6),Y6=Wr({},Gf,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),J6=Fo(Y6),Q6=Wr({},Gf,{data:0}),Ww=Fo(Q6),eT={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},tT={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},nT={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function rT(e){var r=this.nativeEvent;return r.getModifierState?r.getModifierState(e):(e=nT[e])?!!r[e]:!1}function zx(){return rT}var iT=Wr({},Hm,{key:function(e){if(e.key){var r=eT[e.key]||e.key;if(r!=="Unidentified")return r}return e.type==="keypress"?(e=V_(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?tT[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:zx,charCode:function(e){return e.type==="keypress"?V_(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?V_(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),sT=Fo(iT),oT=Wr({},U0,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Gw=Fo(oT),aT=Wr({},Hm,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:zx}),lT=Fo(aT),uT=Wr({},Gf,{propertyName:0,elapsedTime:0,pseudoElement:0}),cT=Fo(uT),hT=Wr({},U0,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),dT=Fo(hT),fT=[9,13,27,32],Dx=zu&&"CompositionEvent"in window,vm=null;zu&&"documentMode"in document&&(vm=document.documentMode);var pT=zu&&"TextEvent"in window&&!vm,l3=zu&&(!Dx||vm&&8<vm&&11>=vm),Hw=" ",Xw=!1;function u3(e,r){switch(e){case"keyup":return fT.indexOf(r.keyCode)!==-1;case"keydown":return r.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function c3(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var vf=!1;function mT(e,r){switch(e){case"compositionend":return c3(r);case"keypress":return r.which!==32?null:(Xw=!0,Hw);case"textInput":return e=r.data,e===Hw&&Xw?null:e;default:return null}}function gT(e,r){if(vf)return e==="compositionend"||!Dx&&u3(e,r)?(e=a3(),$_=Ax=Pc=null,vf=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(r.ctrlKey||r.altKey||r.metaKey)||r.ctrlKey&&r.altKey){if(r.char&&1<r.char.length)return r.char;if(r.which)return String.fromCharCode(r.which)}return null;case"compositionend":return l3&&r.locale!=="ko"?null:r.data;default:return null}}var _T={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Kw(e){var r=e&&e.nodeName&&e.nodeName.toLowerCase();return r==="input"?!!_T[e.type]:r==="textarea"}function h3(e,r,o,h){$2(h),r=s0(r,"onChange"),0<r.length&&(o=new Mx("onChange","change",null,o,h),e.push({event:o,listeners:r}))}var xm=null,zm=null;function yT(e){b3(e,0)}function j0(e){var r=bf(e);if(R2(r))return e}function vT(e,r){if(e==="change")return r}var d3=!1;if(zu){var M1;if(zu){var z1="oninput"in document;if(!z1){var Yw=document.createElement("div");Yw.setAttribute("oninput","return;"),z1=typeof Yw.oninput=="function"}M1=z1}else M1=!1;d3=M1&&(!document.documentMode||9<document.documentMode)}function Jw(){xm&&(xm.detachEvent("onpropertychange",f3),zm=xm=null)}function f3(e){if(e.propertyName==="value"&&j0(zm)){var r=[];h3(r,zm,e,Ex(e)),W2(yT,r)}}function xT(e,r,o){e==="focusin"?(Jw(),xm=r,zm=o,xm.attachEvent("onpropertychange",f3)):e==="focusout"&&Jw()}function wT(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return j0(zm)}function bT(e,r){if(e==="click")return j0(r)}function ST(e,r){if(e==="input"||e==="change")return j0(r)}function TT(e,r){return e===r&&(e!==0||1/e===1/r)||e!==e&&r!==r}var Ya=typeof Object.is=="function"?Object.is:TT;function Dm(e,r){if(Ya(e,r))return!0;if(typeof e!="object"||e===null||typeof r!="object"||r===null)return!1;var o=Object.keys(e),h=Object.keys(r);if(o.length!==h.length)return!1;for(h=0;h<o.length;h++){var g=o[h];if(!hv.call(r,g)||!Ya(e[g],r[g]))return!1}return!0}function Qw(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function eb(e,r){var o=Qw(e);e=0;for(var h;o;){if(o.nodeType===3){if(h=e+o.textContent.length,e<=r&&h>=r)return{node:o,offset:r-e};e=h}e:{for(;o;){if(o.nextSibling){o=o.nextSibling;break e}o=o.parentNode}o=void 0}o=Qw(o)}}function p3(e,r){return e&&r?e===r?!0:e&&e.nodeType===3?!1:r&&r.nodeType===3?p3(e,r.parentNode):"contains"in e?e.contains(r):e.compareDocumentPosition?!!(e.compareDocumentPosition(r)&16):!1:!1}function m3(){for(var e=window,r=J_();r instanceof e.HTMLIFrameElement;){try{var o=typeof r.contentWindow.location.href=="string"}catch{o=!1}if(o)e=r.contentWindow;else break;r=J_(e.document)}return r}function Lx(e){var r=e&&e.nodeName&&e.nodeName.toLowerCase();return r&&(r==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||r==="textarea"||e.contentEditable==="true")}function ET(e){var r=m3(),o=e.focusedElem,h=e.selectionRange;if(r!==o&&o&&o.ownerDocument&&p3(o.ownerDocument.documentElement,o)){if(h!==null&&Lx(o)){if(r=h.start,e=h.end,e===void 0&&(e=r),"selectionStart"in o)o.selectionStart=r,o.selectionEnd=Math.min(e,o.value.length);else if(e=(r=o.ownerDocument||document)&&r.defaultView||window,e.getSelection){e=e.getSelection();var g=o.textContent.length,b=Math.min(h.start,g);h=h.end===void 0?b:Math.min(h.end,g),!e.extend&&b>h&&(g=h,h=b,b=g),g=eb(o,b);var w=eb(o,h);g&&w&&(e.rangeCount!==1||e.anchorNode!==g.node||e.anchorOffset!==g.offset||e.focusNode!==w.node||e.focusOffset!==w.offset)&&(r=r.createRange(),r.setStart(g.node,g.offset),e.removeAllRanges(),b>h?(e.addRange(r),e.extend(w.node,w.offset)):(r.setEnd(w.node,w.offset),e.addRange(r)))}}for(r=[],e=o;e=e.parentNode;)e.nodeType===1&&r.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof o.focus=="function"&&o.focus(),o=0;o<r.length;o++)e=r[o],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var CT=zu&&"documentMode"in document&&11>=document.documentMode,xf=null,Av=null,wm=null,Mv=!1;function tb(e,r,o){var h=o.window===o?o.document:o.nodeType===9?o:o.ownerDocument;Mv||xf==null||xf!==J_(h)||(h=xf,"selectionStart"in h&&Lx(h)?h={start:h.selectionStart,end:h.selectionEnd}:(h=(h.ownerDocument&&h.ownerDocument.defaultView||window).getSelection(),h={anchorNode:h.anchorNode,anchorOffset:h.anchorOffset,focusNode:h.focusNode,focusOffset:h.focusOffset}),wm&&Dm(wm,h)||(wm=h,h=s0(Av,"onSelect"),0<h.length&&(r=new Mx("onSelect","select",null,r,o),e.push({event:r,listeners:h}),r.target=xf)))}function E_(e,r){var o={};return o[e.toLowerCase()]=r.toLowerCase(),o["Webkit"+e]="webkit"+r,o["Moz"+e]="moz"+r,o}var wf={animationend:E_("Animation","AnimationEnd"),animationiteration:E_("Animation","AnimationIteration"),animationstart:E_("Animation","AnimationStart"),transitionend:E_("Transition","TransitionEnd")},D1={},g3={};zu&&(g3=document.createElement("div").style,"AnimationEvent"in window||(delete wf.animationend.animation,delete wf.animationiteration.animation,delete wf.animationstart.animation),"TransitionEvent"in window||delete wf.transitionend.transition);function $0(e){if(D1[e])return D1[e];if(!wf[e])return e;var r=wf[e],o;for(o in r)if(r.hasOwnProperty(o)&&o in g3)return D1[e]=r[o];return e}var _3=$0("animationend"),y3=$0("animationiteration"),v3=$0("animationstart"),x3=$0("transitionend"),w3=new Map,nb="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function $c(e,r){w3.set(e,r),hd(r,[e])}for(var L1=0;L1<nb.length;L1++){var R1=nb[L1],IT=R1.toLowerCase(),kT=R1[0].toUpperCase()+R1.slice(1);$c(IT,"on"+kT)}$c(_3,"onAnimationEnd");$c(y3,"onAnimationIteration");$c(v3,"onAnimationStart");$c("dblclick","onDoubleClick");$c("focusin","onFocus");$c("focusout","onBlur");$c(x3,"onTransitionEnd");Of("onMouseEnter",["mouseout","mouseover"]);Of("onMouseLeave",["mouseout","mouseover"]);Of("onPointerEnter",["pointerout","pointerover"]);Of("onPointerLeave",["pointerout","pointerover"]);hd("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));hd("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));hd("onBeforeInput",["compositionend","keypress","textInput","paste"]);hd("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));hd("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));hd("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var mm="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),PT=new Set("cancel close invalid load scroll toggle".split(" ").concat(mm));function rb(e,r,o){var h=e.type||"unknown-event";e.currentTarget=o,I6(h,r,void 0,e),e.currentTarget=null}function b3(e,r){r=(r&4)!==0;for(var o=0;o<e.length;o++){var h=e[o],g=h.event;h=h.listeners;e:{var b=void 0;if(r)for(var w=h.length-1;0<=w;w--){var c=h[w],D=c.instance,j=c.currentTarget;if(c=c.listener,D!==b&&g.isPropagationStopped())break e;rb(g,c,j),b=D}else for(w=0;w<h.length;w++){if(c=h[w],D=c.instance,j=c.currentTarget,c=c.listener,D!==b&&g.isPropagationStopped())break e;rb(g,c,j),b=D}}}if(e0)throw e=Cv,e0=!1,Cv=null,e}function Dr(e,r){var o=r[Ov];o===void 0&&(o=r[Ov]=new Set);var h=e+"__bubble";o.has(h)||(S3(r,e,2,!1),o.add(h))}function O1(e,r,o){var h=0;r&&(h|=4),S3(o,e,h,r)}var C_="_reactListening"+Math.random().toString(36).slice(2);function Lm(e){if(!e[C_]){e[C_]=!0,A2.forEach(function(o){o!=="selectionchange"&&(PT.has(o)||O1(o,!1,e),O1(o,!0,e))});var r=e.nodeType===9?e:e.ownerDocument;r===null||r[C_]||(r[C_]=!0,O1("selectionchange",!1,r))}}function S3(e,r,o,h){switch(o3(r)){case 1:var g=V6;break;case 4:g=q6;break;default:g=Px}o=g.bind(null,r,o,e),g=void 0,!Ev||r!=="touchstart"&&r!=="touchmove"&&r!=="wheel"||(g=!0),h?g!==void 0?e.addEventListener(r,o,{capture:!0,passive:g}):e.addEventListener(r,o,!0):g!==void 0?e.addEventListener(r,o,{passive:g}):e.addEventListener(r,o,!1)}function F1(e,r,o,h,g){var b=h;if(!(r&1)&&!(r&2)&&h!==null)e:for(;;){if(h===null)return;var w=h.tag;if(w===3||w===4){var c=h.stateNode.containerInfo;if(c===g||c.nodeType===8&&c.parentNode===g)break;if(w===4)for(w=h.return;w!==null;){var D=w.tag;if((D===3||D===4)&&(D=w.stateNode.containerInfo,D===g||D.nodeType===8&&D.parentNode===g))return;w=w.return}for(;c!==null;){if(w=Yh(c),w===null)return;if(D=w.tag,D===5||D===6){h=b=w;continue e}c=c.parentNode}}h=h.return}W2(function(){var j=b,J=Ex(o),G=[];e:{var q=w3.get(e);if(q!==void 0){var Ee=Mx,Ae=e;switch(e){case"keypress":if(V_(o)===0)break e;case"keydown":case"keyup":Ee=sT;break;case"focusin":Ae="focus",Ee=A1;break;case"focusout":Ae="blur",Ee=A1;break;case"beforeblur":case"afterblur":Ee=A1;break;case"click":if(o.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Ee=Zw;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Ee=G6;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Ee=lT;break;case _3:case y3:case v3:Ee=K6;break;case x3:Ee=cT;break;case"scroll":Ee=Z6;break;case"wheel":Ee=dT;break;case"copy":case"cut":case"paste":Ee=J6;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Ee=Gw}var Fe=(r&4)!==0,Ne=!Fe&&e==="scroll",se=Fe?q!==null?q+"Capture":null:q;Fe=[];for(var ue=j,he;ue!==null;){he=ue;var De=he.stateNode;if(he.tag===5&&De!==null&&(he=De,se!==null&&(De=km(ue,se),De!=null&&Fe.push(Rm(ue,De,he)))),Ne)break;ue=ue.return}0<Fe.length&&(q=new Ee(q,Ae,null,o,J),G.push({event:q,listeners:Fe}))}}if(!(r&7)){e:{if(q=e==="mouseover"||e==="pointerover",Ee=e==="mouseout"||e==="pointerout",q&&o!==Sv&&(Ae=o.relatedTarget||o.fromElement)&&(Yh(Ae)||Ae[Du]))break e;if((Ee||q)&&(q=J.window===J?J:(q=J.ownerDocument)?q.defaultView||q.parentWindow:window,Ee?(Ae=o.relatedTarget||o.toElement,Ee=j,Ae=Ae?Yh(Ae):null,Ae!==null&&(Ne=dd(Ae),Ae!==Ne||Ae.tag!==5&&Ae.tag!==6)&&(Ae=null)):(Ee=null,Ae=j),Ee!==Ae)){if(Fe=Zw,De="onMouseLeave",se="onMouseEnter",ue="mouse",(e==="pointerout"||e==="pointerover")&&(Fe=Gw,De="onPointerLeave",se="onPointerEnter",ue="pointer"),Ne=Ee==null?q:bf(Ee),he=Ae==null?q:bf(Ae),q=new Fe(De,ue+"leave",Ee,o,J),q.target=Ne,q.relatedTarget=he,De=null,Yh(J)===j&&(Fe=new Fe(se,ue+"enter",Ae,o,J),Fe.target=he,Fe.relatedTarget=Ne,De=Fe),Ne=De,Ee&&Ae)t:{for(Fe=Ee,se=Ae,ue=0,he=Fe;he;he=ff(he))ue++;for(he=0,De=se;De;De=ff(De))he++;for(;0<ue-he;)Fe=ff(Fe),ue--;for(;0<he-ue;)se=ff(se),he--;for(;ue--;){if(Fe===se||se!==null&&Fe===se.alternate)break t;Fe=ff(Fe),se=ff(se)}Fe=null}else Fe=null;Ee!==null&&ib(G,q,Ee,Fe,!1),Ae!==null&&Ne!==null&&ib(G,Ne,Ae,Fe,!0)}}e:{if(q=j?bf(j):window,Ee=q.nodeName&&q.nodeName.toLowerCase(),Ee==="select"||Ee==="input"&&q.type==="file")var Ze=vT;else if(Kw(q))if(d3)Ze=ST;else{Ze=wT;var je=xT}else(Ee=q.nodeName)&&Ee.toLowerCase()==="input"&&(q.type==="checkbox"||q.type==="radio")&&(Ze=bT);if(Ze&&(Ze=Ze(e,j))){h3(G,Ze,o,J);break e}je&&je(e,q,j),e==="focusout"&&(je=q._wrapperState)&&je.controlled&&q.type==="number"&&yv(q,"number",q.value)}switch(je=j?bf(j):window,e){case"focusin":(Kw(je)||je.contentEditable==="true")&&(xf=je,Av=j,wm=null);break;case"focusout":wm=Av=xf=null;break;case"mousedown":Mv=!0;break;case"contextmenu":case"mouseup":case"dragend":Mv=!1,tb(G,o,J);break;case"selectionchange":if(CT)break;case"keydown":case"keyup":tb(G,o,J)}var ve;if(Dx)e:{switch(e){case"compositionstart":var ee="onCompositionStart";break e;case"compositionend":ee="onCompositionEnd";break e;case"compositionupdate":ee="onCompositionUpdate";break e}ee=void 0}else vf?u3(e,o)&&(ee="onCompositionEnd"):e==="keydown"&&o.keyCode===229&&(ee="onCompositionStart");ee&&(l3&&o.locale!=="ko"&&(vf||ee!=="onCompositionStart"?ee==="onCompositionEnd"&&vf&&(ve=a3()):(Pc=J,Ax="value"in Pc?Pc.value:Pc.textContent,vf=!0)),je=s0(j,ee),0<je.length&&(ee=new Ww(ee,e,null,o,J),G.push({event:ee,listeners:je}),ve?ee.data=ve:(ve=c3(o),ve!==null&&(ee.data=ve)))),(ve=pT?mT(e,o):gT(e,o))&&(j=s0(j,"onBeforeInput"),0<j.length&&(J=new Ww("onBeforeInput","beforeinput",null,o,J),G.push({event:J,listeners:j}),J.data=ve))}b3(G,r)})}function Rm(e,r,o){return{instance:e,listener:r,currentTarget:o}}function s0(e,r){for(var o=r+"Capture",h=[];e!==null;){var g=e,b=g.stateNode;g.tag===5&&b!==null&&(g=b,b=km(e,o),b!=null&&h.unshift(Rm(e,b,g)),b=km(e,r),b!=null&&h.push(Rm(e,b,g))),e=e.return}return h}function ff(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function ib(e,r,o,h,g){for(var b=r._reactName,w=[];o!==null&&o!==h;){var c=o,D=c.alternate,j=c.stateNode;if(D!==null&&D===h)break;c.tag===5&&j!==null&&(c=j,g?(D=km(o,b),D!=null&&w.unshift(Rm(o,D,c))):g||(D=km(o,b),D!=null&&w.push(Rm(o,D,c)))),o=o.return}w.length!==0&&e.push({event:r,listeners:w})}var AT=/\r\n?/g,MT=/\u0000|\uFFFD/g;function sb(e){return(typeof e=="string"?e:""+e).replace(AT,`
`).replace(MT,"")}function I_(e,r,o){if(r=sb(r),sb(e)!==r&&o)throw Error(lt(425))}function o0(){}var zv=null,Dv=null;function Lv(e,r){return e==="textarea"||e==="noscript"||typeof r.children=="string"||typeof r.children=="number"||typeof r.dangerouslySetInnerHTML=="object"&&r.dangerouslySetInnerHTML!==null&&r.dangerouslySetInnerHTML.__html!=null}var Rv=typeof setTimeout=="function"?setTimeout:void 0,zT=typeof clearTimeout=="function"?clearTimeout:void 0,ob=typeof Promise=="function"?Promise:void 0,DT=typeof queueMicrotask=="function"?queueMicrotask:typeof ob<"u"?function(e){return ob.resolve(null).then(e).catch(LT)}:Rv;function LT(e){setTimeout(function(){throw e})}function B1(e,r){var o=r,h=0;do{var g=o.nextSibling;if(e.removeChild(o),g&&g.nodeType===8)if(o=g.data,o==="/$"){if(h===0){e.removeChild(g),Mm(r);return}h--}else o!=="$"&&o!=="$?"&&o!=="$!"||h++;o=g}while(o);Mm(r)}function Lc(e){for(;e!=null;e=e.nextSibling){var r=e.nodeType;if(r===1||r===3)break;if(r===8){if(r=e.data,r==="$"||r==="$!"||r==="$?")break;if(r==="/$")return null}}return e}function ab(e){e=e.previousSibling;for(var r=0;e;){if(e.nodeType===8){var o=e.data;if(o==="$"||o==="$!"||o==="$?"){if(r===0)return e;r--}else o==="/$"&&r++}e=e.previousSibling}return null}var Hf=Math.random().toString(36).slice(2),Rl="__reactFiber$"+Hf,Om="__reactProps$"+Hf,Du="__reactContainer$"+Hf,Ov="__reactEvents$"+Hf,RT="__reactListeners$"+Hf,OT="__reactHandles$"+Hf;function Yh(e){var r=e[Rl];if(r)return r;for(var o=e.parentNode;o;){if(r=o[Du]||o[Rl]){if(o=r.alternate,r.child!==null||o!==null&&o.child!==null)for(e=ab(e);e!==null;){if(o=e[Rl])return o;e=ab(e)}return r}e=o,o=e.parentNode}return null}function Xm(e){return e=e[Rl]||e[Du],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function bf(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(lt(33))}function V0(e){return e[Om]||null}var Fv=[],Sf=-1;function Vc(e){return{current:e}}function Lr(e){0>Sf||(e.current=Fv[Sf],Fv[Sf]=null,Sf--)}function kr(e,r){Sf++,Fv[Sf]=e.current,e.current=r}var Uc={},zs=Vc(Uc),oo=Vc(!1),rd=Uc;function Ff(e,r){var o=e.type.contextTypes;if(!o)return Uc;var h=e.stateNode;if(h&&h.__reactInternalMemoizedUnmaskedChildContext===r)return h.__reactInternalMemoizedMaskedChildContext;var g={},b;for(b in o)g[b]=r[b];return h&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=r,e.__reactInternalMemoizedMaskedChildContext=g),g}function ao(e){return e=e.childContextTypes,e!=null}function a0(){Lr(oo),Lr(zs)}function lb(e,r,o){if(zs.current!==Uc)throw Error(lt(168));kr(zs,r),kr(oo,o)}function T3(e,r,o){var h=e.stateNode;if(r=r.childContextTypes,typeof h.getChildContext!="function")return o;h=h.getChildContext();for(var g in h)if(!(g in r))throw Error(lt(108,x6(e)||"Unknown",g));return Wr({},o,h)}function l0(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Uc,rd=zs.current,kr(zs,e),kr(oo,oo.current),!0}function ub(e,r,o){var h=e.stateNode;if(!h)throw Error(lt(169));o?(e=T3(e,r,rd),h.__reactInternalMemoizedMergedChildContext=e,Lr(oo),Lr(zs),kr(zs,e)):Lr(oo),kr(oo,o)}var Eu=null,q0=!1,N1=!1;function E3(e){Eu===null?Eu=[e]:Eu.push(e)}function FT(e){q0=!0,E3(e)}function qc(){if(!N1&&Eu!==null){N1=!0;var e=0,r=hr;try{var o=Eu;for(hr=1;e<o.length;e++){var h=o[e];do h=h(!0);while(h!==null)}Eu=null,q0=!1}catch(g){throw Eu!==null&&(Eu=Eu.slice(e+1)),K2(Cx,qc),g}finally{hr=r,N1=!1}}return null}var Tf=[],Ef=0,u0=null,c0=0,sa=[],oa=0,id=null,Iu=1,ku="";function Gh(e,r){Tf[Ef++]=c0,Tf[Ef++]=u0,u0=e,c0=r}function C3(e,r,o){sa[oa++]=Iu,sa[oa++]=ku,sa[oa++]=id,id=e;var h=Iu;e=ku;var g=32-Ha(h)-1;h&=~(1<<g),o+=1;var b=32-Ha(r)+g;if(30<b){var w=g-g%5;b=(h&(1<<w)-1).toString(32),h>>=w,g-=w,Iu=1<<32-Ha(r)+g|o<<g|h,ku=b+e}else Iu=1<<b|o<<g|h,ku=e}function Rx(e){e.return!==null&&(Gh(e,1),C3(e,1,0))}function Ox(e){for(;e===u0;)u0=Tf[--Ef],Tf[Ef]=null,c0=Tf[--Ef],Tf[Ef]=null;for(;e===id;)id=sa[--oa],sa[oa]=null,ku=sa[--oa],sa[oa]=null,Iu=sa[--oa],sa[oa]=null}var zo=null,Ao=null,Ur=!1,Wa=null;function I3(e,r){var o=aa(5,null,null,0);o.elementType="DELETED",o.stateNode=r,o.return=e,r=e.deletions,r===null?(e.deletions=[o],e.flags|=16):r.push(o)}function cb(e,r){switch(e.tag){case 5:var o=e.type;return r=r.nodeType!==1||o.toLowerCase()!==r.nodeName.toLowerCase()?null:r,r!==null?(e.stateNode=r,zo=e,Ao=Lc(r.firstChild),!0):!1;case 6:return r=e.pendingProps===""||r.nodeType!==3?null:r,r!==null?(e.stateNode=r,zo=e,Ao=null,!0):!1;case 13:return r=r.nodeType!==8?null:r,r!==null?(o=id!==null?{id:Iu,overflow:ku}:null,e.memoizedState={dehydrated:r,treeContext:o,retryLane:1073741824},o=aa(18,null,null,0),o.stateNode=r,o.return=e,e.child=o,zo=e,Ao=null,!0):!1;default:return!1}}function Bv(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Nv(e){if(Ur){var r=Ao;if(r){var o=r;if(!cb(e,r)){if(Bv(e))throw Error(lt(418));r=Lc(o.nextSibling);var h=zo;r&&cb(e,r)?I3(h,o):(e.flags=e.flags&-4097|2,Ur=!1,zo=e)}}else{if(Bv(e))throw Error(lt(418));e.flags=e.flags&-4097|2,Ur=!1,zo=e}}}function hb(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;zo=e}function k_(e){if(e!==zo)return!1;if(!Ur)return hb(e),Ur=!0,!1;var r;if((r=e.tag!==3)&&!(r=e.tag!==5)&&(r=e.type,r=r!=="head"&&r!=="body"&&!Lv(e.type,e.memoizedProps)),r&&(r=Ao)){if(Bv(e))throw k3(),Error(lt(418));for(;r;)I3(e,r),r=Lc(r.nextSibling)}if(hb(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(lt(317));e:{for(e=e.nextSibling,r=0;e;){if(e.nodeType===8){var o=e.data;if(o==="/$"){if(r===0){Ao=Lc(e.nextSibling);break e}r--}else o!=="$"&&o!=="$!"&&o!=="$?"||r++}e=e.nextSibling}Ao=null}}else Ao=zo?Lc(e.stateNode.nextSibling):null;return!0}function k3(){for(var e=Ao;e;)e=Lc(e.nextSibling)}function Bf(){Ao=zo=null,Ur=!1}function Fx(e){Wa===null?Wa=[e]:Wa.push(e)}var BT=Fu.ReactCurrentBatchConfig;function lm(e,r,o){if(e=o.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(o._owner){if(o=o._owner,o){if(o.tag!==1)throw Error(lt(309));var h=o.stateNode}if(!h)throw Error(lt(147,e));var g=h,b=""+e;return r!==null&&r.ref!==null&&typeof r.ref=="function"&&r.ref._stringRef===b?r.ref:(r=function(w){var c=g.refs;w===null?delete c[b]:c[b]=w},r._stringRef=b,r)}if(typeof e!="string")throw Error(lt(284));if(!o._owner)throw Error(lt(290,e))}return e}function P_(e,r){throw e=Object.prototype.toString.call(r),Error(lt(31,e==="[object Object]"?"object with keys {"+Object.keys(r).join(", ")+"}":e))}function db(e){var r=e._init;return r(e._payload)}function P3(e){function r(se,ue){if(e){var he=se.deletions;he===null?(se.deletions=[ue],se.flags|=16):he.push(ue)}}function o(se,ue){if(!e)return null;for(;ue!==null;)r(se,ue),ue=ue.sibling;return null}function h(se,ue){for(se=new Map;ue!==null;)ue.key!==null?se.set(ue.key,ue):se.set(ue.index,ue),ue=ue.sibling;return se}function g(se,ue){return se=Bc(se,ue),se.index=0,se.sibling=null,se}function b(se,ue,he){return se.index=he,e?(he=se.alternate,he!==null?(he=he.index,he<ue?(se.flags|=2,ue):he):(se.flags|=2,ue)):(se.flags|=1048576,ue)}function w(se){return e&&se.alternate===null&&(se.flags|=2),se}function c(se,ue,he,De){return ue===null||ue.tag!==6?(ue=W1(he,se.mode,De),ue.return=se,ue):(ue=g(ue,he),ue.return=se,ue)}function D(se,ue,he,De){var Ze=he.type;return Ze===yf?J(se,ue,he.props.children,De,he.key):ue!==null&&(ue.elementType===Ze||typeof Ze=="object"&&Ze!==null&&Ze.$$typeof===Ec&&db(Ze)===ue.type)?(De=g(ue,he.props),De.ref=lm(se,ue,he),De.return=se,De):(De=K_(he.type,he.key,he.props,null,se.mode,De),De.ref=lm(se,ue,he),De.return=se,De)}function j(se,ue,he,De){return ue===null||ue.tag!==4||ue.stateNode.containerInfo!==he.containerInfo||ue.stateNode.implementation!==he.implementation?(ue=G1(he,se.mode,De),ue.return=se,ue):(ue=g(ue,he.children||[]),ue.return=se,ue)}function J(se,ue,he,De,Ze){return ue===null||ue.tag!==7?(ue=td(he,se.mode,De,Ze),ue.return=se,ue):(ue=g(ue,he),ue.return=se,ue)}function G(se,ue,he){if(typeof ue=="string"&&ue!==""||typeof ue=="number")return ue=W1(""+ue,se.mode,he),ue.return=se,ue;if(typeof ue=="object"&&ue!==null){switch(ue.$$typeof){case y_:return he=K_(ue.type,ue.key,ue.props,null,se.mode,he),he.ref=lm(se,null,ue),he.return=se,he;case _f:return ue=G1(ue,se.mode,he),ue.return=se,ue;case Ec:var De=ue._init;return G(se,De(ue._payload),he)}if(fm(ue)||rm(ue))return ue=td(ue,se.mode,he,null),ue.return=se,ue;P_(se,ue)}return null}function q(se,ue,he,De){var Ze=ue!==null?ue.key:null;if(typeof he=="string"&&he!==""||typeof he=="number")return Ze!==null?null:c(se,ue,""+he,De);if(typeof he=="object"&&he!==null){switch(he.$$typeof){case y_:return he.key===Ze?D(se,ue,he,De):null;case _f:return he.key===Ze?j(se,ue,he,De):null;case Ec:return Ze=he._init,q(se,ue,Ze(he._payload),De)}if(fm(he)||rm(he))return Ze!==null?null:J(se,ue,he,De,null);P_(se,he)}return null}function Ee(se,ue,he,De,Ze){if(typeof De=="string"&&De!==""||typeof De=="number")return se=se.get(he)||null,c(ue,se,""+De,Ze);if(typeof De=="object"&&De!==null){switch(De.$$typeof){case y_:return se=se.get(De.key===null?he:De.key)||null,D(ue,se,De,Ze);case _f:return se=se.get(De.key===null?he:De.key)||null,j(ue,se,De,Ze);case Ec:var je=De._init;return Ee(se,ue,he,je(De._payload),Ze)}if(fm(De)||rm(De))return se=se.get(he)||null,J(ue,se,De,Ze,null);P_(ue,De)}return null}function Ae(se,ue,he,De){for(var Ze=null,je=null,ve=ue,ee=ue=0,de=null;ve!==null&&ee<he.length;ee++){ve.index>ee?(de=ve,ve=null):de=ve.sibling;var Te=q(se,ve,he[ee],De);if(Te===null){ve===null&&(ve=de);break}e&&ve&&Te.alternate===null&&r(se,ve),ue=b(Te,ue,ee),je===null?Ze=Te:je.sibling=Te,je=Te,ve=de}if(ee===he.length)return o(se,ve),Ur&&Gh(se,ee),Ze;if(ve===null){for(;ee<he.length;ee++)ve=G(se,he[ee],De),ve!==null&&(ue=b(ve,ue,ee),je===null?Ze=ve:je.sibling=ve,je=ve);return Ur&&Gh(se,ee),Ze}for(ve=h(se,ve);ee<he.length;ee++)de=Ee(ve,se,ee,he[ee],De),de!==null&&(e&&de.alternate!==null&&ve.delete(de.key===null?ee:de.key),ue=b(de,ue,ee),je===null?Ze=de:je.sibling=de,je=de);return e&&ve.forEach(function(Ue){return r(se,Ue)}),Ur&&Gh(se,ee),Ze}function Fe(se,ue,he,De){var Ze=rm(he);if(typeof Ze!="function")throw Error(lt(150));if(he=Ze.call(he),he==null)throw Error(lt(151));for(var je=Ze=null,ve=ue,ee=ue=0,de=null,Te=he.next();ve!==null&&!Te.done;ee++,Te=he.next()){ve.index>ee?(de=ve,ve=null):de=ve.sibling;var Ue=q(se,ve,Te.value,De);if(Ue===null){ve===null&&(ve=de);break}e&&ve&&Ue.alternate===null&&r(se,ve),ue=b(Ue,ue,ee),je===null?Ze=Ue:je.sibling=Ue,je=Ue,ve=de}if(Te.done)return o(se,ve),Ur&&Gh(se,ee),Ze;if(ve===null){for(;!Te.done;ee++,Te=he.next())Te=G(se,Te.value,De),Te!==null&&(ue=b(Te,ue,ee),je===null?Ze=Te:je.sibling=Te,je=Te);return Ur&&Gh(se,ee),Ze}for(ve=h(se,ve);!Te.done;ee++,Te=he.next())Te=Ee(ve,se,ee,Te.value,De),Te!==null&&(e&&Te.alternate!==null&&ve.delete(Te.key===null?ee:Te.key),ue=b(Te,ue,ee),je===null?Ze=Te:je.sibling=Te,je=Te);return e&&ve.forEach(function(Xe){return r(se,Xe)}),Ur&&Gh(se,ee),Ze}function Ne(se,ue,he,De){if(typeof he=="object"&&he!==null&&he.type===yf&&he.key===null&&(he=he.props.children),typeof he=="object"&&he!==null){switch(he.$$typeof){case y_:e:{for(var Ze=he.key,je=ue;je!==null;){if(je.key===Ze){if(Ze=he.type,Ze===yf){if(je.tag===7){o(se,je.sibling),ue=g(je,he.props.children),ue.return=se,se=ue;break e}}else if(je.elementType===Ze||typeof Ze=="object"&&Ze!==null&&Ze.$$typeof===Ec&&db(Ze)===je.type){o(se,je.sibling),ue=g(je,he.props),ue.ref=lm(se,je,he),ue.return=se,se=ue;break e}o(se,je);break}else r(se,je);je=je.sibling}he.type===yf?(ue=td(he.props.children,se.mode,De,he.key),ue.return=se,se=ue):(De=K_(he.type,he.key,he.props,null,se.mode,De),De.ref=lm(se,ue,he),De.return=se,se=De)}return w(se);case _f:e:{for(je=he.key;ue!==null;){if(ue.key===je)if(ue.tag===4&&ue.stateNode.containerInfo===he.containerInfo&&ue.stateNode.implementation===he.implementation){o(se,ue.sibling),ue=g(ue,he.children||[]),ue.return=se,se=ue;break e}else{o(se,ue);break}else r(se,ue);ue=ue.sibling}ue=G1(he,se.mode,De),ue.return=se,se=ue}return w(se);case Ec:return je=he._init,Ne(se,ue,je(he._payload),De)}if(fm(he))return Ae(se,ue,he,De);if(rm(he))return Fe(se,ue,he,De);P_(se,he)}return typeof he=="string"&&he!==""||typeof he=="number"?(he=""+he,ue!==null&&ue.tag===6?(o(se,ue.sibling),ue=g(ue,he),ue.return=se,se=ue):(o(se,ue),ue=W1(he,se.mode,De),ue.return=se,se=ue),w(se)):o(se,ue)}return Ne}var Nf=P3(!0),A3=P3(!1),h0=Vc(null),d0=null,Cf=null,Bx=null;function Nx(){Bx=Cf=d0=null}function Ux(e){var r=h0.current;Lr(h0),e._currentValue=r}function Uv(e,r,o){for(;e!==null;){var h=e.alternate;if((e.childLanes&r)!==r?(e.childLanes|=r,h!==null&&(h.childLanes|=r)):h!==null&&(h.childLanes&r)!==r&&(h.childLanes|=r),e===o)break;e=e.return}}function Df(e,r){d0=e,Bx=Cf=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&r&&(so=!0),e.firstContext=null)}function ca(e){var r=e._currentValue;if(Bx!==e)if(e={context:e,memoizedValue:r,next:null},Cf===null){if(d0===null)throw Error(lt(308));Cf=e,d0.dependencies={lanes:0,firstContext:e}}else Cf=Cf.next=e;return r}var Jh=null;function jx(e){Jh===null?Jh=[e]:Jh.push(e)}function M3(e,r,o,h){var g=r.interleaved;return g===null?(o.next=o,jx(r)):(o.next=g.next,g.next=o),r.interleaved=o,Lu(e,h)}function Lu(e,r){e.lanes|=r;var o=e.alternate;for(o!==null&&(o.lanes|=r),o=e,e=e.return;e!==null;)e.childLanes|=r,o=e.alternate,o!==null&&(o.childLanes|=r),o=e,e=e.return;return o.tag===3?o.stateNode:null}var Cc=!1;function $x(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function z3(e,r){e=e.updateQueue,r.updateQueue===e&&(r.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Au(e,r){return{eventTime:e,lane:r,tag:0,payload:null,callback:null,next:null}}function Rc(e,r,o){var h=e.updateQueue;if(h===null)return null;if(h=h.shared,Jn&2){var g=h.pending;return g===null?r.next=r:(r.next=g.next,g.next=r),h.pending=r,Lu(e,o)}return g=h.interleaved,g===null?(r.next=r,jx(h)):(r.next=g.next,g.next=r),h.interleaved=r,Lu(e,o)}function q_(e,r,o){if(r=r.updateQueue,r!==null&&(r=r.shared,(o&4194240)!==0)){var h=r.lanes;h&=e.pendingLanes,o|=h,r.lanes=o,Ix(e,o)}}function fb(e,r){var o=e.updateQueue,h=e.alternate;if(h!==null&&(h=h.updateQueue,o===h)){var g=null,b=null;if(o=o.firstBaseUpdate,o!==null){do{var w={eventTime:o.eventTime,lane:o.lane,tag:o.tag,payload:o.payload,callback:o.callback,next:null};b===null?g=b=w:b=b.next=w,o=o.next}while(o!==null);b===null?g=b=r:b=b.next=r}else g=b=r;o={baseState:h.baseState,firstBaseUpdate:g,lastBaseUpdate:b,shared:h.shared,effects:h.effects},e.updateQueue=o;return}e=o.lastBaseUpdate,e===null?o.firstBaseUpdate=r:e.next=r,o.lastBaseUpdate=r}function f0(e,r,o,h){var g=e.updateQueue;Cc=!1;var b=g.firstBaseUpdate,w=g.lastBaseUpdate,c=g.shared.pending;if(c!==null){g.shared.pending=null;var D=c,j=D.next;D.next=null,w===null?b=j:w.next=j,w=D;var J=e.alternate;J!==null&&(J=J.updateQueue,c=J.lastBaseUpdate,c!==w&&(c===null?J.firstBaseUpdate=j:c.next=j,J.lastBaseUpdate=D))}if(b!==null){var G=g.baseState;w=0,J=j=D=null,c=b;do{var q=c.lane,Ee=c.eventTime;if((h&q)===q){J!==null&&(J=J.next={eventTime:Ee,lane:0,tag:c.tag,payload:c.payload,callback:c.callback,next:null});e:{var Ae=e,Fe=c;switch(q=r,Ee=o,Fe.tag){case 1:if(Ae=Fe.payload,typeof Ae=="function"){G=Ae.call(Ee,G,q);break e}G=Ae;break e;case 3:Ae.flags=Ae.flags&-65537|128;case 0:if(Ae=Fe.payload,q=typeof Ae=="function"?Ae.call(Ee,G,q):Ae,q==null)break e;G=Wr({},G,q);break e;case 2:Cc=!0}}c.callback!==null&&c.lane!==0&&(e.flags|=64,q=g.effects,q===null?g.effects=[c]:q.push(c))}else Ee={eventTime:Ee,lane:q,tag:c.tag,payload:c.payload,callback:c.callback,next:null},J===null?(j=J=Ee,D=G):J=J.next=Ee,w|=q;if(c=c.next,c===null){if(c=g.shared.pending,c===null)break;q=c,c=q.next,q.next=null,g.lastBaseUpdate=q,g.shared.pending=null}}while(!0);if(J===null&&(D=G),g.baseState=D,g.firstBaseUpdate=j,g.lastBaseUpdate=J,r=g.shared.interleaved,r!==null){g=r;do w|=g.lane,g=g.next;while(g!==r)}else b===null&&(g.shared.lanes=0);od|=w,e.lanes=w,e.memoizedState=G}}function pb(e,r,o){if(e=r.effects,r.effects=null,e!==null)for(r=0;r<e.length;r++){var h=e[r],g=h.callback;if(g!==null){if(h.callback=null,h=o,typeof g!="function")throw Error(lt(191,g));g.call(h)}}}var Km={},Bl=Vc(Km),Fm=Vc(Km),Bm=Vc(Km);function Qh(e){if(e===Km)throw Error(lt(174));return e}function Vx(e,r){switch(kr(Bm,r),kr(Fm,e),kr(Bl,Km),e=r.nodeType,e){case 9:case 11:r=(r=r.documentElement)?r.namespaceURI:xv(null,"");break;default:e=e===8?r.parentNode:r,r=e.namespaceURI||null,e=e.tagName,r=xv(r,e)}Lr(Bl),kr(Bl,r)}function Uf(){Lr(Bl),Lr(Fm),Lr(Bm)}function D3(e){Qh(Bm.current);var r=Qh(Bl.current),o=xv(r,e.type);r!==o&&(kr(Fm,e),kr(Bl,o))}function qx(e){Fm.current===e&&(Lr(Bl),Lr(Fm))}var qr=Vc(0);function p0(e){for(var r=e;r!==null;){if(r.tag===13){var o=r.memoizedState;if(o!==null&&(o=o.dehydrated,o===null||o.data==="$?"||o.data==="$!"))return r}else if(r.tag===19&&r.memoizedProps.revealOrder!==void 0){if(r.flags&128)return r}else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===e)break;for(;r.sibling===null;){if(r.return===null||r.return===e)return null;r=r.return}r.sibling.return=r.return,r=r.sibling}return null}var U1=[];function Zx(){for(var e=0;e<U1.length;e++)U1[e]._workInProgressVersionPrimary=null;U1.length=0}var Z_=Fu.ReactCurrentDispatcher,j1=Fu.ReactCurrentBatchConfig,sd=0,Zr=null,Ai=null,$i=null,m0=!1,bm=!1,Nm=0,NT=0;function ks(){throw Error(lt(321))}function Wx(e,r){if(r===null)return!1;for(var o=0;o<r.length&&o<e.length;o++)if(!Ya(e[o],r[o]))return!1;return!0}function Gx(e,r,o,h,g,b){if(sd=b,Zr=r,r.memoizedState=null,r.updateQueue=null,r.lanes=0,Z_.current=e===null||e.memoizedState===null?VT:qT,e=o(h,g),bm){b=0;do{if(bm=!1,Nm=0,25<=b)throw Error(lt(301));b+=1,$i=Ai=null,r.updateQueue=null,Z_.current=ZT,e=o(h,g)}while(bm)}if(Z_.current=g0,r=Ai!==null&&Ai.next!==null,sd=0,$i=Ai=Zr=null,m0=!1,r)throw Error(lt(300));return e}function Hx(){var e=Nm!==0;return Nm=0,e}function Ll(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return $i===null?Zr.memoizedState=$i=e:$i=$i.next=e,$i}function ha(){if(Ai===null){var e=Zr.alternate;e=e!==null?e.memoizedState:null}else e=Ai.next;var r=$i===null?Zr.memoizedState:$i.next;if(r!==null)$i=r,Ai=e;else{if(e===null)throw Error(lt(310));Ai=e,e={memoizedState:Ai.memoizedState,baseState:Ai.baseState,baseQueue:Ai.baseQueue,queue:Ai.queue,next:null},$i===null?Zr.memoizedState=$i=e:$i=$i.next=e}return $i}function Um(e,r){return typeof r=="function"?r(e):r}function $1(e){var r=ha(),o=r.queue;if(o===null)throw Error(lt(311));o.lastRenderedReducer=e;var h=Ai,g=h.baseQueue,b=o.pending;if(b!==null){if(g!==null){var w=g.next;g.next=b.next,b.next=w}h.baseQueue=g=b,o.pending=null}if(g!==null){b=g.next,h=h.baseState;var c=w=null,D=null,j=b;do{var J=j.lane;if((sd&J)===J)D!==null&&(D=D.next={lane:0,action:j.action,hasEagerState:j.hasEagerState,eagerState:j.eagerState,next:null}),h=j.hasEagerState?j.eagerState:e(h,j.action);else{var G={lane:J,action:j.action,hasEagerState:j.hasEagerState,eagerState:j.eagerState,next:null};D===null?(c=D=G,w=h):D=D.next=G,Zr.lanes|=J,od|=J}j=j.next}while(j!==null&&j!==b);D===null?w=h:D.next=c,Ya(h,r.memoizedState)||(so=!0),r.memoizedState=h,r.baseState=w,r.baseQueue=D,o.lastRenderedState=h}if(e=o.interleaved,e!==null){g=e;do b=g.lane,Zr.lanes|=b,od|=b,g=g.next;while(g!==e)}else g===null&&(o.lanes=0);return[r.memoizedState,o.dispatch]}function V1(e){var r=ha(),o=r.queue;if(o===null)throw Error(lt(311));o.lastRenderedReducer=e;var h=o.dispatch,g=o.pending,b=r.memoizedState;if(g!==null){o.pending=null;var w=g=g.next;do b=e(b,w.action),w=w.next;while(w!==g);Ya(b,r.memoizedState)||(so=!0),r.memoizedState=b,r.baseQueue===null&&(r.baseState=b),o.lastRenderedState=b}return[b,h]}function L3(){}function R3(e,r){var o=Zr,h=ha(),g=r(),b=!Ya(h.memoizedState,g);if(b&&(h.memoizedState=g,so=!0),h=h.queue,Xx(B3.bind(null,o,h,e),[e]),h.getSnapshot!==r||b||$i!==null&&$i.memoizedState.tag&1){if(o.flags|=2048,jm(9,F3.bind(null,o,h,g,r),void 0,null),Vi===null)throw Error(lt(349));sd&30||O3(o,r,g)}return g}function O3(e,r,o){e.flags|=16384,e={getSnapshot:r,value:o},r=Zr.updateQueue,r===null?(r={lastEffect:null,stores:null},Zr.updateQueue=r,r.stores=[e]):(o=r.stores,o===null?r.stores=[e]:o.push(e))}function F3(e,r,o,h){r.value=o,r.getSnapshot=h,N3(r)&&U3(e)}function B3(e,r,o){return o(function(){N3(r)&&U3(e)})}function N3(e){var r=e.getSnapshot;e=e.value;try{var o=r();return!Ya(e,o)}catch{return!0}}function U3(e){var r=Lu(e,1);r!==null&&Xa(r,e,1,-1)}function mb(e){var r=Ll();return typeof e=="function"&&(e=e()),r.memoizedState=r.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Um,lastRenderedState:e},r.queue=e,e=e.dispatch=$T.bind(null,Zr,e),[r.memoizedState,e]}function jm(e,r,o,h){return e={tag:e,create:r,destroy:o,deps:h,next:null},r=Zr.updateQueue,r===null?(r={lastEffect:null,stores:null},Zr.updateQueue=r,r.lastEffect=e.next=e):(o=r.lastEffect,o===null?r.lastEffect=e.next=e:(h=o.next,o.next=e,e.next=h,r.lastEffect=e)),e}function j3(){return ha().memoizedState}function W_(e,r,o,h){var g=Ll();Zr.flags|=e,g.memoizedState=jm(1|r,o,void 0,h===void 0?null:h)}function Z0(e,r,o,h){var g=ha();h=h===void 0?null:h;var b=void 0;if(Ai!==null){var w=Ai.memoizedState;if(b=w.destroy,h!==null&&Wx(h,w.deps)){g.memoizedState=jm(r,o,b,h);return}}Zr.flags|=e,g.memoizedState=jm(1|r,o,b,h)}function gb(e,r){return W_(8390656,8,e,r)}function Xx(e,r){return Z0(2048,8,e,r)}function $3(e,r){return Z0(4,2,e,r)}function V3(e,r){return Z0(4,4,e,r)}function q3(e,r){if(typeof r=="function")return e=e(),r(e),function(){r(null)};if(r!=null)return e=e(),r.current=e,function(){r.current=null}}function Z3(e,r,o){return o=o!=null?o.concat([e]):null,Z0(4,4,q3.bind(null,r,e),o)}function Kx(){}function W3(e,r){var o=ha();r=r===void 0?null:r;var h=o.memoizedState;return h!==null&&r!==null&&Wx(r,h[1])?h[0]:(o.memoizedState=[e,r],e)}function G3(e,r){var o=ha();r=r===void 0?null:r;var h=o.memoizedState;return h!==null&&r!==null&&Wx(r,h[1])?h[0]:(e=e(),o.memoizedState=[e,r],e)}function H3(e,r,o){return sd&21?(Ya(o,r)||(o=Q2(),Zr.lanes|=o,od|=o,e.baseState=!0),r):(e.baseState&&(e.baseState=!1,so=!0),e.memoizedState=o)}function UT(e,r){var o=hr;hr=o!==0&&4>o?o:4,e(!0);var h=j1.transition;j1.transition={};try{e(!1),r()}finally{hr=o,j1.transition=h}}function X3(){return ha().memoizedState}function jT(e,r,o){var h=Fc(e);if(o={lane:h,action:o,hasEagerState:!1,eagerState:null,next:null},K3(e))Y3(r,o);else if(o=M3(e,r,o,h),o!==null){var g=Gs();Xa(o,e,h,g),J3(o,r,h)}}function $T(e,r,o){var h=Fc(e),g={lane:h,action:o,hasEagerState:!1,eagerState:null,next:null};if(K3(e))Y3(r,g);else{var b=e.alternate;if(e.lanes===0&&(b===null||b.lanes===0)&&(b=r.lastRenderedReducer,b!==null))try{var w=r.lastRenderedState,c=b(w,o);if(g.hasEagerState=!0,g.eagerState=c,Ya(c,w)){var D=r.interleaved;D===null?(g.next=g,jx(r)):(g.next=D.next,D.next=g),r.interleaved=g;return}}catch{}finally{}o=M3(e,r,g,h),o!==null&&(g=Gs(),Xa(o,e,h,g),J3(o,r,h))}}function K3(e){var r=e.alternate;return e===Zr||r!==null&&r===Zr}function Y3(e,r){bm=m0=!0;var o=e.pending;o===null?r.next=r:(r.next=o.next,o.next=r),e.pending=r}function J3(e,r,o){if(o&4194240){var h=r.lanes;h&=e.pendingLanes,o|=h,r.lanes=o,Ix(e,o)}}var g0={readContext:ca,useCallback:ks,useContext:ks,useEffect:ks,useImperativeHandle:ks,useInsertionEffect:ks,useLayoutEffect:ks,useMemo:ks,useReducer:ks,useRef:ks,useState:ks,useDebugValue:ks,useDeferredValue:ks,useTransition:ks,useMutableSource:ks,useSyncExternalStore:ks,useId:ks,unstable_isNewReconciler:!1},VT={readContext:ca,useCallback:function(e,r){return Ll().memoizedState=[e,r===void 0?null:r],e},useContext:ca,useEffect:gb,useImperativeHandle:function(e,r,o){return o=o!=null?o.concat([e]):null,W_(4194308,4,q3.bind(null,r,e),o)},useLayoutEffect:function(e,r){return W_(4194308,4,e,r)},useInsertionEffect:function(e,r){return W_(4,2,e,r)},useMemo:function(e,r){var o=Ll();return r=r===void 0?null:r,e=e(),o.memoizedState=[e,r],e},useReducer:function(e,r,o){var h=Ll();return r=o!==void 0?o(r):r,h.memoizedState=h.baseState=r,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:r},h.queue=e,e=e.dispatch=jT.bind(null,Zr,e),[h.memoizedState,e]},useRef:function(e){var r=Ll();return e={current:e},r.memoizedState=e},useState:mb,useDebugValue:Kx,useDeferredValue:function(e){return Ll().memoizedState=e},useTransition:function(){var e=mb(!1),r=e[0];return e=UT.bind(null,e[1]),Ll().memoizedState=e,[r,e]},useMutableSource:function(){},useSyncExternalStore:function(e,r,o){var h=Zr,g=Ll();if(Ur){if(o===void 0)throw Error(lt(407));o=o()}else{if(o=r(),Vi===null)throw Error(lt(349));sd&30||O3(h,r,o)}g.memoizedState=o;var b={value:o,getSnapshot:r};return g.queue=b,gb(B3.bind(null,h,b,e),[e]),h.flags|=2048,jm(9,F3.bind(null,h,b,o,r),void 0,null),o},useId:function(){var e=Ll(),r=Vi.identifierPrefix;if(Ur){var o=ku,h=Iu;o=(h&~(1<<32-Ha(h)-1)).toString(32)+o,r=":"+r+"R"+o,o=Nm++,0<o&&(r+="H"+o.toString(32)),r+=":"}else o=NT++,r=":"+r+"r"+o.toString(32)+":";return e.memoizedState=r},unstable_isNewReconciler:!1},qT={readContext:ca,useCallback:W3,useContext:ca,useEffect:Xx,useImperativeHandle:Z3,useInsertionEffect:$3,useLayoutEffect:V3,useMemo:G3,useReducer:$1,useRef:j3,useState:function(){return $1(Um)},useDebugValue:Kx,useDeferredValue:function(e){var r=ha();return H3(r,Ai.memoizedState,e)},useTransition:function(){var e=$1(Um)[0],r=ha().memoizedState;return[e,r]},useMutableSource:L3,useSyncExternalStore:R3,useId:X3,unstable_isNewReconciler:!1},ZT={readContext:ca,useCallback:W3,useContext:ca,useEffect:Xx,useImperativeHandle:Z3,useInsertionEffect:$3,useLayoutEffect:V3,useMemo:G3,useReducer:V1,useRef:j3,useState:function(){return V1(Um)},useDebugValue:Kx,useDeferredValue:function(e){var r=ha();return Ai===null?r.memoizedState=e:H3(r,Ai.memoizedState,e)},useTransition:function(){var e=V1(Um)[0],r=ha().memoizedState;return[e,r]},useMutableSource:L3,useSyncExternalStore:R3,useId:X3,unstable_isNewReconciler:!1};function qa(e,r){if(e&&e.defaultProps){r=Wr({},r),e=e.defaultProps;for(var o in e)r[o]===void 0&&(r[o]=e[o]);return r}return r}function jv(e,r,o,h){r=e.memoizedState,o=o(h,r),o=o==null?r:Wr({},r,o),e.memoizedState=o,e.lanes===0&&(e.updateQueue.baseState=o)}var W0={isMounted:function(e){return(e=e._reactInternals)?dd(e)===e:!1},enqueueSetState:function(e,r,o){e=e._reactInternals;var h=Gs(),g=Fc(e),b=Au(h,g);b.payload=r,o!=null&&(b.callback=o),r=Rc(e,b,g),r!==null&&(Xa(r,e,g,h),q_(r,e,g))},enqueueReplaceState:function(e,r,o){e=e._reactInternals;var h=Gs(),g=Fc(e),b=Au(h,g);b.tag=1,b.payload=r,o!=null&&(b.callback=o),r=Rc(e,b,g),r!==null&&(Xa(r,e,g,h),q_(r,e,g))},enqueueForceUpdate:function(e,r){e=e._reactInternals;var o=Gs(),h=Fc(e),g=Au(o,h);g.tag=2,r!=null&&(g.callback=r),r=Rc(e,g,h),r!==null&&(Xa(r,e,h,o),q_(r,e,h))}};function _b(e,r,o,h,g,b,w){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(h,b,w):r.prototype&&r.prototype.isPureReactComponent?!Dm(o,h)||!Dm(g,b):!0}function Q3(e,r,o){var h=!1,g=Uc,b=r.contextType;return typeof b=="object"&&b!==null?b=ca(b):(g=ao(r)?rd:zs.current,h=r.contextTypes,b=(h=h!=null)?Ff(e,g):Uc),r=new r(o,b),e.memoizedState=r.state!==null&&r.state!==void 0?r.state:null,r.updater=W0,e.stateNode=r,r._reactInternals=e,h&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=g,e.__reactInternalMemoizedMaskedChildContext=b),r}function yb(e,r,o,h){e=r.state,typeof r.componentWillReceiveProps=="function"&&r.componentWillReceiveProps(o,h),typeof r.UNSAFE_componentWillReceiveProps=="function"&&r.UNSAFE_componentWillReceiveProps(o,h),r.state!==e&&W0.enqueueReplaceState(r,r.state,null)}function $v(e,r,o,h){var g=e.stateNode;g.props=o,g.state=e.memoizedState,g.refs={},$x(e);var b=r.contextType;typeof b=="object"&&b!==null?g.context=ca(b):(b=ao(r)?rd:zs.current,g.context=Ff(e,b)),g.state=e.memoizedState,b=r.getDerivedStateFromProps,typeof b=="function"&&(jv(e,r,b,o),g.state=e.memoizedState),typeof r.getDerivedStateFromProps=="function"||typeof g.getSnapshotBeforeUpdate=="function"||typeof g.UNSAFE_componentWillMount!="function"&&typeof g.componentWillMount!="function"||(r=g.state,typeof g.componentWillMount=="function"&&g.componentWillMount(),typeof g.UNSAFE_componentWillMount=="function"&&g.UNSAFE_componentWillMount(),r!==g.state&&W0.enqueueReplaceState(g,g.state,null),f0(e,o,g,h),g.state=e.memoizedState),typeof g.componentDidMount=="function"&&(e.flags|=4194308)}function jf(e,r){try{var o="",h=r;do o+=v6(h),h=h.return;while(h);var g=o}catch(b){g=`
Error generating stack: `+b.message+`
`+b.stack}return{value:e,source:r,stack:g,digest:null}}function q1(e,r,o){return{value:e,source:null,stack:o??null,digest:r??null}}function Vv(e,r){try{console.error(r.value)}catch(o){setTimeout(function(){throw o})}}var WT=typeof WeakMap=="function"?WeakMap:Map;function e4(e,r,o){o=Au(-1,o),o.tag=3,o.payload={element:null};var h=r.value;return o.callback=function(){y0||(y0=!0,Qv=h),Vv(e,r)},o}function t4(e,r,o){o=Au(-1,o),o.tag=3;var h=e.type.getDerivedStateFromError;if(typeof h=="function"){var g=r.value;o.payload=function(){return h(g)},o.callback=function(){Vv(e,r)}}var b=e.stateNode;return b!==null&&typeof b.componentDidCatch=="function"&&(o.callback=function(){Vv(e,r),typeof h!="function"&&(Oc===null?Oc=new Set([this]):Oc.add(this));var w=r.stack;this.componentDidCatch(r.value,{componentStack:w!==null?w:""})}),o}function vb(e,r,o){var h=e.pingCache;if(h===null){h=e.pingCache=new WT;var g=new Set;h.set(r,g)}else g=h.get(r),g===void 0&&(g=new Set,h.set(r,g));g.has(o)||(g.add(o),e=oE.bind(null,e,r,o),r.then(e,e))}function xb(e){do{var r;if((r=e.tag===13)&&(r=e.memoizedState,r=r!==null?r.dehydrated!==null:!0),r)return e;e=e.return}while(e!==null);return null}function wb(e,r,o,h,g){return e.mode&1?(e.flags|=65536,e.lanes=g,e):(e===r?e.flags|=65536:(e.flags|=128,o.flags|=131072,o.flags&=-52805,o.tag===1&&(o.alternate===null?o.tag=17:(r=Au(-1,1),r.tag=2,Rc(o,r,1))),o.lanes|=1),e)}var GT=Fu.ReactCurrentOwner,so=!1;function Ws(e,r,o,h){r.child=e===null?A3(r,null,o,h):Nf(r,e.child,o,h)}function bb(e,r,o,h,g){o=o.render;var b=r.ref;return Df(r,g),h=Gx(e,r,o,h,b,g),o=Hx(),e!==null&&!so?(r.updateQueue=e.updateQueue,r.flags&=-2053,e.lanes&=~g,Ru(e,r,g)):(Ur&&o&&Rx(r),r.flags|=1,Ws(e,r,h,g),r.child)}function Sb(e,r,o,h,g){if(e===null){var b=o.type;return typeof b=="function"&&!iw(b)&&b.defaultProps===void 0&&o.compare===null&&o.defaultProps===void 0?(r.tag=15,r.type=b,n4(e,r,b,h,g)):(e=K_(o.type,null,h,r,r.mode,g),e.ref=r.ref,e.return=r,r.child=e)}if(b=e.child,!(e.lanes&g)){var w=b.memoizedProps;if(o=o.compare,o=o!==null?o:Dm,o(w,h)&&e.ref===r.ref)return Ru(e,r,g)}return r.flags|=1,e=Bc(b,h),e.ref=r.ref,e.return=r,r.child=e}function n4(e,r,o,h,g){if(e!==null){var b=e.memoizedProps;if(Dm(b,h)&&e.ref===r.ref)if(so=!1,r.pendingProps=h=b,(e.lanes&g)!==0)e.flags&131072&&(so=!0);else return r.lanes=e.lanes,Ru(e,r,g)}return qv(e,r,o,h,g)}function r4(e,r,o){var h=r.pendingProps,g=h.children,b=e!==null?e.memoizedState:null;if(h.mode==="hidden")if(!(r.mode&1))r.memoizedState={baseLanes:0,cachePool:null,transitions:null},kr(kf,Po),Po|=o;else{if(!(o&1073741824))return e=b!==null?b.baseLanes|o:o,r.lanes=r.childLanes=1073741824,r.memoizedState={baseLanes:e,cachePool:null,transitions:null},r.updateQueue=null,kr(kf,Po),Po|=e,null;r.memoizedState={baseLanes:0,cachePool:null,transitions:null},h=b!==null?b.baseLanes:o,kr(kf,Po),Po|=h}else b!==null?(h=b.baseLanes|o,r.memoizedState=null):h=o,kr(kf,Po),Po|=h;return Ws(e,r,g,o),r.child}function i4(e,r){var o=r.ref;(e===null&&o!==null||e!==null&&e.ref!==o)&&(r.flags|=512,r.flags|=2097152)}function qv(e,r,o,h,g){var b=ao(o)?rd:zs.current;return b=Ff(r,b),Df(r,g),o=Gx(e,r,o,h,b,g),h=Hx(),e!==null&&!so?(r.updateQueue=e.updateQueue,r.flags&=-2053,e.lanes&=~g,Ru(e,r,g)):(Ur&&h&&Rx(r),r.flags|=1,Ws(e,r,o,g),r.child)}function Tb(e,r,o,h,g){if(ao(o)){var b=!0;l0(r)}else b=!1;if(Df(r,g),r.stateNode===null)G_(e,r),Q3(r,o,h),$v(r,o,h,g),h=!0;else if(e===null){var w=r.stateNode,c=r.memoizedProps;w.props=c;var D=w.context,j=o.contextType;typeof j=="object"&&j!==null?j=ca(j):(j=ao(o)?rd:zs.current,j=Ff(r,j));var J=o.getDerivedStateFromProps,G=typeof J=="function"||typeof w.getSnapshotBeforeUpdate=="function";G||typeof w.UNSAFE_componentWillReceiveProps!="function"&&typeof w.componentWillReceiveProps!="function"||(c!==h||D!==j)&&yb(r,w,h,j),Cc=!1;var q=r.memoizedState;w.state=q,f0(r,h,w,g),D=r.memoizedState,c!==h||q!==D||oo.current||Cc?(typeof J=="function"&&(jv(r,o,J,h),D=r.memoizedState),(c=Cc||_b(r,o,c,h,q,D,j))?(G||typeof w.UNSAFE_componentWillMount!="function"&&typeof w.componentWillMount!="function"||(typeof w.componentWillMount=="function"&&w.componentWillMount(),typeof w.UNSAFE_componentWillMount=="function"&&w.UNSAFE_componentWillMount()),typeof w.componentDidMount=="function"&&(r.flags|=4194308)):(typeof w.componentDidMount=="function"&&(r.flags|=4194308),r.memoizedProps=h,r.memoizedState=D),w.props=h,w.state=D,w.context=j,h=c):(typeof w.componentDidMount=="function"&&(r.flags|=4194308),h=!1)}else{w=r.stateNode,z3(e,r),c=r.memoizedProps,j=r.type===r.elementType?c:qa(r.type,c),w.props=j,G=r.pendingProps,q=w.context,D=o.contextType,typeof D=="object"&&D!==null?D=ca(D):(D=ao(o)?rd:zs.current,D=Ff(r,D));var Ee=o.getDerivedStateFromProps;(J=typeof Ee=="function"||typeof w.getSnapshotBeforeUpdate=="function")||typeof w.UNSAFE_componentWillReceiveProps!="function"&&typeof w.componentWillReceiveProps!="function"||(c!==G||q!==D)&&yb(r,w,h,D),Cc=!1,q=r.memoizedState,w.state=q,f0(r,h,w,g);var Ae=r.memoizedState;c!==G||q!==Ae||oo.current||Cc?(typeof Ee=="function"&&(jv(r,o,Ee,h),Ae=r.memoizedState),(j=Cc||_b(r,o,j,h,q,Ae,D)||!1)?(J||typeof w.UNSAFE_componentWillUpdate!="function"&&typeof w.componentWillUpdate!="function"||(typeof w.componentWillUpdate=="function"&&w.componentWillUpdate(h,Ae,D),typeof w.UNSAFE_componentWillUpdate=="function"&&w.UNSAFE_componentWillUpdate(h,Ae,D)),typeof w.componentDidUpdate=="function"&&(r.flags|=4),typeof w.getSnapshotBeforeUpdate=="function"&&(r.flags|=1024)):(typeof w.componentDidUpdate!="function"||c===e.memoizedProps&&q===e.memoizedState||(r.flags|=4),typeof w.getSnapshotBeforeUpdate!="function"||c===e.memoizedProps&&q===e.memoizedState||(r.flags|=1024),r.memoizedProps=h,r.memoizedState=Ae),w.props=h,w.state=Ae,w.context=D,h=j):(typeof w.componentDidUpdate!="function"||c===e.memoizedProps&&q===e.memoizedState||(r.flags|=4),typeof w.getSnapshotBeforeUpdate!="function"||c===e.memoizedProps&&q===e.memoizedState||(r.flags|=1024),h=!1)}return Zv(e,r,o,h,b,g)}function Zv(e,r,o,h,g,b){i4(e,r);var w=(r.flags&128)!==0;if(!h&&!w)return g&&ub(r,o,!1),Ru(e,r,b);h=r.stateNode,GT.current=r;var c=w&&typeof o.getDerivedStateFromError!="function"?null:h.render();return r.flags|=1,e!==null&&w?(r.child=Nf(r,e.child,null,b),r.child=Nf(r,null,c,b)):Ws(e,r,c,b),r.memoizedState=h.state,g&&ub(r,o,!0),r.child}function s4(e){var r=e.stateNode;r.pendingContext?lb(e,r.pendingContext,r.pendingContext!==r.context):r.context&&lb(e,r.context,!1),Vx(e,r.containerInfo)}function Eb(e,r,o,h,g){return Bf(),Fx(g),r.flags|=256,Ws(e,r,o,h),r.child}var Wv={dehydrated:null,treeContext:null,retryLane:0};function Gv(e){return{baseLanes:e,cachePool:null,transitions:null}}function o4(e,r,o){var h=r.pendingProps,g=qr.current,b=!1,w=(r.flags&128)!==0,c;if((c=w)||(c=e!==null&&e.memoizedState===null?!1:(g&2)!==0),c?(b=!0,r.flags&=-129):(e===null||e.memoizedState!==null)&&(g|=1),kr(qr,g&1),e===null)return Nv(r),e=r.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(r.mode&1?e.data==="$!"?r.lanes=8:r.lanes=1073741824:r.lanes=1,null):(w=h.children,e=h.fallback,b?(h=r.mode,b=r.child,w={mode:"hidden",children:w},!(h&1)&&b!==null?(b.childLanes=0,b.pendingProps=w):b=X0(w,h,0,null),e=td(e,h,o,null),b.return=r,e.return=r,b.sibling=e,r.child=b,r.child.memoizedState=Gv(o),r.memoizedState=Wv,e):Yx(r,w));if(g=e.memoizedState,g!==null&&(c=g.dehydrated,c!==null))return HT(e,r,w,h,c,g,o);if(b){b=h.fallback,w=r.mode,g=e.child,c=g.sibling;var D={mode:"hidden",children:h.children};return!(w&1)&&r.child!==g?(h=r.child,h.childLanes=0,h.pendingProps=D,r.deletions=null):(h=Bc(g,D),h.subtreeFlags=g.subtreeFlags&14680064),c!==null?b=Bc(c,b):(b=td(b,w,o,null),b.flags|=2),b.return=r,h.return=r,h.sibling=b,r.child=h,h=b,b=r.child,w=e.child.memoizedState,w=w===null?Gv(o):{baseLanes:w.baseLanes|o,cachePool:null,transitions:w.transitions},b.memoizedState=w,b.childLanes=e.childLanes&~o,r.memoizedState=Wv,h}return b=e.child,e=b.sibling,h=Bc(b,{mode:"visible",children:h.children}),!(r.mode&1)&&(h.lanes=o),h.return=r,h.sibling=null,e!==null&&(o=r.deletions,o===null?(r.deletions=[e],r.flags|=16):o.push(e)),r.child=h,r.memoizedState=null,h}function Yx(e,r){return r=X0({mode:"visible",children:r},e.mode,0,null),r.return=e,e.child=r}function A_(e,r,o,h){return h!==null&&Fx(h),Nf(r,e.child,null,o),e=Yx(r,r.pendingProps.children),e.flags|=2,r.memoizedState=null,e}function HT(e,r,o,h,g,b,w){if(o)return r.flags&256?(r.flags&=-257,h=q1(Error(lt(422))),A_(e,r,w,h)):r.memoizedState!==null?(r.child=e.child,r.flags|=128,null):(b=h.fallback,g=r.mode,h=X0({mode:"visible",children:h.children},g,0,null),b=td(b,g,w,null),b.flags|=2,h.return=r,b.return=r,h.sibling=b,r.child=h,r.mode&1&&Nf(r,e.child,null,w),r.child.memoizedState=Gv(w),r.memoizedState=Wv,b);if(!(r.mode&1))return A_(e,r,w,null);if(g.data==="$!"){if(h=g.nextSibling&&g.nextSibling.dataset,h)var c=h.dgst;return h=c,b=Error(lt(419)),h=q1(b,h,void 0),A_(e,r,w,h)}if(c=(w&e.childLanes)!==0,so||c){if(h=Vi,h!==null){switch(w&-w){case 4:g=2;break;case 16:g=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:g=32;break;case 536870912:g=268435456;break;default:g=0}g=g&(h.suspendedLanes|w)?0:g,g!==0&&g!==b.retryLane&&(b.retryLane=g,Lu(e,g),Xa(h,e,g,-1))}return rw(),h=q1(Error(lt(421))),A_(e,r,w,h)}return g.data==="$?"?(r.flags|=128,r.child=e.child,r=aE.bind(null,e),g._reactRetry=r,null):(e=b.treeContext,Ao=Lc(g.nextSibling),zo=r,Ur=!0,Wa=null,e!==null&&(sa[oa++]=Iu,sa[oa++]=ku,sa[oa++]=id,Iu=e.id,ku=e.overflow,id=r),r=Yx(r,h.children),r.flags|=4096,r)}function Cb(e,r,o){e.lanes|=r;var h=e.alternate;h!==null&&(h.lanes|=r),Uv(e.return,r,o)}function Z1(e,r,o,h,g){var b=e.memoizedState;b===null?e.memoizedState={isBackwards:r,rendering:null,renderingStartTime:0,last:h,tail:o,tailMode:g}:(b.isBackwards=r,b.rendering=null,b.renderingStartTime=0,b.last=h,b.tail=o,b.tailMode=g)}function a4(e,r,o){var h=r.pendingProps,g=h.revealOrder,b=h.tail;if(Ws(e,r,h.children,o),h=qr.current,h&2)h=h&1|2,r.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=r.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Cb(e,o,r);else if(e.tag===19)Cb(e,o,r);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===r)break e;for(;e.sibling===null;){if(e.return===null||e.return===r)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}h&=1}if(kr(qr,h),!(r.mode&1))r.memoizedState=null;else switch(g){case"forwards":for(o=r.child,g=null;o!==null;)e=o.alternate,e!==null&&p0(e)===null&&(g=o),o=o.sibling;o=g,o===null?(g=r.child,r.child=null):(g=o.sibling,o.sibling=null),Z1(r,!1,g,o,b);break;case"backwards":for(o=null,g=r.child,r.child=null;g!==null;){if(e=g.alternate,e!==null&&p0(e)===null){r.child=g;break}e=g.sibling,g.sibling=o,o=g,g=e}Z1(r,!0,o,null,b);break;case"together":Z1(r,!1,null,null,void 0);break;default:r.memoizedState=null}return r.child}function G_(e,r){!(r.mode&1)&&e!==null&&(e.alternate=null,r.alternate=null,r.flags|=2)}function Ru(e,r,o){if(e!==null&&(r.dependencies=e.dependencies),od|=r.lanes,!(o&r.childLanes))return null;if(e!==null&&r.child!==e.child)throw Error(lt(153));if(r.child!==null){for(e=r.child,o=Bc(e,e.pendingProps),r.child=o,o.return=r;e.sibling!==null;)e=e.sibling,o=o.sibling=Bc(e,e.pendingProps),o.return=r;o.sibling=null}return r.child}function XT(e,r,o){switch(r.tag){case 3:s4(r),Bf();break;case 5:D3(r);break;case 1:ao(r.type)&&l0(r);break;case 4:Vx(r,r.stateNode.containerInfo);break;case 10:var h=r.type._context,g=r.memoizedProps.value;kr(h0,h._currentValue),h._currentValue=g;break;case 13:if(h=r.memoizedState,h!==null)return h.dehydrated!==null?(kr(qr,qr.current&1),r.flags|=128,null):o&r.child.childLanes?o4(e,r,o):(kr(qr,qr.current&1),e=Ru(e,r,o),e!==null?e.sibling:null);kr(qr,qr.current&1);break;case 19:if(h=(o&r.childLanes)!==0,e.flags&128){if(h)return a4(e,r,o);r.flags|=128}if(g=r.memoizedState,g!==null&&(g.rendering=null,g.tail=null,g.lastEffect=null),kr(qr,qr.current),h)break;return null;case 22:case 23:return r.lanes=0,r4(e,r,o)}return Ru(e,r,o)}var l4,Hv,u4,c4;l4=function(e,r){for(var o=r.child;o!==null;){if(o.tag===5||o.tag===6)e.appendChild(o.stateNode);else if(o.tag!==4&&o.child!==null){o.child.return=o,o=o.child;continue}if(o===r)break;for(;o.sibling===null;){if(o.return===null||o.return===r)return;o=o.return}o.sibling.return=o.return,o=o.sibling}};Hv=function(){};u4=function(e,r,o,h){var g=e.memoizedProps;if(g!==h){e=r.stateNode,Qh(Bl.current);var b=null;switch(o){case"input":g=gv(e,g),h=gv(e,h),b=[];break;case"select":g=Wr({},g,{value:void 0}),h=Wr({},h,{value:void 0}),b=[];break;case"textarea":g=vv(e,g),h=vv(e,h),b=[];break;default:typeof g.onClick!="function"&&typeof h.onClick=="function"&&(e.onclick=o0)}wv(o,h);var w;o=null;for(j in g)if(!h.hasOwnProperty(j)&&g.hasOwnProperty(j)&&g[j]!=null)if(j==="style"){var c=g[j];for(w in c)c.hasOwnProperty(w)&&(o||(o={}),o[w]="")}else j!=="dangerouslySetInnerHTML"&&j!=="children"&&j!=="suppressContentEditableWarning"&&j!=="suppressHydrationWarning"&&j!=="autoFocus"&&(Cm.hasOwnProperty(j)?b||(b=[]):(b=b||[]).push(j,null));for(j in h){var D=h[j];if(c=g!=null?g[j]:void 0,h.hasOwnProperty(j)&&D!==c&&(D!=null||c!=null))if(j==="style")if(c){for(w in c)!c.hasOwnProperty(w)||D&&D.hasOwnProperty(w)||(o||(o={}),o[w]="");for(w in D)D.hasOwnProperty(w)&&c[w]!==D[w]&&(o||(o={}),o[w]=D[w])}else o||(b||(b=[]),b.push(j,o)),o=D;else j==="dangerouslySetInnerHTML"?(D=D?D.__html:void 0,c=c?c.__html:void 0,D!=null&&c!==D&&(b=b||[]).push(j,D)):j==="children"?typeof D!="string"&&typeof D!="number"||(b=b||[]).push(j,""+D):j!=="suppressContentEditableWarning"&&j!=="suppressHydrationWarning"&&(Cm.hasOwnProperty(j)?(D!=null&&j==="onScroll"&&Dr("scroll",e),b||c===D||(b=[])):(b=b||[]).push(j,D))}o&&(b=b||[]).push("style",o);var j=b;(r.updateQueue=j)&&(r.flags|=4)}};c4=function(e,r,o,h){o!==h&&(r.flags|=4)};function um(e,r){if(!Ur)switch(e.tailMode){case"hidden":r=e.tail;for(var o=null;r!==null;)r.alternate!==null&&(o=r),r=r.sibling;o===null?e.tail=null:o.sibling=null;break;case"collapsed":o=e.tail;for(var h=null;o!==null;)o.alternate!==null&&(h=o),o=o.sibling;h===null?r||e.tail===null?e.tail=null:e.tail.sibling=null:h.sibling=null}}function Ps(e){var r=e.alternate!==null&&e.alternate.child===e.child,o=0,h=0;if(r)for(var g=e.child;g!==null;)o|=g.lanes|g.childLanes,h|=g.subtreeFlags&14680064,h|=g.flags&14680064,g.return=e,g=g.sibling;else for(g=e.child;g!==null;)o|=g.lanes|g.childLanes,h|=g.subtreeFlags,h|=g.flags,g.return=e,g=g.sibling;return e.subtreeFlags|=h,e.childLanes=o,r}function KT(e,r,o){var h=r.pendingProps;switch(Ox(r),r.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ps(r),null;case 1:return ao(r.type)&&a0(),Ps(r),null;case 3:return h=r.stateNode,Uf(),Lr(oo),Lr(zs),Zx(),h.pendingContext&&(h.context=h.pendingContext,h.pendingContext=null),(e===null||e.child===null)&&(k_(r)?r.flags|=4:e===null||e.memoizedState.isDehydrated&&!(r.flags&256)||(r.flags|=1024,Wa!==null&&(nx(Wa),Wa=null))),Hv(e,r),Ps(r),null;case 5:qx(r);var g=Qh(Bm.current);if(o=r.type,e!==null&&r.stateNode!=null)u4(e,r,o,h,g),e.ref!==r.ref&&(r.flags|=512,r.flags|=2097152);else{if(!h){if(r.stateNode===null)throw Error(lt(166));return Ps(r),null}if(e=Qh(Bl.current),k_(r)){h=r.stateNode,o=r.type;var b=r.memoizedProps;switch(h[Rl]=r,h[Om]=b,e=(r.mode&1)!==0,o){case"dialog":Dr("cancel",h),Dr("close",h);break;case"iframe":case"object":case"embed":Dr("load",h);break;case"video":case"audio":for(g=0;g<mm.length;g++)Dr(mm[g],h);break;case"source":Dr("error",h);break;case"img":case"image":case"link":Dr("error",h),Dr("load",h);break;case"details":Dr("toggle",h);break;case"input":Rw(h,b),Dr("invalid",h);break;case"select":h._wrapperState={wasMultiple:!!b.multiple},Dr("invalid",h);break;case"textarea":Fw(h,b),Dr("invalid",h)}wv(o,b),g=null;for(var w in b)if(b.hasOwnProperty(w)){var c=b[w];w==="children"?typeof c=="string"?h.textContent!==c&&(b.suppressHydrationWarning!==!0&&I_(h.textContent,c,e),g=["children",c]):typeof c=="number"&&h.textContent!==""+c&&(b.suppressHydrationWarning!==!0&&I_(h.textContent,c,e),g=["children",""+c]):Cm.hasOwnProperty(w)&&c!=null&&w==="onScroll"&&Dr("scroll",h)}switch(o){case"input":v_(h),Ow(h,b,!0);break;case"textarea":v_(h),Bw(h);break;case"select":case"option":break;default:typeof b.onClick=="function"&&(h.onclick=o0)}h=g,r.updateQueue=h,h!==null&&(r.flags|=4)}else{w=g.nodeType===9?g:g.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=B2(o)),e==="http://www.w3.org/1999/xhtml"?o==="script"?(e=w.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof h.is=="string"?e=w.createElement(o,{is:h.is}):(e=w.createElement(o),o==="select"&&(w=e,h.multiple?w.multiple=!0:h.size&&(w.size=h.size))):e=w.createElementNS(e,o),e[Rl]=r,e[Om]=h,l4(e,r,!1,!1),r.stateNode=e;e:{switch(w=bv(o,h),o){case"dialog":Dr("cancel",e),Dr("close",e),g=h;break;case"iframe":case"object":case"embed":Dr("load",e),g=h;break;case"video":case"audio":for(g=0;g<mm.length;g++)Dr(mm[g],e);g=h;break;case"source":Dr("error",e),g=h;break;case"img":case"image":case"link":Dr("error",e),Dr("load",e),g=h;break;case"details":Dr("toggle",e),g=h;break;case"input":Rw(e,h),g=gv(e,h),Dr("invalid",e);break;case"option":g=h;break;case"select":e._wrapperState={wasMultiple:!!h.multiple},g=Wr({},h,{value:void 0}),Dr("invalid",e);break;case"textarea":Fw(e,h),g=vv(e,h),Dr("invalid",e);break;default:g=h}wv(o,g),c=g;for(b in c)if(c.hasOwnProperty(b)){var D=c[b];b==="style"?j2(e,D):b==="dangerouslySetInnerHTML"?(D=D?D.__html:void 0,D!=null&&N2(e,D)):b==="children"?typeof D=="string"?(o!=="textarea"||D!=="")&&Im(e,D):typeof D=="number"&&Im(e,""+D):b!=="suppressContentEditableWarning"&&b!=="suppressHydrationWarning"&&b!=="autoFocus"&&(Cm.hasOwnProperty(b)?D!=null&&b==="onScroll"&&Dr("scroll",e):D!=null&&wx(e,b,D,w))}switch(o){case"input":v_(e),Ow(e,h,!1);break;case"textarea":v_(e),Bw(e);break;case"option":h.value!=null&&e.setAttribute("value",""+Nc(h.value));break;case"select":e.multiple=!!h.multiple,b=h.value,b!=null?Pf(e,!!h.multiple,b,!1):h.defaultValue!=null&&Pf(e,!!h.multiple,h.defaultValue,!0);break;default:typeof g.onClick=="function"&&(e.onclick=o0)}switch(o){case"button":case"input":case"select":case"textarea":h=!!h.autoFocus;break e;case"img":h=!0;break e;default:h=!1}}h&&(r.flags|=4)}r.ref!==null&&(r.flags|=512,r.flags|=2097152)}return Ps(r),null;case 6:if(e&&r.stateNode!=null)c4(e,r,e.memoizedProps,h);else{if(typeof h!="string"&&r.stateNode===null)throw Error(lt(166));if(o=Qh(Bm.current),Qh(Bl.current),k_(r)){if(h=r.stateNode,o=r.memoizedProps,h[Rl]=r,(b=h.nodeValue!==o)&&(e=zo,e!==null))switch(e.tag){case 3:I_(h.nodeValue,o,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&I_(h.nodeValue,o,(e.mode&1)!==0)}b&&(r.flags|=4)}else h=(o.nodeType===9?o:o.ownerDocument).createTextNode(h),h[Rl]=r,r.stateNode=h}return Ps(r),null;case 13:if(Lr(qr),h=r.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Ur&&Ao!==null&&r.mode&1&&!(r.flags&128))k3(),Bf(),r.flags|=98560,b=!1;else if(b=k_(r),h!==null&&h.dehydrated!==null){if(e===null){if(!b)throw Error(lt(318));if(b=r.memoizedState,b=b!==null?b.dehydrated:null,!b)throw Error(lt(317));b[Rl]=r}else Bf(),!(r.flags&128)&&(r.memoizedState=null),r.flags|=4;Ps(r),b=!1}else Wa!==null&&(nx(Wa),Wa=null),b=!0;if(!b)return r.flags&65536?r:null}return r.flags&128?(r.lanes=o,r):(h=h!==null,h!==(e!==null&&e.memoizedState!==null)&&h&&(r.child.flags|=8192,r.mode&1&&(e===null||qr.current&1?Mi===0&&(Mi=3):rw())),r.updateQueue!==null&&(r.flags|=4),Ps(r),null);case 4:return Uf(),Hv(e,r),e===null&&Lm(r.stateNode.containerInfo),Ps(r),null;case 10:return Ux(r.type._context),Ps(r),null;case 17:return ao(r.type)&&a0(),Ps(r),null;case 19:if(Lr(qr),b=r.memoizedState,b===null)return Ps(r),null;if(h=(r.flags&128)!==0,w=b.rendering,w===null)if(h)um(b,!1);else{if(Mi!==0||e!==null&&e.flags&128)for(e=r.child;e!==null;){if(w=p0(e),w!==null){for(r.flags|=128,um(b,!1),h=w.updateQueue,h!==null&&(r.updateQueue=h,r.flags|=4),r.subtreeFlags=0,h=o,o=r.child;o!==null;)b=o,e=h,b.flags&=14680066,w=b.alternate,w===null?(b.childLanes=0,b.lanes=e,b.child=null,b.subtreeFlags=0,b.memoizedProps=null,b.memoizedState=null,b.updateQueue=null,b.dependencies=null,b.stateNode=null):(b.childLanes=w.childLanes,b.lanes=w.lanes,b.child=w.child,b.subtreeFlags=0,b.deletions=null,b.memoizedProps=w.memoizedProps,b.memoizedState=w.memoizedState,b.updateQueue=w.updateQueue,b.type=w.type,e=w.dependencies,b.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),o=o.sibling;return kr(qr,qr.current&1|2),r.child}e=e.sibling}b.tail!==null&&ui()>$f&&(r.flags|=128,h=!0,um(b,!1),r.lanes=4194304)}else{if(!h)if(e=p0(w),e!==null){if(r.flags|=128,h=!0,o=e.updateQueue,o!==null&&(r.updateQueue=o,r.flags|=4),um(b,!0),b.tail===null&&b.tailMode==="hidden"&&!w.alternate&&!Ur)return Ps(r),null}else 2*ui()-b.renderingStartTime>$f&&o!==1073741824&&(r.flags|=128,h=!0,um(b,!1),r.lanes=4194304);b.isBackwards?(w.sibling=r.child,r.child=w):(o=b.last,o!==null?o.sibling=w:r.child=w,b.last=w)}return b.tail!==null?(r=b.tail,b.rendering=r,b.tail=r.sibling,b.renderingStartTime=ui(),r.sibling=null,o=qr.current,kr(qr,h?o&1|2:o&1),r):(Ps(r),null);case 22:case 23:return nw(),h=r.memoizedState!==null,e!==null&&e.memoizedState!==null!==h&&(r.flags|=8192),h&&r.mode&1?Po&1073741824&&(Ps(r),r.subtreeFlags&6&&(r.flags|=8192)):Ps(r),null;case 24:return null;case 25:return null}throw Error(lt(156,r.tag))}function YT(e,r){switch(Ox(r),r.tag){case 1:return ao(r.type)&&a0(),e=r.flags,e&65536?(r.flags=e&-65537|128,r):null;case 3:return Uf(),Lr(oo),Lr(zs),Zx(),e=r.flags,e&65536&&!(e&128)?(r.flags=e&-65537|128,r):null;case 5:return qx(r),null;case 13:if(Lr(qr),e=r.memoizedState,e!==null&&e.dehydrated!==null){if(r.alternate===null)throw Error(lt(340));Bf()}return e=r.flags,e&65536?(r.flags=e&-65537|128,r):null;case 19:return Lr(qr),null;case 4:return Uf(),null;case 10:return Ux(r.type._context),null;case 22:case 23:return nw(),null;case 24:return null;default:return null}}var M_=!1,As=!1,JT=typeof WeakSet=="function"?WeakSet:Set,Dt=null;function If(e,r){var o=e.ref;if(o!==null)if(typeof o=="function")try{o(null)}catch(h){ei(e,r,h)}else o.current=null}function Xv(e,r,o){try{o()}catch(h){ei(e,r,h)}}var Ib=!1;function QT(e,r){if(zv=r0,e=m3(),Lx(e)){if("selectionStart"in e)var o={start:e.selectionStart,end:e.selectionEnd};else e:{o=(o=e.ownerDocument)&&o.defaultView||window;var h=o.getSelection&&o.getSelection();if(h&&h.rangeCount!==0){o=h.anchorNode;var g=h.anchorOffset,b=h.focusNode;h=h.focusOffset;try{o.nodeType,b.nodeType}catch{o=null;break e}var w=0,c=-1,D=-1,j=0,J=0,G=e,q=null;t:for(;;){for(var Ee;G!==o||g!==0&&G.nodeType!==3||(c=w+g),G!==b||h!==0&&G.nodeType!==3||(D=w+h),G.nodeType===3&&(w+=G.nodeValue.length),(Ee=G.firstChild)!==null;)q=G,G=Ee;for(;;){if(G===e)break t;if(q===o&&++j===g&&(c=w),q===b&&++J===h&&(D=w),(Ee=G.nextSibling)!==null)break;G=q,q=G.parentNode}G=Ee}o=c===-1||D===-1?null:{start:c,end:D}}else o=null}o=o||{start:0,end:0}}else o=null;for(Dv={focusedElem:e,selectionRange:o},r0=!1,Dt=r;Dt!==null;)if(r=Dt,e=r.child,(r.subtreeFlags&1028)!==0&&e!==null)e.return=r,Dt=e;else for(;Dt!==null;){r=Dt;try{var Ae=r.alternate;if(r.flags&1024)switch(r.tag){case 0:case 11:case 15:break;case 1:if(Ae!==null){var Fe=Ae.memoizedProps,Ne=Ae.memoizedState,se=r.stateNode,ue=se.getSnapshotBeforeUpdate(r.elementType===r.type?Fe:qa(r.type,Fe),Ne);se.__reactInternalSnapshotBeforeUpdate=ue}break;case 3:var he=r.stateNode.containerInfo;he.nodeType===1?he.textContent="":he.nodeType===9&&he.documentElement&&he.removeChild(he.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(lt(163))}}catch(De){ei(r,r.return,De)}if(e=r.sibling,e!==null){e.return=r.return,Dt=e;break}Dt=r.return}return Ae=Ib,Ib=!1,Ae}function Sm(e,r,o){var h=r.updateQueue;if(h=h!==null?h.lastEffect:null,h!==null){var g=h=h.next;do{if((g.tag&e)===e){var b=g.destroy;g.destroy=void 0,b!==void 0&&Xv(r,o,b)}g=g.next}while(g!==h)}}function G0(e,r){if(r=r.updateQueue,r=r!==null?r.lastEffect:null,r!==null){var o=r=r.next;do{if((o.tag&e)===e){var h=o.create;o.destroy=h()}o=o.next}while(o!==r)}}function Kv(e){var r=e.ref;if(r!==null){var o=e.stateNode;switch(e.tag){case 5:e=o;break;default:e=o}typeof r=="function"?r(e):r.current=e}}function h4(e){var r=e.alternate;r!==null&&(e.alternate=null,h4(r)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(r=e.stateNode,r!==null&&(delete r[Rl],delete r[Om],delete r[Ov],delete r[RT],delete r[OT])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function d4(e){return e.tag===5||e.tag===3||e.tag===4}function kb(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||d4(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Yv(e,r,o){var h=e.tag;if(h===5||h===6)e=e.stateNode,r?o.nodeType===8?o.parentNode.insertBefore(e,r):o.insertBefore(e,r):(o.nodeType===8?(r=o.parentNode,r.insertBefore(e,o)):(r=o,r.appendChild(e)),o=o._reactRootContainer,o!=null||r.onclick!==null||(r.onclick=o0));else if(h!==4&&(e=e.child,e!==null))for(Yv(e,r,o),e=e.sibling;e!==null;)Yv(e,r,o),e=e.sibling}function Jv(e,r,o){var h=e.tag;if(h===5||h===6)e=e.stateNode,r?o.insertBefore(e,r):o.appendChild(e);else if(h!==4&&(e=e.child,e!==null))for(Jv(e,r,o),e=e.sibling;e!==null;)Jv(e,r,o),e=e.sibling}var ns=null,Za=!1;function Sc(e,r,o){for(o=o.child;o!==null;)f4(e,r,o),o=o.sibling}function f4(e,r,o){if(Fl&&typeof Fl.onCommitFiberUnmount=="function")try{Fl.onCommitFiberUnmount(N0,o)}catch{}switch(o.tag){case 5:As||If(o,r);case 6:var h=ns,g=Za;ns=null,Sc(e,r,o),ns=h,Za=g,ns!==null&&(Za?(e=ns,o=o.stateNode,e.nodeType===8?e.parentNode.removeChild(o):e.removeChild(o)):ns.removeChild(o.stateNode));break;case 18:ns!==null&&(Za?(e=ns,o=o.stateNode,e.nodeType===8?B1(e.parentNode,o):e.nodeType===1&&B1(e,o),Mm(e)):B1(ns,o.stateNode));break;case 4:h=ns,g=Za,ns=o.stateNode.containerInfo,Za=!0,Sc(e,r,o),ns=h,Za=g;break;case 0:case 11:case 14:case 15:if(!As&&(h=o.updateQueue,h!==null&&(h=h.lastEffect,h!==null))){g=h=h.next;do{var b=g,w=b.destroy;b=b.tag,w!==void 0&&(b&2||b&4)&&Xv(o,r,w),g=g.next}while(g!==h)}Sc(e,r,o);break;case 1:if(!As&&(If(o,r),h=o.stateNode,typeof h.componentWillUnmount=="function"))try{h.props=o.memoizedProps,h.state=o.memoizedState,h.componentWillUnmount()}catch(c){ei(o,r,c)}Sc(e,r,o);break;case 21:Sc(e,r,o);break;case 22:o.mode&1?(As=(h=As)||o.memoizedState!==null,Sc(e,r,o),As=h):Sc(e,r,o);break;default:Sc(e,r,o)}}function Pb(e){var r=e.updateQueue;if(r!==null){e.updateQueue=null;var o=e.stateNode;o===null&&(o=e.stateNode=new JT),r.forEach(function(h){var g=lE.bind(null,e,h);o.has(h)||(o.add(h),h.then(g,g))})}}function $a(e,r){var o=r.deletions;if(o!==null)for(var h=0;h<o.length;h++){var g=o[h];try{var b=e,w=r,c=w;e:for(;c!==null;){switch(c.tag){case 5:ns=c.stateNode,Za=!1;break e;case 3:ns=c.stateNode.containerInfo,Za=!0;break e;case 4:ns=c.stateNode.containerInfo,Za=!0;break e}c=c.return}if(ns===null)throw Error(lt(160));f4(b,w,g),ns=null,Za=!1;var D=g.alternate;D!==null&&(D.return=null),g.return=null}catch(j){ei(g,r,j)}}if(r.subtreeFlags&12854)for(r=r.child;r!==null;)p4(r,e),r=r.sibling}function p4(e,r){var o=e.alternate,h=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if($a(r,e),zl(e),h&4){try{Sm(3,e,e.return),G0(3,e)}catch(Fe){ei(e,e.return,Fe)}try{Sm(5,e,e.return)}catch(Fe){ei(e,e.return,Fe)}}break;case 1:$a(r,e),zl(e),h&512&&o!==null&&If(o,o.return);break;case 5:if($a(r,e),zl(e),h&512&&o!==null&&If(o,o.return),e.flags&32){var g=e.stateNode;try{Im(g,"")}catch(Fe){ei(e,e.return,Fe)}}if(h&4&&(g=e.stateNode,g!=null)){var b=e.memoizedProps,w=o!==null?o.memoizedProps:b,c=e.type,D=e.updateQueue;if(e.updateQueue=null,D!==null)try{c==="input"&&b.type==="radio"&&b.name!=null&&O2(g,b),bv(c,w);var j=bv(c,b);for(w=0;w<D.length;w+=2){var J=D[w],G=D[w+1];J==="style"?j2(g,G):J==="dangerouslySetInnerHTML"?N2(g,G):J==="children"?Im(g,G):wx(g,J,G,j)}switch(c){case"input":_v(g,b);break;case"textarea":F2(g,b);break;case"select":var q=g._wrapperState.wasMultiple;g._wrapperState.wasMultiple=!!b.multiple;var Ee=b.value;Ee!=null?Pf(g,!!b.multiple,Ee,!1):q!==!!b.multiple&&(b.defaultValue!=null?Pf(g,!!b.multiple,b.defaultValue,!0):Pf(g,!!b.multiple,b.multiple?[]:"",!1))}g[Om]=b}catch(Fe){ei(e,e.return,Fe)}}break;case 6:if($a(r,e),zl(e),h&4){if(e.stateNode===null)throw Error(lt(162));g=e.stateNode,b=e.memoizedProps;try{g.nodeValue=b}catch(Fe){ei(e,e.return,Fe)}}break;case 3:if($a(r,e),zl(e),h&4&&o!==null&&o.memoizedState.isDehydrated)try{Mm(r.containerInfo)}catch(Fe){ei(e,e.return,Fe)}break;case 4:$a(r,e),zl(e);break;case 13:$a(r,e),zl(e),g=e.child,g.flags&8192&&(b=g.memoizedState!==null,g.stateNode.isHidden=b,!b||g.alternate!==null&&g.alternate.memoizedState!==null||(ew=ui())),h&4&&Pb(e);break;case 22:if(J=o!==null&&o.memoizedState!==null,e.mode&1?(As=(j=As)||J,$a(r,e),As=j):$a(r,e),zl(e),h&8192){if(j=e.memoizedState!==null,(e.stateNode.isHidden=j)&&!J&&e.mode&1)for(Dt=e,J=e.child;J!==null;){for(G=Dt=J;Dt!==null;){switch(q=Dt,Ee=q.child,q.tag){case 0:case 11:case 14:case 15:Sm(4,q,q.return);break;case 1:If(q,q.return);var Ae=q.stateNode;if(typeof Ae.componentWillUnmount=="function"){h=q,o=q.return;try{r=h,Ae.props=r.memoizedProps,Ae.state=r.memoizedState,Ae.componentWillUnmount()}catch(Fe){ei(h,o,Fe)}}break;case 5:If(q,q.return);break;case 22:if(q.memoizedState!==null){Mb(G);continue}}Ee!==null?(Ee.return=q,Dt=Ee):Mb(G)}J=J.sibling}e:for(J=null,G=e;;){if(G.tag===5){if(J===null){J=G;try{g=G.stateNode,j?(b=g.style,typeof b.setProperty=="function"?b.setProperty("display","none","important"):b.display="none"):(c=G.stateNode,D=G.memoizedProps.style,w=D!=null&&D.hasOwnProperty("display")?D.display:null,c.style.display=U2("display",w))}catch(Fe){ei(e,e.return,Fe)}}}else if(G.tag===6){if(J===null)try{G.stateNode.nodeValue=j?"":G.memoizedProps}catch(Fe){ei(e,e.return,Fe)}}else if((G.tag!==22&&G.tag!==23||G.memoizedState===null||G===e)&&G.child!==null){G.child.return=G,G=G.child;continue}if(G===e)break e;for(;G.sibling===null;){if(G.return===null||G.return===e)break e;J===G&&(J=null),G=G.return}J===G&&(J=null),G.sibling.return=G.return,G=G.sibling}}break;case 19:$a(r,e),zl(e),h&4&&Pb(e);break;case 21:break;default:$a(r,e),zl(e)}}function zl(e){var r=e.flags;if(r&2){try{e:{for(var o=e.return;o!==null;){if(d4(o)){var h=o;break e}o=o.return}throw Error(lt(160))}switch(h.tag){case 5:var g=h.stateNode;h.flags&32&&(Im(g,""),h.flags&=-33);var b=kb(e);Jv(e,b,g);break;case 3:case 4:var w=h.stateNode.containerInfo,c=kb(e);Yv(e,c,w);break;default:throw Error(lt(161))}}catch(D){ei(e,e.return,D)}e.flags&=-3}r&4096&&(e.flags&=-4097)}function eE(e,r,o){Dt=e,m4(e)}function m4(e,r,o){for(var h=(e.mode&1)!==0;Dt!==null;){var g=Dt,b=g.child;if(g.tag===22&&h){var w=g.memoizedState!==null||M_;if(!w){var c=g.alternate,D=c!==null&&c.memoizedState!==null||As;c=M_;var j=As;if(M_=w,(As=D)&&!j)for(Dt=g;Dt!==null;)w=Dt,D=w.child,w.tag===22&&w.memoizedState!==null?zb(g):D!==null?(D.return=w,Dt=D):zb(g);for(;b!==null;)Dt=b,m4(b),b=b.sibling;Dt=g,M_=c,As=j}Ab(e)}else g.subtreeFlags&8772&&b!==null?(b.return=g,Dt=b):Ab(e)}}function Ab(e){for(;Dt!==null;){var r=Dt;if(r.flags&8772){var o=r.alternate;try{if(r.flags&8772)switch(r.tag){case 0:case 11:case 15:As||G0(5,r);break;case 1:var h=r.stateNode;if(r.flags&4&&!As)if(o===null)h.componentDidMount();else{var g=r.elementType===r.type?o.memoizedProps:qa(r.type,o.memoizedProps);h.componentDidUpdate(g,o.memoizedState,h.__reactInternalSnapshotBeforeUpdate)}var b=r.updateQueue;b!==null&&pb(r,b,h);break;case 3:var w=r.updateQueue;if(w!==null){if(o=null,r.child!==null)switch(r.child.tag){case 5:o=r.child.stateNode;break;case 1:o=r.child.stateNode}pb(r,w,o)}break;case 5:var c=r.stateNode;if(o===null&&r.flags&4){o=c;var D=r.memoizedProps;switch(r.type){case"button":case"input":case"select":case"textarea":D.autoFocus&&o.focus();break;case"img":D.src&&(o.src=D.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(r.memoizedState===null){var j=r.alternate;if(j!==null){var J=j.memoizedState;if(J!==null){var G=J.dehydrated;G!==null&&Mm(G)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(lt(163))}As||r.flags&512&&Kv(r)}catch(q){ei(r,r.return,q)}}if(r===e){Dt=null;break}if(o=r.sibling,o!==null){o.return=r.return,Dt=o;break}Dt=r.return}}function Mb(e){for(;Dt!==null;){var r=Dt;if(r===e){Dt=null;break}var o=r.sibling;if(o!==null){o.return=r.return,Dt=o;break}Dt=r.return}}function zb(e){for(;Dt!==null;){var r=Dt;try{switch(r.tag){case 0:case 11:case 15:var o=r.return;try{G0(4,r)}catch(D){ei(r,o,D)}break;case 1:var h=r.stateNode;if(typeof h.componentDidMount=="function"){var g=r.return;try{h.componentDidMount()}catch(D){ei(r,g,D)}}var b=r.return;try{Kv(r)}catch(D){ei(r,b,D)}break;case 5:var w=r.return;try{Kv(r)}catch(D){ei(r,w,D)}}}catch(D){ei(r,r.return,D)}if(r===e){Dt=null;break}var c=r.sibling;if(c!==null){c.return=r.return,Dt=c;break}Dt=r.return}}var tE=Math.ceil,_0=Fu.ReactCurrentDispatcher,Jx=Fu.ReactCurrentOwner,la=Fu.ReactCurrentBatchConfig,Jn=0,Vi=null,Si=null,is=0,Po=0,kf=Vc(0),Mi=0,$m=null,od=0,H0=0,Qx=0,Tm=null,io=null,ew=0,$f=1/0,Tu=null,y0=!1,Qv=null,Oc=null,z_=!1,Ac=null,v0=0,Em=0,ex=null,H_=-1,X_=0;function Gs(){return Jn&6?ui():H_!==-1?H_:H_=ui()}function Fc(e){return e.mode&1?Jn&2&&is!==0?is&-is:BT.transition!==null?(X_===0&&(X_=Q2()),X_):(e=hr,e!==0||(e=window.event,e=e===void 0?16:o3(e.type)),e):1}function Xa(e,r,o,h){if(50<Em)throw Em=0,ex=null,Error(lt(185));Gm(e,o,h),(!(Jn&2)||e!==Vi)&&(e===Vi&&(!(Jn&2)&&(H0|=o),Mi===4&&kc(e,is)),lo(e,h),o===1&&Jn===0&&!(r.mode&1)&&($f=ui()+500,q0&&qc()))}function lo(e,r){var o=e.callbackNode;B6(e,r);var h=n0(e,e===Vi?is:0);if(h===0)o!==null&&jw(o),e.callbackNode=null,e.callbackPriority=0;else if(r=h&-h,e.callbackPriority!==r){if(o!=null&&jw(o),r===1)e.tag===0?FT(Db.bind(null,e)):E3(Db.bind(null,e)),DT(function(){!(Jn&6)&&qc()}),o=null;else{switch(e3(h)){case 1:o=Cx;break;case 4:o=Y2;break;case 16:o=t0;break;case 536870912:o=J2;break;default:o=t0}o=S4(o,g4.bind(null,e))}e.callbackPriority=r,e.callbackNode=o}}function g4(e,r){if(H_=-1,X_=0,Jn&6)throw Error(lt(327));var o=e.callbackNode;if(Lf()&&e.callbackNode!==o)return null;var h=n0(e,e===Vi?is:0);if(h===0)return null;if(h&30||h&e.expiredLanes||r)r=x0(e,h);else{r=h;var g=Jn;Jn|=2;var b=y4();(Vi!==e||is!==r)&&(Tu=null,$f=ui()+500,ed(e,r));do try{iE();break}catch(c){_4(e,c)}while(!0);Nx(),_0.current=b,Jn=g,Si!==null?r=0:(Vi=null,is=0,r=Mi)}if(r!==0){if(r===2&&(g=Iv(e),g!==0&&(h=g,r=tx(e,g))),r===1)throw o=$m,ed(e,0),kc(e,h),lo(e,ui()),o;if(r===6)kc(e,h);else{if(g=e.current.alternate,!(h&30)&&!nE(g)&&(r=x0(e,h),r===2&&(b=Iv(e),b!==0&&(h=b,r=tx(e,b))),r===1))throw o=$m,ed(e,0),kc(e,h),lo(e,ui()),o;switch(e.finishedWork=g,e.finishedLanes=h,r){case 0:case 1:throw Error(lt(345));case 2:Hh(e,io,Tu);break;case 3:if(kc(e,h),(h&130023424)===h&&(r=ew+500-ui(),10<r)){if(n0(e,0)!==0)break;if(g=e.suspendedLanes,(g&h)!==h){Gs(),e.pingedLanes|=e.suspendedLanes&g;break}e.timeoutHandle=Rv(Hh.bind(null,e,io,Tu),r);break}Hh(e,io,Tu);break;case 4:if(kc(e,h),(h&4194240)===h)break;for(r=e.eventTimes,g=-1;0<h;){var w=31-Ha(h);b=1<<w,w=r[w],w>g&&(g=w),h&=~b}if(h=g,h=ui()-h,h=(120>h?120:480>h?480:1080>h?1080:1920>h?1920:3e3>h?3e3:4320>h?4320:1960*tE(h/1960))-h,10<h){e.timeoutHandle=Rv(Hh.bind(null,e,io,Tu),h);break}Hh(e,io,Tu);break;case 5:Hh(e,io,Tu);break;default:throw Error(lt(329))}}}return lo(e,ui()),e.callbackNode===o?g4.bind(null,e):null}function tx(e,r){var o=Tm;return e.current.memoizedState.isDehydrated&&(ed(e,r).flags|=256),e=x0(e,r),e!==2&&(r=io,io=o,r!==null&&nx(r)),e}function nx(e){io===null?io=e:io.push.apply(io,e)}function nE(e){for(var r=e;;){if(r.flags&16384){var o=r.updateQueue;if(o!==null&&(o=o.stores,o!==null))for(var h=0;h<o.length;h++){var g=o[h],b=g.getSnapshot;g=g.value;try{if(!Ya(b(),g))return!1}catch{return!1}}}if(o=r.child,r.subtreeFlags&16384&&o!==null)o.return=r,r=o;else{if(r===e)break;for(;r.sibling===null;){if(r.return===null||r.return===e)return!0;r=r.return}r.sibling.return=r.return,r=r.sibling}}return!0}function kc(e,r){for(r&=~Qx,r&=~H0,e.suspendedLanes|=r,e.pingedLanes&=~r,e=e.expirationTimes;0<r;){var o=31-Ha(r),h=1<<o;e[o]=-1,r&=~h}}function Db(e){if(Jn&6)throw Error(lt(327));Lf();var r=n0(e,0);if(!(r&1))return lo(e,ui()),null;var o=x0(e,r);if(e.tag!==0&&o===2){var h=Iv(e);h!==0&&(r=h,o=tx(e,h))}if(o===1)throw o=$m,ed(e,0),kc(e,r),lo(e,ui()),o;if(o===6)throw Error(lt(345));return e.finishedWork=e.current.alternate,e.finishedLanes=r,Hh(e,io,Tu),lo(e,ui()),null}function tw(e,r){var o=Jn;Jn|=1;try{return e(r)}finally{Jn=o,Jn===0&&($f=ui()+500,q0&&qc())}}function ad(e){Ac!==null&&Ac.tag===0&&!(Jn&6)&&Lf();var r=Jn;Jn|=1;var o=la.transition,h=hr;try{if(la.transition=null,hr=1,e)return e()}finally{hr=h,la.transition=o,Jn=r,!(Jn&6)&&qc()}}function nw(){Po=kf.current,Lr(kf)}function ed(e,r){e.finishedWork=null,e.finishedLanes=0;var o=e.timeoutHandle;if(o!==-1&&(e.timeoutHandle=-1,zT(o)),Si!==null)for(o=Si.return;o!==null;){var h=o;switch(Ox(h),h.tag){case 1:h=h.type.childContextTypes,h!=null&&a0();break;case 3:Uf(),Lr(oo),Lr(zs),Zx();break;case 5:qx(h);break;case 4:Uf();break;case 13:Lr(qr);break;case 19:Lr(qr);break;case 10:Ux(h.type._context);break;case 22:case 23:nw()}o=o.return}if(Vi=e,Si=e=Bc(e.current,null),is=Po=r,Mi=0,$m=null,Qx=H0=od=0,io=Tm=null,Jh!==null){for(r=0;r<Jh.length;r++)if(o=Jh[r],h=o.interleaved,h!==null){o.interleaved=null;var g=h.next,b=o.pending;if(b!==null){var w=b.next;b.next=g,h.next=w}o.pending=h}Jh=null}return e}function _4(e,r){do{var o=Si;try{if(Nx(),Z_.current=g0,m0){for(var h=Zr.memoizedState;h!==null;){var g=h.queue;g!==null&&(g.pending=null),h=h.next}m0=!1}if(sd=0,$i=Ai=Zr=null,bm=!1,Nm=0,Jx.current=null,o===null||o.return===null){Mi=1,$m=r,Si=null;break}e:{var b=e,w=o.return,c=o,D=r;if(r=is,c.flags|=32768,D!==null&&typeof D=="object"&&typeof D.then=="function"){var j=D,J=c,G=J.tag;if(!(J.mode&1)&&(G===0||G===11||G===15)){var q=J.alternate;q?(J.updateQueue=q.updateQueue,J.memoizedState=q.memoizedState,J.lanes=q.lanes):(J.updateQueue=null,J.memoizedState=null)}var Ee=xb(w);if(Ee!==null){Ee.flags&=-257,wb(Ee,w,c,b,r),Ee.mode&1&&vb(b,j,r),r=Ee,D=j;var Ae=r.updateQueue;if(Ae===null){var Fe=new Set;Fe.add(D),r.updateQueue=Fe}else Ae.add(D);break e}else{if(!(r&1)){vb(b,j,r),rw();break e}D=Error(lt(426))}}else if(Ur&&c.mode&1){var Ne=xb(w);if(Ne!==null){!(Ne.flags&65536)&&(Ne.flags|=256),wb(Ne,w,c,b,r),Fx(jf(D,c));break e}}b=D=jf(D,c),Mi!==4&&(Mi=2),Tm===null?Tm=[b]:Tm.push(b),b=w;do{switch(b.tag){case 3:b.flags|=65536,r&=-r,b.lanes|=r;var se=e4(b,D,r);fb(b,se);break e;case 1:c=D;var ue=b.type,he=b.stateNode;if(!(b.flags&128)&&(typeof ue.getDerivedStateFromError=="function"||he!==null&&typeof he.componentDidCatch=="function"&&(Oc===null||!Oc.has(he)))){b.flags|=65536,r&=-r,b.lanes|=r;var De=t4(b,c,r);fb(b,De);break e}}b=b.return}while(b!==null)}x4(o)}catch(Ze){r=Ze,Si===o&&o!==null&&(Si=o=o.return);continue}break}while(!0)}function y4(){var e=_0.current;return _0.current=g0,e===null?g0:e}function rw(){(Mi===0||Mi===3||Mi===2)&&(Mi=4),Vi===null||!(od&268435455)&&!(H0&268435455)||kc(Vi,is)}function x0(e,r){var o=Jn;Jn|=2;var h=y4();(Vi!==e||is!==r)&&(Tu=null,ed(e,r));do try{rE();break}catch(g){_4(e,g)}while(!0);if(Nx(),Jn=o,_0.current=h,Si!==null)throw Error(lt(261));return Vi=null,is=0,Mi}function rE(){for(;Si!==null;)v4(Si)}function iE(){for(;Si!==null&&!P6();)v4(Si)}function v4(e){var r=b4(e.alternate,e,Po);e.memoizedProps=e.pendingProps,r===null?x4(e):Si=r,Jx.current=null}function x4(e){var r=e;do{var o=r.alternate;if(e=r.return,r.flags&32768){if(o=YT(o,r),o!==null){o.flags&=32767,Si=o;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Mi=6,Si=null;return}}else if(o=KT(o,r,Po),o!==null){Si=o;return}if(r=r.sibling,r!==null){Si=r;return}Si=r=e}while(r!==null);Mi===0&&(Mi=5)}function Hh(e,r,o){var h=hr,g=la.transition;try{la.transition=null,hr=1,sE(e,r,o,h)}finally{la.transition=g,hr=h}return null}function sE(e,r,o,h){do Lf();while(Ac!==null);if(Jn&6)throw Error(lt(327));o=e.finishedWork;var g=e.finishedLanes;if(o===null)return null;if(e.finishedWork=null,e.finishedLanes=0,o===e.current)throw Error(lt(177));e.callbackNode=null,e.callbackPriority=0;var b=o.lanes|o.childLanes;if(N6(e,b),e===Vi&&(Si=Vi=null,is=0),!(o.subtreeFlags&2064)&&!(o.flags&2064)||z_||(z_=!0,S4(t0,function(){return Lf(),null})),b=(o.flags&15990)!==0,o.subtreeFlags&15990||b){b=la.transition,la.transition=null;var w=hr;hr=1;var c=Jn;Jn|=4,Jx.current=null,QT(e,o),p4(o,e),ET(Dv),r0=!!zv,Dv=zv=null,e.current=o,eE(o),A6(),Jn=c,hr=w,la.transition=b}else e.current=o;if(z_&&(z_=!1,Ac=e,v0=g),b=e.pendingLanes,b===0&&(Oc=null),D6(o.stateNode),lo(e,ui()),r!==null)for(h=e.onRecoverableError,o=0;o<r.length;o++)g=r[o],h(g.value,{componentStack:g.stack,digest:g.digest});if(y0)throw y0=!1,e=Qv,Qv=null,e;return v0&1&&e.tag!==0&&Lf(),b=e.pendingLanes,b&1?e===ex?Em++:(Em=0,ex=e):Em=0,qc(),null}function Lf(){if(Ac!==null){var e=e3(v0),r=la.transition,o=hr;try{if(la.transition=null,hr=16>e?16:e,Ac===null)var h=!1;else{if(e=Ac,Ac=null,v0=0,Jn&6)throw Error(lt(331));var g=Jn;for(Jn|=4,Dt=e.current;Dt!==null;){var b=Dt,w=b.child;if(Dt.flags&16){var c=b.deletions;if(c!==null){for(var D=0;D<c.length;D++){var j=c[D];for(Dt=j;Dt!==null;){var J=Dt;switch(J.tag){case 0:case 11:case 15:Sm(8,J,b)}var G=J.child;if(G!==null)G.return=J,Dt=G;else for(;Dt!==null;){J=Dt;var q=J.sibling,Ee=J.return;if(h4(J),J===j){Dt=null;break}if(q!==null){q.return=Ee,Dt=q;break}Dt=Ee}}}var Ae=b.alternate;if(Ae!==null){var Fe=Ae.child;if(Fe!==null){Ae.child=null;do{var Ne=Fe.sibling;Fe.sibling=null,Fe=Ne}while(Fe!==null)}}Dt=b}}if(b.subtreeFlags&2064&&w!==null)w.return=b,Dt=w;else e:for(;Dt!==null;){if(b=Dt,b.flags&2048)switch(b.tag){case 0:case 11:case 15:Sm(9,b,b.return)}var se=b.sibling;if(se!==null){se.return=b.return,Dt=se;break e}Dt=b.return}}var ue=e.current;for(Dt=ue;Dt!==null;){w=Dt;var he=w.child;if(w.subtreeFlags&2064&&he!==null)he.return=w,Dt=he;else e:for(w=ue;Dt!==null;){if(c=Dt,c.flags&2048)try{switch(c.tag){case 0:case 11:case 15:G0(9,c)}}catch(Ze){ei(c,c.return,Ze)}if(c===w){Dt=null;break e}var De=c.sibling;if(De!==null){De.return=c.return,Dt=De;break e}Dt=c.return}}if(Jn=g,qc(),Fl&&typeof Fl.onPostCommitFiberRoot=="function")try{Fl.onPostCommitFiberRoot(N0,e)}catch{}h=!0}return h}finally{hr=o,la.transition=r}}return!1}function Lb(e,r,o){r=jf(o,r),r=e4(e,r,1),e=Rc(e,r,1),r=Gs(),e!==null&&(Gm(e,1,r),lo(e,r))}function ei(e,r,o){if(e.tag===3)Lb(e,e,o);else for(;r!==null;){if(r.tag===3){Lb(r,e,o);break}else if(r.tag===1){var h=r.stateNode;if(typeof r.type.getDerivedStateFromError=="function"||typeof h.componentDidCatch=="function"&&(Oc===null||!Oc.has(h))){e=jf(o,e),e=t4(r,e,1),r=Rc(r,e,1),e=Gs(),r!==null&&(Gm(r,1,e),lo(r,e));break}}r=r.return}}function oE(e,r,o){var h=e.pingCache;h!==null&&h.delete(r),r=Gs(),e.pingedLanes|=e.suspendedLanes&o,Vi===e&&(is&o)===o&&(Mi===4||Mi===3&&(is&130023424)===is&&500>ui()-ew?ed(e,0):Qx|=o),lo(e,r)}function w4(e,r){r===0&&(e.mode&1?(r=b_,b_<<=1,!(b_&130023424)&&(b_=4194304)):r=1);var o=Gs();e=Lu(e,r),e!==null&&(Gm(e,r,o),lo(e,o))}function aE(e){var r=e.memoizedState,o=0;r!==null&&(o=r.retryLane),w4(e,o)}function lE(e,r){var o=0;switch(e.tag){case 13:var h=e.stateNode,g=e.memoizedState;g!==null&&(o=g.retryLane);break;case 19:h=e.stateNode;break;default:throw Error(lt(314))}h!==null&&h.delete(r),w4(e,o)}var b4;b4=function(e,r,o){if(e!==null)if(e.memoizedProps!==r.pendingProps||oo.current)so=!0;else{if(!(e.lanes&o)&&!(r.flags&128))return so=!1,XT(e,r,o);so=!!(e.flags&131072)}else so=!1,Ur&&r.flags&1048576&&C3(r,c0,r.index);switch(r.lanes=0,r.tag){case 2:var h=r.type;G_(e,r),e=r.pendingProps;var g=Ff(r,zs.current);Df(r,o),g=Gx(null,r,h,e,g,o);var b=Hx();return r.flags|=1,typeof g=="object"&&g!==null&&typeof g.render=="function"&&g.$$typeof===void 0?(r.tag=1,r.memoizedState=null,r.updateQueue=null,ao(h)?(b=!0,l0(r)):b=!1,r.memoizedState=g.state!==null&&g.state!==void 0?g.state:null,$x(r),g.updater=W0,r.stateNode=g,g._reactInternals=r,$v(r,h,e,o),r=Zv(null,r,h,!0,b,o)):(r.tag=0,Ur&&b&&Rx(r),Ws(null,r,g,o),r=r.child),r;case 16:h=r.elementType;e:{switch(G_(e,r),e=r.pendingProps,g=h._init,h=g(h._payload),r.type=h,g=r.tag=cE(h),e=qa(h,e),g){case 0:r=qv(null,r,h,e,o);break e;case 1:r=Tb(null,r,h,e,o);break e;case 11:r=bb(null,r,h,e,o);break e;case 14:r=Sb(null,r,h,qa(h.type,e),o);break e}throw Error(lt(306,h,""))}return r;case 0:return h=r.type,g=r.pendingProps,g=r.elementType===h?g:qa(h,g),qv(e,r,h,g,o);case 1:return h=r.type,g=r.pendingProps,g=r.elementType===h?g:qa(h,g),Tb(e,r,h,g,o);case 3:e:{if(s4(r),e===null)throw Error(lt(387));h=r.pendingProps,b=r.memoizedState,g=b.element,z3(e,r),f0(r,h,null,o);var w=r.memoizedState;if(h=w.element,b.isDehydrated)if(b={element:h,isDehydrated:!1,cache:w.cache,pendingSuspenseBoundaries:w.pendingSuspenseBoundaries,transitions:w.transitions},r.updateQueue.baseState=b,r.memoizedState=b,r.flags&256){g=jf(Error(lt(423)),r),r=Eb(e,r,h,o,g);break e}else if(h!==g){g=jf(Error(lt(424)),r),r=Eb(e,r,h,o,g);break e}else for(Ao=Lc(r.stateNode.containerInfo.firstChild),zo=r,Ur=!0,Wa=null,o=A3(r,null,h,o),r.child=o;o;)o.flags=o.flags&-3|4096,o=o.sibling;else{if(Bf(),h===g){r=Ru(e,r,o);break e}Ws(e,r,h,o)}r=r.child}return r;case 5:return D3(r),e===null&&Nv(r),h=r.type,g=r.pendingProps,b=e!==null?e.memoizedProps:null,w=g.children,Lv(h,g)?w=null:b!==null&&Lv(h,b)&&(r.flags|=32),i4(e,r),Ws(e,r,w,o),r.child;case 6:return e===null&&Nv(r),null;case 13:return o4(e,r,o);case 4:return Vx(r,r.stateNode.containerInfo),h=r.pendingProps,e===null?r.child=Nf(r,null,h,o):Ws(e,r,h,o),r.child;case 11:return h=r.type,g=r.pendingProps,g=r.elementType===h?g:qa(h,g),bb(e,r,h,g,o);case 7:return Ws(e,r,r.pendingProps,o),r.child;case 8:return Ws(e,r,r.pendingProps.children,o),r.child;case 12:return Ws(e,r,r.pendingProps.children,o),r.child;case 10:e:{if(h=r.type._context,g=r.pendingProps,b=r.memoizedProps,w=g.value,kr(h0,h._currentValue),h._currentValue=w,b!==null)if(Ya(b.value,w)){if(b.children===g.children&&!oo.current){r=Ru(e,r,o);break e}}else for(b=r.child,b!==null&&(b.return=r);b!==null;){var c=b.dependencies;if(c!==null){w=b.child;for(var D=c.firstContext;D!==null;){if(D.context===h){if(b.tag===1){D=Au(-1,o&-o),D.tag=2;var j=b.updateQueue;if(j!==null){j=j.shared;var J=j.pending;J===null?D.next=D:(D.next=J.next,J.next=D),j.pending=D}}b.lanes|=o,D=b.alternate,D!==null&&(D.lanes|=o),Uv(b.return,o,r),c.lanes|=o;break}D=D.next}}else if(b.tag===10)w=b.type===r.type?null:b.child;else if(b.tag===18){if(w=b.return,w===null)throw Error(lt(341));w.lanes|=o,c=w.alternate,c!==null&&(c.lanes|=o),Uv(w,o,r),w=b.sibling}else w=b.child;if(w!==null)w.return=b;else for(w=b;w!==null;){if(w===r){w=null;break}if(b=w.sibling,b!==null){b.return=w.return,w=b;break}w=w.return}b=w}Ws(e,r,g.children,o),r=r.child}return r;case 9:return g=r.type,h=r.pendingProps.children,Df(r,o),g=ca(g),h=h(g),r.flags|=1,Ws(e,r,h,o),r.child;case 14:return h=r.type,g=qa(h,r.pendingProps),g=qa(h.type,g),Sb(e,r,h,g,o);case 15:return n4(e,r,r.type,r.pendingProps,o);case 17:return h=r.type,g=r.pendingProps,g=r.elementType===h?g:qa(h,g),G_(e,r),r.tag=1,ao(h)?(e=!0,l0(r)):e=!1,Df(r,o),Q3(r,h,g),$v(r,h,g,o),Zv(null,r,h,!0,e,o);case 19:return a4(e,r,o);case 22:return r4(e,r,o)}throw Error(lt(156,r.tag))};function S4(e,r){return K2(e,r)}function uE(e,r,o,h){this.tag=e,this.key=o,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=r,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=h,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function aa(e,r,o,h){return new uE(e,r,o,h)}function iw(e){return e=e.prototype,!(!e||!e.isReactComponent)}function cE(e){if(typeof e=="function")return iw(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Sx)return 11;if(e===Tx)return 14}return 2}function Bc(e,r){var o=e.alternate;return o===null?(o=aa(e.tag,r,e.key,e.mode),o.elementType=e.elementType,o.type=e.type,o.stateNode=e.stateNode,o.alternate=e,e.alternate=o):(o.pendingProps=r,o.type=e.type,o.flags=0,o.subtreeFlags=0,o.deletions=null),o.flags=e.flags&14680064,o.childLanes=e.childLanes,o.lanes=e.lanes,o.child=e.child,o.memoizedProps=e.memoizedProps,o.memoizedState=e.memoizedState,o.updateQueue=e.updateQueue,r=e.dependencies,o.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext},o.sibling=e.sibling,o.index=e.index,o.ref=e.ref,o}function K_(e,r,o,h,g,b){var w=2;if(h=e,typeof e=="function")iw(e)&&(w=1);else if(typeof e=="string")w=5;else e:switch(e){case yf:return td(o.children,g,b,r);case bx:w=8,g|=8;break;case dv:return e=aa(12,o,r,g|2),e.elementType=dv,e.lanes=b,e;case fv:return e=aa(13,o,r,g),e.elementType=fv,e.lanes=b,e;case pv:return e=aa(19,o,r,g),e.elementType=pv,e.lanes=b,e;case D2:return X0(o,g,b,r);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case M2:w=10;break e;case z2:w=9;break e;case Sx:w=11;break e;case Tx:w=14;break e;case Ec:w=16,h=null;break e}throw Error(lt(130,e==null?e:typeof e,""))}return r=aa(w,o,r,g),r.elementType=e,r.type=h,r.lanes=b,r}function td(e,r,o,h){return e=aa(7,e,h,r),e.lanes=o,e}function X0(e,r,o,h){return e=aa(22,e,h,r),e.elementType=D2,e.lanes=o,e.stateNode={isHidden:!1},e}function W1(e,r,o){return e=aa(6,e,null,r),e.lanes=o,e}function G1(e,r,o){return r=aa(4,e.children!==null?e.children:[],e.key,r),r.lanes=o,r.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},r}function hE(e,r,o,h,g){this.tag=r,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=I1(0),this.expirationTimes=I1(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=I1(0),this.identifierPrefix=h,this.onRecoverableError=g,this.mutableSourceEagerHydrationData=null}function sw(e,r,o,h,g,b,w,c,D){return e=new hE(e,r,o,c,D),r===1?(r=1,b===!0&&(r|=8)):r=0,b=aa(3,null,null,r),e.current=b,b.stateNode=e,b.memoizedState={element:h,isDehydrated:o,cache:null,transitions:null,pendingSuspenseBoundaries:null},$x(b),e}function dE(e,r,o){var h=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:_f,key:h==null?null:""+h,children:e,containerInfo:r,implementation:o}}function T4(e){if(!e)return Uc;e=e._reactInternals;e:{if(dd(e)!==e||e.tag!==1)throw Error(lt(170));var r=e;do{switch(r.tag){case 3:r=r.stateNode.context;break e;case 1:if(ao(r.type)){r=r.stateNode.__reactInternalMemoizedMergedChildContext;break e}}r=r.return}while(r!==null);throw Error(lt(171))}if(e.tag===1){var o=e.type;if(ao(o))return T3(e,o,r)}return r}function E4(e,r,o,h,g,b,w,c,D){return e=sw(o,h,!0,e,g,b,w,c,D),e.context=T4(null),o=e.current,h=Gs(),g=Fc(o),b=Au(h,g),b.callback=r??null,Rc(o,b,g),e.current.lanes=g,Gm(e,g,h),lo(e,h),e}function K0(e,r,o,h){var g=r.current,b=Gs(),w=Fc(g);return o=T4(o),r.context===null?r.context=o:r.pendingContext=o,r=Au(b,w),r.payload={element:e},h=h===void 0?null:h,h!==null&&(r.callback=h),e=Rc(g,r,w),e!==null&&(Xa(e,g,w,b),q_(e,g,w)),w}function w0(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function Rb(e,r){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var o=e.retryLane;e.retryLane=o!==0&&o<r?o:r}}function ow(e,r){Rb(e,r),(e=e.alternate)&&Rb(e,r)}function fE(){return null}var C4=typeof reportError=="function"?reportError:function(e){console.error(e)};function aw(e){this._internalRoot=e}Y0.prototype.render=aw.prototype.render=function(e){var r=this._internalRoot;if(r===null)throw Error(lt(409));K0(e,r,null,null)};Y0.prototype.unmount=aw.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var r=e.containerInfo;ad(function(){K0(null,e,null,null)}),r[Du]=null}};function Y0(e){this._internalRoot=e}Y0.prototype.unstable_scheduleHydration=function(e){if(e){var r=r3();e={blockedOn:null,target:e,priority:r};for(var o=0;o<Ic.length&&r!==0&&r<Ic[o].priority;o++);Ic.splice(o,0,e),o===0&&s3(e)}};function lw(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function J0(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function Ob(){}function pE(e,r,o,h,g){if(g){if(typeof h=="function"){var b=h;h=function(){var j=w0(w);b.call(j)}}var w=E4(r,h,e,0,null,!1,!1,"",Ob);return e._reactRootContainer=w,e[Du]=w.current,Lm(e.nodeType===8?e.parentNode:e),ad(),w}for(;g=e.lastChild;)e.removeChild(g);if(typeof h=="function"){var c=h;h=function(){var j=w0(D);c.call(j)}}var D=sw(e,0,!1,null,null,!1,!1,"",Ob);return e._reactRootContainer=D,e[Du]=D.current,Lm(e.nodeType===8?e.parentNode:e),ad(function(){K0(r,D,o,h)}),D}function Q0(e,r,o,h,g){var b=o._reactRootContainer;if(b){var w=b;if(typeof g=="function"){var c=g;g=function(){var D=w0(w);c.call(D)}}K0(r,w,e,g)}else w=pE(o,r,e,g,h);return w0(w)}t3=function(e){switch(e.tag){case 3:var r=e.stateNode;if(r.current.memoizedState.isDehydrated){var o=pm(r.pendingLanes);o!==0&&(Ix(r,o|1),lo(r,ui()),!(Jn&6)&&($f=ui()+500,qc()))}break;case 13:ad(function(){var h=Lu(e,1);if(h!==null){var g=Gs();Xa(h,e,1,g)}}),ow(e,1)}};kx=function(e){if(e.tag===13){var r=Lu(e,134217728);if(r!==null){var o=Gs();Xa(r,e,134217728,o)}ow(e,134217728)}};n3=function(e){if(e.tag===13){var r=Fc(e),o=Lu(e,r);if(o!==null){var h=Gs();Xa(o,e,r,h)}ow(e,r)}};r3=function(){return hr};i3=function(e,r){var o=hr;try{return hr=e,r()}finally{hr=o}};Tv=function(e,r,o){switch(r){case"input":if(_v(e,o),r=o.name,o.type==="radio"&&r!=null){for(o=e;o.parentNode;)o=o.parentNode;for(o=o.querySelectorAll("input[name="+JSON.stringify(""+r)+'][type="radio"]'),r=0;r<o.length;r++){var h=o[r];if(h!==e&&h.form===e.form){var g=V0(h);if(!g)throw Error(lt(90));R2(h),_v(h,g)}}}break;case"textarea":F2(e,o);break;case"select":r=o.value,r!=null&&Pf(e,!!o.multiple,r,!1)}};q2=tw;Z2=ad;var mE={usingClientEntryPoint:!1,Events:[Xm,bf,V0,$2,V2,tw]},cm={findFiberByHostInstance:Yh,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},gE={bundleType:cm.bundleType,version:cm.version,rendererPackageName:cm.rendererPackageName,rendererConfig:cm.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Fu.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=H2(e),e===null?null:e.stateNode},findFiberByHostInstance:cm.findFiberByHostInstance||fE,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var D_=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!D_.isDisabled&&D_.supportsFiber)try{N0=D_.inject(gE),Fl=D_}catch{}}Oo.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=mE;Oo.createPortal=function(e,r){var o=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!lw(r))throw Error(lt(200));return dE(e,r,null,o)};Oo.createRoot=function(e,r){if(!lw(e))throw Error(lt(299));var o=!1,h="",g=C4;return r!=null&&(r.unstable_strictMode===!0&&(o=!0),r.identifierPrefix!==void 0&&(h=r.identifierPrefix),r.onRecoverableError!==void 0&&(g=r.onRecoverableError)),r=sw(e,1,!1,null,null,o,!1,h,g),e[Du]=r.current,Lm(e.nodeType===8?e.parentNode:e),new aw(r)};Oo.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var r=e._reactInternals;if(r===void 0)throw typeof e.render=="function"?Error(lt(188)):(e=Object.keys(e).join(","),Error(lt(268,e)));return e=H2(r),e=e===null?null:e.stateNode,e};Oo.flushSync=function(e){return ad(e)};Oo.hydrate=function(e,r,o){if(!J0(r))throw Error(lt(200));return Q0(null,e,r,!0,o)};Oo.hydrateRoot=function(e,r,o){if(!lw(e))throw Error(lt(405));var h=o!=null&&o.hydratedSources||null,g=!1,b="",w=C4;if(o!=null&&(o.unstable_strictMode===!0&&(g=!0),o.identifierPrefix!==void 0&&(b=o.identifierPrefix),o.onRecoverableError!==void 0&&(w=o.onRecoverableError)),r=E4(r,null,e,1,o??null,g,!1,b,w),e[Du]=r.current,Lm(e),h)for(e=0;e<h.length;e++)o=h[e],g=o._getVersion,g=g(o._source),r.mutableSourceEagerHydrationData==null?r.mutableSourceEagerHydrationData=[o,g]:r.mutableSourceEagerHydrationData.push(o,g);return new Y0(r)};Oo.render=function(e,r,o){if(!J0(r))throw Error(lt(200));return Q0(null,e,r,!1,o)};Oo.unmountComponentAtNode=function(e){if(!J0(e))throw Error(lt(40));return e._reactRootContainer?(ad(function(){Q0(null,null,e,!1,function(){e._reactRootContainer=null,e[Du]=null})}),!0):!1};Oo.unstable_batchedUpdates=tw;Oo.unstable_renderSubtreeIntoContainer=function(e,r,o,h){if(!J0(o))throw Error(lt(200));if(e==null||e._reactInternals===void 0)throw Error(lt(38));return Q0(e,r,o,!1,h)};Oo.version="18.3.1-next-f1338f8080-20240426";function I4(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(I4)}catch(e){console.error(e)}}I4(),I2.exports=Oo;var _E=I2.exports,Fb=_E;cv.createRoot=Fb.createRoot,cv.hydrateRoot=Fb.hydrateRoot;var k4={exports:{}},P4={};/**
 * @license React
 * use-sync-external-store-with-selector.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ym=Bt;function yE(e,r){return e===r&&(e!==0||1/e===1/r)||e!==e&&r!==r}var vE=typeof Object.is=="function"?Object.is:yE,xE=Ym.useSyncExternalStore,wE=Ym.useRef,bE=Ym.useEffect,SE=Ym.useMemo,TE=Ym.useDebugValue;P4.useSyncExternalStoreWithSelector=function(e,r,o,h,g){var b=wE(null);if(b.current===null){var w={hasValue:!1,value:null};b.current=w}else w=b.current;b=SE(function(){function D(Ee){if(!j){if(j=!0,J=Ee,Ee=h(Ee),g!==void 0&&w.hasValue){var Ae=w.value;if(g(Ae,Ee))return G=Ae}return G=Ee}if(Ae=G,vE(J,Ee))return Ae;var Fe=h(Ee);return g!==void 0&&g(Ae,Fe)?Ae:(J=Ee,G=Fe)}var j=!1,J,G,q=o===void 0?null:o;return[function(){return D(r())},q===null?void 0:function(){return D(q())}]},[r,o,h,g]);var c=xE(e,b[0],b[1]);return bE(function(){w.hasValue=!0,w.value=c},[c]),TE(c),c};k4.exports=P4;var EE=k4.exports,Mo="default"in Mw?Ol:Mw,Bb=Symbol.for("react-redux-context"),Nb=typeof globalThis<"u"?globalThis:{};function CE(){if(!Mo.createContext)return{};const e=Nb[Bb]??(Nb[Bb]=new Map);let r=e.get(Mo.createContext);return r||(r=Mo.createContext(null),e.set(Mo.createContext,r)),r}var jc=CE(),IE=()=>{throw new Error("uSES not initialized!")};function uw(e=jc){return function(){return Mo.useContext(e)}}var A4=uw(),M4=IE,kE=e=>{M4=e},PE=(e,r)=>e===r;function AE(e=jc){const r=e===jc?A4:uw(e),o=(h,g={})=>{const{equalityFn:b=PE,devModeChecks:w={}}=typeof g=="function"?{equalityFn:g}:g,{store:c,subscription:D,getServerState:j,stabilityCheck:J,identityFunctionCheck:G}=r();Mo.useRef(!0);const q=Mo.useCallback({[h.name](Ae){return h(Ae)}}[h.name],[h,J,w.stabilityCheck]),Ee=M4(D.addNestedSub,c.getState,j||c.getState,q,b);return Mo.useDebugValue(Ee),Ee};return Object.assign(o,{withTypes:()=>o}),o}var ss=AE();function ME(e){e()}function zE(){let e=null,r=null;return{clear(){e=null,r=null},notify(){ME(()=>{let o=e;for(;o;)o.callback(),o=o.next})},get(){const o=[];let h=e;for(;h;)o.push(h),h=h.next;return o},subscribe(o){let h=!0;const g=r={callback:o,next:null,prev:r};return g.prev?g.prev.next=g:e=g,function(){!h||e===null||(h=!1,g.next?g.next.prev=g.prev:r=g.prev,g.prev?g.prev.next=g.next:e=g.next)}}}}var Ub={notify(){},get:()=>[]};function DE(e,r){let o,h=Ub,g=0,b=!1;function w(Fe){J();const Ne=h.subscribe(Fe);let se=!1;return()=>{se||(se=!0,Ne(),G())}}function c(){h.notify()}function D(){Ae.onStateChange&&Ae.onStateChange()}function j(){return b}function J(){g++,o||(o=e.subscribe(D),h=zE())}function G(){g--,o&&g===0&&(o(),o=void 0,h.clear(),h=Ub)}function q(){b||(b=!0,J())}function Ee(){b&&(b=!1,G())}const Ae={addNestedSub:w,notifyNestedSubs:c,handleChangeWrapper:D,isSubscribed:j,trySubscribe:q,tryUnsubscribe:Ee,getListeners:()=>h};return Ae}var LE=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",RE=typeof navigator<"u"&&navigator.product==="ReactNative",OE=LE||RE?Mo.useLayoutEffect:Mo.useEffect;function FE({store:e,context:r,children:o,serverState:h,stabilityCheck:g="once",identityFunctionCheck:b="once"}){const w=Mo.useMemo(()=>{const j=DE(e);return{store:e,subscription:j,getServerState:h?()=>h:void 0,stabilityCheck:g,identityFunctionCheck:b}},[e,h,g,b]),c=Mo.useMemo(()=>e.getState(),[e]);OE(()=>{const{subscription:j}=w;return j.onStateChange=j.notifyNestedSubs,j.trySubscribe(),c!==e.getState()&&j.notifyNestedSubs(),()=>{j.tryUnsubscribe(),j.onStateChange=void 0}},[w,c]);const D=r||jc;return Mo.createElement(D.Provider,{value:w},o)}var BE=FE;function z4(e=jc){const r=e===jc?A4:uw(e),o=()=>{const{store:h}=r();return h};return Object.assign(o,{withTypes:()=>o}),o}var NE=z4();function UE(e=jc){const r=e===jc?NE:z4(e),o=()=>r().dispatch;return Object.assign(o,{withTypes:()=>o}),o}var Jm=UE();kE(EE.useSyncExternalStoreWithSelector);const jE="modulepreload",$E=function(e){return"/"+e},jb={},rx=function(r,o,h){let g=Promise.resolve();if(o&&o.length>0){document.getElementsByTagName("link");const w=document.querySelector("meta[property=csp-nonce]"),c=(w==null?void 0:w.nonce)||(w==null?void 0:w.getAttribute("nonce"));g=Promise.allSettled(o.map(D=>{if(D=$E(D),D in jb)return;jb[D]=!0;const j=D.endsWith(".css"),J=j?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${D}"]${J}`))return;const G=document.createElement("link");if(G.rel=j?"stylesheet":jE,j||(G.as="script"),G.crossOrigin="",G.href=D,c&&G.setAttribute("nonce",c),document.head.appendChild(G),j)return new Promise((q,Ee)=>{G.addEventListener("load",q),G.addEventListener("error",()=>Ee(new Error(`Unable to preload CSS for ${D}`)))})}))}function b(w){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=w,window.dispatchEvent(c),!c.defaultPrevented)throw w}return g.then(w=>{for(const c of w||[])c.status==="rejected"&&b(c.reason);return r().catch(b)})},VE=rx(()=>import("./country-borders-P9p-TcxA.js"),[]),b0={USA:rx(()=>import("./state-borders-usa-_8J44aaB.js"),[]),CAN:rx(()=>import("./state-borders-can-CwVHHxpH.js"),[])},cw=async()=>(await VE).default,ld=e=>e in b0,D4=async e=>{if(!(e in b0))throw Error(`Could not find state data for country ${e}`);return(await b0[e]).default};function qE(e,r){var o=0,h=0,g=0,b=0,w=0,c=0,D=0,j=0,J=null,G=null,q=e[0],Ee=e[1],Ae=r.length;for(o;o<Ae;o++){h=0;var Fe=r[o].length-1,Ne=r[o];if(J=Ne[0],J[0]!==Ne[Fe][0]&&J[1]!==Ne[Fe][1])throw new Error("First and last coordinates in a ring must be the same");for(w=J[0]-q,c=J[1]-Ee,h;h<Fe;h++){if(G=Ne[h+1],j=G[1]-Ee,c<0&&j<0||c>0&&j>0){J=G,c=j,w=J[0]-q;continue}if(D=G[0]-e[0],j>0&&c<=0){if(b=w*j-D*c,b>0)g=g+1;else if(b===0)return 0}else if(c>0&&j<=0){if(b=w*j-D*c,b<0)g=g+1;else if(b===0)return 0}else if(j===0&&c<0){if(b=w*j-D*c,b===0)return 0}else if(c===0&&j<0){if(b=w*j-D*c,b===0)return 0}else if(c===0&&j===0){if(D<=0&&w>=0)return 0;if(w<=0&&D>=0)return 0}J=G,c=j,w=D}}return g%2!==0}function ZE(e){if(!e)throw new Error("coord is required");if(!Array.isArray(e)){if(e.type==="Feature"&&e.geometry!==null&&e.geometry.type==="Point")return[...e.geometry.coordinates];if(e.type==="Point")return[...e.coordinates]}if(Array.isArray(e)&&e.length>=2&&!Array.isArray(e[0])&&!Array.isArray(e[1]))return[...e];throw new Error("coord must be GeoJSON Point or an Array of numbers")}function WE(e){return e.type==="Feature"?e.geometry:e}function GE(e,r,o={}){if(!e)throw new Error("point is required");if(!r)throw new Error("polygon is required");const h=ZE(e),g=WE(r),b=g.type,w=r.bbox;let c=g.coordinates;if(w&&HE(h,w)===!1)return!1;b==="Polygon"&&(c=[c]);let D=!1;for(var j=0;j<c.length;++j){const J=qE(h,c[j]);if(J===0)return!o.ignoreBoundary;J&&(D=!0)}return D}function HE(e,r){return r[0]<=e[0]&&r[1]<=e[1]&&r[2]>=e[0]&&r[3]>=e[1]}var XE=GE;const L4=async(e,r)=>{e=O4(e);const o=await cw();for(let h=0;h<o.length;h++){const g=o[h];if(F4(e,r,g.bbox,g.geojson))return await YE(g)}return null},R4=async(e,r,o)=>{e=O4(e);for(let h=0;h<o.length;h++){const g=o[h];if(F4(e,r,g.bbox,g.geojson))return g}return null},O4=e=>{for(;e>180;)e-=360;for(;e<-180;)e+=360;return e},F4=(e,r,o,h)=>KE(e,r,o)?XE([e,r],h):!1,KE=(e,r,o)=>{const h=o[0],g=o[1],b=o[2],w=o[3];return e>=h&&e<=b&&r>=g&&r<=w},YE=async e=>{let r=null;return ld(e.codeIso3)&&(r=await D4(e.codeIso3)),{...e,statesData:r}},JE="_container_ppg42_1",QE={container:JE},B4=({children:e,style:r,className:o})=>ft.jsx("div",{style:r,className:`${QE.container} ${o??""}`,children:e});var S0={exports:{}};/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */S0.exports;(function(e,r){(function(){var o,h="4.17.21",g=200,b="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",w="Expected a function",c="Invalid `variable` option passed into `_.template`",D="__lodash_hash_undefined__",j=500,J="__lodash_placeholder__",G=1,q=2,Ee=4,Ae=1,Fe=2,Ne=1,se=2,ue=4,he=8,De=16,Ze=32,je=64,ve=128,ee=256,de=512,Te=30,Ue="...",Xe=800,mt=16,Kt=1,qn=2,Qn=3,zt=1/0,Je=9007199254740991,nt=17976931348623157e292,Et=NaN,ct=4294967295,It=ct-1,St=ct>>>1,Sn=[["ary",ve],["bind",Ne],["bindKey",se],["curry",he],["curryRight",De],["flip",de],["partial",Ze],["partialRight",je],["rearg",ee]],cn="[object Arguments]",Cn="[object Array]",Nn="[object AsyncFunction]",Zt="[object Boolean]",rn="[object Date]",Zn="[object DOMException]",Qt="[object Error]",wn="[object Function]",er="[object GeneratorFunction]",sn="[object Map]",dn="[object Number]",Ce="[object Null]",Fn="[object Object]",bn="[object Promise]",Rt="[object Proxy]",Yt="[object RegExp]",Tr="[object Set]",yr="[object String]",Gr="[object Symbol]",vr="[object Undefined]",rr="[object WeakMap]",dr="[object WeakSet]",fr="[object ArrayBuffer]",Ke="[object DataView]",ci="[object Float32Array]",Rr="[object Float64Array]",jr="[object Int8Array]",Pr="[object Int16Array]",rt="[object Int32Array]",Ht="[object Uint8Array]",Ut="[object Uint8ClampedArray]",hi="[object Uint16Array]",qi="[object Uint32Array]",Xt=/\b__p \+= '';/g,Ks=/\b(__p \+=) '' \+/g,uo=/(__e\(.*?\)|\b__t\)) \+\n'';/g,co=/&(?:amp|lt|gt|quot|#39);/g,Ds=/[&<>"']/g,ae=RegExp(co.source),N=RegExp(Ds.source),B=/<%-([\s\S]+?)%>/g,K=/<%([\s\S]+?)%>/g,re=/<%=([\s\S]+?)%>/g,ye=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Se=/^\w*$/,ke=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,pe=/[\\^$.*+?()[\]{}|]/g,Be=RegExp(pe.source),We=/^\s+/,Le=/\s/,it=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Mt=/\{\n\/\* \[wrapped with (.+)\] \*/,Lt=/,? & /,In=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Jt=/[()=,{}\[\]\/\s]/,kn=/\\(\\)?/g,fn=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Ar=/\w*$/,xr=/^[-+]0x[0-9a-f]+$/i,on=/^0b[01]+$/i,Wn=/^\[object .+?Constructor\]$/,ur=/^0o[0-7]+$/i,Hr=/^(?:0|[1-9]\d*)$/,ti=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Xr=/($^)/,Qa=/['\n\r\u2028\u2029\\]/g,Ln="\\ud800-\\udfff",Gc="\\u0300-\\u036f",Hc="\\ufe20-\\ufe2f",Zi="\\u20d0-\\u20ff",zi=Gc+Hc+Zi,fd="\\u2700-\\u27bf",Wi="a-z\\xdf-\\xf6\\xf8-\\xff",Gi="\\xac\\xb1\\xd7\\xf7",el="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",fa="\\u2000-\\u206f",Or=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",tl="A-Z\\xc0-\\xd6\\xd8-\\xde",as="\\ufe0e\\ufe0f",Er=Gi+el+fa+Or,nl="[']",Ls="["+Ln+"]",Bu="["+Er+"]",Di="["+zi+"]",pd="\\d+",Nu="["+fd+"]",Bo="["+Wi+"]",ho="[^"+Ln+Er+pd+fd+Wi+tl+"]",Pn="\\ud83c[\\udffb-\\udfff]",Xc="(?:"+Di+"|"+Pn+")",Uu="[^"+Ln+"]",No="(?:\\ud83c[\\udde6-\\uddff]){2}",$l="[\\ud800-\\udbff][\\udc00-\\udfff]",fo="["+tl+"]",rl="\\u200d",Vl="(?:"+Bo+"|"+ho+")",il="(?:"+fo+"|"+ho+")",Kc="(?:"+nl+"(?:d|ll|m|re|s|t|ve))?",md="(?:"+nl+"(?:D|LL|M|RE|S|T|VE))?",Yc=Xc+"?",gd="["+as+"]?",pa="(?:"+rl+"(?:"+[Uu,No,$l].join("|")+")"+gd+Yc+")*",ql="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Li="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",Ti=gd+Yc+pa,ju="(?:"+[Nu,No,$l].join("|")+")"+Ti,$u="(?:"+[Uu+Di+"?",Di,No,$l,Ls].join("|")+")",Vu=RegExp(nl,"g"),_d=RegExp(Di,"g"),Uo=RegExp(Pn+"(?="+Pn+")|"+$u+Ti,"g"),tp=RegExp([fo+"?"+Bo+"+"+Kc+"(?="+[Bu,fo,"$"].join("|")+")",il+"+"+md+"(?="+[Bu,fo+Vl,"$"].join("|")+")",fo+"?"+Vl+"+"+Kc,fo+"+"+md,Li,ql,pd,ju].join("|"),"g"),yd=RegExp("["+rl+Ln+zi+as+"]"),vd=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,np=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],rp=-1,or={};or[ci]=or[Rr]=or[jr]=or[Pr]=or[rt]=or[Ht]=or[Ut]=or[hi]=or[qi]=!0,or[cn]=or[Cn]=or[fr]=or[Zt]=or[Ke]=or[rn]=or[Qt]=or[wn]=or[sn]=or[dn]=or[Fn]=or[Yt]=or[Tr]=or[yr]=or[rr]=!1;var Gn={};Gn[cn]=Gn[Cn]=Gn[fr]=Gn[Ke]=Gn[Zt]=Gn[rn]=Gn[ci]=Gn[Rr]=Gn[jr]=Gn[Pr]=Gn[rt]=Gn[sn]=Gn[dn]=Gn[Fn]=Gn[Yt]=Gn[Tr]=Gn[yr]=Gn[Gr]=Gn[Ht]=Gn[Ut]=Gn[hi]=Gn[qi]=!0,Gn[Qt]=Gn[wn]=Gn[rr]=!1;var Jc={:"A",:"A",:"A",:"A",:"A",:"A",:"a",:"a",:"a",:"a",:"a",:"a",:"C",:"c",:"D",:"d",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"N",:"n",:"O",:"O",:"O",:"O",:"O",:"O",:"o",:"o",:"o",:"o",:"o",:"o",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"Y",:"y",:"y",:"Ae",:"ae",:"Th",:"th",:"ss",:"A",:"A",:"A",:"a",:"a",:"a",:"C",:"C",:"C",:"C",:"c",:"c",:"c",:"c",:"D",:"D",:"d",:"d",:"E",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"e",:"G",:"G",:"G",:"G",:"g",:"g",:"g",:"g",:"H",:"H",:"h",:"h",:"I",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"i",:"J",:"j",:"K",:"k",:"k",:"L",:"L",:"L",:"L",:"L",:"l",:"l",:"l",:"l",:"l",:"N",:"N",:"N",:"N",:"n",:"n",:"n",:"n",:"O",:"O",:"O",:"o",:"o",:"o",:"R",:"R",:"R",:"r",:"r",:"r",:"S",:"S",:"S",:"S",:"s",:"s",:"s",:"s",:"T",:"T",:"T",:"t",:"t",:"t",:"U",:"U",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"u",:"u",:"W",:"w",:"Y",:"y",:"Y",:"Z",:"Z",:"Z",:"z",:"z",:"z",:"IJ",:"ij",:"Oe",:"oe",:"'n",:"s"},qu={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Qc={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},eh={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Ys=parseFloat,ip=parseInt,Zu=typeof Kh=="object"&&Kh&&Kh.Object===Object&&Kh,ma=typeof self=="object"&&self&&self.Object===Object&&self,pr=Zu||ma||Function("return this")(),Mn=r&&!r.nodeType&&r,Js=Mn&&!0&&e&&!e.nodeType&&e,xd=Js&&Js.exports===Mn,jo=xd&&Zu.process,ls=function(){try{var Ie=Js&&Js.require&&Js.require("util").types;return Ie||jo&&jo.binding&&jo.binding("util")}catch{}}(),th=ls&&ls.isArrayBuffer,wd=ls&&ls.isDate,nh=ls&&ls.isMap,Wu=ls&&ls.isRegExp,rh=ls&&ls.isSet,ih=ls&&ls.isTypedArray;function Ri(Ie,Ve,Oe){switch(Oe.length){case 0:return Ie.call(Ve);case 1:return Ie.call(Ve,Oe[0]);case 2:return Ie.call(Ve,Oe[0],Oe[1]);case 3:return Ie.call(Ve,Oe[0],Oe[1],Oe[2])}return Ie.apply(Ve,Oe)}function bd(Ie,Ve,Oe,Tt){for(var Gt=-1,Tn=Ie==null?0:Ie.length;++Gt<Tn;){var gr=Ie[Gt];Ve(Tt,gr,Oe(gr),Ie)}return Tt}function Kr(Ie,Ve){for(var Oe=-1,Tt=Ie==null?0:Ie.length;++Oe<Tt&&Ve(Ie[Oe],Oe,Ie)!==!1;);return Ie}function Sd(Ie,Ve){for(var Oe=Ie==null?0:Ie.length;Oe--&&Ve(Ie[Oe],Oe,Ie)!==!1;);return Ie}function Td(Ie,Ve){for(var Oe=-1,Tt=Ie==null?0:Ie.length;++Oe<Tt;)if(!Ve(Ie[Oe],Oe,Ie))return!1;return!0}function po(Ie,Ve){for(var Oe=-1,Tt=Ie==null?0:Ie.length,Gt=0,Tn=[];++Oe<Tt;){var gr=Ie[Oe];Ve(gr,Oe,Ie)&&(Tn[Gt++]=gr)}return Tn}function $o(Ie,Ve){var Oe=Ie==null?0:Ie.length;return!!Oe&&qo(Ie,Ve,0)>-1}function sh(Ie,Ve,Oe){for(var Tt=-1,Gt=Ie==null?0:Ie.length;++Tt<Gt;)if(Oe(Ve,Ie[Tt]))return!0;return!1}function ir(Ie,Ve){for(var Oe=-1,Tt=Ie==null?0:Ie.length,Gt=Array(Tt);++Oe<Tt;)Gt[Oe]=Ve(Ie[Oe],Oe,Ie);return Gt}function Vo(Ie,Ve){for(var Oe=-1,Tt=Ve.length,Gt=Ie.length;++Oe<Tt;)Ie[Gt+Oe]=Ve[Oe];return Ie}function oh(Ie,Ve,Oe,Tt){var Gt=-1,Tn=Ie==null?0:Ie.length;for(Tt&&Tn&&(Oe=Ie[++Gt]);++Gt<Tn;)Oe=Ve(Oe,Ie[Gt],Gt,Ie);return Oe}function Ed(Ie,Ve,Oe,Tt){var Gt=Ie==null?0:Ie.length;for(Tt&&Gt&&(Oe=Ie[--Gt]);Gt--;)Oe=Ve(Oe,Ie[Gt],Gt,Ie);return Oe}function Gu(Ie,Ve){for(var Oe=-1,Tt=Ie==null?0:Ie.length;++Oe<Tt;)if(Ve(Ie[Oe],Oe,Ie))return!0;return!1}var Cd=Gl("length");function ah(Ie){return Ie.split("")}function Id(Ie){return Ie.match(In)||[]}function Zl(Ie,Ve,Oe){var Tt;return Oe(Ie,function(Gt,Tn,gr){if(Ve(Gt,Tn,gr))return Tt=Tn,!1}),Tt}function us(Ie,Ve,Oe,Tt){for(var Gt=Ie.length,Tn=Oe+(Tt?1:-1);Tt?Tn--:++Tn<Gt;)if(Ve(Ie[Tn],Tn,Ie))return Tn;return-1}function qo(Ie,Ve,Oe){return Ve===Ve?ul(Ie,Ve,Oe):us(Ie,Hu,Oe)}function lh(Ie,Ve,Oe,Tt){for(var Gt=Oe-1,Tn=Ie.length;++Gt<Tn;)if(Tt(Ie[Gt],Ve))return Gt;return-1}function Hu(Ie){return Ie!==Ie}function Wl(Ie,Ve){var Oe=Ie==null?0:Ie.length;return Oe?mr(Ie,Ve)/Oe:Et}function Gl(Ie){return function(Ve){return Ve==null?o:Ve[Ie]}}function mo(Ie){return function(Ve){return Ie==null?o:Ie[Ve]}}function Xu(Ie,Ve,Oe,Tt,Gt){return Gt(Ie,function(Tn,gr,Hn){Oe=Tt?(Tt=!1,Tn):Ve(Oe,Tn,gr,Hn)}),Oe}function sp(Ie,Ve){var Oe=Ie.length;for(Ie.sort(Ve);Oe--;)Ie[Oe]=Ie[Oe].value;return Ie}function mr(Ie,Ve){for(var Oe,Tt=-1,Gt=Ie.length;++Tt<Gt;){var Tn=Ve(Ie[Tt]);Tn!==o&&(Oe=Oe===o?Tn:Oe+Tn)}return Oe}function uh(Ie,Ve){for(var Oe=-1,Tt=Array(Ie);++Oe<Ie;)Tt[Oe]=Ve(Oe);return Tt}function an(Ie,Ve){return ir(Ve,function(Oe){return[Oe,Ie[Oe]]})}function Hl(Ie){return Ie&&Ie.slice(0,An(Ie)+1).replace(We,"")}function pn(Ie){return function(Ve){return Ie(Ve)}}function Un(Ie,Ve){return ir(Ve,function(Oe){return Ie[Oe]})}function Rs(Ie,Ve){return Ie.has(Ve)}function sl(Ie,Ve){for(var Oe=-1,Tt=Ie.length;++Oe<Tt&&qo(Ve,Ie[Oe],0)>-1;);return Oe}function ol(Ie,Ve){for(var Oe=Ie.length;Oe--&&qo(Ve,Ie[Oe],0)>-1;);return Oe}function ch(Ie,Ve){for(var Oe=Ie.length,Tt=0;Oe--;)Ie[Oe]===Ve&&++Tt;return Tt}var ga=mo(Jc),al=mo(qu);function cs(Ie){return"\\"+eh[Ie]}function hh(Ie,Ve){return Ie==null?o:Ie[Ve]}function Zo(Ie){return yd.test(Ie)}function dh(Ie){return vd.test(Ie)}function _a(Ie){for(var Ve,Oe=[];!(Ve=Ie.next()).done;)Oe.push(Ve.value);return Oe}function ya(Ie){var Ve=-1,Oe=Array(Ie.size);return Ie.forEach(function(Tt,Gt){Oe[++Ve]=[Gt,Tt]}),Oe}function ll(Ie,Ve){return function(Oe){return Ie(Ve(Oe))}}function Hi(Ie,Ve){for(var Oe=-1,Tt=Ie.length,Gt=0,Tn=[];++Oe<Tt;){var gr=Ie[Oe];(gr===Ve||gr===J)&&(Ie[Oe]=J,Tn[Gt++]=Oe)}return Tn}function Wo(Ie){var Ve=-1,Oe=Array(Ie.size);return Ie.forEach(function(Tt){Oe[++Ve]=Tt}),Oe}function Ku(Ie){var Ve=-1,Oe=Array(Ie.size);return Ie.forEach(function(Tt){Oe[++Ve]=[Tt,Tt]}),Oe}function ul(Ie,Ve,Oe){for(var Tt=Oe-1,Gt=Ie.length;++Tt<Gt;)if(Ie[Tt]===Ve)return Tt;return-1}function cl(Ie,Ve,Oe){for(var Tt=Oe+1;Tt--;)if(Ie[Tt]===Ve)return Tt;return Tt}function va(Ie){return Zo(Ie)?op(Ie):Cd(Ie)}function Xi(Ie){return Zo(Ie)?kd(Ie):ah(Ie)}function An(Ie){for(var Ve=Ie.length;Ve--&&Le.test(Ie.charAt(Ve)););return Ve}var Yu=mo(Qc);function op(Ie){for(var Ve=Uo.lastIndex=0;Uo.test(Ie);)++Ve;return Ve}function kd(Ie){return Ie.match(Uo)||[]}function hl(Ie){return Ie.match(tp)||[]}var Pd=function Ie(Ve){Ve=Ve==null?pr:go.defaults(pr.Object(),Ve,go.pick(pr,np));var Oe=Ve.Array,Tt=Ve.Date,Gt=Ve.Error,Tn=Ve.Function,gr=Ve.Math,Hn=Ve.Object,Go=Ve.RegExp,Xl=Ve.String,Ei=Ve.TypeError,xa=Oe.prototype,fh=Tn.prototype,dl=Hn.prototype,Kl=Ve["__core-js_shared__"],wa=fh.toString,jn=dl.hasOwnProperty,Yl=0,fl=function(){var u=/[^.]+$/.exec(Kl&&Kl.keys&&Kl.keys.IE_PROTO||"");return u?"Symbol(src)_1."+u:""}(),$r=dl.toString,ba=wa.call(Hn),Ad=pr._,Md=Go("^"+wa.call(jn).replace(pe,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),cr=xd?Ve.Buffer:o,Yr=Ve.Symbol,di=Ve.Uint8Array,pl=cr?cr.allocUnsafe:o,ml=ll(Hn.getPrototypeOf,Hn),Jl=Hn.create,Sa=dl.propertyIsEnumerable,hs=xa.splice,Ju=Yr?Yr.isConcatSpreadable:o,Ho=Yr?Yr.iterator:o,_o=Yr?Yr.toStringTag:o,Ta=function(){try{var u=Cl(Hn,"defineProperty");return u({},"",{}),u}catch{}}(),ph=Ve.clearTimeout!==pr.clearTimeout&&Ve.clearTimeout,mh=Tt&&Tt.now!==pr.Date.now&&Tt.now,Ea=Ve.setTimeout!==pr.setTimeout&&Ve.setTimeout,Ca=gr.ceil,Xo=gr.floor,Ql=Hn.getOwnPropertySymbols,gh=cr?cr.isBuffer:o,Qu=Ve.isFinite,_h=xa.join,ec=ll(Hn.keys,Hn),_r=gr.max,ni=gr.min,ds=Tt.now,Qs=Ve.parseInt,tc=gr.random,Os=xa.reverse,yo=Cl(Ve,"DataView"),eu=Cl(Ve,"Map"),yh=Cl(Ve,"Promise"),Ia=Cl(Ve,"Set"),gl=Cl(Ve,"WeakMap"),ka=Cl(Hn,"create"),vo=gl&&new gl,ri={},vt=_u(yo),nc=_u(eu),vh=_u(yh),zd=_u(Ia),_l=_u(gl),xo=Yr?Yr.prototype:o,Pa=xo?xo.valueOf:o,mn=xo?xo.toString:o;function H(u){if(zr(u)&&!en(u)&&!(u instanceof ln)){if(u instanceof fs)return u;if(jn.call(u,"__wrapped__"))return wg(u)}return new fs(u)}var yl=function(){function u(){}return function(m){if(!br(m))return{};if(Jl)return Jl(m);u.prototype=m;var T=new u;return u.prototype=o,T}}();function vl(){}function fs(u,m){this.__wrapped__=u,this.__actions__=[],this.__chain__=!!m,this.__index__=0,this.__values__=o}H.templateSettings={escape:B,evaluate:K,interpolate:re,variable:"",imports:{_:H}},H.prototype=vl.prototype,H.prototype.constructor=H,fs.prototype=yl(vl.prototype),fs.prototype.constructor=fs;function ln(u){this.__wrapped__=u,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=ct,this.__views__=[]}function Dd(){var u=new ln(this.__wrapped__);return u.__actions__=Ji(this.__actions__),u.__dir__=this.__dir__,u.__filtered__=this.__filtered__,u.__iteratees__=Ji(this.__iteratees__),u.__takeCount__=this.__takeCount__,u.__views__=Ji(this.__views__),u}function xh(){if(this.__filtered__){var u=new ln(this);u.__dir__=-1,u.__filtered__=!0}else u=this.clone(),u.__dir__*=-1;return u}function Ld(){var u=this.__wrapped__.value(),m=this.__dir__,T=en(u),A=m<0,$=T?u.length:0,Y=xp(0,$,this.__views__),fe=Y.start,we=Y.end,Me=we-fe,Ge=A?we:fe-1,He=this.__iteratees__,et=He.length,bt=0,Nt=ni(Me,this.__takeCount__);if(!T||!A&&$==Me&&Nt==Me)return ng(u,this.__actions__);var tn=[];e:for(;Me--&&bt<Nt;){Ge+=m;for(var En=-1,nn=u[Ge];++En<et;){var Rn=He[En],Vn=Rn.iteratee,Io=Rn.type,Vs=Vn(nn);if(Io==qn)nn=Vs;else if(!Vs){if(Io==Kt)continue e;break e}}tn[bt++]=nn}return tn}ln.prototype=yl(vl.prototype),ln.prototype.constructor=ln;function Aa(u){var m=-1,T=u==null?0:u.length;for(this.clear();++m<T;){var A=u[m];this.set(A[0],A[1])}}function wh(){this.__data__=ka?ka(null):{},this.size=0}function ap(u){var m=this.has(u)&&delete this.__data__[u];return this.size-=m?1:0,m}function lp(u){var m=this.__data__;if(ka){var T=m[u];return T===D?o:T}return jn.call(m,u)?m[u]:o}function Ki(u){var m=this.__data__;return ka?m[u]!==o:jn.call(m,u)}function ar(u,m){var T=this.__data__;return this.size+=this.has(u)?0:1,T[u]=ka&&m===o?D:m,this}Aa.prototype.clear=wh,Aa.prototype.delete=ap,Aa.prototype.get=lp,Aa.prototype.has=Ki,Aa.prototype.set=ar;function Oi(u){var m=-1,T=u==null?0:u.length;for(this.clear();++m<T;){var A=u[m];this.set(A[0],A[1])}}function rc(){this.__data__=[],this.size=0}function ic(u){var m=this.__data__,T=Q(m,u);if(T<0)return!1;var A=m.length-1;return T==A?m.pop():hs.call(m,T,1),--this.size,!0}function Rd(u){var m=this.__data__,T=Q(m,u);return T<0?o:m[T][1]}function tu(u){return Q(this.__data__,u)>-1}function nu(u,m){var T=this.__data__,A=Q(T,u);return A<0?(++this.size,T.push([u,m])):T[A][1]=m,this}Oi.prototype.clear=rc,Oi.prototype.delete=ic,Oi.prototype.get=Rd,Oi.prototype.has=tu,Oi.prototype.set=nu;function Jr(u){var m=-1,T=u==null?0:u.length;for(this.clear();++m<T;){var A=u[m];this.set(A[0],A[1])}}function ru(){this.size=0,this.__data__={hash:new Aa,map:new(eu||Oi),string:new Aa}}function Ct(u){var m=pu(this,u).delete(u);return this.size-=m?1:0,m}function Ft(u){return pu(this,u).get(u)}function sc(u){return pu(this,u).has(u)}function oc(u,m){var T=pu(this,u),A=T.size;return T.set(u,m),this.size+=T.size==A?0:1,this}Jr.prototype.clear=ru,Jr.prototype.delete=Ct,Jr.prototype.get=Ft,Jr.prototype.has=sc,Jr.prototype.set=oc;function wo(u){var m=-1,T=u==null?0:u.length;for(this.__data__=new Jr;++m<T;)this.add(u[m])}function y(u){return this.__data__.set(u,D),this}function t(u){return this.__data__.has(u)}wo.prototype.add=wo.prototype.push=y,wo.prototype.has=t;function a(u){var m=this.__data__=new Oi(u);this.size=m.size}function d(){this.__data__=new Oi,this.size=0}function f(u){var m=this.__data__,T=m.delete(u);return this.size=m.size,T}function _(u){return this.__data__.get(u)}function E(u){return this.__data__.has(u)}function I(u,m){var T=this.__data__;if(T instanceof Oi){var A=T.__data__;if(!eu||A.length<g-1)return A.push([u,m]),this.size=++T.size,this;T=this.__data__=new Jr(A)}return T.set(u,m),this.size=T.size,this}a.prototype.clear=d,a.prototype.delete=f,a.prototype.get=_,a.prototype.has=E,a.prototype.set=I;function k(u,m){var T=en(u),A=!T&&yu(u),$=!T&&!A&&Ua(u),Y=!T&&!A&&!$&&S(u),fe=T||A||$||Y,we=fe?uh(u.length,Xl):[],Me=we.length;for(var Ge in u)(m||jn.call(u,Ge))&&!(fe&&(Ge=="length"||$&&(Ge=="offset"||Ge=="parent")||Y&&(Ge=="buffer"||Ge=="byteLength"||Ge=="byteOffset")||Ba(Ge,Me)))&&we.push(Ge);return we}function z(u){var m=u.length;return m?u[Bd(0,m-1)]:o}function R(u,m){return Lh(Ji(u),xe(m,0,u.length))}function O(u){return Lh(Ji(u))}function V(u,m,T){(T!==o&&!Ts(u[m],T)||T===o&&!(m in u))&&me(u,m,T)}function X(u,m,T){var A=u[m];(!(jn.call(u,m)&&Ts(A,T))||T===o&&!(m in u))&&me(u,m,T)}function Q(u,m){for(var T=u.length;T--;)if(Ts(u[T][0],m))return T;return-1}function ie(u,m,T,A){return pt(u,function($,Y,fe){m(A,$,T($),fe)}),A}function le(u,m){return u&&ws(m,yn(m),u)}function ce(u,m){return u&&ws(m,$n(m),u)}function me(u,m,T){m=="__proto__"&&Ta?Ta(u,m,{configurable:!0,enumerable:!0,value:T,writable:!0}):u[m]=T}function te(u,m){for(var T=-1,A=m.length,$=Oe(A),Y=u==null;++T<A;)$[T]=Y?o:Es(u,m[T]);return $}function xe(u,m,T){return u===u&&(T!==o&&(u=u<=T?u:T),m!==o&&(u=u>=m?u:m)),u}function be(u,m,T,A,$,Y){var fe,we=m&G,Me=m&q,Ge=m&Ee;if(T&&(fe=$?T(u,A,$,Y):T(u)),fe!==o)return fe;if(!br(u))return u;var He=en(u);if(He){if(fe=mg(u),!we)return Ji(u,fe)}else{var et=_i(u),bt=et==wn||et==er;if(Ua(u))return sg(u,we);if(et==Fn||et==cn||bt&&!$){if(fe=Me||bt?{}:gg(u),!we)return Me?Zd(u,ce(fe,u)):ay(u,le(fe,u))}else{if(!Gn[et])return $?u:{};fe=dy(u,et,we)}}Y||(Y=new a);var Nt=Y.get(u);if(Nt)return Nt;Y.set(u,fe),p(u)?u.forEach(function(nn){fe.add(be(nn,m,T,nn,u,Y))}):cf(u)&&u.forEach(function(nn,Rn){fe.set(Rn,be(nn,m,T,Rn,u,Y))});var tn=Ge?Me?vp:El:Me?$n:yn,En=He?o:tn(u);return Kr(En||u,function(nn,Rn){En&&(Rn=nn,nn=u[Rn]),X(fe,Rn,be(nn,m,T,Rn,u,Y))}),fe}function ze(u){var m=yn(u);return function(T){return qe(T,u,m)}}function qe(u,m,T){var A=T.length;if(u==null)return!A;for(u=Hn(u);A--;){var $=T[A],Y=m[$],fe=u[$];if(fe===o&&!($ in u)||!Y(fe))return!1}return!0}function Qe(u,m,T){if(typeof u!="function")throw new Ei(w);return fc(function(){u.apply(o,T)},m)}function at(u,m,T,A){var $=-1,Y=$o,fe=!0,we=u.length,Me=[],Ge=m.length;if(!we)return Me;T&&(m=ir(m,pn(T))),A?(Y=sh,fe=!1):m.length>=g&&(Y=Rs,fe=!1,m=new wo(m));e:for(;++$<we;){var He=u[$],et=T==null?He:T(He);if(He=A||He!==0?He:0,fe&&et===et){for(var bt=Ge;bt--;)if(m[bt]===et)continue e;Me.push(He)}else Y(m,et,A)||Me.push(He)}return Me}var pt=fp($t),st=fp(un,!0);function ot(u,m){var T=!0;return pt(u,function(A,$,Y){return T=!!m(A,$,Y),T}),T}function wt(u,m,T){for(var A=-1,$=u.length;++A<$;){var Y=u[A],fe=m(Y);if(fe!=null&&(we===o?fe===fe&&!x(fe):T(fe,we)))var we=fe,Me=Y}return Me}function Wt(u,m,T,A){var $=u.length;for(T=Z(T),T<0&&(T=-T>$?0:$+T),A=A===o||A>$?$:Z(A),A<0&&(A+=$),A=T>A?0:ne(A);T<A;)u[T++]=m;return u}function ht(u,m){var T=[];return pt(u,function(A,$,Y){m(A,$,Y)&&T.push(A)}),T}function tt(u,m,T,A,$){var Y=-1,fe=u.length;for(T||(T=py),$||($=[]);++Y<fe;){var we=u[Y];m>0&&T(we)?m>1?tt(we,m-1,T,A,$):Vo($,we):A||($[$.length]=we)}return $}var jt=pp(),sr=pp(!0);function $t(u,m){return u&&jt(u,m,yn)}function un(u,m){return u&&sr(u,m,yn)}function Xn(u,m){return po(m,function(T){return So(u[T])})}function Cr(u,m){m=Jo(m,u);for(var T=0,A=m.length;u!=null&&T<A;)u=u[Qo(m[T++])];return T&&T==A?u:o}function ps(u,m,T){var A=m(u);return en(u)?A:Vo(A,T(u))}function hn(u){return u==null?u===o?vr:Ce:_o&&_o in Hn(u)?pg(u):xy(u)}function fi(u,m){return u>m}function Ci(u,m){return u!=null&&jn.call(u,m)}function pi(u,m){return u!=null&&m in Hn(u)}function Ii(u,m,T){return u>=ni(m,T)&&u<_r(m,T)}function ms(u,m,T){for(var A=T?sh:$o,$=u[0].length,Y=u.length,fe=Y,we=Oe(Y),Me=1/0,Ge=[];fe--;){var He=u[fe];fe&&m&&(He=ir(He,pn(m))),Me=ni(He.length,Me),we[fe]=!T&&(m||$>=120&&He.length>=120)?new wo(fe&&He):o}He=u[0];var et=-1,bt=we[0];e:for(;++et<$&&Ge.length<Me;){var Nt=He[et],tn=m?m(Nt):Nt;if(Nt=T||Nt!==0?Nt:0,!(bt?Rs(bt,tn):A(Ge,tn,T))){for(fe=Y;--fe;){var En=we[fe];if(!(En?Rs(En,tn):A(u[fe],tn,T)))continue e}bt&&bt.push(tn),Ge.push(Nt)}}return Ge}function xl(u,m,T,A){return $t(u,function($,Y,fe){m(A,T($),Y,fe)}),A}function Ko(u,m,T){m=Jo(m,u),u=dc(u,m);var A=u==null?u:u[Qo(Ns(m))];return A==null?o:Ri(A,u,T)}function Ma(u){return zr(u)&&hn(u)==cn}function gs(u){return zr(u)&&hn(u)==fr}function ac(u){return zr(u)&&hn(u)==rn}function za(u,m,T,A,$){return u===m?!0:u==null||m==null||!zr(u)&&!zr(m)?u!==u&&m!==m:_s(u,m,T,A,za,$)}function _s(u,m,T,A,$,Y){var fe=en(u),we=en(m),Me=fe?Cn:_i(u),Ge=we?Cn:_i(m);Me=Me==cn?Fn:Me,Ge=Ge==cn?Fn:Ge;var He=Me==Fn,et=Ge==Fn,bt=Me==Ge;if(bt&&Ua(u)){if(!Ua(m))return!1;fe=!0,He=!1}if(bt&&!He)return Y||(Y=new a),fe||S(u)?fg(u,m,T,A,$,Y):hy(u,m,Me,T,A,$,Y);if(!(T&Ae)){var Nt=He&&jn.call(u,"__wrapped__"),tn=et&&jn.call(m,"__wrapped__");if(Nt||tn){var En=Nt?u.value():u,nn=tn?m.value():m;return Y||(Y=new a),$(En,nn,T,A,Y)}}return bt?(Y||(Y=new a),yp(u,m,T,A,$,Y)):!1}function ys(u){return zr(u)&&_i(u)==sn}function eo(u,m,T,A){var $=T.length,Y=$,fe=!A;if(u==null)return!Y;for(u=Hn(u);$--;){var we=T[$];if(fe&&we[2]?we[1]!==u[we[0]]:!(we[0]in u))return!1}for(;++$<Y;){we=T[$];var Me=we[0],Ge=u[Me],He=we[1];if(fe&&we[2]){if(Ge===o&&!(Me in u))return!1}else{var et=new a;if(A)var bt=A(Ge,He,Me,u,m,et);if(!(bt===o?za(He,Ge,Ae|Fe,A,et):bt))return!1}}return!0}function vs(u){if(!br(u)||my(u))return!1;var m=So(u)?Md:Wn;return m.test(_u(u))}function ii(u){return zr(u)&&hn(u)==Yt}function mi(u){return zr(u)&&_i(u)==Tr}function Yi(u){return zr(u)&&Ml(u.length)&&!!or[hn(u)]}function gn(u){return typeof u=="function"?u:u==null?ro:typeof u=="object"?en(u)?Sh(u[0],u[1]):Od(u):Cw(u)}function bo(u){if(!Dh(u))return ec(u);var m=[];for(var T in Hn(u))jn.call(u,T)&&T!="constructor"&&m.push(T);return m}function wl(u){if(!br(u))return vy(u);var m=Dh(u),T=[];for(var A in u)A=="constructor"&&(m||!jn.call(u,A))||T.push(A);return T}function Yo(u,m){return u<m}function bh(u,m){var T=-1,A=Vr(u)?Oe(u.length):[];return pt(u,function($,Y,fe){A[++T]=m($,Y,fe)}),A}function Od(u){var m=mu(u);return m.length==1&&m[0][2]?Ep(m[0][0],m[0][1]):function(T){return T===u||eo(T,u,m)}}function Sh(u,m){return Sp(u)&&Tp(m)?Ep(Qo(u),m):function(T){var A=Es(T,u);return A===o&&A===m?Nr(T,u):za(m,A,Ae|Fe)}}function Fs(u,m,T,A,$){u!==m&&jt(m,function(Y,fe){if($||($=new a),br(Y))Fd(u,m,fe,T,Fs,A,$);else{var we=A?A(Ip(u,fe),Y,fe+"",u,m,$):o;we===o&&(we=Y),V(u,fe,we)}},$n)}function Fd(u,m,T,A,$,Y,fe){var we=Ip(u,T),Me=Ip(m,T),Ge=fe.get(Me);if(Ge){V(u,T,Ge);return}var He=Y?Y(we,Me,T+"",u,m,fe):o,et=He===o;if(et){var bt=en(Me),Nt=!bt&&Ua(Me),tn=!bt&&!Nt&&S(Me);He=Me,bt||Nt||tn?en(we)?He=we:Mr(we)?He=Ji(we):Nt?(et=!1,He=sg(Me,!0)):tn?(et=!1,He=dp(Me,!0)):He=[]:n(Me)||yu(Me)?(He=we,yu(we)?He=Pe(we):(!br(we)||So(we))&&(He=gg(Me))):et=!1}et&&(fe.set(Me,He),$(He,Me,A,Y,fe),fe.delete(Me)),V(u,T,He)}function iu(u,m){var T=u.length;if(T)return m+=m<0?T:0,Ba(m,T)?u[m]:o}function bl(u,m,T){m.length?m=ir(m,function(Y){return en(Y)?function(fe){return Cr(fe,Y.length===1?Y[0]:Y)}:Y}):m=[ro];var A=-1;m=ir(m,pn(Vt()));var $=bh(u,function(Y,fe,we){var Me=ir(m,function(Ge){return Ge(Y)});return{criteria:Me,index:++A,value:Y}});return sp($,function(Y,fe){return Fi(Y,fe,T)})}function lc(u,m){return su(u,m,function(T,A){return Nr(u,A)})}function su(u,m,T){for(var A=-1,$=m.length,Y={};++A<$;){var fe=m[A],we=Cr(u,fe);T(we,fe)&&Bs(Y,Jo(fe,u),we)}return Y}function Sl(u){return function(m){return Cr(m,u)}}function Da(u,m,T,A){var $=A?lh:qo,Y=-1,fe=m.length,we=u;for(u===m&&(m=Ji(m)),T&&(we=ir(u,pn(T)));++Y<fe;)for(var Me=0,Ge=m[Y],He=T?T(Ge):Ge;(Me=$(we,He,Me,A))>-1;)we!==u&&hs.call(we,Me,1),hs.call(u,Me,1);return u}function Th(u,m){for(var T=u?m.length:0,A=T-1;T--;){var $=m[T];if(T==A||$!==Y){var Y=$;Ba($)?hs.call(u,$,1):cc(u,$)}}return u}function Bd(u,m){return u+Xo(tc()*(m-u+1))}function eg(u,m,T,A){for(var $=-1,Y=_r(Ca((m-u)/(T||1)),0),fe=Oe(Y);Y--;)fe[A?Y:++$]=u,u+=T;return fe}function up(u,m){var T="";if(!u||m<1||m>Je)return T;do m%2&&(T+=u),m=Xo(m/2),m&&(u+=u);while(m);return T}function _n(u,m){return kp(Kd(u,m,ro),u+"")}function Eh(u){return z(Is(u))}function uc(u,m){var T=Is(u);return Lh(T,xe(m,0,T.length))}function Bs(u,m,T,A){if(!br(u))return u;m=Jo(m,u);for(var $=-1,Y=m.length,fe=Y-1,we=u;we!=null&&++$<Y;){var Me=Qo(m[$]),Ge=T;if(Me==="__proto__"||Me==="constructor"||Me==="prototype")return u;if($!=fe){var He=we[Me];Ge=A?A(He,Me,we):o,Ge===o&&(Ge=br(He)?He:Ba(m[$+1])?[]:{})}X(we,Me,Ge),we=we[Me]}return u}var to=vo?function(u,m){return vo.set(u,m),u}:ro,Tl=Ta?function(u,m){return Ta(u,"toString",{configurable:!0,enumerable:!1,value:g1(m),writable:!0})}:ro;function tg(u){return Lh(Is(u))}function gi(u,m,T){var A=-1,$=u.length;m<0&&(m=-m>$?0:$+m),T=T>$?$:T,T<0&&(T+=$),$=m>T?0:T-m>>>0,m>>>=0;for(var Y=Oe($);++A<$;)Y[A]=u[A+m];return Y}function oy(u,m){var T;return pt(u,function(A,$,Y){return T=m(A,$,Y),!T}),!!T}function Ch(u,m,T){var A=0,$=u==null?A:u.length;if(typeof m=="number"&&m===m&&$<=St){for(;A<$;){var Y=A+$>>>1,fe=u[Y];fe!==null&&!x(fe)&&(T?fe<=m:fe<m)?A=Y+1:$=Y}return $}return Ir(u,m,ro,T)}function Ir(u,m,T,A){var $=0,Y=u==null?0:u.length;if(Y===0)return 0;m=T(m);for(var fe=m!==m,we=m===null,Me=x(m),Ge=m===o;$<Y;){var He=Xo(($+Y)/2),et=T(u[He]),bt=et!==o,Nt=et===null,tn=et===et,En=x(et);if(fe)var nn=A||tn;else Ge?nn=tn&&(A||bt):we?nn=tn&&bt&&(A||!Nt):Me?nn=tn&&bt&&!Nt&&(A||!En):Nt||En?nn=!1:nn=A?et<=m:et<m;nn?$=He+1:Y=He}return ni(Y,It)}function Nd(u,m){for(var T=-1,A=u.length,$=0,Y=[];++T<A;){var fe=u[T],we=m?m(fe):fe;if(!T||!Ts(we,Me)){var Me=we;Y[$++]=fe===0?0:fe}}return Y}function cp(u){return typeof u=="number"?u:x(u)?Et:+u}function si(u){if(typeof u=="string")return u;if(en(u))return ir(u,si)+"";if(x(u))return mn?mn.call(u):"";var m=u+"";return m=="0"&&1/u==-zt?"-0":m}function xs(u,m,T){var A=-1,$=$o,Y=u.length,fe=!0,we=[],Me=we;if(T)fe=!1,$=sh;else if(Y>=g){var Ge=m?null:zh(u);if(Ge)return Wo(Ge);fe=!1,$=Rs,Me=new wo}else Me=m?[]:we;e:for(;++A<Y;){var He=u[A],et=m?m(He):He;if(He=T||He!==0?He:0,fe&&et===et){for(var bt=Me.length;bt--;)if(Me[bt]===et)continue e;m&&Me.push(et),we.push(He)}else $(Me,et,T)||(Me!==we&&Me.push(et),we.push(He))}return we}function cc(u,m){return m=Jo(m,u),u=dc(u,m),u==null||delete u[Qo(Ns(m))]}function Ud(u,m,T,A){return Bs(u,m,T(Cr(u,m)),A)}function Ih(u,m,T,A){for(var $=u.length,Y=A?$:-1;(A?Y--:++Y<$)&&m(u[Y],Y,u););return T?gi(u,A?0:Y,A?Y+1:$):gi(u,A?Y+1:0,A?$:Y)}function ng(u,m){var T=u;return T instanceof ln&&(T=T.value()),oh(m,function(A,$){return $.func.apply($.thisArg,Vo([A],$.args))},T)}function jd(u,m,T){var A=u.length;if(A<2)return A?xs(u[0]):[];for(var $=-1,Y=Oe(A);++$<A;)for(var fe=u[$],we=-1;++we<A;)we!=$&&(Y[$]=at(Y[$]||fe,u[we],m,T));return xs(tt(Y,1),m,T)}function rg(u,m,T){for(var A=-1,$=u.length,Y=m.length,fe={};++A<$;){var we=A<Y?m[A]:o;T(fe,u[A],we)}return fe}function kh(u){return Mr(u)?u:[]}function hp(u){return typeof u=="function"?u:ro}function Jo(u,m){return en(u)?u:Sp(u,m)?[u]:xg(_e(u))}var ig=_n;function La(u,m,T){var A=u.length;return T=T===o?A:T,!m&&T>=A?u:gi(u,m,T)}var ou=ph||function(u){return pr.clearTimeout(u)};function sg(u,m){if(m)return u.slice();var T=u.length,A=pl?pl(T):new u.constructor(T);return u.copy(A),A}function au(u){var m=new u.constructor(u.byteLength);return new di(m).set(new di(u)),m}function $d(u,m){var T=m?au(u.buffer):u.buffer;return new u.constructor(T,u.byteOffset,u.byteLength)}function Vd(u){var m=new u.constructor(u.source,Ar.exec(u));return m.lastIndex=u.lastIndex,m}function og(u){return Pa?Hn(Pa.call(u)):{}}function dp(u,m){var T=m?au(u.buffer):u.buffer;return new u.constructor(T,u.byteOffset,u.length)}function ag(u,m){if(u!==m){var T=u!==o,A=u===null,$=u===u,Y=x(u),fe=m!==o,we=m===null,Me=m===m,Ge=x(m);if(!we&&!Ge&&!Y&&u>m||Y&&fe&&Me&&!we&&!Ge||A&&fe&&Me||!T&&Me||!$)return 1;if(!A&&!Y&&!Ge&&u<m||Ge&&T&&$&&!A&&!Y||we&&T&&$||!fe&&$||!Me)return-1}return 0}function Fi(u,m,T){for(var A=-1,$=u.criteria,Y=m.criteria,fe=$.length,we=T.length;++A<fe;){var Me=ag($[A],Y[A]);if(Me){if(A>=we)return Me;var Ge=T[A];return Me*(Ge=="desc"?-1:1)}}return u.index-m.index}function lu(u,m,T,A){for(var $=-1,Y=u.length,fe=T.length,we=-1,Me=m.length,Ge=_r(Y-fe,0),He=Oe(Me+Ge),et=!A;++we<Me;)He[we]=m[we];for(;++$<fe;)(et||$<Y)&&(He[T[$]]=u[$]);for(;Ge--;)He[we++]=u[$++];return He}function qd(u,m,T,A){for(var $=-1,Y=u.length,fe=-1,we=T.length,Me=-1,Ge=m.length,He=_r(Y-we,0),et=Oe(He+Ge),bt=!A;++$<He;)et[$]=u[$];for(var Nt=$;++Me<Ge;)et[Nt+Me]=m[Me];for(;++fe<we;)(bt||$<Y)&&(et[Nt+T[fe]]=u[$++]);return et}function Ji(u,m){var T=-1,A=u.length;for(m||(m=Oe(A));++T<A;)m[T]=u[T];return m}function ws(u,m,T,A){var $=!T;T||(T={});for(var Y=-1,fe=m.length;++Y<fe;){var we=m[Y],Me=A?A(T[we],u[we],we,T,u):o;Me===o&&(Me=u[we]),$?me(T,we,Me):X(T,we,Me)}return T}function ay(u,m){return ws(u,gu(u),m)}function Zd(u,m){return ws(u,Xd(u),m)}function Wd(u,m){return function(T,A){var $=en(T)?bd:ie,Y=m?m():{};return $(T,u,Vt(A,2),Y)}}function uu(u){return _n(function(m,T){var A=-1,$=T.length,Y=$>1?T[$-1]:o,fe=$>2?T[2]:o;for(Y=u.length>3&&typeof Y=="function"?($--,Y):o,fe&&Fr(T[0],T[1],fe)&&(Y=$<3?o:Y,$=1),m=Hn(m);++A<$;){var we=T[A];we&&u(m,we,A,Y)}return m})}function fp(u,m){return function(T,A){if(T==null)return T;if(!Vr(T))return u(T,A);for(var $=T.length,Y=m?$:-1,fe=Hn(T);(m?Y--:++Y<$)&&A(fe[Y],Y,fe)!==!1;);return T}}function pp(u){return function(m,T,A){for(var $=-1,Y=Hn(m),fe=A(m),we=fe.length;we--;){var Me=fe[u?we:++$];if(T(Y[Me],Me,Y)===!1)break}return m}}function ly(u,m,T){var A=m&Ne,$=hu(u);function Y(){var fe=this&&this!==pr&&this instanceof Y?$:u;return fe.apply(A?T:this,arguments)}return Y}function Gd(u){return function(m){m=_e(m);var T=Zo(m)?Xi(m):o,A=T?T[0]:m.charAt(0),$=T?La(T,1).join(""):m.slice(1);return A[u]()+$}}function cu(u){return function(m){return oh(Tw(nm(m).replace(Vu,"")),u,"")}}function hu(u){return function(){var m=arguments;switch(m.length){case 0:return new u;case 1:return new u(m[0]);case 2:return new u(m[0],m[1]);case 3:return new u(m[0],m[1],m[2]);case 4:return new u(m[0],m[1],m[2],m[3]);case 5:return new u(m[0],m[1],m[2],m[3],m[4]);case 6:return new u(m[0],m[1],m[2],m[3],m[4],m[5]);case 7:return new u(m[0],m[1],m[2],m[3],m[4],m[5],m[6])}var T=yl(u.prototype),A=u.apply(T,m);return br(A)?A:T}}function Ph(u,m,T){var A=hu(u);function $(){for(var Y=arguments.length,fe=Oe(Y),we=Y,Me=fu($);we--;)fe[we]=arguments[we];var Ge=Y<3&&fe[0]!==Me&&fe[Y-1]!==Me?[]:Hi(fe,Me);if(Y-=Ge.length,Y<T)return _p(u,m,hc,$.placeholder,o,fe,Ge,o,o,T-Y);var He=this&&this!==pr&&this instanceof $?A:u;return Ri(He,this,fe)}return $}function bs(u){return function(m,T,A){var $=Hn(m);if(!Vr(m)){var Y=Vt(T,3);m=yn(m),T=function(we){return Y($[we],we,$)}}var fe=u(m,T,A);return fe>-1?$[Y?m[fe]:fe]:o}}function mp(u){return Fa(function(m){var T=m.length,A=T,$=fs.prototype.thru;for(u&&m.reverse();A--;){var Y=m[A];if(typeof Y!="function")throw new Ei(w);if($&&!fe&&du(Y)=="wrapper")var fe=new fs([],!0)}for(A=fe?A:T;++A<T;){Y=m[A];var we=du(Y),Me=we=="wrapper"?wr(Y):o;Me&&Il(Me[0])&&Me[1]==(ve|he|Ze|ee)&&!Me[4].length&&Me[9]==1?fe=fe[du(Me[0])].apply(fe,Me[3]):fe=Y.length==1&&Il(Y)?fe[we]():fe.thru(Y)}return function(){var Ge=arguments,He=Ge[0];if(fe&&Ge.length==1&&en(He))return fe.plant(He).value();for(var et=0,bt=T?m[et].apply(this,Ge):He;++et<T;)bt=m[et].call(this,bt);return bt}})}function hc(u,m,T,A,$,Y,fe,we,Me,Ge){var He=m&ve,et=m&Ne,bt=m&se,Nt=m&(he|De),tn=m&de,En=bt?o:hu(u);function nn(){for(var Rn=arguments.length,Vn=Oe(Rn),Io=Rn;Io--;)Vn[Io]=arguments[Io];if(Nt)var Vs=fu(nn),ko=ch(Vn,Vs);if(A&&(Vn=lu(Vn,A,$,Nt)),Y&&(Vn=qd(Vn,Y,fe,Nt)),Rn-=ko,Nt&&Rn<Ge){var li=Hi(Vn,Vs);return _p(u,m,hc,nn.placeholder,T,Vn,li,we,Me,Ge-Rn)}var ja=et?T:this,bu=bt?ja[u]:u;return Rn=Vn.length,we?Vn=Cp(Vn,we):tn&&Rn>1&&Vn.reverse(),He&&Me<Rn&&(Vn.length=Me),this&&this!==pr&&this instanceof nn&&(bu=En||hu(bu)),bu.apply(ja,Vn)}return nn}function lg(u,m){return function(T,A){return xl(T,u,m(A),{})}}function Ah(u,m){return function(T,A){var $;if(T===o&&A===o)return m;if(T!==o&&($=T),A!==o){if($===o)return A;typeof T=="string"||typeof A=="string"?(T=si(T),A=si(A)):(T=cp(T),A=cp(A)),$=u(T,A)}return $}}function gp(u){return Fa(function(m){return m=ir(m,pn(Vt())),_n(function(T){var A=this;return u(m,function($){return Ri($,A,T)})})})}function Hd(u,m){m=m===o?" ":si(m);var T=m.length;if(T<2)return T?up(m,u):m;var A=up(m,Ca(u/va(m)));return Zo(m)?La(Xi(A),0,u).join(""):A.slice(0,u)}function uy(u,m,T,A){var $=m&Ne,Y=hu(u);function fe(){for(var we=-1,Me=arguments.length,Ge=-1,He=A.length,et=Oe(He+Me),bt=this&&this!==pr&&this instanceof fe?Y:u;++Ge<He;)et[Ge]=A[Ge];for(;Me--;)et[Ge++]=arguments[++we];return Ri(bt,$?T:this,et)}return fe}function ug(u){return function(m,T,A){return A&&typeof A!="number"&&Fr(m,T,A)&&(T=A=o),m=W(m),T===o?(T=m,m=0):T=W(T),A=A===o?m<T?1:-1:W(A),eg(m,T,A,u)}}function Mh(u){return function(m,T){return typeof m=="string"&&typeof T=="string"||(m=oe(m),T=oe(T)),u(m,T)}}function _p(u,m,T,A,$,Y,fe,we,Me,Ge){var He=m&he,et=He?fe:o,bt=He?o:fe,Nt=He?Y:o,tn=He?o:Y;m|=He?Ze:je,m&=~(He?je:Ze),m&ue||(m&=~(Ne|se));var En=[u,m,$,Nt,et,tn,bt,we,Me,Ge],nn=T.apply(o,En);return Il(u)&&yg(nn,En),nn.placeholder=A,vg(nn,u,m)}function Ra(u){var m=gr[u];return function(T,A){if(T=oe(T),A=A==null?0:ni(Z(A),292),A&&Qu(T)){var $=(_e(T)+"e").split("e"),Y=m($[0]+"e"+(+$[1]+A));return $=(_e(Y)+"e").split("e"),+($[0]+"e"+(+$[1]-A))}return m(T)}}var zh=Ia&&1/Wo(new Ia([,-0]))[1]==zt?function(u){return new Ia(u)}:v1;function cg(u){return function(m){var T=_i(m);return T==sn?ya(m):T==Tr?Ku(m):an(m,u(m))}}function Oa(u,m,T,A,$,Y,fe,we){var Me=m&se;if(!Me&&typeof u!="function")throw new Ei(w);var Ge=A?A.length:0;if(Ge||(m&=~(Ze|je),A=$=o),fe=fe===o?fe:_r(Z(fe),0),we=we===o?we:Z(we),Ge-=$?$.length:0,m&je){var He=A,et=$;A=$=o}var bt=Me?o:wr(u),Nt=[u,m,T,A,$,He,et,Y,fe,we];if(bt&&yy(Nt,bt),u=Nt[0],m=Nt[1],T=Nt[2],A=Nt[3],$=Nt[4],we=Nt[9]=Nt[9]===o?Me?0:u.length:_r(Nt[9]-Ge,0),!we&&m&(he|De)&&(m&=~(he|De)),!m||m==Ne)var tn=ly(u,m,T);else m==he||m==De?tn=Ph(u,m,we):(m==Ze||m==(Ne|Ze))&&!$.length?tn=uy(u,m,T,A):tn=hc.apply(o,Nt);var En=bt?to:yg;return vg(En(tn,Nt),u,m)}function hg(u,m,T,A){return u===o||Ts(u,dl[T])&&!jn.call(A,T)?m:u}function dg(u,m,T,A,$,Y){return br(u)&&br(m)&&(Y.set(m,u),Fs(u,m,o,dg,Y),Y.delete(m)),u}function cy(u){return n(u)?o:u}function fg(u,m,T,A,$,Y){var fe=T&Ae,we=u.length,Me=m.length;if(we!=Me&&!(fe&&Me>we))return!1;var Ge=Y.get(u),He=Y.get(m);if(Ge&&He)return Ge==m&&He==u;var et=-1,bt=!0,Nt=T&Fe?new wo:o;for(Y.set(u,m),Y.set(m,u);++et<we;){var tn=u[et],En=m[et];if(A)var nn=fe?A(En,tn,et,m,u,Y):A(tn,En,et,u,m,Y);if(nn!==o){if(nn)continue;bt=!1;break}if(Nt){if(!Gu(m,function(Rn,Vn){if(!Rs(Nt,Vn)&&(tn===Rn||$(tn,Rn,T,A,Y)))return Nt.push(Vn)})){bt=!1;break}}else if(!(tn===En||$(tn,En,T,A,Y))){bt=!1;break}}return Y.delete(u),Y.delete(m),bt}function hy(u,m,T,A,$,Y,fe){switch(T){case Ke:if(u.byteLength!=m.byteLength||u.byteOffset!=m.byteOffset)return!1;u=u.buffer,m=m.buffer;case fr:return!(u.byteLength!=m.byteLength||!Y(new di(u),new di(m)));case Zt:case rn:case dn:return Ts(+u,+m);case Qt:return u.name==m.name&&u.message==m.message;case Yt:case yr:return u==m+"";case sn:var we=ya;case Tr:var Me=A&Ae;if(we||(we=Wo),u.size!=m.size&&!Me)return!1;var Ge=fe.get(u);if(Ge)return Ge==m;A|=Fe,fe.set(u,m);var He=fg(we(u),we(m),A,$,Y,fe);return fe.delete(u),He;case Gr:if(Pa)return Pa.call(u)==Pa.call(m)}return!1}function yp(u,m,T,A,$,Y){var fe=T&Ae,we=El(u),Me=we.length,Ge=El(m),He=Ge.length;if(Me!=He&&!fe)return!1;for(var et=Me;et--;){var bt=we[et];if(!(fe?bt in m:jn.call(m,bt)))return!1}var Nt=Y.get(u),tn=Y.get(m);if(Nt&&tn)return Nt==m&&tn==u;var En=!0;Y.set(u,m),Y.set(m,u);for(var nn=fe;++et<Me;){bt=we[et];var Rn=u[bt],Vn=m[bt];if(A)var Io=fe?A(Vn,Rn,bt,m,u,Y):A(Rn,Vn,bt,u,m,Y);if(!(Io===o?Rn===Vn||$(Rn,Vn,T,A,Y):Io)){En=!1;break}nn||(nn=bt=="constructor")}if(En&&!nn){var Vs=u.constructor,ko=m.constructor;Vs!=ko&&"constructor"in u&&"constructor"in m&&!(typeof Vs=="function"&&Vs instanceof Vs&&typeof ko=="function"&&ko instanceof ko)&&(En=!1)}return Y.delete(u),Y.delete(m),En}function Fa(u){return kp(Kd(u,o,Ap),u+"")}function El(u){return ps(u,yn,gu)}function vp(u){return ps(u,$n,Xd)}var wr=vo?function(u){return vo.get(u)}:v1;function du(u){for(var m=u.name+"",T=ri[m],A=jn.call(ri,m)?T.length:0;A--;){var $=T[A],Y=$.func;if(Y==null||Y==u)return $.name}return m}function fu(u){var m=jn.call(H,"placeholder")?H:u;return m.placeholder}function Vt(){var u=H.iteratee||_1;return u=u===_1?gn:u,arguments.length?u(arguments[0],arguments[1]):u}function pu(u,m){var T=u.__data__;return _g(m)?T[typeof m=="string"?"string":"hash"]:T.map}function mu(u){for(var m=yn(u),T=m.length;T--;){var A=m[T],$=u[A];m[T]=[A,$,Tp($)]}return m}function Cl(u,m){var T=hh(u,m);return vs(T)?T:o}function pg(u){var m=jn.call(u,_o),T=u[_o];try{u[_o]=o;var A=!0}catch{}var $=$r.call(u);return A&&(m?u[_o]=T:delete u[_o]),$}var gu=Ql?function(u){return u==null?[]:(u=Hn(u),po(Ql(u),function(m){return Sa.call(u,m)}))}:x1,Xd=Ql?function(u){for(var m=[];u;)Vo(m,gu(u)),u=ml(u);return m}:x1,_i=hn;(yo&&_i(new yo(new ArrayBuffer(1)))!=Ke||eu&&_i(new eu)!=sn||yh&&_i(yh.resolve())!=bn||Ia&&_i(new Ia)!=Tr||gl&&_i(new gl)!=rr)&&(_i=function(u){var m=hn(u),T=m==Fn?u.constructor:o,A=T?_u(T):"";if(A)switch(A){case vt:return Ke;case nc:return sn;case vh:return bn;case zd:return Tr;case _l:return rr}return m});function xp(u,m,T){for(var A=-1,$=T.length;++A<$;){var Y=T[A],fe=Y.size;switch(Y.type){case"drop":u+=fe;break;case"dropRight":m-=fe;break;case"take":m=ni(m,u+fe);break;case"takeRight":u=_r(u,m-fe);break}}return{start:u,end:m}}function wp(u){var m=u.match(Mt);return m?m[1].split(Lt):[]}function bp(u,m,T){m=Jo(m,u);for(var A=-1,$=m.length,Y=!1;++A<$;){var fe=Qo(m[A]);if(!(Y=u!=null&&T(u,fe)))break;u=u[fe]}return Y||++A!=$?Y:($=u==null?0:u.length,!!$&&Ml($)&&Ba(fe,$)&&(en(u)||yu(u)))}function mg(u){var m=u.length,T=new u.constructor(m);return m&&typeof u[0]=="string"&&jn.call(u,"index")&&(T.index=u.index,T.input=u.input),T}function gg(u){return typeof u.constructor=="function"&&!Dh(u)?yl(ml(u)):{}}function dy(u,m,T){var A=u.constructor;switch(m){case fr:return au(u);case Zt:case rn:return new A(+u);case Ke:return $d(u,T);case ci:case Rr:case jr:case Pr:case rt:case Ht:case Ut:case hi:case qi:return dp(u,T);case sn:return new A;case dn:case yr:return new A(u);case Yt:return Vd(u);case Tr:return new A;case Gr:return og(u)}}function fy(u,m){var T=m.length;if(!T)return u;var A=T-1;return m[A]=(T>1?"& ":"")+m[A],m=m.join(T>2?", ":" "),u.replace(it,`{
/* [wrapped with `+m+`] */
`)}function py(u){return en(u)||yu(u)||!!(Ju&&u&&u[Ju])}function Ba(u,m){var T=typeof u;return m=m??Je,!!m&&(T=="number"||T!="symbol"&&Hr.test(u))&&u>-1&&u%1==0&&u<m}function Fr(u,m,T){if(!br(T))return!1;var A=typeof m;return(A=="number"?Vr(T)&&Ba(m,T.length):A=="string"&&m in T)?Ts(T[m],u):!1}function Sp(u,m){if(en(u))return!1;var T=typeof u;return T=="number"||T=="symbol"||T=="boolean"||u==null||x(u)?!0:Se.test(u)||!ye.test(u)||m!=null&&u in Hn(m)}function _g(u){var m=typeof u;return m=="string"||m=="number"||m=="symbol"||m=="boolean"?u!=="__proto__":u===null}function Il(u){var m=du(u),T=H[m];if(typeof T!="function"||!(m in ln.prototype))return!1;if(u===T)return!0;var A=wr(T);return!!A&&u===A[0]}function my(u){return!!fl&&fl in u}var gy=Kl?So:w1;function Dh(u){var m=u&&u.constructor,T=typeof m=="function"&&m.prototype||dl;return u===T}function Tp(u){return u===u&&!br(u)}function Ep(u,m){return function(T){return T==null?!1:T[u]===m&&(m!==o||u in Hn(T))}}function _y(u){var m=$h(u,function(A){return T.size===j&&T.clear(),A}),T=m.cache;return m}function yy(u,m){var T=u[1],A=m[1],$=T|A,Y=$<(Ne|se|ve),fe=A==ve&&T==he||A==ve&&T==ee&&u[7].length<=m[8]||A==(ve|ee)&&m[7].length<=m[8]&&T==he;if(!(Y||fe))return u;A&Ne&&(u[2]=m[2],$|=T&Ne?0:ue);var we=m[3];if(we){var Me=u[3];u[3]=Me?lu(Me,we,m[4]):we,u[4]=Me?Hi(u[3],J):m[4]}return we=m[5],we&&(Me=u[5],u[5]=Me?qd(Me,we,m[6]):we,u[6]=Me?Hi(u[5],J):m[6]),we=m[7],we&&(u[7]=we),A&ve&&(u[8]=u[8]==null?m[8]:ni(u[8],m[8])),u[9]==null&&(u[9]=m[9]),u[0]=m[0],u[1]=$,u}function vy(u){var m=[];if(u!=null)for(var T in Hn(u))m.push(T);return m}function xy(u){return $r.call(u)}function Kd(u,m,T){return m=_r(m===o?u.length-1:m,0),function(){for(var A=arguments,$=-1,Y=_r(A.length-m,0),fe=Oe(Y);++$<Y;)fe[$]=A[m+$];$=-1;for(var we=Oe(m+1);++$<m;)we[$]=A[$];return we[m]=T(fe),Ri(u,this,we)}}function dc(u,m){return m.length<2?u:Cr(u,gi(m,0,-1))}function Cp(u,m){for(var T=u.length,A=ni(m.length,T),$=Ji(u);A--;){var Y=m[A];u[A]=Ba(Y,T)?$[Y]:o}return u}function Ip(u,m){if(!(m==="constructor"&&typeof u[m]=="function")&&m!="__proto__")return u[m]}var yg=pc(to),fc=Ea||function(u,m){return pr.setTimeout(u,m)},kp=pc(Tl);function vg(u,m,T){var A=m+"";return kp(u,fy(A,wy(wp(A),T)))}function pc(u){var m=0,T=0;return function(){var A=ds(),$=mt-(A-T);if(T=A,$>0){if(++m>=Xe)return arguments[0]}else m=0;return u.apply(o,arguments)}}function Lh(u,m){var T=-1,A=u.length,$=A-1;for(m=m===o?A:m;++T<m;){var Y=Bd(T,$),fe=u[Y];u[Y]=u[T],u[T]=fe}return u.length=m,u}var xg=_y(function(u){var m=[];return u.charCodeAt(0)===46&&m.push(""),u.replace(ke,function(T,A,$,Y){m.push($?Y.replace(kn,"$1"):A||T)}),m});function Qo(u){if(typeof u=="string"||x(u))return u;var m=u+"";return m=="0"&&1/u==-zt?"-0":m}function _u(u){if(u!=null){try{return wa.call(u)}catch{}try{return u+""}catch{}}return""}function wy(u,m){return Kr(Sn,function(T){var A="_."+T[0];m&T[1]&&!$o(u,A)&&u.push(A)}),u.sort()}function wg(u){if(u instanceof ln)return u.clone();var m=new fs(u.__wrapped__,u.__chain__);return m.__actions__=Ji(u.__actions__),m.__index__=u.__index__,m.__values__=u.__values__,m}function by(u,m,T){(T?Fr(u,m,T):m===o)?m=1:m=_r(Z(m),0);var A=u==null?0:u.length;if(!A||m<1)return[];for(var $=0,Y=0,fe=Oe(Ca(A/m));$<A;)fe[Y++]=gi(u,$,$+=m);return fe}function bg(u){for(var m=-1,T=u==null?0:u.length,A=0,$=[];++m<T;){var Y=u[m];Y&&($[A++]=Y)}return $}function Pp(){var u=arguments.length;if(!u)return[];for(var m=Oe(u-1),T=arguments[0],A=u;A--;)m[A-1]=arguments[A];return Vo(en(T)?Ji(T):[T],tt(m,1))}var Sg=_n(function(u,m){return Mr(u)?at(u,tt(m,1,Mr,!0)):[]}),Tg=_n(function(u,m){var T=Ns(m);return Mr(T)&&(T=o),Mr(u)?at(u,tt(m,1,Mr,!0),Vt(T,2)):[]}),Eg=_n(function(u,m){var T=Ns(m);return Mr(T)&&(T=o),Mr(u)?at(u,tt(m,1,Mr,!0),o,T):[]});function Sy(u,m,T){var A=u==null?0:u.length;return A?(m=T||m===o?1:Z(m),gi(u,m<0?0:m,A)):[]}function Yd(u,m,T){var A=u==null?0:u.length;return A?(m=T||m===o?1:Z(m),m=A-m,gi(u,0,m<0?0:m)):[]}function Ty(u,m){return u&&u.length?Ih(u,Vt(m,3),!0,!0):[]}function Cg(u,m){return u&&u.length?Ih(u,Vt(m,3),!0):[]}function Ey(u,m,T,A){var $=u==null?0:u.length;return $?(T&&typeof T!="number"&&Fr(u,m,T)&&(T=0,A=$),Wt(u,m,T,A)):[]}function Ig(u,m,T){var A=u==null?0:u.length;if(!A)return-1;var $=T==null?0:Z(T);return $<0&&($=_r(A+$,0)),us(u,Vt(m,3),$)}function kg(u,m,T){var A=u==null?0:u.length;if(!A)return-1;var $=A-1;return T!==o&&($=Z(T),$=T<0?_r(A+$,0):ni($,A-1)),us(u,Vt(m,3),$,!0)}function Ap(u){var m=u==null?0:u.length;return m?tt(u,1):[]}function Cy(u){var m=u==null?0:u.length;return m?tt(u,zt):[]}function Iy(u,m){var T=u==null?0:u.length;return T?(m=m===o?1:Z(m),tt(u,m)):[]}function Rh(u){for(var m=-1,T=u==null?0:u.length,A={};++m<T;){var $=u[m];A[$[0]]=$[1]}return A}function Br(u){return u&&u.length?u[0]:o}function Pg(u,m,T){var A=u==null?0:u.length;if(!A)return-1;var $=T==null?0:Z(T);return $<0&&($=_r(A+$,0)),qo(u,m,$)}function Ag(u){var m=u==null?0:u.length;return m?gi(u,0,-1):[]}var Mg=_n(function(u){var m=ir(u,kh);return m.length&&m[0]===u[0]?ms(m):[]}),Kn=_n(function(u){var m=Ns(u),T=ir(u,kh);return m===Ns(T)?m=o:T.pop(),T.length&&T[0]===u[0]?ms(T,Vt(m,2)):[]}),Mp=_n(function(u){var m=Ns(u),T=ir(u,kh);return m=typeof m=="function"?m:o,m&&T.pop(),T.length&&T[0]===u[0]?ms(T,o,m):[]});function zg(u,m){return u==null?"":_h.call(u,m)}function Ns(u){var m=u==null?0:u.length;return m?u[m-1]:o}function Na(u,m,T){var A=u==null?0:u.length;if(!A)return-1;var $=A;return T!==o&&($=Z(T),$=$<0?_r(A+$,0):ni($,A-1)),m===m?cl(u,m,$):us(u,Hu,$,!0)}function mc(u,m){return u&&u.length?iu(u,Z(m)):o}var Dg=_n(Lg);function Lg(u,m){return u&&u.length&&m&&m.length?Da(u,m):u}function ky(u,m,T){return u&&u.length&&m&&m.length?Da(u,m,Vt(T,2)):u}function Py(u,m,T){return u&&u.length&&m&&m.length?Da(u,m,o,T):u}var Ay=Fa(function(u,m){var T=u==null?0:u.length,A=te(u,m);return Th(u,ir(m,function($){return Ba($,T)?+$:$}).sort(ag)),A});function My(u,m){var T=[];if(!(u&&u.length))return T;var A=-1,$=[],Y=u.length;for(m=Vt(m,3);++A<Y;){var fe=u[A];m(fe,A,u)&&(T.push(fe),$.push(A))}return Th(u,$),T}function zp(u){return u==null?u:Os.call(u)}function zy(u,m,T){var A=u==null?0:u.length;return A?(T&&typeof T!="number"&&Fr(u,m,T)?(m=0,T=A):(m=m==null?0:Z(m),T=T===o?A:Z(T)),gi(u,m,T)):[]}function Dy(u,m){return Ch(u,m)}function Ly(u,m,T){return Ir(u,m,Vt(T,2))}function Jd(u,m){var T=u==null?0:u.length;if(T){var A=Ch(u,m);if(A<T&&Ts(u[A],m))return A}return-1}function gc(u,m){return Ch(u,m,!0)}function Rg(u,m,T){return Ir(u,m,Vt(T,2),!0)}function Dp(u,m){var T=u==null?0:u.length;if(T){var A=Ch(u,m,!0)-1;if(Ts(u[A],m))return A}return-1}function Lp(u){return u&&u.length?Nd(u):[]}function Ry(u,m){return u&&u.length?Nd(u,Vt(m,2)):[]}function Oy(u){var m=u==null?0:u.length;return m?gi(u,1,m):[]}function Fy(u,m,T){return u&&u.length?(m=T||m===o?1:Z(m),gi(u,0,m<0?0:m)):[]}function Og(u,m,T){var A=u==null?0:u.length;return A?(m=T||m===o?1:Z(m),m=A-m,gi(u,m<0?0:m,A)):[]}function Fg(u,m){return u&&u.length?Ih(u,Vt(m,3),!1,!0):[]}function Qi(u,m){return u&&u.length?Ih(u,Vt(m,3)):[]}var Rp=_n(function(u){return xs(tt(u,1,Mr,!0))}),Bg=_n(function(u){var m=Ns(u);return Mr(m)&&(m=o),xs(tt(u,1,Mr,!0),Vt(m,2))}),kl=_n(function(u){var m=Ns(u);return m=typeof m=="function"?m:o,xs(tt(u,1,Mr,!0),o,m)});function Oh(u){return u&&u.length?xs(u):[]}function Fh(u,m){return u&&u.length?xs(u,Vt(m,2)):[]}function _c(u,m){return m=typeof m=="function"?m:o,u&&u.length?xs(u,o,m):[]}function yc(u){if(!(u&&u.length))return[];var m=0;return u=po(u,function(T){if(Mr(T))return m=_r(T.length,m),!0}),uh(m,function(T){return ir(u,Gl(T))})}function Bh(u,m){if(!(u&&u.length))return[];var T=yc(u);return m==null?T:ir(T,function(A){return Ri(m,o,A)})}var By=_n(function(u,m){return Mr(u)?at(u,m):[]}),Ny=_n(function(u){return jd(po(u,Mr))}),Ng=_n(function(u){var m=Ns(u);return Mr(m)&&(m=o),jd(po(u,Mr),Vt(m,2))}),Ug=_n(function(u){var m=Ns(u);return m=typeof m=="function"?m:o,jd(po(u,Mr),o,m)}),Uy=_n(yc);function jg(u,m){return rg(u||[],m||[],X)}function $g(u,m){return rg(u||[],m||[],Bs)}var Op=_n(function(u){var m=u.length,T=m>1?u[m-1]:o;return T=typeof T=="function"?(u.pop(),T):o,Bh(u,T)});function Qd(u){var m=H(u);return m.__chain__=!0,m}function jy(u,m){return m(u),u}function ef(u,m){return m(u)}var Vg=Fa(function(u){var m=u.length,T=m?u[0]:0,A=this.__wrapped__,$=function(Y){return te(Y,u)};return m>1||this.__actions__.length||!(A instanceof ln)||!Ba(T)?this.thru($):(A=A.slice(T,+T+(m?1:0)),A.__actions__.push({func:ef,args:[$],thisArg:o}),new fs(A,this.__chain__).thru(function(Y){return m&&!Y.length&&Y.push(o),Y}))});function qg(){return Qd(this)}function Nh(){return new fs(this.value(),this.__chain__)}function ea(){this.__values__===o&&(this.__values__=U(this.value()));var u=this.__index__>=this.__values__.length,m=u?o:this.__values__[this.__index__++];return{done:u,value:m}}function Pl(){return this}function Zg(u){for(var m,T=this;T instanceof vl;){var A=wg(T);A.__index__=0,A.__values__=o,m?$.__wrapped__=A:m=A;var $=A;T=T.__wrapped__}return $.__wrapped__=u,m}function Fp(){var u=this.__wrapped__;if(u instanceof ln){var m=u;return this.__actions__.length&&(m=new ln(this)),m=m.reverse(),m.__actions__.push({func:ef,args:[zp],thisArg:o}),new fs(m,this.__chain__)}return this.thru(zp)}function $y(){return ng(this.__wrapped__,this.__actions__)}var Vy=Wd(function(u,m,T){jn.call(u,T)?++u[T]:me(u,T,1)});function tf(u,m,T){var A=en(u)?Td:ot;return T&&Fr(u,m,T)&&(m=o),A(u,Vt(m,3))}function Bp(u,m){var T=en(u)?po:ht;return T(u,Vt(m,3))}var qy=bs(Ig),Np=bs(kg);function Up(u,m){return tt(sf(u,m),1)}function vc(u,m){return tt(sf(u,m),zt)}function Wg(u,m,T){return T=T===o?1:Z(T),tt(sf(u,m),T)}function jp(u,m){var T=en(u)?Kr:pt;return T(u,Vt(m,3))}function nf(u,m){var T=en(u)?Sd:st;return T(u,Vt(m,3))}var Gg=Wd(function(u,m,T){jn.call(u,T)?u[T].push(m):me(u,T,[m])});function rf(u,m,T,A){u=Vr(u)?u:Is(u),T=T&&!A?Z(T):0;var $=u.length;return T<0&&(T=_r($+T,0)),v(u)?T<=$&&u.indexOf(m,T)>-1:!!$&&qo(u,m,T)>-1}var Hg=_n(function(u,m,T){var A=-1,$=typeof m=="function",Y=Vr(u)?Oe(u.length):[];return pt(u,function(fe){Y[++A]=$?Ri(m,fe,T):Ko(fe,m,T)}),Y}),Zy=Wd(function(u,m,T){me(u,T,m)});function sf(u,m){var T=en(u)?ir:bh;return T(u,Vt(m,3))}function Xg(u,m,T,A){return u==null?[]:(en(m)||(m=m==null?[]:[m]),T=A?o:T,en(T)||(T=T==null?[]:[T]),bl(u,m,T))}var Wy=Wd(function(u,m,T){u[T?0:1].push(m)},function(){return[[],[]]});function Gy(u,m,T){var A=en(u)?oh:Xu,$=arguments.length<3;return A(u,Vt(m,4),T,$,pt)}function Hy(u,m,T){var A=en(u)?Ed:Xu,$=arguments.length<3;return A(u,Vt(m,4),T,$,st)}function Xy(u,m){var T=en(u)?po:ht;return T(u,Vh(Vt(m,3)))}function $p(u){var m=en(u)?z:Eh;return m(u)}function Al(u,m,T){(T?Fr(u,m,T):m===o)?m=1:m=Z(m);var A=en(u)?R:uc;return A(u,m)}function Kg(u){var m=en(u)?O:tg;return m(u)}function Yg(u){if(u==null)return 0;if(Vr(u))return v(u)?va(u):u.length;var m=_i(u);return m==sn||m==Tr?u.size:bo(u).length}function Jg(u,m,T){var A=en(u)?Gu:oy;return T&&Fr(u,m,T)&&(m=o),A(u,Vt(m,3))}var Qg=_n(function(u,m){if(u==null)return[];var T=m.length;return T>1&&Fr(u,m[0],m[1])?m=[]:T>2&&Fr(m[0],m[1],m[2])&&(m=[m[0]]),bl(u,tt(m,1),[])}),Uh=mh||function(){return pr.Date.now()};function Vp(u,m){if(typeof m!="function")throw new Ei(w);return u=Z(u),function(){if(--u<1)return m.apply(this,arguments)}}function xc(u,m,T){return m=T?o:m,m=u&&m==null?u.length:m,Oa(u,ve,o,o,o,o,m)}function qp(u,m){var T;if(typeof m!="function")throw new Ei(w);return u=Z(u),function(){return--u>0&&(T=m.apply(this,arguments)),u<=1&&(m=o),T}}var jh=_n(function(u,m,T){var A=Ne;if(T.length){var $=Hi(T,fu(jh));A|=Ze}return Oa(u,A,m,T,$)}),Zp=_n(function(u,m,T){var A=Ne|se;if(T.length){var $=Hi(T,fu(Zp));A|=Ze}return Oa(m,A,u,T,$)});function Ss(u,m,T){m=T?o:m;var A=Oa(u,he,o,o,o,o,o,m);return A.placeholder=Ss.placeholder,A}function wc(u,m,T){m=T?o:m;var A=Oa(u,De,o,o,o,o,o,m);return A.placeholder=wc.placeholder,A}function Wp(u,m,T){var A,$,Y,fe,we,Me,Ge=0,He=!1,et=!1,bt=!0;if(typeof u!="function")throw new Ei(w);m=oe(m)||0,br(T)&&(He=!!T.leading,et="maxWait"in T,Y=et?_r(oe(T.maxWait)||0,m):Y,bt="trailing"in T?!!T.trailing:bt);function Nt(li){var ja=A,bu=$;return A=$=o,Ge=li,fe=u.apply(bu,ja),fe}function tn(li){return Ge=li,we=fc(Rn,m),He?Nt(li):fe}function En(li){var ja=li-Me,bu=li-Ge,Iw=m-ja;return et?ni(Iw,Y-bu):Iw}function nn(li){var ja=li-Me,bu=li-Ge;return Me===o||ja>=m||ja<0||et&&bu>=Y}function Rn(){var li=Uh();if(nn(li))return Vn(li);we=fc(Rn,En(li))}function Vn(li){return we=o,bt&&A?Nt(li):(A=$=o,fe)}function Io(){we!==o&&ou(we),Ge=0,A=Me=$=we=o}function Vs(){return we===o?fe:Vn(Uh())}function ko(){var li=Uh(),ja=nn(li);if(A=arguments,$=this,Me=li,ja){if(we===o)return tn(Me);if(et)return ou(we),we=fc(Rn,m),Nt(Me)}return we===o&&(we=fc(Rn,m)),fe}return ko.cancel=Io,ko.flush=Vs,ko}var e_=_n(function(u,m){return Qe(u,1,m)}),t_=_n(function(u,m,T){return Qe(u,oe(m)||0,T)});function n_(u){return Oa(u,de)}function $h(u,m){if(typeof u!="function"||m!=null&&typeof m!="function")throw new Ei(w);var T=function(){var A=arguments,$=m?m.apply(this,A):A[0],Y=T.cache;if(Y.has($))return Y.get($);var fe=u.apply(this,A);return T.cache=Y.set($,fe)||Y,fe};return T.cache=new($h.Cache||Jr),T}$h.Cache=Jr;function Vh(u){if(typeof u!="function")throw new Ei(w);return function(){var m=arguments;switch(m.length){case 0:return!u.call(this);case 1:return!u.call(this,m[0]);case 2:return!u.call(this,m[0],m[1]);case 3:return!u.call(this,m[0],m[1],m[2])}return!u.apply(this,m)}}function Ky(u){return qp(2,u)}var r_=ig(function(u,m){m=m.length==1&&en(m[0])?ir(m[0],pn(Vt())):ir(tt(m,1),pn(Vt()));var T=m.length;return _n(function(A){for(var $=-1,Y=ni(A.length,T);++$<Y;)A[$]=m[$].call(this,A[$]);return Ri(u,this,A)})}),ta=_n(function(u,m){var T=Hi(m,fu(ta));return Oa(u,Ze,o,m,T)}),Gp=_n(function(u,m){var T=Hi(m,fu(Gp));return Oa(u,je,o,m,T)}),i_=Fa(function(u,m){return Oa(u,ee,o,o,o,m)});function s_(u,m){if(typeof u!="function")throw new Ei(w);return m=m===o?m:Z(m),_n(u,m)}function o_(u,m){if(typeof u!="function")throw new Ei(w);return m=m==null?0:_r(Z(m),0),_n(function(T){var A=T[m],$=La(T,0,m);return A&&Vo($,A),Ri(u,this,$)})}function Yy(u,m,T){var A=!0,$=!0;if(typeof u!="function")throw new Ei(w);return br(T)&&(A="leading"in T?!!T.leading:A,$="trailing"in T?!!T.trailing:$),Wp(u,m,{leading:A,maxWait:m,trailing:$})}function Jy(u){return xc(u,1)}function a_(u,m){return ta(hp(m),u)}function bc(){if(!arguments.length)return[];var u=arguments[0];return en(u)?u:[u]}function l_(u){return be(u,Ee)}function of(u,m){return m=typeof m=="function"?m:o,be(u,Ee,m)}function u_(u){return be(u,G|Ee)}function af(u,m){return m=typeof m=="function"?m:o,be(u,G|Ee,m)}function lf(u,m){return m==null||qe(u,m,yn(m))}function Ts(u,m){return u===m||u!==u&&m!==m}var Qy=Mh(fi),e1=Mh(function(u,m){return u>=m}),yu=Ma(function(){return arguments}())?Ma:function(u){return zr(u)&&jn.call(u,"callee")&&!Sa.call(u,"callee")},en=Oe.isArray,yi=th?pn(th):gs;function Vr(u){return u!=null&&Ml(u.length)&&!So(u)}function Mr(u){return zr(u)&&Vr(u)}function c_(u){return u===!0||u===!1||zr(u)&&hn(u)==Zt}var Ua=gh||w1,Hp=wd?pn(wd):ac;function t1(u){return zr(u)&&u.nodeType===1&&!n(u)}function h_(u){if(u==null)return!0;if(Vr(u)&&(en(u)||typeof u=="string"||typeof u.splice=="function"||Ua(u)||S(u)||yu(u)))return!u.length;var m=_i(u);if(m==sn||m==Tr)return!u.size;if(Dh(u))return!bo(u).length;for(var T in u)if(jn.call(u,T))return!1;return!0}function d_(u,m){return za(u,m)}function n1(u,m,T){T=typeof T=="function"?T:o;var A=T?T(u,m):o;return A===o?za(u,m,o,T):!!A}function uf(u){if(!zr(u))return!1;var m=hn(u);return m==Qt||m==Zn||typeof u.message=="string"&&typeof u.name=="string"&&!n(u)}function Xp(u){return typeof u=="number"&&Qu(u)}function So(u){if(!br(u))return!1;var m=hn(u);return m==wn||m==er||m==Nn||m==Rt}function Kp(u){return typeof u=="number"&&u==Z(u)}function Ml(u){return typeof u=="number"&&u>-1&&u%1==0&&u<=Je}function br(u){var m=typeof u;return u!=null&&(m=="object"||m=="function")}function zr(u){return u!=null&&typeof u=="object"}var cf=nh?pn(nh):ys;function hf(u,m){return u===m||eo(u,m,mu(m))}function qh(u,m,T){return T=typeof T=="function"?T:o,eo(u,m,mu(m),T)}function Yp(u){return i(u)&&u!=+u}function Jp(u){if(gy(u))throw new Gt(b);return vs(u)}function Qp(u){return u===null}function r1(u){return u==null}function i(u){return typeof u=="number"||zr(u)&&hn(u)==dn}function n(u){if(!zr(u)||hn(u)!=Fn)return!1;var m=ml(u);if(m===null)return!0;var T=jn.call(m,"constructor")&&m.constructor;return typeof T=="function"&&T instanceof T&&wa.call(T)==ba}var s=Wu?pn(Wu):ii;function l(u){return Kp(u)&&u>=-Je&&u<=Je}var p=rh?pn(rh):mi;function v(u){return typeof u=="string"||!en(u)&&zr(u)&&hn(u)==yr}function x(u){return typeof u=="symbol"||zr(u)&&hn(u)==Gr}var S=ih?pn(ih):Yi;function C(u){return u===o}function P(u){return zr(u)&&_i(u)==rr}function M(u){return zr(u)&&hn(u)==dr}var L=Mh(Yo),F=Mh(function(u,m){return u<=m});function U(u){if(!u)return[];if(Vr(u))return v(u)?Xi(u):Ji(u);if(Ho&&u[Ho])return _a(u[Ho]());var m=_i(u),T=m==sn?ya:m==Tr?Wo:Is;return T(u)}function W(u){if(!u)return u===0?u:0;if(u=oe(u),u===zt||u===-zt){var m=u<0?-1:1;return m*nt}return u===u?u:0}function Z(u){var m=W(u),T=m%1;return m===m?T?m-T:m:0}function ne(u){return u?xe(Z(u),0,ct):0}function oe(u){if(typeof u=="number")return u;if(x(u))return Et;if(br(u)){var m=typeof u.valueOf=="function"?u.valueOf():u;u=br(m)?m+"":m}if(typeof u!="string")return u===0?u:+u;u=Hl(u);var T=on.test(u);return T||ur.test(u)?ip(u.slice(2),T?2:8):xr.test(u)?Et:+u}function Pe(u){return ws(u,$n(u))}function ge(u){return u?xe(Z(u),-Je,Je):u===0?u:0}function _e(u){return u==null?"":si(u)}var Re=uu(function(u,m){if(Dh(m)||Vr(m)){ws(m,yn(m),u);return}for(var T in m)jn.call(m,T)&&X(u,T,m[T])}),Ye=uu(function(u,m){ws(m,$n(m),u)}),gt=uu(function(u,m,T,A){ws(m,$n(m),u,A)}),Ot=uu(function(u,m,T,A){ws(m,yn(m),u,A)}),_t=Fa(te);function dt(u,m){var T=yl(u);return m==null?T:le(T,m)}var Pt=_n(function(u,m){u=Hn(u);var T=-1,A=m.length,$=A>2?m[2]:o;for($&&Fr(m[0],m[1],$)&&(A=1);++T<A;)for(var Y=m[T],fe=$n(Y),we=-1,Me=fe.length;++we<Me;){var Ge=fe[we],He=u[Ge];(He===o||Ts(He,dl[Ge])&&!jn.call(u,Ge))&&(u[Ge]=Y[Ge])}return u}),xt=_n(function(u){return u.push(o,dg),Ri(oi,o,u)});function yt(u,m){return Zl(u,Vt(m,3),$t)}function $e(u,m){return Zl(u,Vt(m,3),un)}function At(u,m){return u==null?u:jt(u,Vt(m,3),$n)}function kt(u,m){return u==null?u:sr(u,Vt(m,3),$n)}function qt(u,m){return u&&$t(u,Vt(m,3))}function tr(u,m){return u&&un(u,Vt(m,3))}function Yn(u){return u==null?[]:Xn(u,yn(u))}function Qr(u){return u==null?[]:Xn(u,$n(u))}function Es(u,m,T){var A=u==null?o:Cr(u,m);return A===o?T:A}function vi(u,m){return u!=null&&bp(u,m,Ci)}function Nr(u,m){return u!=null&&bp(u,m,pi)}var Bi=lg(function(u,m,T){m!=null&&typeof m.toString!="function"&&(m=$r.call(m)),u[m]=T},g1(ro)),Ni=lg(function(u,m,T){m!=null&&typeof m.toString!="function"&&(m=$r.call(m)),jn.call(u,m)?u[m].push(T):u[m]=[T]},Vt),Ui=_n(Ko);function yn(u){return Vr(u)?k(u):bo(u)}function $n(u){return Vr(u)?k(u,!0):wl(u)}function ki(u,m){var T={};return m=Vt(m,3),$t(u,function(A,$,Y){me(T,m(A,$,Y),A)}),T}function xi(u,m){var T={};return m=Vt(m,3),$t(u,function(A,$,Y){me(T,$,m(A,$,Y))}),T}var ji=uu(function(u,m,T){Fs(u,m,T)}),oi=uu(function(u,m,T,A){Fs(u,m,T,A)}),Us=Fa(function(u,m){var T={};if(u==null)return T;var A=!1;m=ir(m,function(Y){return Y=Jo(Y,u),A||(A=Y.length>1),Y}),ws(u,vp(u),T),A&&(T=be(T,G|q|Ee,cy));for(var $=m.length;$--;)cc(T,m[$]);return T});function es(u,m){return nr(u,Vh(Vt(m)))}var zn=Fa(function(u,m){return u==null?{}:lc(u,m)});function nr(u,m){if(u==null)return{};var T=ir(vp(u),function(A){return[A]});return m=Vt(m),su(u,T,function(A,$){return m(A,$[0])})}function lr(u,m,T){m=Jo(m,u);var A=-1,$=m.length;for($||($=1,u=o);++A<$;){var Y=u==null?o:u[Qo(m[A])];Y===o&&(A=$,Y=T),u=So(Y)?Y.call(u):Y}return u}function Cs(u,m,T){return u==null?u:Bs(u,m,T)}function Sr(u,m,T,A){return A=typeof A=="function"?A:o,u==null?u:Bs(u,m,T,A)}var vu=cg(yn),To=cg($n);function na(u,m,T){var A=en(u),$=A||Ua(u)||S(u);if(m=Vt(m,4),T==null){var Y=u&&u.constructor;$?T=A?new Y:[]:br(u)?T=So(Y)?yl(ml(u)):{}:T={}}return($?Kr:$t)(u,function(fe,we,Me){return m(T,fe,we,Me)}),T}function no(u,m){return u==null?!0:cc(u,m)}function js(u,m,T){return u==null?u:Ud(u,m,hp(T))}function ai(u,m,T,A){return A=typeof A=="function"?A:o,u==null?u:Ud(u,m,hp(T),A)}function Is(u){return u==null?[]:Un(u,yn(u))}function Zh(u){return u==null?[]:Un(u,$n(u))}function f_(u,m,T){return T===o&&(T=m,m=o),T!==o&&(T=oe(T),T=T===T?T:0),m!==o&&(m=oe(m),m=m===m?m:0),xe(oe(u),m,T)}function p_(u,m,T){return m=W(m),T===o?(T=m,m=0):T=W(T),u=oe(u),Ii(u,m,T)}function em(u,m,T){if(T&&typeof T!="boolean"&&Fr(u,m,T)&&(m=T=o),T===o&&(typeof m=="boolean"?(T=m,m=o):typeof u=="boolean"&&(T=u,u=o)),u===o&&m===o?(u=0,m=1):(u=W(u),m===o?(m=u,u=0):m=W(m)),u>m){var A=u;u=m,m=A}if(T||u%1||m%1){var $=tc();return ni(u+$*(m-u+Ys("1e-"+(($+"").length-1))),m)}return Bd(u,m)}var tm=cu(function(u,m,T){return m=m.toLowerCase(),u+(T?ra(m):m)});function ra(u){return m1(_e(u).toLowerCase())}function nm(u){return u=_e(u),u&&u.replace(ti,ga).replace(_d,"")}function m_(u,m,T){u=_e(u),m=si(m);var A=u.length;T=T===o?A:xe(Z(T),0,A);var $=T;return T-=m.length,T>=0&&u.slice(T,$)==m}function i1(u){return u=_e(u),u&&N.test(u)?u.replace(Ds,al):u}function s1(u){return u=_e(u),u&&Be.test(u)?u.replace(pe,"\\$&"):u}var o1=cu(function(u,m,T){return u+(T?"-":"")+m.toLowerCase()}),a1=cu(function(u,m,T){return u+(T?" ":"")+m.toLowerCase()}),l1=Gd("toLowerCase");function u1(u,m,T){u=_e(u),m=Z(m);var A=m?va(u):0;if(!m||A>=m)return u;var $=(m-A)/2;return Hd(Xo($),T)+u+Hd(Ca($),T)}function c1(u,m,T){u=_e(u),m=Z(m);var A=m?va(u):0;return m&&A<m?u+Hd(m-A,T):u}function h1(u,m,T){u=_e(u),m=Z(m);var A=m?va(u):0;return m&&A<m?Hd(m-A,T)+u:u}function Eo(u,m,T){return T||m==null?m=0:m&&(m=+m),Qs(_e(u).replace(We,""),m||0)}function df(u,m,T){return(T?Fr(u,m,T):m===o)?m=1:m=Z(m),up(_e(u),m)}function g_(){var u=arguments,m=_e(u[0]);return u.length<3?m:m.replace(u[1],u[2])}var d1=cu(function(u,m,T){return u+(T?"_":"")+m.toLowerCase()});function f1(u,m,T){return T&&typeof T!="number"&&Fr(u,m,T)&&(m=T=o),T=T===o?ct:T>>>0,T?(u=_e(u),u&&(typeof m=="string"||m!=null&&!s(m))&&(m=si(m),!m&&Zo(u))?La(Xi(u),0,T):u.split(m,T)):[]}var p1=cu(function(u,m,T){return u+(T?" ":"")+m1(m)});function Pi(u,m,T){return u=_e(u),T=T==null?0:xe(Z(T),0,u.length),m=si(m),u.slice(T,T+m.length)==m}function $s(u,m,T){var A=H.templateSettings;T&&Fr(u,m,T)&&(m=o),u=_e(u),m=gt({},m,A,hg);var $=gt({},m.imports,A.imports,hg),Y=yn($),fe=Un($,Y),we,Me,Ge=0,He=m.interpolate||Xr,et="__p += '",bt=Go((m.escape||Xr).source+"|"+He.source+"|"+(He===re?fn:Xr).source+"|"+(m.evaluate||Xr).source+"|$","g"),Nt="//# sourceURL="+(jn.call(m,"sourceURL")?(m.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++rp+"]")+`
`;u.replace(bt,function(nn,Rn,Vn,Io,Vs,ko){return Vn||(Vn=Io),et+=u.slice(Ge,ko).replace(Qa,cs),Rn&&(we=!0,et+=`' +
__e(`+Rn+`) +
'`),Vs&&(Me=!0,et+=`';
`+Vs+`;
__p += '`),Vn&&(et+=`' +
((__t = (`+Vn+`)) == null ? '' : __t) +
'`),Ge=ko+nn.length,nn}),et+=`';
`;var tn=jn.call(m,"variable")&&m.variable;if(!tn)et=`with (obj) {
`+et+`
}
`;else if(Jt.test(tn))throw new Gt(c);et=(Me?et.replace(Xt,""):et).replace(Ks,"$1").replace(uo,"$1;"),et="function("+(tn||"obj")+`) {
`+(tn?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(we?", __e = _.escape":"")+(Me?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+et+`return __p
}`;var En=Ew(function(){return Tn(Y,Nt+"return "+et).apply(o,fe)});if(En.source=et,uf(En))throw En;return En}function xu(u){return _e(u).toLowerCase()}function Co(u){return _e(u).toUpperCase()}function wu(u,m,T){if(u=_e(u),u&&(T||m===o))return Hl(u);if(!u||!(m=si(m)))return u;var A=Xi(u),$=Xi(m),Y=sl(A,$),fe=ol(A,$)+1;return La(A,Y,fe).join("")}function ia(u,m,T){if(u=_e(u),u&&(T||m===o))return u.slice(0,An(u)+1);if(!u||!(m=si(m)))return u;var A=Xi(u),$=ol(A,Xi(m))+1;return La(A,0,$).join("")}function nS(u,m,T){if(u=_e(u),u&&(T||m===o))return u.replace(We,"");if(!u||!(m=si(m)))return u;var A=Xi(u),$=sl(A,Xi(m));return La(A,$).join("")}function rS(u,m){var T=Te,A=Ue;if(br(m)){var $="separator"in m?m.separator:$;T="length"in m?Z(m.length):T,A="omission"in m?si(m.omission):A}u=_e(u);var Y=u.length;if(Zo(u)){var fe=Xi(u);Y=fe.length}if(T>=Y)return u;var we=T-va(A);if(we<1)return A;var Me=fe?La(fe,0,we).join(""):u.slice(0,we);if($===o)return Me+A;if(fe&&(we+=Me.length-we),s($)){if(u.slice(we).search($)){var Ge,He=Me;for($.global||($=Go($.source,_e(Ar.exec($))+"g")),$.lastIndex=0;Ge=$.exec(He);)var et=Ge.index;Me=Me.slice(0,et===o?we:et)}}else if(u.indexOf(si($),we)!=we){var bt=Me.lastIndexOf($);bt>-1&&(Me=Me.slice(0,bt))}return Me+A}function iS(u){return u=_e(u),u&&ae.test(u)?u.replace(co,Yu):u}var sS=cu(function(u,m,T){return u+(T?" ":"")+m.toUpperCase()}),m1=Gd("toUpperCase");function Tw(u,m,T){return u=_e(u),m=T?o:m,m===o?dh(u)?hl(u):Id(u):u.match(m)||[]}var Ew=_n(function(u,m){try{return Ri(u,o,m)}catch(T){return uf(T)?T:new Gt(T)}}),oS=Fa(function(u,m){return Kr(m,function(T){T=Qo(T),me(u,T,jh(u[T],u))}),u});function aS(u){var m=u==null?0:u.length,T=Vt();return u=m?ir(u,function(A){if(typeof A[1]!="function")throw new Ei(w);return[T(A[0]),A[1]]}):[],_n(function(A){for(var $=-1;++$<m;){var Y=u[$];if(Ri(Y[0],this,A))return Ri(Y[1],this,A)}})}function lS(u){return ze(be(u,G))}function g1(u){return function(){return u}}function uS(u,m){return u==null||u!==u?m:u}var cS=mp(),hS=mp(!0);function ro(u){return u}function _1(u){return gn(typeof u=="function"?u:be(u,G))}function dS(u){return Od(be(u,G))}function fS(u,m){return Sh(u,be(m,G))}var pS=_n(function(u,m){return function(T){return Ko(T,u,m)}}),mS=_n(function(u,m){return function(T){return Ko(u,T,m)}});function y1(u,m,T){var A=yn(m),$=Xn(m,A);T==null&&!(br(m)&&($.length||!A.length))&&(T=m,m=u,u=this,$=Xn(m,yn(m)));var Y=!(br(T)&&"chain"in T)||!!T.chain,fe=So(u);return Kr($,function(we){var Me=m[we];u[we]=Me,fe&&(u.prototype[we]=function(){var Ge=this.__chain__;if(Y||Ge){var He=u(this.__wrapped__),et=He.__actions__=Ji(this.__actions__);return et.push({func:Me,args:arguments,thisArg:u}),He.__chain__=Ge,He}return Me.apply(u,Vo([this.value()],arguments))})}),u}function gS(){return pr._===this&&(pr._=Ad),this}function v1(){}function _S(u){return u=Z(u),_n(function(m){return iu(m,u)})}var yS=gp(ir),vS=gp(Td),xS=gp(Gu);function Cw(u){return Sp(u)?Gl(Qo(u)):Sl(u)}function wS(u){return function(m){return u==null?o:Cr(u,m)}}var bS=ug(),SS=ug(!0);function x1(){return[]}function w1(){return!1}function TS(){return{}}function ES(){return""}function CS(){return!0}function IS(u,m){if(u=Z(u),u<1||u>Je)return[];var T=ct,A=ni(u,ct);m=Vt(m),u-=ct;for(var $=uh(A,m);++T<u;)m(T);return $}function kS(u){return en(u)?ir(u,Qo):x(u)?[u]:Ji(xg(_e(u)))}function PS(u){var m=++Yl;return _e(u)+m}var AS=Ah(function(u,m){return u+m},0),MS=Ra("ceil"),zS=Ah(function(u,m){return u/m},1),DS=Ra("floor");function LS(u){return u&&u.length?wt(u,ro,fi):o}function RS(u,m){return u&&u.length?wt(u,Vt(m,2),fi):o}function OS(u){return Wl(u,ro)}function FS(u,m){return Wl(u,Vt(m,2))}function BS(u){return u&&u.length?wt(u,ro,Yo):o}function NS(u,m){return u&&u.length?wt(u,Vt(m,2),Yo):o}var US=Ah(function(u,m){return u*m},1),jS=Ra("round"),$S=Ah(function(u,m){return u-m},0);function VS(u){return u&&u.length?mr(u,ro):0}function qS(u,m){return u&&u.length?mr(u,Vt(m,2)):0}return H.after=Vp,H.ary=xc,H.assign=Re,H.assignIn=Ye,H.assignInWith=gt,H.assignWith=Ot,H.at=_t,H.before=qp,H.bind=jh,H.bindAll=oS,H.bindKey=Zp,H.castArray=bc,H.chain=Qd,H.chunk=by,H.compact=bg,H.concat=Pp,H.cond=aS,H.conforms=lS,H.constant=g1,H.countBy=Vy,H.create=dt,H.curry=Ss,H.curryRight=wc,H.debounce=Wp,H.defaults=Pt,H.defaultsDeep=xt,H.defer=e_,H.delay=t_,H.difference=Sg,H.differenceBy=Tg,H.differenceWith=Eg,H.drop=Sy,H.dropRight=Yd,H.dropRightWhile=Ty,H.dropWhile=Cg,H.fill=Ey,H.filter=Bp,H.flatMap=Up,H.flatMapDeep=vc,H.flatMapDepth=Wg,H.flatten=Ap,H.flattenDeep=Cy,H.flattenDepth=Iy,H.flip=n_,H.flow=cS,H.flowRight=hS,H.fromPairs=Rh,H.functions=Yn,H.functionsIn=Qr,H.groupBy=Gg,H.initial=Ag,H.intersection=Mg,H.intersectionBy=Kn,H.intersectionWith=Mp,H.invert=Bi,H.invertBy=Ni,H.invokeMap=Hg,H.iteratee=_1,H.keyBy=Zy,H.keys=yn,H.keysIn=$n,H.map=sf,H.mapKeys=ki,H.mapValues=xi,H.matches=dS,H.matchesProperty=fS,H.memoize=$h,H.merge=ji,H.mergeWith=oi,H.method=pS,H.methodOf=mS,H.mixin=y1,H.negate=Vh,H.nthArg=_S,H.omit=Us,H.omitBy=es,H.once=Ky,H.orderBy=Xg,H.over=yS,H.overArgs=r_,H.overEvery=vS,H.overSome=xS,H.partial=ta,H.partialRight=Gp,H.partition=Wy,H.pick=zn,H.pickBy=nr,H.property=Cw,H.propertyOf=wS,H.pull=Dg,H.pullAll=Lg,H.pullAllBy=ky,H.pullAllWith=Py,H.pullAt=Ay,H.range=bS,H.rangeRight=SS,H.rearg=i_,H.reject=Xy,H.remove=My,H.rest=s_,H.reverse=zp,H.sampleSize=Al,H.set=Cs,H.setWith=Sr,H.shuffle=Kg,H.slice=zy,H.sortBy=Qg,H.sortedUniq=Lp,H.sortedUniqBy=Ry,H.split=f1,H.spread=o_,H.tail=Oy,H.take=Fy,H.takeRight=Og,H.takeRightWhile=Fg,H.takeWhile=Qi,H.tap=jy,H.throttle=Yy,H.thru=ef,H.toArray=U,H.toPairs=vu,H.toPairsIn=To,H.toPath=kS,H.toPlainObject=Pe,H.transform=na,H.unary=Jy,H.union=Rp,H.unionBy=Bg,H.unionWith=kl,H.uniq=Oh,H.uniqBy=Fh,H.uniqWith=_c,H.unset=no,H.unzip=yc,H.unzipWith=Bh,H.update=js,H.updateWith=ai,H.values=Is,H.valuesIn=Zh,H.without=By,H.words=Tw,H.wrap=a_,H.xor=Ny,H.xorBy=Ng,H.xorWith=Ug,H.zip=Uy,H.zipObject=jg,H.zipObjectDeep=$g,H.zipWith=Op,H.entries=vu,H.entriesIn=To,H.extend=Ye,H.extendWith=gt,y1(H,H),H.add=AS,H.attempt=Ew,H.camelCase=tm,H.capitalize=ra,H.ceil=MS,H.clamp=f_,H.clone=l_,H.cloneDeep=u_,H.cloneDeepWith=af,H.cloneWith=of,H.conformsTo=lf,H.deburr=nm,H.defaultTo=uS,H.divide=zS,H.endsWith=m_,H.eq=Ts,H.escape=i1,H.escapeRegExp=s1,H.every=tf,H.find=qy,H.findIndex=Ig,H.findKey=yt,H.findLast=Np,H.findLastIndex=kg,H.findLastKey=$e,H.floor=DS,H.forEach=jp,H.forEachRight=nf,H.forIn=At,H.forInRight=kt,H.forOwn=qt,H.forOwnRight=tr,H.get=Es,H.gt=Qy,H.gte=e1,H.has=vi,H.hasIn=Nr,H.head=Br,H.identity=ro,H.includes=rf,H.indexOf=Pg,H.inRange=p_,H.invoke=Ui,H.isArguments=yu,H.isArray=en,H.isArrayBuffer=yi,H.isArrayLike=Vr,H.isArrayLikeObject=Mr,H.isBoolean=c_,H.isBuffer=Ua,H.isDate=Hp,H.isElement=t1,H.isEmpty=h_,H.isEqual=d_,H.isEqualWith=n1,H.isError=uf,H.isFinite=Xp,H.isFunction=So,H.isInteger=Kp,H.isLength=Ml,H.isMap=cf,H.isMatch=hf,H.isMatchWith=qh,H.isNaN=Yp,H.isNative=Jp,H.isNil=r1,H.isNull=Qp,H.isNumber=i,H.isObject=br,H.isObjectLike=zr,H.isPlainObject=n,H.isRegExp=s,H.isSafeInteger=l,H.isSet=p,H.isString=v,H.isSymbol=x,H.isTypedArray=S,H.isUndefined=C,H.isWeakMap=P,H.isWeakSet=M,H.join=zg,H.kebabCase=o1,H.last=Ns,H.lastIndexOf=Na,H.lowerCase=a1,H.lowerFirst=l1,H.lt=L,H.lte=F,H.max=LS,H.maxBy=RS,H.mean=OS,H.meanBy=FS,H.min=BS,H.minBy=NS,H.stubArray=x1,H.stubFalse=w1,H.stubObject=TS,H.stubString=ES,H.stubTrue=CS,H.multiply=US,H.nth=mc,H.noConflict=gS,H.noop=v1,H.now=Uh,H.pad=u1,H.padEnd=c1,H.padStart=h1,H.parseInt=Eo,H.random=em,H.reduce=Gy,H.reduceRight=Hy,H.repeat=df,H.replace=g_,H.result=lr,H.round=jS,H.runInContext=Ie,H.sample=$p,H.size=Yg,H.snakeCase=d1,H.some=Jg,H.sortedIndex=Dy,H.sortedIndexBy=Ly,H.sortedIndexOf=Jd,H.sortedLastIndex=gc,H.sortedLastIndexBy=Rg,H.sortedLastIndexOf=Dp,H.startCase=p1,H.startsWith=Pi,H.subtract=$S,H.sum=VS,H.sumBy=qS,H.template=$s,H.times=IS,H.toFinite=W,H.toInteger=Z,H.toLength=ne,H.toLower=xu,H.toNumber=oe,H.toSafeInteger=ge,H.toString=_e,H.toUpper=Co,H.trim=wu,H.trimEnd=ia,H.trimStart=nS,H.truncate=rS,H.unescape=iS,H.uniqueId=PS,H.upperCase=sS,H.upperFirst=m1,H.each=jp,H.eachRight=nf,H.first=Br,y1(H,function(){var u={};return $t(H,function(m,T){jn.call(H.prototype,T)||(u[T]=m)}),u}(),{chain:!1}),H.VERSION=h,Kr(["bind","bindKey","curry","curryRight","partial","partialRight"],function(u){H[u].placeholder=H}),Kr(["drop","take"],function(u,m){ln.prototype[u]=function(T){T=T===o?1:_r(Z(T),0);var A=this.__filtered__&&!m?new ln(this):this.clone();return A.__filtered__?A.__takeCount__=ni(T,A.__takeCount__):A.__views__.push({size:ni(T,ct),type:u+(A.__dir__<0?"Right":"")}),A},ln.prototype[u+"Right"]=function(T){return this.reverse()[u](T).reverse()}}),Kr(["filter","map","takeWhile"],function(u,m){var T=m+1,A=T==Kt||T==Qn;ln.prototype[u]=function($){var Y=this.clone();return Y.__iteratees__.push({iteratee:Vt($,3),type:T}),Y.__filtered__=Y.__filtered__||A,Y}}),Kr(["head","last"],function(u,m){var T="take"+(m?"Right":"");ln.prototype[u]=function(){return this[T](1).value()[0]}}),Kr(["initial","tail"],function(u,m){var T="drop"+(m?"":"Right");ln.prototype[u]=function(){return this.__filtered__?new ln(this):this[T](1)}}),ln.prototype.compact=function(){return this.filter(ro)},ln.prototype.find=function(u){return this.filter(u).head()},ln.prototype.findLast=function(u){return this.reverse().find(u)},ln.prototype.invokeMap=_n(function(u,m){return typeof u=="function"?new ln(this):this.map(function(T){return Ko(T,u,m)})}),ln.prototype.reject=function(u){return this.filter(Vh(Vt(u)))},ln.prototype.slice=function(u,m){u=Z(u);var T=this;return T.__filtered__&&(u>0||m<0)?new ln(T):(u<0?T=T.takeRight(-u):u&&(T=T.drop(u)),m!==o&&(m=Z(m),T=m<0?T.dropRight(-m):T.take(m-u)),T)},ln.prototype.takeRightWhile=function(u){return this.reverse().takeWhile(u).reverse()},ln.prototype.toArray=function(){return this.take(ct)},$t(ln.prototype,function(u,m){var T=/^(?:filter|find|map|reject)|While$/.test(m),A=/^(?:head|last)$/.test(m),$=H[A?"take"+(m=="last"?"Right":""):m],Y=A||/^find/.test(m);$&&(H.prototype[m]=function(){var fe=this.__wrapped__,we=A?[1]:arguments,Me=fe instanceof ln,Ge=we[0],He=Me||en(fe),et=function(Rn){var Vn=$.apply(H,Vo([Rn],we));return A&&bt?Vn[0]:Vn};He&&T&&typeof Ge=="function"&&Ge.length!=1&&(Me=He=!1);var bt=this.__chain__,Nt=!!this.__actions__.length,tn=Y&&!bt,En=Me&&!Nt;if(!Y&&He){fe=En?fe:new ln(this);var nn=u.apply(fe,we);return nn.__actions__.push({func:ef,args:[et],thisArg:o}),new fs(nn,bt)}return tn&&En?u.apply(this,we):(nn=this.thru(et),tn?A?nn.value()[0]:nn.value():nn)})}),Kr(["pop","push","shift","sort","splice","unshift"],function(u){var m=xa[u],T=/^(?:push|sort|unshift)$/.test(u)?"tap":"thru",A=/^(?:pop|shift)$/.test(u);H.prototype[u]=function(){var $=arguments;if(A&&!this.__chain__){var Y=this.value();return m.apply(en(Y)?Y:[],$)}return this[T](function(fe){return m.apply(en(fe)?fe:[],$)})}}),$t(ln.prototype,function(u,m){var T=H[m];if(T){var A=T.name+"";jn.call(ri,A)||(ri[A]=[]),ri[A].push({name:m,func:T})}}),ri[hc(o,se).name]=[{name:"wrapper",func:o}],ln.prototype.clone=Dd,ln.prototype.reverse=xh,ln.prototype.value=Ld,H.prototype.at=Vg,H.prototype.chain=qg,H.prototype.commit=Nh,H.prototype.next=ea,H.prototype.plant=Zg,H.prototype.reverse=Fp,H.prototype.toJSON=H.prototype.valueOf=H.prototype.value=$y,H.prototype.first=H.prototype.head,Ho&&(H.prototype[Ho]=Pl),H},go=Pd();Js?((Js.exports=go)._=go,Mn._=go):pr._=go}).call(Kh)})(S0,S0.exports);var eC=S0.exports;const Qm=F0(eC);var N4={exports:{}};/* @license
Papa Parse
v5.5.2
https://github.com/mholt/PapaParse
License: MIT
*/(function(e,r){((o,h)=>{e.exports=h()})(Kh,function o(){var h=typeof self<"u"?self:typeof window<"u"?window:h!==void 0?h:{},g,b=!h.document&&!!h.postMessage,w=h.IS_PAPA_WORKER||!1,c={},D=0,j={};function J(ee){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},(function(de){var Te=Ze(de);Te.chunkSize=parseInt(Te.chunkSize),de.step||de.chunk||(Te.chunkSize=null),this._handle=new Fe(Te),(this._handle.streamer=this)._config=Te}).call(this,ee),this.parseChunk=function(de,Te){var Ue=parseInt(this._config.skipFirstNLines)||0;if(this.isFirstChunk&&0<Ue){let mt=this._config.newline;mt||(Xe=this._config.quoteChar||'"',mt=this._handle.guessLineEndings(de,Xe)),de=[...de.split(mt).slice(Ue)].join(mt)}this.isFirstChunk&&ve(this._config.beforeFirstChunk)&&(Xe=this._config.beforeFirstChunk(de))!==void 0&&(de=Xe),this.isFirstChunk=!1,this._halted=!1;var Ue=this._partialLine+de,Xe=(this._partialLine="",this._handle.parse(Ue,this._baseIndex,!this._finished));if(!this._handle.paused()&&!this._handle.aborted()){if(de=Xe.meta.cursor,Ue=(this._finished||(this._partialLine=Ue.substring(de-this._baseIndex),this._baseIndex=de),Xe&&Xe.data&&(this._rowCount+=Xe.data.length),this._finished||this._config.preview&&this._rowCount>=this._config.preview),w)h.postMessage({results:Xe,workerId:j.WORKER_ID,finished:Ue});else if(ve(this._config.chunk)&&!Te){if(this._config.chunk(Xe,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);this._completeResults=Xe=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(Xe.data),this._completeResults.errors=this._completeResults.errors.concat(Xe.errors),this._completeResults.meta=Xe.meta),this._completed||!Ue||!ve(this._config.complete)||Xe&&Xe.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),Ue||Xe&&Xe.meta.paused||this._nextChunk(),Xe}this._halted=!0},this._sendError=function(de){ve(this._config.error)?this._config.error(de):w&&this._config.error&&h.postMessage({workerId:j.WORKER_ID,error:de,finished:!1})}}function G(ee){var de;(ee=ee||{}).chunkSize||(ee.chunkSize=j.RemoteChunkSize),J.call(this,ee),this._nextChunk=b?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(Te){this._input=Te,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(de=new XMLHttpRequest,this._config.withCredentials&&(de.withCredentials=this._config.withCredentials),b||(de.onload=je(this._chunkLoaded,this),de.onerror=je(this._chunkError,this)),de.open(this._config.downloadRequestBody?"POST":"GET",this._input,!b),this._config.downloadRequestHeaders){var Te,Ue=this._config.downloadRequestHeaders;for(Te in Ue)de.setRequestHeader(Te,Ue[Te])}var Xe;this._config.chunkSize&&(Xe=this._start+this._config.chunkSize-1,de.setRequestHeader("Range","bytes="+this._start+"-"+Xe));try{de.send(this._config.downloadRequestBody)}catch(mt){this._chunkError(mt.message)}b&&de.status===0&&this._chunkError()}},this._chunkLoaded=function(){de.readyState===4&&(de.status<200||400<=de.status?this._chunkError():(this._start+=this._config.chunkSize||de.responseText.length,this._finished=!this._config.chunkSize||this._start>=(Te=>(Te=Te.getResponseHeader("Content-Range"))!==null?parseInt(Te.substring(Te.lastIndexOf("/")+1)):-1)(de),this.parseChunk(de.responseText)))},this._chunkError=function(Te){Te=de.statusText||Te,this._sendError(new Error(Te))}}function q(ee){(ee=ee||{}).chunkSize||(ee.chunkSize=j.LocalChunkSize),J.call(this,ee);var de,Te,Ue=typeof FileReader<"u";this.stream=function(Xe){this._input=Xe,Te=Xe.slice||Xe.webkitSlice||Xe.mozSlice,Ue?((de=new FileReader).onload=je(this._chunkLoaded,this),de.onerror=je(this._chunkError,this)):de=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var Xe=this._input,mt=(this._config.chunkSize&&(mt=Math.min(this._start+this._config.chunkSize,this._input.size),Xe=Te.call(Xe,this._start,mt)),de.readAsText(Xe,this._config.encoding));Ue||this._chunkLoaded({target:{result:mt}})},this._chunkLoaded=function(Xe){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(Xe.target.result)},this._chunkError=function(){this._sendError(de.error)}}function Ee(ee){var de;J.call(this,ee=ee||{}),this.stream=function(Te){return de=Te,this._nextChunk()},this._nextChunk=function(){var Te,Ue;if(!this._finished)return Te=this._config.chunkSize,de=Te?(Ue=de.substring(0,Te),de.substring(Te)):(Ue=de,""),this._finished=!de,this.parseChunk(Ue)}}function Ae(ee){J.call(this,ee=ee||{});var de=[],Te=!0,Ue=!1;this.pause=function(){J.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){J.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(Xe){this._input=Xe,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){Ue&&de.length===1&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),de.length?this.parseChunk(de.shift()):Te=!0},this._streamData=je(function(Xe){try{de.push(typeof Xe=="string"?Xe:Xe.toString(this._config.encoding)),Te&&(Te=!1,this._checkIsFinished(),this.parseChunk(de.shift()))}catch(mt){this._streamError(mt)}},this),this._streamError=je(function(Xe){this._streamCleanUp(),this._sendError(Xe)},this),this._streamEnd=je(function(){this._streamCleanUp(),Ue=!0,this._streamData("")},this),this._streamCleanUp=je(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function Fe(ee){var de,Te,Ue,Xe,mt=Math.pow(2,53),Kt=-mt,qn=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,Qn=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,zt=this,Je=0,nt=0,Et=!1,ct=!1,It=[],St={data:[],errors:[],meta:{}};function Sn(Zt){return ee.skipEmptyLines==="greedy"?Zt.join("").trim()==="":Zt.length===1&&Zt[0].length===0}function cn(){if(St&&Ue&&(Nn("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+j.DefaultDelimiter+"'"),Ue=!1),ee.skipEmptyLines&&(St.data=St.data.filter(function(wn){return!Sn(wn)})),Cn()){let wn=function(er,sn){ve(ee.transformHeader)&&(er=ee.transformHeader(er,sn)),It.push(er)};var Qt=wn;if(St)if(Array.isArray(St.data[0])){for(var Zt=0;Cn()&&Zt<St.data.length;Zt++)St.data[Zt].forEach(wn);St.data.splice(0,1)}else St.data.forEach(wn)}function rn(wn,er){for(var sn=ee.header?{}:[],dn=0;dn<wn.length;dn++){var Ce=dn,Fn=wn[dn],Fn=((bn,Rt)=>(Yt=>(ee.dynamicTypingFunction&&ee.dynamicTyping[Yt]===void 0&&(ee.dynamicTyping[Yt]=ee.dynamicTypingFunction(Yt)),(ee.dynamicTyping[Yt]||ee.dynamicTyping)===!0))(bn)?Rt==="true"||Rt==="TRUE"||Rt!=="false"&&Rt!=="FALSE"&&((Yt=>{if(qn.test(Yt)&&(Yt=parseFloat(Yt),Kt<Yt&&Yt<mt))return 1})(Rt)?parseFloat(Rt):Qn.test(Rt)?new Date(Rt):Rt===""?null:Rt):Rt)(Ce=ee.header?dn>=It.length?"__parsed_extra":It[dn]:Ce,Fn=ee.transform?ee.transform(Fn,Ce):Fn);Ce==="__parsed_extra"?(sn[Ce]=sn[Ce]||[],sn[Ce].push(Fn)):sn[Ce]=Fn}return ee.header&&(dn>It.length?Nn("FieldMismatch","TooManyFields","Too many fields: expected "+It.length+" fields but parsed "+dn,nt+er):dn<It.length&&Nn("FieldMismatch","TooFewFields","Too few fields: expected "+It.length+" fields but parsed "+dn,nt+er)),sn}var Zn;St&&(ee.header||ee.dynamicTyping||ee.transform)&&(Zn=1,!St.data.length||Array.isArray(St.data[0])?(St.data=St.data.map(rn),Zn=St.data.length):St.data=rn(St.data,0),ee.header&&St.meta&&(St.meta.fields=It),nt+=Zn)}function Cn(){return ee.header&&It.length===0}function Nn(Zt,rn,Zn,Qt){Zt={type:Zt,code:rn,message:Zn},Qt!==void 0&&(Zt.row=Qt),St.errors.push(Zt)}ve(ee.step)&&(Xe=ee.step,ee.step=function(Zt){St=Zt,Cn()?cn():(cn(),St.data.length!==0&&(Je+=Zt.data.length,ee.preview&&Je>ee.preview?Te.abort():(St.data=St.data[0],Xe(St,zt))))}),this.parse=function(Zt,rn,Zn){var Qt=ee.quoteChar||'"',Qt=(ee.newline||(ee.newline=this.guessLineEndings(Zt,Qt)),Ue=!1,ee.delimiter?ve(ee.delimiter)&&(ee.delimiter=ee.delimiter(Zt),St.meta.delimiter=ee.delimiter):((Qt=((wn,er,sn,dn,Ce)=>{var Fn,bn,Rt,Yt;Ce=Ce||[",","	","|",";",j.RECORD_SEP,j.UNIT_SEP];for(var Tr=0;Tr<Ce.length;Tr++){for(var yr,Gr=Ce[Tr],vr=0,rr=0,dr=0,fr=(Rt=void 0,new se({comments:dn,delimiter:Gr,newline:er,preview:10}).parse(wn)),Ke=0;Ke<fr.data.length;Ke++)sn&&Sn(fr.data[Ke])?dr++:(yr=fr.data[Ke].length,rr+=yr,Rt===void 0?Rt=yr:0<yr&&(vr+=Math.abs(yr-Rt),Rt=yr));0<fr.data.length&&(rr/=fr.data.length-dr),(bn===void 0||vr<=bn)&&(Yt===void 0||Yt<rr)&&1.99<rr&&(bn=vr,Fn=Gr,Yt=rr)}return{successful:!!(ee.delimiter=Fn),bestDelimiter:Fn}})(Zt,ee.newline,ee.skipEmptyLines,ee.comments,ee.delimitersToGuess)).successful?ee.delimiter=Qt.bestDelimiter:(Ue=!0,ee.delimiter=j.DefaultDelimiter),St.meta.delimiter=ee.delimiter),Ze(ee));return ee.preview&&ee.header&&Qt.preview++,de=Zt,Te=new se(Qt),St=Te.parse(de,rn,Zn),cn(),Et?{meta:{paused:!0}}:St||{meta:{paused:!1}}},this.paused=function(){return Et},this.pause=function(){Et=!0,Te.abort(),de=ve(ee.chunk)?"":de.substring(Te.getCharIndex())},this.resume=function(){zt.streamer._halted?(Et=!1,zt.streamer.parseChunk(de,!0)):setTimeout(zt.resume,3)},this.aborted=function(){return ct},this.abort=function(){ct=!0,Te.abort(),St.meta.aborted=!0,ve(ee.complete)&&ee.complete(St),de=""},this.guessLineEndings=function(wn,Qt){wn=wn.substring(0,1048576);var Qt=new RegExp(Ne(Qt)+"([^]*?)"+Ne(Qt),"gm"),Zn=(wn=wn.replace(Qt,"")).split("\r"),Qt=wn.split(`
`),wn=1<Qt.length&&Qt[0].length<Zn[0].length;if(Zn.length===1||wn)return`
`;for(var er=0,sn=0;sn<Zn.length;sn++)Zn[sn][0]===`
`&&er++;return er>=Zn.length/2?`\r
`:"\r"}}function Ne(ee){return ee.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function se(ee){var de=(ee=ee||{}).delimiter,Te=ee.newline,Ue=ee.comments,Xe=ee.step,mt=ee.preview,Kt=ee.fastMode,qn=null,Qn=!1,zt=ee.quoteChar==null?'"':ee.quoteChar,Je=zt;if(ee.escapeChar!==void 0&&(Je=ee.escapeChar),(typeof de!="string"||-1<j.BAD_DELIMITERS.indexOf(de))&&(de=","),Ue===de)throw new Error("Comment character same as delimiter");Ue===!0?Ue="#":(typeof Ue!="string"||-1<j.BAD_DELIMITERS.indexOf(Ue))&&(Ue=!1),Te!==`
`&&Te!=="\r"&&Te!==`\r
`&&(Te=`
`);var nt=0,Et=!1;this.parse=function(ct,It,St){if(typeof ct!="string")throw new Error("Input must be a string");var Sn=ct.length,cn=de.length,Cn=Te.length,Nn=Ue.length,Zt=ve(Xe),rn=[],Zn=[],Qt=[],wn=nt=0;if(!ct)return vr();if(Kt||Kt!==!1&&ct.indexOf(zt)===-1){for(var er=ct.split(Te),sn=0;sn<er.length;sn++){if(Qt=er[sn],nt+=Qt.length,sn!==er.length-1)nt+=Te.length;else if(St)return vr();if(!Ue||Qt.substring(0,Nn)!==Ue){if(Zt){if(rn=[],Yt(Qt.split(de)),rr(),Et)return vr()}else Yt(Qt.split(de));if(mt&&mt<=sn)return rn=rn.slice(0,mt),vr(!0)}}return vr()}for(var dn=ct.indexOf(de,nt),Ce=ct.indexOf(Te,nt),Fn=new RegExp(Ne(Je)+Ne(zt),"g"),bn=ct.indexOf(zt,nt);;)if(ct[nt]===zt)for(bn=nt,nt++;;){if((bn=ct.indexOf(zt,bn+1))===-1)return St||Zn.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:rn.length,index:nt}),yr();if(bn===Sn-1)return yr(ct.substring(nt,bn).replace(Fn,zt));if(zt===Je&&ct[bn+1]===Je)bn++;else if(zt===Je||bn===0||ct[bn-1]!==Je){dn!==-1&&dn<bn+1&&(dn=ct.indexOf(de,bn+1));var Rt=Tr((Ce=Ce!==-1&&Ce<bn+1?ct.indexOf(Te,bn+1):Ce)===-1?dn:Math.min(dn,Ce));if(ct.substr(bn+1+Rt,cn)===de){Qt.push(ct.substring(nt,bn).replace(Fn,zt)),ct[nt=bn+1+Rt+cn]!==zt&&(bn=ct.indexOf(zt,nt)),dn=ct.indexOf(de,nt),Ce=ct.indexOf(Te,nt);break}if(Rt=Tr(Ce),ct.substring(bn+1+Rt,bn+1+Rt+Cn)===Te){if(Qt.push(ct.substring(nt,bn).replace(Fn,zt)),Gr(bn+1+Rt+Cn),dn=ct.indexOf(de,nt),bn=ct.indexOf(zt,nt),Zt&&(rr(),Et))return vr();if(mt&&rn.length>=mt)return vr(!0);break}Zn.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:rn.length,index:nt}),bn++}}else if(Ue&&Qt.length===0&&ct.substring(nt,nt+Nn)===Ue){if(Ce===-1)return vr();nt=Ce+Cn,Ce=ct.indexOf(Te,nt),dn=ct.indexOf(de,nt)}else if(dn!==-1&&(dn<Ce||Ce===-1))Qt.push(ct.substring(nt,dn)),nt=dn+cn,dn=ct.indexOf(de,nt);else{if(Ce===-1)break;if(Qt.push(ct.substring(nt,Ce)),Gr(Ce+Cn),Zt&&(rr(),Et))return vr();if(mt&&rn.length>=mt)return vr(!0)}return yr();function Yt(dr){rn.push(dr),wn=nt}function Tr(dr){var fr=0;return fr=dr!==-1&&(dr=ct.substring(bn+1,dr))&&dr.trim()===""?dr.length:fr}function yr(dr){return St||(dr===void 0&&(dr=ct.substring(nt)),Qt.push(dr),nt=Sn,Yt(Qt),Zt&&rr()),vr()}function Gr(dr){nt=dr,Yt(Qt),Qt=[],Ce=ct.indexOf(Te,nt)}function vr(dr){if(ee.header&&!It&&rn.length&&!Qn){var fr=rn[0],Ke={},ci=new Set(fr);let Rr=!1;for(let jr=0;jr<fr.length;jr++){let Pr=fr[jr];if(Ke[Pr=ve(ee.transformHeader)?ee.transformHeader(Pr,jr):Pr]){let rt,Ht=Ke[Pr];for(;rt=Pr+"_"+Ht,Ht++,ci.has(rt););ci.add(rt),fr[jr]=rt,Ke[Pr]++,Rr=!0,(qn=qn===null?{}:qn)[rt]=Pr}else Ke[Pr]=1,fr[jr]=Pr;ci.add(Pr)}Rr&&console.warn("Duplicate headers found and renamed."),Qn=!0}return{data:rn,errors:Zn,meta:{delimiter:de,linebreak:Te,aborted:Et,truncated:!!dr,cursor:wn+(It||0),renamedHeaders:qn}}}function rr(){Xe(vr()),rn=[],Zn=[]}},this.abort=function(){Et=!0},this.getCharIndex=function(){return nt}}function ue(ee){var de=ee.data,Te=c[de.workerId],Ue=!1;if(de.error)Te.userError(de.error,de.file);else if(de.results&&de.results.data){var Xe={abort:function(){Ue=!0,he(de.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:De,resume:De};if(ve(Te.userStep)){for(var mt=0;mt<de.results.data.length&&(Te.userStep({data:de.results.data[mt],errors:de.results.errors,meta:de.results.meta},Xe),!Ue);mt++);delete de.results}else ve(Te.userChunk)&&(Te.userChunk(de.results,Xe,de.file),delete de.results)}de.finished&&!Ue&&he(de.workerId,de.results)}function he(ee,de){var Te=c[ee];ve(Te.userComplete)&&Te.userComplete(de),Te.terminate(),delete c[ee]}function De(){throw new Error("Not implemented.")}function Ze(ee){if(typeof ee!="object"||ee===null)return ee;var de,Te=Array.isArray(ee)?[]:{};for(de in ee)Te[de]=Ze(ee[de]);return Te}function je(ee,de){return function(){ee.apply(de,arguments)}}function ve(ee){return typeof ee=="function"}return j.parse=function(ee,de){var Te=(de=de||{}).dynamicTyping||!1;if(ve(Te)&&(de.dynamicTypingFunction=Te,Te={}),de.dynamicTyping=Te,de.transform=!!ve(de.transform)&&de.transform,!de.worker||!j.WORKERS_SUPPORTED)return Te=null,j.NODE_STREAM_INPUT,typeof ee=="string"?(ee=(Ue=>Ue.charCodeAt(0)!==65279?Ue:Ue.slice(1))(ee),Te=new(de.download?G:Ee)(de)):ee.readable===!0&&ve(ee.read)&&ve(ee.on)?Te=new Ae(de):(h.File&&ee instanceof File||ee instanceof Object)&&(Te=new q(de)),Te.stream(ee);(Te=(()=>{var Ue;return!!j.WORKERS_SUPPORTED&&(Ue=(()=>{var Xe=h.URL||h.webkitURL||null,mt=o.toString();return j.BLOB_URL||(j.BLOB_URL=Xe.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",mt,")();"],{type:"text/javascript"})))})(),(Ue=new h.Worker(Ue)).onmessage=ue,Ue.id=D++,c[Ue.id]=Ue)})()).userStep=de.step,Te.userChunk=de.chunk,Te.userComplete=de.complete,Te.userError=de.error,de.step=ve(de.step),de.chunk=ve(de.chunk),de.complete=ve(de.complete),de.error=ve(de.error),delete de.worker,Te.postMessage({input:ee,config:de,workerId:Te.id})},j.unparse=function(ee,de){var Te=!1,Ue=!0,Xe=",",mt=`\r
`,Kt='"',qn=Kt+Kt,Qn=!1,zt=null,Je=!1,nt=((()=>{if(typeof de=="object"){if(typeof de.delimiter!="string"||j.BAD_DELIMITERS.filter(function(It){return de.delimiter.indexOf(It)!==-1}).length||(Xe=de.delimiter),typeof de.quotes!="boolean"&&typeof de.quotes!="function"&&!Array.isArray(de.quotes)||(Te=de.quotes),typeof de.skipEmptyLines!="boolean"&&typeof de.skipEmptyLines!="string"||(Qn=de.skipEmptyLines),typeof de.newline=="string"&&(mt=de.newline),typeof de.quoteChar=="string"&&(Kt=de.quoteChar),typeof de.header=="boolean"&&(Ue=de.header),Array.isArray(de.columns)){if(de.columns.length===0)throw new Error("Option columns is empty");zt=de.columns}de.escapeChar!==void 0&&(qn=de.escapeChar+Kt),de.escapeFormulae instanceof RegExp?Je=de.escapeFormulae:typeof de.escapeFormulae=="boolean"&&de.escapeFormulae&&(Je=/^[=+\-@\t\r].*$/)}})(),new RegExp(Ne(Kt),"g"));if(typeof ee=="string"&&(ee=JSON.parse(ee)),Array.isArray(ee)){if(!ee.length||Array.isArray(ee[0]))return Et(null,ee,Qn);if(typeof ee[0]=="object")return Et(zt||Object.keys(ee[0]),ee,Qn)}else if(typeof ee=="object")return typeof ee.data=="string"&&(ee.data=JSON.parse(ee.data)),Array.isArray(ee.data)&&(ee.fields||(ee.fields=ee.meta&&ee.meta.fields||zt),ee.fields||(ee.fields=Array.isArray(ee.data[0])?ee.fields:typeof ee.data[0]=="object"?Object.keys(ee.data[0]):[]),Array.isArray(ee.data[0])||typeof ee.data[0]=="object"||(ee.data=[ee.data])),Et(ee.fields||[],ee.data||[],Qn);throw new Error("Unable to serialize unrecognized input");function Et(It,St,Sn){var cn="",Cn=(typeof It=="string"&&(It=JSON.parse(It)),typeof St=="string"&&(St=JSON.parse(St)),Array.isArray(It)&&0<It.length),Nn=!Array.isArray(St[0]);if(Cn&&Ue){for(var Zt=0;Zt<It.length;Zt++)0<Zt&&(cn+=Xe),cn+=ct(It[Zt],Zt);0<St.length&&(cn+=mt)}for(var rn=0;rn<St.length;rn++){var Zn=(Cn?It:St[rn]).length,Qt=!1,wn=Cn?Object.keys(St[rn]).length===0:St[rn].length===0;if(Sn&&!Cn&&(Qt=Sn==="greedy"?St[rn].join("").trim()==="":St[rn].length===1&&St[rn][0].length===0),Sn==="greedy"&&Cn){for(var er=[],sn=0;sn<Zn;sn++){var dn=Nn?It[sn]:sn;er.push(St[rn][dn])}Qt=er.join("").trim()===""}if(!Qt){for(var Ce=0;Ce<Zn;Ce++){0<Ce&&!wn&&(cn+=Xe);var Fn=Cn&&Nn?It[Ce]:Ce;cn+=ct(St[rn][Fn],Ce)}rn<St.length-1&&(!Sn||0<Zn&&!wn)&&(cn+=mt)}}return cn}function ct(It,St){var Sn,cn;return It==null?"":It.constructor===Date?JSON.stringify(It).slice(1,25):(cn=!1,Je&&typeof It=="string"&&Je.test(It)&&(It="'"+It,cn=!0),Sn=It.toString().replace(nt,qn),(cn=cn||Te===!0||typeof Te=="function"&&Te(It,St)||Array.isArray(Te)&&Te[St]||((Cn,Nn)=>{for(var Zt=0;Zt<Nn.length;Zt++)if(-1<Cn.indexOf(Nn[Zt]))return!0;return!1})(Sn,j.BAD_DELIMITERS)||-1<Sn.indexOf(Xe)||Sn.charAt(0)===" "||Sn.charAt(Sn.length-1)===" ")?Kt+Sn+Kt:Sn)}},j.RECORD_SEP="",j.UNIT_SEP="",j.BYTE_ORDER_MARK="\uFEFF",j.BAD_DELIMITERS=["\r",`
`,'"',j.BYTE_ORDER_MARK],j.WORKERS_SUPPORTED=!b&&!!h.Worker,j.NODE_STREAM_INPUT=1,j.LocalChunkSize=10485760,j.RemoteChunkSize=5242880,j.DefaultDelimiter=",",j.Parser=se,j.ParserHandle=Fe,j.NetworkStreamer=G,j.FileStreamer=q,j.StringStreamer=Ee,j.ReadableStreamStreamer=Ae,h.jQuery&&((g=h.jQuery).fn.parse=function(ee){var de=ee.config||{},Te=[];return this.each(function(mt){if(!(g(this).prop("tagName").toUpperCase()==="INPUT"&&g(this).attr("type").toLowerCase()==="file"&&h.FileReader)||!this.files||this.files.length===0)return!0;for(var Kt=0;Kt<this.files.length;Kt++)Te.push({file:this.files[Kt],inputElem:this,instanceConfig:g.extend({},de)})}),Ue(),this;function Ue(){if(Te.length===0)ve(ee.complete)&&ee.complete();else{var mt,Kt,qn,Qn,zt=Te[0];if(ve(ee.before)){var Je=ee.before(zt.file,zt.inputElem);if(typeof Je=="object"){if(Je.action==="abort")return mt="AbortError",Kt=zt.file,qn=zt.inputElem,Qn=Je.reason,void(ve(ee.error)&&ee.error({name:mt},Kt,qn,Qn));if(Je.action==="skip")return void Xe();typeof Je.config=="object"&&(zt.instanceConfig=g.extend(zt.instanceConfig,Je.config))}else if(Je==="skip")return void Xe()}var nt=zt.instanceConfig.complete;zt.instanceConfig.complete=function(Et){ve(nt)&&nt(Et,zt.file,zt.inputElem),Xe()},j.parse(zt.file,zt.instanceConfig)}}function Xe(){Te.splice(0,1),Ue()}}),w&&(h.onmessage=function(ee){ee=ee.data,j.WORKER_ID===void 0&&ee&&(j.WORKER_ID=ee.workerId),typeof ee.input=="string"?h.postMessage({workerId:j.WORKER_ID,results:j.parse(ee.input,ee.config),finished:!0}):(h.File&&ee.input instanceof File||ee.input instanceof Object)&&(ee=j.parse(ee.input,ee.config))&&h.postMessage({workerId:j.WORKER_ID,results:ee,finished:!0})}),(G.prototype=Object.create(J.prototype)).constructor=G,(q.prototype=Object.create(J.prototype)).constructor=q,(Ee.prototype=Object.create(Ee.prototype)).constructor=Ee,(Ae.prototype=Object.create(J.prototype)).constructor=Ae,j})})(N4);var tC=N4.exports;const nC=F0(tC),rC=(async()=>{const e={};return(await cw()).forEach(o=>{e[o.codeIso3]=o}),e})(),iC=(async()=>{const e={};for(const[r,o]of Object.entries(b0)){const h=(await o).default;e[r]={},h.forEach(g=>{e[r][g.stateCode]=g})}return e})(),U4=async e=>(await rC)[e]??null,j4=async(e,r)=>ld(e)?(await iC)[e][r]??null:null,T0=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],qs={INSTITUTIONAL_INFORMATION:"Institutional Information",DATASET_INFORMATION:"Dataset Information",ACCESSIBILITY:"Accessibility"},hw="Country Code",$4="State Code",Y_="B",sC=T0.indexOf(Y_),ix="C",oC=T0.indexOf(ix),aC=[{name:"Name of Dataset",column:"A"},{name:hw,column:Y_},{name:$4,column:ix,hide:e=>!e},{name:"Country",column:Y_,category:qs.INSTITUTIONAL_INFORMATION,transform:async e=>{const r=await U4(e);return(r==null?void 0:r.name)??null}},{name:"State",columns:[Y_,ix],category:qs.INSTITUTIONAL_INFORMATION,transform:async([e,r])=>{const o=await j4(e,r);return(o==null?void 0:o.name)??null},hide:e=>!e},{name:"Source",column:"E",category:qs.INSTITUTIONAL_INFORMATION},{name:"URL",column:"F",category:qs.INSTITUTIONAL_INFORMATION,transform:e=>e?ft.jsx("a",{href:e,target:"_",rel:"noreferrer",children:e}):null},{name:"Number of Participants",column:"G",category:qs.DATASET_INFORMATION},{name:"Number of Samples",column:"H",category:qs.DATASET_INFORMATION},{name:"Language",column:"L",category:qs.DATASET_INFORMATION},{name:"Disease Category",column:"I",category:qs.DATASET_INFORMATION},{name:"Diagnoses",column:"J",category:qs.DATASET_INFORMATION},{name:"Speech Task(s)",column:"K",category:qs.DATASET_INFORMATION},{name:"Speaker Details",column:"M",category:qs.DATASET_INFORMATION},{name:"Demographics",column:"N",category:qs.DATASET_INFORMATION},{name:"Accessibility",column:"O",category:qs.ACCESSIBILITY},{name:"Access Instructions",column:"P",category:qs.ACCESSIBILITY},{name:"License Types",column:"Q",category:qs.ACCESSIBILITY}],lC=async(e,r)=>{const h=`row ${r+2} (${e[0]})`,g=e[sC];if(!g)return console.warn(`Skipping ${h} due to missing country code.`),null;if(U4(g)===null)return console.warn(`Skipping ${h} due to unknown country code (${g}).`),null;if(ld(g)){const D=e[oC];if(!D)return console.warn(`Skipping ${h} due to missing state code.`),null;if(j4(g,D)===null)return console.warn(`Skipping ${h} due to unknown state code (${D}) for country '${g}'.`),null}const c=[];for(const D of aC){const{name:j,column:J,columns:G,category:q}=D,Ee=D.hide??(()=>!1),Ae=D.transform??(se=>se);let Fe;if(J){const se=T0.findIndex(ue=>ue===J);Fe=e[se]}else if(G)Fe=G.map(se=>{const ue=T0.findIndex(he=>he===se);return e[ue]});else throw Error("Neither 'column' nor 'columns' defined.");const Ne=await Ae(Fe);Ee(Ne)||c.push({name:j,value:Ne,category:q,hide:Ee})}return c},uC=(async()=>{let e=[],r=[];try{const h=await(await fetch("https://docs.google.com/spreadsheets/d/e/2PACX-1vRhVfbSe0_jQBHdqbssbutK2n77y0KyB5Th2E70C3whkSoxMFnuBfkD7xjnHU1VIA/pub?gid=1792955439&single=true&output=csv")).text(),{data:g}=nC.parse(h);r=g.slice(1)}catch(o){alert("Error loading datasets CSV."),console.error(o)}console.log("voiceDatasetsCsv",r);for(let o=0;o<r.length;o++){const h=r[o],g=await lC(h,o);g!==null&&e.push(g)}return e})(),V4=async()=>await uC,cC=(async()=>{const e=await V4(),r={};for(const o of e){const g=Qm.find(o,{name:hw}).value;r[g]??(r[g]=[]),r[g].push(o)}return r})(),hC=(async()=>{var o;const e=await V4(),r={};for(const h of e){const b=Qm.find(h,{name:hw}).value,w=h.find(D=>D.name===$4);if(!w)continue;const c=w.value;r[b]??(r[b]={}),(o=r[b])[c]??(o[c]=[]),r[b][c].push(h)}return r})(),q4=async()=>await cC,Z4=async()=>{const e=await q4(),r={};for(const o in e){const h=e[o].length;r[o]=h}return r},W4=async e=>(await q4())[e]??[],dC=async e=>(await W4(e)).length,G4=async()=>{const e=await Z4();return Qm(e).values().maxBy()},H4=async e=>(await hC)[e]??{},X4=async e=>{const r=await H4(e),o={};for(const h in r){const g=r[h].length;o[h]=g}return o},K4=async(e,r)=>(await H4(e))[r]??[],fC=async(e,r)=>(await K4(e,r)).length,Y4=async e=>{const r=await X4(e);return Qm(r).values().maxBy()},pC="_container_12zem_1",mC="_title_12zem_6",gC="_description_12zem_10",H1={container:pC,title:mC,description:gC},Rf=({title:e,descriptions:r,children:o,className:h})=>ft.jsxs("div",{className:`${H1.container} ${h??""}`,children:[e!==void 0&&ft.jsx("h2",{className:H1.title,children:e}),r!==void 0&&r.map((g,b)=>ft.jsx("p",{className:H1.description,children:g},b)),o]});var J4={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},$b=Ol.createContext&&Ol.createContext(J4),_C=["attr","size","title"];function yC(e,r){if(e==null)return{};var o=vC(e,r),h,g;if(Object.getOwnPropertySymbols){var b=Object.getOwnPropertySymbols(e);for(g=0;g<b.length;g++)h=b[g],!(r.indexOf(h)>=0)&&Object.prototype.propertyIsEnumerable.call(e,h)&&(o[h]=e[h])}return o}function vC(e,r){if(e==null)return{};var o={};for(var h in e)if(Object.prototype.hasOwnProperty.call(e,h)){if(r.indexOf(h)>=0)continue;o[h]=e[h]}return o}function E0(){return E0=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var o=arguments[r];for(var h in o)Object.prototype.hasOwnProperty.call(o,h)&&(e[h]=o[h])}return e},E0.apply(this,arguments)}function Vb(e,r){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var h=Object.getOwnPropertySymbols(e);r&&(h=h.filter(function(g){return Object.getOwnPropertyDescriptor(e,g).enumerable})),o.push.apply(o,h)}return o}function C0(e){for(var r=1;r<arguments.length;r++){var o=arguments[r]!=null?arguments[r]:{};r%2?Vb(Object(o),!0).forEach(function(h){xC(e,h,o[h])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):Vb(Object(o)).forEach(function(h){Object.defineProperty(e,h,Object.getOwnPropertyDescriptor(o,h))})}return e}function xC(e,r,o){return r=wC(r),r in e?Object.defineProperty(e,r,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[r]=o,e}function wC(e){var r=bC(e,"string");return typeof r=="symbol"?r:r+""}function bC(e,r){if(typeof e!="object"||!e)return e;var o=e[Symbol.toPrimitive];if(o!==void 0){var h=o.call(e,r||"default");if(typeof h!="object")return h;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}function Q4(e){return e&&e.map((r,o)=>Ol.createElement(r.tag,C0({key:o},r.attr),Q4(r.child)))}function e5(e){return r=>Ol.createElement(SC,E0({attr:C0({},e.attr)},r),Q4(e.child))}function SC(e){var r=o=>{var{attr:h,size:g,title:b}=e,w=yC(e,_C),c=g||o.size||"1em",D;return o.className&&(D=o.className),e.className&&(D=(D?D+" ":"")+e.className),Ol.createElement("svg",E0({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},o.attr,h,w,{className:D,style:C0(C0({color:e.color||o.color},o.style),e.style),height:c,width:c,xmlns:"http://www.w3.org/2000/svg"}),b&&Ol.createElement("title",null,b),e.children)};return $b!==void 0?Ol.createElement($b.Consumer,null,o=>r(o)):r(J4)}function TC(e){return e5({tag:"svg",attr:{viewBox:"0 0 320 512"},child:[{tag:"path",attr:{d:"M34.52 239.03L228.87 44.69c9.37-9.37 24.57-9.37 33.94 0l22.67 22.67c9.36 9.36 9.37 24.52.04 33.9L131.49 256l154.02 154.75c9.34 9.38 9.32 24.54-.04 33.9l-22.67 22.67c-9.37 9.37-24.57 9.37-33.94 0L34.52 272.97c-9.37-9.37-9.37-24.57 0-33.94z"},child:[]}]})(e)}function EC(e){return e5({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M240.971 130.524l194.343 194.343c9.373 9.373 9.373 24.569 0 33.941l-22.667 22.667c-9.357 9.357-24.522 9.375-33.901.04L224 227.495 69.255 381.516c-9.379 9.335-24.544 9.317-33.901-.04l-22.667-22.667c-9.373-9.373-9.373-24.569 0-33.941L207.03 130.525c9.372-9.373 24.568-9.373 33.941-.001z"},child:[]}]})(e)}const CC="_container_ce3n2_1",IC="_back_ce3n2_5",kC="_backText_ce3n2_17",X1={container:CC,back:IC,backText:kC},PC=({onClick:e})=>ft.jsx(Rf,{className:X1.container,children:ft.jsxs("div",{className:X1.back,onClick:e,children:[ft.jsx(TC,{size:12}),ft.jsx("div",{className:X1.backText,children:"Back"})]})}),AC="_container_1d3e8_1",MC="_header_1d3e8_5",zC="_isExpanded_1d3e8_15",DC="_title_1d3e8_20",LC="_details_1d3e8_35",RC="_categoryTitle_1d3e8_51",OC="_categoryRows_1d3e8_57",FC="_categoryRow_1d3e8_57",BC="_categoryRowKey_1d3e8_73",NC="_categoryRowValue_1d3e8_82",UC="_arrow_1d3e8_87",Va={container:AC,header:MC,isExpanded:zC,title:DC,details:LC,categoryTitle:RC,categoryRows:OC,categoryRow:FC,categoryRowKey:BC,categoryRowValue:NC,arrow:UC},jC=({dataset:e})=>{const[r,o]=Bt.useState(!1),h=Bt.useMemo(()=>{const g=Qm(e).groupBy("category").entries().filter(([b])=>b!=="undefined").value();return ft.jsx("div",{className:Va.details,children:g.map(([b,w],c)=>ft.jsxs("div",{children:[ft.jsx("h3",{className:Va.categoryTitle,children:b}),ft.jsx("div",{className:Va.categoryRows,children:w.map((D,j)=>ft.jsxs("div",{className:Va.categoryRow,children:[ft.jsxs("div",{className:Va.categoryRowKey,children:[D.name,":"]}),ft.jsx("div",{className:Va.categoryRowValue,children:D.value})]},`row-${j}`))})]},`category-${c}`))})},[e]);return e?ft.jsxs("div",{className:`${Va.container} ${r?Va.isExpanded:""}`,children:[ft.jsxs("div",{className:Va.header,onClick:()=>o(!r),children:[ft.jsx("div",{className:Va.title,children:e[0].value}),ft.jsx("div",{className:`${Va.arrow}`,children:ft.jsx(EC,{})})]}),r?h:null]}):null},t5=({title:e,extraDescriptions:r,getDatasets:o,onClickBack:h})=>{const[g,b]=Bt.useState(null);return Bt.useEffect(()=>{(async()=>{const w=await o(),c=w.length;b(ft.jsxs(ft.Fragment,{children:[ft.jsx(PC,{onClick:h}),ft.jsx(Rf,{title:e,descriptions:[`Number of Datasets: ${c}`,...r]}),ft.jsx(Rf,{title:`Datasets (${c})`,children:w.map((D,j)=>ft.jsx(jC,{dataset:D},`${j}-${D[0].value}`))})]}))})()},[r,o,h,e]),g};function ts(e){return`Minified Redux error #${e}; visit https://redux.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var $C=typeof Symbol=="function"&&Symbol.observable||"@@observable",qb=$C,K1=()=>Math.random().toString(36).substring(7).split("").join("."),VC={INIT:`@@redux/INIT${K1()}`,REPLACE:`@@redux/REPLACE${K1()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${K1()}`},I0=VC;function dw(e){if(typeof e!="object"||e===null)return!1;let r=e;for(;Object.getPrototypeOf(r)!==null;)r=Object.getPrototypeOf(r);return Object.getPrototypeOf(e)===r||Object.getPrototypeOf(e)===null}function n5(e,r,o){if(typeof e!="function")throw new Error(ts(2));if(typeof r=="function"&&typeof o=="function"||typeof o=="function"&&typeof arguments[3]=="function")throw new Error(ts(0));if(typeof r=="function"&&typeof o>"u"&&(o=r,r=void 0),typeof o<"u"){if(typeof o!="function")throw new Error(ts(1));return o(n5)(e,r)}let h=e,g=r,b=new Map,w=b,c=0,D=!1;function j(){w===b&&(w=new Map,b.forEach((Ne,se)=>{w.set(se,Ne)}))}function J(){if(D)throw new Error(ts(3));return g}function G(Ne){if(typeof Ne!="function")throw new Error(ts(4));if(D)throw new Error(ts(5));let se=!0;j();const ue=c++;return w.set(ue,Ne),function(){if(se){if(D)throw new Error(ts(6));se=!1,j(),w.delete(ue),b=null}}}function q(Ne){if(!dw(Ne))throw new Error(ts(7));if(typeof Ne.type>"u")throw new Error(ts(8));if(typeof Ne.type!="string")throw new Error(ts(17));if(D)throw new Error(ts(9));try{D=!0,g=h(g,Ne)}finally{D=!1}return(b=w).forEach(ue=>{ue()}),Ne}function Ee(Ne){if(typeof Ne!="function")throw new Error(ts(10));h=Ne,q({type:I0.REPLACE})}function Ae(){const Ne=G;return{subscribe(se){if(typeof se!="object"||se===null)throw new Error(ts(11));function ue(){const De=se;De.next&&De.next(J())}return ue(),{unsubscribe:Ne(ue)}},[qb](){return this}}}return q({type:I0.INIT}),{dispatch:q,subscribe:G,getState:J,replaceReducer:Ee,[qb]:Ae}}function qC(e){Object.keys(e).forEach(r=>{const o=e[r];if(typeof o(void 0,{type:I0.INIT})>"u")throw new Error(ts(12));if(typeof o(void 0,{type:I0.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(ts(13))})}function ZC(e){const r=Object.keys(e),o={};for(let b=0;b<r.length;b++){const w=r[b];typeof e[w]=="function"&&(o[w]=e[w])}const h=Object.keys(o);let g;try{qC(o)}catch(b){g=b}return function(w={},c){if(g)throw g;let D=!1;const j={};for(let J=0;J<h.length;J++){const G=h[J],q=o[G],Ee=w[G],Ae=q(Ee,c);if(typeof Ae>"u")throw c&&c.type,new Error(ts(14));j[G]=Ae,D=D||Ae!==Ee}return D=D||h.length!==Object.keys(w).length,D?j:w}}function k0(...e){return e.length===0?r=>r:e.length===1?e[0]:e.reduce((r,o)=>(...h)=>r(o(...h)))}function WC(...e){return r=>(o,h)=>{const g=r(o,h);let b=()=>{throw new Error(ts(15))};const w={getState:g.getState,dispatch:(D,...j)=>b(D,...j)},c=e.map(D=>D(w));return b=k0(...c)(g.dispatch),{...g,dispatch:b}}}function GC(e){return dw(e)&&"type"in e&&typeof e.type=="string"}var r5=Symbol.for("immer-nothing"),Zb=Symbol.for("immer-draftable"),Lo=Symbol.for("immer-state");function Ga(e,...r){throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var Vf=Object.getPrototypeOf;function ud(e){return!!e&&!!e[Lo]}function Ou(e){var r;return e?i5(e)||Array.isArray(e)||!!e[Zb]||!!((r=e.constructor)!=null&&r[Zb])||ty(e)||ny(e):!1}var HC=Object.prototype.constructor.toString();function i5(e){if(!e||typeof e!="object")return!1;const r=Vf(e);if(r===null)return!0;const o=Object.hasOwnProperty.call(r,"constructor")&&r.constructor;return o===Object?!0:typeof o=="function"&&Function.toString.call(o)===HC}function P0(e,r){ey(e)===0?Reflect.ownKeys(e).forEach(o=>{r(o,e[o],e)}):e.forEach((o,h)=>r(h,o,e))}function ey(e){const r=e[Lo];return r?r.type_:Array.isArray(e)?1:ty(e)?2:ny(e)?3:0}function sx(e,r){return ey(e)===2?e.has(r):Object.prototype.hasOwnProperty.call(e,r)}function s5(e,r,o){const h=ey(e);h===2?e.set(r,o):h===3?e.add(o):e[r]=o}function XC(e,r){return e===r?e!==0||1/e===1/r:e!==e&&r!==r}function ty(e){return e instanceof Map}function ny(e){return e instanceof Set}function Xh(e){return e.copy_||e.base_}function ox(e,r){if(ty(e))return new Map(e);if(ny(e))return new Set(e);if(Array.isArray(e))return Array.prototype.slice.call(e);const o=i5(e);if(r===!0||r==="class_only"&&!o){const h=Object.getOwnPropertyDescriptors(e);delete h[Lo];let g=Reflect.ownKeys(h);for(let b=0;b<g.length;b++){const w=g[b],c=h[w];c.writable===!1&&(c.writable=!0,c.configurable=!0),(c.get||c.set)&&(h[w]={configurable:!0,writable:!0,enumerable:c.enumerable,value:e[w]})}return Object.create(Vf(e),h)}else{const h=Vf(e);if(h!==null&&o)return{...e};const g=Object.create(h);return Object.assign(g,e)}}function fw(e,r=!1){return ry(e)||ud(e)||!Ou(e)||(ey(e)>1&&(e.set=e.add=e.clear=e.delete=KC),Object.freeze(e),r&&Object.entries(e).forEach(([o,h])=>fw(h,!0))),e}function KC(){Ga(2)}function ry(e){return Object.isFrozen(e)}var YC={};function cd(e){const r=YC[e];return r||Ga(0,e),r}var Vm;function o5(){return Vm}function JC(e,r){return{drafts_:[],parent_:e,immer_:r,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function Wb(e,r){r&&(cd("Patches"),e.patches_=[],e.inversePatches_=[],e.patchListener_=r)}function ax(e){lx(e),e.drafts_.forEach(QC),e.drafts_=null}function lx(e){e===Vm&&(Vm=e.parent_)}function Gb(e){return Vm=JC(Vm,e)}function QC(e){const r=e[Lo];r.type_===0||r.type_===1?r.revoke_():r.revoked_=!0}function Hb(e,r){r.unfinalizedDrafts_=r.drafts_.length;const o=r.drafts_[0];return e!==void 0&&e!==o?(o[Lo].modified_&&(ax(r),Ga(4)),Ou(e)&&(e=A0(r,e),r.parent_||M0(r,e)),r.patches_&&cd("Patches").generateReplacementPatches_(o[Lo].base_,e,r.patches_,r.inversePatches_)):e=A0(r,o,[]),ax(r),r.patches_&&r.patchListener_(r.patches_,r.inversePatches_),e!==r5?e:void 0}function A0(e,r,o){if(ry(r))return r;const h=r[Lo];if(!h)return P0(r,(g,b)=>Xb(e,h,r,g,b,o)),r;if(h.scope_!==e)return r;if(!h.modified_)return M0(e,h.base_,!0),h.base_;if(!h.finalized_){h.finalized_=!0,h.scope_.unfinalizedDrafts_--;const g=h.copy_;let b=g,w=!1;h.type_===3&&(b=new Set(g),g.clear(),w=!0),P0(b,(c,D)=>Xb(e,h,g,c,D,o,w)),M0(e,g,!1),o&&e.patches_&&cd("Patches").generatePatches_(h,o,e.patches_,e.inversePatches_)}return h.copy_}function Xb(e,r,o,h,g,b,w){if(ud(g)){const c=b&&r&&r.type_!==3&&!sx(r.assigned_,h)?b.concat(h):void 0,D=A0(e,g,c);if(s5(o,h,D),ud(D))e.canAutoFreeze_=!1;else return}else w&&o.add(g);if(Ou(g)&&!ry(g)){if(!e.immer_.autoFreeze_&&e.unfinalizedDrafts_<1)return;A0(e,g),(!r||!r.scope_.parent_)&&typeof h!="symbol"&&Object.prototype.propertyIsEnumerable.call(o,h)&&M0(e,g)}}function M0(e,r,o=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&fw(r,o)}function eI(e,r){const o=Array.isArray(e),h={type_:o?1:0,scope_:r?r.scope_:o5(),modified_:!1,finalized_:!1,assigned_:{},parent_:r,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1};let g=h,b=pw;o&&(g=[h],b=qm);const{revoke:w,proxy:c}=Proxy.revocable(g,b);return h.draft_=c,h.revoke_=w,c}var pw={get(e,r){if(r===Lo)return e;const o=Xh(e);if(!sx(o,r))return tI(e,o,r);const h=o[r];return e.finalized_||!Ou(h)?h:h===Y1(e.base_,r)?(J1(e),e.copy_[r]=cx(h,e)):h},has(e,r){return r in Xh(e)},ownKeys(e){return Reflect.ownKeys(Xh(e))},set(e,r,o){const h=a5(Xh(e),r);if(h!=null&&h.set)return h.set.call(e.draft_,o),!0;if(!e.modified_){const g=Y1(Xh(e),r),b=g==null?void 0:g[Lo];if(b&&b.base_===o)return e.copy_[r]=o,e.assigned_[r]=!1,!0;if(XC(o,g)&&(o!==void 0||sx(e.base_,r)))return!0;J1(e),ux(e)}return e.copy_[r]===o&&(o!==void 0||r in e.copy_)||Number.isNaN(o)&&Number.isNaN(e.copy_[r])||(e.copy_[r]=o,e.assigned_[r]=!0),!0},deleteProperty(e,r){return Y1(e.base_,r)!==void 0||r in e.base_?(e.assigned_[r]=!1,J1(e),ux(e)):delete e.assigned_[r],e.copy_&&delete e.copy_[r],!0},getOwnPropertyDescriptor(e,r){const o=Xh(e),h=Reflect.getOwnPropertyDescriptor(o,r);return h&&{writable:!0,configurable:e.type_!==1||r!=="length",enumerable:h.enumerable,value:o[r]}},defineProperty(){Ga(11)},getPrototypeOf(e){return Vf(e.base_)},setPrototypeOf(){Ga(12)}},qm={};P0(pw,(e,r)=>{qm[e]=function(){return arguments[0]=arguments[0][0],r.apply(this,arguments)}});qm.deleteProperty=function(e,r){return qm.set.call(this,e,r,void 0)};qm.set=function(e,r,o){return pw.set.call(this,e[0],r,o,e[0])};function Y1(e,r){const o=e[Lo];return(o?Xh(o):e)[r]}function tI(e,r,o){var g;const h=a5(r,o);return h?"value"in h?h.value:(g=h.get)==null?void 0:g.call(e.draft_):void 0}function a5(e,r){if(!(r in e))return;let o=Vf(e);for(;o;){const h=Object.getOwnPropertyDescriptor(o,r);if(h)return h;o=Vf(o)}}function ux(e){e.modified_||(e.modified_=!0,e.parent_&&ux(e.parent_))}function J1(e){e.copy_||(e.copy_=ox(e.base_,e.scope_.immer_.useStrictShallowCopy_))}var nI=class{constructor(e){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(r,o,h)=>{if(typeof r=="function"&&typeof o!="function"){const b=o;o=r;const w=this;return function(D=b,...j){return w.produce(D,J=>o.call(this,J,...j))}}typeof o!="function"&&Ga(6),h!==void 0&&typeof h!="function"&&Ga(7);let g;if(Ou(r)){const b=Gb(this),w=cx(r,void 0);let c=!0;try{g=o(w),c=!1}finally{c?ax(b):lx(b)}return Wb(b,h),Hb(g,b)}else if(!r||typeof r!="object"){if(g=o(r),g===void 0&&(g=r),g===r5&&(g=void 0),this.autoFreeze_&&fw(g,!0),h){const b=[],w=[];cd("Patches").generateReplacementPatches_(r,g,b,w),h(b,w)}return g}else Ga(1,r)},this.produceWithPatches=(r,o)=>{if(typeof r=="function")return(w,...c)=>this.produceWithPatches(w,D=>r(D,...c));let h,g;return[this.produce(r,o,(w,c)=>{h=w,g=c}),h,g]},typeof(e==null?void 0:e.autoFreeze)=="boolean"&&this.setAutoFreeze(e.autoFreeze),typeof(e==null?void 0:e.useStrictShallowCopy)=="boolean"&&this.setUseStrictShallowCopy(e.useStrictShallowCopy)}createDraft(e){Ou(e)||Ga(8),ud(e)&&(e=rI(e));const r=Gb(this),o=cx(e,void 0);return o[Lo].isManual_=!0,lx(r),o}finishDraft(e,r){const o=e&&e[Lo];(!o||!o.isManual_)&&Ga(9);const{scope_:h}=o;return Wb(h,r),Hb(void 0,h)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}applyPatches(e,r){let o;for(o=r.length-1;o>=0;o--){const g=r[o];if(g.path.length===0&&g.op==="replace"){e=g.value;break}}o>-1&&(r=r.slice(o+1));const h=cd("Patches").applyPatches_;return ud(e)?h(e,r):this.produce(e,g=>h(g,r))}};function cx(e,r){const o=ty(e)?cd("MapSet").proxyMap_(e,r):ny(e)?cd("MapSet").proxySet_(e,r):eI(e,r);return(r?r.scope_:o5()).drafts_.push(o),o}function rI(e){return ud(e)||Ga(10,e),l5(e)}function l5(e){if(!Ou(e)||ry(e))return e;const r=e[Lo];let o;if(r){if(!r.modified_)return r.base_;r.finalized_=!0,o=ox(e,r.scope_.immer_.useStrictShallowCopy_)}else o=ox(e,!0);return P0(o,(h,g)=>{s5(o,h,l5(g))}),r&&(r.finalized_=!1),o}var Ro=new nI,u5=Ro.produce;Ro.produceWithPatches.bind(Ro);Ro.setAutoFreeze.bind(Ro);Ro.setUseStrictShallowCopy.bind(Ro);Ro.applyPatches.bind(Ro);Ro.createDraft.bind(Ro);Ro.finishDraft.bind(Ro);function c5(e){return({dispatch:o,getState:h})=>g=>b=>typeof b=="function"?b(o,h,e):g(b)}var iI=c5(),sI=c5,oI=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?k0:k0.apply(null,arguments)};function Kb(e,r){function o(...h){if(r){let g=r(...h);if(!g)throw new Error(Nl(0));return{type:e,payload:g.payload,..."meta"in g&&{meta:g.meta},..."error"in g&&{error:g.error}}}return{type:e,payload:h[0]}}return o.toString=()=>`${e}`,o.type=e,o.match=h=>GC(h)&&h.type===e,o}var h5=class gm extends Array{constructor(...r){super(...r),Object.setPrototypeOf(this,gm.prototype)}static get[Symbol.species](){return gm}concat(...r){return super.concat.apply(this,r)}prepend(...r){return r.length===1&&Array.isArray(r[0])?new gm(...r[0].concat(this)):new gm(...r.concat(this))}};function Yb(e){return Ou(e)?u5(e,()=>{}):e}function Jb(e,r,o){if(e.has(r)){let g=e.get(r);return o.update&&(g=o.update(g,r,e),e.set(r,g)),g}if(!o.insert)throw new Error(Nl(10));const h=o.insert(r,e);return e.set(r,h),h}function aI(e){return typeof e=="boolean"}var lI=()=>function(r){const{thunk:o=!0,immutableCheck:h=!0,serializableCheck:g=!0,actionCreatorCheck:b=!0}=r??{};let w=new h5;return o&&(aI(o)?w.push(iI):w.push(sI(o.extraArgument))),w},uI="RTK_autoBatch",d5=e=>r=>{setTimeout(r,e)},cI=typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame:d5(10),hI=(e={type:"raf"})=>r=>(...o)=>{const h=r(...o);let g=!0,b=!1,w=!1;const c=new Set,D=e.type==="tick"?queueMicrotask:e.type==="raf"?cI:e.type==="callback"?e.queueNotification:d5(e.timeout),j=()=>{w=!1,b&&(b=!1,c.forEach(J=>J()))};return Object.assign({},h,{subscribe(J){const G=()=>g&&J(),q=h.subscribe(G);return c.add(J),()=>{q(),c.delete(J)}},dispatch(J){var G;try{return g=!((G=J==null?void 0:J.meta)!=null&&G[uI]),b=!g,b&&(w||(w=!0,D(j))),h.dispatch(J)}finally{g=!0}}})},dI=e=>function(o){const{autoBatch:h=!0}=o??{};let g=new h5(e);return h&&g.push(hI(typeof h=="object"?h:void 0)),g};function fI(e){const r=lI(),{reducer:o=void 0,middleware:h,devTools:g=!0,preloadedState:b=void 0,enhancers:w=void 0}=e||{};let c;if(typeof o=="function")c=o;else if(dw(o))c=ZC(o);else throw new Error(Nl(1));let D;typeof h=="function"?D=h(r):D=r();let j=k0;g&&(j=oI({trace:!1,...typeof g=="object"&&g}));const J=WC(...D),G=dI(J);let q=typeof w=="function"?w(G):G();const Ee=j(...q);return n5(c,b,Ee)}function f5(e){const r={},o=[];let h;const g={addCase(b,w){const c=typeof b=="string"?b:b.type;if(!c)throw new Error(Nl(28));if(c in r)throw new Error(Nl(29));return r[c]=w,g},addMatcher(b,w){return o.push({matcher:b,reducer:w}),g},addDefaultCase(b){return h=b,g}};return e(g),[r,o,h]}function pI(e){return typeof e=="function"}function mI(e,r){let[o,h,g]=f5(r),b;if(pI(e))b=()=>Yb(e());else{const c=Yb(e);b=()=>c}function w(c=b(),D){let j=[o[D.type],...h.filter(({matcher:J})=>J(D)).map(({reducer:J})=>J)];return j.filter(J=>!!J).length===0&&(j=[g]),j.reduce((J,G)=>{if(G)if(ud(J)){const Ee=G(J,D);return Ee===void 0?J:Ee}else{if(Ou(J))return u5(J,q=>G(q,D));{const q=G(J,D);if(q===void 0){if(J===null)return J;throw Error("A case reducer on a non-draftable value must not return undefined")}return q}}return J},c)}return w.getInitialState=b,w}var gI=Symbol.for("rtk-slice-createasyncthunk");function _I(e,r){return`${e}/${r}`}function yI({creators:e}={}){var o;const r=(o=e==null?void 0:e.asyncThunk)==null?void 0:o[gI];return function(g){const{name:b,reducerPath:w=b}=g;if(!b)throw new Error(Nl(11));typeof process<"u";const c=(typeof g.reducers=="function"?g.reducers(wI()):g.reducers)||{},D=Object.keys(c),j={sliceCaseReducersByName:{},sliceCaseReducersByType:{},actionCreators:{},sliceMatchers:[]},J={addCase(he,De){const Ze=typeof he=="string"?he:he.type;if(!Ze)throw new Error(Nl(12));if(Ze in j.sliceCaseReducersByType)throw new Error(Nl(13));return j.sliceCaseReducersByType[Ze]=De,J},addMatcher(he,De){return j.sliceMatchers.push({matcher:he,reducer:De}),J},exposeAction(he,De){return j.actionCreators[he]=De,J},exposeCaseReducer(he,De){return j.sliceCaseReducersByName[he]=De,J}};D.forEach(he=>{const De=c[he],Ze={reducerName:he,type:_I(b,he),createNotation:typeof g.reducers=="function"};SI(De)?EI(Ze,De,J,r):bI(Ze,De,J)});function G(){const[he={},De=[],Ze=void 0]=typeof g.extraReducers=="function"?f5(g.extraReducers):[g.extraReducers],je={...he,...j.sliceCaseReducersByType};return mI(g.initialState,ve=>{for(let ee in je)ve.addCase(ee,je[ee]);for(let ee of j.sliceMatchers)ve.addMatcher(ee.matcher,ee.reducer);for(let ee of De)ve.addMatcher(ee.matcher,ee.reducer);Ze&&ve.addDefaultCase(Ze)})}const q=he=>he,Ee=new Map;let Ae;function Fe(he,De){return Ae||(Ae=G()),Ae(he,De)}function Ne(){return Ae||(Ae=G()),Ae.getInitialState()}function se(he,De=!1){function Ze(ve){let ee=ve[he];return typeof ee>"u"&&De&&(ee=Ne()),ee}function je(ve=q){const ee=Jb(Ee,De,{insert:()=>new WeakMap});return Jb(ee,ve,{insert:()=>{const de={};for(const[Te,Ue]of Object.entries(g.selectors??{}))de[Te]=vI(Ue,ve,Ne,De);return de}})}return{reducerPath:he,getSelectors:je,get selectors(){return je(Ze)},selectSlice:Ze}}const ue={name:b,reducer:Fe,actions:j.actionCreators,caseReducers:j.sliceCaseReducersByName,getInitialState:Ne,...se(w),injectInto(he,{reducerPath:De,...Ze}={}){const je=De??w;return he.inject({reducerPath:je,reducer:Fe},Ze),{...ue,...se(je,!0)}}};return ue}}function vI(e,r,o,h){function g(b,...w){let c=r(b);return typeof c>"u"&&h&&(c=o()),e(c,...w)}return g.unwrapped=e,g}var xI=yI();function wI(){function e(r,o){return{_reducerDefinitionType:"asyncThunk",payloadCreator:r,...o}}return e.withTypes=()=>e,{reducer(r){return Object.assign({[r.name](...o){return r(...o)}}[r.name],{_reducerDefinitionType:"reducer"})},preparedReducer(r,o){return{_reducerDefinitionType:"reducerWithPrepare",prepare:r,reducer:o}},asyncThunk:e}}function bI({type:e,reducerName:r,createNotation:o},h,g){let b,w;if("reducer"in h){if(o&&!TI(h))throw new Error(Nl(17));b=h.reducer,w=h.prepare}else b=h;g.addCase(e,b).exposeCaseReducer(r,b).exposeAction(r,w?Kb(e,w):Kb(e))}function SI(e){return e._reducerDefinitionType==="asyncThunk"}function TI(e){return e._reducerDefinitionType==="reducerWithPrepare"}function EI({type:e,reducerName:r},o,h,g){if(!g)throw new Error(Nl(18));const{payloadCreator:b,fulfilled:w,pending:c,rejected:D,settled:j,options:J}=o,G=g(e,b,J);h.exposeAction(r,G),w&&h.addCase(G.fulfilled,w),c&&h.addCase(G.pending,c),D&&h.addCase(G.rejected,D),j&&h.addMatcher(G.settled,j),h.exposeCaseReducer(r,{fulfilled:w||L_,pending:c||L_,rejected:D||L_,settled:j||L_})}function L_(){}function Nl(e){return`Minified Redux Toolkit error #${e}; visit https://redux-toolkit.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}const jl=xI({name:"main",initialState:{isMapInitialized:!1,focusedCountry:null,focusedState:null,menuWidthPx:500},reducers:{setIsMapInitialized:(e,r)=>{e.isMapInitialized=r.payload},setFocusedCountry:(e,r)=>{e.focusedCountry=r.payload},setFocusedState:(e,r)=>{e.focusedState=r.payload},setMenuWidthPx:(e,r)=>{e.menuWidthPx=r.payload}}});var p5={exports:{}};/**
 * MapLibre GL JS
 * @license 3-Clause BSD. Full text of license: https://github.com/maplibre/maplibre-gl-js/blob/v4.7.1/LICENSE.txt
 */(function(e,r){(function(o,h){e.exports=h()})(Kh,function(){var o={},h={};function g(w,c,D){if(h[w]=D,w==="index"){var j="var sharedModule = {}; ("+h.shared+")(sharedModule); ("+h.worker+")(sharedModule);",J={};return h.shared(J),h.index(o,J),typeof window<"u"&&o.setWorkerUrl(window.URL.createObjectURL(new Blob([j],{type:"text/javascript"}))),o}}g("shared",["exports"],function(w){function c(i,n,s,l){return new(s||(s=Promise))(function(p,v){function x(P){try{C(l.next(P))}catch(M){v(M)}}function S(P){try{C(l.throw(P))}catch(M){v(M)}}function C(P){var M;P.done?p(P.value):(M=P.value,M instanceof s?M:new s(function(L){L(M)})).then(x,S)}C((l=l.apply(i,n||[])).next())})}function D(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}typeof SuppressedError=="function"&&SuppressedError;var j=J;function J(i,n){this.x=i,this.y=n}J.prototype={clone:function(){return new J(this.x,this.y)},add:function(i){return this.clone()._add(i)},sub:function(i){return this.clone()._sub(i)},multByPoint:function(i){return this.clone()._multByPoint(i)},divByPoint:function(i){return this.clone()._divByPoint(i)},mult:function(i){return this.clone()._mult(i)},div:function(i){return this.clone()._div(i)},rotate:function(i){return this.clone()._rotate(i)},rotateAround:function(i,n){return this.clone()._rotateAround(i,n)},matMult:function(i){return this.clone()._matMult(i)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(i){return this.x===i.x&&this.y===i.y},dist:function(i){return Math.sqrt(this.distSqr(i))},distSqr:function(i){var n=i.x-this.x,s=i.y-this.y;return n*n+s*s},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(i){return Math.atan2(this.y-i.y,this.x-i.x)},angleWith:function(i){return this.angleWithSep(i.x,i.y)},angleWithSep:function(i,n){return Math.atan2(this.x*n-this.y*i,this.x*i+this.y*n)},_matMult:function(i){var n=i[2]*this.x+i[3]*this.y;return this.x=i[0]*this.x+i[1]*this.y,this.y=n,this},_add:function(i){return this.x+=i.x,this.y+=i.y,this},_sub:function(i){return this.x-=i.x,this.y-=i.y,this},_mult:function(i){return this.x*=i,this.y*=i,this},_div:function(i){return this.x/=i,this.y/=i,this},_multByPoint:function(i){return this.x*=i.x,this.y*=i.y,this},_divByPoint:function(i){return this.x/=i.x,this.y/=i.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var i=this.y;return this.y=this.x,this.x=-i,this},_rotate:function(i){var n=Math.cos(i),s=Math.sin(i),l=s*this.x+n*this.y;return this.x=n*this.x-s*this.y,this.y=l,this},_rotateAround:function(i,n){var s=Math.cos(i),l=Math.sin(i),p=n.y+l*(this.x-n.x)+s*(this.y-n.y);return this.x=n.x+s*(this.x-n.x)-l*(this.y-n.y),this.y=p,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},J.convert=function(i){return i instanceof J?i:Array.isArray(i)?new J(i[0],i[1]):i};var G=D(j),q=Ee;function Ee(i,n,s,l){this.cx=3*i,this.bx=3*(s-i)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*n,this.by=3*(l-n)-this.cy,this.ay=1-this.cy-this.by,this.p1x=i,this.p1y=n,this.p2x=s,this.p2y=l}Ee.prototype={sampleCurveX:function(i){return((this.ax*i+this.bx)*i+this.cx)*i},sampleCurveY:function(i){return((this.ay*i+this.by)*i+this.cy)*i},sampleCurveDerivativeX:function(i){return(3*this.ax*i+2*this.bx)*i+this.cx},solveCurveX:function(i,n){if(n===void 0&&(n=1e-6),i<0)return 0;if(i>1)return 1;for(var s=i,l=0;l<8;l++){var p=this.sampleCurveX(s)-i;if(Math.abs(p)<n)return s;var v=this.sampleCurveDerivativeX(s);if(Math.abs(v)<1e-6)break;s-=p/v}var x=0,S=1;for(s=i,l=0;l<20&&(p=this.sampleCurveX(s),!(Math.abs(p-i)<n));l++)i>p?x=s:S=s,s=.5*(S-x)+x;return s},solve:function(i,n){return this.sampleCurveY(this.solveCurveX(i,n))}};var Ae=D(q);let Fe,Ne;function se(){return Fe==null&&(Fe=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),Fe}function ue(){if(Ne==null&&(Ne=!1,se())){const n=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(n){for(let l=0;l<5*5;l++){const p=4*l;n.fillStyle=`rgb(${p},${p+1},${p+2})`,n.fillRect(l%5,Math.floor(l/5),1,1)}const s=n.getImageData(0,0,5,5).data;for(let l=0;l<5*5*4;l++)if(l%4!=3&&s[l]!==l){Ne=!0;break}}}return Ne||!1}function he(i,n,s,l){const p=new Ae(i,n,s,l);return v=>p.solve(v)}const De=he(.25,.1,.25,1);function Ze(i,n,s){return Math.min(s,Math.max(n,i))}function je(i,n,s){const l=s-n,p=((i-n)%l+l)%l+n;return p===n?s:p}function ve(i,...n){for(const s of n)for(const l in s)i[l]=s[l];return i}let ee=1;function de(i,n,s){const l={};for(const p in i)l[p]=n.call(this,i[p],p,i);return l}function Te(i,n,s){const l={};for(const p in i)n.call(this,i[p],p,i)&&(l[p]=i[p]);return l}function Ue(i){return Array.isArray(i)?i.map(Ue):typeof i=="object"&&i?de(i,Ue):i}const Xe={};function mt(i){Xe[i]||(typeof console<"u"&&console.warn(i),Xe[i]=!0)}function Kt(i,n,s){return(s.y-i.y)*(n.x-i.x)>(n.y-i.y)*(s.x-i.x)}function qn(i){return typeof WorkerGlobalScope<"u"&&i!==void 0&&i instanceof WorkerGlobalScope}let Qn=null;function zt(i){return typeof ImageBitmap<"u"&&i instanceof ImageBitmap}const Je="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function nt(i,n,s,l,p){return c(this,void 0,void 0,function*(){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");const v=new VideoFrame(i,{timestamp:0});try{const x=v==null?void 0:v.format;if(!x||!x.startsWith("BGR")&&!x.startsWith("RGB"))throw new Error(`Unrecognized format ${x}`);const S=x.startsWith("BGR"),C=new Uint8ClampedArray(l*p*4);if(yield v.copyTo(C,function(P,M,L,F,U){const W=4*Math.max(-M,0),Z=(Math.max(0,L)-L)*F*4+W,ne=4*F,oe=Math.max(0,M),Pe=Math.max(0,L);return{rect:{x:oe,y:Pe,width:Math.min(P.width,M+F)-oe,height:Math.min(P.height,L+U)-Pe},layout:[{offset:Z,stride:ne}]}}(i,n,s,l,p)),S)for(let P=0;P<C.length;P+=4){const M=C[P];C[P]=C[P+2],C[P+2]=M}return C}finally{v.close()}})}let Et,ct;const It="AbortError";function St(){return new Error(It)}const Sn={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};function cn(i){return Sn.REGISTERED_PROTOCOLS[i.substring(0,i.indexOf("://"))]}const Cn="global-dispatcher";class Nn extends Error{constructor(n,s,l,p){super(`AJAXError: ${s} (${n}): ${l}`),this.status=n,this.statusText=s,this.url=l,this.body=p}}const Zt=()=>qn(self)?self.worker&&self.worker.referrer:(window.location.protocol==="blob:"?window.parent:window).location.href,rn=function(i,n){if(/:\/\//.test(i.url)&&!/^https?:|^file:/.test(i.url)){const l=cn(i.url);if(l)return l(i,n);if(qn(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:i,targetMapId:Cn},n)}if(!(/^file:/.test(s=i.url)||/^file:/.test(Zt())&&!/^\w+:/.test(s))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return function(l,p){return c(this,void 0,void 0,function*(){const v=new Request(l.url,{method:l.method||"GET",body:l.body,credentials:l.credentials,headers:l.headers,cache:l.cache,referrer:Zt(),signal:p.signal});l.type!=="json"||v.headers.has("Accept")||v.headers.set("Accept","application/json");const x=yield fetch(v);if(!x.ok){const P=yield x.blob();throw new Nn(x.status,x.statusText,l.url,P)}let S;S=l.type==="arrayBuffer"||l.type==="image"?x.arrayBuffer():l.type==="json"?x.json():x.text();const C=yield S;if(p.signal.aborted)throw St();return{data:C,cacheControl:x.headers.get("Cache-Control"),expires:x.headers.get("Expires")}})}(i,n);if(qn(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:i,mustQueue:!0,targetMapId:Cn},n)}var s;return function(l,p){return new Promise((v,x)=>{var S;const C=new XMLHttpRequest;C.open(l.method||"GET",l.url,!0),l.type!=="arrayBuffer"&&l.type!=="image"||(C.responseType="arraybuffer");for(const P in l.headers)C.setRequestHeader(P,l.headers[P]);l.type==="json"&&(C.responseType="text",!((S=l.headers)===null||S===void 0)&&S.Accept||C.setRequestHeader("Accept","application/json")),C.withCredentials=l.credentials==="include",C.onerror=()=>{x(new Error(C.statusText))},C.onload=()=>{if(!p.signal.aborted)if((C.status>=200&&C.status<300||C.status===0)&&C.response!==null){let P=C.response;if(l.type==="json")try{P=JSON.parse(C.response)}catch(M){return void x(M)}v({data:P,cacheControl:C.getResponseHeader("Cache-Control"),expires:C.getResponseHeader("Expires")})}else{const P=new Blob([C.response],{type:C.getResponseHeader("Content-Type")});x(new Nn(C.status,C.statusText,l.url,P))}},p.signal.addEventListener("abort",()=>{C.abort(),x(St())}),C.send(l.body)})}(i,n)};function Zn(i){if(!i||i.indexOf("://")<=0||i.indexOf("data:image/")===0||i.indexOf("blob:")===0)return!0;const n=new URL(i),s=window.location;return n.protocol===s.protocol&&n.host===s.host}function Qt(i,n,s){s[i]&&s[i].indexOf(n)!==-1||(s[i]=s[i]||[],s[i].push(n))}function wn(i,n,s){if(s&&s[i]){const l=s[i].indexOf(n);l!==-1&&s[i].splice(l,1)}}class er{constructor(n,s={}){ve(this,s),this.type=n}}class sn extends er{constructor(n,s={}){super("error",ve({error:n},s))}}class dn{on(n,s){return this._listeners=this._listeners||{},Qt(n,s,this._listeners),this}off(n,s){return wn(n,s,this._listeners),wn(n,s,this._oneTimeListeners),this}once(n,s){return s?(this._oneTimeListeners=this._oneTimeListeners||{},Qt(n,s,this._oneTimeListeners),this):new Promise(l=>this.once(n,l))}fire(n,s){typeof n=="string"&&(n=new er(n,s||{}));const l=n.type;if(this.listens(l)){n.target=this;const p=this._listeners&&this._listeners[l]?this._listeners[l].slice():[];for(const S of p)S.call(this,n);const v=this._oneTimeListeners&&this._oneTimeListeners[l]?this._oneTimeListeners[l].slice():[];for(const S of v)wn(l,S,this._oneTimeListeners),S.call(this,n);const x=this._eventedParent;x&&(ve(n,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),x.fire(n))}else n instanceof sn&&console.error(n.error);return this}listens(n){return this._listeners&&this._listeners[n]&&this._listeners[n].length>0||this._oneTimeListeners&&this._oneTimeListeners[n]&&this._oneTimeListeners[n].length>0||this._eventedParent&&this._eventedParent.listens(n)}setEventedParent(n,s){return this._eventedParent=n,this._eventedParentData=s,this}}var Ce={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sky:{type:"sky"},projection:{type:"projection"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},sky:{"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-ground-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-fog-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"sky-horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"atmosphere-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},projection:{type:{type:"enum",default:"mercator",values:{mercator:{},globe:{}}}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};const Fn=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function bn(i,n){const s={};for(const l in i)l!=="ref"&&(s[l]=i[l]);return Fn.forEach(l=>{l in n&&(s[l]=n[l])}),s}function Rt(i,n){if(Array.isArray(i)){if(!Array.isArray(n)||i.length!==n.length)return!1;for(let s=0;s<i.length;s++)if(!Rt(i[s],n[s]))return!1;return!0}if(typeof i=="object"&&i!==null&&n!==null){if(typeof n!="object"||Object.keys(i).length!==Object.keys(n).length)return!1;for(const s in i)if(!Rt(i[s],n[s]))return!1;return!0}return i===n}function Yt(i,n){i.push(n)}function Tr(i,n,s){Yt(s,{command:"addSource",args:[i,n[i]]})}function yr(i,n,s){Yt(n,{command:"removeSource",args:[i]}),s[i]=!0}function Gr(i,n,s,l){yr(i,s,l),Tr(i,n,s)}function vr(i,n,s){let l;for(l in i[s])if(Object.prototype.hasOwnProperty.call(i[s],l)&&l!=="data"&&!Rt(i[s][l],n[s][l]))return!1;for(l in n[s])if(Object.prototype.hasOwnProperty.call(n[s],l)&&l!=="data"&&!Rt(i[s][l],n[s][l]))return!1;return!0}function rr(i,n,s,l,p,v){i=i||{},n=n||{};for(const x in i)Object.prototype.hasOwnProperty.call(i,x)&&(Rt(i[x],n[x])||s.push({command:v,args:[l,x,n[x],p]}));for(const x in n)Object.prototype.hasOwnProperty.call(n,x)&&!Object.prototype.hasOwnProperty.call(i,x)&&(Rt(i[x],n[x])||s.push({command:v,args:[l,x,n[x],p]}))}function dr(i){return i.id}function fr(i,n){return i[n.id]=n,i}class Ke{constructor(n,s,l,p){this.message=(n?`${n}: `:"")+l,p&&(this.identifier=p),s!=null&&s.__line__&&(this.line=s.__line__)}}function ci(i,...n){for(const s of n)for(const l in s)i[l]=s[l];return i}class Rr extends Error{constructor(n,s){super(s),this.message=s,this.key=n}}class jr{constructor(n,s=[]){this.parent=n,this.bindings={};for(const[l,p]of s)this.bindings[l]=p}concat(n){return new jr(this,n)}get(n){if(this.bindings[n])return this.bindings[n];if(this.parent)return this.parent.get(n);throw new Error(`${n} not found in scope.`)}has(n){return!!this.bindings[n]||!!this.parent&&this.parent.has(n)}}const Pr={kind:"null"},rt={kind:"number"},Ht={kind:"string"},Ut={kind:"boolean"},hi={kind:"color"},qi={kind:"object"},Xt={kind:"value"},Ks={kind:"collator"},uo={kind:"formatted"},co={kind:"padding"},Ds={kind:"resolvedImage"},ae={kind:"variableAnchorOffsetCollection"};function N(i,n){return{kind:"array",itemType:i,N:n}}function B(i){if(i.kind==="array"){const n=B(i.itemType);return typeof i.N=="number"?`array<${n}, ${i.N}>`:i.itemType.kind==="value"?"array":`array<${n}>`}return i.kind}const K=[Pr,rt,Ht,Ut,hi,uo,qi,N(Xt),co,Ds,ae];function re(i,n){if(n.kind==="error")return null;if(i.kind==="array"){if(n.kind==="array"&&(n.N===0&&n.itemType.kind==="value"||!re(i.itemType,n.itemType))&&(typeof i.N!="number"||i.N===n.N))return null}else{if(i.kind===n.kind)return null;if(i.kind==="value"){for(const s of K)if(!re(s,n))return null}}return`Expected ${B(i)} but found ${B(n)} instead.`}function ye(i,n){return n.some(s=>s.kind===i.kind)}function Se(i,n){return n.some(s=>s==="null"?i===null:s==="array"?Array.isArray(i):s==="object"?i&&!Array.isArray(i)&&typeof i=="object":s===typeof i)}function ke(i,n){return i.kind==="array"&&n.kind==="array"?i.itemType.kind===n.itemType.kind&&typeof i.N=="number":i.kind===n.kind}const pe=.96422,Be=.82521,We=4/29,Le=6/29,it=3*Le*Le,Mt=Le*Le*Le,Lt=Math.PI/180,In=180/Math.PI;function Jt(i){return(i%=360)<0&&(i+=360),i}function kn([i,n,s,l]){let p,v;const x=Ar((.2225045*(i=fn(i))+.7168786*(n=fn(n))+.0606169*(s=fn(s)))/1);i===n&&n===s?p=v=x:(p=Ar((.4360747*i+.3850649*n+.1430804*s)/pe),v=Ar((.0139322*i+.0971045*n+.7141733*s)/Be));const S=116*x-16;return[S<0?0:S,500*(p-x),200*(x-v),l]}function fn(i){return i<=.04045?i/12.92:Math.pow((i+.055)/1.055,2.4)}function Ar(i){return i>Mt?Math.pow(i,1/3):i/it+We}function xr([i,n,s,l]){let p=(i+16)/116,v=isNaN(n)?p:p+n/500,x=isNaN(s)?p:p-s/200;return p=1*Wn(p),v=pe*Wn(v),x=Be*Wn(x),[on(3.1338561*v-1.6168667*p-.4906146*x),on(-.9787684*v+1.9161415*p+.033454*x),on(.0719453*v-.2289914*p+1.4052427*x),l]}function on(i){return(i=i<=.00304?12.92*i:1.055*Math.pow(i,1/2.4)-.055)<0?0:i>1?1:i}function Wn(i){return i>Le?i*i*i:it*(i-We)}function ur(i){return parseInt(i.padEnd(2,i),16)/255}function Hr(i,n){return ti(n?i/100:i,0,1)}function ti(i,n,s){return Math.min(Math.max(n,i),s)}function Xr(i){return!i.some(Number.isNaN)}const Qa={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};class Ln{constructor(n,s,l,p=1,v=!0){this.r=n,this.g=s,this.b=l,this.a=p,v||(this.r*=p,this.g*=p,this.b*=p,p||this.overwriteGetter("rgb",[n,s,l,p]))}static parse(n){if(n instanceof Ln)return n;if(typeof n!="string")return;const s=function(l){if((l=l.toLowerCase().trim())==="transparent")return[0,0,0,0];const p=Qa[l];if(p){const[x,S,C]=p;return[x/255,S/255,C/255,1]}if(l.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(l)){const x=l.length<6?1:2;let S=1;return[ur(l.slice(S,S+=x)),ur(l.slice(S,S+=x)),ur(l.slice(S,S+=x)),ur(l.slice(S,S+x)||"ff")]}if(l.startsWith("rgb")){const x=l.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(x){const[S,C,P,M,L,F,U,W,Z,ne,oe,Pe]=x,ge=[M||" ",U||" ",ne].join("");if(ge==="  "||ge==="  /"||ge===",,"||ge===",,,"){const _e=[P,F,Z].join(""),Re=_e==="%%%"?100:_e===""?255:0;if(Re){const Ye=[ti(+C/Re,0,1),ti(+L/Re,0,1),ti(+W/Re,0,1),oe?Hr(+oe,Pe):1];if(Xr(Ye))return Ye}}return}}const v=l.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(v){const[x,S,C,P,M,L,F,U,W]=v,Z=[C||" ",M||" ",F].join("");if(Z==="  "||Z==="  /"||Z===",,"||Z===",,,"){const ne=[+S,ti(+P,0,100),ti(+L,0,100),U?Hr(+U,W):1];if(Xr(ne))return function([oe,Pe,ge,_e]){function Re(Ye){const gt=(Ye+oe/30)%12,Ot=Pe*Math.min(ge,1-ge);return ge-Ot*Math.max(-1,Math.min(gt-3,9-gt,1))}return oe=Jt(oe),Pe/=100,ge/=100,[Re(0),Re(8),Re(4),_e]}(ne)}}}(n);return s?new Ln(...s,!1):void 0}get rgb(){const{r:n,g:s,b:l,a:p}=this,v=p||1/0;return this.overwriteGetter("rgb",[n/v,s/v,l/v,p])}get hcl(){return this.overwriteGetter("hcl",function(n){const[s,l,p,v]=kn(n),x=Math.sqrt(l*l+p*p);return[Math.round(1e4*x)?Jt(Math.atan2(p,l)*In):NaN,x,s,v]}(this.rgb))}get lab(){return this.overwriteGetter("lab",kn(this.rgb))}overwriteGetter(n,s){return Object.defineProperty(this,n,{value:s}),s}toString(){const[n,s,l,p]=this.rgb;return`rgba(${[n,s,l].map(v=>Math.round(255*v)).join(",")},${p})`}}Ln.black=new Ln(0,0,0,1),Ln.white=new Ln(1,1,1,1),Ln.transparent=new Ln(0,0,0,0),Ln.red=new Ln(1,0,0,1);class Gc{constructor(n,s,l){this.sensitivity=n?s?"variant":"case":s?"accent":"base",this.locale=l,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(n,s){return this.collator.compare(n,s)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class Hc{constructor(n,s,l,p,v){this.text=n,this.image=s,this.scale=l,this.fontStack=p,this.textColor=v}}class Zi{constructor(n){this.sections=n}static fromString(n){return new Zi([new Hc(n,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(n=>n.text.length!==0||n.image&&n.image.name.length!==0)}static factory(n){return n instanceof Zi?n:Zi.fromString(n)}toString(){return this.sections.length===0?"":this.sections.map(n=>n.text).join("")}}class zi{constructor(n){this.values=n.slice()}static parse(n){if(n instanceof zi)return n;if(typeof n=="number")return new zi([n,n,n,n]);if(Array.isArray(n)&&!(n.length<1||n.length>4)){for(const s of n)if(typeof s!="number")return;switch(n.length){case 1:n=[n[0],n[0],n[0],n[0]];break;case 2:n=[n[0],n[1],n[0],n[1]];break;case 3:n=[n[0],n[1],n[2],n[1]]}return new zi(n)}}toString(){return JSON.stringify(this.values)}}const fd=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class Wi{constructor(n){this.values=n.slice()}static parse(n){if(n instanceof Wi)return n;if(Array.isArray(n)&&!(n.length<1)&&n.length%2==0){for(let s=0;s<n.length;s+=2){const l=n[s],p=n[s+1];if(typeof l!="string"||!fd.has(l)||!Array.isArray(p)||p.length!==2||typeof p[0]!="number"||typeof p[1]!="number")return}return new Wi(n)}}toString(){return JSON.stringify(this.values)}}class Gi{constructor(n){this.name=n.name,this.available=n.available}toString(){return this.name}static fromString(n){return n?new Gi({name:n,available:!1}):null}}function el(i,n,s,l){return typeof i=="number"&&i>=0&&i<=255&&typeof n=="number"&&n>=0&&n<=255&&typeof s=="number"&&s>=0&&s<=255?l===void 0||typeof l=="number"&&l>=0&&l<=1?null:`Invalid rgba value [${[i,n,s,l].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof l=="number"?[i,n,s,l]:[i,n,s]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function fa(i){if(i===null||typeof i=="string"||typeof i=="boolean"||typeof i=="number"||i instanceof Ln||i instanceof Gc||i instanceof Zi||i instanceof zi||i instanceof Wi||i instanceof Gi)return!0;if(Array.isArray(i)){for(const n of i)if(!fa(n))return!1;return!0}if(typeof i=="object"){for(const n in i)if(!fa(i[n]))return!1;return!0}return!1}function Or(i){if(i===null)return Pr;if(typeof i=="string")return Ht;if(typeof i=="boolean")return Ut;if(typeof i=="number")return rt;if(i instanceof Ln)return hi;if(i instanceof Gc)return Ks;if(i instanceof Zi)return uo;if(i instanceof zi)return co;if(i instanceof Wi)return ae;if(i instanceof Gi)return Ds;if(Array.isArray(i)){const n=i.length;let s;for(const l of i){const p=Or(l);if(s){if(s===p)continue;s=Xt;break}s=p}return N(s||Xt,n)}return qi}function tl(i){const n=typeof i;return i===null?"":n==="string"||n==="number"||n==="boolean"?String(i):i instanceof Ln||i instanceof Zi||i instanceof zi||i instanceof Wi||i instanceof Gi?i.toString():JSON.stringify(i)}class as{constructor(n,s){this.type=n,this.value=s}static parse(n,s){if(n.length!==2)return s.error(`'literal' expression requires exactly one argument, but found ${n.length-1} instead.`);if(!fa(n[1]))return s.error("invalid value");const l=n[1];let p=Or(l);const v=s.expectedType;return p.kind!=="array"||p.N!==0||!v||v.kind!=="array"||typeof v.N=="number"&&v.N!==0||(p=v),new as(p,l)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}class Er{constructor(n){this.name="ExpressionEvaluationError",this.message=n}toJSON(){return this.message}}const nl={string:Ht,number:rt,boolean:Ut,object:qi};class Ls{constructor(n,s){this.type=n,this.args=s}static parse(n,s){if(n.length<2)return s.error("Expected at least one argument.");let l,p=1;const v=n[0];if(v==="array"){let S,C;if(n.length>2){const P=n[1];if(typeof P!="string"||!(P in nl)||P==="object")return s.error('The item type argument of "array" must be one of string, number, boolean',1);S=nl[P],p++}else S=Xt;if(n.length>3){if(n[2]!==null&&(typeof n[2]!="number"||n[2]<0||n[2]!==Math.floor(n[2])))return s.error('The length argument to "array" must be a positive integer literal',2);C=n[2],p++}l=N(S,C)}else{if(!nl[v])throw new Error(`Types doesn't contain name = ${v}`);l=nl[v]}const x=[];for(;p<n.length;p++){const S=s.parse(n[p],p,Xt);if(!S)return null;x.push(S)}return new Ls(l,x)}evaluate(n){for(let s=0;s<this.args.length;s++){const l=this.args[s].evaluate(n);if(!re(this.type,Or(l)))return l;if(s===this.args.length-1)throw new Er(`Expected value to be of type ${B(this.type)}, but found ${B(Or(l))} instead.`)}throw new Error}eachChild(n){this.args.forEach(n)}outputDefined(){return this.args.every(n=>n.outputDefined())}}const Bu={"to-boolean":Ut,"to-color":hi,"to-number":rt,"to-string":Ht};class Di{constructor(n,s){this.type=n,this.args=s}static parse(n,s){if(n.length<2)return s.error("Expected at least one argument.");const l=n[0];if(!Bu[l])throw new Error(`Can't parse ${l} as it is not part of the known types`);if((l==="to-boolean"||l==="to-string")&&n.length!==2)return s.error("Expected one argument.");const p=Bu[l],v=[];for(let x=1;x<n.length;x++){const S=s.parse(n[x],x,Xt);if(!S)return null;v.push(S)}return new Di(p,v)}evaluate(n){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(n);case"color":{let s,l;for(const p of this.args){if(s=p.evaluate(n),l=null,s instanceof Ln)return s;if(typeof s=="string"){const v=n.parseColor(s);if(v)return v}else if(Array.isArray(s)&&(l=s.length<3||s.length>4?`Invalid rbga value ${JSON.stringify(s)}: expected an array containing either three or four numeric values.`:el(s[0],s[1],s[2],s[3]),!l))return new Ln(s[0]/255,s[1]/255,s[2]/255,s[3])}throw new Er(l||`Could not parse color from value '${typeof s=="string"?s:JSON.stringify(s)}'`)}case"padding":{let s;for(const l of this.args){s=l.evaluate(n);const p=zi.parse(s);if(p)return p}throw new Er(`Could not parse padding from value '${typeof s=="string"?s:JSON.stringify(s)}'`)}case"variableAnchorOffsetCollection":{let s;for(const l of this.args){s=l.evaluate(n);const p=Wi.parse(s);if(p)return p}throw new Er(`Could not parse variableAnchorOffsetCollection from value '${typeof s=="string"?s:JSON.stringify(s)}'`)}case"number":{let s=null;for(const l of this.args){if(s=l.evaluate(n),s===null)return 0;const p=Number(s);if(!isNaN(p))return p}throw new Er(`Could not convert ${JSON.stringify(s)} to number.`)}case"formatted":return Zi.fromString(tl(this.args[0].evaluate(n)));case"resolvedImage":return Gi.fromString(tl(this.args[0].evaluate(n)));default:return tl(this.args[0].evaluate(n))}}eachChild(n){this.args.forEach(n)}outputDefined(){return this.args.every(n=>n.outputDefined())}}const pd=["Unknown","Point","LineString","Polygon"];class Nu{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?pd[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(n){let s=this._parseColorCache[n];return s||(s=this._parseColorCache[n]=Ln.parse(n)),s}}class Bo{constructor(n,s,l=[],p,v=new jr,x=[]){this.registry=n,this.path=l,this.key=l.map(S=>`[${S}]`).join(""),this.scope=v,this.errors=x,this.expectedType=p,this._isConstant=s}parse(n,s,l,p,v={}){return s?this.concat(s,l,p)._parse(n,v):this._parse(n,v)}_parse(n,s){function l(p,v,x){return x==="assert"?new Ls(v,[p]):x==="coerce"?new Di(v,[p]):p}if(n!==null&&typeof n!="string"&&typeof n!="boolean"&&typeof n!="number"||(n=["literal",n]),Array.isArray(n)){if(n.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const p=n[0];if(typeof p!="string")return this.error(`Expression name must be a string, but found ${typeof p} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const v=this.registry[p];if(v){let x=v.parse(n,this);if(!x)return null;if(this.expectedType){const S=this.expectedType,C=x.type;if(S.kind!=="string"&&S.kind!=="number"&&S.kind!=="boolean"&&S.kind!=="object"&&S.kind!=="array"||C.kind!=="value")if(S.kind!=="color"&&S.kind!=="formatted"&&S.kind!=="resolvedImage"||C.kind!=="value"&&C.kind!=="string")if(S.kind!=="padding"||C.kind!=="value"&&C.kind!=="number"&&C.kind!=="array")if(S.kind!=="variableAnchorOffsetCollection"||C.kind!=="value"&&C.kind!=="array"){if(this.checkSubtype(S,C))return null}else x=l(x,S,s.typeAnnotation||"coerce");else x=l(x,S,s.typeAnnotation||"coerce");else x=l(x,S,s.typeAnnotation||"coerce");else x=l(x,S,s.typeAnnotation||"assert")}if(!(x instanceof as)&&x.type.kind!=="resolvedImage"&&this._isConstant(x)){const S=new Nu;try{x=new as(x.type,x.evaluate(S))}catch(C){return this.error(C.message),null}}return x}return this.error(`Unknown expression "${p}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(n===void 0?"'undefined' value invalid. Use null instead.":typeof n=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof n} instead.`)}concat(n,s,l){const p=typeof n=="number"?this.path.concat(n):this.path,v=l?this.scope.concat(l):this.scope;return new Bo(this.registry,this._isConstant,p,s||null,v,this.errors)}error(n,...s){const l=`${this.key}${s.map(p=>`[${p}]`).join("")}`;this.errors.push(new Rr(l,n))}checkSubtype(n,s){const l=re(n,s);return l&&this.error(l),l}}class ho{constructor(n,s){this.type=s.type,this.bindings=[].concat(n),this.result=s}evaluate(n){return this.result.evaluate(n)}eachChild(n){for(const s of this.bindings)n(s[1]);n(this.result)}static parse(n,s){if(n.length<4)return s.error(`Expected at least 3 arguments, but found ${n.length-1} instead.`);const l=[];for(let v=1;v<n.length-1;v+=2){const x=n[v];if(typeof x!="string")return s.error(`Expected string, but found ${typeof x} instead.`,v);if(/[^a-zA-Z0-9_]/.test(x))return s.error("Variable names must contain only alphanumeric characters or '_'.",v);const S=s.parse(n[v+1],v+1);if(!S)return null;l.push([x,S])}const p=s.parse(n[n.length-1],n.length-1,s.expectedType,l);return p?new ho(l,p):null}outputDefined(){return this.result.outputDefined()}}class Pn{constructor(n,s){this.type=s.type,this.name=n,this.boundExpression=s}static parse(n,s){if(n.length!==2||typeof n[1]!="string")return s.error("'var' expression requires exactly one string literal argument.");const l=n[1];return s.scope.has(l)?new Pn(l,s.scope.get(l)):s.error(`Unknown variable "${l}". Make sure "${l}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(n){return this.boundExpression.evaluate(n)}eachChild(){}outputDefined(){return!1}}class Xc{constructor(n,s,l){this.type=n,this.index=s,this.input=l}static parse(n,s){if(n.length!==3)return s.error(`Expected 2 arguments, but found ${n.length-1} instead.`);const l=s.parse(n[1],1,rt),p=s.parse(n[2],2,N(s.expectedType||Xt));return l&&p?new Xc(p.type.itemType,l,p):null}evaluate(n){const s=this.index.evaluate(n),l=this.input.evaluate(n);if(s<0)throw new Er(`Array index out of bounds: ${s} < 0.`);if(s>=l.length)throw new Er(`Array index out of bounds: ${s} > ${l.length-1}.`);if(s!==Math.floor(s))throw new Er(`Array index must be an integer, but found ${s} instead.`);return l[s]}eachChild(n){n(this.index),n(this.input)}outputDefined(){return!1}}class Uu{constructor(n,s){this.type=Ut,this.needle=n,this.haystack=s}static parse(n,s){if(n.length!==3)return s.error(`Expected 2 arguments, but found ${n.length-1} instead.`);const l=s.parse(n[1],1,Xt),p=s.parse(n[2],2,Xt);return l&&p?ye(l.type,[Ut,Ht,rt,Pr,Xt])?new Uu(l,p):s.error(`Expected first argument to be of type boolean, string, number or null, but found ${B(l.type)} instead`):null}evaluate(n){const s=this.needle.evaluate(n),l=this.haystack.evaluate(n);if(!l)return!1;if(!Se(s,["boolean","string","number","null"]))throw new Er(`Expected first argument to be of type boolean, string, number or null, but found ${B(Or(s))} instead.`);if(!Se(l,["string","array"]))throw new Er(`Expected second argument to be of type array or string, but found ${B(Or(l))} instead.`);return l.indexOf(s)>=0}eachChild(n){n(this.needle),n(this.haystack)}outputDefined(){return!0}}class No{constructor(n,s,l){this.type=rt,this.needle=n,this.haystack=s,this.fromIndex=l}static parse(n,s){if(n.length<=2||n.length>=5)return s.error(`Expected 3 or 4 arguments, but found ${n.length-1} instead.`);const l=s.parse(n[1],1,Xt),p=s.parse(n[2],2,Xt);if(!l||!p)return null;if(!ye(l.type,[Ut,Ht,rt,Pr,Xt]))return s.error(`Expected first argument to be of type boolean, string, number or null, but found ${B(l.type)} instead`);if(n.length===4){const v=s.parse(n[3],3,rt);return v?new No(l,p,v):null}return new No(l,p)}evaluate(n){const s=this.needle.evaluate(n),l=this.haystack.evaluate(n);if(!Se(s,["boolean","string","number","null"]))throw new Er(`Expected first argument to be of type boolean, string, number or null, but found ${B(Or(s))} instead.`);let p;if(this.fromIndex&&(p=this.fromIndex.evaluate(n)),Se(l,["string"])){const v=l.indexOf(s,p);return v===-1?-1:[...l.slice(0,v)].length}if(Se(l,["array"]))return l.indexOf(s,p);throw new Er(`Expected second argument to be of type array or string, but found ${B(Or(l))} instead.`)}eachChild(n){n(this.needle),n(this.haystack),this.fromIndex&&n(this.fromIndex)}outputDefined(){return!1}}class $l{constructor(n,s,l,p,v,x){this.inputType=n,this.type=s,this.input=l,this.cases=p,this.outputs=v,this.otherwise=x}static parse(n,s){if(n.length<5)return s.error(`Expected at least 4 arguments, but found only ${n.length-1}.`);if(n.length%2!=1)return s.error("Expected an even number of arguments.");let l,p;s.expectedType&&s.expectedType.kind!=="value"&&(p=s.expectedType);const v={},x=[];for(let P=2;P<n.length-1;P+=2){let M=n[P];const L=n[P+1];Array.isArray(M)||(M=[M]);const F=s.concat(P);if(M.length===0)return F.error("Expected at least one branch label.");for(const W of M){if(typeof W!="number"&&typeof W!="string")return F.error("Branch labels must be numbers or strings.");if(typeof W=="number"&&Math.abs(W)>Number.MAX_SAFE_INTEGER)return F.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof W=="number"&&Math.floor(W)!==W)return F.error("Numeric branch labels must be integer values.");if(l){if(F.checkSubtype(l,Or(W)))return null}else l=Or(W);if(v[String(W)]!==void 0)return F.error("Branch labels must be unique.");v[String(W)]=x.length}const U=s.parse(L,P,p);if(!U)return null;p=p||U.type,x.push(U)}const S=s.parse(n[1],1,Xt);if(!S)return null;const C=s.parse(n[n.length-1],n.length-1,p);return C?S.type.kind!=="value"&&s.concat(1).checkSubtype(l,S.type)?null:new $l(l,p,S,v,x,C):null}evaluate(n){const s=this.input.evaluate(n);return(Or(s)===this.inputType&&this.outputs[this.cases[s]]||this.otherwise).evaluate(n)}eachChild(n){n(this.input),this.outputs.forEach(n),n(this.otherwise)}outputDefined(){return this.outputs.every(n=>n.outputDefined())&&this.otherwise.outputDefined()}}class fo{constructor(n,s,l){this.type=n,this.branches=s,this.otherwise=l}static parse(n,s){if(n.length<4)return s.error(`Expected at least 3 arguments, but found only ${n.length-1}.`);if(n.length%2!=0)return s.error("Expected an odd number of arguments.");let l;s.expectedType&&s.expectedType.kind!=="value"&&(l=s.expectedType);const p=[];for(let x=1;x<n.length-1;x+=2){const S=s.parse(n[x],x,Ut);if(!S)return null;const C=s.parse(n[x+1],x+1,l);if(!C)return null;p.push([S,C]),l=l||C.type}const v=s.parse(n[n.length-1],n.length-1,l);if(!v)return null;if(!l)throw new Error("Can't infer output type");return new fo(l,p,v)}evaluate(n){for(const[s,l]of this.branches)if(s.evaluate(n))return l.evaluate(n);return this.otherwise.evaluate(n)}eachChild(n){for(const[s,l]of this.branches)n(s),n(l);n(this.otherwise)}outputDefined(){return this.branches.every(([n,s])=>s.outputDefined())&&this.otherwise.outputDefined()}}class rl{constructor(n,s,l,p){this.type=n,this.input=s,this.beginIndex=l,this.endIndex=p}static parse(n,s){if(n.length<=2||n.length>=5)return s.error(`Expected 3 or 4 arguments, but found ${n.length-1} instead.`);const l=s.parse(n[1],1,Xt),p=s.parse(n[2],2,rt);if(!l||!p)return null;if(!ye(l.type,[N(Xt),Ht,Xt]))return s.error(`Expected first argument to be of type array or string, but found ${B(l.type)} instead`);if(n.length===4){const v=s.parse(n[3],3,rt);return v?new rl(l.type,l,p,v):null}return new rl(l.type,l,p)}evaluate(n){const s=this.input.evaluate(n),l=this.beginIndex.evaluate(n);let p;if(this.endIndex&&(p=this.endIndex.evaluate(n)),Se(s,["string"]))return[...s].slice(l,p).join("");if(Se(s,["array"]))return s.slice(l,p);throw new Er(`Expected first argument to be of type array or string, but found ${B(Or(s))} instead.`)}eachChild(n){n(this.input),n(this.beginIndex),this.endIndex&&n(this.endIndex)}outputDefined(){return!1}}function Vl(i,n){const s=i.length-1;let l,p,v=0,x=s,S=0;for(;v<=x;)if(S=Math.floor((v+x)/2),l=i[S],p=i[S+1],l<=n){if(S===s||n<p)return S;v=S+1}else{if(!(l>n))throw new Er("Input is not a number.");x=S-1}return 0}class il{constructor(n,s,l){this.type=n,this.input=s,this.labels=[],this.outputs=[];for(const[p,v]of l)this.labels.push(p),this.outputs.push(v)}static parse(n,s){if(n.length-1<4)return s.error(`Expected at least 4 arguments, but found only ${n.length-1}.`);if((n.length-1)%2!=0)return s.error("Expected an even number of arguments.");const l=s.parse(n[1],1,rt);if(!l)return null;const p=[];let v=null;s.expectedType&&s.expectedType.kind!=="value"&&(v=s.expectedType);for(let x=1;x<n.length;x+=2){const S=x===1?-1/0:n[x],C=n[x+1],P=x,M=x+1;if(typeof S!="number")return s.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',P);if(p.length&&p[p.length-1][0]>=S)return s.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',P);const L=s.parse(C,M,v);if(!L)return null;v=v||L.type,p.push([S,L])}return new il(v,l,p)}evaluate(n){const s=this.labels,l=this.outputs;if(s.length===1)return l[0].evaluate(n);const p=this.input.evaluate(n);if(p<=s[0])return l[0].evaluate(n);const v=s.length;return p>=s[v-1]?l[v-1].evaluate(n):l[Vl(s,p)].evaluate(n)}eachChild(n){n(this.input);for(const s of this.outputs)n(s)}outputDefined(){return this.outputs.every(n=>n.outputDefined())}}function Kc(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var md=Yc;function Yc(i,n,s,l){this.cx=3*i,this.bx=3*(s-i)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*n,this.by=3*(l-n)-this.cy,this.ay=1-this.cy-this.by,this.p1x=i,this.p1y=n,this.p2x=s,this.p2y=l}Yc.prototype={sampleCurveX:function(i){return((this.ax*i+this.bx)*i+this.cx)*i},sampleCurveY:function(i){return((this.ay*i+this.by)*i+this.cy)*i},sampleCurveDerivativeX:function(i){return(3*this.ax*i+2*this.bx)*i+this.cx},solveCurveX:function(i,n){if(n===void 0&&(n=1e-6),i<0)return 0;if(i>1)return 1;for(var s=i,l=0;l<8;l++){var p=this.sampleCurveX(s)-i;if(Math.abs(p)<n)return s;var v=this.sampleCurveDerivativeX(s);if(Math.abs(v)<1e-6)break;s-=p/v}var x=0,S=1;for(s=i,l=0;l<20&&(p=this.sampleCurveX(s),!(Math.abs(p-i)<n));l++)i>p?x=s:S=s,s=.5*(S-x)+x;return s},solve:function(i,n){return this.sampleCurveY(this.solveCurveX(i,n))}};var gd=Kc(md);function pa(i,n,s){return i+s*(n-i)}function ql(i,n,s){return i.map((l,p)=>pa(l,n[p],s))}const Li={number:pa,color:function(i,n,s,l="rgb"){switch(l){case"rgb":{const[p,v,x,S]=ql(i.rgb,n.rgb,s);return new Ln(p,v,x,S,!1)}case"hcl":{const[p,v,x,S]=i.hcl,[C,P,M,L]=n.hcl;let F,U;if(isNaN(p)||isNaN(C))isNaN(p)?isNaN(C)?F=NaN:(F=C,x!==1&&x!==0||(U=P)):(F=p,M!==1&&M!==0||(U=v));else{let Pe=C-p;C>p&&Pe>180?Pe-=360:C<p&&p-C>180&&(Pe+=360),F=p+s*Pe}const[W,Z,ne,oe]=function([Pe,ge,_e,Re]){return Pe=isNaN(Pe)?0:Pe*Lt,xr([_e,Math.cos(Pe)*ge,Math.sin(Pe)*ge,Re])}([F,U??pa(v,P,s),pa(x,M,s),pa(S,L,s)]);return new Ln(W,Z,ne,oe,!1)}case"lab":{const[p,v,x,S]=xr(ql(i.lab,n.lab,s));return new Ln(p,v,x,S,!1)}}},array:ql,padding:function(i,n,s){return new zi(ql(i.values,n.values,s))},variableAnchorOffsetCollection:function(i,n,s){const l=i.values,p=n.values;if(l.length!==p.length)throw new Er(`Cannot interpolate values of different length. from: ${i.toString()}, to: ${n.toString()}`);const v=[];for(let x=0;x<l.length;x+=2){if(l[x]!==p[x])throw new Er(`Cannot interpolate values containing mismatched anchors. from[${x}]: ${l[x]}, to[${x}]: ${p[x]}`);v.push(l[x]);const[S,C]=l[x+1],[P,M]=p[x+1];v.push([pa(S,P,s),pa(C,M,s)])}return new Wi(v)}};class Ti{constructor(n,s,l,p,v){this.type=n,this.operator=s,this.interpolation=l,this.input=p,this.labels=[],this.outputs=[];for(const[x,S]of v)this.labels.push(x),this.outputs.push(S)}static interpolationFactor(n,s,l,p){let v=0;if(n.name==="exponential")v=ju(s,n.base,l,p);else if(n.name==="linear")v=ju(s,1,l,p);else if(n.name==="cubic-bezier"){const x=n.controlPoints;v=new gd(x[0],x[1],x[2],x[3]).solve(ju(s,1,l,p))}return v}static parse(n,s){let[l,p,v,...x]=n;if(!Array.isArray(p)||p.length===0)return s.error("Expected an interpolation type expression.",1);if(p[0]==="linear")p={name:"linear"};else if(p[0]==="exponential"){const P=p[1];if(typeof P!="number")return s.error("Exponential interpolation requires a numeric base.",1,1);p={name:"exponential",base:P}}else{if(p[0]!=="cubic-bezier")return s.error(`Unknown interpolation type ${String(p[0])}`,1,0);{const P=p.slice(1);if(P.length!==4||P.some(M=>typeof M!="number"||M<0||M>1))return s.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);p={name:"cubic-bezier",controlPoints:P}}}if(n.length-1<4)return s.error(`Expected at least 4 arguments, but found only ${n.length-1}.`);if((n.length-1)%2!=0)return s.error("Expected an even number of arguments.");if(v=s.parse(v,2,rt),!v)return null;const S=[];let C=null;l==="interpolate-hcl"||l==="interpolate-lab"?C=hi:s.expectedType&&s.expectedType.kind!=="value"&&(C=s.expectedType);for(let P=0;P<x.length;P+=2){const M=x[P],L=x[P+1],F=P+3,U=P+4;if(typeof M!="number")return s.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',F);if(S.length&&S[S.length-1][0]>=M)return s.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',F);const W=s.parse(L,U,C);if(!W)return null;C=C||W.type,S.push([M,W])}return ke(C,rt)||ke(C,hi)||ke(C,co)||ke(C,ae)||ke(C,N(rt))?new Ti(C,l,p,v,S):s.error(`Type ${B(C)} is not interpolatable.`)}evaluate(n){const s=this.labels,l=this.outputs;if(s.length===1)return l[0].evaluate(n);const p=this.input.evaluate(n);if(p<=s[0])return l[0].evaluate(n);const v=s.length;if(p>=s[v-1])return l[v-1].evaluate(n);const x=Vl(s,p),S=Ti.interpolationFactor(this.interpolation,p,s[x],s[x+1]),C=l[x].evaluate(n),P=l[x+1].evaluate(n);switch(this.operator){case"interpolate":return Li[this.type.kind](C,P,S);case"interpolate-hcl":return Li.color(C,P,S,"hcl");case"interpolate-lab":return Li.color(C,P,S,"lab")}}eachChild(n){n(this.input);for(const s of this.outputs)n(s)}outputDefined(){return this.outputs.every(n=>n.outputDefined())}}function ju(i,n,s,l){const p=l-s,v=i-s;return p===0?0:n===1?v/p:(Math.pow(n,v)-1)/(Math.pow(n,p)-1)}class $u{constructor(n,s){this.type=n,this.args=s}static parse(n,s){if(n.length<2)return s.error("Expectected at least one argument.");let l=null;const p=s.expectedType;p&&p.kind!=="value"&&(l=p);const v=[];for(const S of n.slice(1)){const C=s.parse(S,1+v.length,l,void 0,{typeAnnotation:"omit"});if(!C)return null;l=l||C.type,v.push(C)}if(!l)throw new Error("No output type");const x=p&&v.some(S=>re(p,S.type));return new $u(x?Xt:l,v)}evaluate(n){let s,l=null,p=0;for(const v of this.args)if(p++,l=v.evaluate(n),l&&l instanceof Gi&&!l.available&&(s||(s=l.name),l=null,p===this.args.length&&(l=s)),l!==null)break;return l}eachChild(n){this.args.forEach(n)}outputDefined(){return this.args.every(n=>n.outputDefined())}}function Vu(i,n){return i==="=="||i==="!="?n.kind==="boolean"||n.kind==="string"||n.kind==="number"||n.kind==="null"||n.kind==="value":n.kind==="string"||n.kind==="number"||n.kind==="value"}function _d(i,n,s,l){return l.compare(n,s)===0}function Uo(i,n,s){const l=i!=="=="&&i!=="!=";return class m5{constructor(v,x,S){this.type=Ut,this.lhs=v,this.rhs=x,this.collator=S,this.hasUntypedArgument=v.type.kind==="value"||x.type.kind==="value"}static parse(v,x){if(v.length!==3&&v.length!==4)return x.error("Expected two or three arguments.");const S=v[0];let C=x.parse(v[1],1,Xt);if(!C)return null;if(!Vu(S,C.type))return x.concat(1).error(`"${S}" comparisons are not supported for type '${B(C.type)}'.`);let P=x.parse(v[2],2,Xt);if(!P)return null;if(!Vu(S,P.type))return x.concat(2).error(`"${S}" comparisons are not supported for type '${B(P.type)}'.`);if(C.type.kind!==P.type.kind&&C.type.kind!=="value"&&P.type.kind!=="value")return x.error(`Cannot compare types '${B(C.type)}' and '${B(P.type)}'.`);l&&(C.type.kind==="value"&&P.type.kind!=="value"?C=new Ls(P.type,[C]):C.type.kind!=="value"&&P.type.kind==="value"&&(P=new Ls(C.type,[P])));let M=null;if(v.length===4){if(C.type.kind!=="string"&&P.type.kind!=="string"&&C.type.kind!=="value"&&P.type.kind!=="value")return x.error("Cannot use collator to compare non-string types.");if(M=x.parse(v[3],3,Ks),!M)return null}return new m5(C,P,M)}evaluate(v){const x=this.lhs.evaluate(v),S=this.rhs.evaluate(v);if(l&&this.hasUntypedArgument){const C=Or(x),P=Or(S);if(C.kind!==P.kind||C.kind!=="string"&&C.kind!=="number")throw new Er(`Expected arguments for "${i}" to be (string, string) or (number, number), but found (${C.kind}, ${P.kind}) instead.`)}if(this.collator&&!l&&this.hasUntypedArgument){const C=Or(x),P=Or(S);if(C.kind!=="string"||P.kind!=="string")return n(v,x,S)}return this.collator?s(v,x,S,this.collator.evaluate(v)):n(v,x,S)}eachChild(v){v(this.lhs),v(this.rhs),this.collator&&v(this.collator)}outputDefined(){return!0}}}const tp=Uo("==",function(i,n,s){return n===s},_d),yd=Uo("!=",function(i,n,s){return n!==s},function(i,n,s,l){return!_d(0,n,s,l)}),vd=Uo("<",function(i,n,s){return n<s},function(i,n,s,l){return l.compare(n,s)<0}),np=Uo(">",function(i,n,s){return n>s},function(i,n,s,l){return l.compare(n,s)>0}),rp=Uo("<=",function(i,n,s){return n<=s},function(i,n,s,l){return l.compare(n,s)<=0}),or=Uo(">=",function(i,n,s){return n>=s},function(i,n,s,l){return l.compare(n,s)>=0});class Gn{constructor(n,s,l){this.type=Ks,this.locale=l,this.caseSensitive=n,this.diacriticSensitive=s}static parse(n,s){if(n.length!==2)return s.error("Expected one argument.");const l=n[1];if(typeof l!="object"||Array.isArray(l))return s.error("Collator options argument must be an object.");const p=s.parse(l["case-sensitive"]!==void 0&&l["case-sensitive"],1,Ut);if(!p)return null;const v=s.parse(l["diacritic-sensitive"]!==void 0&&l["diacritic-sensitive"],1,Ut);if(!v)return null;let x=null;return l.locale&&(x=s.parse(l.locale,1,Ht),!x)?null:new Gn(p,v,x)}evaluate(n){return new Gc(this.caseSensitive.evaluate(n),this.diacriticSensitive.evaluate(n),this.locale?this.locale.evaluate(n):null)}eachChild(n){n(this.caseSensitive),n(this.diacriticSensitive),this.locale&&n(this.locale)}outputDefined(){return!1}}class Jc{constructor(n,s,l,p,v){this.type=Ht,this.number=n,this.locale=s,this.currency=l,this.minFractionDigits=p,this.maxFractionDigits=v}static parse(n,s){if(n.length!==3)return s.error("Expected two arguments.");const l=s.parse(n[1],1,rt);if(!l)return null;const p=n[2];if(typeof p!="object"||Array.isArray(p))return s.error("NumberFormat options argument must be an object.");let v=null;if(p.locale&&(v=s.parse(p.locale,1,Ht),!v))return null;let x=null;if(p.currency&&(x=s.parse(p.currency,1,Ht),!x))return null;let S=null;if(p["min-fraction-digits"]&&(S=s.parse(p["min-fraction-digits"],1,rt),!S))return null;let C=null;return p["max-fraction-digits"]&&(C=s.parse(p["max-fraction-digits"],1,rt),!C)?null:new Jc(l,v,x,S,C)}evaluate(n){return new Intl.NumberFormat(this.locale?this.locale.evaluate(n):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(n):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(n):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(n):void 0}).format(this.number.evaluate(n))}eachChild(n){n(this.number),this.locale&&n(this.locale),this.currency&&n(this.currency),this.minFractionDigits&&n(this.minFractionDigits),this.maxFractionDigits&&n(this.maxFractionDigits)}outputDefined(){return!1}}class qu{constructor(n){this.type=uo,this.sections=n}static parse(n,s){if(n.length<2)return s.error("Expected at least one argument.");const l=n[1];if(!Array.isArray(l)&&typeof l=="object")return s.error("First argument must be an image or text section.");const p=[];let v=!1;for(let x=1;x<=n.length-1;++x){const S=n[x];if(v&&typeof S=="object"&&!Array.isArray(S)){v=!1;let C=null;if(S["font-scale"]&&(C=s.parse(S["font-scale"],1,rt),!C))return null;let P=null;if(S["text-font"]&&(P=s.parse(S["text-font"],1,N(Ht)),!P))return null;let M=null;if(S["text-color"]&&(M=s.parse(S["text-color"],1,hi),!M))return null;const L=p[p.length-1];L.scale=C,L.font=P,L.textColor=M}else{const C=s.parse(n[x],1,Xt);if(!C)return null;const P=C.type.kind;if(P!=="string"&&P!=="value"&&P!=="null"&&P!=="resolvedImage")return s.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");v=!0,p.push({content:C,scale:null,font:null,textColor:null})}}return new qu(p)}evaluate(n){return new Zi(this.sections.map(s=>{const l=s.content.evaluate(n);return Or(l)===Ds?new Hc("",l,null,null,null):new Hc(tl(l),null,s.scale?s.scale.evaluate(n):null,s.font?s.font.evaluate(n).join(","):null,s.textColor?s.textColor.evaluate(n):null)}))}eachChild(n){for(const s of this.sections)n(s.content),s.scale&&n(s.scale),s.font&&n(s.font),s.textColor&&n(s.textColor)}outputDefined(){return!1}}class Qc{constructor(n){this.type=Ds,this.input=n}static parse(n,s){if(n.length!==2)return s.error("Expected two arguments.");const l=s.parse(n[1],1,Ht);return l?new Qc(l):s.error("No image name provided.")}evaluate(n){const s=this.input.evaluate(n),l=Gi.fromString(s);return l&&n.availableImages&&(l.available=n.availableImages.indexOf(s)>-1),l}eachChild(n){n(this.input)}outputDefined(){return!1}}class eh{constructor(n){this.type=rt,this.input=n}static parse(n,s){if(n.length!==2)return s.error(`Expected 1 argument, but found ${n.length-1} instead.`);const l=s.parse(n[1],1);return l?l.type.kind!=="array"&&l.type.kind!=="string"&&l.type.kind!=="value"?s.error(`Expected argument of type string or array, but found ${B(l.type)} instead.`):new eh(l):null}evaluate(n){const s=this.input.evaluate(n);if(typeof s=="string")return[...s].length;if(Array.isArray(s))return s.length;throw new Er(`Expected value to be of type string or array, but found ${B(Or(s))} instead.`)}eachChild(n){n(this.input)}outputDefined(){return!1}}const Ys=8192;function ip(i,n){const s=(180+i[0])/360,l=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+i[1]*Math.PI/360)))/360,p=Math.pow(2,n.z);return[Math.round(s*p*Ys),Math.round(l*p*Ys)]}function Zu(i,n){const s=Math.pow(2,n.z);return[(p=(i[0]/Ys+n.x)/s,360*p-180),(l=(i[1]/Ys+n.y)/s,360/Math.PI*Math.atan(Math.exp((180-360*l)*Math.PI/180))-90)];var l,p}function ma(i,n){i[0]=Math.min(i[0],n[0]),i[1]=Math.min(i[1],n[1]),i[2]=Math.max(i[2],n[0]),i[3]=Math.max(i[3],n[1])}function pr(i,n){return!(i[0]<=n[0]||i[2]>=n[2]||i[1]<=n[1]||i[3]>=n[3])}function Mn(i,n,s){const l=i[0]-n[0],p=i[1]-n[1],v=i[0]-s[0],x=i[1]-s[1];return l*x-v*p==0&&l*v<=0&&p*x<=0}function Js(i,n,s,l){return(p=[l[0]-s[0],l[1]-s[1]])[0]*(v=[n[0]-i[0],n[1]-i[1]])[1]-p[1]*v[0]!=0&&!(!nh(i,n,s,l)||!nh(s,l,i,n));var p,v}function xd(i,n,s){for(const l of s)for(let p=0;p<l.length-1;++p)if(Js(i,n,l[p],l[p+1]))return!0;return!1}function jo(i,n,s=!1){let l=!1;for(const S of n)for(let C=0;C<S.length-1;C++){if(Mn(i,S[C],S[C+1]))return s;(v=S[C])[1]>(p=i)[1]!=(x=S[C+1])[1]>p[1]&&p[0]<(x[0]-v[0])*(p[1]-v[1])/(x[1]-v[1])+v[0]&&(l=!l)}var p,v,x;return l}function ls(i,n){for(const s of n)if(jo(i,s))return!0;return!1}function th(i,n){for(const s of i)if(!jo(s,n))return!1;for(let s=0;s<i.length-1;++s)if(xd(i[s],i[s+1],n))return!1;return!0}function wd(i,n){for(const s of n)if(th(i,s))return!0;return!1}function nh(i,n,s,l){const p=l[0]-s[0],v=l[1]-s[1],x=(i[0]-s[0])*v-p*(i[1]-s[1]),S=(n[0]-s[0])*v-p*(n[1]-s[1]);return x>0&&S<0||x<0&&S>0}function Wu(i,n,s){const l=[];for(let p=0;p<i.length;p++){const v=[];for(let x=0;x<i[p].length;x++){const S=ip(i[p][x],s);ma(n,S),v.push(S)}l.push(v)}return l}function rh(i,n,s){const l=[];for(let p=0;p<i.length;p++){const v=Wu(i[p],n,s);l.push(v)}return l}function ih(i,n,s,l){if(i[0]<s[0]||i[0]>s[2]){const p=.5*l;let v=i[0]-s[0]>p?-l:s[0]-i[0]>p?l:0;v===0&&(v=i[0]-s[2]>p?-l:s[2]-i[0]>p?l:0),i[0]+=v}ma(n,i)}function Ri(i,n,s,l){const p=Math.pow(2,l.z)*Ys,v=[l.x*Ys,l.y*Ys],x=[];for(const S of i)for(const C of S){const P=[C.x+v[0],C.y+v[1]];ih(P,n,s,p),x.push(P)}return x}function bd(i,n,s,l){const p=Math.pow(2,l.z)*Ys,v=[l.x*Ys,l.y*Ys],x=[];for(const C of i){const P=[];for(const M of C){const L=[M.x+v[0],M.y+v[1]];ma(n,L),P.push(L)}x.push(P)}if(n[2]-n[0]<=p/2){(S=n)[0]=S[1]=1/0,S[2]=S[3]=-1/0;for(const C of x)for(const P of C)ih(P,n,s,p)}var S;return x}class Kr{constructor(n,s){this.type=Ut,this.geojson=n,this.geometries=s}static parse(n,s){if(n.length!==2)return s.error(`'within' expression requires exactly one argument, but found ${n.length-1} instead.`);if(fa(n[1])){const l=n[1];if(l.type==="FeatureCollection"){const p=[];for(const v of l.features){const{type:x,coordinates:S}=v.geometry;x==="Polygon"&&p.push(S),x==="MultiPolygon"&&p.push(...S)}if(p.length)return new Kr(l,{type:"MultiPolygon",coordinates:p})}else if(l.type==="Feature"){const p=l.geometry.type;if(p==="Polygon"||p==="MultiPolygon")return new Kr(l,l.geometry)}else if(l.type==="Polygon"||l.type==="MultiPolygon")return new Kr(l,l)}return s.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(n){if(n.geometry()!=null&&n.canonicalID()!=null){if(n.geometryType()==="Point")return function(s,l){const p=[1/0,1/0,-1/0,-1/0],v=[1/0,1/0,-1/0,-1/0],x=s.canonicalID();if(l.type==="Polygon"){const S=Wu(l.coordinates,v,x),C=Ri(s.geometry(),p,v,x);if(!pr(p,v))return!1;for(const P of C)if(!jo(P,S))return!1}if(l.type==="MultiPolygon"){const S=rh(l.coordinates,v,x),C=Ri(s.geometry(),p,v,x);if(!pr(p,v))return!1;for(const P of C)if(!ls(P,S))return!1}return!0}(n,this.geometries);if(n.geometryType()==="LineString")return function(s,l){const p=[1/0,1/0,-1/0,-1/0],v=[1/0,1/0,-1/0,-1/0],x=s.canonicalID();if(l.type==="Polygon"){const S=Wu(l.coordinates,v,x),C=bd(s.geometry(),p,v,x);if(!pr(p,v))return!1;for(const P of C)if(!th(P,S))return!1}if(l.type==="MultiPolygon"){const S=rh(l.coordinates,v,x),C=bd(s.geometry(),p,v,x);if(!pr(p,v))return!1;for(const P of C)if(!wd(P,S))return!1}return!0}(n,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}let Sd=class{constructor(i=[],n=(s,l)=>s<l?-1:s>l?1:0){if(this.data=i,this.length=this.data.length,this.compare=n,this.length>0)for(let s=(this.length>>1)-1;s>=0;s--)this._down(s)}push(i){this.data.push(i),this._up(this.length++)}pop(){if(this.length===0)return;const i=this.data[0],n=this.data.pop();return--this.length>0&&(this.data[0]=n,this._down(0)),i}peek(){return this.data[0]}_up(i){const{data:n,compare:s}=this,l=n[i];for(;i>0;){const p=i-1>>1,v=n[p];if(s(l,v)>=0)break;n[i]=v,i=p}n[i]=l}_down(i){const{data:n,compare:s}=this,l=this.length>>1,p=n[i];for(;i<l;){let v=1+(i<<1);const x=v+1;if(x<this.length&&s(n[x],n[v])<0&&(v=x),s(n[v],p)>=0)break;n[i]=n[v],i=v}n[i]=p}};function Td(i,n,s,l,p){po(i,n,s,l||i.length-1,p||sh)}function po(i,n,s,l,p){for(;l>s;){if(l-s>600){var v=l-s+1,x=n-s+1,S=Math.log(v),C=.5*Math.exp(2*S/3),P=.5*Math.sqrt(S*C*(v-C)/v)*(x-v/2<0?-1:1);po(i,n,Math.max(s,Math.floor(n-x*C/v+P)),Math.min(l,Math.floor(n+(v-x)*C/v+P)),p)}var M=i[n],L=s,F=l;for($o(i,s,n),p(i[l],M)>0&&$o(i,s,l);L<F;){for($o(i,L,F),L++,F--;p(i[L],M)<0;)L++;for(;p(i[F],M)>0;)F--}p(i[s],M)===0?$o(i,s,F):$o(i,++F,l),F<=n&&(s=F+1),n<=F&&(l=F-1)}}function $o(i,n,s){var l=i[n];i[n]=i[s],i[s]=l}function sh(i,n){return i<n?-1:i>n?1:0}function ir(i,n){if(i.length<=1)return[i];const s=[];let l,p;for(const v of i){const x=oh(v);x!==0&&(v.area=Math.abs(x),p===void 0&&(p=x<0),p===x<0?(l&&s.push(l),l=[v]):l.push(v))}if(l&&s.push(l),n>1)for(let v=0;v<s.length;v++)s[v].length<=n||(Td(s[v],n,1,s[v].length-1,Vo),s[v]=s[v].slice(0,n));return s}function Vo(i,n){return n.area-i.area}function oh(i){let n=0;for(let s,l,p=0,v=i.length,x=v-1;p<v;x=p++)s=i[p],l=i[x],n+=(l.x-s.x)*(s.y+l.y);return n}const Ed=1/298.257223563,Gu=Ed*(2-Ed),Cd=Math.PI/180;class ah{constructor(n){const s=6378.137*Cd*1e3,l=Math.cos(n*Cd),p=1/(1-Gu*(1-l*l)),v=Math.sqrt(p);this.kx=s*v*l,this.ky=s*v*p*(1-Gu)}distance(n,s){const l=this.wrap(n[0]-s[0])*this.kx,p=(n[1]-s[1])*this.ky;return Math.sqrt(l*l+p*p)}pointOnLine(n,s){let l,p,v,x,S=1/0;for(let C=0;C<n.length-1;C++){let P=n[C][0],M=n[C][1],L=this.wrap(n[C+1][0]-P)*this.kx,F=(n[C+1][1]-M)*this.ky,U=0;L===0&&F===0||(U=(this.wrap(s[0]-P)*this.kx*L+(s[1]-M)*this.ky*F)/(L*L+F*F),U>1?(P=n[C+1][0],M=n[C+1][1]):U>0&&(P+=L/this.kx*U,M+=F/this.ky*U)),L=this.wrap(s[0]-P)*this.kx,F=(s[1]-M)*this.ky;const W=L*L+F*F;W<S&&(S=W,l=P,p=M,v=C,x=U)}return{point:[l,p],index:v,t:Math.max(0,Math.min(1,x))}}wrap(n){for(;n<-180;)n+=360;for(;n>180;)n-=360;return n}}function Id(i,n){return n[0]-i[0]}function Zl(i){return i[1]-i[0]+1}function us(i,n){return i[1]>=i[0]&&i[1]<n}function qo(i,n){if(i[0]>i[1])return[null,null];const s=Zl(i);if(n){if(s===2)return[i,null];const p=Math.floor(s/2);return[[i[0],i[0]+p],[i[0]+p,i[1]]]}if(s===1)return[i,null];const l=Math.floor(s/2)-1;return[[i[0],i[0]+l],[i[0]+l+1,i[1]]]}function lh(i,n){if(!us(n,i.length))return[1/0,1/0,-1/0,-1/0];const s=[1/0,1/0,-1/0,-1/0];for(let l=n[0];l<=n[1];++l)ma(s,i[l]);return s}function Hu(i){const n=[1/0,1/0,-1/0,-1/0];for(const s of i)for(const l of s)ma(n,l);return n}function Wl(i){return i[0]!==-1/0&&i[1]!==-1/0&&i[2]!==1/0&&i[3]!==1/0}function Gl(i,n,s){if(!Wl(i)||!Wl(n))return NaN;let l=0,p=0;return i[2]<n[0]&&(l=n[0]-i[2]),i[0]>n[2]&&(l=i[0]-n[2]),i[1]>n[3]&&(p=i[1]-n[3]),i[3]<n[1]&&(p=n[1]-i[3]),s.distance([0,0],[l,p])}function mo(i,n,s){const l=s.pointOnLine(n,i);return s.distance(i,l.point)}function Xu(i,n,s,l,p){const v=Math.min(mo(i,[s,l],p),mo(n,[s,l],p)),x=Math.min(mo(s,[i,n],p),mo(l,[i,n],p));return Math.min(v,x)}function sp(i,n,s,l,p){if(!us(n,i.length)||!us(l,s.length))return 1/0;let v=1/0;for(let x=n[0];x<n[1];++x){const S=i[x],C=i[x+1];for(let P=l[0];P<l[1];++P){const M=s[P],L=s[P+1];if(Js(S,C,M,L))return 0;v=Math.min(v,Xu(S,C,M,L,p))}}return v}function mr(i,n,s,l,p){if(!us(n,i.length)||!us(l,s.length))return NaN;let v=1/0;for(let x=n[0];x<=n[1];++x)for(let S=l[0];S<=l[1];++S)if(v=Math.min(v,p.distance(i[x],s[S])),v===0)return v;return v}function uh(i,n,s){if(jo(i,n,!0))return 0;let l=1/0;for(const p of n){const v=p[0],x=p[p.length-1];if(v!==x&&(l=Math.min(l,mo(i,[x,v],s)),l===0))return l;const S=s.pointOnLine(p,i);if(l=Math.min(l,s.distance(i,S.point)),l===0)return l}return l}function an(i,n,s,l){if(!us(n,i.length))return NaN;for(let v=n[0];v<=n[1];++v)if(jo(i[v],s,!0))return 0;let p=1/0;for(let v=n[0];v<n[1];++v){const x=i[v],S=i[v+1];for(const C of s)for(let P=0,M=C.length,L=M-1;P<M;L=P++){const F=C[L],U=C[P];if(Js(x,S,F,U))return 0;p=Math.min(p,Xu(x,S,F,U,l))}}return p}function Hl(i,n){for(const s of i)for(const l of s)if(jo(l,n,!0))return!0;return!1}function pn(i,n,s,l=1/0){const p=Hu(i),v=Hu(n);if(l!==1/0&&Gl(p,v,s)>=l)return l;if(pr(p,v)){if(Hl(i,n))return 0}else if(Hl(n,i))return 0;let x=1/0;for(const S of i)for(let C=0,P=S.length,M=P-1;C<P;M=C++){const L=S[M],F=S[C];for(const U of n)for(let W=0,Z=U.length,ne=Z-1;W<Z;ne=W++){const oe=U[ne],Pe=U[W];if(Js(L,F,oe,Pe))return 0;x=Math.min(x,Xu(L,F,oe,Pe,s))}}return x}function Un(i,n,s,l,p,v){if(!v)return;const x=Gl(lh(l,v),p,s);x<n&&i.push([x,v,[0,0]])}function Rs(i,n,s,l,p,v,x){if(!v||!x)return;const S=Gl(lh(l,v),lh(p,x),s);S<n&&i.push([S,v,x])}function sl(i,n,s,l,p=1/0){let v=Math.min(l.distance(i[0],s[0][0]),p);if(v===0)return v;const x=new Sd([[0,[0,i.length-1],[0,0]]],Id),S=Hu(s);for(;x.length>0;){const C=x.pop();if(C[0]>=v)continue;const P=C[1],M=n?50:100;if(Zl(P)<=M){if(!us(P,i.length))return NaN;if(n){const L=an(i,P,s,l);if(isNaN(L)||L===0)return L;v=Math.min(v,L)}else for(let L=P[0];L<=P[1];++L){const F=uh(i[L],s,l);if(v=Math.min(v,F),v===0)return 0}}else{const L=qo(P,n);Un(x,v,l,i,S,L[0]),Un(x,v,l,i,S,L[1])}}return v}function ol(i,n,s,l,p,v=1/0){let x=Math.min(v,p.distance(i[0],s[0]));if(x===0)return x;const S=new Sd([[0,[0,i.length-1],[0,s.length-1]]],Id);for(;S.length>0;){const C=S.pop();if(C[0]>=x)continue;const P=C[1],M=C[2],L=n?50:100,F=l?50:100;if(Zl(P)<=L&&Zl(M)<=F){if(!us(P,i.length)&&us(M,s.length))return NaN;let U;if(n&&l)U=sp(i,P,s,M,p),x=Math.min(x,U);else if(n&&!l){const W=i.slice(P[0],P[1]+1);for(let Z=M[0];Z<=M[1];++Z)if(U=mo(s[Z],W,p),x=Math.min(x,U),x===0)return x}else if(!n&&l){const W=s.slice(M[0],M[1]+1);for(let Z=P[0];Z<=P[1];++Z)if(U=mo(i[Z],W,p),x=Math.min(x,U),x===0)return x}else U=mr(i,P,s,M,p),x=Math.min(x,U)}else{const U=qo(P,n),W=qo(M,l);Rs(S,x,p,i,s,U[0],W[0]),Rs(S,x,p,i,s,U[0],W[1]),Rs(S,x,p,i,s,U[1],W[0]),Rs(S,x,p,i,s,U[1],W[1])}}return x}function ch(i){return i.type==="MultiPolygon"?i.coordinates.map(n=>({type:"Polygon",coordinates:n})):i.type==="MultiLineString"?i.coordinates.map(n=>({type:"LineString",coordinates:n})):i.type==="MultiPoint"?i.coordinates.map(n=>({type:"Point",coordinates:n})):[i]}class ga{constructor(n,s){this.type=rt,this.geojson=n,this.geometries=s}static parse(n,s){if(n.length!==2)return s.error(`'distance' expression requires exactly one argument, but found ${n.length-1} instead.`);if(fa(n[1])){const l=n[1];if(l.type==="FeatureCollection")return new ga(l,l.features.map(p=>ch(p.geometry)).flat());if(l.type==="Feature")return new ga(l,ch(l.geometry));if("type"in l&&"coordinates"in l)return new ga(l,ch(l))}return s.error("'distance' expression requires valid geojson object that contains polygon geometry type.")}evaluate(n){if(n.geometry()!=null&&n.canonicalID()!=null){if(n.geometryType()==="Point")return function(s,l){const p=s.geometry(),v=p.flat().map(C=>Zu([C.x,C.y],s.canonical));if(p.length===0)return NaN;const x=new ah(v[0][1]);let S=1/0;for(const C of l){switch(C.type){case"Point":S=Math.min(S,ol(v,!1,[C.coordinates],!1,x,S));break;case"LineString":S=Math.min(S,ol(v,!1,C.coordinates,!0,x,S));break;case"Polygon":S=Math.min(S,sl(v,!1,C.coordinates,x,S))}if(S===0)return S}return S}(n,this.geometries);if(n.geometryType()==="LineString")return function(s,l){const p=s.geometry(),v=p.flat().map(C=>Zu([C.x,C.y],s.canonical));if(p.length===0)return NaN;const x=new ah(v[0][1]);let S=1/0;for(const C of l){switch(C.type){case"Point":S=Math.min(S,ol(v,!0,[C.coordinates],!1,x,S));break;case"LineString":S=Math.min(S,ol(v,!0,C.coordinates,!0,x,S));break;case"Polygon":S=Math.min(S,sl(v,!0,C.coordinates,x,S))}if(S===0)return S}return S}(n,this.geometries);if(n.geometryType()==="Polygon")return function(s,l){const p=s.geometry();if(p.length===0||p[0].length===0)return NaN;const v=ir(p,0).map(C=>C.map(P=>P.map(M=>Zu([M.x,M.y],s.canonical)))),x=new ah(v[0][0][0][1]);let S=1/0;for(const C of l)for(const P of v){switch(C.type){case"Point":S=Math.min(S,sl([C.coordinates],!1,P,x,S));break;case"LineString":S=Math.min(S,sl(C.coordinates,!0,P,x,S));break;case"Polygon":S=Math.min(S,pn(P,C.coordinates,x,S))}if(S===0)return S}return S}(n,this.geometries)}return NaN}eachChild(){}outputDefined(){return!0}}const al={"==":tp,"!=":yd,">":np,"<":vd,">=":or,"<=":rp,array:Ls,at:Xc,boolean:Ls,case:fo,coalesce:$u,collator:Gn,format:qu,image:Qc,in:Uu,"index-of":No,interpolate:Ti,"interpolate-hcl":Ti,"interpolate-lab":Ti,length:eh,let:ho,literal:as,match:$l,number:Ls,"number-format":Jc,object:Ls,slice:rl,step:il,string:Ls,"to-boolean":Di,"to-color":Di,"to-number":Di,"to-string":Di,var:Pn,within:Kr,distance:ga};class cs{constructor(n,s,l,p){this.name=n,this.type=s,this._evaluate=l,this.args=p}evaluate(n){return this._evaluate(n,this.args)}eachChild(n){this.args.forEach(n)}outputDefined(){return!1}static parse(n,s){const l=n[0],p=cs.definitions[l];if(!p)return s.error(`Unknown expression "${l}". If you wanted a literal array, use ["literal", [...]].`,0);const v=Array.isArray(p)?p[0]:p.type,x=Array.isArray(p)?[[p[1],p[2]]]:p.overloads,S=x.filter(([P])=>!Array.isArray(P)||P.length===n.length-1);let C=null;for(const[P,M]of S){C=new Bo(s.registry,ya,s.path,null,s.scope);const L=[];let F=!1;for(let U=1;U<n.length;U++){const W=n[U],Z=Array.isArray(P)?P[U-1]:P.type,ne=C.parse(W,1+L.length,Z);if(!ne){F=!0;break}L.push(ne)}if(!F)if(Array.isArray(P)&&P.length!==L.length)C.error(`Expected ${P.length} arguments, but found ${L.length} instead.`);else{for(let U=0;U<L.length;U++){const W=Array.isArray(P)?P[U]:P.type,Z=L[U];C.concat(U+1).checkSubtype(W,Z.type)}if(C.errors.length===0)return new cs(l,v,M,L)}}if(S.length===1)s.errors.push(...C.errors);else{const P=(S.length?S:x).map(([L])=>{return F=L,Array.isArray(F)?`(${F.map(B).join(", ")})`:`(${B(F.type)}...)`;var F}).join(" | "),M=[];for(let L=1;L<n.length;L++){const F=s.parse(n[L],1+M.length);if(!F)return null;M.push(B(F.type))}s.error(`Expected arguments of type ${P}, but found (${M.join(", ")}) instead.`)}return null}static register(n,s){cs.definitions=s;for(const l in s)n[l]=cs}}function hh(i,[n,s,l,p]){n=n.evaluate(i),s=s.evaluate(i),l=l.evaluate(i);const v=p?p.evaluate(i):1,x=el(n,s,l,v);if(x)throw new Er(x);return new Ln(n/255,s/255,l/255,v,!1)}function Zo(i,n){return i in n}function dh(i,n){const s=n[i];return s===void 0?null:s}function _a(i){return{type:i}}function ya(i){if(i instanceof Pn)return ya(i.boundExpression);if(i instanceof cs&&i.name==="error"||i instanceof Gn||i instanceof Kr||i instanceof ga)return!1;const n=i instanceof Di||i instanceof Ls;let s=!0;return i.eachChild(l=>{s=n?s&&ya(l):s&&l instanceof as}),!!s&&ll(i)&&Wo(i,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}function ll(i){if(i instanceof cs&&(i.name==="get"&&i.args.length===1||i.name==="feature-state"||i.name==="has"&&i.args.length===1||i.name==="properties"||i.name==="geometry-type"||i.name==="id"||/^filter-/.test(i.name))||i instanceof Kr||i instanceof ga)return!1;let n=!0;return i.eachChild(s=>{n&&!ll(s)&&(n=!1)}),n}function Hi(i){if(i instanceof cs&&i.name==="feature-state")return!1;let n=!0;return i.eachChild(s=>{n&&!Hi(s)&&(n=!1)}),n}function Wo(i,n){if(i instanceof cs&&n.indexOf(i.name)>=0)return!1;let s=!0;return i.eachChild(l=>{s&&!Wo(l,n)&&(s=!1)}),s}function Ku(i){return{result:"success",value:i}}function ul(i){return{result:"error",value:i}}function cl(i){return i["property-type"]==="data-driven"||i["property-type"]==="cross-faded-data-driven"}function va(i){return!!i.expression&&i.expression.parameters.indexOf("zoom")>-1}function Xi(i){return!!i.expression&&i.expression.interpolated}function An(i){return i instanceof Number?"number":i instanceof String?"string":i instanceof Boolean?"boolean":Array.isArray(i)?"array":i===null?"null":typeof i}function Yu(i){return typeof i=="object"&&i!==null&&!Array.isArray(i)}function op(i){return i}function kd(i,n){const s=n.type==="color",l=i.stops&&typeof i.stops[0][0]=="object",p=l||!(l||i.property!==void 0),v=i.type||(Xi(n)?"exponential":"interval");if(s||n.type==="padding"){const M=s?Ln.parse:zi.parse;(i=ci({},i)).stops&&(i.stops=i.stops.map(L=>[L[0],M(L[1])])),i.default=M(i.default?i.default:n.default)}if(i.colorSpace&&(x=i.colorSpace)!=="rgb"&&x!=="hcl"&&x!=="lab")throw new Error(`Unknown color space: "${i.colorSpace}"`);var x;let S,C,P;if(v==="exponential")S=Ie;else if(v==="interval")S=go;else if(v==="categorical"){S=Pd,C=Object.create(null);for(const M of i.stops)C[M[0]]=M[1];P=typeof i.stops[0][0]}else{if(v!=="identity")throw new Error(`Unknown function type "${v}"`);S=Ve}if(l){const M={},L=[];for(let W=0;W<i.stops.length;W++){const Z=i.stops[W],ne=Z[0].zoom;M[ne]===void 0&&(M[ne]={zoom:ne,type:i.type,property:i.property,default:i.default,stops:[]},L.push(ne)),M[ne].stops.push([Z[0].value,Z[1]])}const F=[];for(const W of L)F.push([M[W].zoom,kd(M[W],n)]);const U={name:"linear"};return{kind:"composite",interpolationType:U,interpolationFactor:Ti.interpolationFactor.bind(void 0,U),zoomStops:F.map(W=>W[0]),evaluate:({zoom:W},Z)=>Ie({stops:F,base:i.base},n,W).evaluate(W,Z)}}if(p){const M=v==="exponential"?{name:"exponential",base:i.base!==void 0?i.base:1}:null;return{kind:"camera",interpolationType:M,interpolationFactor:Ti.interpolationFactor.bind(void 0,M),zoomStops:i.stops.map(L=>L[0]),evaluate:({zoom:L})=>S(i,n,L,C,P)}}return{kind:"source",evaluate(M,L){const F=L&&L.properties?L.properties[i.property]:void 0;return F===void 0?hl(i.default,n.default):S(i,n,F,C,P)}}}function hl(i,n,s){return i!==void 0?i:n!==void 0?n:s!==void 0?s:void 0}function Pd(i,n,s,l,p){return hl(typeof s===p?l[s]:void 0,i.default,n.default)}function go(i,n,s){if(An(s)!=="number")return hl(i.default,n.default);const l=i.stops.length;if(l===1||s<=i.stops[0][0])return i.stops[0][1];if(s>=i.stops[l-1][0])return i.stops[l-1][1];const p=Vl(i.stops.map(v=>v[0]),s);return i.stops[p][1]}function Ie(i,n,s){const l=i.base!==void 0?i.base:1;if(An(s)!=="number")return hl(i.default,n.default);const p=i.stops.length;if(p===1||s<=i.stops[0][0])return i.stops[0][1];if(s>=i.stops[p-1][0])return i.stops[p-1][1];const v=Vl(i.stops.map(M=>M[0]),s),x=function(M,L,F,U){const W=U-F,Z=M-F;return W===0?0:L===1?Z/W:(Math.pow(L,Z)-1)/(Math.pow(L,W)-1)}(s,l,i.stops[v][0],i.stops[v+1][0]),S=i.stops[v][1],C=i.stops[v+1][1],P=Li[n.type]||op;return typeof S.evaluate=="function"?{evaluate(...M){const L=S.evaluate.apply(void 0,M),F=C.evaluate.apply(void 0,M);if(L!==void 0&&F!==void 0)return P(L,F,x,i.colorSpace)}}:P(S,C,x,i.colorSpace)}function Ve(i,n,s){switch(n.type){case"color":s=Ln.parse(s);break;case"formatted":s=Zi.fromString(s.toString());break;case"resolvedImage":s=Gi.fromString(s.toString());break;case"padding":s=zi.parse(s);break;default:An(s)===n.type||n.type==="enum"&&n.values[s]||(s=void 0)}return hl(s,i.default,n.default)}cs.register(al,{error:[{kind:"error"},[Ht],(i,[n])=>{throw new Er(n.evaluate(i))}],typeof:[Ht,[Xt],(i,[n])=>B(Or(n.evaluate(i)))],"to-rgba":[N(rt,4),[hi],(i,[n])=>{const[s,l,p,v]=n.evaluate(i).rgb;return[255*s,255*l,255*p,v]}],rgb:[hi,[rt,rt,rt],hh],rgba:[hi,[rt,rt,rt,rt],hh],has:{type:Ut,overloads:[[[Ht],(i,[n])=>Zo(n.evaluate(i),i.properties())],[[Ht,qi],(i,[n,s])=>Zo(n.evaluate(i),s.evaluate(i))]]},get:{type:Xt,overloads:[[[Ht],(i,[n])=>dh(n.evaluate(i),i.properties())],[[Ht,qi],(i,[n,s])=>dh(n.evaluate(i),s.evaluate(i))]]},"feature-state":[Xt,[Ht],(i,[n])=>dh(n.evaluate(i),i.featureState||{})],properties:[qi,[],i=>i.properties()],"geometry-type":[Ht,[],i=>i.geometryType()],id:[Xt,[],i=>i.id()],zoom:[rt,[],i=>i.globals.zoom],"heatmap-density":[rt,[],i=>i.globals.heatmapDensity||0],"line-progress":[rt,[],i=>i.globals.lineProgress||0],accumulated:[Xt,[],i=>i.globals.accumulated===void 0?null:i.globals.accumulated],"+":[rt,_a(rt),(i,n)=>{let s=0;for(const l of n)s+=l.evaluate(i);return s}],"*":[rt,_a(rt),(i,n)=>{let s=1;for(const l of n)s*=l.evaluate(i);return s}],"-":{type:rt,overloads:[[[rt,rt],(i,[n,s])=>n.evaluate(i)-s.evaluate(i)],[[rt],(i,[n])=>-n.evaluate(i)]]},"/":[rt,[rt,rt],(i,[n,s])=>n.evaluate(i)/s.evaluate(i)],"%":[rt,[rt,rt],(i,[n,s])=>n.evaluate(i)%s.evaluate(i)],ln2:[rt,[],()=>Math.LN2],pi:[rt,[],()=>Math.PI],e:[rt,[],()=>Math.E],"^":[rt,[rt,rt],(i,[n,s])=>Math.pow(n.evaluate(i),s.evaluate(i))],sqrt:[rt,[rt],(i,[n])=>Math.sqrt(n.evaluate(i))],log10:[rt,[rt],(i,[n])=>Math.log(n.evaluate(i))/Math.LN10],ln:[rt,[rt],(i,[n])=>Math.log(n.evaluate(i))],log2:[rt,[rt],(i,[n])=>Math.log(n.evaluate(i))/Math.LN2],sin:[rt,[rt],(i,[n])=>Math.sin(n.evaluate(i))],cos:[rt,[rt],(i,[n])=>Math.cos(n.evaluate(i))],tan:[rt,[rt],(i,[n])=>Math.tan(n.evaluate(i))],asin:[rt,[rt],(i,[n])=>Math.asin(n.evaluate(i))],acos:[rt,[rt],(i,[n])=>Math.acos(n.evaluate(i))],atan:[rt,[rt],(i,[n])=>Math.atan(n.evaluate(i))],min:[rt,_a(rt),(i,n)=>Math.min(...n.map(s=>s.evaluate(i)))],max:[rt,_a(rt),(i,n)=>Math.max(...n.map(s=>s.evaluate(i)))],abs:[rt,[rt],(i,[n])=>Math.abs(n.evaluate(i))],round:[rt,[rt],(i,[n])=>{const s=n.evaluate(i);return s<0?-Math.round(-s):Math.round(s)}],floor:[rt,[rt],(i,[n])=>Math.floor(n.evaluate(i))],ceil:[rt,[rt],(i,[n])=>Math.ceil(n.evaluate(i))],"filter-==":[Ut,[Ht,Xt],(i,[n,s])=>i.properties()[n.value]===s.value],"filter-id-==":[Ut,[Xt],(i,[n])=>i.id()===n.value],"filter-type-==":[Ut,[Ht],(i,[n])=>i.geometryType()===n.value],"filter-<":[Ut,[Ht,Xt],(i,[n,s])=>{const l=i.properties()[n.value],p=s.value;return typeof l==typeof p&&l<p}],"filter-id-<":[Ut,[Xt],(i,[n])=>{const s=i.id(),l=n.value;return typeof s==typeof l&&s<l}],"filter->":[Ut,[Ht,Xt],(i,[n,s])=>{const l=i.properties()[n.value],p=s.value;return typeof l==typeof p&&l>p}],"filter-id->":[Ut,[Xt],(i,[n])=>{const s=i.id(),l=n.value;return typeof s==typeof l&&s>l}],"filter-<=":[Ut,[Ht,Xt],(i,[n,s])=>{const l=i.properties()[n.value],p=s.value;return typeof l==typeof p&&l<=p}],"filter-id-<=":[Ut,[Xt],(i,[n])=>{const s=i.id(),l=n.value;return typeof s==typeof l&&s<=l}],"filter->=":[Ut,[Ht,Xt],(i,[n,s])=>{const l=i.properties()[n.value],p=s.value;return typeof l==typeof p&&l>=p}],"filter-id->=":[Ut,[Xt],(i,[n])=>{const s=i.id(),l=n.value;return typeof s==typeof l&&s>=l}],"filter-has":[Ut,[Xt],(i,[n])=>n.value in i.properties()],"filter-has-id":[Ut,[],i=>i.id()!==null&&i.id()!==void 0],"filter-type-in":[Ut,[N(Ht)],(i,[n])=>n.value.indexOf(i.geometryType())>=0],"filter-id-in":[Ut,[N(Xt)],(i,[n])=>n.value.indexOf(i.id())>=0],"filter-in-small":[Ut,[Ht,N(Xt)],(i,[n,s])=>s.value.indexOf(i.properties()[n.value])>=0],"filter-in-large":[Ut,[Ht,N(Xt)],(i,[n,s])=>function(l,p,v,x){for(;v<=x;){const S=v+x>>1;if(p[S]===l)return!0;p[S]>l?x=S-1:v=S+1}return!1}(i.properties()[n.value],s.value,0,s.value.length-1)],all:{type:Ut,overloads:[[[Ut,Ut],(i,[n,s])=>n.evaluate(i)&&s.evaluate(i)],[_a(Ut),(i,n)=>{for(const s of n)if(!s.evaluate(i))return!1;return!0}]]},any:{type:Ut,overloads:[[[Ut,Ut],(i,[n,s])=>n.evaluate(i)||s.evaluate(i)],[_a(Ut),(i,n)=>{for(const s of n)if(s.evaluate(i))return!0;return!1}]]},"!":[Ut,[Ut],(i,[n])=>!n.evaluate(i)],"is-supported-script":[Ut,[Ht],(i,[n])=>{const s=i.globals&&i.globals.isSupportedScript;return!s||s(n.evaluate(i))}],upcase:[Ht,[Ht],(i,[n])=>n.evaluate(i).toUpperCase()],downcase:[Ht,[Ht],(i,[n])=>n.evaluate(i).toLowerCase()],concat:[Ht,_a(Xt),(i,n)=>n.map(s=>tl(s.evaluate(i))).join("")],"resolved-locale":[Ht,[Ks],(i,[n])=>n.evaluate(i).resolvedLocale()]});class Oe{constructor(n,s){var l;this.expression=n,this._warningHistory={},this._evaluator=new Nu,this._defaultValue=s?(l=s).type==="color"&&Yu(l.default)?new Ln(0,0,0,0):l.type==="color"?Ln.parse(l.default)||null:l.type==="padding"?zi.parse(l.default)||null:l.type==="variableAnchorOffsetCollection"?Wi.parse(l.default)||null:l.default===void 0?null:l.default:null,this._enumValues=s&&s.type==="enum"?s.values:null}evaluateWithoutErrorHandling(n,s,l,p,v,x){return this._evaluator.globals=n,this._evaluator.feature=s,this._evaluator.featureState=l,this._evaluator.canonical=p,this._evaluator.availableImages=v||null,this._evaluator.formattedSection=x,this.expression.evaluate(this._evaluator)}evaluate(n,s,l,p,v,x){this._evaluator.globals=n,this._evaluator.feature=s||null,this._evaluator.featureState=l||null,this._evaluator.canonical=p,this._evaluator.availableImages=v||null,this._evaluator.formattedSection=x||null;try{const S=this.expression.evaluate(this._evaluator);if(S==null||typeof S=="number"&&S!=S)return this._defaultValue;if(this._enumValues&&!(S in this._enumValues))throw new Er(`Expected value to be one of ${Object.keys(this._enumValues).map(C=>JSON.stringify(C)).join(", ")}, but found ${JSON.stringify(S)} instead.`);return S}catch(S){return this._warningHistory[S.message]||(this._warningHistory[S.message]=!0,typeof console<"u"&&console.warn(S.message)),this._defaultValue}}}function Tt(i){return Array.isArray(i)&&i.length>0&&typeof i[0]=="string"&&i[0]in al}function Gt(i,n){const s=new Bo(al,ya,[],n?function(p){const v={color:hi,string:Ht,number:rt,enum:Ht,boolean:Ut,formatted:uo,padding:co,resolvedImage:Ds,variableAnchorOffsetCollection:ae};return p.type==="array"?N(v[p.value]||Xt,p.length):v[p.type]}(n):void 0),l=s.parse(i,void 0,void 0,void 0,n&&n.type==="string"?{typeAnnotation:"coerce"}:void 0);return l?Ku(new Oe(l,n)):ul(s.errors)}class Tn{constructor(n,s){this.kind=n,this._styleExpression=s,this.isStateDependent=n!=="constant"&&!Hi(s.expression)}evaluateWithoutErrorHandling(n,s,l,p,v,x){return this._styleExpression.evaluateWithoutErrorHandling(n,s,l,p,v,x)}evaluate(n,s,l,p,v,x){return this._styleExpression.evaluate(n,s,l,p,v,x)}}class gr{constructor(n,s,l,p){this.kind=n,this.zoomStops=l,this._styleExpression=s,this.isStateDependent=n!=="camera"&&!Hi(s.expression),this.interpolationType=p}evaluateWithoutErrorHandling(n,s,l,p,v,x){return this._styleExpression.evaluateWithoutErrorHandling(n,s,l,p,v,x)}evaluate(n,s,l,p,v,x){return this._styleExpression.evaluate(n,s,l,p,v,x)}interpolationFactor(n,s,l){return this.interpolationType?Ti.interpolationFactor(this.interpolationType,n,s,l):0}}function Hn(i,n){const s=Gt(i,n);if(s.result==="error")return s;const l=s.value.expression,p=ll(l);if(!p&&!cl(n))return ul([new Rr("","data expressions not supported")]);const v=Wo(l,["zoom"]);if(!v&&!va(n))return ul([new Rr("","zoom expressions not supported")]);const x=Xl(l);return x||v?x instanceof Rr?ul([x]):x instanceof Ti&&!Xi(n)?ul([new Rr("",'"interpolate" expressions cannot be used with this property')]):Ku(x?new gr(p?"camera":"composite",s.value,x.labels,x instanceof Ti?x.interpolation:void 0):new Tn(p?"constant":"source",s.value)):ul([new Rr("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class Go{constructor(n,s){this._parameters=n,this._specification=s,ci(this,kd(this._parameters,this._specification))}static deserialize(n){return new Go(n._parameters,n._specification)}static serialize(n){return{_parameters:n._parameters,_specification:n._specification}}}function Xl(i){let n=null;if(i instanceof ho)n=Xl(i.result);else if(i instanceof $u){for(const s of i.args)if(n=Xl(s),n)break}else(i instanceof il||i instanceof Ti)&&i.input instanceof cs&&i.input.name==="zoom"&&(n=i);return n instanceof Rr||i.eachChild(s=>{const l=Xl(s);l instanceof Rr?n=l:!n&&l?n=new Rr("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):n&&l&&n!==l&&(n=new Rr("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),n}function Ei(i){if(i===!0||i===!1)return!0;if(!Array.isArray(i)||i.length===0)return!1;switch(i[0]){case"has":return i.length>=2&&i[1]!=="$id"&&i[1]!=="$type";case"in":return i.length>=3&&(typeof i[1]!="string"||Array.isArray(i[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return i.length!==3||Array.isArray(i[1])||Array.isArray(i[2]);case"any":case"all":for(const n of i.slice(1))if(!Ei(n)&&typeof n!="boolean")return!1;return!0;default:return!0}}const xa={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function fh(i){if(i==null)return{filter:()=>!0,needGeometry:!1};Ei(i)||(i=wa(i));const n=Gt(i,xa);if(n.result==="error")throw new Error(n.value.map(s=>`${s.key}: ${s.message}`).join(", "));return{filter:(s,l,p)=>n.value.evaluate(s,l,{},p),needGeometry:Kl(i)}}function dl(i,n){return i<n?-1:i>n?1:0}function Kl(i){if(!Array.isArray(i))return!1;if(i[0]==="within"||i[0]==="distance")return!0;for(let n=1;n<i.length;n++)if(Kl(i[n]))return!0;return!1}function wa(i){if(!i)return!0;const n=i[0];return i.length<=1?n!=="any":n==="=="?jn(i[1],i[2],"=="):n==="!="?$r(jn(i[1],i[2],"==")):n==="<"||n===">"||n==="<="||n===">="?jn(i[1],i[2],n):n==="any"?(s=i.slice(1),["any"].concat(s.map(wa))):n==="all"?["all"].concat(i.slice(1).map(wa)):n==="none"?["all"].concat(i.slice(1).map(wa).map($r)):n==="in"?Yl(i[1],i.slice(2)):n==="!in"?$r(Yl(i[1],i.slice(2))):n==="has"?fl(i[1]):n!=="!has"||$r(fl(i[1]));var s}function jn(i,n,s){switch(i){case"$type":return[`filter-type-${s}`,n];case"$id":return[`filter-id-${s}`,n];default:return[`filter-${s}`,i,n]}}function Yl(i,n){if(n.length===0)return!1;switch(i){case"$type":return["filter-type-in",["literal",n]];case"$id":return["filter-id-in",["literal",n]];default:return n.length>200&&!n.some(s=>typeof s!=typeof n[0])?["filter-in-large",i,["literal",n.sort(dl)]]:["filter-in-small",i,["literal",n]]}}function fl(i){switch(i){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",i]}}function $r(i){return["!",i]}function ba(i){const n=typeof i;if(n==="number"||n==="boolean"||n==="string"||i==null)return JSON.stringify(i);if(Array.isArray(i)){let p="[";for(const v of i)p+=`${ba(v)},`;return`${p}]`}const s=Object.keys(i).sort();let l="{";for(let p=0;p<s.length;p++)l+=`${JSON.stringify(s[p])}:${ba(i[s[p]])},`;return`${l}}`}function Ad(i){let n="";for(const s of Fn)n+=`/${ba(i[s])}`;return n}function Md(i){const n=i.value;return n?[new Ke(i.key,n,"constants have been deprecated as of v8")]:[]}function cr(i){return i instanceof Number||i instanceof String||i instanceof Boolean?i.valueOf():i}function Yr(i){if(Array.isArray(i))return i.map(Yr);if(i instanceof Object&&!(i instanceof Number||i instanceof String||i instanceof Boolean)){const n={};for(const s in i)n[s]=Yr(i[s]);return n}return cr(i)}function di(i){const n=i.key,s=i.value,l=i.valueSpec||{},p=i.objectElementValidators||{},v=i.style,x=i.styleSpec,S=i.validateSpec;let C=[];const P=An(s);if(P!=="object")return[new Ke(n,s,`object expected, ${P} found`)];for(const M in s){const L=M.split(".")[0],F=l[L]||l["*"];let U;if(p[L])U=p[L];else if(l[L])U=S;else if(p["*"])U=p["*"];else{if(!l["*"]){C.push(new Ke(n,s[M],`unknown property "${M}"`));continue}U=S}C=C.concat(U({key:(n&&`${n}.`)+M,value:s[M],valueSpec:F,style:v,styleSpec:x,object:s,objectKey:M,validateSpec:S},s))}for(const M in l)p[M]||l[M].required&&l[M].default===void 0&&s[M]===void 0&&C.push(new Ke(n,s,`missing required property "${M}"`));return C}function pl(i){const n=i.value,s=i.valueSpec,l=i.style,p=i.styleSpec,v=i.key,x=i.arrayElementValidator||i.validateSpec;if(An(n)!=="array")return[new Ke(v,n,`array expected, ${An(n)} found`)];if(s.length&&n.length!==s.length)return[new Ke(v,n,`array length ${s.length} expected, length ${n.length} found`)];if(s["min-length"]&&n.length<s["min-length"])return[new Ke(v,n,`array length at least ${s["min-length"]} expected, length ${n.length} found`)];let S={type:s.value,values:s.values};p.$version<7&&(S.function=s.function),An(s.value)==="object"&&(S=s.value);let C=[];for(let P=0;P<n.length;P++)C=C.concat(x({array:n,arrayIndex:P,value:n[P],valueSpec:S,validateSpec:i.validateSpec,style:l,styleSpec:p,key:`${v}[${P}]`}));return C}function ml(i){const n=i.key,s=i.value,l=i.valueSpec;let p=An(s);return p==="number"&&s!=s&&(p="NaN"),p!=="number"?[new Ke(n,s,`number expected, ${p} found`)]:"minimum"in l&&s<l.minimum?[new Ke(n,s,`${s} is less than the minimum value ${l.minimum}`)]:"maximum"in l&&s>l.maximum?[new Ke(n,s,`${s} is greater than the maximum value ${l.maximum}`)]:[]}function Jl(i){const n=i.valueSpec,s=cr(i.value.type);let l,p,v,x={};const S=s!=="categorical"&&i.value.property===void 0,C=!S,P=An(i.value.stops)==="array"&&An(i.value.stops[0])==="array"&&An(i.value.stops[0][0])==="object",M=di({key:i.key,value:i.value,valueSpec:i.styleSpec.function,validateSpec:i.validateSpec,style:i.style,styleSpec:i.styleSpec,objectElementValidators:{stops:function(U){if(s==="identity")return[new Ke(U.key,U.value,'identity function may not have a "stops" property')];let W=[];const Z=U.value;return W=W.concat(pl({key:U.key,value:Z,valueSpec:U.valueSpec,validateSpec:U.validateSpec,style:U.style,styleSpec:U.styleSpec,arrayElementValidator:L})),An(Z)==="array"&&Z.length===0&&W.push(new Ke(U.key,Z,"array must have at least one stop")),W},default:function(U){return U.validateSpec({key:U.key,value:U.value,valueSpec:n,validateSpec:U.validateSpec,style:U.style,styleSpec:U.styleSpec})}}});return s==="identity"&&S&&M.push(new Ke(i.key,i.value,'missing required property "property"')),s==="identity"||i.value.stops||M.push(new Ke(i.key,i.value,'missing required property "stops"')),s==="exponential"&&i.valueSpec.expression&&!Xi(i.valueSpec)&&M.push(new Ke(i.key,i.value,"exponential functions not supported")),i.styleSpec.$version>=8&&(C&&!cl(i.valueSpec)?M.push(new Ke(i.key,i.value,"property functions not supported")):S&&!va(i.valueSpec)&&M.push(new Ke(i.key,i.value,"zoom functions not supported"))),s!=="categorical"&&!P||i.value.property!==void 0||M.push(new Ke(i.key,i.value,'"property" property is required')),M;function L(U){let W=[];const Z=U.value,ne=U.key;if(An(Z)!=="array")return[new Ke(ne,Z,`array expected, ${An(Z)} found`)];if(Z.length!==2)return[new Ke(ne,Z,`array length 2 expected, length ${Z.length} found`)];if(P){if(An(Z[0])!=="object")return[new Ke(ne,Z,`object expected, ${An(Z[0])} found`)];if(Z[0].zoom===void 0)return[new Ke(ne,Z,"object stop key must have zoom")];if(Z[0].value===void 0)return[new Ke(ne,Z,"object stop key must have value")];if(v&&v>cr(Z[0].zoom))return[new Ke(ne,Z[0].zoom,"stop zoom values must appear in ascending order")];cr(Z[0].zoom)!==v&&(v=cr(Z[0].zoom),p=void 0,x={}),W=W.concat(di({key:`${ne}[0]`,value:Z[0],valueSpec:{zoom:{}},validateSpec:U.validateSpec,style:U.style,styleSpec:U.styleSpec,objectElementValidators:{zoom:ml,value:F}}))}else W=W.concat(F({key:`${ne}[0]`,value:Z[0],valueSpec:{},validateSpec:U.validateSpec,style:U.style,styleSpec:U.styleSpec},Z));return Tt(Yr(Z[1]))?W.concat([new Ke(`${ne}[1]`,Z[1],"expressions are not allowed in function stops.")]):W.concat(U.validateSpec({key:`${ne}[1]`,value:Z[1],valueSpec:n,validateSpec:U.validateSpec,style:U.style,styleSpec:U.styleSpec}))}function F(U,W){const Z=An(U.value),ne=cr(U.value),oe=U.value!==null?U.value:W;if(l){if(Z!==l)return[new Ke(U.key,oe,`${Z} stop domain type must match previous stop domain type ${l}`)]}else l=Z;if(Z!=="number"&&Z!=="string"&&Z!=="boolean")return[new Ke(U.key,oe,"stop domain value must be a number, string, or boolean")];if(Z!=="number"&&s!=="categorical"){let Pe=`number expected, ${Z} found`;return cl(n)&&s===void 0&&(Pe+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Ke(U.key,oe,Pe)]}return s!=="categorical"||Z!=="number"||isFinite(ne)&&Math.floor(ne)===ne?s!=="categorical"&&Z==="number"&&p!==void 0&&ne<p?[new Ke(U.key,oe,"stop domain values must appear in ascending order")]:(p=ne,s==="categorical"&&ne in x?[new Ke(U.key,oe,"stop domain values must be unique")]:(x[ne]=!0,[])):[new Ke(U.key,oe,`integer expected, found ${ne}`)]}}function Sa(i){const n=(i.expressionContext==="property"?Hn:Gt)(Yr(i.value),i.valueSpec);if(n.result==="error")return n.value.map(l=>new Ke(`${i.key}${l.key}`,i.value,l.message));const s=n.value.expression||n.value._styleExpression.expression;if(i.expressionContext==="property"&&i.propertyKey==="text-font"&&!s.outputDefined())return[new Ke(i.key,i.value,`Invalid data expression for "${i.propertyKey}". Output values must be contained as literals within the expression.`)];if(i.expressionContext==="property"&&i.propertyType==="layout"&&!Hi(s))return[new Ke(i.key,i.value,'"feature-state" data expressions are not supported with layout properties.')];if(i.expressionContext==="filter"&&!Hi(s))return[new Ke(i.key,i.value,'"feature-state" data expressions are not supported with filters.')];if(i.expressionContext&&i.expressionContext.indexOf("cluster")===0){if(!Wo(s,["zoom","feature-state"]))return[new Ke(i.key,i.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(i.expressionContext==="cluster-initial"&&!ll(s))return[new Ke(i.key,i.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function hs(i){const n=i.key,s=i.value,l=i.valueSpec,p=[];return Array.isArray(l.values)?l.values.indexOf(cr(s))===-1&&p.push(new Ke(n,s,`expected one of [${l.values.join(", ")}], ${JSON.stringify(s)} found`)):Object.keys(l.values).indexOf(cr(s))===-1&&p.push(new Ke(n,s,`expected one of [${Object.keys(l.values).join(", ")}], ${JSON.stringify(s)} found`)),p}function Ju(i){return Ei(Yr(i.value))?Sa(ci({},i,{expressionContext:"filter",valueSpec:{value:"boolean"}})):Ho(i)}function Ho(i){const n=i.value,s=i.key;if(An(n)!=="array")return[new Ke(s,n,`array expected, ${An(n)} found`)];const l=i.styleSpec;let p,v=[];if(n.length<1)return[new Ke(s,n,"filter array must have at least 1 element")];switch(v=v.concat(hs({key:`${s}[0]`,value:n[0],valueSpec:l.filter_operator,style:i.style,styleSpec:i.styleSpec})),cr(n[0])){case"<":case"<=":case">":case">=":n.length>=2&&cr(n[1])==="$type"&&v.push(new Ke(s,n,`"$type" cannot be use with operator "${n[0]}"`));case"==":case"!=":n.length!==3&&v.push(new Ke(s,n,`filter array for operator "${n[0]}" must have 3 elements`));case"in":case"!in":n.length>=2&&(p=An(n[1]),p!=="string"&&v.push(new Ke(`${s}[1]`,n[1],`string expected, ${p} found`)));for(let x=2;x<n.length;x++)p=An(n[x]),cr(n[1])==="$type"?v=v.concat(hs({key:`${s}[${x}]`,value:n[x],valueSpec:l.geometry_type,style:i.style,styleSpec:i.styleSpec})):p!=="string"&&p!=="number"&&p!=="boolean"&&v.push(new Ke(`${s}[${x}]`,n[x],`string, number, or boolean expected, ${p} found`));break;case"any":case"all":case"none":for(let x=1;x<n.length;x++)v=v.concat(Ho({key:`${s}[${x}]`,value:n[x],style:i.style,styleSpec:i.styleSpec}));break;case"has":case"!has":p=An(n[1]),n.length!==2?v.push(new Ke(s,n,`filter array for "${n[0]}" operator must have 2 elements`)):p!=="string"&&v.push(new Ke(`${s}[1]`,n[1],`string expected, ${p} found`))}return v}function _o(i,n){const s=i.key,l=i.validateSpec,p=i.style,v=i.styleSpec,x=i.value,S=i.objectKey,C=v[`${n}_${i.layerType}`];if(!C)return[];const P=S.match(/^(.*)-transition$/);if(n==="paint"&&P&&C[P[1]]&&C[P[1]].transition)return l({key:s,value:x,valueSpec:v.transition,style:p,styleSpec:v});const M=i.valueSpec||C[S];if(!M)return[new Ke(s,x,`unknown property "${S}"`)];let L;if(An(x)==="string"&&cl(M)&&!M.tokens&&(L=/^{([^}]+)}$/.exec(x)))return[new Ke(s,x,`"${S}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(L[1])} }\`.`)];const F=[];return i.layerType==="symbol"&&(S==="text-field"&&p&&!p.glyphs&&F.push(new Ke(s,x,'use of "text-field" requires a style "glyphs" property')),S==="text-font"&&Yu(Yr(x))&&cr(x.type)==="identity"&&F.push(new Ke(s,x,'"text-font" does not support identity functions'))),F.concat(l({key:i.key,value:x,valueSpec:M,style:p,styleSpec:v,expressionContext:"property",propertyType:n,propertyKey:S}))}function Ta(i){return _o(i,"paint")}function ph(i){return _o(i,"layout")}function mh(i){let n=[];const s=i.value,l=i.key,p=i.style,v=i.styleSpec;s.type||s.ref||n.push(new Ke(l,s,'either "type" or "ref" is required'));let x=cr(s.type);const S=cr(s.ref);if(s.id){const C=cr(s.id);for(let P=0;P<i.arrayIndex;P++){const M=p.layers[P];cr(M.id)===C&&n.push(new Ke(l,s.id,`duplicate layer id "${s.id}", previously used at line ${M.id.__line__}`))}}if("ref"in s){let C;["type","source","source-layer","filter","layout"].forEach(P=>{P in s&&n.push(new Ke(l,s[P],`"${P}" is prohibited for ref layers`))}),p.layers.forEach(P=>{cr(P.id)===S&&(C=P)}),C?C.ref?n.push(new Ke(l,s.ref,"ref cannot reference another ref layer")):x=cr(C.type):n.push(new Ke(l,s.ref,`ref layer "${S}" not found`))}else if(x!=="background")if(s.source){const C=p.sources&&p.sources[s.source],P=C&&cr(C.type);C?P==="vector"&&x==="raster"?n.push(new Ke(l,s.source,`layer "${s.id}" requires a raster source`)):P!=="raster-dem"&&x==="hillshade"?n.push(new Ke(l,s.source,`layer "${s.id}" requires a raster-dem source`)):P==="raster"&&x!=="raster"?n.push(new Ke(l,s.source,`layer "${s.id}" requires a vector source`)):P!=="vector"||s["source-layer"]?P==="raster-dem"&&x!=="hillshade"?n.push(new Ke(l,s.source,"raster-dem source can only be used with layer type 'hillshade'.")):x!=="line"||!s.paint||!s.paint["line-gradient"]||P==="geojson"&&C.lineMetrics||n.push(new Ke(l,s,`layer "${s.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):n.push(new Ke(l,s,`layer "${s.id}" must specify a "source-layer"`)):n.push(new Ke(l,s.source,`source "${s.source}" not found`))}else n.push(new Ke(l,s,'missing required property "source"'));return n=n.concat(di({key:l,value:s,valueSpec:v.layer,style:i.style,styleSpec:i.styleSpec,validateSpec:i.validateSpec,objectElementValidators:{"*":()=>[],type:()=>i.validateSpec({key:`${l}.type`,value:s.type,valueSpec:v.layer.type,style:i.style,styleSpec:i.styleSpec,validateSpec:i.validateSpec,object:s,objectKey:"type"}),filter:Ju,layout:C=>di({layer:s,key:C.key,value:C.value,style:C.style,styleSpec:C.styleSpec,validateSpec:C.validateSpec,objectElementValidators:{"*":P=>ph(ci({layerType:x},P))}}),paint:C=>di({layer:s,key:C.key,value:C.value,style:C.style,styleSpec:C.styleSpec,validateSpec:C.validateSpec,objectElementValidators:{"*":P=>Ta(ci({layerType:x},P))}})}})),n}function Ea(i){const n=i.value,s=i.key,l=An(n);return l!=="string"?[new Ke(s,n,`string expected, ${l} found`)]:[]}const Ca={promoteId:function({key:i,value:n}){if(An(n)==="string")return Ea({key:i,value:n});{const s=[];for(const l in n)s.push(...Ea({key:`${i}.${l}`,value:n[l]}));return s}}};function Xo(i){const n=i.value,s=i.key,l=i.styleSpec,p=i.style,v=i.validateSpec;if(!n.type)return[new Ke(s,n,'"type" is required')];const x=cr(n.type);let S;switch(x){case"vector":case"raster":return S=di({key:s,value:n,valueSpec:l[`source_${x.replace("-","_")}`],style:i.style,styleSpec:l,objectElementValidators:Ca,validateSpec:v}),S;case"raster-dem":return S=function(C){var P;const M=(P=C.sourceName)!==null&&P!==void 0?P:"",L=C.value,F=C.styleSpec,U=F.source_raster_dem,W=C.style;let Z=[];const ne=An(L);if(L===void 0)return Z;if(ne!=="object")return Z.push(new Ke("source_raster_dem",L,`object expected, ${ne} found`)),Z;const oe=cr(L.encoding)==="custom",Pe=["redFactor","greenFactor","blueFactor","baseShift"],ge=C.value.encoding?`"${C.value.encoding}"`:"Default";for(const _e in L)!oe&&Pe.includes(_e)?Z.push(new Ke(_e,L[_e],`In "${M}": "${_e}" is only valid when "encoding" is set to "custom". ${ge} encoding found`)):U[_e]?Z=Z.concat(C.validateSpec({key:_e,value:L[_e],valueSpec:U[_e],validateSpec:C.validateSpec,style:W,styleSpec:F})):Z.push(new Ke(_e,L[_e],`unknown property "${_e}"`));return Z}({sourceName:s,value:n,style:i.style,styleSpec:l,validateSpec:v}),S;case"geojson":if(S=di({key:s,value:n,valueSpec:l.source_geojson,style:p,styleSpec:l,validateSpec:v,objectElementValidators:Ca}),n.cluster)for(const C in n.clusterProperties){const[P,M]=n.clusterProperties[C],L=typeof P=="string"?[P,["accumulated"],["get",C]]:P;S.push(...Sa({key:`${s}.${C}.map`,value:M,validateSpec:v,expressionContext:"cluster-map"})),S.push(...Sa({key:`${s}.${C}.reduce`,value:L,validateSpec:v,expressionContext:"cluster-reduce"}))}return S;case"video":return di({key:s,value:n,valueSpec:l.source_video,style:p,validateSpec:v,styleSpec:l});case"image":return di({key:s,value:n,valueSpec:l.source_image,style:p,validateSpec:v,styleSpec:l});case"canvas":return[new Ke(s,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return hs({key:`${s}.type`,value:n.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:p,validateSpec:v,styleSpec:l})}}function Ql(i){const n=i.value,s=i.styleSpec,l=s.light,p=i.style;let v=[];const x=An(n);if(n===void 0)return v;if(x!=="object")return v=v.concat([new Ke("light",n,`object expected, ${x} found`)]),v;for(const S in n){const C=S.match(/^(.*)-transition$/);v=v.concat(C&&l[C[1]]&&l[C[1]].transition?i.validateSpec({key:S,value:n[S],valueSpec:s.transition,validateSpec:i.validateSpec,style:p,styleSpec:s}):l[S]?i.validateSpec({key:S,value:n[S],valueSpec:l[S],validateSpec:i.validateSpec,style:p,styleSpec:s}):[new Ke(S,n[S],`unknown property "${S}"`)])}return v}function gh(i){const n=i.value,s=i.styleSpec,l=s.sky,p=i.style,v=An(n);if(n===void 0)return[];if(v!=="object")return[new Ke("sky",n,`object expected, ${v} found`)];let x=[];for(const S in n)x=x.concat(l[S]?i.validateSpec({key:S,value:n[S],valueSpec:l[S],style:p,styleSpec:s}):[new Ke(S,n[S],`unknown property "${S}"`)]);return x}function Qu(i){const n=i.value,s=i.styleSpec,l=s.terrain,p=i.style;let v=[];const x=An(n);if(n===void 0)return v;if(x!=="object")return v=v.concat([new Ke("terrain",n,`object expected, ${x} found`)]),v;for(const S in n)v=v.concat(l[S]?i.validateSpec({key:S,value:n[S],valueSpec:l[S],validateSpec:i.validateSpec,style:p,styleSpec:s}):[new Ke(S,n[S],`unknown property "${S}"`)]);return v}function _h(i){let n=[];const s=i.value,l=i.key;if(Array.isArray(s)){const p=[],v=[];for(const x in s)s[x].id&&p.includes(s[x].id)&&n.push(new Ke(l,s,`all the sprites' ids must be unique, but ${s[x].id} is duplicated`)),p.push(s[x].id),s[x].url&&v.includes(s[x].url)&&n.push(new Ke(l,s,`all the sprites' URLs must be unique, but ${s[x].url} is duplicated`)),v.push(s[x].url),n=n.concat(di({key:`${l}[${x}]`,value:s[x],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:i.validateSpec}));return n}return Ea({key:l,value:s})}const ec={"*":()=>[],array:pl,boolean:function(i){const n=i.value,s=i.key,l=An(n);return l!=="boolean"?[new Ke(s,n,`boolean expected, ${l} found`)]:[]},number:ml,color:function(i){const n=i.key,s=i.value,l=An(s);return l!=="string"?[new Ke(n,s,`color expected, ${l} found`)]:Ln.parse(String(s))?[]:[new Ke(n,s,`color expected, "${s}" found`)]},constants:Md,enum:hs,filter:Ju,function:Jl,layer:mh,object:di,source:Xo,light:Ql,sky:gh,terrain:Qu,projection:function(i){const n=i.value,s=i.styleSpec,l=s.projection,p=i.style,v=An(n);if(n===void 0)return[];if(v!=="object")return[new Ke("projection",n,`object expected, ${v} found`)];let x=[];for(const S in n)x=x.concat(l[S]?i.validateSpec({key:S,value:n[S],valueSpec:l[S],style:p,styleSpec:s}):[new Ke(S,n[S],`unknown property "${S}"`)]);return x},string:Ea,formatted:function(i){return Ea(i).length===0?[]:Sa(i)},resolvedImage:function(i){return Ea(i).length===0?[]:Sa(i)},padding:function(i){const n=i.key,s=i.value;if(An(s)==="array"){if(s.length<1||s.length>4)return[new Ke(n,s,`padding requires 1 to 4 values; ${s.length} values found`)];const l={type:"number"};let p=[];for(let v=0;v<s.length;v++)p=p.concat(i.validateSpec({key:`${n}[${v}]`,value:s[v],validateSpec:i.validateSpec,valueSpec:l}));return p}return ml({key:n,value:s,valueSpec:{}})},variableAnchorOffsetCollection:function(i){const n=i.key,s=i.value,l=An(s),p=i.styleSpec;if(l!=="array"||s.length<1||s.length%2!=0)return[new Ke(n,s,"variableAnchorOffsetCollection requires a non-empty array of even length")];let v=[];for(let x=0;x<s.length;x+=2)v=v.concat(hs({key:`${n}[${x}]`,value:s[x],valueSpec:p.layout_symbol["text-anchor"]})),v=v.concat(pl({key:`${n}[${x+1}]`,value:s[x+1],valueSpec:{length:2,value:"number"},validateSpec:i.validateSpec,style:i.style,styleSpec:p}));return v},sprite:_h};function _r(i){const n=i.value,s=i.valueSpec,l=i.styleSpec;return i.validateSpec=_r,s.expression&&Yu(cr(n))?Jl(i):s.expression&&Tt(Yr(n))?Sa(i):s.type&&ec[s.type]?ec[s.type](i):di(ci({},i,{valueSpec:s.type?l[s.type]:s}))}function ni(i){const n=i.value,s=i.key,l=Ea(i);return l.length||(n.indexOf("{fontstack}")===-1&&l.push(new Ke(s,n,'"glyphs" url must include a "{fontstack}" token')),n.indexOf("{range}")===-1&&l.push(new Ke(s,n,'"glyphs" url must include a "{range}" token'))),l}function ds(i,n=Ce){let s=[];return s=s.concat(_r({key:"",value:i,valueSpec:n.$root,styleSpec:n,style:i,validateSpec:_r,objectElementValidators:{glyphs:ni,"*":()=>[]}})),i.constants&&(s=s.concat(Md({key:"constants",value:i.constants,style:i,styleSpec:n,validateSpec:_r}))),tc(s)}function Qs(i){return function(n){return i({...n,validateSpec:_r})}}function tc(i){return[].concat(i).sort((n,s)=>n.line-s.line)}function Os(i){return function(...n){return tc(i.apply(this,n))}}ds.source=Os(Qs(Xo)),ds.sprite=Os(Qs(_h)),ds.glyphs=Os(Qs(ni)),ds.light=Os(Qs(Ql)),ds.sky=Os(Qs(gh)),ds.terrain=Os(Qs(Qu)),ds.layer=Os(Qs(mh)),ds.filter=Os(Qs(Ju)),ds.paintProperty=Os(Qs(Ta)),ds.layoutProperty=Os(Qs(ph));const yo=ds,eu=yo.light,yh=yo.sky,Ia=yo.paintProperty,gl=yo.layoutProperty;function ka(i,n){let s=!1;if(n&&n.length)for(const l of n)i.fire(new sn(new Error(l.message))),s=!0;return s}class vo{constructor(n,s,l){const p=this.cells=[];if(n instanceof ArrayBuffer){this.arrayBuffer=n;const x=new Int32Array(this.arrayBuffer);n=x[0],this.d=(s=x[1])+2*(l=x[2]);for(let C=0;C<this.d*this.d;C++){const P=x[3+C],M=x[3+C+1];p.push(P===M?null:x.subarray(P,M))}const S=x[3+p.length+1];this.keys=x.subarray(x[3+p.length],S),this.bboxes=x.subarray(S),this.insert=this._insertReadonly}else{this.d=s+2*l;for(let x=0;x<this.d*this.d;x++)p.push([]);this.keys=[],this.bboxes=[]}this.n=s,this.extent=n,this.padding=l,this.scale=s/n,this.uid=0;const v=l/s*n;this.min=-v,this.max=n+v}insert(n,s,l,p,v){this._forEachCell(s,l,p,v,this._insertCell,this.uid++,void 0,void 0),this.keys.push(n),this.bboxes.push(s),this.bboxes.push(l),this.bboxes.push(p),this.bboxes.push(v)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(n,s,l,p,v,x){this.cells[v].push(x)}query(n,s,l,p,v){const x=this.min,S=this.max;if(n<=x&&s<=x&&S<=l&&S<=p&&!v)return Array.prototype.slice.call(this.keys);{const C=[];return this._forEachCell(n,s,l,p,this._queryCell,C,{},v),C}}_queryCell(n,s,l,p,v,x,S,C){const P=this.cells[v];if(P!==null){const M=this.keys,L=this.bboxes;for(let F=0;F<P.length;F++){const U=P[F];if(S[U]===void 0){const W=4*U;(C?C(L[W+0],L[W+1],L[W+2],L[W+3]):n<=L[W+2]&&s<=L[W+3]&&l>=L[W+0]&&p>=L[W+1])?(S[U]=!0,x.push(M[U])):S[U]=!1}}}}_forEachCell(n,s,l,p,v,x,S,C){const P=this._convertToCellCoord(n),M=this._convertToCellCoord(s),L=this._convertToCellCoord(l),F=this._convertToCellCoord(p);for(let U=P;U<=L;U++)for(let W=M;W<=F;W++){const Z=this.d*W+U;if((!C||C(this._convertFromCellCoord(U),this._convertFromCellCoord(W),this._convertFromCellCoord(U+1),this._convertFromCellCoord(W+1)))&&v.call(this,n,s,l,p,Z,x,S,C))return}}_convertFromCellCoord(n){return(n-this.padding)/this.scale}_convertToCellCoord(n){return Math.max(0,Math.min(this.d-1,Math.floor(n*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const n=this.cells,s=3+this.cells.length+1+1;let l=0;for(let x=0;x<this.cells.length;x++)l+=this.cells[x].length;const p=new Int32Array(s+l+this.keys.length+this.bboxes.length);p[0]=this.extent,p[1]=this.n,p[2]=this.padding;let v=s;for(let x=0;x<n.length;x++){const S=n[x];p[3+x]=v,p.set(S,v),v+=S.length}return p[3+n.length]=v,p.set(this.keys,v),v+=this.keys.length,p[3+n.length+1]=v,p.set(this.bboxes,v),v+=this.bboxes.length,p.buffer}static serialize(n,s){const l=n.toArrayBuffer();return s&&s.push(l),{buffer:l}}static deserialize(n){return new vo(n.buffer)}}const ri={};function vt(i,n,s={}){if(ri[i])throw new Error(`${i} is already registered.`);Object.defineProperty(n,"_classRegistryKey",{value:i,writeable:!1}),ri[i]={klass:n,omit:s.omit||[],shallow:s.shallow||[]}}vt("Object",Object),vt("TransferableGridIndex",vo),vt("Color",Ln),vt("Error",Error),vt("AJAXError",Nn),vt("ResolvedImage",Gi),vt("StylePropertyFunction",Go),vt("StyleExpression",Oe,{omit:["_evaluator"]}),vt("ZoomDependentExpression",gr),vt("ZoomConstantExpression",Tn),vt("CompoundExpression",cs,{omit:["_evaluate"]});for(const i in al)al[i]._classRegistryKey||vt(`Expression_${i}`,al[i]);function nc(i){return i&&typeof ArrayBuffer<"u"&&(i instanceof ArrayBuffer||i.constructor&&i.constructor.name==="ArrayBuffer")}function vh(i){return i.$name||i.constructor._classRegistryKey}function zd(i){return!function(n){if(n===null||typeof n!="object")return!1;const s=vh(n);return!(!s||s==="Object")}(i)&&(i==null||typeof i=="boolean"||typeof i=="number"||typeof i=="string"||i instanceof Boolean||i instanceof Number||i instanceof String||i instanceof Date||i instanceof RegExp||i instanceof Blob||i instanceof Error||nc(i)||zt(i)||ArrayBuffer.isView(i)||i instanceof ImageData)}function _l(i,n){if(zd(i))return(nc(i)||zt(i))&&n&&n.push(i),ArrayBuffer.isView(i)&&n&&n.push(i.buffer),i instanceof ImageData&&n&&n.push(i.data.buffer),i;if(Array.isArray(i)){const v=[];for(const x of i)v.push(_l(x,n));return v}if(typeof i!="object")throw new Error("can't serialize object of type "+typeof i);const s=vh(i);if(!s)throw new Error(`can't serialize object of unregistered class ${i.constructor.name}`);if(!ri[s])throw new Error(`${s} is not registered.`);const{klass:l}=ri[s],p=l.serialize?l.serialize(i,n):{};if(l.serialize){if(n&&p===n[n.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const v in i){if(!i.hasOwnProperty(v)||ri[s].omit.indexOf(v)>=0)continue;const x=i[v];p[v]=ri[s].shallow.indexOf(v)>=0?x:_l(x,n)}i instanceof Error&&(p.message=i.message)}if(p.$name)throw new Error("$name property is reserved for worker serialization logic.");return s!=="Object"&&(p.$name=s),p}function xo(i){if(zd(i))return i;if(Array.isArray(i))return i.map(xo);if(typeof i!="object")throw new Error("can't deserialize object of type "+typeof i);const n=vh(i)||"Object";if(!ri[n])throw new Error(`can't deserialize unregistered class ${n}`);const{klass:s}=ri[n];if(!s)throw new Error(`can't deserialize unregistered class ${n}`);if(s.deserialize)return s.deserialize(i);const l=Object.create(s.prototype);for(const p of Object.keys(i)){if(p==="$name")continue;const v=i[p];l[p]=ri[n].shallow.indexOf(p)>=0?v:xo(v)}return l}class Pa{constructor(){this.first=!0}update(n,s){const l=Math.floor(n);return this.first?(this.first=!1,this.lastIntegerZoom=l,this.lastIntegerZoomTime=0,this.lastZoom=n,this.lastFloorZoom=l,!0):(this.lastFloorZoom>l?(this.lastIntegerZoom=l+1,this.lastIntegerZoomTime=s):this.lastFloorZoom<l&&(this.lastIntegerZoom=l,this.lastIntegerZoomTime=s),n!==this.lastZoom&&(this.lastZoom=n,this.lastFloorZoom=l,!0))}}const mn={"Latin-1 Supplement":i=>i>=128&&i<=255,"Hangul Jamo":i=>i>=4352&&i<=4607,Khmer:i=>i>=6016&&i<=6143,"General Punctuation":i=>i>=8192&&i<=8303,"Letterlike Symbols":i=>i>=8448&&i<=8527,"Number Forms":i=>i>=8528&&i<=8591,"Miscellaneous Technical":i=>i>=8960&&i<=9215,"Control Pictures":i=>i>=9216&&i<=9279,"Optical Character Recognition":i=>i>=9280&&i<=9311,"Enclosed Alphanumerics":i=>i>=9312&&i<=9471,"Geometric Shapes":i=>i>=9632&&i<=9727,"Miscellaneous Symbols":i=>i>=9728&&i<=9983,"Miscellaneous Symbols and Arrows":i=>i>=11008&&i<=11263,"Ideographic Description Characters":i=>i>=12272&&i<=12287,"CJK Symbols and Punctuation":i=>i>=12288&&i<=12351,Katakana:i=>i>=12448&&i<=12543,Kanbun:i=>i>=12688&&i<=12703,"CJK Strokes":i=>i>=12736&&i<=12783,"Enclosed CJK Letters and Months":i=>i>=12800&&i<=13055,"CJK Compatibility":i=>i>=13056&&i<=13311,"Yijing Hexagram Symbols":i=>i>=19904&&i<=19967,"Private Use Area":i=>i>=57344&&i<=63743,"Vertical Forms":i=>i>=65040&&i<=65055,"CJK Compatibility Forms":i=>i>=65072&&i<=65103,"Small Form Variants":i=>i>=65104&&i<=65135,"Halfwidth and Fullwidth Forms":i=>i>=65280&&i<=65519};function H(i){for(const n of i)if(xh(n.charCodeAt(0)))return!0;return!1}function yl(i){for(const n of i)if(!ln(n.charCodeAt(0)))return!1;return!0}function vl(i){const n=i.map(s=>{try{return new RegExp(`\\p{sc=${s}}`,"u").source}catch{return null}}).filter(s=>s);return new RegExp(n.join("|"),"u")}const fs=vl(["Arab","Dupl","Mong","Ougr","Syrc"]);function ln(i){return!fs.test(String.fromCodePoint(i))}const Dd=vl(["Bopo","Hani","Hira","Kana","Kits","Nshu","Tang","Yiii"]);function xh(i){return!(i!==746&&i!==747&&(i<4352||!(mn["CJK Compatibility Forms"](i)&&!(i>=65097&&i<=65103)||mn["CJK Compatibility"](i)||mn["CJK Strokes"](i)||!(!mn["CJK Symbols and Punctuation"](i)||i>=12296&&i<=12305||i>=12308&&i<=12319||i===12336)||mn["Enclosed CJK Letters and Months"](i)||mn["Ideographic Description Characters"](i)||mn.Kanbun(i)||mn.Katakana(i)&&i!==12540||!(!mn["Halfwidth and Fullwidth Forms"](i)||i===65288||i===65289||i===65293||i>=65306&&i<=65310||i===65339||i===65341||i===65343||i>=65371&&i<=65503||i===65507||i>=65512&&i<=65519)||!(!mn["Small Form Variants"](i)||i>=65112&&i<=65118||i>=65123&&i<=65126)||mn["Vertical Forms"](i)||mn["Yijing Hexagram Symbols"](i)||new RegExp("\\p{sc=Cans}","u").test(String.fromCodePoint(i))||new RegExp("\\p{sc=Hang}","u").test(String.fromCodePoint(i))||Dd.test(String.fromCodePoint(i)))))}function Ld(i){return!(xh(i)||function(n){return!!(mn["Latin-1 Supplement"](n)&&(n===167||n===169||n===174||n===177||n===188||n===189||n===190||n===215||n===247)||mn["General Punctuation"](n)&&(n===8214||n===8224||n===8225||n===8240||n===8241||n===8251||n===8252||n===8258||n===8263||n===8264||n===8265||n===8273)||mn["Letterlike Symbols"](n)||mn["Number Forms"](n)||mn["Miscellaneous Technical"](n)&&(n>=8960&&n<=8967||n>=8972&&n<=8991||n>=8996&&n<=9e3||n===9003||n>=9085&&n<=9114||n>=9150&&n<=9165||n===9167||n>=9169&&n<=9179||n>=9186&&n<=9215)||mn["Control Pictures"](n)&&n!==9251||mn["Optical Character Recognition"](n)||mn["Enclosed Alphanumerics"](n)||mn["Geometric Shapes"](n)||mn["Miscellaneous Symbols"](n)&&!(n>=9754&&n<=9759)||mn["Miscellaneous Symbols and Arrows"](n)&&(n>=11026&&n<=11055||n>=11088&&n<=11097||n>=11192&&n<=11243)||mn["CJK Symbols and Punctuation"](n)||mn.Katakana(n)||mn["Private Use Area"](n)||mn["CJK Compatibility Forms"](n)||mn["Small Form Variants"](n)||mn["Halfwidth and Fullwidth Forms"](n)||n===8734||n===8756||n===8757||n>=9984&&n<=10087||n>=10102&&n<=10131||n===65532||n===65533)}(i))}const Aa=vl(["Adlm","Arab","Armi","Avst","Chrs","Cprt","Egyp","Elym","Gara","Hatr","Hebr","Hung","Khar","Lydi","Mand","Mani","Mend","Merc","Mero","Narb","Nbat","Nkoo","Orkh","Palm","Phli","Phlp","Phnx","Prti","Rohg","Samr","Sarb","Sogo","Syrc","Thaa","Todr","Yezi"]);function wh(i){return Aa.test(String.fromCodePoint(i))}function ap(i,n){return!(!n&&wh(i)||i>=2304&&i<=3583||i>=3840&&i<=4255||mn.Khmer(i))}function lp(i){for(const n of i)if(wh(n.charCodeAt(0)))return!0;return!1}const Ki=new class{constructor(){this.applyArabicShaping=null,this.processBidirectionalText=null,this.processStyledBidirectionalText=null,this.pluginStatus="unavailable",this.pluginURL=null}setState(i){this.pluginStatus=i.pluginStatus,this.pluginURL=i.pluginURL}getState(){return{pluginStatus:this.pluginStatus,pluginURL:this.pluginURL}}setMethods(i){this.applyArabicShaping=i.applyArabicShaping,this.processBidirectionalText=i.processBidirectionalText,this.processStyledBidirectionalText=i.processStyledBidirectionalText}isParsed(){return this.applyArabicShaping!=null&&this.processBidirectionalText!=null&&this.processStyledBidirectionalText!=null}getPluginURL(){return this.pluginURL}getRTLTextPluginStatus(){return this.pluginStatus}};class ar{constructor(n,s){this.zoom=n,s?(this.now=s.now,this.fadeDuration=s.fadeDuration,this.zoomHistory=s.zoomHistory,this.transition=s.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Pa,this.transition={})}isSupportedScript(n){return function(s,l){for(const p of s)if(!ap(p.charCodeAt(0),l))return!1;return!0}(n,Ki.getRTLTextPluginStatus()==="loaded")}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const n=this.zoom,s=n-Math.floor(n),l=this.crossFadingFactor();return n>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:s+(1-s)*l}:{fromScale:.5,toScale:1,t:1-(1-l)*s}}}class Oi{constructor(n,s){this.property=n,this.value=s,this.expression=function(l,p){if(Yu(l))return new Go(l,p);if(Tt(l)){const v=Hn(l,p);if(v.result==="error")throw new Error(v.value.map(x=>`${x.key}: ${x.message}`).join(", "));return v.value}{let v=l;return p.type==="color"&&typeof l=="string"?v=Ln.parse(l):p.type!=="padding"||typeof l!="number"&&!Array.isArray(l)?p.type==="variableAnchorOffsetCollection"&&Array.isArray(l)&&(v=Wi.parse(l)):v=zi.parse(l),{kind:"constant",evaluate:()=>v}}}(s===void 0?n.specification.default:s,n.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(n,s,l){return this.property.possiblyEvaluate(this,n,s,l)}}class rc{constructor(n){this.property=n,this.value=new Oi(n,void 0)}transitioned(n,s){return new Rd(this.property,this.value,s,ve({},n.transition,this.transition),n.now)}untransitioned(){return new Rd(this.property,this.value,null,{},0)}}class ic{constructor(n){this._properties=n,this._values=Object.create(n.defaultTransitionablePropertyValues)}getValue(n){return Ue(this._values[n].value.value)}setValue(n,s){Object.prototype.hasOwnProperty.call(this._values,n)||(this._values[n]=new rc(this._values[n].property)),this._values[n].value=new Oi(this._values[n].property,s===null?void 0:Ue(s))}getTransition(n){return Ue(this._values[n].transition)}setTransition(n,s){Object.prototype.hasOwnProperty.call(this._values,n)||(this._values[n]=new rc(this._values[n].property)),this._values[n].transition=Ue(s)||void 0}serialize(){const n={};for(const s of Object.keys(this._values)){const l=this.getValue(s);l!==void 0&&(n[s]=l);const p=this.getTransition(s);p!==void 0&&(n[`${s}-transition`]=p)}return n}transitioned(n,s){const l=new tu(this._properties);for(const p of Object.keys(this._values))l._values[p]=this._values[p].transitioned(n,s._values[p]);return l}untransitioned(){const n=new tu(this._properties);for(const s of Object.keys(this._values))n._values[s]=this._values[s].untransitioned();return n}}class Rd{constructor(n,s,l,p,v){this.property=n,this.value=s,this.begin=v+p.delay||0,this.end=this.begin+p.duration||0,n.specification.transition&&(p.delay||p.duration)&&(this.prior=l)}possiblyEvaluate(n,s,l){const p=n.now||0,v=this.value.possiblyEvaluate(n,s,l),x=this.prior;if(x){if(p>this.end)return this.prior=null,v;if(this.value.isDataDriven())return this.prior=null,v;if(p<this.begin)return x.possiblyEvaluate(n,s,l);{const S=(p-this.begin)/(this.end-this.begin);return this.property.interpolate(x.possiblyEvaluate(n,s,l),v,function(C){if(C<=0)return 0;if(C>=1)return 1;const P=C*C,M=P*C;return 4*(C<.5?M:3*(C-P)+M-.75)}(S))}}return v}}class tu{constructor(n){this._properties=n,this._values=Object.create(n.defaultTransitioningPropertyValues)}possiblyEvaluate(n,s,l){const p=new ru(this._properties);for(const v of Object.keys(this._values))p._values[v]=this._values[v].possiblyEvaluate(n,s,l);return p}hasTransition(){for(const n of Object.keys(this._values))if(this._values[n].prior)return!0;return!1}}class nu{constructor(n){this._properties=n,this._values=Object.create(n.defaultPropertyValues)}hasValue(n){return this._values[n].value!==void 0}getValue(n){return Ue(this._values[n].value)}setValue(n,s){this._values[n]=new Oi(this._values[n].property,s===null?void 0:Ue(s))}serialize(){const n={};for(const s of Object.keys(this._values)){const l=this.getValue(s);l!==void 0&&(n[s]=l)}return n}possiblyEvaluate(n,s,l){const p=new ru(this._properties);for(const v of Object.keys(this._values))p._values[v]=this._values[v].possiblyEvaluate(n,s,l);return p}}class Jr{constructor(n,s,l){this.property=n,this.value=s,this.parameters=l}isConstant(){return this.value.kind==="constant"}constantOr(n){return this.value.kind==="constant"?this.value.value:n}evaluate(n,s,l,p){return this.property.evaluate(this.value,this.parameters,n,s,l,p)}}class ru{constructor(n){this._properties=n,this._values=Object.create(n.defaultPossiblyEvaluatedValues)}get(n){return this._values[n]}}class Ct{constructor(n){this.specification=n}possiblyEvaluate(n,s){if(n.isDataDriven())throw new Error("Value should not be data driven");return n.expression.evaluate(s)}interpolate(n,s,l){const p=Li[this.specification.type];return p?p(n,s,l):n}}class Ft{constructor(n,s){this.specification=n,this.overrides=s}possiblyEvaluate(n,s,l,p){return new Jr(this,n.expression.kind==="constant"||n.expression.kind==="camera"?{kind:"constant",value:n.expression.evaluate(s,null,{},l,p)}:n.expression,s)}interpolate(n,s,l){if(n.value.kind!=="constant"||s.value.kind!=="constant")return n;if(n.value.value===void 0||s.value.value===void 0)return new Jr(this,{kind:"constant",value:void 0},n.parameters);const p=Li[this.specification.type];if(p){const v=p(n.value.value,s.value.value,l);return new Jr(this,{kind:"constant",value:v},n.parameters)}return n}evaluate(n,s,l,p,v,x){return n.kind==="constant"?n.value:n.evaluate(s,l,p,v,x)}}class sc extends Ft{possiblyEvaluate(n,s,l,p){if(n.value===void 0)return new Jr(this,{kind:"constant",value:void 0},s);if(n.expression.kind==="constant"){const v=n.expression.evaluate(s,null,{},l,p),x=n.property.specification.type==="resolvedImage"&&typeof v!="string"?v.name:v,S=this._calculate(x,x,x,s);return new Jr(this,{kind:"constant",value:S},s)}if(n.expression.kind==="camera"){const v=this._calculate(n.expression.evaluate({zoom:s.zoom-1}),n.expression.evaluate({zoom:s.zoom}),n.expression.evaluate({zoom:s.zoom+1}),s);return new Jr(this,{kind:"constant",value:v},s)}return new Jr(this,n.expression,s)}evaluate(n,s,l,p,v,x){if(n.kind==="source"){const S=n.evaluate(s,l,p,v,x);return this._calculate(S,S,S,s)}return n.kind==="composite"?this._calculate(n.evaluate({zoom:Math.floor(s.zoom)-1},l,p),n.evaluate({zoom:Math.floor(s.zoom)},l,p),n.evaluate({zoom:Math.floor(s.zoom)+1},l,p),s):n.value}_calculate(n,s,l,p){return p.zoom>p.zoomHistory.lastIntegerZoom?{from:n,to:s}:{from:l,to:s}}interpolate(n){return n}}class oc{constructor(n){this.specification=n}possiblyEvaluate(n,s,l,p){if(n.value!==void 0){if(n.expression.kind==="constant"){const v=n.expression.evaluate(s,null,{},l,p);return this._calculate(v,v,v,s)}return this._calculate(n.expression.evaluate(new ar(Math.floor(s.zoom-1),s)),n.expression.evaluate(new ar(Math.floor(s.zoom),s)),n.expression.evaluate(new ar(Math.floor(s.zoom+1),s)),s)}}_calculate(n,s,l,p){return p.zoom>p.zoomHistory.lastIntegerZoom?{from:n,to:s}:{from:l,to:s}}interpolate(n){return n}}class wo{constructor(n){this.specification=n}possiblyEvaluate(n,s,l,p){return!!n.expression.evaluate(s,null,{},l,p)}interpolate(){return!1}}class y{constructor(n){this.properties=n,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const s in n){const l=n[s];l.specification.overridable&&this.overridableProperties.push(s);const p=this.defaultPropertyValues[s]=new Oi(l,void 0),v=this.defaultTransitionablePropertyValues[s]=new rc(l);this.defaultTransitioningPropertyValues[s]=v.untransitioned(),this.defaultPossiblyEvaluatedValues[s]=p.possiblyEvaluate({})}}}vt("DataDrivenProperty",Ft),vt("DataConstantProperty",Ct),vt("CrossFadedDataDrivenProperty",sc),vt("CrossFadedProperty",oc),vt("ColorRampProperty",wo);const t="-transition";class a extends dn{constructor(n,s){if(super(),this.id=n.id,this.type=n.type,this._featureFilter={filter:()=>!0,needGeometry:!1},n.type!=="custom"&&(this.metadata=n.metadata,this.minzoom=n.minzoom,this.maxzoom=n.maxzoom,n.type!=="background"&&(this.source=n.source,this.sourceLayer=n["source-layer"],this.filter=n.filter),s.layout&&(this._unevaluatedLayout=new nu(s.layout)),s.paint)){this._transitionablePaint=new ic(s.paint);for(const l in n.paint)this.setPaintProperty(l,n.paint[l],{validate:!1});for(const l in n.layout)this.setLayoutProperty(l,n.layout[l],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new ru(s.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(n){return n==="visibility"?this.visibility:this._unevaluatedLayout.getValue(n)}setLayoutProperty(n,s,l={}){s!=null&&this._validate(gl,`layers.${this.id}.layout.${n}`,n,s,l)||(n!=="visibility"?this._unevaluatedLayout.setValue(n,s):this.visibility=s)}getPaintProperty(n){return n.endsWith(t)?this._transitionablePaint.getTransition(n.slice(0,-11)):this._transitionablePaint.getValue(n)}setPaintProperty(n,s,l={}){if(s!=null&&this._validate(Ia,`layers.${this.id}.paint.${n}`,n,s,l))return!1;if(n.endsWith(t))return this._transitionablePaint.setTransition(n.slice(0,-11),s||void 0),!1;{const p=this._transitionablePaint._values[n],v=p.property.specification["property-type"]==="cross-faded-data-driven",x=p.value.isDataDriven(),S=p.value;this._transitionablePaint.setValue(n,s),this._handleSpecialPaintPropertyUpdate(n);const C=this._transitionablePaint._values[n].value;return C.isDataDriven()||x||v||this._handleOverridablePaintPropertyUpdate(n,S,C)}}_handleSpecialPaintPropertyUpdate(n){}_handleOverridablePaintPropertyUpdate(n,s,l){return!1}isHidden(n){return!!(this.minzoom&&n<this.minzoom)||!!(this.maxzoom&&n>=this.maxzoom)||this.visibility==="none"}updateTransitions(n){this._transitioningPaint=this._transitionablePaint.transitioned(n,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(n,s){n.getCrossfadeParameters&&(this._crossfadeParameters=n.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(n,void 0,s)),this.paint=this._transitioningPaint.possiblyEvaluate(n,void 0,s)}serialize(){const n={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(n.layout=n.layout||{},n.layout.visibility=this.visibility),Te(n,(s,l)=>!(s===void 0||l==="layout"&&!Object.keys(s).length||l==="paint"&&!Object.keys(s).length))}_validate(n,s,l,p,v={}){return(!v||v.validate!==!1)&&ka(this,n.call(yo,{key:s,layerType:this.type,objectKey:l,value:p,styleSpec:Ce,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const n in this.paint._values){const s=this.paint.get(n);if(s instanceof Jr&&cl(s.property.specification)&&(s.value.kind==="source"||s.value.kind==="composite")&&s.value.isStateDependent)return!0}return!1}}const d={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class f{constructor(n,s){this._structArray=n,this._pos1=s*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class _{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(n,s){return n._trim(),s&&(n.isTransferred=!0,s.push(n.arrayBuffer)),{length:n.length,arrayBuffer:n.arrayBuffer}}static deserialize(n){const s=Object.create(this.prototype);return s.arrayBuffer=n.arrayBuffer,s.length=n.length,s.capacity=n.arrayBuffer.byteLength/s.bytesPerElement,s._refreshViews(),s}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(n){this.reserve(n),this.length=n}reserve(n){if(n>this.capacity){this.capacity=Math.max(n,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const s=this.uint8;this._refreshViews(),s&&this.uint8.set(s)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function E(i,n=1){let s=0,l=0;return{members:i.map(p=>{const v=d[p.type].BYTES_PER_ELEMENT,x=s=I(s,Math.max(n,v)),S=p.components||1;return l=Math.max(l,v),s+=v*S,{name:p.name,type:p.type,components:S,offset:x}}),size:I(s,Math.max(l,n)),alignment:n}}function I(i,n){return Math.ceil(i/n)*n}class k extends _{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,s){const l=this.length;return this.resize(l+1),this.emplace(l,n,s)}emplace(n,s,l){const p=2*n;return this.int16[p+0]=s,this.int16[p+1]=l,n}}k.prototype.bytesPerElement=4,vt("StructArrayLayout2i4",k);class z extends _{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,s,l){const p=this.length;return this.resize(p+1),this.emplace(p,n,s,l)}emplace(n,s,l,p){const v=3*n;return this.int16[v+0]=s,this.int16[v+1]=l,this.int16[v+2]=p,n}}z.prototype.bytesPerElement=6,vt("StructArrayLayout3i6",z);class R extends _{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,s,l,p){const v=this.length;return this.resize(v+1),this.emplace(v,n,s,l,p)}emplace(n,s,l,p,v){const x=4*n;return this.int16[x+0]=s,this.int16[x+1]=l,this.int16[x+2]=p,this.int16[x+3]=v,n}}R.prototype.bytesPerElement=8,vt("StructArrayLayout4i8",R);class O extends _{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,s,l,p,v,x){const S=this.length;return this.resize(S+1),this.emplace(S,n,s,l,p,v,x)}emplace(n,s,l,p,v,x,S){const C=6*n;return this.int16[C+0]=s,this.int16[C+1]=l,this.int16[C+2]=p,this.int16[C+3]=v,this.int16[C+4]=x,this.int16[C+5]=S,n}}O.prototype.bytesPerElement=12,vt("StructArrayLayout2i4i12",O);class V extends _{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,s,l,p,v,x){const S=this.length;return this.resize(S+1),this.emplace(S,n,s,l,p,v,x)}emplace(n,s,l,p,v,x,S){const C=4*n,P=8*n;return this.int16[C+0]=s,this.int16[C+1]=l,this.uint8[P+4]=p,this.uint8[P+5]=v,this.uint8[P+6]=x,this.uint8[P+7]=S,n}}V.prototype.bytesPerElement=8,vt("StructArrayLayout2i4ub8",V);class X extends _{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,s){const l=this.length;return this.resize(l+1),this.emplace(l,n,s)}emplace(n,s,l){const p=2*n;return this.float32[p+0]=s,this.float32[p+1]=l,n}}X.prototype.bytesPerElement=8,vt("StructArrayLayout2f8",X);class Q extends _{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,s,l,p,v,x,S,C,P,M){const L=this.length;return this.resize(L+1),this.emplace(L,n,s,l,p,v,x,S,C,P,M)}emplace(n,s,l,p,v,x,S,C,P,M,L){const F=10*n;return this.uint16[F+0]=s,this.uint16[F+1]=l,this.uint16[F+2]=p,this.uint16[F+3]=v,this.uint16[F+4]=x,this.uint16[F+5]=S,this.uint16[F+6]=C,this.uint16[F+7]=P,this.uint16[F+8]=M,this.uint16[F+9]=L,n}}Q.prototype.bytesPerElement=20,vt("StructArrayLayout10ui20",Q);class ie extends _{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,s,l,p,v,x,S,C,P,M,L,F){const U=this.length;return this.resize(U+1),this.emplace(U,n,s,l,p,v,x,S,C,P,M,L,F)}emplace(n,s,l,p,v,x,S,C,P,M,L,F,U){const W=12*n;return this.int16[W+0]=s,this.int16[W+1]=l,this.int16[W+2]=p,this.int16[W+3]=v,this.uint16[W+4]=x,this.uint16[W+5]=S,this.uint16[W+6]=C,this.uint16[W+7]=P,this.int16[W+8]=M,this.int16[W+9]=L,this.int16[W+10]=F,this.int16[W+11]=U,n}}ie.prototype.bytesPerElement=24,vt("StructArrayLayout4i4ui4i24",ie);class le extends _{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,s,l){const p=this.length;return this.resize(p+1),this.emplace(p,n,s,l)}emplace(n,s,l,p){const v=3*n;return this.float32[v+0]=s,this.float32[v+1]=l,this.float32[v+2]=p,n}}le.prototype.bytesPerElement=12,vt("StructArrayLayout3f12",le);class ce extends _{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(n){const s=this.length;return this.resize(s+1),this.emplace(s,n)}emplace(n,s){return this.uint32[1*n+0]=s,n}}ce.prototype.bytesPerElement=4,vt("StructArrayLayout1ul4",ce);class me extends _{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,s,l,p,v,x,S,C,P){const M=this.length;return this.resize(M+1),this.emplace(M,n,s,l,p,v,x,S,C,P)}emplace(n,s,l,p,v,x,S,C,P,M){const L=10*n,F=5*n;return this.int16[L+0]=s,this.int16[L+1]=l,this.int16[L+2]=p,this.int16[L+3]=v,this.int16[L+4]=x,this.int16[L+5]=S,this.uint32[F+3]=C,this.uint16[L+8]=P,this.uint16[L+9]=M,n}}me.prototype.bytesPerElement=20,vt("StructArrayLayout6i1ul2ui20",me);class te extends _{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,s,l,p,v,x){const S=this.length;return this.resize(S+1),this.emplace(S,n,s,l,p,v,x)}emplace(n,s,l,p,v,x,S){const C=6*n;return this.int16[C+0]=s,this.int16[C+1]=l,this.int16[C+2]=p,this.int16[C+3]=v,this.int16[C+4]=x,this.int16[C+5]=S,n}}te.prototype.bytesPerElement=12,vt("StructArrayLayout2i2i2i12",te);class xe extends _{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,s,l,p,v){const x=this.length;return this.resize(x+1),this.emplace(x,n,s,l,p,v)}emplace(n,s,l,p,v,x){const S=4*n,C=8*n;return this.float32[S+0]=s,this.float32[S+1]=l,this.float32[S+2]=p,this.int16[C+6]=v,this.int16[C+7]=x,n}}xe.prototype.bytesPerElement=16,vt("StructArrayLayout2f1f2i16",xe);class be extends _{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,s,l,p,v,x){const S=this.length;return this.resize(S+1),this.emplace(S,n,s,l,p,v,x)}emplace(n,s,l,p,v,x,S){const C=16*n,P=4*n,M=8*n;return this.uint8[C+0]=s,this.uint8[C+1]=l,this.float32[P+1]=p,this.float32[P+2]=v,this.int16[M+6]=x,this.int16[M+7]=S,n}}be.prototype.bytesPerElement=16,vt("StructArrayLayout2ub2f2i16",be);class ze extends _{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,s,l){const p=this.length;return this.resize(p+1),this.emplace(p,n,s,l)}emplace(n,s,l,p){const v=3*n;return this.uint16[v+0]=s,this.uint16[v+1]=l,this.uint16[v+2]=p,n}}ze.prototype.bytesPerElement=6,vt("StructArrayLayout3ui6",ze);class qe extends _{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,s,l,p,v,x,S,C,P,M,L,F,U,W,Z,ne,oe){const Pe=this.length;return this.resize(Pe+1),this.emplace(Pe,n,s,l,p,v,x,S,C,P,M,L,F,U,W,Z,ne,oe)}emplace(n,s,l,p,v,x,S,C,P,M,L,F,U,W,Z,ne,oe,Pe){const ge=24*n,_e=12*n,Re=48*n;return this.int16[ge+0]=s,this.int16[ge+1]=l,this.uint16[ge+2]=p,this.uint16[ge+3]=v,this.uint32[_e+2]=x,this.uint32[_e+3]=S,this.uint32[_e+4]=C,this.uint16[ge+10]=P,this.uint16[ge+11]=M,this.uint16[ge+12]=L,this.float32[_e+7]=F,this.float32[_e+8]=U,this.uint8[Re+36]=W,this.uint8[Re+37]=Z,this.uint8[Re+38]=ne,this.uint32[_e+10]=oe,this.int16[ge+22]=Pe,n}}qe.prototype.bytesPerElement=48,vt("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",qe);class Qe extends _{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,s,l,p,v,x,S,C,P,M,L,F,U,W,Z,ne,oe,Pe,ge,_e,Re,Ye,gt,Ot,_t,dt,Pt,xt){const yt=this.length;return this.resize(yt+1),this.emplace(yt,n,s,l,p,v,x,S,C,P,M,L,F,U,W,Z,ne,oe,Pe,ge,_e,Re,Ye,gt,Ot,_t,dt,Pt,xt)}emplace(n,s,l,p,v,x,S,C,P,M,L,F,U,W,Z,ne,oe,Pe,ge,_e,Re,Ye,gt,Ot,_t,dt,Pt,xt,yt){const $e=32*n,At=16*n;return this.int16[$e+0]=s,this.int16[$e+1]=l,this.int16[$e+2]=p,this.int16[$e+3]=v,this.int16[$e+4]=x,this.int16[$e+5]=S,this.int16[$e+6]=C,this.int16[$e+7]=P,this.uint16[$e+8]=M,this.uint16[$e+9]=L,this.uint16[$e+10]=F,this.uint16[$e+11]=U,this.uint16[$e+12]=W,this.uint16[$e+13]=Z,this.uint16[$e+14]=ne,this.uint16[$e+15]=oe,this.uint16[$e+16]=Pe,this.uint16[$e+17]=ge,this.uint16[$e+18]=_e,this.uint16[$e+19]=Re,this.uint16[$e+20]=Ye,this.uint16[$e+21]=gt,this.uint16[$e+22]=Ot,this.uint32[At+12]=_t,this.float32[At+13]=dt,this.float32[At+14]=Pt,this.uint16[$e+30]=xt,this.uint16[$e+31]=yt,n}}Qe.prototype.bytesPerElement=64,vt("StructArrayLayout8i15ui1ul2f2ui64",Qe);class at extends _{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n){const s=this.length;return this.resize(s+1),this.emplace(s,n)}emplace(n,s){return this.float32[1*n+0]=s,n}}at.prototype.bytesPerElement=4,vt("StructArrayLayout1f4",at);class pt extends _{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,s,l){const p=this.length;return this.resize(p+1),this.emplace(p,n,s,l)}emplace(n,s,l,p){const v=3*n;return this.uint16[6*n+0]=s,this.float32[v+1]=l,this.float32[v+2]=p,n}}pt.prototype.bytesPerElement=12,vt("StructArrayLayout1ui2f12",pt);class st extends _{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,s,l){const p=this.length;return this.resize(p+1),this.emplace(p,n,s,l)}emplace(n,s,l,p){const v=4*n;return this.uint32[2*n+0]=s,this.uint16[v+2]=l,this.uint16[v+3]=p,n}}st.prototype.bytesPerElement=8,vt("StructArrayLayout1ul2ui8",st);class ot extends _{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,s){const l=this.length;return this.resize(l+1),this.emplace(l,n,s)}emplace(n,s,l){const p=2*n;return this.uint16[p+0]=s,this.uint16[p+1]=l,n}}ot.prototype.bytesPerElement=4,vt("StructArrayLayout2ui4",ot);class wt extends _{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n){const s=this.length;return this.resize(s+1),this.emplace(s,n)}emplace(n,s){return this.uint16[1*n+0]=s,n}}wt.prototype.bytesPerElement=2,vt("StructArrayLayout1ui2",wt);class Wt extends _{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,s,l,p){const v=this.length;return this.resize(v+1),this.emplace(v,n,s,l,p)}emplace(n,s,l,p,v){const x=4*n;return this.float32[x+0]=s,this.float32[x+1]=l,this.float32[x+2]=p,this.float32[x+3]=v,n}}Wt.prototype.bytesPerElement=16,vt("StructArrayLayout4f16",Wt);class ht extends f{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new G(this.anchorPointX,this.anchorPointY)}}ht.prototype.size=20;class tt extends me{get(n){return new ht(this,n)}}vt("CollisionBoxArray",tt);class jt extends f{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(n){this._structArray.uint8[this._pos1+37]=n}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(n){this._structArray.uint8[this._pos1+38]=n}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(n){this._structArray.uint32[this._pos4+10]=n}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}jt.prototype.size=48;class sr extends qe{get(n){return new jt(this,n)}}vt("PlacedSymbolArray",sr);class $t extends f{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(n){this._structArray.uint32[this._pos4+12]=n}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}$t.prototype.size=64;class un extends Qe{get(n){return new $t(this,n)}}vt("SymbolInstanceArray",un);class Xn extends at{getoffsetX(n){return this.float32[1*n+0]}}vt("GlyphOffsetArray",Xn);class Cr extends z{getx(n){return this.int16[3*n+0]}gety(n){return this.int16[3*n+1]}gettileUnitDistanceFromAnchor(n){return this.int16[3*n+2]}}vt("SymbolLineVertexArray",Cr);class ps extends f{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}ps.prototype.size=12;class hn extends pt{get(n){return new ps(this,n)}}vt("TextAnchorOffsetArray",hn);class fi extends f{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}fi.prototype.size=8;class Ci extends st{get(n){return new fi(this,n)}}vt("FeatureIndexArray",Ci);class pi extends k{}class Ii extends k{}class ms extends k{}class xl extends O{}class Ko extends V{}class Ma extends X{}class gs extends Q{}class ac extends ie{}class za extends le{}class _s extends ce{}class ys extends te{}class eo extends be{}class vs extends ze{}class ii extends ot{}const mi=E([{name:"a_pos",components:2,type:"Int16"}],4),{members:Yi}=mi;class gn{constructor(n=[]){this.segments=n}prepareSegment(n,s,l,p){let v=this.segments[this.segments.length-1];return n>gn.MAX_VERTEX_ARRAY_LENGTH&&mt(`Max vertices per segment is ${gn.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${n}`),(!v||v.vertexLength+n>gn.MAX_VERTEX_ARRAY_LENGTH||v.sortKey!==p)&&(v={vertexOffset:s.length,primitiveOffset:l.length,vertexLength:0,primitiveLength:0},p!==void 0&&(v.sortKey=p),this.segments.push(v)),v}get(){return this.segments}destroy(){for(const n of this.segments)for(const s in n.vaos)n.vaos[s].destroy()}static simpleSegment(n,s,l,p){return new gn([{vertexOffset:n,primitiveOffset:s,vertexLength:l,primitiveLength:p,vaos:{},sortKey:0}])}}function bo(i,n){return 256*(i=Ze(Math.floor(i),0,255))+Ze(Math.floor(n),0,255)}gn.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,vt("SegmentVector",gn);const wl=E([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var Yo={exports:{}},bh={exports:{}};bh.exports=function(i,n){var s,l,p,v,x,S,C,P;for(l=i.length-(s=3&i.length),p=n,x=3432918353,S=461845907,P=0;P<l;)C=255&i.charCodeAt(P)|(255&i.charCodeAt(++P))<<8|(255&i.charCodeAt(++P))<<16|(255&i.charCodeAt(++P))<<24,++P,p=27492+(65535&(v=5*(65535&(p=(p^=C=(65535&(C=(C=(65535&C)*x+(((C>>>16)*x&65535)<<16)&4294967295)<<15|C>>>17))*S+(((C>>>16)*S&65535)<<16)&4294967295)<<13|p>>>19))+((5*(p>>>16)&65535)<<16)&4294967295))+((58964+(v>>>16)&65535)<<16);switch(C=0,s){case 3:C^=(255&i.charCodeAt(P+2))<<16;case 2:C^=(255&i.charCodeAt(P+1))<<8;case 1:p^=C=(65535&(C=(C=(65535&(C^=255&i.charCodeAt(P)))*x+(((C>>>16)*x&65535)<<16)&4294967295)<<15|C>>>17))*S+(((C>>>16)*S&65535)<<16)&4294967295}return p^=i.length,p=2246822507*(65535&(p^=p>>>16))+((2246822507*(p>>>16)&65535)<<16)&4294967295,p=3266489909*(65535&(p^=p>>>13))+((3266489909*(p>>>16)&65535)<<16)&4294967295,(p^=p>>>16)>>>0};var Od=bh.exports,Sh={exports:{}};Sh.exports=function(i,n){for(var s,l=i.length,p=n^l,v=0;l>=4;)s=1540483477*(65535&(s=255&i.charCodeAt(v)|(255&i.charCodeAt(++v))<<8|(255&i.charCodeAt(++v))<<16|(255&i.charCodeAt(++v))<<24))+((1540483477*(s>>>16)&65535)<<16),p=1540483477*(65535&p)+((1540483477*(p>>>16)&65535)<<16)^(s=1540483477*(65535&(s^=s>>>24))+((1540483477*(s>>>16)&65535)<<16)),l-=4,++v;switch(l){case 3:p^=(255&i.charCodeAt(v+2))<<16;case 2:p^=(255&i.charCodeAt(v+1))<<8;case 1:p=1540483477*(65535&(p^=255&i.charCodeAt(v)))+((1540483477*(p>>>16)&65535)<<16)}return p=1540483477*(65535&(p^=p>>>13))+((1540483477*(p>>>16)&65535)<<16),(p^=p>>>15)>>>0};var Fs=Od,Fd=Sh.exports;Yo.exports=Fs,Yo.exports.murmur3=Fs,Yo.exports.murmur2=Fd;var iu=D(Yo.exports);class bl{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(n,s,l,p){this.ids.push(lc(n)),this.positions.push(s,l,p)}getPositions(n){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const s=lc(n);let l=0,p=this.ids.length-1;for(;l<p;){const x=l+p>>1;this.ids[x]>=s?p=x:l=x+1}const v=[];for(;this.ids[l]===s;)v.push({index:this.positions[3*l],start:this.positions[3*l+1],end:this.positions[3*l+2]}),l++;return v}static serialize(n,s){const l=new Float64Array(n.ids),p=new Uint32Array(n.positions);return su(l,p,0,l.length-1),s&&s.push(l.buffer,p.buffer),{ids:l,positions:p}}static deserialize(n){const s=new bl;return s.ids=n.ids,s.positions=n.positions,s.indexed=!0,s}}function lc(i){const n=+i;return!isNaN(n)&&n<=Number.MAX_SAFE_INTEGER?n:iu(String(i))}function su(i,n,s,l){for(;s<l;){const p=i[s+l>>1];let v=s-1,x=l+1;for(;;){do v++;while(i[v]<p);do x--;while(i[x]>p);if(v>=x)break;Sl(i,v,x),Sl(n,3*v,3*x),Sl(n,3*v+1,3*x+1),Sl(n,3*v+2,3*x+2)}x-s<l-x?(su(i,n,s,x),s=x+1):(su(i,n,x+1,l),l=x)}}function Sl(i,n,s){const l=i[n];i[n]=i[s],i[s]=l}vt("FeaturePositionMap",bl);class Da{constructor(n,s){this.gl=n.gl,this.location=s}}class Th extends Da{constructor(n,s){super(n,s),this.current=0}set(n){this.current!==n&&(this.current=n,this.gl.uniform1f(this.location,n))}}class Bd extends Da{constructor(n,s){super(n,s),this.current=[0,0,0,0]}set(n){n[0]===this.current[0]&&n[1]===this.current[1]&&n[2]===this.current[2]&&n[3]===this.current[3]||(this.current=n,this.gl.uniform4f(this.location,n[0],n[1],n[2],n[3]))}}class eg extends Da{constructor(n,s){super(n,s),this.current=Ln.transparent}set(n){n.r===this.current.r&&n.g===this.current.g&&n.b===this.current.b&&n.a===this.current.a||(this.current=n,this.gl.uniform4f(this.location,n.r,n.g,n.b,n.a))}}const up=new Float32Array(16);function _n(i){return[bo(255*i.r,255*i.g),bo(255*i.b,255*i.a)]}class Eh{constructor(n,s,l){this.value=n,this.uniformNames=s.map(p=>`u_${p}`),this.type=l}setUniform(n,s,l){n.set(l.constantOr(this.value))}getBinding(n,s,l){return this.type==="color"?new eg(n,s):new Th(n,s)}}class uc{constructor(n,s){this.uniformNames=s.map(l=>`u_${l}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(n,s){this.pixelRatioFrom=s.pixelRatio,this.pixelRatioTo=n.pixelRatio,this.patternFrom=s.tlbr,this.patternTo=n.tlbr}setUniform(n,s,l,p){const v=p==="u_pattern_to"?this.patternTo:p==="u_pattern_from"?this.patternFrom:p==="u_pixel_ratio_to"?this.pixelRatioTo:p==="u_pixel_ratio_from"?this.pixelRatioFrom:null;v&&n.set(v)}getBinding(n,s,l){return l.substr(0,9)==="u_pattern"?new Bd(n,s):new Th(n,s)}}class Bs{constructor(n,s,l,p){this.expression=n,this.type=l,this.maxValue=0,this.paintVertexAttributes=s.map(v=>({name:`a_${v}`,type:"Float32",components:l==="color"?2:1,offset:0})),this.paintVertexArray=new p}populatePaintArray(n,s,l,p,v){const x=this.paintVertexArray.length,S=this.expression.evaluate(new ar(0),s,{},p,[],v);this.paintVertexArray.resize(n),this._setPaintValue(x,n,S)}updatePaintArray(n,s,l,p){const v=this.expression.evaluate({zoom:0},l,p);this._setPaintValue(n,s,v)}_setPaintValue(n,s,l){if(this.type==="color"){const p=_n(l);for(let v=n;v<s;v++)this.paintVertexArray.emplace(v,p[0],p[1])}else{for(let p=n;p<s;p++)this.paintVertexArray.emplace(p,l);this.maxValue=Math.max(this.maxValue,Math.abs(l))}}upload(n){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=n.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class to{constructor(n,s,l,p,v,x){this.expression=n,this.uniformNames=s.map(S=>`u_${S}_t`),this.type=l,this.useIntegerZoom=p,this.zoom=v,this.maxValue=0,this.paintVertexAttributes=s.map(S=>({name:`a_${S}`,type:"Float32",components:l==="color"?4:2,offset:0})),this.paintVertexArray=new x}populatePaintArray(n,s,l,p,v){const x=this.expression.evaluate(new ar(this.zoom),s,{},p,[],v),S=this.expression.evaluate(new ar(this.zoom+1),s,{},p,[],v),C=this.paintVertexArray.length;this.paintVertexArray.resize(n),this._setPaintValue(C,n,x,S)}updatePaintArray(n,s,l,p){const v=this.expression.evaluate({zoom:this.zoom},l,p),x=this.expression.evaluate({zoom:this.zoom+1},l,p);this._setPaintValue(n,s,v,x)}_setPaintValue(n,s,l,p){if(this.type==="color"){const v=_n(l),x=_n(p);for(let S=n;S<s;S++)this.paintVertexArray.emplace(S,v[0],v[1],x[0],x[1])}else{for(let v=n;v<s;v++)this.paintVertexArray.emplace(v,l,p);this.maxValue=Math.max(this.maxValue,Math.abs(l),Math.abs(p))}}upload(n){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=n.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(n,s){const l=this.useIntegerZoom?Math.floor(s.zoom):s.zoom,p=Ze(this.expression.interpolationFactor(l,this.zoom,this.zoom+1),0,1);n.set(p)}getBinding(n,s,l){return new Th(n,s)}}class Tl{constructor(n,s,l,p,v,x){this.expression=n,this.type=s,this.useIntegerZoom=l,this.zoom=p,this.layerId=x,this.zoomInPaintVertexArray=new v,this.zoomOutPaintVertexArray=new v}populatePaintArray(n,s,l){const p=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(n),this.zoomOutPaintVertexArray.resize(n),this._setPaintValues(p,n,s.patterns&&s.patterns[this.layerId],l)}updatePaintArray(n,s,l,p,v){this._setPaintValues(n,s,l.patterns&&l.patterns[this.layerId],v)}_setPaintValues(n,s,l,p){if(!p||!l)return;const{min:v,mid:x,max:S}=l,C=p[v],P=p[x],M=p[S];if(C&&P&&M)for(let L=n;L<s;L++)this.zoomInPaintVertexArray.emplace(L,P.tl[0],P.tl[1],P.br[0],P.br[1],C.tl[0],C.tl[1],C.br[0],C.br[1],P.pixelRatio,C.pixelRatio),this.zoomOutPaintVertexArray.emplace(L,P.tl[0],P.tl[1],P.br[0],P.br[1],M.tl[0],M.tl[1],M.br[0],M.br[1],P.pixelRatio,M.pixelRatio)}upload(n){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=n.createVertexBuffer(this.zoomInPaintVertexArray,wl.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=n.createVertexBuffer(this.zoomOutPaintVertexArray,wl.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class tg{constructor(n,s,l){this.binders={},this._buffers=[];const p=[];for(const v in n.paint._values){if(!l(v))continue;const x=n.paint.get(v);if(!(x instanceof Jr&&cl(x.property.specification)))continue;const S=oy(v,n.type),C=x.value,P=x.property.specification.type,M=x.property.useIntegerZoom,L=x.property.specification["property-type"],F=L==="cross-faded"||L==="cross-faded-data-driven";if(C.kind==="constant")this.binders[v]=F?new uc(C.value,S):new Eh(C.value,S,P),p.push(`/u_${v}`);else if(C.kind==="source"||F){const U=Ch(v,P,"source");this.binders[v]=F?new Tl(C,P,M,s,U,n.id):new Bs(C,S,P,U),p.push(`/a_${v}`)}else{const U=Ch(v,P,"composite");this.binders[v]=new to(C,S,P,M,s,U),p.push(`/z_${v}`)}}this.cacheKey=p.sort().join("")}getMaxValue(n){const s=this.binders[n];return s instanceof Bs||s instanceof to?s.maxValue:0}populatePaintArrays(n,s,l,p,v){for(const x in this.binders){const S=this.binders[x];(S instanceof Bs||S instanceof to||S instanceof Tl)&&S.populatePaintArray(n,s,l,p,v)}}setConstantPatternPositions(n,s){for(const l in this.binders){const p=this.binders[l];p instanceof uc&&p.setConstantPatternPositions(n,s)}}updatePaintArrays(n,s,l,p,v){let x=!1;for(const S in n){const C=s.getPositions(S);for(const P of C){const M=l.feature(P.index);for(const L in this.binders){const F=this.binders[L];if((F instanceof Bs||F instanceof to||F instanceof Tl)&&F.expression.isStateDependent===!0){const U=p.paint.get(L);F.expression=U.value,F.updatePaintArray(P.start,P.end,M,n[S],v),x=!0}}}}return x}defines(){const n=[];for(const s in this.binders){const l=this.binders[s];(l instanceof Eh||l instanceof uc)&&n.push(...l.uniformNames.map(p=>`#define HAS_UNIFORM_${p}`))}return n}getBinderAttributes(){const n=[];for(const s in this.binders){const l=this.binders[s];if(l instanceof Bs||l instanceof to)for(let p=0;p<l.paintVertexAttributes.length;p++)n.push(l.paintVertexAttributes[p].name);else if(l instanceof Tl)for(let p=0;p<wl.members.length;p++)n.push(wl.members[p].name)}return n}getBinderUniforms(){const n=[];for(const s in this.binders){const l=this.binders[s];if(l instanceof Eh||l instanceof uc||l instanceof to)for(const p of l.uniformNames)n.push(p)}return n}getPaintVertexBuffers(){return this._buffers}getUniforms(n,s){const l=[];for(const p in this.binders){const v=this.binders[p];if(v instanceof Eh||v instanceof uc||v instanceof to){for(const x of v.uniformNames)if(s[x]){const S=v.getBinding(n,s[x],x);l.push({name:x,property:p,binding:S})}}}return l}setUniforms(n,s,l,p){for(const{name:v,property:x,binding:S}of s)this.binders[x].setUniform(S,p,l.get(x),v)}updatePaintBuffers(n){this._buffers=[];for(const s in this.binders){const l=this.binders[s];if(n&&l instanceof Tl){const p=n.fromScale===2?l.zoomInPaintVertexBuffer:l.zoomOutPaintVertexBuffer;p&&this._buffers.push(p)}else(l instanceof Bs||l instanceof to)&&l.paintVertexBuffer&&this._buffers.push(l.paintVertexBuffer)}}upload(n){for(const s in this.binders){const l=this.binders[s];(l instanceof Bs||l instanceof to||l instanceof Tl)&&l.upload(n)}this.updatePaintBuffers()}destroy(){for(const n in this.binders){const s=this.binders[n];(s instanceof Bs||s instanceof to||s instanceof Tl)&&s.destroy()}}}class gi{constructor(n,s,l=()=>!0){this.programConfigurations={};for(const p of n)this.programConfigurations[p.id]=new tg(p,s,l);this.needsUpload=!1,this._featureMap=new bl,this._bufferOffset=0}populatePaintArrays(n,s,l,p,v,x){for(const S in this.programConfigurations)this.programConfigurations[S].populatePaintArrays(n,s,p,v,x);s.id!==void 0&&this._featureMap.add(s.id,l,this._bufferOffset,n),this._bufferOffset=n,this.needsUpload=!0}updatePaintArrays(n,s,l,p){for(const v of l)this.needsUpload=this.programConfigurations[v.id].updatePaintArrays(n,this._featureMap,s,v,p)||this.needsUpload}get(n){return this.programConfigurations[n]}upload(n){if(this.needsUpload){for(const s in this.programConfigurations)this.programConfigurations[s].upload(n);this.needsUpload=!1}}destroy(){for(const n in this.programConfigurations)this.programConfigurations[n].destroy()}}function oy(i,n){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[i]||[i.replace(`${n}-`,"").replace(/-/g,"_")]}function Ch(i,n,s){const l={color:{source:X,composite:Wt},number:{source:at,composite:X}},p=function(v){return{"line-pattern":{source:gs,composite:gs},"fill-pattern":{source:gs,composite:gs},"fill-extrusion-pattern":{source:gs,composite:gs}}[v]}(i);return p&&p[s]||l[n][s]}vt("ConstantBinder",Eh),vt("CrossFadedConstantBinder",uc),vt("SourceExpressionBinder",Bs),vt("CrossFadedCompositeBinder",Tl),vt("CompositeExpressionBinder",to),vt("ProgramConfiguration",tg,{omit:["_buffers"]}),vt("ProgramConfigurationSet",gi);const Ir=8192,Nd=Math.pow(2,14)-1,cp=-Nd-1;function si(i){const n=Ir/i.extent,s=i.loadGeometry();for(let l=0;l<s.length;l++){const p=s[l];for(let v=0;v<p.length;v++){const x=p[v],S=Math.round(x.x*n),C=Math.round(x.y*n);x.x=Ze(S,cp,Nd),x.y=Ze(C,cp,Nd),(S<x.x||S>x.x+1||C<x.y||C>x.y+1)&&mt("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return s}function xs(i,n){return{type:i.type,id:i.id,properties:i.properties,geometry:n?si(i):[]}}function cc(i,n,s,l,p){i.emplaceBack(2*n+(l+1)/2,2*s+(p+1)/2)}class Ud{constructor(n){this.zoom=n.zoom,this.overscaling=n.overscaling,this.layers=n.layers,this.layerIds=this.layers.map(s=>s.id),this.index=n.index,this.hasPattern=!1,this.layoutVertexArray=new Ii,this.indexArray=new vs,this.segments=new gn,this.programConfigurations=new gi(n.layers,n.zoom),this.stateDependentLayerIds=this.layers.filter(s=>s.isStateDependent()).map(s=>s.id)}populate(n,s,l){const p=this.layers[0],v=[];let x=null,S=!1;p.type==="circle"&&(x=p.layout.get("circle-sort-key"),S=!x.isConstant());for(const{feature:C,id:P,index:M,sourceLayerIndex:L}of n){const F=this.layers[0]._featureFilter.needGeometry,U=xs(C,F);if(!this.layers[0]._featureFilter.filter(new ar(this.zoom),U,l))continue;const W=S?x.evaluate(U,{},l):void 0,Z={id:P,properties:C.properties,type:C.type,sourceLayerIndex:L,index:M,geometry:F?U.geometry:si(C),patterns:{},sortKey:W};v.push(Z)}S&&v.sort((C,P)=>C.sortKey-P.sortKey);for(const C of v){const{geometry:P,index:M,sourceLayerIndex:L}=C,F=n[M].feature;this.addFeature(C,P,M,l),s.featureIndex.insert(F,P,M,L,this.index)}}update(n,s,l){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(n,s,this.stateDependentLayers,l)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(n){this.uploaded||(this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,Yi),this.indexBuffer=n.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(n),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(n,s,l,p){for(const v of s)for(const x of v){const S=x.x,C=x.y;if(S<0||S>=Ir||C<0||C>=Ir)continue;const P=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,n.sortKey),M=P.vertexLength;cc(this.layoutVertexArray,S,C,-1,-1),cc(this.layoutVertexArray,S,C,1,-1),cc(this.layoutVertexArray,S,C,1,1),cc(this.layoutVertexArray,S,C,-1,1),this.indexArray.emplaceBack(M,M+1,M+2),this.indexArray.emplaceBack(M,M+3,M+2),P.vertexLength+=4,P.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,n,l,{},p)}}function Ih(i,n){for(let s=0;s<i.length;s++)if(ou(n,i[s]))return!0;for(let s=0;s<n.length;s++)if(ou(i,n[s]))return!0;return!!kh(i,n)}function ng(i,n,s){return!!ou(i,n)||!!Jo(n,i,s)}function jd(i,n){if(i.length===1)return La(n,i[0]);for(let s=0;s<n.length;s++){const l=n[s];for(let p=0;p<l.length;p++)if(ou(i,l[p]))return!0}for(let s=0;s<i.length;s++)if(La(n,i[s]))return!0;for(let s=0;s<n.length;s++)if(kh(i,n[s]))return!0;return!1}function rg(i,n,s){if(i.length>1){if(kh(i,n))return!0;for(let l=0;l<n.length;l++)if(Jo(n[l],i,s))return!0}for(let l=0;l<i.length;l++)if(Jo(i[l],n,s))return!0;return!1}function kh(i,n){if(i.length===0||n.length===0)return!1;for(let s=0;s<i.length-1;s++){const l=i[s],p=i[s+1];for(let v=0;v<n.length-1;v++)if(hp(l,p,n[v],n[v+1]))return!0}return!1}function hp(i,n,s,l){return Kt(i,s,l)!==Kt(n,s,l)&&Kt(i,n,s)!==Kt(i,n,l)}function Jo(i,n,s){const l=s*s;if(n.length===1)return i.distSqr(n[0])<l;for(let p=1;p<n.length;p++)if(ig(i,n[p-1],n[p])<l)return!0;return!1}function ig(i,n,s){const l=n.distSqr(s);if(l===0)return i.distSqr(n);const p=((i.x-n.x)*(s.x-n.x)+(i.y-n.y)*(s.y-n.y))/l;return i.distSqr(p<0?n:p>1?s:s.sub(n)._mult(p)._add(n))}function La(i,n){let s,l,p,v=!1;for(let x=0;x<i.length;x++){s=i[x];for(let S=0,C=s.length-1;S<s.length;C=S++)l=s[S],p=s[C],l.y>n.y!=p.y>n.y&&n.x<(p.x-l.x)*(n.y-l.y)/(p.y-l.y)+l.x&&(v=!v)}return v}function ou(i,n){let s=!1;for(let l=0,p=i.length-1;l<i.length;p=l++){const v=i[l],x=i[p];v.y>n.y!=x.y>n.y&&n.x<(x.x-v.x)*(n.y-v.y)/(x.y-v.y)+v.x&&(s=!s)}return s}function sg(i,n,s){const l=s[0],p=s[2];if(i.x<l.x&&n.x<l.x||i.x>p.x&&n.x>p.x||i.y<l.y&&n.y<l.y||i.y>p.y&&n.y>p.y)return!1;const v=Kt(i,n,s[0]);return v!==Kt(i,n,s[1])||v!==Kt(i,n,s[2])||v!==Kt(i,n,s[3])}function au(i,n,s){const l=n.paint.get(i).value;return l.kind==="constant"?l.value:s.programConfigurations.get(n.id).getMaxValue(i)}function $d(i){return Math.sqrt(i[0]*i[0]+i[1]*i[1])}function Vd(i,n,s,l,p){if(!n[0]&&!n[1])return i;const v=G.convert(n)._mult(p);s==="viewport"&&v._rotate(-l);const x=[];for(let S=0;S<i.length;S++)x.push(i[S].sub(v));return x}let og,dp;vt("CircleBucket",Ud,{omit:["layers"]});var ag={get paint(){return dp=dp||new y({"circle-radius":new Ft(Ce.paint_circle["circle-radius"]),"circle-color":new Ft(Ce.paint_circle["circle-color"]),"circle-blur":new Ft(Ce.paint_circle["circle-blur"]),"circle-opacity":new Ft(Ce.paint_circle["circle-opacity"]),"circle-translate":new Ct(Ce.paint_circle["circle-translate"]),"circle-translate-anchor":new Ct(Ce.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Ct(Ce.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Ct(Ce.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Ft(Ce.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Ft(Ce.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Ft(Ce.paint_circle["circle-stroke-opacity"])})},get layout(){return og=og||new y({"circle-sort-key":new Ft(Ce.layout_circle["circle-sort-key"])})}},Fi=1e-6,lu=typeof Float32Array<"u"?Float32Array:Array;function qd(i){return i[0]=1,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=1,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=1,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i}function Ji(i,n,s){var l=n[0],p=n[1],v=n[2],x=n[3],S=n[4],C=n[5],P=n[6],M=n[7],L=n[8],F=n[9],U=n[10],W=n[11],Z=n[12],ne=n[13],oe=n[14],Pe=n[15],ge=s[0],_e=s[1],Re=s[2],Ye=s[3];return i[0]=ge*l+_e*S+Re*L+Ye*Z,i[1]=ge*p+_e*C+Re*F+Ye*ne,i[2]=ge*v+_e*P+Re*U+Ye*oe,i[3]=ge*x+_e*M+Re*W+Ye*Pe,i[4]=(ge=s[4])*l+(_e=s[5])*S+(Re=s[6])*L+(Ye=s[7])*Z,i[5]=ge*p+_e*C+Re*F+Ye*ne,i[6]=ge*v+_e*P+Re*U+Ye*oe,i[7]=ge*x+_e*M+Re*W+Ye*Pe,i[8]=(ge=s[8])*l+(_e=s[9])*S+(Re=s[10])*L+(Ye=s[11])*Z,i[9]=ge*p+_e*C+Re*F+Ye*ne,i[10]=ge*v+_e*P+Re*U+Ye*oe,i[11]=ge*x+_e*M+Re*W+Ye*Pe,i[12]=(ge=s[12])*l+(_e=s[13])*S+(Re=s[14])*L+(Ye=s[15])*Z,i[13]=ge*p+_e*C+Re*F+Ye*ne,i[14]=ge*v+_e*P+Re*U+Ye*oe,i[15]=ge*x+_e*M+Re*W+Ye*Pe,i}Math.hypot||(Math.hypot=function(){for(var i=0,n=arguments.length;n--;)i+=arguments[n]*arguments[n];return Math.sqrt(i)});var ws,ay=Ji;function Zd(i,n,s){var l=n[0],p=n[1],v=n[2],x=n[3];return i[0]=s[0]*l+s[4]*p+s[8]*v+s[12]*x,i[1]=s[1]*l+s[5]*p+s[9]*v+s[13]*x,i[2]=s[2]*l+s[6]*p+s[10]*v+s[14]*x,i[3]=s[3]*l+s[7]*p+s[11]*v+s[15]*x,i}ws=new lu(4),lu!=Float32Array&&(ws[0]=0,ws[1]=0,ws[2]=0,ws[3]=0);class Wd extends a{constructor(n){super(n,ag)}createBucket(n){return new Ud(n)}queryRadius(n){const s=n;return au("circle-radius",this,s)+au("circle-stroke-width",this,s)+$d(this.paint.get("circle-translate"))}queryIntersectsFeature(n,s,l,p,v,x,S,C){const P=Vd(n,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),x.angle,S),M=this.paint.get("circle-radius").evaluate(s,l)+this.paint.get("circle-stroke-width").evaluate(s,l),L=this.paint.get("circle-pitch-alignment")==="map",F=L?P:function(W,Z){return W.map(ne=>uu(ne,Z))}(P,C),U=L?M*S:M;for(const W of p)for(const Z of W){const ne=L?Z:uu(Z,C);let oe=U;const Pe=Zd([],[Z.x,Z.y,0,1],C);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?oe*=Pe[3]/x.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(oe*=x.cameraToCenterDistance/Pe[3]),ng(F,ne,oe))return!0}return!1}}function uu(i,n){const s=Zd([],[i.x,i.y,0,1],n);return new G(s[0]/s[3],s[1]/s[3])}class fp extends Ud{}let pp;vt("HeatmapBucket",fp,{omit:["layers"]});var ly={get paint(){return pp=pp||new y({"heatmap-radius":new Ft(Ce.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Ft(Ce.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Ct(Ce.paint_heatmap["heatmap-intensity"]),"heatmap-color":new wo(Ce.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Ct(Ce.paint_heatmap["heatmap-opacity"])})}};function Gd(i,{width:n,height:s},l,p){if(p){if(p instanceof Uint8ClampedArray)p=new Uint8Array(p.buffer);else if(p.length!==n*s*l)throw new RangeError(`mismatched image size. expected: ${p.length} but got: ${n*s*l}`)}else p=new Uint8Array(n*s*l);return i.width=n,i.height=s,i.data=p,i}function cu(i,{width:n,height:s},l){if(n===i.width&&s===i.height)return;const p=Gd({},{width:n,height:s},l);hu(i,p,{x:0,y:0},{x:0,y:0},{width:Math.min(i.width,n),height:Math.min(i.height,s)},l),i.width=n,i.height=s,i.data=p.data}function hu(i,n,s,l,p,v){if(p.width===0||p.height===0)return n;if(p.width>i.width||p.height>i.height||s.x>i.width-p.width||s.y>i.height-p.height)throw new RangeError("out of range source coordinates for image copy");if(p.width>n.width||p.height>n.height||l.x>n.width-p.width||l.y>n.height-p.height)throw new RangeError("out of range destination coordinates for image copy");const x=i.data,S=n.data;if(x===S)throw new Error("srcData equals dstData, so image is already copied");for(let C=0;C<p.height;C++){const P=((s.y+C)*i.width+s.x)*v,M=((l.y+C)*n.width+l.x)*v;for(let L=0;L<p.width*v;L++)S[M+L]=x[P+L]}return n}class Ph{constructor(n,s){Gd(this,n,1,s)}resize(n){cu(this,n,1)}clone(){return new Ph({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(n,s,l,p,v){hu(n,s,l,p,v,1)}}class bs{constructor(n,s){Gd(this,n,4,s)}resize(n){cu(this,n,4)}replace(n,s){s?this.data.set(n):this.data=n instanceof Uint8ClampedArray?new Uint8Array(n.buffer):n}clone(){return new bs({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(n,s,l,p,v){hu(n,s,l,p,v,4)}}function mp(i){const n={},s=i.resolution||256,l=i.clips?i.clips.length:1,p=i.image||new bs({width:s,height:l});if(Math.log(s)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${s}`);const v=(x,S,C)=>{n[i.evaluationKey]=C;const P=i.expression.evaluate(n);p.data[x+S+0]=Math.floor(255*P.r/P.a),p.data[x+S+1]=Math.floor(255*P.g/P.a),p.data[x+S+2]=Math.floor(255*P.b/P.a),p.data[x+S+3]=Math.floor(255*P.a)};if(i.clips)for(let x=0,S=0;x<l;++x,S+=4*s)for(let C=0,P=0;C<s;C++,P+=4){const M=C/(s-1),{start:L,end:F}=i.clips[x];v(S,P,L*(1-M)+F*M)}else for(let x=0,S=0;x<s;x++,S+=4)v(0,S,x/(s-1));return p}vt("AlphaImage",Ph),vt("RGBAImage",bs);const hc="big-fb";class lg extends a{createBucket(n){return new fp(n)}constructor(n){super(n,ly),this.heatmapFbos=new Map,this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(n){n==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=mp({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbos.has(hc)&&this.heatmapFbos.delete(hc)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}}let Ah;var gp={get paint(){return Ah=Ah||new y({"hillshade-illumination-direction":new Ct(Ce.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Ct(Ce.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Ct(Ce.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Ct(Ce.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Ct(Ce.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Ct(Ce.paint_hillshade["hillshade-accent-color"])})}};class Hd extends a{constructor(n){super(n,gp)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}}const uy=E([{name:"a_pos",components:2,type:"Int16"}],4),{members:ug}=uy;function Mh(i,n,s=2){const l=n&&n.length,p=l?n[0]*s:i.length;let v=_p(i,0,p,s,!0);const x=[];if(!v||v.next===v.prev)return x;let S,C,P;if(l&&(v=function(M,L,F,U){const W=[];for(let Z=0,ne=L.length;Z<ne;Z++){const oe=_p(M,L[Z]*U,Z<ne-1?L[Z+1]*U:M.length,U,!1);oe===oe.next&&(oe.steiner=!0),W.push(Fa(oe))}W.sort(cy);for(let Z=0;Z<W.length;Z++)F=fg(W[Z],F);return F}(i,n,v,s)),i.length>80*s){S=1/0,C=1/0;let M=-1/0,L=-1/0;for(let F=s;F<p;F+=s){const U=i[F],W=i[F+1];U<S&&(S=U),W<C&&(C=W),U>M&&(M=U),W>L&&(L=W)}P=Math.max(M-S,L-C),P=P!==0?32767/P:0}return zh(v,x,s,S,C,P,0),x}function _p(i,n,s,l,p){let v;if(p===function(x,S,C,P){let M=0;for(let L=S,F=C-P;L<C;L+=P)M+=(x[F]-x[L])*(x[L+1]+x[F+1]),F=L;return M}(i,n,s,l)>0)for(let x=n;x<s;x+=l)v=pg(x/l|0,i[x],i[x+1],v);else for(let x=s-l;x>=n;x-=l)v=pg(x/l|0,i[x],i[x+1],v);return v&&du(v,v.next)&&(gu(v),v=v.next),v}function Ra(i,n){if(!i)return i;n||(n=i);let s,l=i;do if(s=!1,l.steiner||!du(l,l.next)&&wr(l.prev,l,l.next)!==0)l=l.next;else{if(gu(l),l=n=l.prev,l===l.next)break;s=!0}while(s||l!==n);return n}function zh(i,n,s,l,p,v,x){if(!i)return;!x&&v&&function(C,P,M,L){let F=C;do F.z===0&&(F.z=yp(F.x,F.y,P,M,L)),F.prevZ=F.prev,F.nextZ=F.next,F=F.next;while(F!==C);F.prevZ.nextZ=null,F.prevZ=null,function(U){let W,Z=1;do{let ne,oe=U;U=null;let Pe=null;for(W=0;oe;){W++;let ge=oe,_e=0;for(let Ye=0;Ye<Z&&(_e++,ge=ge.nextZ,ge);Ye++);let Re=Z;for(;_e>0||Re>0&&ge;)_e!==0&&(Re===0||!ge||oe.z<=ge.z)?(ne=oe,oe=oe.nextZ,_e--):(ne=ge,ge=ge.nextZ,Re--),Pe?Pe.nextZ=ne:U=ne,ne.prevZ=Pe,Pe=ne;oe=ge}Pe.nextZ=null,Z*=2}while(W>1)}(F)}(i,l,p,v);let S=i;for(;i.prev!==i.next;){const C=i.prev,P=i.next;if(v?Oa(i,l,p,v):cg(i))n.push(C.i,i.i,P.i),gu(i),i=P.next,S=P.next;else if((i=P)===S){x?x===1?zh(i=hg(Ra(i),n),n,s,l,p,v,2):x===2&&dg(i,n,s,l,p,v):zh(Ra(i),n,s,l,p,v,1);break}}}function cg(i){const n=i.prev,s=i,l=i.next;if(wr(n,s,l)>=0)return!1;const p=n.x,v=s.x,x=l.x,S=n.y,C=s.y,P=l.y,M=p<v?p<x?p:x:v<x?v:x,L=S<C?S<P?S:P:C<P?C:P,F=p>v?p>x?p:x:v>x?v:x,U=S>C?S>P?S:P:C>P?C:P;let W=l.next;for(;W!==n;){if(W.x>=M&&W.x<=F&&W.y>=L&&W.y<=U&&El(p,S,v,C,x,P,W.x,W.y)&&wr(W.prev,W,W.next)>=0)return!1;W=W.next}return!0}function Oa(i,n,s,l){const p=i.prev,v=i,x=i.next;if(wr(p,v,x)>=0)return!1;const S=p.x,C=v.x,P=x.x,M=p.y,L=v.y,F=x.y,U=S<C?S<P?S:P:C<P?C:P,W=M<L?M<F?M:F:L<F?L:F,Z=S>C?S>P?S:P:C>P?C:P,ne=M>L?M>F?M:F:L>F?L:F,oe=yp(U,W,n,s,l),Pe=yp(Z,ne,n,s,l);let ge=i.prevZ,_e=i.nextZ;for(;ge&&ge.z>=oe&&_e&&_e.z<=Pe;){if(ge.x>=U&&ge.x<=Z&&ge.y>=W&&ge.y<=ne&&ge!==p&&ge!==x&&El(S,M,C,L,P,F,ge.x,ge.y)&&wr(ge.prev,ge,ge.next)>=0||(ge=ge.prevZ,_e.x>=U&&_e.x<=Z&&_e.y>=W&&_e.y<=ne&&_e!==p&&_e!==x&&El(S,M,C,L,P,F,_e.x,_e.y)&&wr(_e.prev,_e,_e.next)>=0))return!1;_e=_e.nextZ}for(;ge&&ge.z>=oe;){if(ge.x>=U&&ge.x<=Z&&ge.y>=W&&ge.y<=ne&&ge!==p&&ge!==x&&El(S,M,C,L,P,F,ge.x,ge.y)&&wr(ge.prev,ge,ge.next)>=0)return!1;ge=ge.prevZ}for(;_e&&_e.z<=Pe;){if(_e.x>=U&&_e.x<=Z&&_e.y>=W&&_e.y<=ne&&_e!==p&&_e!==x&&El(S,M,C,L,P,F,_e.x,_e.y)&&wr(_e.prev,_e,_e.next)>=0)return!1;_e=_e.nextZ}return!0}function hg(i,n){let s=i;do{const l=s.prev,p=s.next.next;!du(l,p)&&fu(l,s,s.next,p)&&mu(l,p)&&mu(p,l)&&(n.push(l.i,s.i,p.i),gu(s),gu(s.next),s=i=p),s=s.next}while(s!==i);return Ra(s)}function dg(i,n,s,l,p,v){let x=i;do{let S=x.next.next;for(;S!==x.prev;){if(x.i!==S.i&&vp(x,S)){let C=Cl(x,S);return x=Ra(x,x.next),C=Ra(C,C.next),zh(x,n,s,l,p,v,0),void zh(C,n,s,l,p,v,0)}S=S.next}x=x.next}while(x!==i)}function cy(i,n){return i.x-n.x}function fg(i,n){const s=function(p,v){let x=v;const S=p.x,C=p.y;let P,M=-1/0;do{if(C<=x.y&&C>=x.next.y&&x.next.y!==x.y){const Z=x.x+(C-x.y)*(x.next.x-x.x)/(x.next.y-x.y);if(Z<=S&&Z>M&&(M=Z,P=x.x<x.next.x?x:x.next,Z===S))return P}x=x.next}while(x!==v);if(!P)return null;const L=P,F=P.x,U=P.y;let W=1/0;x=P;do{if(S>=x.x&&x.x>=F&&S!==x.x&&El(C<U?S:M,C,F,U,C<U?M:S,C,x.x,x.y)){const Z=Math.abs(C-x.y)/(S-x.x);mu(x,p)&&(Z<W||Z===W&&(x.x>P.x||x.x===P.x&&hy(P,x)))&&(P=x,W=Z)}x=x.next}while(x!==L);return P}(i,n);if(!s)return n;const l=Cl(s,i);return Ra(l,l.next),Ra(s,s.next)}function hy(i,n){return wr(i.prev,i,n.prev)<0&&wr(n.next,i,i.next)<0}function yp(i,n,s,l,p){return(i=1431655765&((i=858993459&((i=252645135&((i=16711935&((i=(i-s)*p|0)|i<<8))|i<<4))|i<<2))|i<<1))|(n=1431655765&((n=858993459&((n=252645135&((n=16711935&((n=(n-l)*p|0)|n<<8))|n<<4))|n<<2))|n<<1))<<1}function Fa(i){let n=i,s=i;do(n.x<s.x||n.x===s.x&&n.y<s.y)&&(s=n),n=n.next;while(n!==i);return s}function El(i,n,s,l,p,v,x,S){return(p-x)*(n-S)>=(i-x)*(v-S)&&(i-x)*(l-S)>=(s-x)*(n-S)&&(s-x)*(v-S)>=(p-x)*(l-S)}function vp(i,n){return i.next.i!==n.i&&i.prev.i!==n.i&&!function(s,l){let p=s;do{if(p.i!==s.i&&p.next.i!==s.i&&p.i!==l.i&&p.next.i!==l.i&&fu(p,p.next,s,l))return!0;p=p.next}while(p!==s);return!1}(i,n)&&(mu(i,n)&&mu(n,i)&&function(s,l){let p=s,v=!1;const x=(s.x+l.x)/2,S=(s.y+l.y)/2;do p.y>S!=p.next.y>S&&p.next.y!==p.y&&x<(p.next.x-p.x)*(S-p.y)/(p.next.y-p.y)+p.x&&(v=!v),p=p.next;while(p!==s);return v}(i,n)&&(wr(i.prev,i,n.prev)||wr(i,n.prev,n))||du(i,n)&&wr(i.prev,i,i.next)>0&&wr(n.prev,n,n.next)>0)}function wr(i,n,s){return(n.y-i.y)*(s.x-n.x)-(n.x-i.x)*(s.y-n.y)}function du(i,n){return i.x===n.x&&i.y===n.y}function fu(i,n,s,l){const p=pu(wr(i,n,s)),v=pu(wr(i,n,l)),x=pu(wr(s,l,i)),S=pu(wr(s,l,n));return p!==v&&x!==S||!(p!==0||!Vt(i,s,n))||!(v!==0||!Vt(i,l,n))||!(x!==0||!Vt(s,i,l))||!(S!==0||!Vt(s,n,l))}function Vt(i,n,s){return n.x<=Math.max(i.x,s.x)&&n.x>=Math.min(i.x,s.x)&&n.y<=Math.max(i.y,s.y)&&n.y>=Math.min(i.y,s.y)}function pu(i){return i>0?1:i<0?-1:0}function mu(i,n){return wr(i.prev,i,i.next)<0?wr(i,n,i.next)>=0&&wr(i,i.prev,n)>=0:wr(i,n,i.prev)<0||wr(i,i.next,n)<0}function Cl(i,n){const s=Xd(i.i,i.x,i.y),l=Xd(n.i,n.x,n.y),p=i.next,v=n.prev;return i.next=n,n.prev=i,s.next=p,p.prev=s,l.next=s,s.prev=l,v.next=l,l.prev=v,l}function pg(i,n,s,l){const p=Xd(i,n,s);return l?(p.next=l.next,p.prev=l,l.next.prev=p,l.next=p):(p.prev=p,p.next=p),p}function gu(i){i.next.prev=i.prev,i.prev.next=i.next,i.prevZ&&(i.prevZ.nextZ=i.nextZ),i.nextZ&&(i.nextZ.prevZ=i.prevZ)}function Xd(i,n,s){return{i,x:n,y:s,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function _i(i,n,s){const l=s.patternDependencies;let p=!1;for(const v of n){const x=v.paint.get(`${i}-pattern`);x.isConstant()||(p=!0);const S=x.constantOr(null);S&&(p=!0,l[S.to]=!0,l[S.from]=!0)}return p}function xp(i,n,s,l,p){const v=p.patternDependencies;for(const x of n){const S=x.paint.get(`${i}-pattern`).value;if(S.kind!=="constant"){let C=S.evaluate({zoom:l-1},s,{},p.availableImages),P=S.evaluate({zoom:l},s,{},p.availableImages),M=S.evaluate({zoom:l+1},s,{},p.availableImages);C=C&&C.name?C.name:C,P=P&&P.name?P.name:P,M=M&&M.name?M.name:M,v[C]=!0,v[P]=!0,v[M]=!0,s.patterns[x.id]={min:C,mid:P,max:M}}}return s}class wp{constructor(n){this.zoom=n.zoom,this.overscaling=n.overscaling,this.layers=n.layers,this.layerIds=this.layers.map(s=>s.id),this.index=n.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new ms,this.indexArray=new vs,this.indexArray2=new ii,this.programConfigurations=new gi(n.layers,n.zoom),this.segments=new gn,this.segments2=new gn,this.stateDependentLayerIds=this.layers.filter(s=>s.isStateDependent()).map(s=>s.id)}populate(n,s,l){this.hasPattern=_i("fill",this.layers,s);const p=this.layers[0].layout.get("fill-sort-key"),v=!p.isConstant(),x=[];for(const{feature:S,id:C,index:P,sourceLayerIndex:M}of n){const L=this.layers[0]._featureFilter.needGeometry,F=xs(S,L);if(!this.layers[0]._featureFilter.filter(new ar(this.zoom),F,l))continue;const U=v?p.evaluate(F,{},l,s.availableImages):void 0,W={id:C,properties:S.properties,type:S.type,sourceLayerIndex:M,index:P,geometry:L?F.geometry:si(S),patterns:{},sortKey:U};x.push(W)}v&&x.sort((S,C)=>S.sortKey-C.sortKey);for(const S of x){const{geometry:C,index:P,sourceLayerIndex:M}=S;if(this.hasPattern){const L=xp("fill",this.layers,S,this.zoom,s);this.patternFeatures.push(L)}else this.addFeature(S,C,P,l,{});s.featureIndex.insert(n[P].feature,C,P,M,this.index)}}update(n,s,l){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(n,s,this.stateDependentLayers,l)}addFeatures(n,s,l){for(const p of this.patternFeatures)this.addFeature(p,p.geometry,p.index,s,l)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(n){this.uploaded||(this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,ug),this.indexBuffer=n.createIndexBuffer(this.indexArray),this.indexBuffer2=n.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(n),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(n,s,l,p,v){for(const x of ir(s,500)){let S=0;for(const U of x)S+=U.length;const C=this.segments.prepareSegment(S,this.layoutVertexArray,this.indexArray),P=C.vertexLength,M=[],L=[];for(const U of x){if(U.length===0)continue;U!==x[0]&&L.push(M.length/2);const W=this.segments2.prepareSegment(U.length,this.layoutVertexArray,this.indexArray2),Z=W.vertexLength;this.layoutVertexArray.emplaceBack(U[0].x,U[0].y),this.indexArray2.emplaceBack(Z+U.length-1,Z),M.push(U[0].x),M.push(U[0].y);for(let ne=1;ne<U.length;ne++)this.layoutVertexArray.emplaceBack(U[ne].x,U[ne].y),this.indexArray2.emplaceBack(Z+ne-1,Z+ne),M.push(U[ne].x),M.push(U[ne].y);W.vertexLength+=U.length,W.primitiveLength+=U.length}const F=Mh(M,L);for(let U=0;U<F.length;U+=3)this.indexArray.emplaceBack(P+F[U],P+F[U+1],P+F[U+2]);C.vertexLength+=S,C.primitiveLength+=F.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,n,l,v,p)}}let bp,mg;vt("FillBucket",wp,{omit:["layers","patternFeatures"]});var gg={get paint(){return mg=mg||new y({"fill-antialias":new Ct(Ce.paint_fill["fill-antialias"]),"fill-opacity":new Ft(Ce.paint_fill["fill-opacity"]),"fill-color":new Ft(Ce.paint_fill["fill-color"]),"fill-outline-color":new Ft(Ce.paint_fill["fill-outline-color"]),"fill-translate":new Ct(Ce.paint_fill["fill-translate"]),"fill-translate-anchor":new Ct(Ce.paint_fill["fill-translate-anchor"]),"fill-pattern":new sc(Ce.paint_fill["fill-pattern"])})},get layout(){return bp=bp||new y({"fill-sort-key":new Ft(Ce.layout_fill["fill-sort-key"])})}};class dy extends a{constructor(n){super(n,gg)}recalculate(n,s){super.recalculate(n,s);const l=this.paint._values["fill-outline-color"];l.value.kind==="constant"&&l.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(n){return new wp(n)}queryRadius(){return $d(this.paint.get("fill-translate"))}queryIntersectsFeature(n,s,l,p,v,x,S){return jd(Vd(n,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),x.angle,S),p)}isTileClipped(){return!0}}const fy=E([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),py=E([{name:"a_centroid",components:2,type:"Int16"}],4),{members:Ba}=fy;var Fr={},Sp=j,_g=Il;function Il(i,n,s,l,p){this.properties={},this.extent=s,this.type=0,this._pbf=i,this._geometry=-1,this._keys=l,this._values=p,i.readFields(my,this,n)}function my(i,n,s){i==1?n.id=s.readVarint():i==2?function(l,p){for(var v=l.readVarint()+l.pos;l.pos<v;){var x=p._keys[l.readVarint()],S=p._values[l.readVarint()];p.properties[x]=S}}(s,n):i==3?n.type=s.readVarint():i==4&&(n._geometry=s.pos)}function gy(i){for(var n,s,l=0,p=0,v=i.length,x=v-1;p<v;x=p++)l+=((s=i[x]).x-(n=i[p]).x)*(n.y+s.y);return l}Il.types=["Unknown","Point","LineString","Polygon"],Il.prototype.loadGeometry=function(){var i=this._pbf;i.pos=this._geometry;for(var n,s=i.readVarint()+i.pos,l=1,p=0,v=0,x=0,S=[];i.pos<s;){if(p<=0){var C=i.readVarint();l=7&C,p=C>>3}if(p--,l===1||l===2)v+=i.readSVarint(),x+=i.readSVarint(),l===1&&(n&&S.push(n),n=[]),n.push(new Sp(v,x));else{if(l!==7)throw new Error("unknown command "+l);n&&n.push(n[0].clone())}}return n&&S.push(n),S},Il.prototype.bbox=function(){var i=this._pbf;i.pos=this._geometry;for(var n=i.readVarint()+i.pos,s=1,l=0,p=0,v=0,x=1/0,S=-1/0,C=1/0,P=-1/0;i.pos<n;){if(l<=0){var M=i.readVarint();s=7&M,l=M>>3}if(l--,s===1||s===2)(p+=i.readSVarint())<x&&(x=p),p>S&&(S=p),(v+=i.readSVarint())<C&&(C=v),v>P&&(P=v);else if(s!==7)throw new Error("unknown command "+s)}return[x,C,S,P]},Il.prototype.toGeoJSON=function(i,n,s){var l,p,v=this.extent*Math.pow(2,s),x=this.extent*i,S=this.extent*n,C=this.loadGeometry(),P=Il.types[this.type];function M(U){for(var W=0;W<U.length;W++){var Z=U[W];U[W]=[360*(Z.x+x)/v-180,360/Math.PI*Math.atan(Math.exp((180-360*(Z.y+S)/v)*Math.PI/180))-90]}}switch(this.type){case 1:var L=[];for(l=0;l<C.length;l++)L[l]=C[l][0];M(C=L);break;case 2:for(l=0;l<C.length;l++)M(C[l]);break;case 3:for(C=function(U){var W=U.length;if(W<=1)return[U];for(var Z,ne,oe=[],Pe=0;Pe<W;Pe++){var ge=gy(U[Pe]);ge!==0&&(ne===void 0&&(ne=ge<0),ne===ge<0?(Z&&oe.push(Z),Z=[U[Pe]]):Z.push(U[Pe]))}return Z&&oe.push(Z),oe}(C),l=0;l<C.length;l++)for(p=0;p<C[l].length;p++)M(C[l][p])}C.length===1?C=C[0]:P="Multi"+P;var F={type:"Feature",geometry:{type:P,coordinates:C},properties:this.properties};return"id"in this&&(F.id=this.id),F};var Dh=_g,Tp=Ep;function Ep(i,n){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=i,this._keys=[],this._values=[],this._features=[],i.readFields(_y,this,n),this.length=this._features.length}function _y(i,n,s){i===15?n.version=s.readVarint():i===1?n.name=s.readString():i===5?n.extent=s.readVarint():i===2?n._features.push(s.pos):i===3?n._keys.push(s.readString()):i===4&&n._values.push(function(l){for(var p=null,v=l.readVarint()+l.pos;l.pos<v;){var x=l.readVarint()>>3;p=x===1?l.readString():x===2?l.readFloat():x===3?l.readDouble():x===4?l.readVarint64():x===5?l.readVarint():x===6?l.readSVarint():x===7?l.readBoolean():null}return p}(s))}Ep.prototype.feature=function(i){if(i<0||i>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[i];var n=this._pbf.readVarint()+this._pbf.pos;return new Dh(this._pbf,n,this.extent,this._keys,this._values)};var yy=Tp;function vy(i,n,s){if(i===3){var l=new yy(s,s.readVarint()+s.pos);l.length&&(n[l.name]=l)}}Fr.VectorTile=function(i,n){this.layers=i.readFields(vy,{},n)},Fr.VectorTileFeature=_g,Fr.VectorTileLayer=Tp;const xy=Fr.VectorTileFeature.types,Kd=Math.pow(2,13);function dc(i,n,s,l,p,v,x,S){i.emplaceBack(n,s,2*Math.floor(l*Kd)+x,p*Kd*2,v*Kd*2,Math.round(S))}class Cp{constructor(n){this.zoom=n.zoom,this.overscaling=n.overscaling,this.layers=n.layers,this.layerIds=this.layers.map(s=>s.id),this.index=n.index,this.hasPattern=!1,this.layoutVertexArray=new xl,this.centroidVertexArray=new pi,this.indexArray=new vs,this.programConfigurations=new gi(n.layers,n.zoom),this.segments=new gn,this.stateDependentLayerIds=this.layers.filter(s=>s.isStateDependent()).map(s=>s.id)}populate(n,s,l){this.features=[],this.hasPattern=_i("fill-extrusion",this.layers,s);for(const{feature:p,id:v,index:x,sourceLayerIndex:S}of n){const C=this.layers[0]._featureFilter.needGeometry,P=xs(p,C);if(!this.layers[0]._featureFilter.filter(new ar(this.zoom),P,l))continue;const M={id:v,sourceLayerIndex:S,index:x,geometry:C?P.geometry:si(p),properties:p.properties,type:p.type,patterns:{}};this.hasPattern?this.features.push(xp("fill-extrusion",this.layers,M,this.zoom,s)):this.addFeature(M,M.geometry,x,l,{}),s.featureIndex.insert(p,M.geometry,x,S,this.index,!0)}}addFeatures(n,s,l){for(const p of this.features){const{geometry:v}=p;this.addFeature(p,v,p.index,s,l)}}update(n,s,l){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(n,s,this.stateDependentLayers,l)}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(n){this.uploaded||(this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,Ba),this.centroidVertexBuffer=n.createVertexBuffer(this.centroidVertexArray,py.members,!0),this.indexBuffer=n.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(n),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(n,s,l,p,v){for(const x of ir(s,500)){const S={x:0,y:0,vertexCount:0};let C=0;for(const W of x)C+=W.length;let P=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray);for(const W of x){if(W.length===0||yg(W))continue;let Z=0;for(let ne=0;ne<W.length;ne++){const oe=W[ne];if(ne>=1){const Pe=W[ne-1];if(!Ip(oe,Pe)){P.vertexLength+4>gn.MAX_VERTEX_ARRAY_LENGTH&&(P=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const ge=oe.sub(Pe)._perp()._unit(),_e=Pe.dist(oe);Z+_e>32768&&(Z=0),dc(this.layoutVertexArray,oe.x,oe.y,ge.x,ge.y,0,0,Z),dc(this.layoutVertexArray,oe.x,oe.y,ge.x,ge.y,0,1,Z),S.x+=2*oe.x,S.y+=2*oe.y,S.vertexCount+=2,Z+=_e,dc(this.layoutVertexArray,Pe.x,Pe.y,ge.x,ge.y,0,0,Z),dc(this.layoutVertexArray,Pe.x,Pe.y,ge.x,ge.y,0,1,Z),S.x+=2*Pe.x,S.y+=2*Pe.y,S.vertexCount+=2;const Re=P.vertexLength;this.indexArray.emplaceBack(Re,Re+2,Re+1),this.indexArray.emplaceBack(Re+1,Re+2,Re+3),P.vertexLength+=4,P.primitiveLength+=2}}}}if(P.vertexLength+C>gn.MAX_VERTEX_ARRAY_LENGTH&&(P=this.segments.prepareSegment(C,this.layoutVertexArray,this.indexArray)),xy[n.type]!=="Polygon")continue;const M=[],L=[],F=P.vertexLength;for(const W of x)if(W.length!==0){W!==x[0]&&L.push(M.length/2);for(let Z=0;Z<W.length;Z++){const ne=W[Z];dc(this.layoutVertexArray,ne.x,ne.y,0,0,1,1,0),S.x+=ne.x,S.y+=ne.y,S.vertexCount+=1,M.push(ne.x),M.push(ne.y)}}const U=Mh(M,L);for(let W=0;W<U.length;W+=3)this.indexArray.emplaceBack(F+U[W],F+U[W+2],F+U[W+1]);P.primitiveLength+=U.length/3,P.vertexLength+=C;for(let W=0;W<S.vertexCount;W++){const Z=Math.floor(S.x/S.vertexCount),ne=Math.floor(S.y/S.vertexCount);this.centroidVertexArray.emplaceBack(Z,ne)}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,n,l,v,p)}}function Ip(i,n){return i.x===n.x&&(i.x<0||i.x>Ir)||i.y===n.y&&(i.y<0||i.y>Ir)}function yg(i){return i.every(n=>n.x<0)||i.every(n=>n.x>Ir)||i.every(n=>n.y<0)||i.every(n=>n.y>Ir)}let fc;vt("FillExtrusionBucket",Cp,{omit:["layers","features"]});var kp={get paint(){return fc=fc||new y({"fill-extrusion-opacity":new Ct(Ce["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Ft(Ce["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Ct(Ce["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Ct(Ce["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new sc(Ce["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Ft(Ce["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Ft(Ce["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Ct(Ce["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class vg extends a{constructor(n){super(n,kp)}createBucket(n){return new Cp(n)}queryRadius(){return $d(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature(n,s,l,p,v,x,S,C){const P=Vd(n,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),x.angle,S),M=this.paint.get("fill-extrusion-height").evaluate(s,l),L=this.paint.get("fill-extrusion-base").evaluate(s,l),F=function(W,Z,ne,oe){const Pe=[];for(const ge of W){const _e=[ge.x,ge.y,0,1];Zd(_e,_e,Z),Pe.push(new G(_e[0]/_e[3],_e[1]/_e[3]))}return Pe}(P,C),U=function(W,Z,ne,oe){const Pe=[],ge=[],_e=oe[8]*Z,Re=oe[9]*Z,Ye=oe[10]*Z,gt=oe[11]*Z,Ot=oe[8]*ne,_t=oe[9]*ne,dt=oe[10]*ne,Pt=oe[11]*ne;for(const xt of W){const yt=[],$e=[];for(const At of xt){const kt=At.x,qt=At.y,tr=oe[0]*kt+oe[4]*qt+oe[12],Yn=oe[1]*kt+oe[5]*qt+oe[13],Qr=oe[2]*kt+oe[6]*qt+oe[14],Es=oe[3]*kt+oe[7]*qt+oe[15],vi=Qr+Ye,Nr=Es+gt,Bi=tr+Ot,Ni=Yn+_t,Ui=Qr+dt,yn=Es+Pt,$n=new G((tr+_e)/Nr,(Yn+Re)/Nr);$n.z=vi/Nr,yt.push($n);const ki=new G(Bi/yn,Ni/yn);ki.z=Ui/yn,$e.push(ki)}Pe.push(yt),ge.push($e)}return[Pe,ge]}(p,L,M,C);return function(W,Z,ne){let oe=1/0;jd(ne,Z)&&(oe=Lh(ne,Z[0]));for(let Pe=0;Pe<Z.length;Pe++){const ge=Z[Pe],_e=W[Pe];for(let Re=0;Re<ge.length-1;Re++){const Ye=ge[Re],gt=[Ye,ge[Re+1],_e[Re+1],_e[Re],Ye];Ih(ne,gt)&&(oe=Math.min(oe,Lh(ne,gt)))}}return oe!==1/0&&oe}(U[0],U[1],F)}}function pc(i,n){return i.x*n.x+i.y*n.y}function Lh(i,n){if(i.length===1){let s=0;const l=n[s++];let p;for(;!p||l.equals(p);)if(p=n[s++],!p)return 1/0;for(;s<n.length;s++){const v=n[s],x=i[0],S=p.sub(l),C=v.sub(l),P=x.sub(l),M=pc(S,S),L=pc(S,C),F=pc(C,C),U=pc(P,S),W=pc(P,C),Z=M*F-L*L,ne=(F*U-L*W)/Z,oe=(M*W-L*U)/Z,Pe=l.z*(1-ne-oe)+p.z*ne+v.z*oe;if(isFinite(Pe))return Pe}return 1/0}{let s=1/0;for(const l of n)s=Math.min(s,l.z);return s}}const xg=E([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:Qo}=xg,_u=E([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:wy}=_u,wg=Fr.VectorTileFeature.types,by=Math.cos(Math.PI/180*37.5),bg=Math.pow(2,14)/.5;class Pp{constructor(n){this.zoom=n.zoom,this.overscaling=n.overscaling,this.layers=n.layers,this.layerIds=this.layers.map(s=>s.id),this.index=n.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(s=>{this.gradients[s.id]={}}),this.layoutVertexArray=new Ko,this.layoutVertexArray2=new Ma,this.indexArray=new vs,this.programConfigurations=new gi(n.layers,n.zoom),this.segments=new gn,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(s=>s.isStateDependent()).map(s=>s.id)}populate(n,s,l){this.hasPattern=_i("line",this.layers,s);const p=this.layers[0].layout.get("line-sort-key"),v=!p.isConstant(),x=[];for(const{feature:S,id:C,index:P,sourceLayerIndex:M}of n){const L=this.layers[0]._featureFilter.needGeometry,F=xs(S,L);if(!this.layers[0]._featureFilter.filter(new ar(this.zoom),F,l))continue;const U=v?p.evaluate(F,{},l):void 0,W={id:C,properties:S.properties,type:S.type,sourceLayerIndex:M,index:P,geometry:L?F.geometry:si(S),patterns:{},sortKey:U};x.push(W)}v&&x.sort((S,C)=>S.sortKey-C.sortKey);for(const S of x){const{geometry:C,index:P,sourceLayerIndex:M}=S;if(this.hasPattern){const L=xp("line",this.layers,S,this.zoom,s);this.patternFeatures.push(L)}else this.addFeature(S,C,P,l,{});s.featureIndex.insert(n[P].feature,C,P,M,this.index)}}update(n,s,l){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(n,s,this.stateDependentLayers,l)}addFeatures(n,s,l){for(const p of this.patternFeatures)this.addFeature(p,p.geometry,p.index,s,l)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(n){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=n.createVertexBuffer(this.layoutVertexArray2,wy)),this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,Qo),this.indexBuffer=n.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(n),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(n){if(n.properties&&Object.prototype.hasOwnProperty.call(n.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(n.properties,"mapbox_clip_end"))return{start:+n.properties.mapbox_clip_start,end:+n.properties.mapbox_clip_end}}addFeature(n,s,l,p,v){const x=this.layers[0].layout,S=x.get("line-join").evaluate(n,{}),C=x.get("line-cap"),P=x.get("line-miter-limit"),M=x.get("line-round-limit");this.lineClips=this.lineFeatureClips(n);for(const L of s)this.addLine(L,n,S,C,P,M);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,n,l,v,p)}addLine(n,s,l,p,v,x){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let oe=0;oe<n.length-1;oe++)this.totalDistance+=n[oe].dist(n[oe+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const S=wg[s.type]==="Polygon";let C=n.length;for(;C>=2&&n[C-1].equals(n[C-2]);)C--;let P=0;for(;P<C-1&&n[P].equals(n[P+1]);)P++;if(C<(S?3:2))return;l==="bevel"&&(v=1.05);const M=this.overscaling<=16?15*Ir/(512*this.overscaling):0,L=this.segments.prepareSegment(10*C,this.layoutVertexArray,this.indexArray);let F,U,W,Z,ne;this.e1=this.e2=-1,S&&(F=n[C-2],ne=n[P].sub(F)._unit()._perp());for(let oe=P;oe<C;oe++){if(W=oe===C-1?S?n[P+1]:void 0:n[oe+1],W&&n[oe].equals(W))continue;ne&&(Z=ne),F&&(U=F),F=n[oe],ne=W?W.sub(F)._unit()._perp():Z,Z=Z||ne;let Pe=Z.add(ne);Pe.x===0&&Pe.y===0||Pe._unit();const ge=Z.x*ne.x+Z.y*ne.y,_e=Pe.x*ne.x+Pe.y*ne.y,Re=_e!==0?1/_e:1/0,Ye=2*Math.sqrt(2-2*_e),gt=_e<by&&U&&W,Ot=Z.x*ne.y-Z.y*ne.x>0;if(gt&&oe>P){const Pt=F.dist(U);if(Pt>2*M){const xt=F.sub(F.sub(U)._mult(M/Pt)._round());this.updateDistance(U,xt),this.addCurrentVertex(xt,Z,0,0,L),U=xt}}const _t=U&&W;let dt=_t?l:S?"butt":p;if(_t&&dt==="round"&&(Re<x?dt="miter":Re<=2&&(dt="fakeround")),dt==="miter"&&Re>v&&(dt="bevel"),dt==="bevel"&&(Re>2&&(dt="flipbevel"),Re<v&&(dt="miter")),U&&this.updateDistance(U,F),dt==="miter")Pe._mult(Re),this.addCurrentVertex(F,Pe,0,0,L);else if(dt==="flipbevel"){if(Re>100)Pe=ne.mult(-1);else{const Pt=Re*Z.add(ne).mag()/Z.sub(ne).mag();Pe._perp()._mult(Pt*(Ot?-1:1))}this.addCurrentVertex(F,Pe,0,0,L),this.addCurrentVertex(F,Pe.mult(-1),0,0,L)}else if(dt==="bevel"||dt==="fakeround"){const Pt=-Math.sqrt(Re*Re-1),xt=Ot?Pt:0,yt=Ot?0:Pt;if(U&&this.addCurrentVertex(F,Z,xt,yt,L),dt==="fakeround"){const $e=Math.round(180*Ye/Math.PI/20);for(let At=1;At<$e;At++){let kt=At/$e;if(kt!==.5){const tr=kt-.5;kt+=kt*tr*(kt-1)*((1.0904+ge*(ge*(3.55645-1.43519*ge)-3.2452))*tr*tr+(.848013+ge*(.215638*ge-1.06021)))}const qt=ne.sub(Z)._mult(kt)._add(Z)._unit()._mult(Ot?-1:1);this.addHalfVertex(F,qt.x,qt.y,!1,Ot,0,L)}}W&&this.addCurrentVertex(F,ne,-xt,-yt,L)}else if(dt==="butt")this.addCurrentVertex(F,Pe,0,0,L);else if(dt==="square"){const Pt=U?1:-1;this.addCurrentVertex(F,Pe,Pt,Pt,L)}else dt==="round"&&(U&&(this.addCurrentVertex(F,Z,0,0,L),this.addCurrentVertex(F,Z,1,1,L,!0)),W&&(this.addCurrentVertex(F,ne,-1,-1,L,!0),this.addCurrentVertex(F,ne,0,0,L)));if(gt&&oe<C-1){const Pt=F.dist(W);if(Pt>2*M){const xt=F.add(W.sub(F)._mult(M/Pt)._round());this.updateDistance(F,xt),this.addCurrentVertex(xt,ne,0,0,L),F=xt}}}}addCurrentVertex(n,s,l,p,v,x=!1){const S=s.y*p-s.x,C=-s.y-s.x*p;this.addHalfVertex(n,s.x+s.y*l,s.y-s.x*l,x,!1,l,v),this.addHalfVertex(n,S,C,x,!0,-p,v),this.distance>bg/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(n,s,l,p,v,x))}addHalfVertex({x:n,y:s},l,p,v,x,S,C){const P=.5*(this.lineClips?this.scaledDistance*(bg-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((n<<1)+(v?1:0),(s<<1)+(x?1:0),Math.round(63*l)+128,Math.round(63*p)+128,1+(S===0?0:S<0?-1:1)|(63&P)<<2,P>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const M=C.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,M),C.primitiveLength++),x?this.e2=M:this.e1=M}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(n,s){this.distance+=n.dist(s),this.updateScaledDistance()}}let Sg,Tg;vt("LineBucket",Pp,{omit:["layers","patternFeatures"]});var Eg={get paint(){return Tg=Tg||new y({"line-opacity":new Ft(Ce.paint_line["line-opacity"]),"line-color":new Ft(Ce.paint_line["line-color"]),"line-translate":new Ct(Ce.paint_line["line-translate"]),"line-translate-anchor":new Ct(Ce.paint_line["line-translate-anchor"]),"line-width":new Ft(Ce.paint_line["line-width"]),"line-gap-width":new Ft(Ce.paint_line["line-gap-width"]),"line-offset":new Ft(Ce.paint_line["line-offset"]),"line-blur":new Ft(Ce.paint_line["line-blur"]),"line-dasharray":new oc(Ce.paint_line["line-dasharray"]),"line-pattern":new sc(Ce.paint_line["line-pattern"]),"line-gradient":new wo(Ce.paint_line["line-gradient"])})},get layout(){return Sg=Sg||new y({"line-cap":new Ct(Ce.layout_line["line-cap"]),"line-join":new Ft(Ce.layout_line["line-join"]),"line-miter-limit":new Ct(Ce.layout_line["line-miter-limit"]),"line-round-limit":new Ct(Ce.layout_line["line-round-limit"]),"line-sort-key":new Ft(Ce.layout_line["line-sort-key"])})}};class Sy extends Ft{possiblyEvaluate(n,s){return s=new ar(Math.floor(s.zoom),{now:s.now,fadeDuration:s.fadeDuration,zoomHistory:s.zoomHistory,transition:s.transition}),super.possiblyEvaluate(n,s)}evaluate(n,s,l,p){return s=ve({},s,{zoom:Math.floor(s.zoom)}),super.evaluate(n,s,l,p)}}let Yd;class Ty extends a{constructor(n){super(n,Eg),this.gradientVersion=0,Yd||(Yd=new Sy(Eg.paint.properties["line-width"].specification),Yd.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(n){if(n==="line-gradient"){const s=this.gradientExpression();this.stepInterpolant=!!function(l){return l._styleExpression!==void 0}(s)&&s._styleExpression.expression instanceof il,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(n,s){super.recalculate(n,s),this.paint._values["line-floorwidth"]=Yd.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,n)}createBucket(n){return new Pp(n)}queryRadius(n){const s=n,l=Cg(au("line-width",this,s),au("line-gap-width",this,s)),p=au("line-offset",this,s);return l/2+Math.abs(p)+$d(this.paint.get("line-translate"))}queryIntersectsFeature(n,s,l,p,v,x,S){const C=Vd(n,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),x.angle,S),P=S/2*Cg(this.paint.get("line-width").evaluate(s,l),this.paint.get("line-gap-width").evaluate(s,l)),M=this.paint.get("line-offset").evaluate(s,l);return M&&(p=function(L,F){const U=[];for(let W=0;W<L.length;W++){const Z=L[W],ne=[];for(let oe=0;oe<Z.length;oe++){const Pe=Z[oe-1],ge=Z[oe],_e=Z[oe+1],Re=oe===0?new G(0,0):ge.sub(Pe)._unit()._perp(),Ye=oe===Z.length-1?new G(0,0):_e.sub(ge)._unit()._perp(),gt=Re._add(Ye)._unit(),Ot=gt.x*Ye.x+gt.y*Ye.y;Ot!==0&&gt._mult(1/Ot),ne.push(gt._mult(F)._add(ge))}U.push(ne)}return U}(p,M*S)),function(L,F,U){for(let W=0;W<F.length;W++){const Z=F[W];if(L.length>=3){for(let ne=0;ne<Z.length;ne++)if(ou(L,Z[ne]))return!0}if(rg(L,Z,U))return!0}return!1}(C,p,P)}isTileClipped(){return!0}}function Cg(i,n){return n>0?n+2*i:i}const Ey=E([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),Ig=E([{name:"a_projected_pos",components:3,type:"Float32"}],4);E([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const kg=E([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_box_real",components:2,type:"Int16"}]);E([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const Ap=E([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),Cy=E([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function Iy(i,n,s){return i.sections.forEach(l=>{l.text=function(p,v,x){const S=v.layout.get("text-transform").evaluate(x,{});return S==="uppercase"?p=p.toLocaleUpperCase():S==="lowercase"&&(p=p.toLocaleLowerCase()),Ki.applyArabicShaping&&(p=Ki.applyArabicShaping(p)),p}(l.text,n,s)}),i}E([{name:"triangle",components:3,type:"Uint16"}]),E([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),E([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),E([{type:"Float32",name:"offsetX"}]),E([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),E([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);const Rh={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""};var Br=24,Pg=Kn,Ag=function(i,n,s,l,p){var v,x,S=8*p-l-1,C=(1<<S)-1,P=C>>1,M=-7,L=p-1,F=-1,U=i[n+L];for(L+=F,v=U&(1<<-M)-1,U>>=-M,M+=S;M>0;v=256*v+i[n+L],L+=F,M-=8);for(x=v&(1<<-M)-1,v>>=-M,M+=l;M>0;x=256*x+i[n+L],L+=F,M-=8);if(v===0)v=1-P;else{if(v===C)return x?NaN:1/0*(U?-1:1);x+=Math.pow(2,l),v-=P}return(U?-1:1)*x*Math.pow(2,v-l)},Mg=function(i,n,s,l,p,v){var x,S,C,P=8*v-p-1,M=(1<<P)-1,L=M>>1,F=p===23?Math.pow(2,-24)-Math.pow(2,-77):0,U=0,W=1,Z=n<0||n===0&&1/n<0?1:0;for(n=Math.abs(n),isNaN(n)||n===1/0?(S=isNaN(n)?1:0,x=M):(x=Math.floor(Math.log(n)/Math.LN2),n*(C=Math.pow(2,-x))<1&&(x--,C*=2),(n+=x+L>=1?F/C:F*Math.pow(2,1-L))*C>=2&&(x++,C/=2),x+L>=M?(S=0,x=M):x+L>=1?(S=(n*C-1)*Math.pow(2,p),x+=L):(S=n*Math.pow(2,L-1)*Math.pow(2,p),x=0));p>=8;i[s+U]=255&S,U+=W,S/=256,p-=8);for(x=x<<p|S,P+=p;P>0;i[s+U]=255&x,U+=W,x/=256,P-=8);i[s+U-W]|=128*Z};function Kn(i){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(i)?i:new Uint8Array(i||0),this.pos=0,this.type=0,this.length=this.buf.length}Kn.Varint=0,Kn.Fixed64=1,Kn.Bytes=2,Kn.Fixed32=5;var Mp=4294967296,zg=1/Mp,Ns=typeof TextDecoder>"u"?null:new TextDecoder("utf-8");function Na(i){return i.type===Kn.Bytes?i.readVarint()+i.pos:i.pos+1}function mc(i,n,s){return s?4294967296*n+(i>>>0):4294967296*(n>>>0)+(i>>>0)}function Dg(i,n,s){var l=n<=16383?1:n<=2097151?2:n<=268435455?3:Math.floor(Math.log(n)/(7*Math.LN2));s.realloc(l);for(var p=s.pos-1;p>=i;p--)s.buf[p+l]=s.buf[p]}function Lg(i,n){for(var s=0;s<i.length;s++)n.writeVarint(i[s])}function ky(i,n){for(var s=0;s<i.length;s++)n.writeSVarint(i[s])}function Py(i,n){for(var s=0;s<i.length;s++)n.writeFloat(i[s])}function Ay(i,n){for(var s=0;s<i.length;s++)n.writeDouble(i[s])}function My(i,n){for(var s=0;s<i.length;s++)n.writeBoolean(i[s])}function zp(i,n){for(var s=0;s<i.length;s++)n.writeFixed32(i[s])}function zy(i,n){for(var s=0;s<i.length;s++)n.writeSFixed32(i[s])}function Dy(i,n){for(var s=0;s<i.length;s++)n.writeFixed64(i[s])}function Ly(i,n){for(var s=0;s<i.length;s++)n.writeSFixed64(i[s])}function Jd(i,n){return(i[n]|i[n+1]<<8|i[n+2]<<16)+16777216*i[n+3]}function gc(i,n,s){i[s]=n,i[s+1]=n>>>8,i[s+2]=n>>>16,i[s+3]=n>>>24}function Rg(i,n){return(i[n]|i[n+1]<<8|i[n+2]<<16)+(i[n+3]<<24)}Kn.prototype={destroy:function(){this.buf=null},readFields:function(i,n,s){for(s=s||this.length;this.pos<s;){var l=this.readVarint(),p=l>>3,v=this.pos;this.type=7&l,i(p,n,this),this.pos===v&&this.skip(l)}return n},readMessage:function(i,n){return this.readFields(i,n,this.readVarint()+this.pos)},readFixed32:function(){var i=Jd(this.buf,this.pos);return this.pos+=4,i},readSFixed32:function(){var i=Rg(this.buf,this.pos);return this.pos+=4,i},readFixed64:function(){var i=Jd(this.buf,this.pos)+Jd(this.buf,this.pos+4)*Mp;return this.pos+=8,i},readSFixed64:function(){var i=Jd(this.buf,this.pos)+Rg(this.buf,this.pos+4)*Mp;return this.pos+=8,i},readFloat:function(){var i=Ag(this.buf,this.pos,!0,23,4);return this.pos+=4,i},readDouble:function(){var i=Ag(this.buf,this.pos,!0,52,8);return this.pos+=8,i},readVarint:function(i){var n,s,l=this.buf;return n=127&(s=l[this.pos++]),s<128?n:(n|=(127&(s=l[this.pos++]))<<7,s<128?n:(n|=(127&(s=l[this.pos++]))<<14,s<128?n:(n|=(127&(s=l[this.pos++]))<<21,s<128?n:function(p,v,x){var S,C,P=x.buf;if(S=(112&(C=P[x.pos++]))>>4,C<128||(S|=(127&(C=P[x.pos++]))<<3,C<128)||(S|=(127&(C=P[x.pos++]))<<10,C<128)||(S|=(127&(C=P[x.pos++]))<<17,C<128)||(S|=(127&(C=P[x.pos++]))<<24,C<128)||(S|=(1&(C=P[x.pos++]))<<31,C<128))return mc(p,S,v);throw new Error("Expected varint not more than 10 bytes")}(n|=(15&(s=l[this.pos]))<<28,i,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var i=this.readVarint();return i%2==1?(i+1)/-2:i/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var i=this.readVarint()+this.pos,n=this.pos;return this.pos=i,i-n>=12&&Ns?function(s,l,p){return Ns.decode(s.subarray(l,p))}(this.buf,n,i):function(s,l,p){for(var v="",x=l;x<p;){var S,C,P,M=s[x],L=null,F=M>239?4:M>223?3:M>191?2:1;if(x+F>p)break;F===1?M<128&&(L=M):F===2?(192&(S=s[x+1]))==128&&(L=(31&M)<<6|63&S)<=127&&(L=null):F===3?(C=s[x+2],(192&(S=s[x+1]))==128&&(192&C)==128&&((L=(15&M)<<12|(63&S)<<6|63&C)<=2047||L>=55296&&L<=57343)&&(L=null)):F===4&&(C=s[x+2],P=s[x+3],(192&(S=s[x+1]))==128&&(192&C)==128&&(192&P)==128&&((L=(15&M)<<18|(63&S)<<12|(63&C)<<6|63&P)<=65535||L>=1114112)&&(L=null)),L===null?(L=65533,F=1):L>65535&&(L-=65536,v+=String.fromCharCode(L>>>10&1023|55296),L=56320|1023&L),v+=String.fromCharCode(L),x+=F}return v}(this.buf,n,i)},readBytes:function(){var i=this.readVarint()+this.pos,n=this.buf.subarray(this.pos,i);return this.pos=i,n},readPackedVarint:function(i,n){if(this.type!==Kn.Bytes)return i.push(this.readVarint(n));var s=Na(this);for(i=i||[];this.pos<s;)i.push(this.readVarint(n));return i},readPackedSVarint:function(i){if(this.type!==Kn.Bytes)return i.push(this.readSVarint());var n=Na(this);for(i=i||[];this.pos<n;)i.push(this.readSVarint());return i},readPackedBoolean:function(i){if(this.type!==Kn.Bytes)return i.push(this.readBoolean());var n=Na(this);for(i=i||[];this.pos<n;)i.push(this.readBoolean());return i},readPackedFloat:function(i){if(this.type!==Kn.Bytes)return i.push(this.readFloat());var n=Na(this);for(i=i||[];this.pos<n;)i.push(this.readFloat());return i},readPackedDouble:function(i){if(this.type!==Kn.Bytes)return i.push(this.readDouble());var n=Na(this);for(i=i||[];this.pos<n;)i.push(this.readDouble());return i},readPackedFixed32:function(i){if(this.type!==Kn.Bytes)return i.push(this.readFixed32());var n=Na(this);for(i=i||[];this.pos<n;)i.push(this.readFixed32());return i},readPackedSFixed32:function(i){if(this.type!==Kn.Bytes)return i.push(this.readSFixed32());var n=Na(this);for(i=i||[];this.pos<n;)i.push(this.readSFixed32());return i},readPackedFixed64:function(i){if(this.type!==Kn.Bytes)return i.push(this.readFixed64());var n=Na(this);for(i=i||[];this.pos<n;)i.push(this.readFixed64());return i},readPackedSFixed64:function(i){if(this.type!==Kn.Bytes)return i.push(this.readSFixed64());var n=Na(this);for(i=i||[];this.pos<n;)i.push(this.readSFixed64());return i},skip:function(i){var n=7&i;if(n===Kn.Varint)for(;this.buf[this.pos++]>127;);else if(n===Kn.Bytes)this.pos=this.readVarint()+this.pos;else if(n===Kn.Fixed32)this.pos+=4;else{if(n!==Kn.Fixed64)throw new Error("Unimplemented type: "+n);this.pos+=8}},writeTag:function(i,n){this.writeVarint(i<<3|n)},realloc:function(i){for(var n=this.length||16;n<this.pos+i;)n*=2;if(n!==this.length){var s=new Uint8Array(n);s.set(this.buf),this.buf=s,this.length=n}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(i){this.realloc(4),gc(this.buf,i,this.pos),this.pos+=4},writeSFixed32:function(i){this.realloc(4),gc(this.buf,i,this.pos),this.pos+=4},writeFixed64:function(i){this.realloc(8),gc(this.buf,-1&i,this.pos),gc(this.buf,Math.floor(i*zg),this.pos+4),this.pos+=8},writeSFixed64:function(i){this.realloc(8),gc(this.buf,-1&i,this.pos),gc(this.buf,Math.floor(i*zg),this.pos+4),this.pos+=8},writeVarint:function(i){(i=+i||0)>268435455||i<0?function(n,s){var l,p;if(n>=0?(l=n%4294967296|0,p=n/4294967296|0):(p=~(-n/4294967296),4294967295^(l=~(-n%4294967296))?l=l+1|0:(l=0,p=p+1|0)),n>=18446744073709552e3||n<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");s.realloc(10),function(v,x,S){S.buf[S.pos++]=127&v|128,v>>>=7,S.buf[S.pos++]=127&v|128,v>>>=7,S.buf[S.pos++]=127&v|128,v>>>=7,S.buf[S.pos++]=127&v|128,S.buf[S.pos]=127&(v>>>=7)}(l,0,s),function(v,x){var S=(7&v)<<4;x.buf[x.pos++]|=S|((v>>>=3)?128:0),v&&(x.buf[x.pos++]=127&v|((v>>>=7)?128:0),v&&(x.buf[x.pos++]=127&v|((v>>>=7)?128:0),v&&(x.buf[x.pos++]=127&v|((v>>>=7)?128:0),v&&(x.buf[x.pos++]=127&v|((v>>>=7)?128:0),v&&(x.buf[x.pos++]=127&v)))))}(p,s)}(i,this):(this.realloc(4),this.buf[this.pos++]=127&i|(i>127?128:0),i<=127||(this.buf[this.pos++]=127&(i>>>=7)|(i>127?128:0),i<=127||(this.buf[this.pos++]=127&(i>>>=7)|(i>127?128:0),i<=127||(this.buf[this.pos++]=i>>>7&127))))},writeSVarint:function(i){this.writeVarint(i<0?2*-i-1:2*i)},writeBoolean:function(i){this.writeVarint(!!i)},writeString:function(i){i=String(i),this.realloc(4*i.length),this.pos++;var n=this.pos;this.pos=function(l,p,v){for(var x,S,C=0;C<p.length;C++){if((x=p.charCodeAt(C))>55295&&x<57344){if(!S){x>56319||C+1===p.length?(l[v++]=239,l[v++]=191,l[v++]=189):S=x;continue}if(x<56320){l[v++]=239,l[v++]=191,l[v++]=189,S=x;continue}x=S-55296<<10|x-56320|65536,S=null}else S&&(l[v++]=239,l[v++]=191,l[v++]=189,S=null);x<128?l[v++]=x:(x<2048?l[v++]=x>>6|192:(x<65536?l[v++]=x>>12|224:(l[v++]=x>>18|240,l[v++]=x>>12&63|128),l[v++]=x>>6&63|128),l[v++]=63&x|128)}return v}(this.buf,i,this.pos);var s=this.pos-n;s>=128&&Dg(n,s,this),this.pos=n-1,this.writeVarint(s),this.pos+=s},writeFloat:function(i){this.realloc(4),Mg(this.buf,i,this.pos,!0,23,4),this.pos+=4},writeDouble:function(i){this.realloc(8),Mg(this.buf,i,this.pos,!0,52,8),this.pos+=8},writeBytes:function(i){var n=i.length;this.writeVarint(n),this.realloc(n);for(var s=0;s<n;s++)this.buf[this.pos++]=i[s]},writeRawMessage:function(i,n){this.pos++;var s=this.pos;i(n,this);var l=this.pos-s;l>=128&&Dg(s,l,this),this.pos=s-1,this.writeVarint(l),this.pos+=l},writeMessage:function(i,n,s){this.writeTag(i,Kn.Bytes),this.writeRawMessage(n,s)},writePackedVarint:function(i,n){n.length&&this.writeMessage(i,Lg,n)},writePackedSVarint:function(i,n){n.length&&this.writeMessage(i,ky,n)},writePackedBoolean:function(i,n){n.length&&this.writeMessage(i,My,n)},writePackedFloat:function(i,n){n.length&&this.writeMessage(i,Py,n)},writePackedDouble:function(i,n){n.length&&this.writeMessage(i,Ay,n)},writePackedFixed32:function(i,n){n.length&&this.writeMessage(i,zp,n)},writePackedSFixed32:function(i,n){n.length&&this.writeMessage(i,zy,n)},writePackedFixed64:function(i,n){n.length&&this.writeMessage(i,Dy,n)},writePackedSFixed64:function(i,n){n.length&&this.writeMessage(i,Ly,n)},writeBytesField:function(i,n){this.writeTag(i,Kn.Bytes),this.writeBytes(n)},writeFixed32Field:function(i,n){this.writeTag(i,Kn.Fixed32),this.writeFixed32(n)},writeSFixed32Field:function(i,n){this.writeTag(i,Kn.Fixed32),this.writeSFixed32(n)},writeFixed64Field:function(i,n){this.writeTag(i,Kn.Fixed64),this.writeFixed64(n)},writeSFixed64Field:function(i,n){this.writeTag(i,Kn.Fixed64),this.writeSFixed64(n)},writeVarintField:function(i,n){this.writeTag(i,Kn.Varint),this.writeVarint(n)},writeSVarintField:function(i,n){this.writeTag(i,Kn.Varint),this.writeSVarint(n)},writeStringField:function(i,n){this.writeTag(i,Kn.Bytes),this.writeString(n)},writeFloatField:function(i,n){this.writeTag(i,Kn.Fixed32),this.writeFloat(n)},writeDoubleField:function(i,n){this.writeTag(i,Kn.Fixed64),this.writeDouble(n)},writeBooleanField:function(i,n){this.writeVarintField(i,!!n)}};var Dp=D(Pg);const Lp=3;function Ry(i,n,s){i===1&&s.readMessage(Oy,n)}function Oy(i,n,s){if(i===3){const{id:l,bitmap:p,width:v,height:x,left:S,top:C,advance:P}=s.readMessage(Fy,{});n.push({id:l,bitmap:new Ph({width:v+2*Lp,height:x+2*Lp},p),metrics:{width:v,height:x,left:S,top:C,advance:P}})}}function Fy(i,n,s){i===1?n.id=s.readVarint():i===2?n.bitmap=s.readBytes():i===3?n.width=s.readVarint():i===4?n.height=s.readVarint():i===5?n.left=s.readSVarint():i===6?n.top=s.readSVarint():i===7&&(n.advance=s.readVarint())}const Og=Lp;function Fg(i){let n=0,s=0;for(const x of i)n+=x.w*x.h,s=Math.max(s,x.w);i.sort((x,S)=>S.h-x.h);const l=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(n/.95)),s),h:1/0}];let p=0,v=0;for(const x of i)for(let S=l.length-1;S>=0;S--){const C=l[S];if(!(x.w>C.w||x.h>C.h)){if(x.x=C.x,x.y=C.y,v=Math.max(v,x.y+x.h),p=Math.max(p,x.x+x.w),x.w===C.w&&x.h===C.h){const P=l.pop();S<l.length&&(l[S]=P)}else x.h===C.h?(C.x+=x.w,C.w-=x.w):x.w===C.w?(C.y+=x.h,C.h-=x.h):(l.push({x:C.x+x.w,y:C.y,w:C.w-x.w,h:x.h}),C.y+=x.h,C.h-=x.h);break}}return{w:p,h:v,fill:n/(p*v)||0}}const Qi=1;class Rp{constructor(n,{pixelRatio:s,version:l,stretchX:p,stretchY:v,content:x,textFitWidth:S,textFitHeight:C}){this.paddedRect=n,this.pixelRatio=s,this.stretchX=p,this.stretchY=v,this.content=x,this.version=l,this.textFitWidth=S,this.textFitHeight=C}get tl(){return[this.paddedRect.x+Qi,this.paddedRect.y+Qi]}get br(){return[this.paddedRect.x+this.paddedRect.w-Qi,this.paddedRect.y+this.paddedRect.h-Qi]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2*Qi)/this.pixelRatio,(this.paddedRect.h-2*Qi)/this.pixelRatio]}}class Bg{constructor(n,s){const l={},p={};this.haveRenderCallbacks=[];const v=[];this.addImages(n,l,v),this.addImages(s,p,v);const{w:x,h:S}=Fg(v),C=new bs({width:x||1,height:S||1});for(const P in n){const M=n[P],L=l[P].paddedRect;bs.copy(M.data,C,{x:0,y:0},{x:L.x+Qi,y:L.y+Qi},M.data)}for(const P in s){const M=s[P],L=p[P].paddedRect,F=L.x+Qi,U=L.y+Qi,W=M.data.width,Z=M.data.height;bs.copy(M.data,C,{x:0,y:0},{x:F,y:U},M.data),bs.copy(M.data,C,{x:0,y:Z-1},{x:F,y:U-1},{width:W,height:1}),bs.copy(M.data,C,{x:0,y:0},{x:F,y:U+Z},{width:W,height:1}),bs.copy(M.data,C,{x:W-1,y:0},{x:F-1,y:U},{width:1,height:Z}),bs.copy(M.data,C,{x:0,y:0},{x:F+W,y:U},{width:1,height:Z})}this.image=C,this.iconPositions=l,this.patternPositions=p}addImages(n,s,l){for(const p in n){const v=n[p],x={x:0,y:0,w:v.data.width+2*Qi,h:v.data.height+2*Qi};l.push(x),s[p]=new Rp(x,v),v.hasRenderCallback&&this.haveRenderCallbacks.push(p)}}patchUpdatedImages(n,s){n.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const l in n.updatedImages)this.patchUpdatedImage(this.iconPositions[l],n.getImage(l),s),this.patchUpdatedImage(this.patternPositions[l],n.getImage(l),s)}patchUpdatedImage(n,s,l){if(!n||!s||n.version===s.version)return;n.version=s.version;const[p,v]=n.tl;l.update(s.data,void 0,{x:p,y:v})}}var kl;vt("ImagePosition",Rp),vt("ImageAtlas",Bg),w.ah=void 0,(kl=w.ah||(w.ah={}))[kl.none=0]="none",kl[kl.horizontal=1]="horizontal",kl[kl.vertical=2]="vertical",kl[kl.horizontalOnly=3]="horizontalOnly";const Oh=-17;class Fh{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(n,s){const l=new Fh;return l.scale=n||1,l.fontStack=s,l}static forImage(n){const s=new Fh;return s.imageName=n,s}}class _c{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(n,s){const l=new _c;for(let p=0;p<n.sections.length;p++){const v=n.sections[p];v.image?l.addImageSection(v):l.addTextSection(v,s)}return l}length(){return this.text.length}getSection(n){return this.sections[this.sectionIndex[n]]}getSectionIndex(n){return this.sectionIndex[n]}getCharCode(n){return this.text.charCodeAt(n)}verticalizePunctuation(){this.text=function(n){let s="";for(let l=0;l<n.length;l++){const p=n.charCodeAt(l+1)||null,v=n.charCodeAt(l-1)||null;s+=p&&Ld(p)&&!Rh[n[l+1]]||v&&Ld(v)&&!Rh[n[l-1]]||!Rh[n[l]]?n[l]:Rh[n[l]]}return s}(this.text)}trim(){let n=0;for(let l=0;l<this.text.length&&Bh[this.text.charCodeAt(l)];l++)n++;let s=this.text.length;for(let l=this.text.length-1;l>=0&&l>=n&&Bh[this.text.charCodeAt(l)];l--)s--;this.text=this.text.substring(n,s),this.sectionIndex=this.sectionIndex.slice(n,s)}substring(n,s){const l=new _c;return l.text=this.text.substring(n,s),l.sectionIndex=this.sectionIndex.slice(n,s),l.sections=this.sections,l}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((n,s)=>Math.max(n,this.sections[s].scale),0)}addTextSection(n,s){this.text+=n.text,this.sections.push(Fh.forText(n.scale,n.fontStack||s));const l=this.sections.length-1;for(let p=0;p<n.text.length;++p)this.sectionIndex.push(l)}addImageSection(n){const s=n.image?n.image.name:"";if(s.length===0)return void mt("Can't add FormattedSection with an empty image.");const l=this.getNextImageSectionCharCode();l?(this.text+=String.fromCharCode(l),this.sections.push(Fh.forImage(s)),this.sectionIndex.push(this.sections.length-1)):mt("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function yc(i,n,s,l,p,v,x,S,C,P,M,L,F,U,W){const Z=_c.fromFeature(i,p);let ne;L===w.ah.vertical&&Z.verticalizePunctuation();const{processBidirectionalText:oe,processStyledBidirectionalText:Pe}=Ki;if(oe&&Z.sections.length===1){ne=[];const Re=oe(Z.toString(),Op(Z,P,v,n,l,U));for(const Ye of Re){const gt=new _c;gt.text=Ye,gt.sections=Z.sections;for(let Ot=0;Ot<Ye.length;Ot++)gt.sectionIndex.push(0);ne.push(gt)}}else if(Pe){ne=[];const Re=Pe(Z.text,Z.sectionIndex,Op(Z,P,v,n,l,U));for(const Ye of Re){const gt=new _c;gt.text=Ye[0],gt.sectionIndex=Ye[1],gt.sections=Z.sections,ne.push(gt)}}else ne=function(Re,Ye){const gt=[],Ot=Re.text;let _t=0;for(const dt of Ye)gt.push(Re.substring(_t,dt)),_t=dt;return _t<Ot.length&&gt.push(Re.substring(_t,Ot.length)),gt}(Z,Op(Z,P,v,n,l,U));const ge=[],_e={positionedLines:ge,text:Z.toString(),top:M[1],bottom:M[1],left:M[0],right:M[0],writingMode:L,iconsInText:!1,verticalizable:!1};return function(Re,Ye,gt,Ot,_t,dt,Pt,xt,yt,$e,At,kt){let qt=0,tr=Oh,Yn=0,Qr=0;const Es=xt==="right"?1:xt==="left"?0:.5;let vi=0;for(const yn of _t){yn.trim();const $n=yn.getMaxScale(),ki=($n-1)*Br,xi={positionedGlyphs:[],lineOffset:0};Re.positionedLines[vi]=xi;const ji=xi.positionedGlyphs;let oi=0;if(!yn.length()){tr+=dt,++vi;continue}for(let es=0;es<yn.length();es++){const zn=yn.getSection(es),nr=yn.getSectionIndex(es),lr=yn.getCharCode(es);let Cs=0,Sr=null,vu=null,To=null,na=Br;const no=!(yt===w.ah.horizontal||!At&&!xh(lr)||At&&(Bh[lr]||(Nr=lr,new RegExp("\\p{sc=Arab}","u").test(String.fromCodePoint(Nr)))));if(zn.imageName){const js=Ot[zn.imageName];if(!js)continue;To=zn.imageName,Re.iconsInText=Re.iconsInText||!0,vu=js.paddedRect;const ai=js.displaySize;zn.scale=zn.scale*Br/kt,Sr={width:ai[0],height:ai[1],left:Qi,top:-Og,advance:no?ai[1]:ai[0]},Cs=ki+(Br-ai[1]*zn.scale),na=Sr.advance;const Is=no?ai[0]*zn.scale-Br*$n:ai[1]*zn.scale-Br*$n;Is>0&&Is>oi&&(oi=Is)}else{const js=gt[zn.fontStack],ai=js&&js[lr];if(ai&&ai.rect)vu=ai.rect,Sr=ai.metrics;else{const Is=Ye[zn.fontStack],Zh=Is&&Is[lr];if(!Zh)continue;Sr=Zh.metrics}Cs=($n-zn.scale)*Br}no?(Re.verticalizable=!0,ji.push({glyph:lr,imageName:To,x:qt,y:tr+Cs,vertical:no,scale:zn.scale,fontStack:zn.fontStack,sectionIndex:nr,metrics:Sr,rect:vu}),qt+=na*zn.scale+$e):(ji.push({glyph:lr,imageName:To,x:qt,y:tr+Cs,vertical:no,scale:zn.scale,fontStack:zn.fontStack,sectionIndex:nr,metrics:Sr,rect:vu}),qt+=Sr.advance*zn.scale+$e)}ji.length!==0&&(Yn=Math.max(qt-$e,Yn),jy(ji,0,ji.length-1,Es,oi)),qt=0;const Us=dt*$n+oi;xi.lineOffset=Math.max(oi,ki),tr+=Us,Qr=Math.max(Us,Qr),++vi}var Nr;const Bi=tr-Oh,{horizontalAlign:Ni,verticalAlign:Ui}=Qd(Pt);(function(yn,$n,ki,xi,ji,oi,Us,es,zn){const nr=($n-ki)*ji;let lr=0;lr=oi!==Us?-es*xi-Oh:(-xi*zn+.5)*Us;for(const Cs of yn)for(const Sr of Cs.positionedGlyphs)Sr.x+=nr,Sr.y+=lr})(Re.positionedLines,Es,Ni,Ui,Yn,Qr,dt,Bi,_t.length),Re.top+=-Ui*Bi,Re.bottom=Re.top+Bi,Re.left+=-Ni*Yn,Re.right=Re.left+Yn}(_e,n,s,l,ne,x,S,C,L,P,F,W),!function(Re){for(const Ye of Re)if(Ye.positionedGlyphs.length!==0)return!1;return!0}(ge)&&_e}const Bh={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},By={10:!0,32:!0,38:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0},Ny={40:!0};function Ng(i,n,s,l,p,v){if(n.imageName){const x=l[n.imageName];return x?x.displaySize[0]*n.scale*Br/v+p:0}{const x=s[n.fontStack],S=x&&x[i];return S?S.metrics.advance*n.scale+p:0}}function Ug(i,n,s,l){const p=Math.pow(i-n,2);return l?i<n?p/2:2*p:p+Math.abs(s)*s}function Uy(i,n,s){let l=0;return i===10&&(l-=1e4),s&&(l+=150),i!==40&&i!==65288||(l+=50),n!==41&&n!==65289||(l+=50),l}function jg(i,n,s,l,p,v){let x=null,S=Ug(n,s,p,v);for(const C of l){const P=Ug(n-C.x,s,p,v)+C.badness;P<=S&&(x=C,S=P)}return{index:i,x:n,priorBreak:x,badness:S}}function $g(i){return i?$g(i.priorBreak).concat(i.index):[]}function Op(i,n,s,l,p,v){if(!i)return[];const x=[],S=function(L,F,U,W,Z,ne){let oe=0;for(let Pe=0;Pe<L.length();Pe++){const ge=L.getSection(Pe);oe+=Ng(L.getCharCode(Pe),ge,W,Z,F,ne)}return oe/Math.max(1,Math.ceil(oe/U))}(i,n,s,l,p,v),C=i.text.indexOf("")>=0;let P=0;for(let L=0;L<i.length();L++){const F=i.getSection(L),U=i.getCharCode(L);if(Bh[U]||(P+=Ng(U,F,l,p,n,v)),L<i.length()-1){const W=!((M=U)<11904)&&(!!mn["CJK Compatibility Forms"](M)||!!mn["CJK Compatibility"](M)||!!mn["CJK Strokes"](M)||!!mn["CJK Symbols and Punctuation"](M)||!!mn["Enclosed CJK Letters and Months"](M)||!!mn["Halfwidth and Fullwidth Forms"](M)||!!mn["Ideographic Description Characters"](M)||!!mn["Vertical Forms"](M)||Dd.test(String.fromCodePoint(M)));(By[U]||W||F.imageName||L!==i.length()-2&&Ny[i.getCharCode(L+1)])&&x.push(jg(L+1,P,S,x,Uy(U,i.getCharCode(L+1),W&&C),!1))}}var M;return $g(jg(i.length(),P,S,x,0,!0))}function Qd(i){let n=.5,s=.5;switch(i){case"right":case"top-right":case"bottom-right":n=1;break;case"left":case"top-left":case"bottom-left":n=0}switch(i){case"bottom":case"bottom-right":case"bottom-left":s=1;break;case"top":case"top-right":case"top-left":s=0}return{horizontalAlign:n,verticalAlign:s}}function jy(i,n,s,l,p){if(!l&&!p)return;const v=i[s],x=(i[s].x+v.metrics.advance*v.scale)*l;for(let S=n;S<=s;S++)i[S].x-=x,i[S].y+=p}function ef(i,n,s){const{horizontalAlign:l,verticalAlign:p}=Qd(s),v=n[0]-i.displaySize[0]*l,x=n[1]-i.displaySize[1]*p;return{image:i,top:x,bottom:x+i.displaySize[1],left:v,right:v+i.displaySize[0]}}function Vg(i){var n,s;let l=i.left,p=i.top,v=i.right-l,x=i.bottom-p;const S=(n=i.image.textFitWidth)!==null&&n!==void 0?n:"stretchOrShrink",C=(s=i.image.textFitHeight)!==null&&s!==void 0?s:"stretchOrShrink",P=(i.image.content[2]-i.image.content[0])/(i.image.content[3]-i.image.content[1]);if(C==="proportional"){if(S==="stretchOnly"&&v/x<P||S==="proportional"){const M=Math.ceil(x*P);l*=M/v,v=M}}else if(S==="proportional"&&C==="stretchOnly"&&P!==0&&v/x>P){const M=Math.ceil(v/P);p*=M/x,x=M}return{x1:l,y1:p,x2:l+v,y2:p+x}}function qg(i,n,s,l,p,v){const x=i.image;let S;if(x.content){const ne=x.content,oe=x.pixelRatio||1;S=[ne[0]/oe,ne[1]/oe,x.displaySize[0]-ne[2]/oe,x.displaySize[1]-ne[3]/oe]}const C=n.left*v,P=n.right*v;let M,L,F,U;s==="width"||s==="both"?(U=p[0]+C-l[3],L=p[0]+P+l[1]):(U=p[0]+(C+P-x.displaySize[0])/2,L=U+x.displaySize[0]);const W=n.top*v,Z=n.bottom*v;return s==="height"||s==="both"?(M=p[1]+W-l[0],F=p[1]+Z+l[2]):(M=p[1]+(W+Z-x.displaySize[1])/2,F=M+x.displaySize[1]),{image:x,top:M,right:L,bottom:F,left:U,collisionPadding:S}}const Nh=255,ea=128,Pl=Nh*ea;function Zg(i,n){const{expression:s}=n;if(s.kind==="constant")return{kind:"constant",layoutSize:s.evaluate(new ar(i+1))};if(s.kind==="source")return{kind:"source"};{const{zoomStops:l,interpolationType:p}=s;let v=0;for(;v<l.length&&l[v]<=i;)v++;v=Math.max(0,v-1);let x=v;for(;x<l.length&&l[x]<i+1;)x++;x=Math.min(l.length-1,x);const S=l[v],C=l[x];return s.kind==="composite"?{kind:"composite",minZoom:S,maxZoom:C,interpolationType:p}:{kind:"camera",minZoom:S,maxZoom:C,minSize:s.evaluate(new ar(S)),maxSize:s.evaluate(new ar(C)),interpolationType:p}}}function Fp(i,n,s){let l="never";const p=i.get(n);return p?l=p:i.get(s)&&(l="always"),l}const $y=Fr.VectorTileFeature.types,Vy=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function tf(i,n,s,l,p,v,x,S,C,P,M,L,F){const U=S?Math.min(Pl,Math.round(S[0])):0,W=S?Math.min(Pl,Math.round(S[1])):0;i.emplaceBack(n,s,Math.round(32*l),Math.round(32*p),v,x,(U<<1)+(C?1:0),W,16*P,16*M,256*L,256*F)}function Bp(i,n,s){i.emplaceBack(n.x,n.y,s),i.emplaceBack(n.x,n.y,s),i.emplaceBack(n.x,n.y,s),i.emplaceBack(n.x,n.y,s)}function qy(i){for(const n of i.sections)if(lp(n.text))return!0;return!1}class Np{constructor(n){this.layoutVertexArray=new ac,this.indexArray=new vs,this.programConfigurations=n,this.segments=new gn,this.dynamicLayoutVertexArray=new za,this.opacityVertexArray=new _s,this.hasVisibleVertices=!1,this.placedSymbolArray=new sr}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(n,s,l,p){this.isEmpty()||(l&&(this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,Ey.members),this.indexBuffer=n.createIndexBuffer(this.indexArray,s),this.dynamicLayoutVertexBuffer=n.createVertexBuffer(this.dynamicLayoutVertexArray,Ig.members,!0),this.opacityVertexBuffer=n.createVertexBuffer(this.opacityVertexArray,Vy,!0),this.opacityVertexBuffer.itemSize=1),(l||p)&&this.programConfigurations.upload(n))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}vt("SymbolBuffers",Np);class Up{constructor(n,s,l){this.layoutVertexArray=new n,this.layoutAttributes=s,this.indexArray=new l,this.segments=new gn,this.collisionVertexArray=new eo}upload(n){this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=n.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=n.createVertexBuffer(this.collisionVertexArray,kg.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}vt("CollisionBuffers",Up);class vc{constructor(n){this.collisionBoxArray=n.collisionBoxArray,this.zoom=n.zoom,this.overscaling=n.overscaling,this.layers=n.layers,this.layerIds=this.layers.map(x=>x.id),this.index=n.index,this.pixelRatio=n.pixelRatio,this.sourceLayerIndex=n.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=qd([]),this.placementViewportMatrix=qd([]);const s=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Zg(this.zoom,s["text-size"]),this.iconSizeData=Zg(this.zoom,s["icon-size"]);const l=this.layers[0].layout,p=l.get("symbol-sort-key"),v=l.get("symbol-z-order");this.canOverlap=Fp(l,"text-overlap","text-allow-overlap")!=="never"||Fp(l,"icon-overlap","icon-allow-overlap")!=="never"||l.get("text-ignore-placement")||l.get("icon-ignore-placement"),this.sortFeaturesByKey=v!=="viewport-y"&&!p.isConstant(),this.sortFeaturesByY=(v==="viewport-y"||v==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,l.get("symbol-placement")==="point"&&(this.writingModes=l.get("text-writing-mode").map(x=>w.ah[x])),this.stateDependentLayerIds=this.layers.filter(x=>x.isStateDependent()).map(x=>x.id),this.sourceID=n.sourceID}createArrays(){this.text=new Np(new gi(this.layers,this.zoom,n=>/^text/.test(n))),this.icon=new Np(new gi(this.layers,this.zoom,n=>/^icon/.test(n))),this.glyphOffsetArray=new Xn,this.lineVertexArray=new Cr,this.symbolInstances=new un,this.textAnchorOffsets=new hn}calculateGlyphDependencies(n,s,l,p,v){for(let x=0;x<n.length;x++)if(s[n.charCodeAt(x)]=!0,(l||p)&&v){const S=Rh[n.charAt(x)];S&&(s[S.charCodeAt(0)]=!0)}}populate(n,s,l){const p=this.layers[0],v=p.layout,x=v.get("text-font"),S=v.get("text-field"),C=v.get("icon-image"),P=(S.value.kind!=="constant"||S.value.value instanceof Zi&&!S.value.value.isEmpty()||S.value.value.toString().length>0)&&(x.value.kind!=="constant"||x.value.value.length>0),M=C.value.kind!=="constant"||!!C.value.value||Object.keys(C.parameters).length>0,L=v.get("symbol-sort-key");if(this.features=[],!P&&!M)return;const F=s.iconDependencies,U=s.glyphDependencies,W=s.availableImages,Z=new ar(this.zoom);for(const{feature:ne,id:oe,index:Pe,sourceLayerIndex:ge}of n){const _e=p._featureFilter.needGeometry,Re=xs(ne,_e);if(!p._featureFilter.filter(Z,Re,l))continue;let Ye,gt;if(_e||(Re.geometry=si(ne)),P){const _t=p.getValueAndResolveTokens("text-field",Re,l,W),dt=Zi.factory(_t),Pt=this.hasRTLText=this.hasRTLText||qy(dt);(!Pt||Ki.getRTLTextPluginStatus()==="unavailable"||Pt&&Ki.isParsed())&&(Ye=Iy(dt,p,Re))}if(M){const _t=p.getValueAndResolveTokens("icon-image",Re,l,W);gt=_t instanceof Gi?_t:Gi.fromString(_t)}if(!Ye&&!gt)continue;const Ot=this.sortFeaturesByKey?L.evaluate(Re,{},l):void 0;if(this.features.push({id:oe,text:Ye,icon:gt,index:Pe,sourceLayerIndex:ge,geometry:Re.geometry,properties:ne.properties,type:$y[ne.type],sortKey:Ot}),gt&&(F[gt.name]=!0),Ye){const _t=x.evaluate(Re,{},l).join(","),dt=v.get("text-rotation-alignment")!=="viewport"&&v.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(w.ah.vertical)>=0;for(const Pt of Ye.sections)if(Pt.image)F[Pt.image.name]=!0;else{const xt=H(Ye.toString()),yt=Pt.fontStack||_t,$e=U[yt]=U[yt]||{};this.calculateGlyphDependencies(Pt.text,$e,dt,this.allowVerticalPlacement,xt)}}}v.get("symbol-placement")==="line"&&(this.features=function(ne){const oe={},Pe={},ge=[];let _e=0;function Re(_t){ge.push(ne[_t]),_e++}function Ye(_t,dt,Pt){const xt=Pe[_t];return delete Pe[_t],Pe[dt]=xt,ge[xt].geometry[0].pop(),ge[xt].geometry[0]=ge[xt].geometry[0].concat(Pt[0]),xt}function gt(_t,dt,Pt){const xt=oe[dt];return delete oe[dt],oe[_t]=xt,ge[xt].geometry[0].shift(),ge[xt].geometry[0]=Pt[0].concat(ge[xt].geometry[0]),xt}function Ot(_t,dt,Pt){const xt=Pt?dt[0][dt[0].length-1]:dt[0][0];return`${_t}:${xt.x}:${xt.y}`}for(let _t=0;_t<ne.length;_t++){const dt=ne[_t],Pt=dt.geometry,xt=dt.text?dt.text.toString():null;if(!xt){Re(_t);continue}const yt=Ot(xt,Pt),$e=Ot(xt,Pt,!0);if(yt in Pe&&$e in oe&&Pe[yt]!==oe[$e]){const At=gt(yt,$e,Pt),kt=Ye(yt,$e,ge[At].geometry);delete oe[yt],delete Pe[$e],Pe[Ot(xt,ge[kt].geometry,!0)]=kt,ge[At].geometry=null}else yt in Pe?Ye(yt,$e,Pt):$e in oe?gt(yt,$e,Pt):(Re(_t),oe[yt]=_e-1,Pe[$e]=_e-1)}return ge.filter(_t=>_t.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((ne,oe)=>ne.sortKey-oe.sortKey)}update(n,s,l){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(n,s,this.layers,l),this.icon.programConfigurations.updatePaintArrays(n,s,this.layers,l))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(n){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(n),this.iconCollisionBox.upload(n)),this.text.upload(n,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(n,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(n,s){const l=this.lineVertexArray.length;if(n.segment!==void 0){let p=n.dist(s[n.segment+1]),v=n.dist(s[n.segment]);const x={};for(let S=n.segment+1;S<s.length;S++)x[S]={x:s[S].x,y:s[S].y,tileUnitDistanceFromAnchor:p},S<s.length-1&&(p+=s[S+1].dist(s[S]));for(let S=n.segment||0;S>=0;S--)x[S]={x:s[S].x,y:s[S].y,tileUnitDistanceFromAnchor:v},S>0&&(v+=s[S-1].dist(s[S]));for(let S=0;S<s.length;S++){const C=x[S];this.lineVertexArray.emplaceBack(C.x,C.y,C.tileUnitDistanceFromAnchor)}}return{lineStartIndex:l,lineLength:this.lineVertexArray.length-l}}addSymbols(n,s,l,p,v,x,S,C,P,M,L,F){const U=n.indexArray,W=n.layoutVertexArray,Z=n.segments.prepareSegment(4*s.length,W,U,this.canOverlap?x.sortKey:void 0),ne=this.glyphOffsetArray.length,oe=Z.vertexLength,Pe=this.allowVerticalPlacement&&S===w.ah.vertical?Math.PI/2:0,ge=x.text&&x.text.sections;for(let _e=0;_e<s.length;_e++){const{tl:Re,tr:Ye,bl:gt,br:Ot,tex:_t,pixelOffsetTL:dt,pixelOffsetBR:Pt,minFontScaleX:xt,minFontScaleY:yt,glyphOffset:$e,isSDF:At,sectionIndex:kt}=s[_e],qt=Z.vertexLength,tr=$e[1];tf(W,C.x,C.y,Re.x,tr+Re.y,_t.x,_t.y,l,At,dt.x,dt.y,xt,yt),tf(W,C.x,C.y,Ye.x,tr+Ye.y,_t.x+_t.w,_t.y,l,At,Pt.x,dt.y,xt,yt),tf(W,C.x,C.y,gt.x,tr+gt.y,_t.x,_t.y+_t.h,l,At,dt.x,Pt.y,xt,yt),tf(W,C.x,C.y,Ot.x,tr+Ot.y,_t.x+_t.w,_t.y+_t.h,l,At,Pt.x,Pt.y,xt,yt),Bp(n.dynamicLayoutVertexArray,C,Pe),U.emplaceBack(qt,qt+1,qt+2),U.emplaceBack(qt+1,qt+2,qt+3),Z.vertexLength+=4,Z.primitiveLength+=2,this.glyphOffsetArray.emplaceBack($e[0]),_e!==s.length-1&&kt===s[_e+1].sectionIndex||n.programConfigurations.populatePaintArrays(W.length,x,x.index,{},F,ge&&ge[kt])}n.placedSymbolArray.emplaceBack(C.x,C.y,ne,this.glyphOffsetArray.length-ne,oe,P,M,C.segment,l?l[0]:0,l?l[1]:0,p[0],p[1],S,0,!1,0,L)}_addCollisionDebugVertex(n,s,l,p,v,x){return s.emplaceBack(0,0),n.emplaceBack(l.x,l.y,p,v,Math.round(x.x),Math.round(x.y))}addCollisionDebugVertices(n,s,l,p,v,x,S){const C=v.segments.prepareSegment(4,v.layoutVertexArray,v.indexArray),P=C.vertexLength,M=v.layoutVertexArray,L=v.collisionVertexArray,F=S.anchorX,U=S.anchorY;this._addCollisionDebugVertex(M,L,x,F,U,new G(n,s)),this._addCollisionDebugVertex(M,L,x,F,U,new G(l,s)),this._addCollisionDebugVertex(M,L,x,F,U,new G(l,p)),this._addCollisionDebugVertex(M,L,x,F,U,new G(n,p)),C.vertexLength+=4;const W=v.indexArray;W.emplaceBack(P,P+1),W.emplaceBack(P+1,P+2),W.emplaceBack(P+2,P+3),W.emplaceBack(P+3,P),C.primitiveLength+=4}addDebugCollisionBoxes(n,s,l,p){for(let v=n;v<s;v++){const x=this.collisionBoxArray.get(v);this.addCollisionDebugVertices(x.x1,x.y1,x.x2,x.y2,p?this.textCollisionBox:this.iconCollisionBox,x.anchorPoint,l)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new Up(ys,Ap.members,ii),this.iconCollisionBox=new Up(ys,Ap.members,ii);for(let n=0;n<this.symbolInstances.length;n++){const s=this.symbolInstances.get(n);this.addDebugCollisionBoxes(s.textBoxStartIndex,s.textBoxEndIndex,s,!0),this.addDebugCollisionBoxes(s.verticalTextBoxStartIndex,s.verticalTextBoxEndIndex,s,!0),this.addDebugCollisionBoxes(s.iconBoxStartIndex,s.iconBoxEndIndex,s,!1),this.addDebugCollisionBoxes(s.verticalIconBoxStartIndex,s.verticalIconBoxEndIndex,s,!1)}}_deserializeCollisionBoxesForSymbol(n,s,l,p,v,x,S,C,P){const M={};for(let L=s;L<l;L++){const F=n.get(L);M.textBox={x1:F.x1,y1:F.y1,x2:F.x2,y2:F.y2,anchorPointX:F.anchorPointX,anchorPointY:F.anchorPointY},M.textFeatureIndex=F.featureIndex;break}for(let L=p;L<v;L++){const F=n.get(L);M.verticalTextBox={x1:F.x1,y1:F.y1,x2:F.x2,y2:F.y2,anchorPointX:F.anchorPointX,anchorPointY:F.anchorPointY},M.verticalTextFeatureIndex=F.featureIndex;break}for(let L=x;L<S;L++){const F=n.get(L);M.iconBox={x1:F.x1,y1:F.y1,x2:F.x2,y2:F.y2,anchorPointX:F.anchorPointX,anchorPointY:F.anchorPointY},M.iconFeatureIndex=F.featureIndex;break}for(let L=C;L<P;L++){const F=n.get(L);M.verticalIconBox={x1:F.x1,y1:F.y1,x2:F.x2,y2:F.y2,anchorPointX:F.anchorPointX,anchorPointY:F.anchorPointY},M.verticalIconFeatureIndex=F.featureIndex;break}return M}deserializeCollisionBoxes(n){this.collisionArrays=[];for(let s=0;s<this.symbolInstances.length;s++){const l=this.symbolInstances.get(s);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(n,l.textBoxStartIndex,l.textBoxEndIndex,l.verticalTextBoxStartIndex,l.verticalTextBoxEndIndex,l.iconBoxStartIndex,l.iconBoxEndIndex,l.verticalIconBoxStartIndex,l.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(n,s){const l=n.placedSymbolArray.get(s),p=l.vertexStartIndex+4*l.numGlyphs;for(let v=l.vertexStartIndex;v<p;v+=4)n.indexArray.emplaceBack(v,v+1,v+2),n.indexArray.emplaceBack(v+1,v+2,v+3)}getSortedSymbolIndexes(n){if(this.sortedAngle===n&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const s=Math.sin(n),l=Math.cos(n),p=[],v=[],x=[];for(let S=0;S<this.symbolInstances.length;++S){x.push(S);const C=this.symbolInstances.get(S);p.push(0|Math.round(s*C.anchorX+l*C.anchorY)),v.push(C.featureIndex)}return x.sort((S,C)=>p[S]-p[C]||v[C]-v[S]),x}addToSortKeyRanges(n,s){const l=this.sortKeyRanges[this.sortKeyRanges.length-1];l&&l.sortKey===s?l.symbolInstanceEnd=n+1:this.sortKeyRanges.push({sortKey:s,symbolInstanceStart:n,symbolInstanceEnd:n+1})}sortFeatures(n){if(this.sortFeaturesByY&&this.sortedAngle!==n&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(n),this.sortedAngle=n,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const s of this.symbolInstanceIndexes){const l=this.symbolInstances.get(s);this.featureSortOrder.push(l.featureIndex),[l.rightJustifiedTextSymbolIndex,l.centerJustifiedTextSymbolIndex,l.leftJustifiedTextSymbolIndex].forEach((p,v,x)=>{p>=0&&x.indexOf(p)===v&&this.addIndicesForPlacedSymbol(this.text,p)}),l.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,l.verticalPlacedTextSymbolIndex),l.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,l.placedIconSymbolIndex),l.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,l.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let Wg,jp;vt("SymbolBucket",vc,{omit:["layers","collisionBoxArray","features","compareText"]}),vc.MAX_GLYPHS=65535,vc.addDynamicAttributes=Bp;var nf={get paint(){return jp=jp||new y({"icon-opacity":new Ft(Ce.paint_symbol["icon-opacity"]),"icon-color":new Ft(Ce.paint_symbol["icon-color"]),"icon-halo-color":new Ft(Ce.paint_symbol["icon-halo-color"]),"icon-halo-width":new Ft(Ce.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Ft(Ce.paint_symbol["icon-halo-blur"]),"icon-translate":new Ct(Ce.paint_symbol["icon-translate"]),"icon-translate-anchor":new Ct(Ce.paint_symbol["icon-translate-anchor"]),"text-opacity":new Ft(Ce.paint_symbol["text-opacity"]),"text-color":new Ft(Ce.paint_symbol["text-color"],{runtimeType:hi,getOverride:i=>i.textColor,hasOverride:i=>!!i.textColor}),"text-halo-color":new Ft(Ce.paint_symbol["text-halo-color"]),"text-halo-width":new Ft(Ce.paint_symbol["text-halo-width"]),"text-halo-blur":new Ft(Ce.paint_symbol["text-halo-blur"]),"text-translate":new Ct(Ce.paint_symbol["text-translate"]),"text-translate-anchor":new Ct(Ce.paint_symbol["text-translate-anchor"])})},get layout(){return Wg=Wg||new y({"symbol-placement":new Ct(Ce.layout_symbol["symbol-placement"]),"symbol-spacing":new Ct(Ce.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Ct(Ce.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Ft(Ce.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Ct(Ce.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Ct(Ce.layout_symbol["icon-allow-overlap"]),"icon-overlap":new Ct(Ce.layout_symbol["icon-overlap"]),"icon-ignore-placement":new Ct(Ce.layout_symbol["icon-ignore-placement"]),"icon-optional":new Ct(Ce.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Ct(Ce.layout_symbol["icon-rotation-alignment"]),"icon-size":new Ft(Ce.layout_symbol["icon-size"]),"icon-text-fit":new Ct(Ce.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Ct(Ce.layout_symbol["icon-text-fit-padding"]),"icon-image":new Ft(Ce.layout_symbol["icon-image"]),"icon-rotate":new Ft(Ce.layout_symbol["icon-rotate"]),"icon-padding":new Ft(Ce.layout_symbol["icon-padding"]),"icon-keep-upright":new Ct(Ce.layout_symbol["icon-keep-upright"]),"icon-offset":new Ft(Ce.layout_symbol["icon-offset"]),"icon-anchor":new Ft(Ce.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Ct(Ce.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Ct(Ce.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Ct(Ce.layout_symbol["text-rotation-alignment"]),"text-field":new Ft(Ce.layout_symbol["text-field"]),"text-font":new Ft(Ce.layout_symbol["text-font"]),"text-size":new Ft(Ce.layout_symbol["text-size"]),"text-max-width":new Ft(Ce.layout_symbol["text-max-width"]),"text-line-height":new Ct(Ce.layout_symbol["text-line-height"]),"text-letter-spacing":new Ft(Ce.layout_symbol["text-letter-spacing"]),"text-justify":new Ft(Ce.layout_symbol["text-justify"]),"text-radial-offset":new Ft(Ce.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Ct(Ce.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new Ft(Ce.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new Ft(Ce.layout_symbol["text-anchor"]),"text-max-angle":new Ct(Ce.layout_symbol["text-max-angle"]),"text-writing-mode":new Ct(Ce.layout_symbol["text-writing-mode"]),"text-rotate":new Ft(Ce.layout_symbol["text-rotate"]),"text-padding":new Ct(Ce.layout_symbol["text-padding"]),"text-keep-upright":new Ct(Ce.layout_symbol["text-keep-upright"]),"text-transform":new Ft(Ce.layout_symbol["text-transform"]),"text-offset":new Ft(Ce.layout_symbol["text-offset"]),"text-allow-overlap":new Ct(Ce.layout_symbol["text-allow-overlap"]),"text-overlap":new Ct(Ce.layout_symbol["text-overlap"]),"text-ignore-placement":new Ct(Ce.layout_symbol["text-ignore-placement"]),"text-optional":new Ct(Ce.layout_symbol["text-optional"])})}};class Gg{constructor(n){if(n.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=n.property.overrides?n.property.overrides.runtimeType:Pr,this.defaultValue=n}evaluate(n){if(n.formattedSection){const s=this.defaultValue.property.overrides;if(s&&s.hasOverride(n.formattedSection))return s.getOverride(n.formattedSection)}return n.feature&&n.featureState?this.defaultValue.evaluate(n.feature,n.featureState):this.defaultValue.property.specification.default}eachChild(n){this.defaultValue.isConstant()||n(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}vt("FormatSectionOverride",Gg,{omit:["defaultValue"]});class rf extends a{constructor(n){super(n,nf)}recalculate(n,s){if(super.recalculate(n,s),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const l=this.layout.get("text-writing-mode");if(l){const p=[];for(const v of l)p.indexOf(v)<0&&p.push(v);this.layout._values["text-writing-mode"]=p}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(n,s,l,p){const v=this.layout.get(n).evaluate(s,{},l,p),x=this._unevaluatedLayout._values[n];return x.isDataDriven()||Tt(x.value)||!v?v:function(S,C){return C.replace(/{([^{}]+)}/g,(P,M)=>S&&M in S?String(S[M]):"")}(s.properties,v)}createBucket(n){return new vc(n)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const n of nf.paint.overridableProperties){if(!rf.hasPaintOverride(this.layout,n))continue;const s=this.paint.get(n),l=new Gg(s),p=new Oe(l,s.property.specification);let v=null;v=s.value.kind==="constant"||s.value.kind==="source"?new Tn("source",p):new gr("composite",p,s.value.zoomStops),this.paint._values[n]=new Jr(s.property,v,s.parameters)}}_handleOverridablePaintPropertyUpdate(n,s,l){return!(!this.layout||s.isDataDriven()||l.isDataDriven())&&rf.hasPaintOverride(this.layout,n)}static hasPaintOverride(n,s){const l=n.get("text-field"),p=nf.paint.properties[s];let v=!1;const x=S=>{for(const C of S)if(p.overrides&&p.overrides.hasOverride(C))return void(v=!0)};if(l.value.kind==="constant"&&l.value.value instanceof Zi)x(l.value.value.sections);else if(l.value.kind==="source"){const S=P=>{v||(P instanceof as&&Or(P.value)===uo?x(P.value.sections):P instanceof qu?x(P.sections):P.eachChild(S))},C=l.value;C._styleExpression&&S(C._styleExpression.expression)}return v}}let Hg;var Zy={get paint(){return Hg=Hg||new y({"background-color":new Ct(Ce.paint_background["background-color"]),"background-pattern":new oc(Ce.paint_background["background-pattern"]),"background-opacity":new Ct(Ce.paint_background["background-opacity"])})}};class sf extends a{constructor(n){super(n,Zy)}}let Xg;var Wy={get paint(){return Xg=Xg||new y({"raster-opacity":new Ct(Ce.paint_raster["raster-opacity"]),"raster-hue-rotate":new Ct(Ce.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Ct(Ce.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Ct(Ce.paint_raster["raster-brightness-max"]),"raster-saturation":new Ct(Ce.paint_raster["raster-saturation"]),"raster-contrast":new Ct(Ce.paint_raster["raster-contrast"]),"raster-resampling":new Ct(Ce.paint_raster["raster-resampling"]),"raster-fade-duration":new Ct(Ce.paint_raster["raster-fade-duration"])})}};class Gy extends a{constructor(n){super(n,Wy)}}class Hy extends a{constructor(n){super(n,{}),this.onAdd=s=>{this.implementation.onAdd&&this.implementation.onAdd(s,s.painter.context.gl)},this.onRemove=s=>{this.implementation.onRemove&&this.implementation.onRemove(s,s.painter.context.gl)},this.implementation=n}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class Xy{constructor(n){this._methodToThrottle=n,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._methodToThrottle()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._methodToThrottle()},0))}remove(){delete this._channel,this._methodToThrottle=()=>{}}}const $p=63710088e-1;class Al{constructor(n,s){if(isNaN(n)||isNaN(s))throw new Error(`Invalid LngLat object: (${n}, ${s})`);if(this.lng=+n,this.lat=+s,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new Al(je(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(n){const s=Math.PI/180,l=this.lat*s,p=n.lat*s,v=Math.sin(l)*Math.sin(p)+Math.cos(l)*Math.cos(p)*Math.cos((n.lng-this.lng)*s);return $p*Math.acos(Math.min(v,1))}static convert(n){if(n instanceof Al)return n;if(Array.isArray(n)&&(n.length===2||n.length===3))return new Al(Number(n[0]),Number(n[1]));if(!Array.isArray(n)&&typeof n=="object"&&n!==null)return new Al(Number("lng"in n?n.lng:n.lon),Number(n.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const Kg=2*Math.PI*$p;function Yg(i){return Kg*Math.cos(i*Math.PI/180)}function Jg(i){return(180+i)/360}function Qg(i){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+i*Math.PI/360)))/360}function Uh(i,n){return i/Yg(n)}function Vp(i){return 360/Math.PI*Math.atan(Math.exp((180-360*i)*Math.PI/180))-90}class xc{constructor(n,s,l=0){this.x=+n,this.y=+s,this.z=+l}static fromLngLat(n,s=0){const l=Al.convert(n);return new xc(Jg(l.lng),Qg(l.lat),Uh(s,l.lat))}toLngLat(){return new Al(360*this.x-180,Vp(this.y))}toAltitude(){return this.z*Yg(Vp(this.y))}meterInMercatorCoordinateUnits(){return 1/Kg*(n=Vp(this.y),1/Math.cos(n*Math.PI/180));var n}}function qp(i,n,s){var l=2*Math.PI*6378137/256/Math.pow(2,s);return[i*l-2*Math.PI*6378137/2,n*l-2*Math.PI*6378137/2]}class jh{constructor(n,s,l){if(!function(p,v,x){return!(p<0||p>25||x<0||x>=Math.pow(2,p)||v<0||v>=Math.pow(2,p))}(n,s,l))throw new Error(`x=${s}, y=${l}, z=${n} outside of bounds. 0<=x<${Math.pow(2,n)}, 0<=y<${Math.pow(2,n)} 0<=z<=25 `);this.z=n,this.x=s,this.y=l,this.key=wc(0,n,n,s,l)}equals(n){return this.z===n.z&&this.x===n.x&&this.y===n.y}url(n,s,l){const p=(x=this.y,S=this.z,C=qp(256*(v=this.x),256*(x=Math.pow(2,S)-x-1),S),P=qp(256*(v+1),256*(x+1),S),C[0]+","+C[1]+","+P[0]+","+P[1]);var v,x,S,C,P;const M=function(L,F,U){let W,Z="";for(let ne=L;ne>0;ne--)W=1<<ne-1,Z+=(F&W?1:0)+(U&W?2:0);return Z}(this.z,this.x,this.y);return n[(this.x+this.y)%n.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(l==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,s>1?"@2x":"").replace(/{quadkey}/g,M).replace(/{bbox-epsg-3857}/g,p)}isChildOf(n){const s=this.z-n.z;return s>0&&n.x===this.x>>s&&n.y===this.y>>s}getTilePoint(n){const s=Math.pow(2,this.z);return new G((n.x*s-this.x)*Ir,(n.y*s-this.y)*Ir)}toString(){return`${this.z}/${this.x}/${this.y}`}}class Zp{constructor(n,s){this.wrap=n,this.canonical=s,this.key=wc(n,s.z,s.z,s.x,s.y)}}class Ss{constructor(n,s,l,p,v){if(n<l)throw new Error(`overscaledZ should be >= z; overscaledZ = ${n}; z = ${l}`);this.overscaledZ=n,this.wrap=s,this.canonical=new jh(l,+p,+v),this.key=wc(s,n,l,p,v)}clone(){return new Ss(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(n){return this.overscaledZ===n.overscaledZ&&this.wrap===n.wrap&&this.canonical.equals(n.canonical)}scaledTo(n){if(n>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${n}; overscaledZ = ${this.overscaledZ}`);const s=this.canonical.z-n;return n>this.canonical.z?new Ss(n,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Ss(n,this.wrap,n,this.canonical.x>>s,this.canonical.y>>s)}calculateScaledKey(n,s){if(n>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${n}; overscaledZ = ${this.overscaledZ}`);const l=this.canonical.z-n;return n>this.canonical.z?wc(this.wrap*+s,n,this.canonical.z,this.canonical.x,this.canonical.y):wc(this.wrap*+s,n,n,this.canonical.x>>l,this.canonical.y>>l)}isChildOf(n){if(n.wrap!==this.wrap)return!1;const s=this.canonical.z-n.canonical.z;return n.overscaledZ===0||n.overscaledZ<this.overscaledZ&&n.canonical.x===this.canonical.x>>s&&n.canonical.y===this.canonical.y>>s}children(n){if(this.overscaledZ>=n)return[new Ss(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const s=this.canonical.z+1,l=2*this.canonical.x,p=2*this.canonical.y;return[new Ss(s,this.wrap,s,l,p),new Ss(s,this.wrap,s,l+1,p),new Ss(s,this.wrap,s,l,p+1),new Ss(s,this.wrap,s,l+1,p+1)]}isLessThan(n){return this.wrap<n.wrap||!(this.wrap>n.wrap)&&(this.overscaledZ<n.overscaledZ||!(this.overscaledZ>n.overscaledZ)&&(this.canonical.x<n.canonical.x||!(this.canonical.x>n.canonical.x)&&this.canonical.y<n.canonical.y))}wrapped(){return new Ss(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(n){return new Ss(this.overscaledZ,n,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new Zp(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(n){return this.canonical.getTilePoint(new xc(n.x-this.wrap,n.y))}}function wc(i,n,s,l,p){(i*=2)<0&&(i=-1*i-1);const v=1<<s;return(v*v*i+v*p+l).toString(36)+s.toString(36)+n.toString(36)}vt("CanonicalTileID",jh),vt("OverscaledTileID",Ss,{omit:["posMatrix"]});class Wp{constructor(n,s,l,p=1,v=1,x=1,S=0){if(this.uid=n,s.height!==s.width)throw new RangeError("DEM tiles must be square");if(l&&!["mapbox","terrarium","custom"].includes(l))return void mt(`"${l}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);this.stride=s.height;const C=this.dim=s.height-2;switch(this.data=new Uint32Array(s.data.buffer),l){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=p,this.greenFactor=v,this.blueFactor=x,this.baseShift=S;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let P=0;P<C;P++)this.data[this._idx(-1,P)]=this.data[this._idx(0,P)],this.data[this._idx(C,P)]=this.data[this._idx(C-1,P)],this.data[this._idx(P,-1)]=this.data[this._idx(P,0)],this.data[this._idx(P,C)]=this.data[this._idx(P,C-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(C,-1)]=this.data[this._idx(C-1,0)],this.data[this._idx(-1,C)]=this.data[this._idx(0,C-1)],this.data[this._idx(C,C)]=this.data[this._idx(C-1,C-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let P=0;P<C;P++)for(let M=0;M<C;M++){const L=this.get(P,M);L>this.max&&(this.max=L),L<this.min&&(this.min=L)}}get(n,s){const l=new Uint8Array(this.data.buffer),p=4*this._idx(n,s);return this.unpack(l[p],l[p+1],l[p+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(n,s){if(n<-1||n>=this.dim+1||s<-1||s>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(s+1)*this.stride+(n+1)}unpack(n,s,l){return n*this.redFactor+s*this.greenFactor+l*this.blueFactor-this.baseShift}getPixels(){return new bs({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(n,s,l){if(this.dim!==n.dim)throw new Error("dem dimension mismatch");let p=s*this.dim,v=s*this.dim+this.dim,x=l*this.dim,S=l*this.dim+this.dim;switch(s){case-1:p=v-1;break;case 1:v=p+1}switch(l){case-1:x=S-1;break;case 1:S=x+1}const C=-s*this.dim,P=-l*this.dim;for(let M=x;M<S;M++)for(let L=p;L<v;L++)this.data[this._idx(L,M)]=n.data[this._idx(L+C,M+P)]}}vt("DEMData",Wp);class e_{constructor(n){this._stringToNumber={},this._numberToString=[];for(let s=0;s<n.length;s++){const l=n[s];this._stringToNumber[l]=s,this._numberToString[s]=l}}encode(n){return this._stringToNumber[n]}decode(n){if(n>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${n} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[n]}}class t_{constructor(n,s,l,p,v){this.type="Feature",this._vectorTileFeature=n,n._z=s,n._x=l,n._y=p,this.properties=n.properties,this.id=v}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(n){this._geometry=n}toJSON(){const n={geometry:this.geometry};for(const s in this)s!=="_geometry"&&s!=="_vectorTileFeature"&&(n[s]=this[s]);return n}}class n_{constructor(n,s){this.tileID=n,this.x=n.canonical.x,this.y=n.canonical.y,this.z=n.canonical.z,this.grid=new vo(Ir,16,0),this.grid3D=new vo(Ir,16,0),this.featureIndexArray=new Ci,this.promoteId=s}insert(n,s,l,p,v,x){const S=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(l,p,v);const C=x?this.grid3D:this.grid;for(let P=0;P<s.length;P++){const M=s[P],L=[1/0,1/0,-1/0,-1/0];for(let F=0;F<M.length;F++){const U=M[F];L[0]=Math.min(L[0],U.x),L[1]=Math.min(L[1],U.y),L[2]=Math.max(L[2],U.x),L[3]=Math.max(L[3],U.y)}L[0]<Ir&&L[1]<Ir&&L[2]>=0&&L[3]>=0&&C.insert(S,L[0],L[1],L[2],L[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new Fr.VectorTile(new Dp(this.rawTileData)).layers,this.sourceLayerCoder=new e_(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(n,s,l,p){this.loadVTLayers();const v=n.params||{},x=Ir/n.tileSize/n.scale,S=fh(v.filter),C=n.queryGeometry,P=n.queryPadding*x,M=Vh(C),L=this.grid.query(M.minX-P,M.minY-P,M.maxX+P,M.maxY+P),F=Vh(n.cameraQueryGeometry),U=this.grid3D.query(F.minX-P,F.minY-P,F.maxX+P,F.maxY+P,(ne,oe,Pe,ge)=>function(_e,Re,Ye,gt,Ot){for(const dt of _e)if(Re<=dt.x&&Ye<=dt.y&&gt>=dt.x&&Ot>=dt.y)return!0;const _t=[new G(Re,Ye),new G(Re,Ot),new G(gt,Ot),new G(gt,Ye)];if(_e.length>2){for(const dt of _t)if(ou(_e,dt))return!0}for(let dt=0;dt<_e.length-1;dt++)if(sg(_e[dt],_e[dt+1],_t))return!0;return!1}(n.cameraQueryGeometry,ne-P,oe-P,Pe+P,ge+P));for(const ne of U)L.push(ne);L.sort(Ky);const W={};let Z;for(let ne=0;ne<L.length;ne++){const oe=L[ne];if(oe===Z)continue;Z=oe;const Pe=this.featureIndexArray.get(oe);let ge=null;this.loadMatchingFeature(W,Pe.bucketIndex,Pe.sourceLayerIndex,Pe.featureIndex,S,v.layers,v.availableImages,s,l,p,(_e,Re,Ye)=>(ge||(ge=si(_e)),Re.queryIntersectsFeature(C,_e,Ye,ge,this.z,n.transform,x,n.pixelPosMatrix)))}return W}loadMatchingFeature(n,s,l,p,v,x,S,C,P,M,L){const F=this.bucketLayerIDs[s];if(x&&!function(ne,oe){for(let Pe=0;Pe<ne.length;Pe++)if(oe.indexOf(ne[Pe])>=0)return!0;return!1}(x,F))return;const U=this.sourceLayerCoder.decode(l),W=this.vtLayers[U].feature(p);if(v.needGeometry){const ne=xs(W,!0);if(!v.filter(new ar(this.tileID.overscaledZ),ne,this.tileID.canonical))return}else if(!v.filter(new ar(this.tileID.overscaledZ),W))return;const Z=this.getId(W,U);for(let ne=0;ne<F.length;ne++){const oe=F[ne];if(x&&x.indexOf(oe)<0)continue;const Pe=C[oe];if(!Pe)continue;let ge={};Z&&M&&(ge=M.getState(Pe.sourceLayer||"_geojsonTileLayer",Z));const _e=ve({},P[oe]);_e.paint=$h(_e.paint,Pe.paint,W,ge,S),_e.layout=$h(_e.layout,Pe.layout,W,ge,S);const Re=!L||L(W,Pe,ge);if(!Re)continue;const Ye=new t_(W,this.z,this.x,this.y,Z);Ye.layer=_e;let gt=n[oe];gt===void 0&&(gt=n[oe]=[]),gt.push({featureIndex:p,feature:Ye,intersectionZ:Re})}}lookupSymbolFeatures(n,s,l,p,v,x,S,C){const P={};this.loadVTLayers();const M=fh(v);for(const L of n)this.loadMatchingFeature(P,l,p,L,M,x,S,C,s);return P}hasLayer(n){for(const s of this.bucketLayerIDs)for(const l of s)if(n===l)return!0;return!1}getId(n,s){let l=n.id;return this.promoteId&&(l=n.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[s]],typeof l=="boolean"&&(l=Number(l))),l}}function $h(i,n,s,l,p){return de(i,(v,x)=>{const S=n instanceof ru?n.get(x):null;return S&&S.evaluate?S.evaluate(s,l,p):S})}function Vh(i){let n=1/0,s=1/0,l=-1/0,p=-1/0;for(const v of i)n=Math.min(n,v.x),s=Math.min(s,v.y),l=Math.max(l,v.x),p=Math.max(p,v.y);return{minX:n,minY:s,maxX:l,maxY:p}}function Ky(i,n){return n-i}function r_(i,n,s,l,p){const v=[];for(let x=0;x<i.length;x++){const S=i[x];let C;for(let P=0;P<S.length-1;P++){let M=S[P],L=S[P+1];M.x<n&&L.x<n||(M.x<n?M=new G(n,M.y+(n-M.x)/(L.x-M.x)*(L.y-M.y))._round():L.x<n&&(L=new G(n,M.y+(n-M.x)/(L.x-M.x)*(L.y-M.y))._round()),M.y<s&&L.y<s||(M.y<s?M=new G(M.x+(s-M.y)/(L.y-M.y)*(L.x-M.x),s)._round():L.y<s&&(L=new G(M.x+(s-M.y)/(L.y-M.y)*(L.x-M.x),s)._round()),M.x>=l&&L.x>=l||(M.x>=l?M=new G(l,M.y+(l-M.x)/(L.x-M.x)*(L.y-M.y))._round():L.x>=l&&(L=new G(l,M.y+(l-M.x)/(L.x-M.x)*(L.y-M.y))._round()),M.y>=p&&L.y>=p||(M.y>=p?M=new G(M.x+(p-M.y)/(L.y-M.y)*(L.x-M.x),p)._round():L.y>=p&&(L=new G(M.x+(p-M.y)/(L.y-M.y)*(L.x-M.x),p)._round()),C&&M.equals(C[C.length-1])||(C=[M],v.push(C)),C.push(L)))))}}return v}vt("FeatureIndex",n_,{omit:["rawTileData","sourceLayerCoder"]});class ta extends G{constructor(n,s,l,p){super(n,s),this.angle=l,p!==void 0&&(this.segment=p)}clone(){return new ta(this.x,this.y,this.angle,this.segment)}}function Gp(i,n,s,l,p){if(n.segment===void 0||s===0)return!0;let v=n,x=n.segment+1,S=0;for(;S>-s/2;){if(x--,x<0)return!1;S-=i[x].dist(v),v=i[x]}S+=i[x].dist(i[x+1]),x++;const C=[];let P=0;for(;S<s/2;){const M=i[x],L=i[x+1];if(!L)return!1;let F=i[x-1].angleTo(M)-M.angleTo(L);for(F=Math.abs((F+3*Math.PI)%(2*Math.PI)-Math.PI),C.push({distance:S,angleDelta:F}),P+=F;S-C[0].distance>l;)P-=C.shift().angleDelta;if(P>p)return!1;x++,S+=M.dist(L)}return!0}function i_(i){let n=0;for(let s=0;s<i.length-1;s++)n+=i[s].dist(i[s+1]);return n}function s_(i,n,s){return i?.6*n*s:0}function o_(i,n){return Math.max(i?i.right-i.left:0,n?n.right-n.left:0)}function Yy(i,n,s,l,p,v){const x=s_(s,p,v),S=o_(s,l)*v;let C=0;const P=i_(i)/2;for(let M=0;M<i.length-1;M++){const L=i[M],F=i[M+1],U=L.dist(F);if(C+U>P){const W=(P-C)/U,Z=Li.number(L.x,F.x,W),ne=Li.number(L.y,F.y,W),oe=new ta(Z,ne,F.angleTo(L),M);return oe._round(),!x||Gp(i,oe,S,x,n)?oe:void 0}C+=U}}function Jy(i,n,s,l,p,v,x,S,C){const P=s_(l,v,x),M=o_(l,p),L=M*x,F=i[0].x===0||i[0].x===C||i[0].y===0||i[0].y===C;return n-L<n/4&&(n=L+n/4),a_(i,F?n/2*S%n:(M/2+2*v)*x*S%n,n,P,s,L,F,!1,C)}function a_(i,n,s,l,p,v,x,S,C){const P=v/2,M=i_(i);let L=0,F=n-s,U=[];for(let W=0;W<i.length-1;W++){const Z=i[W],ne=i[W+1],oe=Z.dist(ne),Pe=ne.angleTo(Z);for(;F+s<L+oe;){F+=s;const ge=(F-L)/oe,_e=Li.number(Z.x,ne.x,ge),Re=Li.number(Z.y,ne.y,ge);if(_e>=0&&_e<C&&Re>=0&&Re<C&&F-P>=0&&F+P<=M){const Ye=new ta(_e,Re,Pe,W);Ye._round(),l&&!Gp(i,Ye,v,l,p)||U.push(Ye)}}L+=oe}return S||U.length||x||(U=a_(i,L/2,s,l,p,v,x,!0,C)),U}vt("Anchor",ta);const bc=Qi;function l_(i,n,s,l){const p=[],v=i.image,x=v.pixelRatio,S=v.paddedRect.w-2*bc,C=v.paddedRect.h-2*bc;let P={x1:i.left,y1:i.top,x2:i.right,y2:i.bottom};const M=v.stretchX||[[0,S]],L=v.stretchY||[[0,C]],F=($e,At)=>$e+At[1]-At[0],U=M.reduce(F,0),W=L.reduce(F,0),Z=S-U,ne=C-W;let oe=0,Pe=U,ge=0,_e=W,Re=0,Ye=Z,gt=0,Ot=ne;if(v.content&&l){const $e=v.content,At=$e[2]-$e[0],kt=$e[3]-$e[1];(v.textFitWidth||v.textFitHeight)&&(P=Vg(i)),oe=of(M,0,$e[0]),ge=of(L,0,$e[1]),Pe=of(M,$e[0],$e[2]),_e=of(L,$e[1],$e[3]),Re=$e[0]-oe,gt=$e[1]-ge,Ye=At-Pe,Ot=kt-_e}const _t=P.x1,dt=P.y1,Pt=P.x2-_t,xt=P.y2-dt,yt=($e,At,kt,qt)=>{const tr=af($e.stretch-oe,Pe,Pt,_t),Yn=lf($e.fixed-Re,Ye,$e.stretch,U),Qr=af(At.stretch-ge,_e,xt,dt),Es=lf(At.fixed-gt,Ot,At.stretch,W),vi=af(kt.stretch-oe,Pe,Pt,_t),Nr=lf(kt.fixed-Re,Ye,kt.stretch,U),Bi=af(qt.stretch-ge,_e,xt,dt),Ni=lf(qt.fixed-gt,Ot,qt.stretch,W),Ui=new G(tr,Qr),yn=new G(vi,Qr),$n=new G(vi,Bi),ki=new G(tr,Bi),xi=new G(Yn/x,Es/x),ji=new G(Nr/x,Ni/x),oi=n*Math.PI/180;if(oi){const zn=Math.sin(oi),nr=Math.cos(oi),lr=[nr,-zn,zn,nr];Ui._matMult(lr),yn._matMult(lr),ki._matMult(lr),$n._matMult(lr)}const Us=$e.stretch+$e.fixed,es=At.stretch+At.fixed;return{tl:Ui,tr:yn,bl:ki,br:$n,tex:{x:v.paddedRect.x+bc+Us,y:v.paddedRect.y+bc+es,w:kt.stretch+kt.fixed-Us,h:qt.stretch+qt.fixed-es},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:xi,pixelOffsetBR:ji,minFontScaleX:Ye/x/Pt,minFontScaleY:Ot/x/xt,isSDF:s}};if(l&&(v.stretchX||v.stretchY)){const $e=u_(M,Z,U),At=u_(L,ne,W);for(let kt=0;kt<$e.length-1;kt++){const qt=$e[kt],tr=$e[kt+1];for(let Yn=0;Yn<At.length-1;Yn++)p.push(yt(qt,At[Yn],tr,At[Yn+1]))}}else p.push(yt({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:S+1},{fixed:0,stretch:C+1}));return p}function of(i,n,s){let l=0;for(const p of i)l+=Math.max(n,Math.min(s,p[1]))-Math.max(n,Math.min(s,p[0]));return l}function u_(i,n,s){const l=[{fixed:-bc,stretch:0}];for(const[p,v]of i){const x=l[l.length-1];l.push({fixed:p-x.stretch,stretch:x.stretch}),l.push({fixed:p-x.stretch,stretch:x.stretch+(v-p)})}return l.push({fixed:n+bc,stretch:s}),l}function af(i,n,s,l){return i/n*s+l}function lf(i,n,s,l){return i-n*s/l}class Ts{constructor(n,s,l,p,v,x,S,C,P,M){var L;if(this.boxStartIndex=n.length,P){let F=x.top,U=x.bottom;const W=x.collisionPadding;W&&(F-=W[1],U+=W[3]);let Z=U-F;Z>0&&(Z=Math.max(10,Z),this.circleDiameter=Z)}else{const F=!((L=x.image)===null||L===void 0)&&L.content&&(x.image.textFitWidth||x.image.textFitHeight)?Vg(x):{x1:x.left,y1:x.top,x2:x.right,y2:x.bottom};F.y1=F.y1*S-C[0],F.y2=F.y2*S+C[2],F.x1=F.x1*S-C[3],F.x2=F.x2*S+C[1];const U=x.collisionPadding;if(U&&(F.x1-=U[0]*S,F.y1-=U[1]*S,F.x2+=U[2]*S,F.y2+=U[3]*S),M){const W=new G(F.x1,F.y1),Z=new G(F.x2,F.y1),ne=new G(F.x1,F.y2),oe=new G(F.x2,F.y2),Pe=M*Math.PI/180;W._rotate(Pe),Z._rotate(Pe),ne._rotate(Pe),oe._rotate(Pe),F.x1=Math.min(W.x,Z.x,ne.x,oe.x),F.x2=Math.max(W.x,Z.x,ne.x,oe.x),F.y1=Math.min(W.y,Z.y,ne.y,oe.y),F.y2=Math.max(W.y,Z.y,ne.y,oe.y)}n.emplaceBack(s.x,s.y,F.x1,F.y1,F.x2,F.y2,l,p,v)}this.boxEndIndex=n.length}}class Qy{constructor(n=[],s=(l,p)=>l<p?-1:l>p?1:0){if(this.data=n,this.length=this.data.length,this.compare=s,this.length>0)for(let l=(this.length>>1)-1;l>=0;l--)this._down(l)}push(n){this.data.push(n),this._up(this.length++)}pop(){if(this.length===0)return;const n=this.data[0],s=this.data.pop();return--this.length>0&&(this.data[0]=s,this._down(0)),n}peek(){return this.data[0]}_up(n){const{data:s,compare:l}=this,p=s[n];for(;n>0;){const v=n-1>>1,x=s[v];if(l(p,x)>=0)break;s[n]=x,n=v}s[n]=p}_down(n){const{data:s,compare:l}=this,p=this.length>>1,v=s[n];for(;n<p;){let x=1+(n<<1);const S=x+1;if(S<this.length&&l(s[S],s[x])<0&&(x=S),l(s[x],v)>=0)break;s[n]=s[x],n=x}s[n]=v}}function e1(i,n=1,s=!1){let l=1/0,p=1/0,v=-1/0,x=-1/0;const S=i[0];for(let U=0;U<S.length;U++){const W=S[U];(!U||W.x<l)&&(l=W.x),(!U||W.y<p)&&(p=W.y),(!U||W.x>v)&&(v=W.x),(!U||W.y>x)&&(x=W.y)}const C=Math.min(v-l,x-p);let P=C/2;const M=new Qy([],yu);if(C===0)return new G(l,p);for(let U=l;U<v;U+=C)for(let W=p;W<x;W+=C)M.push(new en(U+P,W+P,P,i));let L=function(U){let W=0,Z=0,ne=0;const oe=U[0];for(let Pe=0,ge=oe.length,_e=ge-1;Pe<ge;_e=Pe++){const Re=oe[Pe],Ye=oe[_e],gt=Re.x*Ye.y-Ye.x*Re.y;Z+=(Re.x+Ye.x)*gt,ne+=(Re.y+Ye.y)*gt,W+=3*gt}return new en(Z/W,ne/W,0,U)}(i),F=M.length;for(;M.length;){const U=M.pop();(U.d>L.d||!L.d)&&(L=U,s&&console.log("found best %d after %d probes",Math.round(1e4*U.d)/1e4,F)),U.max-L.d<=n||(P=U.h/2,M.push(new en(U.p.x-P,U.p.y-P,P,i)),M.push(new en(U.p.x+P,U.p.y-P,P,i)),M.push(new en(U.p.x-P,U.p.y+P,P,i)),M.push(new en(U.p.x+P,U.p.y+P,P,i)),F+=4)}return s&&(console.log(`num probes: ${F}`),console.log(`best distance: ${L.d}`)),L.p}function yu(i,n){return n.max-i.max}function en(i,n,s,l){this.p=new G(i,n),this.h=s,this.d=function(p,v){let x=!1,S=1/0;for(let C=0;C<v.length;C++){const P=v[C];for(let M=0,L=P.length,F=L-1;M<L;F=M++){const U=P[M],W=P[F];U.y>p.y!=W.y>p.y&&p.x<(W.x-U.x)*(p.y-U.y)/(W.y-U.y)+U.x&&(x=!x),S=Math.min(S,ig(p,U,W))}}return(x?1:-1)*Math.sqrt(S)}(this.p,l),this.max=this.d+this.h*Math.SQRT2}var yi;w.aq=void 0,(yi=w.aq||(w.aq={}))[yi.center=1]="center",yi[yi.left=2]="left",yi[yi.right=3]="right",yi[yi.top=4]="top",yi[yi.bottom=5]="bottom",yi[yi["top-left"]=6]="top-left",yi[yi["top-right"]=7]="top-right",yi[yi["bottom-left"]=8]="bottom-left",yi[yi["bottom-right"]=9]="bottom-right";const Vr=7,Mr=Number.POSITIVE_INFINITY;function c_(i,n){return n[1]!==Mr?function(s,l,p){let v=0,x=0;switch(l=Math.abs(l),p=Math.abs(p),s){case"top-right":case"top-left":case"top":x=p-Vr;break;case"bottom-right":case"bottom-left":case"bottom":x=-p+Vr}switch(s){case"top-right":case"bottom-right":case"right":v=-l;break;case"top-left":case"bottom-left":case"left":v=l}return[v,x]}(i,n[0],n[1]):function(s,l){let p=0,v=0;l<0&&(l=0);const x=l/Math.SQRT2;switch(s){case"top-right":case"top-left":v=x-Vr;break;case"bottom-right":case"bottom-left":v=-x+Vr;break;case"bottom":v=-l+Vr;break;case"top":v=l-Vr}switch(s){case"top-right":case"bottom-right":p=-x;break;case"top-left":case"bottom-left":p=x;break;case"left":p=l;break;case"right":p=-l}return[p,v]}(i,n[0])}function Ua(i,n,s){var l;const p=i.layout,v=(l=p.get("text-variable-anchor-offset"))===null||l===void 0?void 0:l.evaluate(n,{},s);if(v){const S=v.values,C=[];for(let P=0;P<S.length;P+=2){const M=C[P]=S[P],L=S[P+1].map(F=>F*Br);M.startsWith("top")?L[1]-=Vr:M.startsWith("bottom")&&(L[1]+=Vr),C[P+1]=L}return new Wi(C)}const x=p.get("text-variable-anchor");if(x){let S;S=i._unevaluatedLayout.getValue("text-radial-offset")!==void 0?[p.get("text-radial-offset").evaluate(n,{},s)*Br,Mr]:p.get("text-offset").evaluate(n,{},s).map(P=>P*Br);const C=[];for(const P of x)C.push(P,c_(P,S));return new Wi(C)}return null}function Hp(i){switch(i){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function t1(i,n,s,l,p,v,x,S,C,P,M){let L=v.textMaxSize.evaluate(n,{});L===void 0&&(L=x);const F=i.layers[0].layout,U=F.get("icon-offset").evaluate(n,{},M),W=d_(s.horizontal),Z=x/24,ne=i.tilePixelRatio*Z,oe=i.tilePixelRatio*L/24,Pe=i.tilePixelRatio*S,ge=i.tilePixelRatio*F.get("symbol-spacing"),_e=F.get("text-padding")*i.tilePixelRatio,Re=function($e,At,kt,qt=1){const tr=$e.get("icon-padding").evaluate(At,{},kt),Yn=tr&&tr.values;return[Yn[0]*qt,Yn[1]*qt,Yn[2]*qt,Yn[3]*qt]}(F,n,M,i.tilePixelRatio),Ye=F.get("text-max-angle")/180*Math.PI,gt=F.get("text-rotation-alignment")!=="viewport"&&F.get("symbol-placement")!=="point",Ot=F.get("icon-rotation-alignment")==="map"&&F.get("symbol-placement")!=="point",_t=F.get("symbol-placement"),dt=ge/2,Pt=F.get("icon-text-fit");let xt;l&&Pt!=="none"&&(i.allowVerticalPlacement&&s.vertical&&(xt=qg(l,s.vertical,Pt,F.get("icon-text-fit-padding"),U,Z)),W&&(l=qg(l,W,Pt,F.get("icon-text-fit-padding"),U,Z)));const yt=($e,At)=>{At.x<0||At.x>=Ir||At.y<0||At.y>=Ir||function(kt,qt,tr,Yn,Qr,Es,vi,Nr,Bi,Ni,Ui,yn,$n,ki,xi,ji,oi,Us,es,zn,nr,lr,Cs,Sr,vu){const To=kt.addToLineVertexArray(qt,tr);let na,no,js,ai,Is=0,Zh=0,f_=0,p_=0,em=-1,tm=-1;const ra={};let nm=iu("");if(kt.allowVerticalPlacement&&Yn.vertical){const Pi=Nr.layout.get("text-rotate").evaluate(nr,{},Sr)+90;js=new Ts(Bi,qt,Ni,Ui,yn,Yn.vertical,$n,ki,xi,Pi),vi&&(ai=new Ts(Bi,qt,Ni,Ui,yn,vi,oi,Us,xi,Pi))}if(Qr){const Pi=Nr.layout.get("icon-rotate").evaluate(nr,{}),$s=Nr.layout.get("icon-text-fit")!=="none",xu=l_(Qr,Pi,Cs,$s),Co=vi?l_(vi,Pi,Cs,$s):void 0;no=new Ts(Bi,qt,Ni,Ui,yn,Qr,oi,Us,!1,Pi),Is=4*xu.length;const wu=kt.iconSizeData;let ia=null;wu.kind==="source"?(ia=[ea*Nr.layout.get("icon-size").evaluate(nr,{})],ia[0]>Pl&&mt(`${kt.layerIds[0]}: Value for "icon-size" is >= ${Nh}. Reduce your "icon-size".`)):wu.kind==="composite"&&(ia=[ea*lr.compositeIconSizes[0].evaluate(nr,{},Sr),ea*lr.compositeIconSizes[1].evaluate(nr,{},Sr)],(ia[0]>Pl||ia[1]>Pl)&&mt(`${kt.layerIds[0]}: Value for "icon-size" is >= ${Nh}. Reduce your "icon-size".`)),kt.addSymbols(kt.icon,xu,ia,zn,es,nr,w.ah.none,qt,To.lineStartIndex,To.lineLength,-1,Sr),em=kt.icon.placedSymbolArray.length-1,Co&&(Zh=4*Co.length,kt.addSymbols(kt.icon,Co,ia,zn,es,nr,w.ah.vertical,qt,To.lineStartIndex,To.lineLength,-1,Sr),tm=kt.icon.placedSymbolArray.length-1)}const m_=Object.keys(Yn.horizontal);for(const Pi of m_){const $s=Yn.horizontal[Pi];if(!na){nm=iu($s.text);const Co=Nr.layout.get("text-rotate").evaluate(nr,{},Sr);na=new Ts(Bi,qt,Ni,Ui,yn,$s,$n,ki,xi,Co)}const xu=$s.positionedLines.length===1;if(f_+=h_(kt,qt,$s,Es,Nr,xi,nr,ji,To,Yn.vertical?w.ah.horizontal:w.ah.horizontalOnly,xu?m_:[Pi],ra,em,lr,Sr),xu)break}Yn.vertical&&(p_+=h_(kt,qt,Yn.vertical,Es,Nr,xi,nr,ji,To,w.ah.vertical,["vertical"],ra,tm,lr,Sr));const i1=na?na.boxStartIndex:kt.collisionBoxArray.length,s1=na?na.boxEndIndex:kt.collisionBoxArray.length,o1=js?js.boxStartIndex:kt.collisionBoxArray.length,a1=js?js.boxEndIndex:kt.collisionBoxArray.length,l1=no?no.boxStartIndex:kt.collisionBoxArray.length,u1=no?no.boxEndIndex:kt.collisionBoxArray.length,c1=ai?ai.boxStartIndex:kt.collisionBoxArray.length,h1=ai?ai.boxEndIndex:kt.collisionBoxArray.length;let Eo=-1;const df=(Pi,$s)=>Pi&&Pi.circleDiameter?Math.max(Pi.circleDiameter,$s):$s;Eo=df(na,Eo),Eo=df(js,Eo),Eo=df(no,Eo),Eo=df(ai,Eo);const g_=Eo>-1?1:0;g_&&(Eo*=vu/Br),kt.glyphOffsetArray.length>=vc.MAX_GLYPHS&&mt("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),nr.sortKey!==void 0&&kt.addToSortKeyRanges(kt.symbolInstances.length,nr.sortKey);const d1=Ua(Nr,nr,Sr),[f1,p1]=function(Pi,$s){const xu=Pi.length,Co=$s==null?void 0:$s.values;if((Co==null?void 0:Co.length)>0)for(let wu=0;wu<Co.length;wu+=2){const ia=Co[wu+1];Pi.emplaceBack(w.aq[Co[wu]],ia[0],ia[1])}return[xu,Pi.length]}(kt.textAnchorOffsets,d1);kt.symbolInstances.emplaceBack(qt.x,qt.y,ra.right>=0?ra.right:-1,ra.center>=0?ra.center:-1,ra.left>=0?ra.left:-1,ra.vertical||-1,em,tm,nm,i1,s1,o1,a1,l1,u1,c1,h1,Ni,f_,p_,Is,Zh,g_,0,$n,Eo,f1,p1)}(i,At,$e,s,l,p,xt,i.layers[0],i.collisionBoxArray,n.index,n.sourceLayerIndex,i.index,ne,[_e,_e,_e,_e],gt,C,Pe,Re,Ot,U,n,v,P,M,x)};if(_t==="line")for(const $e of r_(n.geometry,0,0,Ir,Ir)){const At=Jy($e,ge,Ye,s.vertical||W,l,24,oe,i.overscaling,Ir);for(const kt of At)W&&n1(i,W.text,dt,kt)||yt($e,kt)}else if(_t==="line-center"){for(const $e of n.geometry)if($e.length>1){const At=Yy($e,Ye,s.vertical||W,l,24,oe);At&&yt($e,At)}}else if(n.type==="Polygon")for(const $e of ir(n.geometry,0)){const At=e1($e,16);yt($e[0],new ta(At.x,At.y,0))}else if(n.type==="LineString")for(const $e of n.geometry)yt($e,new ta($e[0].x,$e[0].y,0));else if(n.type==="Point")for(const $e of n.geometry)for(const At of $e)yt([At],new ta(At.x,At.y,0))}function h_(i,n,s,l,p,v,x,S,C,P,M,L,F,U,W){const Z=function(Pe,ge,_e,Re,Ye,gt,Ot,_t){const dt=Re.layout.get("text-rotate").evaluate(gt,{})*Math.PI/180,Pt=[];for(const xt of ge.positionedLines)for(const yt of xt.positionedGlyphs){if(!yt.rect)continue;const $e=yt.rect||{};let At=Og+1,kt=!0,qt=1,tr=0;const Yn=(Ye||_t)&&yt.vertical,Qr=yt.metrics.advance*yt.scale/2;if(_t&&ge.verticalizable&&(tr=xt.lineOffset/2-(yt.imageName?-(Br-yt.metrics.width*yt.scale)/2:(yt.scale-1)*Br)),yt.imageName){const zn=Ot[yt.imageName];kt=zn.sdf,qt=zn.pixelRatio,At=Qi/qt}const Es=Ye?[yt.x+Qr,yt.y]:[0,0];let vi=Ye?[0,0]:[yt.x+Qr+_e[0],yt.y+_e[1]-tr],Nr=[0,0];Yn&&(Nr=vi,vi=[0,0]);const Bi=yt.metrics.isDoubleResolution?2:1,Ni=(yt.metrics.left-At)*yt.scale-Qr+vi[0],Ui=(-yt.metrics.top-At)*yt.scale+vi[1],yn=Ni+$e.w/Bi*yt.scale/qt,$n=Ui+$e.h/Bi*yt.scale/qt,ki=new G(Ni,Ui),xi=new G(yn,Ui),ji=new G(Ni,$n),oi=new G(yn,$n);if(Yn){const zn=new G(-Qr,Qr-Oh),nr=-Math.PI/2,lr=Br/2-Qr,Cs=new G(5-Oh-lr,-(yt.imageName?lr:0)),Sr=new G(...Nr);ki._rotateAround(nr,zn)._add(Cs)._add(Sr),xi._rotateAround(nr,zn)._add(Cs)._add(Sr),ji._rotateAround(nr,zn)._add(Cs)._add(Sr),oi._rotateAround(nr,zn)._add(Cs)._add(Sr)}if(dt){const zn=Math.sin(dt),nr=Math.cos(dt),lr=[nr,-zn,zn,nr];ki._matMult(lr),xi._matMult(lr),ji._matMult(lr),oi._matMult(lr)}const Us=new G(0,0),es=new G(0,0);Pt.push({tl:ki,tr:xi,bl:ji,br:oi,tex:$e,writingMode:ge.writingMode,glyphOffset:Es,sectionIndex:yt.sectionIndex,isSDF:kt,pixelOffsetTL:Us,pixelOffsetBR:es,minFontScaleX:0,minFontScaleY:0})}return Pt}(0,s,S,p,v,x,l,i.allowVerticalPlacement),ne=i.textSizeData;let oe=null;ne.kind==="source"?(oe=[ea*p.layout.get("text-size").evaluate(x,{})],oe[0]>Pl&&mt(`${i.layerIds[0]}: Value for "text-size" is >= ${Nh}. Reduce your "text-size".`)):ne.kind==="composite"&&(oe=[ea*U.compositeTextSizes[0].evaluate(x,{},W),ea*U.compositeTextSizes[1].evaluate(x,{},W)],(oe[0]>Pl||oe[1]>Pl)&&mt(`${i.layerIds[0]}: Value for "text-size" is >= ${Nh}. Reduce your "text-size".`)),i.addSymbols(i.text,Z,oe,S,v,x,P,n,C.lineStartIndex,C.lineLength,F,W);for(const Pe of M)L[Pe]=i.text.placedSymbolArray.length-1;return 4*Z.length}function d_(i){for(const n in i)return i[n];return null}function n1(i,n,s,l){const p=i.compareText;if(n in p){const v=p[n];for(let x=v.length-1;x>=0;x--)if(l.dist(v[x])<s)return!0}else p[n]=[];return p[n].push(l),!1}const uf=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class Xp{static from(n){if(!(n instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[s,l]=new Uint8Array(n,0,2);if(s!==219)throw new Error("Data does not appear to be in a KDBush format.");const p=l>>4;if(p!==1)throw new Error(`Got v${p} data when expected v1.`);const v=uf[15&l];if(!v)throw new Error("Unrecognized array type.");const[x]=new Uint16Array(n,2,1),[S]=new Uint32Array(n,4,1);return new Xp(S,x,v,n)}constructor(n,s=64,l=Float64Array,p){if(isNaN(n)||n<0)throw new Error(`Unpexpected numItems value: ${n}.`);this.numItems=+n,this.nodeSize=Math.min(Math.max(+s,2),65535),this.ArrayType=l,this.IndexArrayType=n<65536?Uint16Array:Uint32Array;const v=uf.indexOf(this.ArrayType),x=2*n*this.ArrayType.BYTES_PER_ELEMENT,S=n*this.IndexArrayType.BYTES_PER_ELEMENT,C=(8-S%8)%8;if(v<0)throw new Error(`Unexpected typed array class: ${l}.`);p&&p instanceof ArrayBuffer?(this.data=p,this.ids=new this.IndexArrayType(this.data,8,n),this.coords=new this.ArrayType(this.data,8+S+C,2*n),this._pos=2*n,this._finished=!0):(this.data=new ArrayBuffer(8+x+S+C),this.ids=new this.IndexArrayType(this.data,8,n),this.coords=new this.ArrayType(this.data,8+S+C,2*n),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+v]),new Uint16Array(this.data,2,1)[0]=s,new Uint32Array(this.data,4,1)[0]=n)}add(n,s){const l=this._pos>>1;return this.ids[l]=l,this.coords[this._pos++]=n,this.coords[this._pos++]=s,l}finish(){const n=this._pos>>1;if(n!==this.numItems)throw new Error(`Added ${n} items when expected ${this.numItems}.`);return So(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(n,s,l,p){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:v,coords:x,nodeSize:S}=this,C=[0,v.length-1,0],P=[];for(;C.length;){const M=C.pop()||0,L=C.pop()||0,F=C.pop()||0;if(L-F<=S){for(let ne=F;ne<=L;ne++){const oe=x[2*ne],Pe=x[2*ne+1];oe>=n&&oe<=l&&Pe>=s&&Pe<=p&&P.push(v[ne])}continue}const U=F+L>>1,W=x[2*U],Z=x[2*U+1];W>=n&&W<=l&&Z>=s&&Z<=p&&P.push(v[U]),(M===0?n<=W:s<=Z)&&(C.push(F),C.push(U-1),C.push(1-M)),(M===0?l>=W:p>=Z)&&(C.push(U+1),C.push(L),C.push(1-M))}return P}within(n,s,l){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:p,coords:v,nodeSize:x}=this,S=[0,p.length-1,0],C=[],P=l*l;for(;S.length;){const M=S.pop()||0,L=S.pop()||0,F=S.pop()||0;if(L-F<=x){for(let ne=F;ne<=L;ne++)zr(v[2*ne],v[2*ne+1],n,s)<=P&&C.push(p[ne]);continue}const U=F+L>>1,W=v[2*U],Z=v[2*U+1];zr(W,Z,n,s)<=P&&C.push(p[U]),(M===0?n-l<=W:s-l<=Z)&&(S.push(F),S.push(U-1),S.push(1-M)),(M===0?n+l>=W:s+l>=Z)&&(S.push(U+1),S.push(L),S.push(1-M))}return C}}function So(i,n,s,l,p,v){if(p-l<=s)return;const x=l+p>>1;Kp(i,n,x,l,p,v),So(i,n,s,l,x-1,1-v),So(i,n,s,x+1,p,1-v)}function Kp(i,n,s,l,p,v){for(;p>l;){if(p-l>600){const P=p-l+1,M=s-l+1,L=Math.log(P),F=.5*Math.exp(2*L/3),U=.5*Math.sqrt(L*F*(P-F)/P)*(M-P/2<0?-1:1);Kp(i,n,s,Math.max(l,Math.floor(s-M*F/P+U)),Math.min(p,Math.floor(s+(P-M)*F/P+U)),v)}const x=n[2*s+v];let S=l,C=p;for(Ml(i,n,l,s),n[2*p+v]>x&&Ml(i,n,l,p);S<C;){for(Ml(i,n,S,C),S++,C--;n[2*S+v]<x;)S++;for(;n[2*C+v]>x;)C--}n[2*l+v]===x?Ml(i,n,l,C):(C++,Ml(i,n,C,p)),C<=s&&(l=C+1),s<=C&&(p=C-1)}}function Ml(i,n,s,l){br(i,s,l),br(n,2*s,2*l),br(n,2*s+1,2*l+1)}function br(i,n,s){const l=i[n];i[n]=i[s],i[s]=l}function zr(i,n,s,l){const p=i-s,v=n-l;return p*p+v*v}var cf;w.bg=void 0,(cf=w.bg||(w.bg={})).create="create",cf.load="load",cf.fullLoad="fullLoad";let hf=null,qh=[];const Yp=1e3/60,Jp="loadTime",Qp="fullLoadTime",r1={mark(i){performance.mark(i)},frame(i){const n=i;hf!=null&&qh.push(n-hf),hf=n},clearMetrics(){hf=null,qh=[],performance.clearMeasures(Jp),performance.clearMeasures(Qp);for(const i in w.bg)performance.clearMarks(w.bg[i])},getPerformanceMetrics(){performance.measure(Jp,w.bg.create,w.bg.load),performance.measure(Qp,w.bg.create,w.bg.fullLoad);const i=performance.getEntriesByName(Jp)[0].duration,n=performance.getEntriesByName(Qp)[0].duration,s=qh.length,l=1/(qh.reduce((v,x)=>v+x,0)/s/1e3),p=qh.filter(v=>v>Yp).reduce((v,x)=>v+(x-Yp)/Yp,0);return{loadTime:i,fullLoadTime:n,fps:l,percentDroppedFrames:p/(s+p)*100,totalFrames:s}}};w.$=class extends R{},w.A=lu,w.B=yh,w.C=function(i){if(Qn==null){const n=i.navigator?i.navigator.userAgent:null;Qn=!!i.safari||!(!n||!(/\b(iPad|iPhone|iPod)\b/.test(n)||n.match("Safari")&&!n.match("Chrome")))}return Qn},w.D=Ct,w.E=dn,w.F=class{constructor(i,n){this.target=i,this.mapId=n,this.resolveRejects={},this.tasks={},this.taskQueue=[],this.abortControllers={},this.messageHandlers={},this.invoker=new Xy(()=>this.process()),this.subscription=function(s,l,p,v){return s.addEventListener(l,p,!1),{unsubscribe:()=>{s.removeEventListener(l,p,!1)}}}(this.target,"message",s=>this.receive(s)),this.globalScope=qn(self)?i:window}registerMessageHandler(i,n){this.messageHandlers[i]=n}sendAsync(i,n){return new Promise((s,l)=>{const p=Math.round(1e18*Math.random()).toString(36).substring(0,10);this.resolveRejects[p]={resolve:s,reject:l},n&&n.signal.addEventListener("abort",()=>{delete this.resolveRejects[p];const S={id:p,type:"<cancel>",origin:location.origin,targetMapId:i.targetMapId,sourceMapId:this.mapId};this.target.postMessage(S)},{once:!0});const v=[],x=Object.assign(Object.assign({},i),{id:p,sourceMapId:this.mapId,origin:location.origin,data:_l(i.data,v)});this.target.postMessage(x,{transfer:v})})}receive(i){const n=i.data,s=n.id;if(!(n.origin!=="file://"&&location.origin!=="file://"&&n.origin!=="resource://android"&&location.origin!=="resource://android"&&n.origin!==location.origin||n.targetMapId&&this.mapId!==n.targetMapId)){if(n.type==="<cancel>"){delete this.tasks[s];const l=this.abortControllers[s];return delete this.abortControllers[s],void(l&&l.abort())}if(qn(self)||n.mustQueue)return this.tasks[s]=n,this.taskQueue.push(s),void this.invoker.trigger();this.processTask(s,n)}}process(){if(this.taskQueue.length===0)return;const i=this.taskQueue.shift(),n=this.tasks[i];delete this.tasks[i],this.taskQueue.length>0&&this.invoker.trigger(),n&&this.processTask(i,n)}processTask(i,n){return c(this,void 0,void 0,function*(){if(n.type==="<response>"){const p=this.resolveRejects[i];return delete this.resolveRejects[i],p?void(n.error?p.reject(xo(n.error)):p.resolve(xo(n.data))):void 0}if(!this.messageHandlers[n.type])return void this.completeTask(i,new Error(`Could not find a registered handler for ${n.type}, map ID: ${this.mapId}, available handlers: ${Object.keys(this.messageHandlers).join(", ")}`));const s=xo(n.data),l=new AbortController;this.abortControllers[i]=l;try{const p=yield this.messageHandlers[n.type](n.sourceMapId,s,l);this.completeTask(i,null,p)}catch(p){this.completeTask(i,p)}})}completeTask(i,n,s){const l=[];delete this.abortControllers[i];const p={id:i,type:"<response>",sourceMapId:this.mapId,origin:location.origin,error:n?_l(n):null,data:_l(s,l)};this.target.postMessage(p,{transfer:l})}remove(){this.invoker.remove(),this.subscription.unsubscribe()}},w.G=Cn,w.H=function(){var i=new lu(16);return lu!=Float32Array&&(i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[11]=0,i[12]=0,i[13]=0,i[14]=0),i[0]=1,i[5]=1,i[10]=1,i[15]=1,i},w.I=Rp,w.J=function(i,n,s){var l,p,v,x,S,C,P,M,L,F,U,W,Z=s[0],ne=s[1],oe=s[2];return n===i?(i[12]=n[0]*Z+n[4]*ne+n[8]*oe+n[12],i[13]=n[1]*Z+n[5]*ne+n[9]*oe+n[13],i[14]=n[2]*Z+n[6]*ne+n[10]*oe+n[14],i[15]=n[3]*Z+n[7]*ne+n[11]*oe+n[15]):(p=n[1],v=n[2],x=n[3],S=n[4],C=n[5],P=n[6],M=n[7],L=n[8],F=n[9],U=n[10],W=n[11],i[0]=l=n[0],i[1]=p,i[2]=v,i[3]=x,i[4]=S,i[5]=C,i[6]=P,i[7]=M,i[8]=L,i[9]=F,i[10]=U,i[11]=W,i[12]=l*Z+S*ne+L*oe+n[12],i[13]=p*Z+C*ne+F*oe+n[13],i[14]=v*Z+P*ne+U*oe+n[14],i[15]=x*Z+M*ne+W*oe+n[15]),i},w.K=function(i,n,s){var l=s[0],p=s[1],v=s[2];return i[0]=n[0]*l,i[1]=n[1]*l,i[2]=n[2]*l,i[3]=n[3]*l,i[4]=n[4]*p,i[5]=n[5]*p,i[6]=n[6]*p,i[7]=n[7]*p,i[8]=n[8]*v,i[9]=n[9]*v,i[10]=n[10]*v,i[11]=n[11]*v,i[12]=n[12],i[13]=n[13],i[14]=n[14],i[15]=n[15],i},w.L=Ji,w.M=function(i,n){const s={};for(let l=0;l<n.length;l++){const p=n[l];p in i&&(s[p]=i[p])}return s},w.N=Al,w.O=Jg,w.P=G,w.Q=Qg,w.R=bs,w.S=Ss,w.T=ic,w.U=se,w.V=ue,w.W=nt,w.X=Ir,w.Y=E,w.Z=xc,w._=c,w.a=Sn,w.a$=function(i,n){var s=i[0],l=i[1],p=i[2],v=i[3],x=i[4],S=i[5],C=i[6],P=i[7],M=i[8],L=i[9],F=i[10],U=i[11],W=i[12],Z=i[13],ne=i[14],oe=i[15],Pe=n[0],ge=n[1],_e=n[2],Re=n[3],Ye=n[4],gt=n[5],Ot=n[6],_t=n[7],dt=n[8],Pt=n[9],xt=n[10],yt=n[11],$e=n[12],At=n[13],kt=n[14],qt=n[15];return Math.abs(s-Pe)<=Fi*Math.max(1,Math.abs(s),Math.abs(Pe))&&Math.abs(l-ge)<=Fi*Math.max(1,Math.abs(l),Math.abs(ge))&&Math.abs(p-_e)<=Fi*Math.max(1,Math.abs(p),Math.abs(_e))&&Math.abs(v-Re)<=Fi*Math.max(1,Math.abs(v),Math.abs(Re))&&Math.abs(x-Ye)<=Fi*Math.max(1,Math.abs(x),Math.abs(Ye))&&Math.abs(S-gt)<=Fi*Math.max(1,Math.abs(S),Math.abs(gt))&&Math.abs(C-Ot)<=Fi*Math.max(1,Math.abs(C),Math.abs(Ot))&&Math.abs(P-_t)<=Fi*Math.max(1,Math.abs(P),Math.abs(_t))&&Math.abs(M-dt)<=Fi*Math.max(1,Math.abs(M),Math.abs(dt))&&Math.abs(L-Pt)<=Fi*Math.max(1,Math.abs(L),Math.abs(Pt))&&Math.abs(F-xt)<=Fi*Math.max(1,Math.abs(F),Math.abs(xt))&&Math.abs(U-yt)<=Fi*Math.max(1,Math.abs(U),Math.abs(yt))&&Math.abs(W-$e)<=Fi*Math.max(1,Math.abs(W),Math.abs($e))&&Math.abs(Z-At)<=Fi*Math.max(1,Math.abs(Z),Math.abs(At))&&Math.abs(ne-kt)<=Fi*Math.max(1,Math.abs(ne),Math.abs(kt))&&Math.abs(oe-qt)<=Fi*Math.max(1,Math.abs(oe),Math.abs(qt))},w.a0=gn,w.a1=jh,w.a2=Ke,w.a3=i=>{const n=window.document.createElement("video");return n.muted=!0,new Promise(s=>{n.onloadstart=()=>{s(n)};for(const l of i){const p=window.document.createElement("source");Zn(l)||(n.crossOrigin="Anonymous"),p.src=l,n.appendChild(p)}})},w.a4=function(){return ee++},w.a5=tt,w.a6=vc,w.a7=fh,w.a8=xs,w.a9=t_,w.aA=function(i){if(i.type==="custom")return new Hy(i);switch(i.type){case"background":return new sf(i);case"circle":return new Wd(i);case"fill":return new dy(i);case"fill-extrusion":return new vg(i);case"heatmap":return new lg(i);case"hillshade":return new Hd(i);case"line":return new Ty(i);case"raster":return new Gy(i);case"symbol":return new rf(i)}},w.aB=Ue,w.aC=function(i,n){if(!i)return[{command:"setStyle",args:[n]}];let s=[];try{if(!Rt(i.version,n.version))return[{command:"setStyle",args:[n]}];Rt(i.center,n.center)||s.push({command:"setCenter",args:[n.center]}),Rt(i.zoom,n.zoom)||s.push({command:"setZoom",args:[n.zoom]}),Rt(i.bearing,n.bearing)||s.push({command:"setBearing",args:[n.bearing]}),Rt(i.pitch,n.pitch)||s.push({command:"setPitch",args:[n.pitch]}),Rt(i.sprite,n.sprite)||s.push({command:"setSprite",args:[n.sprite]}),Rt(i.glyphs,n.glyphs)||s.push({command:"setGlyphs",args:[n.glyphs]}),Rt(i.transition,n.transition)||s.push({command:"setTransition",args:[n.transition]}),Rt(i.light,n.light)||s.push({command:"setLight",args:[n.light]}),Rt(i.terrain,n.terrain)||s.push({command:"setTerrain",args:[n.terrain]}),Rt(i.sky,n.sky)||s.push({command:"setSky",args:[n.sky]}),Rt(i.projection,n.projection)||s.push({command:"setProjection",args:[n.projection]});const l={},p=[];(function(x,S,C,P){let M;for(M in S=S||{},x=x||{})Object.prototype.hasOwnProperty.call(x,M)&&(Object.prototype.hasOwnProperty.call(S,M)||yr(M,C,P));for(M in S)Object.prototype.hasOwnProperty.call(S,M)&&(Object.prototype.hasOwnProperty.call(x,M)?Rt(x[M],S[M])||(x[M].type==="geojson"&&S[M].type==="geojson"&&vr(x,S,M)?Yt(C,{command:"setGeoJSONSourceData",args:[M,S[M].data]}):Gr(M,S,C,P)):Tr(M,S,C))})(i.sources,n.sources,p,l);const v=[];i.layers&&i.layers.forEach(x=>{"source"in x&&l[x.source]?s.push({command:"removeLayer",args:[x.id]}):v.push(x)}),s=s.concat(p),function(x,S,C){S=S||[];const P=(x=x||[]).map(dr),M=S.map(dr),L=x.reduce(fr,{}),F=S.reduce(fr,{}),U=P.slice(),W=Object.create(null);let Z,ne,oe,Pe,ge;for(let _e=0,Re=0;_e<P.length;_e++)Z=P[_e],Object.prototype.hasOwnProperty.call(F,Z)?Re++:(Yt(C,{command:"removeLayer",args:[Z]}),U.splice(U.indexOf(Z,Re),1));for(let _e=0,Re=0;_e<M.length;_e++)Z=M[M.length-1-_e],U[U.length-1-_e]!==Z&&(Object.prototype.hasOwnProperty.call(L,Z)?(Yt(C,{command:"removeLayer",args:[Z]}),U.splice(U.lastIndexOf(Z,U.length-Re),1)):Re++,Pe=U[U.length-_e],Yt(C,{command:"addLayer",args:[F[Z],Pe]}),U.splice(U.length-_e,0,Z),W[Z]=!0);for(let _e=0;_e<M.length;_e++)if(Z=M[_e],ne=L[Z],oe=F[Z],!W[Z]&&!Rt(ne,oe))if(Rt(ne.source,oe.source)&&Rt(ne["source-layer"],oe["source-layer"])&&Rt(ne.type,oe.type)){for(ge in rr(ne.layout,oe.layout,C,Z,null,"setLayoutProperty"),rr(ne.paint,oe.paint,C,Z,null,"setPaintProperty"),Rt(ne.filter,oe.filter)||Yt(C,{command:"setFilter",args:[Z,oe.filter]}),Rt(ne.minzoom,oe.minzoom)&&Rt(ne.maxzoom,oe.maxzoom)||Yt(C,{command:"setLayerZoomRange",args:[Z,oe.minzoom,oe.maxzoom]}),ne)Object.prototype.hasOwnProperty.call(ne,ge)&&ge!=="layout"&&ge!=="paint"&&ge!=="filter"&&ge!=="metadata"&&ge!=="minzoom"&&ge!=="maxzoom"&&(ge.indexOf("paint.")===0?rr(ne[ge],oe[ge],C,Z,ge.slice(6),"setPaintProperty"):Rt(ne[ge],oe[ge])||Yt(C,{command:"setLayerProperty",args:[Z,ge,oe[ge]]}));for(ge in oe)Object.prototype.hasOwnProperty.call(oe,ge)&&!Object.prototype.hasOwnProperty.call(ne,ge)&&ge!=="layout"&&ge!=="paint"&&ge!=="filter"&&ge!=="metadata"&&ge!=="minzoom"&&ge!=="maxzoom"&&(ge.indexOf("paint.")===0?rr(ne[ge],oe[ge],C,Z,ge.slice(6),"setPaintProperty"):Rt(ne[ge],oe[ge])||Yt(C,{command:"setLayerProperty",args:[Z,ge,oe[ge]]}))}else Yt(C,{command:"removeLayer",args:[Z]}),Pe=U[U.lastIndexOf(Z)+1],Yt(C,{command:"addLayer",args:[oe,Pe]})}(v,n.layers,s)}catch(l){console.warn("Unable to compute style diff:",l),s=[{command:"setStyle",args:[n]}]}return s},w.aD=function(i){const n=[],s=i.id;return s===void 0&&n.push({message:`layers.${s}: missing required property "id"`}),i.render===void 0&&n.push({message:`layers.${s}: missing required method "render"`}),i.renderingMode&&i.renderingMode!=="2d"&&i.renderingMode!=="3d"&&n.push({message:`layers.${s}: property "renderingMode" must be either "2d" or "3d"`}),n},w.aE=function i(n,s){if(Array.isArray(n)){if(!Array.isArray(s)||n.length!==s.length)return!1;for(let l=0;l<n.length;l++)if(!i(n[l],s[l]))return!1;return!0}if(typeof n=="object"&&n!==null&&s!==null){if(typeof s!="object"||Object.keys(n).length!==Object.keys(s).length)return!1;for(const l in n)if(!i(n[l],s[l]))return!1;return!0}return n===s},w.aF=de,w.aG=Te,w.aH=class extends Da{constructor(i,n){super(i,n),this.current=0}set(i){this.current!==i&&(this.current=i,this.gl.uniform1i(this.location,i))}},w.aI=Th,w.aJ=class extends Da{constructor(i,n){super(i,n),this.current=up}set(i){if(i[12]!==this.current[12]||i[0]!==this.current[0])return this.current=i,void this.gl.uniformMatrix4fv(this.location,!1,i);for(let n=1;n<16;n++)if(i[n]!==this.current[n]){this.current=i,this.gl.uniformMatrix4fv(this.location,!1,i);break}}},w.aK=Bd,w.aL=eg,w.aM=Ln,w.aN=class extends Da{constructor(i,n){super(i,n),this.current=[0,0,0]}set(i){i[0]===this.current[0]&&i[1]===this.current[1]&&i[2]===this.current[2]||(this.current=i,this.gl.uniform3f(this.location,i[0],i[1],i[2]))}},w.aO=class extends Da{constructor(i,n){super(i,n),this.current=[0,0]}set(i){i[0]===this.current[0]&&i[1]===this.current[1]||(this.current=i,this.gl.uniform2f(this.location,i[0],i[1]))}},w.aP=function(i,n,s,l,p,v,x){var S=1/(n-s),C=1/(l-p),P=1/(v-x);return i[0]=-2*S,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=-2*C,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=2*P,i[11]=0,i[12]=(n+s)*S,i[13]=(p+l)*C,i[14]=(x+v)*P,i[15]=1,i},w.aQ=ay,w.aR=class extends xe{},w.aS=Cy,w.aT=class extends ze{},w.aU=hc,w.aV=function(i){return i<=1?1:Math.pow(2,Math.ceil(Math.log(i)/Math.LN2))},w.aW=mp,w.aX=pi,w.aY=vs,w.aZ=class extends wt{},w.a_=function(i,n){return i[0]===n[0]&&i[1]===n[1]&&i[2]===n[2]&&i[3]===n[3]&&i[4]===n[4]&&i[5]===n[5]&&i[6]===n[6]&&i[7]===n[7]&&i[8]===n[8]&&i[9]===n[9]&&i[10]===n[10]&&i[11]===n[11]&&i[12]===n[12]&&i[13]===n[13]&&i[14]===n[14]&&i[15]===n[15]},w.aa=function(i){const n={};if(i.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(s,l,p,v)=>{const x=p||v;return n[l]=!x||x.toLowerCase(),""}),n["max-age"]){const s=parseInt(n["max-age"],10);isNaN(s)?delete n["max-age"]:n["max-age"]=s}return n},w.ab=function(i,n){const s=[];for(const l in i)l in n||s.push(l);return s},w.ac=Ze,w.ad=function(i,n,s){var l=Math.sin(s),p=Math.cos(s),v=n[0],x=n[1],S=n[2],C=n[3],P=n[4],M=n[5],L=n[6],F=n[7];return n!==i&&(i[8]=n[8],i[9]=n[9],i[10]=n[10],i[11]=n[11],i[12]=n[12],i[13]=n[13],i[14]=n[14],i[15]=n[15]),i[0]=v*p+P*l,i[1]=x*p+M*l,i[2]=S*p+L*l,i[3]=C*p+F*l,i[4]=P*p-v*l,i[5]=M*p-x*l,i[6]=L*p-S*l,i[7]=F*p-C*l,i},w.ae=function(i){var n=new lu(16);return n[0]=i[0],n[1]=i[1],n[2]=i[2],n[3]=i[3],n[4]=i[4],n[5]=i[5],n[6]=i[6],n[7]=i[7],n[8]=i[8],n[9]=i[9],n[10]=i[10],n[11]=i[11],n[12]=i[12],n[13]=i[13],n[14]=i[14],n[15]=i[15],n},w.af=Zd,w.ag=function(i,n){let s=0,l=0;if(i.kind==="constant")l=i.layoutSize;else if(i.kind!=="source"){const{interpolationType:p,minZoom:v,maxZoom:x}=i,S=p?Ze(Ti.interpolationFactor(p,n,v,x),0,1):0;i.kind==="camera"?l=Li.number(i.minSize,i.maxSize,S):s=S}return{uSizeT:s,uSize:l}},w.ai=function(i,{uSize:n,uSizeT:s},{lowerSize:l,upperSize:p}){return i.kind==="source"?l/ea:i.kind==="composite"?Li.number(l/ea,p/ea,s):n},w.aj=Bp,w.ak=function(i,n,s,l){const p=n.y-i.y,v=n.x-i.x,x=l.y-s.y,S=l.x-s.x,C=x*v-S*p;if(C===0)return null;const P=(S*(i.y-s.y)-x*(i.x-s.x))/C;return new G(i.x+P*v,i.y+P*p)},w.al=r_,w.am=Ih,w.an=qd,w.ao=function(i){let n=1/0,s=1/0,l=-1/0,p=-1/0;for(const v of i)n=Math.min(n,v.x),s=Math.min(s,v.y),l=Math.max(l,v.x),p=Math.max(p,v.y);return[n,s,l,p]},w.ap=Br,w.ar=Fp,w.as=function(i,n){var s=n[0],l=n[1],p=n[2],v=n[3],x=n[4],S=n[5],C=n[6],P=n[7],M=n[8],L=n[9],F=n[10],U=n[11],W=n[12],Z=n[13],ne=n[14],oe=n[15],Pe=s*S-l*x,ge=s*C-p*x,_e=s*P-v*x,Re=l*C-p*S,Ye=l*P-v*S,gt=p*P-v*C,Ot=M*Z-L*W,_t=M*ne-F*W,dt=M*oe-U*W,Pt=L*ne-F*Z,xt=L*oe-U*Z,yt=F*oe-U*ne,$e=Pe*yt-ge*xt+_e*Pt+Re*dt-Ye*_t+gt*Ot;return $e?(i[0]=(S*yt-C*xt+P*Pt)*($e=1/$e),i[1]=(p*xt-l*yt-v*Pt)*$e,i[2]=(Z*gt-ne*Ye+oe*Re)*$e,i[3]=(F*Ye-L*gt-U*Re)*$e,i[4]=(C*dt-x*yt-P*_t)*$e,i[5]=(s*yt-p*dt+v*_t)*$e,i[6]=(ne*_e-W*gt-oe*ge)*$e,i[7]=(M*gt-F*_e+U*ge)*$e,i[8]=(x*xt-S*dt+P*Ot)*$e,i[9]=(l*dt-s*xt-v*Ot)*$e,i[10]=(W*Ye-Z*_e+oe*Pe)*$e,i[11]=(L*_e-M*Ye-U*Pe)*$e,i[12]=(S*_t-x*Pt-C*Ot)*$e,i[13]=(s*Pt-l*_t+p*Ot)*$e,i[14]=(Z*ge-W*Re-ne*Pe)*$e,i[15]=(M*Re-L*ge+F*Pe)*$e,i):null},w.at=Hp,w.au=Qd,w.av=Xp,w.aw=function(){const i={},n=Ce.$version;for(const s in Ce.$root){const l=Ce.$root[s];if(l.required){let p=null;p=s==="version"?n:l.type==="array"?[]:{},p!=null&&(i[s]=p)}}return i},w.ax=Pa,w.ay=Zt,w.az=function(i){i=i.slice();const n=Object.create(null);for(let s=0;s<i.length;s++)n[i[s].id]=i[s];for(let s=0;s<i.length;s++)"ref"in i[s]&&(i[s]=bn(i[s],n[i[s].ref]));return i},w.b=zt,w.b0=function(i,n){return i[0]=n[0],i[1]=n[1],i[2]=n[2],i[3]=n[3],i[4]=n[4],i[5]=n[5],i[6]=n[6],i[7]=n[7],i[8]=n[8],i[9]=n[9],i[10]=n[10],i[11]=n[11],i[12]=n[12],i[13]=n[13],i[14]=n[14],i[15]=n[15],i},w.b1=function(i,n,s){return i[0]=n[0]*s[0],i[1]=n[1]*s[1],i[2]=n[2]*s[2],i[3]=n[3]*s[3],i},w.b2=function(i,n){return i[0]*n[0]+i[1]*n[1]+i[2]*n[2]+i[3]*n[3]},w.b3=je,w.b4=Zp,w.b5=Uh,w.b6=function(i,n,s,l,p){var v,x=1/Math.tan(n/2);return i[0]=x/s,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=x,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[11]=-1,i[12]=0,i[13]=0,i[15]=0,p!=null&&p!==1/0?(i[10]=(p+l)*(v=1/(l-p)),i[14]=2*p*l*v):(i[10]=-1,i[14]=-2*l),i},w.b7=function(i,n,s){var l=Math.sin(s),p=Math.cos(s),v=n[4],x=n[5],S=n[6],C=n[7],P=n[8],M=n[9],L=n[10],F=n[11];return n!==i&&(i[0]=n[0],i[1]=n[1],i[2]=n[2],i[3]=n[3],i[12]=n[12],i[13]=n[13],i[14]=n[14],i[15]=n[15]),i[4]=v*p+P*l,i[5]=x*p+M*l,i[6]=S*p+L*l,i[7]=C*p+F*l,i[8]=P*p-v*l,i[9]=M*p-x*l,i[10]=L*p-S*l,i[11]=F*p-C*l,i},w.b8=he,w.b9=De,w.bA=Pg,w.bB=function(i){return i.message===It},w.bC=Gt,w.bD=Ki,w.ba=function(i){return i*Math.PI/180},w.bb=function(i,n){const{x:s,y:l}=xc.fromLngLat(n);return!(i<0||i>25||l<0||l>=1||s<0||s>=1)},w.bc=function(i,n){return i[0]=n[0],i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=n[1],i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=n[2],i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i},w.bd=class extends z{},w.be=$p,w.bf=r1,w.bh=Nn,w.bi=function(i,n){Sn.REGISTERED_PROTOCOLS[i]=n},w.bj=function(i){delete Sn.REGISTERED_PROTOCOLS[i]},w.bk=function(i,n){const s={};for(let p=0;p<i.length;p++){const v=n&&n[i[p].id]||Ad(i[p]);n&&(n[i[p].id]=v);let x=s[v];x||(x=s[v]=[]),x.push(i[p])}const l=[];for(const p in s)l.push(s[p]);return l},w.bl=vt,w.bm=e_,w.bn=n_,w.bo=Bg,w.bp=function(i){i.bucket.createArrays(),i.bucket.tilePixelRatio=Ir/(512*i.bucket.overscaling),i.bucket.compareText={},i.bucket.iconsNeedLinear=!1;const n=i.bucket.layers[0],s=n.layout,l=n._unevaluatedLayout._values,p={layoutIconSize:l["icon-size"].possiblyEvaluate(new ar(i.bucket.zoom+1),i.canonical),layoutTextSize:l["text-size"].possiblyEvaluate(new ar(i.bucket.zoom+1),i.canonical),textMaxSize:l["text-size"].possiblyEvaluate(new ar(18))};if(i.bucket.textSizeData.kind==="composite"){const{minZoom:P,maxZoom:M}=i.bucket.textSizeData;p.compositeTextSizes=[l["text-size"].possiblyEvaluate(new ar(P),i.canonical),l["text-size"].possiblyEvaluate(new ar(M),i.canonical)]}if(i.bucket.iconSizeData.kind==="composite"){const{minZoom:P,maxZoom:M}=i.bucket.iconSizeData;p.compositeIconSizes=[l["icon-size"].possiblyEvaluate(new ar(P),i.canonical),l["icon-size"].possiblyEvaluate(new ar(M),i.canonical)]}const v=s.get("text-line-height")*Br,x=s.get("text-rotation-alignment")!=="viewport"&&s.get("symbol-placement")!=="point",S=s.get("text-keep-upright"),C=s.get("text-size");for(const P of i.bucket.features){const M=s.get("text-font").evaluate(P,{},i.canonical).join(","),L=C.evaluate(P,{},i.canonical),F=p.layoutTextSize.evaluate(P,{},i.canonical),U=p.layoutIconSize.evaluate(P,{},i.canonical),W={horizontal:{},vertical:void 0},Z=P.text;let ne,oe=[0,0];if(Z){const _e=Z.toString(),Re=s.get("text-letter-spacing").evaluate(P,{},i.canonical)*Br,Ye=yl(_e)?Re:0,gt=s.get("text-anchor").evaluate(P,{},i.canonical),Ot=Ua(n,P,i.canonical);if(!Ot){const xt=s.get("text-radial-offset").evaluate(P,{},i.canonical);oe=xt?c_(gt,[xt*Br,Mr]):s.get("text-offset").evaluate(P,{},i.canonical).map(yt=>yt*Br)}let _t=x?"center":s.get("text-justify").evaluate(P,{},i.canonical);const dt=s.get("symbol-placement")==="point"?s.get("text-max-width").evaluate(P,{},i.canonical)*Br:1/0,Pt=()=>{i.bucket.allowVerticalPlacement&&H(_e)&&(W.vertical=yc(Z,i.glyphMap,i.glyphPositions,i.imagePositions,M,dt,v,gt,"left",Ye,oe,w.ah.vertical,!0,F,L))};if(!x&&Ot){const xt=new Set;if(_t==="auto")for(let $e=0;$e<Ot.values.length;$e+=2)xt.add(Hp(Ot.values[$e]));else xt.add(_t);let yt=!1;for(const $e of xt)if(!W.horizontal[$e])if(yt)W.horizontal[$e]=W.horizontal[0];else{const At=yc(Z,i.glyphMap,i.glyphPositions,i.imagePositions,M,dt,v,"center",$e,Ye,oe,w.ah.horizontal,!1,F,L);At&&(W.horizontal[$e]=At,yt=At.positionedLines.length===1)}Pt()}else{_t==="auto"&&(_t=Hp(gt));const xt=yc(Z,i.glyphMap,i.glyphPositions,i.imagePositions,M,dt,v,gt,_t,Ye,oe,w.ah.horizontal,!1,F,L);xt&&(W.horizontal[_t]=xt),Pt(),H(_e)&&x&&S&&(W.vertical=yc(Z,i.glyphMap,i.glyphPositions,i.imagePositions,M,dt,v,gt,_t,Ye,oe,w.ah.vertical,!1,F,L))}}let Pe=!1;if(P.icon&&P.icon.name){const _e=i.imageMap[P.icon.name];_e&&(ne=ef(i.imagePositions[P.icon.name],s.get("icon-offset").evaluate(P,{},i.canonical),s.get("icon-anchor").evaluate(P,{},i.canonical)),Pe=!!_e.sdf,i.bucket.sdfIcons===void 0?i.bucket.sdfIcons=Pe:i.bucket.sdfIcons!==Pe&&mt("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(_e.pixelRatio!==i.bucket.pixelRatio||s.get("icon-rotate").constantOr(1)!==0)&&(i.bucket.iconsNeedLinear=!0))}const ge=d_(W.horizontal)||W.vertical;i.bucket.iconsInText=!!ge&&ge.iconsInText,(ge||ne)&&t1(i.bucket,P,W,ne,i.imageMap,p,F,U,oe,Pe,i.canonical)}i.showCollisionBoxes&&i.bucket.generateCollisionDebugBuffers()},w.bq=Pp,w.br=wp,w.bs=Cp,w.bt=Fr,w.bu=Dp,w.bv=class{constructor(i){this._marks={start:[i.url,"start"].join("#"),end:[i.url,"end"].join("#"),measure:i.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let i=performance.getEntriesByName(this._marks.measure);return i.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),i=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),i}},w.bw=function(i,n,s,l,p){return c(this,void 0,void 0,function*(){if(ue())try{return yield nt(i,n,s,l,p)}catch{}return function(v,x,S,C,P){const M=v.width,L=v.height;Et&&ct||(Et=new OffscreenCanvas(M,L),ct=Et.getContext("2d",{willReadFrequently:!0})),Et.width=M,Et.height=L,ct.drawImage(v,0,0,M,L);const F=ct.getImageData(x,S,C,P);return ct.clearRect(0,0,M,L),F.data}(i,n,s,l,p)})},w.bx=Wp,w.by=D,w.bz=j,w.c=St,w.d=i=>c(void 0,void 0,void 0,function*(){if(i.byteLength===0)return createImageBitmap(new ImageData(1,1));const n=new Blob([new Uint8Array(i)],{type:"image/png"});try{return createImageBitmap(n)}catch(s){throw new Error(`Could not load image because of ${s.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`)}}),w.e=ve,w.f=i=>new Promise((n,s)=>{const l=new Image;l.onload=()=>{n(l),URL.revokeObjectURL(l.src),l.onload=null,window.requestAnimationFrame(()=>{l.src=Je})},l.onerror=()=>s(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const p=new Blob([new Uint8Array(i)],{type:"image/png"});l.src=i.byteLength?URL.createObjectURL(p):Je}),w.g=cn,w.h=(i,n)=>rn(ve(i,{type:"json"}),n),w.i=qn,w.j=sn,w.k=er,w.l=(i,n)=>rn(ve(i,{type:"arrayBuffer"}),n),w.m=rn,w.n=function(i){return new Dp(i).readFields(Ry,[])},w.o=Ph,w.p=Fg,w.q=y,w.r=eu,w.s=Zn,w.t=ka,w.u=yo,w.v=Ce,w.w=mt,w.x=function([i,n,s]){return n+=90,n*=Math.PI/180,s*=Math.PI/180,{x:i*Math.cos(n)*Math.sin(s),y:i*Math.sin(n)*Math.sin(s),z:i*Math.cos(s)}},w.y=Li,w.z=ar}),g("worker",["./shared"],function(w){class c{constructor(N){this.keyCache={},N&&this.replace(N)}replace(N){this._layerConfigs={},this._layers={},this.update(N,[])}update(N,B){for(const re of N){this._layerConfigs[re.id]=re;const ye=this._layers[re.id]=w.aA(re);ye._featureFilter=w.a7(ye.filter),this.keyCache[re.id]&&delete this.keyCache[re.id]}for(const re of B)delete this.keyCache[re],delete this._layerConfigs[re],delete this._layers[re];this.familiesBySource={};const K=w.bk(Object.values(this._layerConfigs),this.keyCache);for(const re of K){const ye=re.map(Le=>this._layers[Le.id]),Se=ye[0];if(Se.visibility==="none")continue;const ke=Se.source||"";let pe=this.familiesBySource[ke];pe||(pe=this.familiesBySource[ke]={});const Be=Se.sourceLayer||"_geojsonTileLayer";let We=pe[Be];We||(We=pe[Be]=[]),We.push(ye)}}}class D{constructor(N){const B={},K=[];for(const ke in N){const pe=N[ke],Be=B[ke]={};for(const We in pe){const Le=pe[+We];if(!Le||Le.bitmap.width===0||Le.bitmap.height===0)continue;const it={x:0,y:0,w:Le.bitmap.width+2,h:Le.bitmap.height+2};K.push(it),Be[We]={rect:it,metrics:Le.metrics}}}const{w:re,h:ye}=w.p(K),Se=new w.o({width:re||1,height:ye||1});for(const ke in N){const pe=N[ke];for(const Be in pe){const We=pe[+Be];if(!We||We.bitmap.width===0||We.bitmap.height===0)continue;const Le=B[ke][Be].rect;w.o.copy(We.bitmap,Se,{x:0,y:0},{x:Le.x+1,y:Le.y+1},We.bitmap)}}this.image=Se,this.positions=B}}w.bl("GlyphAtlas",D);class j{constructor(N){this.tileID=new w.S(N.tileID.overscaledZ,N.tileID.wrap,N.tileID.canonical.z,N.tileID.canonical.x,N.tileID.canonical.y),this.uid=N.uid,this.zoom=N.zoom,this.pixelRatio=N.pixelRatio,this.tileSize=N.tileSize,this.source=N.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=N.showCollisionBoxes,this.collectResourceTiming=!!N.collectResourceTiming,this.returnDependencies=!!N.returnDependencies,this.promoteId=N.promoteId,this.inFlightDependencies=[]}parse(N,B,K,re){return w._(this,void 0,void 0,function*(){this.status="parsing",this.data=N,this.collisionBoxArray=new w.a5;const ye=new w.bm(Object.keys(N.layers).sort()),Se=new w.bn(this.tileID,this.promoteId);Se.bucketLayerIDs=[];const ke={},pe={featureIndex:Se,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:K},Be=B.familiesBySource[this.source];for(const on in Be){const Wn=N.layers[on];if(!Wn)continue;Wn.version===1&&w.w(`Vector tile source "${this.source}" layer "${on}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const ur=ye.encode(on),Hr=[];for(let ti=0;ti<Wn.length;ti++){const Xr=Wn.feature(ti),Qa=Se.getId(Xr,on);Hr.push({feature:Xr,id:Qa,index:ti,sourceLayerIndex:ur})}for(const ti of Be[on]){const Xr=ti[0];Xr.source!==this.source&&w.w(`layer.source = ${Xr.source} does not equal this.source = ${this.source}`),Xr.minzoom&&this.zoom<Math.floor(Xr.minzoom)||Xr.maxzoom&&this.zoom>=Xr.maxzoom||Xr.visibility!=="none"&&(J(ti,this.zoom,K),(ke[Xr.id]=Xr.createBucket({index:Se.bucketLayerIDs.length,layers:ti,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:ur,sourceID:this.source})).populate(Hr,pe,this.tileID.canonical),Se.bucketLayerIDs.push(ti.map(Qa=>Qa.id)))}}const We=w.aF(pe.glyphDependencies,on=>Object.keys(on).map(Number));this.inFlightDependencies.forEach(on=>on==null?void 0:on.abort()),this.inFlightDependencies=[];let Le=Promise.resolve({});if(Object.keys(We).length){const on=new AbortController;this.inFlightDependencies.push(on),Le=re.sendAsync({type:"GG",data:{stacks:We,source:this.source,tileID:this.tileID,type:"glyphs"}},on)}const it=Object.keys(pe.iconDependencies);let Mt=Promise.resolve({});if(it.length){const on=new AbortController;this.inFlightDependencies.push(on),Mt=re.sendAsync({type:"GI",data:{icons:it,source:this.source,tileID:this.tileID,type:"icons"}},on)}const Lt=Object.keys(pe.patternDependencies);let In=Promise.resolve({});if(Lt.length){const on=new AbortController;this.inFlightDependencies.push(on),In=re.sendAsync({type:"GI",data:{icons:Lt,source:this.source,tileID:this.tileID,type:"patterns"}},on)}const[Jt,kn,fn]=yield Promise.all([Le,Mt,In]),Ar=new D(Jt),xr=new w.bo(kn,fn);for(const on in ke){const Wn=ke[on];Wn instanceof w.a6?(J(Wn.layers,this.zoom,K),w.bp({bucket:Wn,glyphMap:Jt,glyphPositions:Ar.positions,imageMap:kn,imagePositions:xr.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical})):Wn.hasPattern&&(Wn instanceof w.bq||Wn instanceof w.br||Wn instanceof w.bs)&&(J(Wn.layers,this.zoom,K),Wn.addFeatures(pe,this.tileID.canonical,xr.patternPositions))}return this.status="done",{buckets:Object.values(ke).filter(on=>!on.isEmpty()),featureIndex:Se,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Ar.image,imageAtlas:xr,glyphMap:this.returnDependencies?Jt:null,iconMap:this.returnDependencies?kn:null,glyphPositions:this.returnDependencies?Ar.positions:null}})}}function J(ae,N,B){const K=new w.z(N);for(const re of ae)re.recalculate(K,B)}class G{constructor(N,B,K){this.actor=N,this.layerIndex=B,this.availableImages=K,this.fetching={},this.loading={},this.loaded={}}loadVectorTile(N,B){return w._(this,void 0,void 0,function*(){const K=yield w.l(N.request,B);try{return{vectorTile:new w.bt.VectorTile(new w.bu(K.data)),rawData:K.data,cacheControl:K.cacheControl,expires:K.expires}}catch(re){const ye=new Uint8Array(K.data);let Se=`Unable to parse the tile at ${N.request.url}, `;throw Se+=ye[0]===31&&ye[1]===139?"please make sure the data is not gzipped and that you have configured the relevant header in the server":`got error: ${re.message}`,new Error(Se)}})}loadTile(N){return w._(this,void 0,void 0,function*(){const B=N.uid,K=!!(N&&N.request&&N.request.collectResourceTiming)&&new w.bv(N.request),re=new j(N);this.loading[B]=re;const ye=new AbortController;re.abort=ye;try{const Se=yield this.loadVectorTile(N,ye);if(delete this.loading[B],!Se)return null;const ke=Se.rawData,pe={};Se.expires&&(pe.expires=Se.expires),Se.cacheControl&&(pe.cacheControl=Se.cacheControl);const Be={};if(K){const Le=K.finish();Le&&(Be.resourceTiming=JSON.parse(JSON.stringify(Le)))}re.vectorTile=Se.vectorTile;const We=re.parse(Se.vectorTile,this.layerIndex,this.availableImages,this.actor);this.loaded[B]=re,this.fetching[B]={rawTileData:ke,cacheControl:pe,resourceTiming:Be};try{const Le=yield We;return w.e({rawTileData:ke.slice(0)},Le,pe,Be)}finally{delete this.fetching[B]}}catch(Se){throw delete this.loading[B],re.status="done",this.loaded[B]=re,Se}})}reloadTile(N){return w._(this,void 0,void 0,function*(){const B=N.uid;if(!this.loaded||!this.loaded[B])throw new Error("Should not be trying to reload a tile that was never loaded or has been removed");const K=this.loaded[B];if(K.showCollisionBoxes=N.showCollisionBoxes,K.status==="parsing"){const re=yield K.parse(K.vectorTile,this.layerIndex,this.availableImages,this.actor);let ye;if(this.fetching[B]){const{rawTileData:Se,cacheControl:ke,resourceTiming:pe}=this.fetching[B];delete this.fetching[B],ye=w.e({rawTileData:Se.slice(0)},re,ke,pe)}else ye=re;return ye}if(K.status==="done"&&K.vectorTile)return K.parse(K.vectorTile,this.layerIndex,this.availableImages,this.actor)})}abortTile(N){return w._(this,void 0,void 0,function*(){const B=this.loading,K=N.uid;B&&B[K]&&B[K].abort&&(B[K].abort.abort(),delete B[K])})}removeTile(N){return w._(this,void 0,void 0,function*(){this.loaded&&this.loaded[N.uid]&&delete this.loaded[N.uid]})}}class q{constructor(){this.loaded={}}loadTile(N){return w._(this,void 0,void 0,function*(){const{uid:B,encoding:K,rawImageData:re,redFactor:ye,greenFactor:Se,blueFactor:ke,baseShift:pe}=N,Be=re.width+2,We=re.height+2,Le=w.b(re)?new w.R({width:Be,height:We},yield w.bw(re,-1,-1,Be,We)):re,it=new w.bx(B,Le,K,ye,Se,ke,pe);return this.loaded=this.loaded||{},this.loaded[B]=it,it})}removeTile(N){const B=this.loaded,K=N.uid;B&&B[K]&&delete B[K]}}function Ee(ae,N){if(ae.length!==0){Ae(ae[0],N);for(var B=1;B<ae.length;B++)Ae(ae[B],!N)}}function Ae(ae,N){for(var B=0,K=0,re=0,ye=ae.length,Se=ye-1;re<ye;Se=re++){var ke=(ae[re][0]-ae[Se][0])*(ae[Se][1]+ae[re][1]),pe=B+ke;K+=Math.abs(B)>=Math.abs(ke)?B-pe+ke:ke-pe+B,B=pe}B+K>=0!=!!N&&ae.reverse()}var Fe=w.by(function ae(N,B){var K,re=N&&N.type;if(re==="FeatureCollection")for(K=0;K<N.features.length;K++)ae(N.features[K],B);else if(re==="GeometryCollection")for(K=0;K<N.geometries.length;K++)ae(N.geometries[K],B);else if(re==="Feature")ae(N.geometry,B);else if(re==="Polygon")Ee(N.coordinates,B);else if(re==="MultiPolygon")for(K=0;K<N.coordinates.length;K++)Ee(N.coordinates[K],B);return N});const Ne=w.bt.VectorTileFeature.prototype.toGeoJSON;var se={exports:{}},ue=w.bz,he=w.bt.VectorTileFeature,De=Ze;function Ze(ae,N){this.options=N||{},this.features=ae,this.length=ae.length}function je(ae,N){this.id=typeof ae.id=="number"?ae.id:void 0,this.type=ae.type,this.rawGeometry=ae.type===1?[ae.geometry]:ae.geometry,this.properties=ae.tags,this.extent=N||4096}Ze.prototype.feature=function(ae){return new je(this.features[ae],this.options.extent)},je.prototype.loadGeometry=function(){var ae=this.rawGeometry;this.geometry=[];for(var N=0;N<ae.length;N++){for(var B=ae[N],K=[],re=0;re<B.length;re++)K.push(new ue(B[re][0],B[re][1]));this.geometry.push(K)}return this.geometry},je.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var ae=this.geometry,N=1/0,B=-1/0,K=1/0,re=-1/0,ye=0;ye<ae.length;ye++)for(var Se=ae[ye],ke=0;ke<Se.length;ke++){var pe=Se[ke];N=Math.min(N,pe.x),B=Math.max(B,pe.x),K=Math.min(K,pe.y),re=Math.max(re,pe.y)}return[N,K,B,re]},je.prototype.toGeoJSON=he.prototype.toGeoJSON;var ve=w.bA,ee=De;function de(ae){var N=new ve;return function(B,K){for(var re in B.layers)K.writeMessage(3,Te,B.layers[re])}(ae,N),N.finish()}function Te(ae,N){var B;N.writeVarintField(15,ae.version||1),N.writeStringField(1,ae.name||""),N.writeVarintField(5,ae.extent||4096);var K={keys:[],values:[],keycache:{},valuecache:{}};for(B=0;B<ae.length;B++)K.feature=ae.feature(B),N.writeMessage(2,Ue,K);var re=K.keys;for(B=0;B<re.length;B++)N.writeStringField(3,re[B]);var ye=K.values;for(B=0;B<ye.length;B++)N.writeMessage(4,Qn,ye[B])}function Ue(ae,N){var B=ae.feature;B.id!==void 0&&N.writeVarintField(1,B.id),N.writeMessage(2,Xe,ae),N.writeVarintField(3,B.type),N.writeMessage(4,qn,B)}function Xe(ae,N){var B=ae.feature,K=ae.keys,re=ae.values,ye=ae.keycache,Se=ae.valuecache;for(var ke in B.properties){var pe=B.properties[ke],Be=ye[ke];if(pe!==null){Be===void 0&&(K.push(ke),ye[ke]=Be=K.length-1),N.writeVarint(Be);var We=typeof pe;We!=="string"&&We!=="boolean"&&We!=="number"&&(pe=JSON.stringify(pe));var Le=We+":"+pe,it=Se[Le];it===void 0&&(re.push(pe),Se[Le]=it=re.length-1),N.writeVarint(it)}}}function mt(ae,N){return(N<<3)+(7&ae)}function Kt(ae){return ae<<1^ae>>31}function qn(ae,N){for(var B=ae.loadGeometry(),K=ae.type,re=0,ye=0,Se=B.length,ke=0;ke<Se;ke++){var pe=B[ke],Be=1;K===1&&(Be=pe.length),N.writeVarint(mt(1,Be));for(var We=K===3?pe.length-1:pe.length,Le=0;Le<We;Le++){Le===1&&K!==1&&N.writeVarint(mt(2,We-1));var it=pe[Le].x-re,Mt=pe[Le].y-ye;N.writeVarint(Kt(it)),N.writeVarint(Kt(Mt)),re+=it,ye+=Mt}K===3&&N.writeVarint(mt(7,1))}}function Qn(ae,N){var B=typeof ae;B==="string"?N.writeStringField(1,ae):B==="boolean"?N.writeBooleanField(7,ae):B==="number"&&(ae%1!=0?N.writeDoubleField(3,ae):ae<0?N.writeSVarintField(6,ae):N.writeVarintField(5,ae))}se.exports=de,se.exports.fromVectorTileJs=de,se.exports.fromGeojsonVt=function(ae,N){N=N||{};var B={};for(var K in ae)B[K]=new ee(ae[K].features,N),B[K].name=K,B[K].version=N.version,B[K].extent=N.extent;return de({layers:B})},se.exports.GeoJSONWrapper=ee;var zt=w.by(se.exports);const Je={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:ae=>ae},nt=Math.fround||(Et=new Float32Array(1),ae=>(Et[0]=+ae,Et[0]));var Et;const ct=3,It=5,St=6;class Sn{constructor(N){this.options=Object.assign(Object.create(Je),N),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(N){const{log:B,minZoom:K,maxZoom:re}=this.options;B&&console.time("total time");const ye=`prepare ${N.length} points`;B&&console.time(ye),this.points=N;const Se=[];for(let pe=0;pe<N.length;pe++){const Be=N[pe];if(!Be.geometry)continue;const[We,Le]=Be.geometry.coordinates,it=nt(Nn(We)),Mt=nt(Zt(Le));Se.push(it,Mt,1/0,pe,-1,1),this.options.reduce&&Se.push(0)}let ke=this.trees[re+1]=this._createTree(Se);B&&console.timeEnd(ye);for(let pe=re;pe>=K;pe--){const Be=+Date.now();ke=this.trees[pe]=this._createTree(this._cluster(ke,pe)),B&&console.log("z%d: %d clusters in %dms",pe,ke.numItems,+Date.now()-Be)}return B&&console.timeEnd("total time"),this}getClusters(N,B){let K=((N[0]+180)%360+360)%360-180;const re=Math.max(-90,Math.min(90,N[1]));let ye=N[2]===180?180:((N[2]+180)%360+360)%360-180;const Se=Math.max(-90,Math.min(90,N[3]));if(N[2]-N[0]>=360)K=-180,ye=180;else if(K>ye){const Le=this.getClusters([K,re,180,Se],B),it=this.getClusters([-180,re,ye,Se],B);return Le.concat(it)}const ke=this.trees[this._limitZoom(B)],pe=ke.range(Nn(K),Zt(Se),Nn(ye),Zt(re)),Be=ke.data,We=[];for(const Le of pe){const it=this.stride*Le;We.push(Be[it+It]>1?cn(Be,it,this.clusterProps):this.points[Be[it+ct]])}return We}getChildren(N){const B=this._getOriginId(N),K=this._getOriginZoom(N),re="No cluster with the specified id.",ye=this.trees[K];if(!ye)throw new Error(re);const Se=ye.data;if(B*this.stride>=Se.length)throw new Error(re);const ke=this.options.radius/(this.options.extent*Math.pow(2,K-1)),pe=ye.within(Se[B*this.stride],Se[B*this.stride+1],ke),Be=[];for(const We of pe){const Le=We*this.stride;Se[Le+4]===N&&Be.push(Se[Le+It]>1?cn(Se,Le,this.clusterProps):this.points[Se[Le+ct]])}if(Be.length===0)throw new Error(re);return Be}getLeaves(N,B,K){const re=[];return this._appendLeaves(re,N,B=B||10,K=K||0,0),re}getTile(N,B,K){const re=this.trees[this._limitZoom(N)],ye=Math.pow(2,N),{extent:Se,radius:ke}=this.options,pe=ke/Se,Be=(K-pe)/ye,We=(K+1+pe)/ye,Le={features:[]};return this._addTileFeatures(re.range((B-pe)/ye,Be,(B+1+pe)/ye,We),re.data,B,K,ye,Le),B===0&&this._addTileFeatures(re.range(1-pe/ye,Be,1,We),re.data,ye,K,ye,Le),B===ye-1&&this._addTileFeatures(re.range(0,Be,pe/ye,We),re.data,-1,K,ye,Le),Le.features.length?Le:null}getClusterExpansionZoom(N){let B=this._getOriginZoom(N)-1;for(;B<=this.options.maxZoom;){const K=this.getChildren(N);if(B++,K.length!==1)break;N=K[0].properties.cluster_id}return B}_appendLeaves(N,B,K,re,ye){const Se=this.getChildren(B);for(const ke of Se){const pe=ke.properties;if(pe&&pe.cluster?ye+pe.point_count<=re?ye+=pe.point_count:ye=this._appendLeaves(N,pe.cluster_id,K,re,ye):ye<re?ye++:N.push(ke),N.length===K)break}return ye}_createTree(N){const B=new w.av(N.length/this.stride|0,this.options.nodeSize,Float32Array);for(let K=0;K<N.length;K+=this.stride)B.add(N[K],N[K+1]);return B.finish(),B.data=N,B}_addTileFeatures(N,B,K,re,ye,Se){for(const ke of N){const pe=ke*this.stride,Be=B[pe+It]>1;let We,Le,it;if(Be)We=Cn(B,pe,this.clusterProps),Le=B[pe],it=B[pe+1];else{const In=this.points[B[pe+ct]];We=In.properties;const[Jt,kn]=In.geometry.coordinates;Le=Nn(Jt),it=Zt(kn)}const Mt={type:1,geometry:[[Math.round(this.options.extent*(Le*ye-K)),Math.round(this.options.extent*(it*ye-re))]],tags:We};let Lt;Lt=Be||this.options.generateId?B[pe+ct]:this.points[B[pe+ct]].id,Lt!==void 0&&(Mt.id=Lt),Se.features.push(Mt)}}_limitZoom(N){return Math.max(this.options.minZoom,Math.min(Math.floor(+N),this.options.maxZoom+1))}_cluster(N,B){const{radius:K,extent:re,reduce:ye,minPoints:Se}=this.options,ke=K/(re*Math.pow(2,B)),pe=N.data,Be=[],We=this.stride;for(let Le=0;Le<pe.length;Le+=We){if(pe[Le+2]<=B)continue;pe[Le+2]=B;const it=pe[Le],Mt=pe[Le+1],Lt=N.within(pe[Le],pe[Le+1],ke),In=pe[Le+It];let Jt=In;for(const kn of Lt){const fn=kn*We;pe[fn+2]>B&&(Jt+=pe[fn+It])}if(Jt>In&&Jt>=Se){let kn,fn=it*In,Ar=Mt*In,xr=-1;const on=((Le/We|0)<<5)+(B+1)+this.points.length;for(const Wn of Lt){const ur=Wn*We;if(pe[ur+2]<=B)continue;pe[ur+2]=B;const Hr=pe[ur+It];fn+=pe[ur]*Hr,Ar+=pe[ur+1]*Hr,pe[ur+4]=on,ye&&(kn||(kn=this._map(pe,Le,!0),xr=this.clusterProps.length,this.clusterProps.push(kn)),ye(kn,this._map(pe,ur)))}pe[Le+4]=on,Be.push(fn/Jt,Ar/Jt,1/0,on,-1,Jt),ye&&Be.push(xr)}else{for(let kn=0;kn<We;kn++)Be.push(pe[Le+kn]);if(Jt>1)for(const kn of Lt){const fn=kn*We;if(!(pe[fn+2]<=B)){pe[fn+2]=B;for(let Ar=0;Ar<We;Ar++)Be.push(pe[fn+Ar])}}}}return Be}_getOriginId(N){return N-this.points.length>>5}_getOriginZoom(N){return(N-this.points.length)%32}_map(N,B,K){if(N[B+It]>1){const Se=this.clusterProps[N[B+St]];return K?Object.assign({},Se):Se}const re=this.points[N[B+ct]].properties,ye=this.options.map(re);return K&&ye===re?Object.assign({},ye):ye}}function cn(ae,N,B){return{type:"Feature",id:ae[N+ct],properties:Cn(ae,N,B),geometry:{type:"Point",coordinates:[(K=ae[N],360*(K-.5)),rn(ae[N+1])]}};var K}function Cn(ae,N,B){const K=ae[N+It],re=K>=1e4?`${Math.round(K/1e3)}k`:K>=1e3?Math.round(K/100)/10+"k":K,ye=ae[N+St],Se=ye===-1?{}:Object.assign({},B[ye]);return Object.assign(Se,{cluster:!0,cluster_id:ae[N+ct],point_count:K,point_count_abbreviated:re})}function Nn(ae){return ae/360+.5}function Zt(ae){const N=Math.sin(ae*Math.PI/180),B=.5-.25*Math.log((1+N)/(1-N))/Math.PI;return B<0?0:B>1?1:B}function rn(ae){const N=(180-360*ae)*Math.PI/180;return 360*Math.atan(Math.exp(N))/Math.PI-90}function Zn(ae,N,B,K){let re=K;const ye=N+(B-N>>1);let Se,ke=B-N;const pe=ae[N],Be=ae[N+1],We=ae[B],Le=ae[B+1];for(let it=N+3;it<B;it+=3){const Mt=Qt(ae[it],ae[it+1],pe,Be,We,Le);if(Mt>re)Se=it,re=Mt;else if(Mt===re){const Lt=Math.abs(it-ye);Lt<ke&&(Se=it,ke=Lt)}}re>K&&(Se-N>3&&Zn(ae,N,Se,K),ae[Se+2]=re,B-Se>3&&Zn(ae,Se,B,K))}function Qt(ae,N,B,K,re,ye){let Se=re-B,ke=ye-K;if(Se!==0||ke!==0){const pe=((ae-B)*Se+(N-K)*ke)/(Se*Se+ke*ke);pe>1?(B=re,K=ye):pe>0&&(B+=Se*pe,K+=ke*pe)}return Se=ae-B,ke=N-K,Se*Se+ke*ke}function wn(ae,N,B,K){const re={id:ae??null,type:N,geometry:B,tags:K,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if(N==="Point"||N==="MultiPoint"||N==="LineString")er(re,B);else if(N==="Polygon")er(re,B[0]);else if(N==="MultiLineString")for(const ye of B)er(re,ye);else if(N==="MultiPolygon")for(const ye of B)er(re,ye[0]);return re}function er(ae,N){for(let B=0;B<N.length;B+=3)ae.minX=Math.min(ae.minX,N[B]),ae.minY=Math.min(ae.minY,N[B+1]),ae.maxX=Math.max(ae.maxX,N[B]),ae.maxY=Math.max(ae.maxY,N[B+1])}function sn(ae,N,B,K){if(!N.geometry)return;const re=N.geometry.coordinates;if(re&&re.length===0)return;const ye=N.geometry.type,Se=Math.pow(B.tolerance/((1<<B.maxZoom)*B.extent),2);let ke=[],pe=N.id;if(B.promoteId?pe=N.properties[B.promoteId]:B.generateId&&(pe=K||0),ye==="Point")dn(re,ke);else if(ye==="MultiPoint")for(const Be of re)dn(Be,ke);else if(ye==="LineString")Ce(re,ke,Se,!1);else if(ye==="MultiLineString"){if(B.lineMetrics){for(const Be of re)ke=[],Ce(Be,ke,Se,!1),ae.push(wn(pe,"LineString",ke,N.properties));return}Fn(re,ke,Se,!1)}else if(ye==="Polygon")Fn(re,ke,Se,!0);else{if(ye!=="MultiPolygon"){if(ye==="GeometryCollection"){for(const Be of N.geometry.geometries)sn(ae,{id:pe,geometry:Be,properties:N.properties},B,K);return}throw new Error("Input data is not a valid GeoJSON object.")}for(const Be of re){const We=[];Fn(Be,We,Se,!0),ke.push(We)}}ae.push(wn(pe,ye,ke,N.properties))}function dn(ae,N){N.push(bn(ae[0]),Rt(ae[1]),0)}function Ce(ae,N,B,K){let re,ye,Se=0;for(let pe=0;pe<ae.length;pe++){const Be=bn(ae[pe][0]),We=Rt(ae[pe][1]);N.push(Be,We,0),pe>0&&(Se+=K?(re*We-Be*ye)/2:Math.sqrt(Math.pow(Be-re,2)+Math.pow(We-ye,2))),re=Be,ye=We}const ke=N.length-3;N[2]=1,Zn(N,0,ke,B),N[ke+2]=1,N.size=Math.abs(Se),N.start=0,N.end=N.size}function Fn(ae,N,B,K){for(let re=0;re<ae.length;re++){const ye=[];Ce(ae[re],ye,B,K),N.push(ye)}}function bn(ae){return ae/360+.5}function Rt(ae){const N=Math.sin(ae*Math.PI/180),B=.5-.25*Math.log((1+N)/(1-N))/Math.PI;return B<0?0:B>1?1:B}function Yt(ae,N,B,K,re,ye,Se,ke){if(K/=N,ye>=(B/=N)&&Se<K)return ae;if(Se<B||ye>=K)return null;const pe=[];for(const Be of ae){const We=Be.geometry;let Le=Be.type;const it=re===0?Be.minX:Be.minY,Mt=re===0?Be.maxX:Be.maxY;if(it>=B&&Mt<K){pe.push(Be);continue}if(Mt<B||it>=K)continue;let Lt=[];if(Le==="Point"||Le==="MultiPoint")Tr(We,Lt,B,K,re);else if(Le==="LineString")yr(We,Lt,B,K,re,!1,ke.lineMetrics);else if(Le==="MultiLineString")vr(We,Lt,B,K,re,!1);else if(Le==="Polygon")vr(We,Lt,B,K,re,!0);else if(Le==="MultiPolygon")for(const In of We){const Jt=[];vr(In,Jt,B,K,re,!0),Jt.length&&Lt.push(Jt)}if(Lt.length){if(ke.lineMetrics&&Le==="LineString"){for(const In of Lt)pe.push(wn(Be.id,Le,In,Be.tags));continue}Le!=="LineString"&&Le!=="MultiLineString"||(Lt.length===1?(Le="LineString",Lt=Lt[0]):Le="MultiLineString"),Le!=="Point"&&Le!=="MultiPoint"||(Le=Lt.length===3?"Point":"MultiPoint"),pe.push(wn(Be.id,Le,Lt,Be.tags))}}return pe.length?pe:null}function Tr(ae,N,B,K,re){for(let ye=0;ye<ae.length;ye+=3){const Se=ae[ye+re];Se>=B&&Se<=K&&rr(N,ae[ye],ae[ye+1],ae[ye+2])}}function yr(ae,N,B,K,re,ye,Se){let ke=Gr(ae);const pe=re===0?dr:fr;let Be,We,Le=ae.start;for(let Jt=0;Jt<ae.length-3;Jt+=3){const kn=ae[Jt],fn=ae[Jt+1],Ar=ae[Jt+2],xr=ae[Jt+3],on=ae[Jt+4],Wn=re===0?kn:fn,ur=re===0?xr:on;let Hr=!1;Se&&(Be=Math.sqrt(Math.pow(kn-xr,2)+Math.pow(fn-on,2))),Wn<B?ur>B&&(We=pe(ke,kn,fn,xr,on,B),Se&&(ke.start=Le+Be*We)):Wn>K?ur<K&&(We=pe(ke,kn,fn,xr,on,K),Se&&(ke.start=Le+Be*We)):rr(ke,kn,fn,Ar),ur<B&&Wn>=B&&(We=pe(ke,kn,fn,xr,on,B),Hr=!0),ur>K&&Wn<=K&&(We=pe(ke,kn,fn,xr,on,K),Hr=!0),!ye&&Hr&&(Se&&(ke.end=Le+Be*We),N.push(ke),ke=Gr(ae)),Se&&(Le+=Be)}let it=ae.length-3;const Mt=ae[it],Lt=ae[it+1],In=re===0?Mt:Lt;In>=B&&In<=K&&rr(ke,Mt,Lt,ae[it+2]),it=ke.length-3,ye&&it>=3&&(ke[it]!==ke[0]||ke[it+1]!==ke[1])&&rr(ke,ke[0],ke[1],ke[2]),ke.length&&N.push(ke)}function Gr(ae){const N=[];return N.size=ae.size,N.start=ae.start,N.end=ae.end,N}function vr(ae,N,B,K,re,ye){for(const Se of ae)yr(Se,N,B,K,re,ye,!1)}function rr(ae,N,B,K){ae.push(N,B,K)}function dr(ae,N,B,K,re,ye){const Se=(ye-N)/(K-N);return rr(ae,ye,B+(re-B)*Se,1),Se}function fr(ae,N,B,K,re,ye){const Se=(ye-B)/(re-B);return rr(ae,N+(K-N)*Se,ye,1),Se}function Ke(ae,N){const B=[];for(let K=0;K<ae.length;K++){const re=ae[K],ye=re.type;let Se;if(ye==="Point"||ye==="MultiPoint"||ye==="LineString")Se=ci(re.geometry,N);else if(ye==="MultiLineString"||ye==="Polygon"){Se=[];for(const ke of re.geometry)Se.push(ci(ke,N))}else if(ye==="MultiPolygon"){Se=[];for(const ke of re.geometry){const pe=[];for(const Be of ke)pe.push(ci(Be,N));Se.push(pe)}}B.push(wn(re.id,ye,Se,re.tags))}return B}function ci(ae,N){const B=[];B.size=ae.size,ae.start!==void 0&&(B.start=ae.start,B.end=ae.end);for(let K=0;K<ae.length;K+=3)B.push(ae[K]+N,ae[K+1],ae[K+2]);return B}function Rr(ae,N){if(ae.transformed)return ae;const B=1<<ae.z,K=ae.x,re=ae.y;for(const ye of ae.features){const Se=ye.geometry,ke=ye.type;if(ye.geometry=[],ke===1)for(let pe=0;pe<Se.length;pe+=2)ye.geometry.push(jr(Se[pe],Se[pe+1],N,B,K,re));else for(let pe=0;pe<Se.length;pe++){const Be=[];for(let We=0;We<Se[pe].length;We+=2)Be.push(jr(Se[pe][We],Se[pe][We+1],N,B,K,re));ye.geometry.push(Be)}}return ae.transformed=!0,ae}function jr(ae,N,B,K,re,ye){return[Math.round(B*(ae*K-re)),Math.round(B*(N*K-ye))]}function Pr(ae,N,B,K,re){const ye=N===re.maxZoom?0:re.tolerance/((1<<N)*re.extent),Se={features:[],numPoints:0,numSimplified:0,numFeatures:ae.length,source:null,x:B,y:K,z:N,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const ke of ae)rt(Se,ke,ye,re);return Se}function rt(ae,N,B,K){const re=N.geometry,ye=N.type,Se=[];if(ae.minX=Math.min(ae.minX,N.minX),ae.minY=Math.min(ae.minY,N.minY),ae.maxX=Math.max(ae.maxX,N.maxX),ae.maxY=Math.max(ae.maxY,N.maxY),ye==="Point"||ye==="MultiPoint")for(let ke=0;ke<re.length;ke+=3)Se.push(re[ke],re[ke+1]),ae.numPoints++,ae.numSimplified++;else if(ye==="LineString")Ht(Se,re,ae,B,!1,!1);else if(ye==="MultiLineString"||ye==="Polygon")for(let ke=0;ke<re.length;ke++)Ht(Se,re[ke],ae,B,ye==="Polygon",ke===0);else if(ye==="MultiPolygon")for(let ke=0;ke<re.length;ke++){const pe=re[ke];for(let Be=0;Be<pe.length;Be++)Ht(Se,pe[Be],ae,B,!0,Be===0)}if(Se.length){let ke=N.tags||null;if(ye==="LineString"&&K.lineMetrics){ke={};for(const Be in N.tags)ke[Be]=N.tags[Be];ke.mapbox_clip_start=re.start/re.size,ke.mapbox_clip_end=re.end/re.size}const pe={geometry:Se,type:ye==="Polygon"||ye==="MultiPolygon"?3:ye==="LineString"||ye==="MultiLineString"?2:1,tags:ke};N.id!==null&&(pe.id=N.id),ae.features.push(pe)}}function Ht(ae,N,B,K,re,ye){const Se=K*K;if(K>0&&N.size<(re?Se:K))return void(B.numPoints+=N.length/3);const ke=[];for(let pe=0;pe<N.length;pe+=3)(K===0||N[pe+2]>Se)&&(B.numSimplified++,ke.push(N[pe],N[pe+1])),B.numPoints++;re&&function(pe,Be){let We=0;for(let Le=0,it=pe.length,Mt=it-2;Le<it;Mt=Le,Le+=2)We+=(pe[Le]-pe[Mt])*(pe[Le+1]+pe[Mt+1]);if(We>0===Be)for(let Le=0,it=pe.length;Le<it/2;Le+=2){const Mt=pe[Le],Lt=pe[Le+1];pe[Le]=pe[it-2-Le],pe[Le+1]=pe[it-1-Le],pe[it-2-Le]=Mt,pe[it-1-Le]=Lt}}(ke,ye),ae.push(ke)}const Ut={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class hi{constructor(N,B){const K=(B=this.options=function(ye,Se){for(const ke in Se)ye[ke]=Se[ke];return ye}(Object.create(Ut),B)).debug;if(K&&console.time("preprocess data"),B.maxZoom<0||B.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(B.promoteId&&B.generateId)throw new Error("promoteId and generateId cannot be used together.");let re=function(ye,Se){const ke=[];if(ye.type==="FeatureCollection")for(let pe=0;pe<ye.features.length;pe++)sn(ke,ye.features[pe],Se,pe);else sn(ke,ye.type==="Feature"?ye:{geometry:ye},Se);return ke}(N,B);this.tiles={},this.tileCoords=[],K&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",B.indexMaxZoom,B.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),re=function(ye,Se){const ke=Se.buffer/Se.extent;let pe=ye;const Be=Yt(ye,1,-1-ke,ke,0,-1,2,Se),We=Yt(ye,1,1-ke,2+ke,0,-1,2,Se);return(Be||We)&&(pe=Yt(ye,1,-ke,1+ke,0,-1,2,Se)||[],Be&&(pe=Ke(Be,1).concat(pe)),We&&(pe=pe.concat(Ke(We,-1)))),pe}(re,B),re.length&&this.splitTile(re,0,0,0),K&&(re.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(N,B,K,re,ye,Se,ke){const pe=[N,B,K,re],Be=this.options,We=Be.debug;for(;pe.length;){re=pe.pop(),K=pe.pop(),B=pe.pop(),N=pe.pop();const Le=1<<B,it=qi(B,K,re);let Mt=this.tiles[it];if(!Mt&&(We>1&&console.time("creation"),Mt=this.tiles[it]=Pr(N,B,K,re,Be),this.tileCoords.push({z:B,x:K,y:re}),We)){We>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",B,K,re,Mt.numFeatures,Mt.numPoints,Mt.numSimplified),console.timeEnd("creation"));const Hr=`z${B}`;this.stats[Hr]=(this.stats[Hr]||0)+1,this.total++}if(Mt.source=N,ye==null){if(B===Be.indexMaxZoom||Mt.numPoints<=Be.indexMaxPoints)continue}else{if(B===Be.maxZoom||B===ye)continue;if(ye!=null){const Hr=ye-B;if(K!==Se>>Hr||re!==ke>>Hr)continue}}if(Mt.source=null,N.length===0)continue;We>1&&console.time("clipping");const Lt=.5*Be.buffer/Be.extent,In=.5-Lt,Jt=.5+Lt,kn=1+Lt;let fn=null,Ar=null,xr=null,on=null,Wn=Yt(N,Le,K-Lt,K+Jt,0,Mt.minX,Mt.maxX,Be),ur=Yt(N,Le,K+In,K+kn,0,Mt.minX,Mt.maxX,Be);N=null,Wn&&(fn=Yt(Wn,Le,re-Lt,re+Jt,1,Mt.minY,Mt.maxY,Be),Ar=Yt(Wn,Le,re+In,re+kn,1,Mt.minY,Mt.maxY,Be),Wn=null),ur&&(xr=Yt(ur,Le,re-Lt,re+Jt,1,Mt.minY,Mt.maxY,Be),on=Yt(ur,Le,re+In,re+kn,1,Mt.minY,Mt.maxY,Be),ur=null),We>1&&console.timeEnd("clipping"),pe.push(fn||[],B+1,2*K,2*re),pe.push(Ar||[],B+1,2*K,2*re+1),pe.push(xr||[],B+1,2*K+1,2*re),pe.push(on||[],B+1,2*K+1,2*re+1)}}getTile(N,B,K){N=+N,B=+B,K=+K;const re=this.options,{extent:ye,debug:Se}=re;if(N<0||N>24)return null;const ke=1<<N,pe=qi(N,B=B+ke&ke-1,K);if(this.tiles[pe])return Rr(this.tiles[pe],ye);Se>1&&console.log("drilling down to z%d-%d-%d",N,B,K);let Be,We=N,Le=B,it=K;for(;!Be&&We>0;)We--,Le>>=1,it>>=1,Be=this.tiles[qi(We,Le,it)];return Be&&Be.source?(Se>1&&(console.log("found parent tile z%d-%d-%d",We,Le,it),console.time("drilling down")),this.splitTile(Be.source,We,Le,it,N,B,K),Se>1&&console.timeEnd("drilling down"),this.tiles[pe]?Rr(this.tiles[pe],ye):null):null}}function qi(ae,N,B){return 32*((1<<ae)*B+N)+ae}function Xt(ae,N){return N?ae.properties[N]:ae.id}function Ks(ae,N){if(ae==null)return!0;if(ae.type==="Feature")return Xt(ae,N)!=null;if(ae.type==="FeatureCollection"){const B=new Set;for(const K of ae.features){const re=Xt(K,N);if(re==null||B.has(re))return!1;B.add(re)}return!0}return!1}function uo(ae,N){const B=new Map;if(ae!=null)if(ae.type==="Feature")B.set(Xt(ae,N),ae);else for(const K of ae.features)B.set(Xt(K,N),K);return B}class co extends G{constructor(){super(...arguments),this._dataUpdateable=new Map}loadVectorTile(N,B){return w._(this,void 0,void 0,function*(){const K=N.tileID.canonical;if(!this._geoJSONIndex)throw new Error("Unable to parse the data into a cluster or geojson");const re=this._geoJSONIndex.getTile(K.z,K.x,K.y);if(!re)return null;const ye=new class{constructor(ke){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=w.X,this.length=ke.length,this._features=ke}feature(ke){return new class{constructor(pe){this._feature=pe,this.extent=w.X,this.type=pe.type,this.properties=pe.tags,"id"in pe&&!isNaN(pe.id)&&(this.id=parseInt(pe.id,10))}loadGeometry(){if(this._feature.type===1){const pe=[];for(const Be of this._feature.geometry)pe.push([new w.P(Be[0],Be[1])]);return pe}{const pe=[];for(const Be of this._feature.geometry){const We=[];for(const Le of Be)We.push(new w.P(Le[0],Le[1]));pe.push(We)}return pe}}toGeoJSON(pe,Be,We){return Ne.call(this,pe,Be,We)}}(this._features[ke])}}(re.features);let Se=zt(ye);return Se.byteOffset===0&&Se.byteLength===Se.buffer.byteLength||(Se=new Uint8Array(Se)),{vectorTile:ye,rawData:Se.buffer}})}loadData(N){return w._(this,void 0,void 0,function*(){var B;(B=this._pendingRequest)===null||B===void 0||B.abort();const K=!!(N&&N.request&&N.request.collectResourceTiming)&&new w.bv(N.request);this._pendingRequest=new AbortController;try{this._pendingData=this.loadAndProcessGeoJSON(N,this._pendingRequest),this._geoJSONIndex=N.cluster?new Sn(function({superclusterOptions:Se,clusterProperties:ke}){if(!ke||!Se)return Se;const pe={},Be={},We={accumulated:null,zoom:0},Le={properties:null},it=Object.keys(ke);for(const Mt of it){const[Lt,In]=ke[Mt],Jt=w.bC(In),kn=w.bC(typeof Lt=="string"?[Lt,["accumulated"],["get",Mt]]:Lt);pe[Mt]=Jt.value,Be[Mt]=kn.value}return Se.map=Mt=>{Le.properties=Mt;const Lt={};for(const In of it)Lt[In]=pe[In].evaluate(We,Le);return Lt},Se.reduce=(Mt,Lt)=>{Le.properties=Lt;for(const In of it)We.accumulated=Mt[In],Mt[In]=Be[In].evaluate(We,Le)},Se}(N)).load((yield this._pendingData).features):(re=yield this._pendingData,new hi(re,N.geojsonVtOptions)),this.loaded={};const ye={};if(K){const Se=K.finish();Se&&(ye.resourceTiming={},ye.resourceTiming[N.source]=JSON.parse(JSON.stringify(Se)))}return ye}catch(ye){if(delete this._pendingRequest,w.bB(ye))return{abandoned:!0};throw ye}var re})}getData(){return w._(this,void 0,void 0,function*(){return this._pendingData})}reloadTile(N){const B=this.loaded;return B&&B[N.uid]?super.reloadTile(N):this.loadTile(N)}loadAndProcessGeoJSON(N,B){return w._(this,void 0,void 0,function*(){let K=yield this.loadGeoJSON(N,B);if(delete this._pendingRequest,typeof K!="object")throw new Error(`Input data given to '${N.source}' is not a valid GeoJSON object.`);if(Fe(K,!0),N.filter){const re=w.bC(N.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(re.result==="error")throw new Error(re.value.map(Se=>`${Se.key}: ${Se.message}`).join(", "));K={type:"FeatureCollection",features:K.features.filter(Se=>re.value.evaluate({zoom:0},Se))}}return K})}loadGeoJSON(N,B){return w._(this,void 0,void 0,function*(){const{promoteId:K}=N;if(N.request){const re=yield w.h(N.request,B);return this._dataUpdateable=Ks(re.data,K)?uo(re.data,K):void 0,re.data}if(typeof N.data=="string")try{const re=JSON.parse(N.data);return this._dataUpdateable=Ks(re,K)?uo(re,K):void 0,re}catch{throw new Error(`Input data given to '${N.source}' is not a valid GeoJSON object.`)}if(!N.dataDiff)throw new Error(`Input data given to '${N.source}' is not a valid GeoJSON object.`);if(!this._dataUpdateable)throw new Error(`Cannot update existing geojson data in ${N.source}`);return function(re,ye,Se){var ke,pe,Be,We;if(ye.removeAll&&re.clear(),ye.remove)for(const Le of ye.remove)re.delete(Le);if(ye.add)for(const Le of ye.add){const it=Xt(Le,Se);it!=null&&re.set(it,Le)}if(ye.update)for(const Le of ye.update){let it=re.get(Le.id);if(it==null)continue;const Mt=!Le.removeAllProperties&&(((ke=Le.removeProperties)===null||ke===void 0?void 0:ke.length)>0||((pe=Le.addOrUpdateProperties)===null||pe===void 0?void 0:pe.length)>0);if((Le.newGeometry||Le.removeAllProperties||Mt)&&(it=Object.assign({},it),re.set(Le.id,it),Mt&&(it.properties=Object.assign({},it.properties))),Le.newGeometry&&(it.geometry=Le.newGeometry),Le.removeAllProperties)it.properties={};else if(((Be=Le.removeProperties)===null||Be===void 0?void 0:Be.length)>0)for(const Lt of Le.removeProperties)Object.prototype.hasOwnProperty.call(it.properties,Lt)&&delete it.properties[Lt];if(((We=Le.addOrUpdateProperties)===null||We===void 0?void 0:We.length)>0)for(const{key:Lt,value:In}of Le.addOrUpdateProperties)it.properties[Lt]=In}}(this._dataUpdateable,N.dataDiff,K),{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())}})}removeSource(N){return w._(this,void 0,void 0,function*(){this._pendingRequest&&this._pendingRequest.abort()})}getClusterExpansionZoom(N){return this._geoJSONIndex.getClusterExpansionZoom(N.clusterId)}getClusterChildren(N){return this._geoJSONIndex.getChildren(N.clusterId)}getClusterLeaves(N){return this._geoJSONIndex.getLeaves(N.clusterId,N.limit,N.offset)}}class Ds{constructor(N){this.self=N,this.actor=new w.F(N),this.layerIndexes={},this.availableImages={},this.workerSources={},this.demWorkerSources={},this.externalWorkerSourceTypes={},this.self.registerWorkerSource=(B,K)=>{if(this.externalWorkerSourceTypes[B])throw new Error(`Worker source with name "${B}" already registered.`);this.externalWorkerSourceTypes[B]=K},this.self.addProtocol=w.bi,this.self.removeProtocol=w.bj,this.self.registerRTLTextPlugin=B=>{if(w.bD.isParsed())throw new Error("RTL text plugin already registered.");w.bD.setMethods(B)},this.actor.registerMessageHandler("LDT",(B,K)=>this._getDEMWorkerSource(B,K.source).loadTile(K)),this.actor.registerMessageHandler("RDT",(B,K)=>w._(this,void 0,void 0,function*(){this._getDEMWorkerSource(B,K.source).removeTile(K)})),this.actor.registerMessageHandler("GCEZ",(B,K)=>w._(this,void 0,void 0,function*(){return this._getWorkerSource(B,K.type,K.source).getClusterExpansionZoom(K)})),this.actor.registerMessageHandler("GCC",(B,K)=>w._(this,void 0,void 0,function*(){return this._getWorkerSource(B,K.type,K.source).getClusterChildren(K)})),this.actor.registerMessageHandler("GCL",(B,K)=>w._(this,void 0,void 0,function*(){return this._getWorkerSource(B,K.type,K.source).getClusterLeaves(K)})),this.actor.registerMessageHandler("LD",(B,K)=>this._getWorkerSource(B,K.type,K.source).loadData(K)),this.actor.registerMessageHandler("GD",(B,K)=>this._getWorkerSource(B,K.type,K.source).getData()),this.actor.registerMessageHandler("LT",(B,K)=>this._getWorkerSource(B,K.type,K.source).loadTile(K)),this.actor.registerMessageHandler("RT",(B,K)=>this._getWorkerSource(B,K.type,K.source).reloadTile(K)),this.actor.registerMessageHandler("AT",(B,K)=>this._getWorkerSource(B,K.type,K.source).abortTile(K)),this.actor.registerMessageHandler("RMT",(B,K)=>this._getWorkerSource(B,K.type,K.source).removeTile(K)),this.actor.registerMessageHandler("RS",(B,K)=>w._(this,void 0,void 0,function*(){if(!this.workerSources[B]||!this.workerSources[B][K.type]||!this.workerSources[B][K.type][K.source])return;const re=this.workerSources[B][K.type][K.source];delete this.workerSources[B][K.type][K.source],re.removeSource!==void 0&&re.removeSource(K)})),this.actor.registerMessageHandler("RM",B=>w._(this,void 0,void 0,function*(){delete this.layerIndexes[B],delete this.availableImages[B],delete this.workerSources[B],delete this.demWorkerSources[B]})),this.actor.registerMessageHandler("SR",(B,K)=>w._(this,void 0,void 0,function*(){this.referrer=K})),this.actor.registerMessageHandler("SRPS",(B,K)=>this._syncRTLPluginState(B,K)),this.actor.registerMessageHandler("IS",(B,K)=>w._(this,void 0,void 0,function*(){this.self.importScripts(K)})),this.actor.registerMessageHandler("SI",(B,K)=>this._setImages(B,K)),this.actor.registerMessageHandler("UL",(B,K)=>w._(this,void 0,void 0,function*(){this._getLayerIndex(B).update(K.layers,K.removedIds)})),this.actor.registerMessageHandler("SL",(B,K)=>w._(this,void 0,void 0,function*(){this._getLayerIndex(B).replace(K)}))}_setImages(N,B){return w._(this,void 0,void 0,function*(){this.availableImages[N]=B;for(const K in this.workerSources[N]){const re=this.workerSources[N][K];for(const ye in re)re[ye].availableImages=B}})}_syncRTLPluginState(N,B){return w._(this,void 0,void 0,function*(){if(w.bD.isParsed())return w.bD.getState();if(B.pluginStatus!=="loading")return w.bD.setState(B),B;const K=B.pluginURL;if(this.self.importScripts(K),w.bD.isParsed()){const re={pluginStatus:"loaded",pluginURL:K};return w.bD.setState(re),re}throw w.bD.setState({pluginStatus:"error",pluginURL:""}),new Error(`RTL Text Plugin failed to import scripts from ${K}`)})}_getAvailableImages(N){let B=this.availableImages[N];return B||(B=[]),B}_getLayerIndex(N){let B=this.layerIndexes[N];return B||(B=this.layerIndexes[N]=new c),B}_getWorkerSource(N,B,K){if(this.workerSources[N]||(this.workerSources[N]={}),this.workerSources[N][B]||(this.workerSources[N][B]={}),!this.workerSources[N][B][K]){const re={sendAsync:(ye,Se)=>(ye.targetMapId=N,this.actor.sendAsync(ye,Se))};switch(B){case"vector":this.workerSources[N][B][K]=new G(re,this._getLayerIndex(N),this._getAvailableImages(N));break;case"geojson":this.workerSources[N][B][K]=new co(re,this._getLayerIndex(N),this._getAvailableImages(N));break;default:this.workerSources[N][B][K]=new this.externalWorkerSourceTypes[B](re,this._getLayerIndex(N),this._getAvailableImages(N))}}return this.workerSources[N][B][K]}_getDEMWorkerSource(N,B){return this.demWorkerSources[N]||(this.demWorkerSources[N]={}),this.demWorkerSources[N][B]||(this.demWorkerSources[N][B]=new q),this.demWorkerSources[N][B]}}return w.i(self)&&(self.worker=new Ds(self)),Ds}),g("index",["exports","./shared"],function(w,c){var D="4.7.1";let j,J;const G={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frameAsync:y=>new Promise((t,a)=>{const d=requestAnimationFrame(t);y.signal.addEventListener("abort",()=>{cancelAnimationFrame(d),a(c.c())})}),getImageData(y,t=0){return this.getImageCanvasContext(y).getImageData(-t,-t,y.width+2*t,y.height+2*t)},getImageCanvasContext(y){const t=window.document.createElement("canvas"),a=t.getContext("2d",{willReadFrequently:!0});if(!a)throw new Error("failed to create canvas 2d context");return t.width=y.width,t.height=y.height,a.drawImage(y,0,0,y.width,y.height),a},resolveURL:y=>(j||(j=document.createElement("a")),j.href=y,j.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(J==null&&(J=matchMedia("(prefers-reduced-motion: reduce)")),J.matches)}};class q{static testProp(t){if(!q.docStyle)return t[0];for(let a=0;a<t.length;a++)if(t[a]in q.docStyle)return t[a];return t[0]}static create(t,a,d){const f=window.document.createElement(t);return a!==void 0&&(f.className=a),d&&d.appendChild(f),f}static createNS(t,a){return window.document.createElementNS(t,a)}static disableDrag(){q.docStyle&&q.selectProp&&(q.userSelect=q.docStyle[q.selectProp],q.docStyle[q.selectProp]="none")}static enableDrag(){q.docStyle&&q.selectProp&&(q.docStyle[q.selectProp]=q.userSelect)}static setTransform(t,a){t.style[q.transformProp]=a}static addEventListener(t,a,d,f={}){t.addEventListener(a,d,"passive"in f?f:f.capture)}static removeEventListener(t,a,d,f={}){t.removeEventListener(a,d,"passive"in f?f:f.capture)}static suppressClickInternal(t){t.preventDefault(),t.stopPropagation(),window.removeEventListener("click",q.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",q.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",q.suppressClickInternal,!0)},0)}static getScale(t){const a=t.getBoundingClientRect();return{x:a.width/t.offsetWidth||1,y:a.height/t.offsetHeight||1,boundingClientRect:a}}static getPoint(t,a,d){const f=a.boundingClientRect;return new c.P((d.clientX-f.left)/a.x-t.clientLeft,(d.clientY-f.top)/a.y-t.clientTop)}static mousePos(t,a){const d=q.getScale(t);return q.getPoint(t,d,a)}static touchPos(t,a){const d=[],f=q.getScale(t);for(let _=0;_<a.length;_++)d.push(q.getPoint(t,f,a[_]));return d}static mouseButton(t){return t.button}static remove(t){t.parentNode&&t.parentNode.removeChild(t)}}q.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,q.selectProp=q.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),q.transformProp=q.testProp(["transform","WebkitTransform"]);const Ee={supported:!1,testSupport:function(y){!Ne&&Fe&&(se?ue(y):Ae=y)}};let Ae,Fe,Ne=!1,se=!1;function ue(y){const t=y.createTexture();y.bindTexture(y.TEXTURE_2D,t);try{if(y.texImage2D(y.TEXTURE_2D,0,y.RGBA,y.RGBA,y.UNSIGNED_BYTE,Fe),y.isContextLost())return;Ee.supported=!0}catch{}y.deleteTexture(t),Ne=!0}var he;typeof document<"u"&&(Fe=document.createElement("img"),Fe.onload=()=>{Ae&&ue(Ae),Ae=null,se=!0},Fe.onerror=()=>{Ne=!0,Ae=null},Fe.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),function(y){let t,a,d,f;y.resetRequestQueue=()=>{t=[],a=0,d=0,f={}},y.addThrottleControl=k=>{const z=d++;return f[z]=k,z},y.removeThrottleControl=k=>{delete f[k],E()},y.getImage=(k,z,R=!0)=>new Promise((O,V)=>{Ee.supported&&(k.headers||(k.headers={}),k.headers.accept="image/webp,*/*"),c.e(k,{type:"image"}),t.push({abortController:z,requestParameters:k,supportImageRefresh:R,state:"queued",onError:X=>{V(X)},onSuccess:X=>{O(X)}}),E()});const _=k=>c._(this,void 0,void 0,function*(){k.state="running";const{requestParameters:z,supportImageRefresh:R,onError:O,onSuccess:V,abortController:X}=k,Q=R===!1&&!c.i(self)&&!c.g(z.url)&&(!z.headers||Object.keys(z.headers).reduce((ce,me)=>ce&&me==="accept",!0));a++;const ie=Q?I(z,X):c.m(z,X);try{const ce=yield ie;delete k.abortController,k.state="completed",ce.data instanceof HTMLImageElement||c.b(ce.data)?V(ce):ce.data&&V({data:yield(le=ce.data,typeof createImageBitmap=="function"?c.d(le):c.f(le)),cacheControl:ce.cacheControl,expires:ce.expires})}catch(ce){delete k.abortController,O(ce)}finally{a--,E()}var le}),E=()=>{const k=(()=>{for(const z of Object.keys(f))if(f[z]())return!0;return!1})()?c.a.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:c.a.MAX_PARALLEL_IMAGE_REQUESTS;for(let z=a;z<k&&t.length>0;z++){const R=t.shift();R.abortController.signal.aborted?z--:_(R)}},I=(k,z)=>new Promise((R,O)=>{const V=new Image,X=k.url,Q=k.credentials;Q&&Q==="include"?V.crossOrigin="use-credentials":(Q&&Q==="same-origin"||!c.s(X))&&(V.crossOrigin="anonymous"),z.signal.addEventListener("abort",()=>{V.src="",O(c.c())}),V.fetchPriority="high",V.onload=()=>{V.onerror=V.onload=null,R({data:V})},V.onerror=()=>{V.onerror=V.onload=null,z.signal.aborted||O(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))},V.src=X})}(he||(he={})),he.resetRequestQueue();class De{constructor(t){this._transformRequestFn=t}transformRequest(t,a){return this._transformRequestFn&&this._transformRequestFn(t,a)||{url:t}}setTransformRequest(t){this._transformRequestFn=t}}function Ze(y){var t=new c.A(3);return t[0]=y[0],t[1]=y[1],t[2]=y[2],t}var je,ve=function(y,t,a){return y[0]=t[0]-a[0],y[1]=t[1]-a[1],y[2]=t[2]-a[2],y};je=new c.A(3),c.A!=Float32Array&&(je[0]=0,je[1]=0,je[2]=0);var ee=function(y){var t=y[0],a=y[1];return t*t+a*a};function de(y){const t=[];if(typeof y=="string")t.push({id:"default",url:y});else if(y&&y.length>0){const a=[];for(const{id:d,url:f}of y){const _=`${d}${f}`;a.indexOf(_)===-1&&(a.push(_),t.push({id:d,url:f}))}}return t}function Te(y,t,a){const d=y.split("?");return d[0]+=`${t}${a}`,d.join("?")}(function(){var y=new c.A(2);c.A!=Float32Array&&(y[0]=0,y[1]=0)})();class Ue{constructor(t,a,d,f){this.context=t,this.format=d,this.texture=t.gl.createTexture(),this.update(a,f)}update(t,a,d){const{width:f,height:_}=t,E=!(this.size&&this.size[0]===f&&this.size[1]===_||d),{context:I}=this,{gl:k}=I;if(this.useMipmap=!!(a&&a.useMipmap),k.bindTexture(k.TEXTURE_2D,this.texture),I.pixelStoreUnpackFlipY.set(!1),I.pixelStoreUnpack.set(1),I.pixelStoreUnpackPremultiplyAlpha.set(this.format===k.RGBA&&(!a||a.premultiply!==!1)),E)this.size=[f,_],t instanceof HTMLImageElement||t instanceof HTMLCanvasElement||t instanceof HTMLVideoElement||t instanceof ImageData||c.b(t)?k.texImage2D(k.TEXTURE_2D,0,this.format,this.format,k.UNSIGNED_BYTE,t):k.texImage2D(k.TEXTURE_2D,0,this.format,f,_,0,this.format,k.UNSIGNED_BYTE,t.data);else{const{x:z,y:R}=d||{x:0,y:0};t instanceof HTMLImageElement||t instanceof HTMLCanvasElement||t instanceof HTMLVideoElement||t instanceof ImageData||c.b(t)?k.texSubImage2D(k.TEXTURE_2D,0,z,R,k.RGBA,k.UNSIGNED_BYTE,t):k.texSubImage2D(k.TEXTURE_2D,0,z,R,f,_,k.RGBA,k.UNSIGNED_BYTE,t.data)}this.useMipmap&&this.isSizePowerOfTwo()&&k.generateMipmap(k.TEXTURE_2D)}bind(t,a,d){const{context:f}=this,{gl:_}=f;_.bindTexture(_.TEXTURE_2D,this.texture),d!==_.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(d=_.LINEAR),t!==this.filter&&(_.texParameteri(_.TEXTURE_2D,_.TEXTURE_MAG_FILTER,t),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_MIN_FILTER,d||t),this.filter=t),a!==this.wrap&&(_.texParameteri(_.TEXTURE_2D,_.TEXTURE_WRAP_S,a),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_WRAP_T,a),this.wrap=a)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:t}=this.context;t.deleteTexture(this.texture),this.texture=null}}function Xe(y){const{userImage:t}=y;return!!(t&&t.render&&t.render())&&(y.data.replace(new Uint8Array(t.data.buffer)),!0)}class mt extends c.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new c.R({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(t){if(this.loaded!==t&&(this.loaded=t,t)){for(const{ids:a,promiseResolve:d}of this.requestors)d(this._getImagesForIds(a));this.requestors=[]}}getImage(t){const a=this.images[t];if(a&&!a.data&&a.spriteData){const d=a.spriteData;a.data=new c.R({width:d.width,height:d.height},d.context.getImageData(d.x,d.y,d.width,d.height).data),a.spriteData=null}return a}addImage(t,a){if(this.images[t])throw new Error(`Image id ${t} already exist, use updateImage instead`);this._validate(t,a)&&(this.images[t]=a)}_validate(t,a){let d=!0;const f=a.data||a.spriteData;return this._validateStretch(a.stretchX,f&&f.width)||(this.fire(new c.j(new Error(`Image "${t}" has invalid "stretchX" value`))),d=!1),this._validateStretch(a.stretchY,f&&f.height)||(this.fire(new c.j(new Error(`Image "${t}" has invalid "stretchY" value`))),d=!1),this._validateContent(a.content,a)||(this.fire(new c.j(new Error(`Image "${t}" has invalid "content" value`))),d=!1),d}_validateStretch(t,a){if(!t)return!0;let d=0;for(const f of t){if(f[0]<d||f[1]<f[0]||a<f[1])return!1;d=f[1]}return!0}_validateContent(t,a){if(!t)return!0;if(t.length!==4)return!1;const d=a.spriteData,f=d&&d.width||a.data.width,_=d&&d.height||a.data.height;return!(t[0]<0||f<t[0]||t[1]<0||_<t[1]||t[2]<0||f<t[2]||t[3]<0||_<t[3]||t[2]<t[0]||t[3]<t[1])}updateImage(t,a,d=!0){const f=this.getImage(t);if(d&&(f.data.width!==a.data.width||f.data.height!==a.data.height))throw new Error(`size mismatch between old image (${f.data.width}x${f.data.height}) and new image (${a.data.width}x${a.data.height}).`);a.version=f.version+1,this.images[t]=a,this.updatedImages[t]=!0}removeImage(t){const a=this.images[t];delete this.images[t],delete this.patterns[t],a.userImage&&a.userImage.onRemove&&a.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(t){return new Promise((a,d)=>{let f=!0;if(!this.isLoaded())for(const _ of t)this.images[_]||(f=!1);this.isLoaded()||f?a(this._getImagesForIds(t)):this.requestors.push({ids:t,promiseResolve:a})})}_getImagesForIds(t){const a={};for(const d of t){let f=this.getImage(d);f||(this.fire(new c.k("styleimagemissing",{id:d})),f=this.getImage(d)),f?a[d]={data:f.data.clone(),pixelRatio:f.pixelRatio,sdf:f.sdf,version:f.version,stretchX:f.stretchX,stretchY:f.stretchY,content:f.content,textFitWidth:f.textFitWidth,textFitHeight:f.textFitHeight,hasRenderCallback:!!(f.userImage&&f.userImage.render)}:c.w(`Image "${d}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}return a}getPixelSize(){const{width:t,height:a}=this.atlasImage;return{width:t,height:a}}getPattern(t){const a=this.patterns[t],d=this.getImage(t);if(!d)return null;if(a&&a.position.version===d.version)return a.position;if(a)a.position.version=d.version;else{const f={w:d.data.width+2,h:d.data.height+2,x:0,y:0},_=new c.I(f,d);this.patterns[t]={bin:f,position:_}}return this._updatePatternAtlas(),this.patterns[t].position}bind(t){const a=t.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new Ue(t,this.atlasImage,a.RGBA),this.atlasTexture.bind(a.LINEAR,a.CLAMP_TO_EDGE)}_updatePatternAtlas(){const t=[];for(const _ in this.patterns)t.push(this.patterns[_].bin);const{w:a,h:d}=c.p(t),f=this.atlasImage;f.resize({width:a||1,height:d||1});for(const _ in this.patterns){const{bin:E}=this.patterns[_],I=E.x+1,k=E.y+1,z=this.getImage(_).data,R=z.width,O=z.height;c.R.copy(z,f,{x:0,y:0},{x:I,y:k},{width:R,height:O}),c.R.copy(z,f,{x:0,y:O-1},{x:I,y:k-1},{width:R,height:1}),c.R.copy(z,f,{x:0,y:0},{x:I,y:k+O},{width:R,height:1}),c.R.copy(z,f,{x:R-1,y:0},{x:I-1,y:k},{width:1,height:O}),c.R.copy(z,f,{x:0,y:0},{x:I+R,y:k},{width:1,height:O})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(t){for(const a of t){if(this.callbackDispatchedThisFrame[a])continue;this.callbackDispatchedThisFrame[a]=!0;const d=this.getImage(a);d||c.w(`Image with ID: "${a}" was not found`),Xe(d)&&this.updateImage(a,d)}}}const Kt=1e20;function qn(y,t,a,d,f,_,E,I,k){for(let z=t;z<t+d;z++)Qn(y,a*_+z,_,f,E,I,k);for(let z=a;z<a+f;z++)Qn(y,z*_+t,1,d,E,I,k)}function Qn(y,t,a,d,f,_,E){_[0]=0,E[0]=-Kt,E[1]=Kt,f[0]=y[t];for(let I=1,k=0,z=0;I<d;I++){f[I]=y[t+I*a];const R=I*I;do{const O=_[k];z=(f[I]-f[O]+R-O*O)/(I-O)/2}while(z<=E[k]&&--k>-1);k++,_[k]=I,E[k]=z,E[k+1]=Kt}for(let I=0,k=0;I<d;I++){for(;E[k+1]<I;)k++;const z=_[k],R=I-z;y[t+I*a]=f[z]+R*R}}class zt{constructor(t,a){this.requestManager=t,this.localIdeographFontFamily=a,this.entries={}}setURL(t){this.url=t}getGlyphs(t){return c._(this,void 0,void 0,function*(){const a=[];for(const _ in t)for(const E of t[_])a.push(this._getAndCacheGlyphsPromise(_,E));const d=yield Promise.all(a),f={};for(const{stack:_,id:E,glyph:I}of d)f[_]||(f[_]={}),f[_][E]=I&&{id:I.id,bitmap:I.bitmap.clone(),metrics:I.metrics};return f})}_getAndCacheGlyphsPromise(t,a){return c._(this,void 0,void 0,function*(){let d=this.entries[t];d||(d=this.entries[t]={glyphs:{},requests:{},ranges:{}});let f=d.glyphs[a];if(f!==void 0)return{stack:t,id:a,glyph:f};if(f=this._tinySDF(d,t,a),f)return d.glyphs[a]=f,{stack:t,id:a,glyph:f};const _=Math.floor(a/256);if(256*_>65535)throw new Error("glyphs > 65535 not supported");if(d.ranges[_])return{stack:t,id:a,glyph:f};if(!this.url)throw new Error("glyphsUrl is not set");if(!d.requests[_]){const I=zt.loadGlyphRange(t,_,this.url,this.requestManager);d.requests[_]=I}const E=yield d.requests[_];for(const I in E)this._doesCharSupportLocalGlyph(+I)||(d.glyphs[+I]=E[+I]);return d.ranges[_]=!0,{stack:t,id:a,glyph:E[a]||null}})}_doesCharSupportLocalGlyph(t){return!!this.localIdeographFontFamily&&new RegExp("\\p{Ideo}|\\p{sc=Hang}|\\p{sc=Hira}|\\p{sc=Kana}","u").test(String.fromCodePoint(t))}_tinySDF(t,a,d){const f=this.localIdeographFontFamily;if(!f||!this._doesCharSupportLocalGlyph(d))return;let _=t.tinySDF;if(!_){let I="400";/bold/i.test(a)?I="900":/medium/i.test(a)?I="500":/light/i.test(a)&&(I="200"),_=t.tinySDF=new zt.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,fontFamily:f,fontWeight:I})}const E=_.draw(String.fromCharCode(d));return{id:d,bitmap:new c.o({width:E.width||60,height:E.height||60},E.data),metrics:{width:E.glyphWidth/2||24,height:E.glyphHeight/2||24,left:E.glyphLeft/2+.5||0,top:E.glyphTop/2-27.5||-8,advance:E.glyphAdvance/2||24,isDoubleResolution:!0}}}}zt.loadGlyphRange=function(y,t,a,d){return c._(this,void 0,void 0,function*(){const f=256*t,_=f+255,E=d.transformRequest(a.replace("{fontstack}",y).replace("{range}",`${f}-${_}`),"Glyphs"),I=yield c.l(E,new AbortController);if(!I||!I.data)throw new Error(`Could not load glyph range. range: ${t}, ${f}-${_}`);const k={};for(const z of c.n(I.data))k[z.id]=z;return k})},zt.TinySDF=class{constructor({fontSize:y=24,buffer:t=3,radius:a=8,cutoff:d=.25,fontFamily:f="sans-serif",fontWeight:_="normal",fontStyle:E="normal"}={}){this.buffer=t,this.cutoff=d,this.radius=a;const I=this.size=y+4*t,k=this._createCanvas(I),z=this.ctx=k.getContext("2d",{willReadFrequently:!0});z.font=`${E} ${_} ${y}px ${f}`,z.textBaseline="alphabetic",z.textAlign="left",z.fillStyle="black",this.gridOuter=new Float64Array(I*I),this.gridInner=new Float64Array(I*I),this.f=new Float64Array(I),this.z=new Float64Array(I+1),this.v=new Uint16Array(I)}_createCanvas(y){const t=document.createElement("canvas");return t.width=t.height=y,t}draw(y){const{width:t,actualBoundingBoxAscent:a,actualBoundingBoxDescent:d,actualBoundingBoxLeft:f,actualBoundingBoxRight:_}=this.ctx.measureText(y),E=Math.ceil(a),I=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(_-f))),k=Math.min(this.size-this.buffer,E+Math.ceil(d)),z=I+2*this.buffer,R=k+2*this.buffer,O=Math.max(z*R,0),V=new Uint8ClampedArray(O),X={data:V,width:z,height:R,glyphWidth:I,glyphHeight:k,glyphTop:E,glyphLeft:0,glyphAdvance:t};if(I===0||k===0)return X;const{ctx:Q,buffer:ie,gridInner:le,gridOuter:ce}=this;Q.clearRect(ie,ie,I,k),Q.fillText(y,ie,ie+E);const me=Q.getImageData(ie,ie,I,k);ce.fill(Kt,0,O),le.fill(0,0,O);for(let te=0;te<k;te++)for(let xe=0;xe<I;xe++){const be=me.data[4*(te*I+xe)+3]/255;if(be===0)continue;const ze=(te+ie)*z+xe+ie;if(be===1)ce[ze]=0,le[ze]=Kt;else{const qe=.5-be;ce[ze]=qe>0?qe*qe:0,le[ze]=qe<0?qe*qe:0}}qn(ce,0,0,z,R,z,this.f,this.v,this.z),qn(le,ie,ie,I,k,z,this.f,this.v,this.z);for(let te=0;te<O;te++){const xe=Math.sqrt(ce[te])-Math.sqrt(le[te]);V[te]=Math.round(255-255*(xe/this.radius+this.cutoff))}return X}};class Je{constructor(){this.specification=c.v.light.position}possiblyEvaluate(t,a){return c.x(t.expression.evaluate(a))}interpolate(t,a,d){return{x:c.y.number(t.x,a.x,d),y:c.y.number(t.y,a.y,d),z:c.y.number(t.z,a.z,d)}}}let nt;class Et extends c.E{constructor(t){super(),nt=nt||new c.q({anchor:new c.D(c.v.light.anchor),position:new Je,color:new c.D(c.v.light.color),intensity:new c.D(c.v.light.intensity)}),this._transitionable=new c.T(nt),this.setLight(t),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(t,a={}){if(!this._validate(c.r,t,a))for(const d in t){const f=t[d];d.endsWith("-transition")?this._transitionable.setTransition(d.slice(0,-11),f):this._transitionable.setValue(d,f)}}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t)}_validate(t,a,d){return(!d||d.validate!==!1)&&c.t(this,t.call(c.u,{value:a,style:{glyphs:!0,sprite:!0},styleSpec:c.v}))}}const ct=new c.q({"sky-color":new c.D(c.v.sky["sky-color"]),"horizon-color":new c.D(c.v.sky["horizon-color"]),"fog-color":new c.D(c.v.sky["fog-color"]),"fog-ground-blend":new c.D(c.v.sky["fog-ground-blend"]),"horizon-fog-blend":new c.D(c.v.sky["horizon-fog-blend"]),"sky-horizon-blend":new c.D(c.v.sky["sky-horizon-blend"]),"atmosphere-blend":new c.D(c.v.sky["atmosphere-blend"])});class It extends c.E{constructor(t){super(),this._transitionable=new c.T(ct),this.setSky(t),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new c.z(0))}setSky(t,a={}){if(!this._validate(c.B,t,a)){t||(t={"sky-color":"transparent","horizon-color":"transparent","fog-color":"transparent","fog-ground-blend":1,"atmosphere-blend":0});for(const d in t){const f=t[d];d.endsWith("-transition")?this._transitionable.setTransition(d.slice(0,-11),f):this._transitionable.setValue(d,f)}}}getSky(){return this._transitionable.serialize()}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t)}_validate(t,a,d={}){return(d==null?void 0:d.validate)!==!1&&c.t(this,t.call(c.u,c.e({value:a,style:{glyphs:!0,sprite:!0},styleSpec:c.v})))}calculateFogBlendOpacity(t){return t<60?0:t<70?(t-60)/10:1}}class St{constructor(t,a){this.width=t,this.height=a,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(t,a){const d=t.join(",")+String(a);return this.dashEntry[d]||(this.dashEntry[d]=this.addDash(t,a)),this.dashEntry[d]}getDashRanges(t,a,d){const f=[];let _=t.length%2==1?-t[t.length-1]*d:0,E=t[0]*d,I=!0;f.push({left:_,right:E,isDash:I,zeroLength:t[0]===0});let k=t[0];for(let z=1;z<t.length;z++){I=!I;const R=t[z];_=k*d,k+=R,E=k*d,f.push({left:_,right:E,isDash:I,zeroLength:R===0})}return f}addRoundDash(t,a,d){const f=a/2;for(let _=-d;_<=d;_++){const E=this.width*(this.nextRow+d+_);let I=0,k=t[I];for(let z=0;z<this.width;z++){z/k.right>1&&(k=t[++I]);const R=Math.abs(z-k.left),O=Math.abs(z-k.right),V=Math.min(R,O);let X;const Q=_/d*(f+1);if(k.isDash){const ie=f-Math.abs(Q);X=Math.sqrt(V*V+ie*ie)}else X=f-Math.sqrt(V*V+Q*Q);this.data[E+z]=Math.max(0,Math.min(255,X+128))}}}addRegularDash(t){for(let I=t.length-1;I>=0;--I){const k=t[I],z=t[I+1];k.zeroLength?t.splice(I,1):z&&z.isDash===k.isDash&&(z.left=k.left,t.splice(I,1))}const a=t[0],d=t[t.length-1];a.isDash===d.isDash&&(a.left=d.left-this.width,d.right=a.right+this.width);const f=this.width*this.nextRow;let _=0,E=t[_];for(let I=0;I<this.width;I++){I/E.right>1&&(E=t[++_]);const k=Math.abs(I-E.left),z=Math.abs(I-E.right),R=Math.min(k,z);this.data[f+I]=Math.max(0,Math.min(255,(E.isDash?R:-R)+128))}}addDash(t,a){const d=a?7:0,f=2*d+1;if(this.nextRow+f>this.height)return c.w("LineAtlas out of space"),null;let _=0;for(let I=0;I<t.length;I++)_+=t[I];if(_!==0){const I=this.width/_,k=this.getDashRanges(t,this.width,I);a?this.addRoundDash(k,I,d):this.addRegularDash(k)}const E={y:(this.nextRow+d+.5)/this.height,height:2*d/this.height,width:_};return this.nextRow+=f,this.dirty=!0,E}bind(t){const a=t.gl;this.texture?(a.bindTexture(a.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,a.texSubImage2D(a.TEXTURE_2D,0,0,0,this.width,this.height,a.ALPHA,a.UNSIGNED_BYTE,this.data))):(this.texture=a.createTexture(),a.bindTexture(a.TEXTURE_2D,this.texture),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.REPEAT),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.REPEAT),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.LINEAR),a.texImage2D(a.TEXTURE_2D,0,a.ALPHA,this.width,this.height,0,a.ALPHA,a.UNSIGNED_BYTE,this.data))}}const Sn="maplibre_preloaded_worker_pool";class cn{constructor(){this.active={}}acquire(t){if(!this.workers)for(this.workers=[];this.workers.length<cn.workerCount;)this.workers.push(new Worker(c.a.WORKER_URL));return this.active[t]=!0,this.workers.slice()}release(t){delete this.active[t],this.numActive()===0&&(this.workers.forEach(a=>{a.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[Sn]}numActive(){return Object.keys(this.active).length}}const Cn=Math.floor(G.hardwareConcurrency/2);let Nn,Zt;function rn(){return Nn||(Nn=new cn),Nn}cn.workerCount=c.C(globalThis)?Math.max(Math.min(Cn,3),1):1;class Zn{constructor(t,a){this.workerPool=t,this.actors=[],this.currentActor=0,this.id=a;const d=this.workerPool.acquire(a);for(let f=0;f<d.length;f++){const _=new c.F(d[f],a);_.name=`Worker ${f}`,this.actors.push(_)}if(!this.actors.length)throw new Error("No actors found")}broadcast(t,a){const d=[];for(const f of this.actors)d.push(f.sendAsync({type:t,data:a}));return Promise.all(d)}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(t=!0){this.actors.forEach(a=>{a.remove()}),this.actors=[],t&&this.workerPool.release(this.id)}registerMessageHandler(t,a){for(const d of this.actors)d.registerMessageHandler(t,a)}}function Qt(){return Zt||(Zt=new Zn(rn(),c.G),Zt.registerMessageHandler("GR",(y,t,a)=>c.m(t,a))),Zt}function wn(y,t){const a=c.H();return c.J(a,a,[1,1,0]),c.K(a,a,[.5*y.width,.5*y.height,1]),c.L(a,a,y.calculatePosMatrix(t.toUnwrapped()))}function er(y,t,a,d,f,_){const E=function(O,V,X){if(O)for(const Q of O){const ie=V[Q];if(ie&&ie.source===X&&ie.type==="fill-extrusion")return!0}else for(const Q in V){const ie=V[Q];if(ie.source===X&&ie.type==="fill-extrusion")return!0}return!1}(f&&f.layers,t,y.id),I=_.maxPitchScaleFactor(),k=y.tilesIn(d,I,E);k.sort(sn);const z=[];for(const O of k)z.push({wrappedTileID:O.tileID.wrapped().key,queryResults:O.tile.queryRenderedFeatures(t,a,y._state,O.queryGeometry,O.cameraQueryGeometry,O.scale,f,_,I,wn(y.transform,O.tileID))});const R=function(O){const V={},X={};for(const Q of O){const ie=Q.queryResults,le=Q.wrappedTileID,ce=X[le]=X[le]||{};for(const me in ie){const te=ie[me],xe=ce[me]=ce[me]||{},be=V[me]=V[me]||[];for(const ze of te)xe[ze.featureIndex]||(xe[ze.featureIndex]=!0,be.push(ze))}}return V}(z);for(const O in R)R[O].forEach(V=>{const X=V.feature,Q=y.getFeatureState(X.layer["source-layer"],X.id);X.source=X.layer.source,X.layer["source-layer"]&&(X.sourceLayer=X.layer["source-layer"]),X.state=Q});return R}function sn(y,t){const a=y.tileID,d=t.tileID;return a.overscaledZ-d.overscaledZ||a.canonical.y-d.canonical.y||a.wrap-d.wrap||a.canonical.x-d.canonical.x}function dn(y,t,a){return c._(this,void 0,void 0,function*(){let d=y;if(y.url?d=(yield c.h(t.transformRequest(y.url,"Source"),a)).data:yield G.frameAsync(a),!d)return null;const f=c.M(c.e(d,y),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);return"vector_layers"in d&&d.vector_layers&&(f.vectorLayerIds=d.vector_layers.map(_=>_.id)),f})}class Ce{constructor(t,a){t&&(a?this.setSouthWest(t).setNorthEast(a):Array.isArray(t)&&(t.length===4?this.setSouthWest([t[0],t[1]]).setNorthEast([t[2],t[3]]):this.setSouthWest(t[0]).setNorthEast(t[1])))}setNorthEast(t){return this._ne=t instanceof c.N?new c.N(t.lng,t.lat):c.N.convert(t),this}setSouthWest(t){return this._sw=t instanceof c.N?new c.N(t.lng,t.lat):c.N.convert(t),this}extend(t){const a=this._sw,d=this._ne;let f,_;if(t instanceof c.N)f=t,_=t;else{if(!(t instanceof Ce))return Array.isArray(t)?t.length===4||t.every(Array.isArray)?this.extend(Ce.convert(t)):this.extend(c.N.convert(t)):t&&("lng"in t||"lon"in t)&&"lat"in t?this.extend(c.N.convert(t)):this;if(f=t._sw,_=t._ne,!f||!_)return this}return a||d?(a.lng=Math.min(f.lng,a.lng),a.lat=Math.min(f.lat,a.lat),d.lng=Math.max(_.lng,d.lng),d.lat=Math.max(_.lat,d.lat)):(this._sw=new c.N(f.lng,f.lat),this._ne=new c.N(_.lng,_.lat)),this}getCenter(){return new c.N((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new c.N(this.getWest(),this.getNorth())}getSouthEast(){return new c.N(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(t){const{lng:a,lat:d}=c.N.convert(t);let f=this._sw.lng<=a&&a<=this._ne.lng;return this._sw.lng>this._ne.lng&&(f=this._sw.lng>=a&&a>=this._ne.lng),this._sw.lat<=d&&d<=this._ne.lat&&f}static convert(t){return t instanceof Ce?t:t&&new Ce(t)}static fromLngLat(t,a=0){const d=360*a/40075017,f=d/Math.cos(Math.PI/180*t.lat);return new Ce(new c.N(t.lng-f,t.lat-d),new c.N(t.lng+f,t.lat+d))}adjustAntiMeridian(){const t=new c.N(this._sw.lng,this._sw.lat),a=new c.N(this._ne.lng,this._ne.lat);return new Ce(t,t.lng>a.lng?new c.N(a.lng+360,a.lat):a)}}class Fn{constructor(t,a,d){this.bounds=Ce.convert(this.validateBounds(t)),this.minzoom=a||0,this.maxzoom=d||24}validateBounds(t){return Array.isArray(t)&&t.length===4?[Math.max(-180,t[0]),Math.max(-90,t[1]),Math.min(180,t[2]),Math.min(90,t[3])]:[-180,-90,180,90]}contains(t){const a=Math.pow(2,t.z),d=Math.floor(c.O(this.bounds.getWest())*a),f=Math.floor(c.Q(this.bounds.getNorth())*a),_=Math.ceil(c.O(this.bounds.getEast())*a),E=Math.ceil(c.Q(this.bounds.getSouth())*a);return t.x>=d&&t.x<_&&t.y>=f&&t.y<E}}class bn extends c.E{constructor(t,a,d,f){if(super(),this.id=t,this.dispatcher=d,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,c.e(this,c.M(a,["url","scheme","tileSize","promoteId"])),this._options=c.e({type:"vector"},a),this._collectResourceTiming=a.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(f)}load(){return c._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new c.k("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const t=yield dn(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),t&&(c.e(this,t),t.bounds&&(this.tileBounds=new Fn(t.bounds,this.minzoom,this.maxzoom)),this.fire(new c.k("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new c.k("data",{dataType:"source",sourceDataType:"content"})))}catch(t){this._tileJSONRequest=null,this.fire(new c.j(t))}})}loaded(){return this._loaded}hasTile(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)}onAdd(t){this.map=t,this.load()}setSourceProperty(t){this._tileJSONRequest&&this._tileJSONRequest.abort(),t(),this.load()}setTiles(t){return this.setSourceProperty(()=>{this._options.tiles=t}),this}setUrl(t){return this.setSourceProperty(()=>{this.url=t,this._options.url=t}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}serialize(){return c.e({},this._options)}loadTile(t){return c._(this,void 0,void 0,function*(){const a=t.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),d={request:this.map._requestManager.transformRequest(a,"Tile"),uid:t.uid,tileID:t.tileID,zoom:t.tileID.overscaledZ,tileSize:this.tileSize*t.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};d.request.collectResourceTiming=this._collectResourceTiming;let f="RT";if(t.actor&&t.state!=="expired"){if(t.state==="loading")return new Promise((_,E)=>{t.reloadPromise={resolve:_,reject:E}})}else t.actor=this.dispatcher.getActor(),f="LT";t.abortController=new AbortController;try{const _=yield t.actor.sendAsync({type:f,data:d},t.abortController);if(delete t.abortController,t.aborted)return;this._afterTileLoadWorkerResponse(t,_)}catch(_){if(delete t.abortController,t.aborted)return;if(_&&_.status!==404)throw _;this._afterTileLoadWorkerResponse(t,null)}})}_afterTileLoadWorkerResponse(t,a){if(a&&a.resourceTiming&&(t.resourceTiming=a.resourceTiming),a&&this.map._refreshExpiredTiles&&t.setExpiryData(a),t.loadVectorData(a,this.map.painter),t.reloadPromise){const d=t.reloadPromise;t.reloadPromise=null,this.loadTile(t).then(d.resolve).catch(d.reject)}}abortTile(t){return c._(this,void 0,void 0,function*(){t.abortController&&(t.abortController.abort(),delete t.abortController),t.actor&&(yield t.actor.sendAsync({type:"AT",data:{uid:t.uid,type:this.type,source:this.id}}))})}unloadTile(t){return c._(this,void 0,void 0,function*(){t.unloadVectorData(),t.actor&&(yield t.actor.sendAsync({type:"RMT",data:{uid:t.uid,type:this.type,source:this.id}}))})}hasTransition(){return!1}}class Rt extends c.E{constructor(t,a,d,f){super(),this.id=t,this.dispatcher=d,this.setEventedParent(f),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=c.e({type:"raster"},a),c.e(this,c.M(a,["url","scheme","tileSize"]))}load(){return c._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new c.k("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const t=yield dn(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,t&&(c.e(this,t),t.bounds&&(this.tileBounds=new Fn(t.bounds,this.minzoom,this.maxzoom)),this.fire(new c.k("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new c.k("data",{dataType:"source",sourceDataType:"content"})))}catch(t){this._tileJSONRequest=null,this.fire(new c.j(t))}})}loaded(){return this._loaded}onAdd(t){this.map=t,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}setSourceProperty(t){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null),t(),this.load()}setTiles(t){return this.setSourceProperty(()=>{this._options.tiles=t}),this}setUrl(t){return this.setSourceProperty(()=>{this.url=t,this._options.url=t}),this}serialize(){return c.e({},this._options)}hasTile(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)}loadTile(t){return c._(this,void 0,void 0,function*(){const a=t.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);t.abortController=new AbortController;try{const d=yield he.getImage(this.map._requestManager.transformRequest(a,"Tile"),t.abortController,this.map._refreshExpiredTiles);if(delete t.abortController,t.aborted)return void(t.state="unloaded");if(d&&d.data){this.map._refreshExpiredTiles&&d.cacheControl&&d.expires&&t.setExpiryData({cacheControl:d.cacheControl,expires:d.expires});const f=this.map.painter.context,_=f.gl,E=d.data;t.texture=this.map.painter.getTileTexture(E.width),t.texture?t.texture.update(E,{useMipmap:!0}):(t.texture=new Ue(f,E,_.RGBA,{useMipmap:!0}),t.texture.bind(_.LINEAR,_.CLAMP_TO_EDGE,_.LINEAR_MIPMAP_NEAREST)),t.state="loaded"}}catch(d){if(delete t.abortController,t.aborted)t.state="unloaded";else if(d)throw t.state="errored",d}})}abortTile(t){return c._(this,void 0,void 0,function*(){t.abortController&&(t.abortController.abort(),delete t.abortController)})}unloadTile(t){return c._(this,void 0,void 0,function*(){t.texture&&this.map.painter.saveTileTexture(t.texture)})}hasTransition(){return!1}}class Yt extends Rt{constructor(t,a,d,f){super(t,a,d,f),this.type="raster-dem",this.maxzoom=22,this._options=c.e({type:"raster-dem"},a),this.encoding=a.encoding||"mapbox",this.redFactor=a.redFactor,this.greenFactor=a.greenFactor,this.blueFactor=a.blueFactor,this.baseShift=a.baseShift}loadTile(t){return c._(this,void 0,void 0,function*(){const a=t.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),d=this.map._requestManager.transformRequest(a,"Tile");t.neighboringTiles=this._getNeighboringTiles(t.tileID),t.abortController=new AbortController;try{const f=yield he.getImage(d,t.abortController,this.map._refreshExpiredTiles);if(delete t.abortController,t.aborted)return void(t.state="unloaded");if(f&&f.data){const _=f.data;this.map._refreshExpiredTiles&&f.cacheControl&&f.expires&&t.setExpiryData({cacheControl:f.cacheControl,expires:f.expires});const E=c.b(_)&&c.U()?_:yield this.readImageNow(_),I={type:this.type,uid:t.uid,source:this.id,rawImageData:E,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};if(!t.actor||t.state==="expired"){t.actor=this.dispatcher.getActor();const k=yield t.actor.sendAsync({type:"LDT",data:I});t.dem=k,t.needsHillshadePrepare=!0,t.needsTerrainPrepare=!0,t.state="loaded"}}}catch(f){if(delete t.abortController,t.aborted)t.state="unloaded";else if(f)throw t.state="errored",f}})}readImageNow(t){return c._(this,void 0,void 0,function*(){if(typeof VideoFrame<"u"&&c.V()){const a=t.width+2,d=t.height+2;try{return new c.R({width:a,height:d},yield c.W(t,-1,-1,a,d))}catch{}}return G.getImageData(t,1)})}_getNeighboringTiles(t){const a=t.canonical,d=Math.pow(2,a.z),f=(a.x-1+d)%d,_=a.x===0?t.wrap-1:t.wrap,E=(a.x+1+d)%d,I=a.x+1===d?t.wrap+1:t.wrap,k={};return k[new c.S(t.overscaledZ,_,a.z,f,a.y).key]={backfilled:!1},k[new c.S(t.overscaledZ,I,a.z,E,a.y).key]={backfilled:!1},a.y>0&&(k[new c.S(t.overscaledZ,_,a.z,f,a.y-1).key]={backfilled:!1},k[new c.S(t.overscaledZ,t.wrap,a.z,a.x,a.y-1).key]={backfilled:!1},k[new c.S(t.overscaledZ,I,a.z,E,a.y-1).key]={backfilled:!1}),a.y+1<d&&(k[new c.S(t.overscaledZ,_,a.z,f,a.y+1).key]={backfilled:!1},k[new c.S(t.overscaledZ,t.wrap,a.z,a.x,a.y+1).key]={backfilled:!1},k[new c.S(t.overscaledZ,I,a.z,E,a.y+1).key]={backfilled:!1}),k}unloadTile(t){return c._(this,void 0,void 0,function*(){t.demTexture&&this.map.painter.saveTileTexture(t.demTexture),t.fbo&&(t.fbo.destroy(),delete t.fbo),t.dem&&delete t.dem,delete t.neighboringTiles,t.state="unloaded",t.actor&&(yield t.actor.sendAsync({type:"RDT",data:{type:this.type,uid:t.uid,source:this.id}}))})}}class Tr extends c.E{constructor(t,a,d,f){super(),this.id=t,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=d.getActor(),this.setEventedParent(f),this._data=a.data,this._options=c.e({},a),this._collectResourceTiming=a.collectResourceTiming,a.maxzoom!==void 0&&(this.maxzoom=a.maxzoom),a.type&&(this.type=a.type),a.attribution&&(this.attribution=a.attribution),this.promoteId=a.promoteId;const _=c.X/this.tileSize;a.clusterMaxZoom!==void 0&&this.maxzoom<=a.clusterMaxZoom&&c.w(`The maxzoom value "${this.maxzoom}" is expected to be greater than the clusterMaxZoom value "${a.clusterMaxZoom}".`),this.workerOptions=c.e({source:this.id,cluster:a.cluster||!1,geojsonVtOptions:{buffer:(a.buffer!==void 0?a.buffer:128)*_,tolerance:(a.tolerance!==void 0?a.tolerance:.375)*_,extent:c.X,maxZoom:this.maxzoom,lineMetrics:a.lineMetrics||!1,generateId:a.generateId||!1},superclusterOptions:{maxZoom:a.clusterMaxZoom!==void 0?a.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,a.clusterMinPoints||2),extent:c.X,radius:(a.clusterRadius||50)*_,log:!1,generateId:a.generateId||!1},clusterProperties:a.clusterProperties,filter:a.filter},a.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}load(){return c._(this,void 0,void 0,function*(){yield this._updateWorkerData()})}onAdd(t){this.map=t,this.load()}setData(t){return this._data=t,this._updateWorkerData(),this}updateData(t){return this._updateWorkerData(t),this}getData(){return c._(this,void 0,void 0,function*(){const t=c.e({type:this.type},this.workerOptions);return this.actor.sendAsync({type:"GD",data:t})})}setClusterOptions(t){return this.workerOptions.cluster=t.cluster,t&&(t.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=t.clusterRadius),t.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=t.clusterMaxZoom)),this._updateWorkerData(),this}getClusterExpansionZoom(t){return this.actor.sendAsync({type:"GCEZ",data:{type:this.type,clusterId:t,source:this.id}})}getClusterChildren(t){return this.actor.sendAsync({type:"GCC",data:{type:this.type,clusterId:t,source:this.id}})}getClusterLeaves(t,a,d){return this.actor.sendAsync({type:"GCL",data:{type:this.type,source:this.id,clusterId:t,limit:a,offset:d}})}_updateWorkerData(t){return c._(this,void 0,void 0,function*(){const a=c.e({type:this.type},this.workerOptions);t?a.dataDiff=t:typeof this._data=="string"?(a.request=this.map._requestManager.transformRequest(G.resolveURL(this._data),"Source"),a.request.collectResourceTiming=this._collectResourceTiming):a.data=JSON.stringify(this._data),this._pendingLoads++,this.fire(new c.k("dataloading",{dataType:"source"}));try{const d=yield this.actor.sendAsync({type:"LD",data:a});if(this._pendingLoads--,this._removed||d.abandoned)return void this.fire(new c.k("dataabort",{dataType:"source"}));let f=null;d.resourceTiming&&d.resourceTiming[this.id]&&(f=d.resourceTiming[this.id].slice(0));const _={dataType:"source"};this._collectResourceTiming&&f&&f.length>0&&c.e(_,{resourceTiming:f}),this.fire(new c.k("data",Object.assign(Object.assign({},_),{sourceDataType:"metadata"}))),this.fire(new c.k("data",Object.assign(Object.assign({},_),{sourceDataType:"content"})))}catch(d){if(this._pendingLoads--,this._removed)return void this.fire(new c.k("dataabort",{dataType:"source"}));this.fire(new c.j(d))}})}loaded(){return this._pendingLoads===0}loadTile(t){return c._(this,void 0,void 0,function*(){const a=t.actor?"RT":"LT";t.actor=this.actor;const d={type:this.type,uid:t.uid,tileID:t.tileID,zoom:t.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};t.abortController=new AbortController;const f=yield this.actor.sendAsync({type:a,data:d},t.abortController);delete t.abortController,t.unloadVectorData(),t.aborted||t.loadVectorData(f,this.map.painter,a==="RT")})}abortTile(t){return c._(this,void 0,void 0,function*(){t.abortController&&(t.abortController.abort(),delete t.abortController),t.aborted=!0})}unloadTile(t){return c._(this,void 0,void 0,function*(){t.unloadVectorData(),yield this.actor.sendAsync({type:"RMT",data:{uid:t.uid,type:this.type,source:this.id}})})}onRemove(){this._removed=!0,this.actor.sendAsync({type:"RS",data:{type:this.type,source:this.id}})}serialize(){return c.e({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}}var yr=c.Y([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class Gr extends c.E{constructor(t,a,d,f){super(),this.id=t,this.dispatcher=d,this.coordinates=a.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(f),this.options=a}load(t){return c._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new c.k("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=new AbortController;try{const a=yield he.getImage(this.map._requestManager.transformRequest(this.url,"Image"),this._request);this._request=null,this._loaded=!0,a&&a.data&&(this.image=a.data,t&&(this.coordinates=t),this._finishLoading())}catch(a){this._request=null,this._loaded=!0,this.fire(new c.j(a))}})}loaded(){return this._loaded}updateImage(t){return t.url?(this._request&&(this._request.abort(),this._request=null),this.options.url=t.url,this.load(t.coordinates).finally(()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new c.k("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(t){this.map=t,this.load()}onRemove(){this._request&&(this._request.abort(),this._request=null)}setCoordinates(t){this.coordinates=t;const a=t.map(c.Z.fromLngLat);this.tileID=function(f){let _=1/0,E=1/0,I=-1/0,k=-1/0;for(const V of f)_=Math.min(_,V.x),E=Math.min(E,V.y),I=Math.max(I,V.x),k=Math.max(k,V.y);const z=Math.max(I-_,k-E),R=Math.max(0,Math.floor(-Math.log(z)/Math.LN2)),O=Math.pow(2,R);return new c.a1(R,Math.floor((_+I)/2*O),Math.floor((E+k)/2*O))}(a),this.minzoom=this.maxzoom=this.tileID.z;const d=a.map(f=>this.tileID.getTilePoint(f)._round());return this._boundsArray=new c.$,this._boundsArray.emplaceBack(d[0].x,d[0].y,0,0),this._boundsArray.emplaceBack(d[1].x,d[1].y,c.X,0),this._boundsArray.emplaceBack(d[3].x,d[3].y,0,c.X),this._boundsArray.emplaceBack(d[2].x,d[2].y,c.X,c.X),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new c.k("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const t=this.map.painter.context,a=t.gl;this.boundsBuffer||(this.boundsBuffer=t.createVertexBuffer(this._boundsArray,yr.members)),this.boundsSegments||(this.boundsSegments=c.a0.simpleSegment(0,0,4,2)),this.texture||(this.texture=new Ue(t,this.image,a.RGBA),this.texture.bind(a.LINEAR,a.CLAMP_TO_EDGE));let d=!1;for(const f in this.tiles){const _=this.tiles[f];_.state!=="loaded"&&(_.state="loaded",_.texture=this.texture,d=!0)}d&&this.fire(new c.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}loadTile(t){return c._(this,void 0,void 0,function*(){this.tileID&&this.tileID.equals(t.tileID.canonical)?(this.tiles[String(t.tileID.wrap)]=t,t.buckets={}):t.state="errored"})}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}class vr extends Gr{constructor(t,a,d,f){super(t,a,d,f),this.roundZoom=!0,this.type="video",this.options=a}load(){return c._(this,void 0,void 0,function*(){this._loaded=!1;const t=this.options;this.urls=[];for(const a of t.urls)this.urls.push(this.map._requestManager.transformRequest(a,"Source").url);try{const a=yield c.a3(this.urls);if(this._loaded=!0,!a)return;this.video=a,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading()}catch(a){this.fire(new c.j(a))}})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(t){if(this.video){const a=this.video.seekable;t<a.start(0)||t>a.end(0)?this.fire(new c.j(new c.a2(`sources.${this.id}`,null,`Playback for this video can be set only between the ${a.start(0)} and ${a.end(0)}-second mark.`))):this.video.currentTime=t}}getVideo(){return this.video}onAdd(t){this.map||(this.map=t,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const t=this.map.painter.context,a=t.gl;this.boundsBuffer||(this.boundsBuffer=t.createVertexBuffer(this._boundsArray,yr.members)),this.boundsSegments||(this.boundsSegments=c.a0.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(a.LINEAR,a.CLAMP_TO_EDGE),a.texSubImage2D(a.TEXTURE_2D,0,0,0,a.RGBA,a.UNSIGNED_BYTE,this.video)):(this.texture=new Ue(t,this.video,a.RGBA),this.texture.bind(a.LINEAR,a.CLAMP_TO_EDGE));let d=!1;for(const f in this.tiles){const _=this.tiles[f];_.state!=="loaded"&&(_.state="loaded",_.texture=this.texture,d=!0)}d&&this.fire(new c.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class rr extends Gr{constructor(t,a,d,f){super(t,a,d,f),a.coordinates?Array.isArray(a.coordinates)&&a.coordinates.length===4&&!a.coordinates.some(_=>!Array.isArray(_)||_.length!==2||_.some(E=>typeof E!="number"))||this.fire(new c.j(new c.a2(`sources.${t}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new c.j(new c.a2(`sources.${t}`,null,'missing required property "coordinates"'))),a.animate&&typeof a.animate!="boolean"&&this.fire(new c.j(new c.a2(`sources.${t}`,null,'optional "animate" property must be a boolean value'))),a.canvas?typeof a.canvas=="string"||a.canvas instanceof HTMLCanvasElement||this.fire(new c.j(new c.a2(`sources.${t}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new c.j(new c.a2(`sources.${t}`,null,'missing required property "canvas"'))),this.options=a,this.animate=a.animate===void 0||a.animate}load(){return c._(this,void 0,void 0,function*(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new c.j(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())})}getCanvas(){return this.canvas}onAdd(t){this.map=t,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let t=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,t=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,t=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const a=this.map.painter.context,d=a.gl;this.boundsBuffer||(this.boundsBuffer=a.createVertexBuffer(this._boundsArray,yr.members)),this.boundsSegments||(this.boundsSegments=c.a0.simpleSegment(0,0,4,2)),this.texture?(t||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new Ue(a,this.canvas,d.RGBA,{premultiply:!0});let f=!1;for(const _ in this.tiles){const E=this.tiles[_];E.state!=="loaded"&&(E.state="loaded",E.texture=this.texture,f=!0)}f&&this.fire(new c.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const t of[this.canvas.width,this.canvas.height])if(isNaN(t)||t<=0)return!0;return!1}}const dr={},fr=y=>{switch(y){case"geojson":return Tr;case"image":return Gr;case"raster":return Rt;case"raster-dem":return Yt;case"vector":return bn;case"video":return vr;case"canvas":return rr}return dr[y]},Ke="RTLPluginLoaded";class ci extends c.E{constructor(){super(...arguments),this.status="unavailable",this.url=null,this.dispatcher=Qt()}_syncState(t){return this.status=t,this.dispatcher.broadcast("SRPS",{pluginStatus:t,pluginURL:this.url}).catch(a=>{throw this.status="error",a})}getRTLTextPluginStatus(){return this.status}clearRTLTextPlugin(){this.status="unavailable",this.url=null}setRTLTextPlugin(t){return c._(this,arguments,void 0,function*(a,d=!1){if(this.url)throw new Error("setRTLTextPlugin cannot be called multiple times.");if(this.url=G.resolveURL(a),!this.url)throw new Error(`requested url ${a} is invalid`);if(this.status==="unavailable"){if(!d)return this._requestImport();this.status="deferred",this._syncState(this.status)}else if(this.status==="requested")return this._requestImport()})}_requestImport(){return c._(this,void 0,void 0,function*(){yield this._syncState("loading"),this.status="loaded",this.fire(new c.k(Ke))})}lazyLoad(){this.status==="unavailable"?this.status="requested":this.status==="deferred"&&this._requestImport()}}let Rr=null;function jr(){return Rr||(Rr=new ci),Rr}class Pr{constructor(t,a){this.timeAdded=0,this.fadeEndTime=0,this.tileID=t,this.uid=c.a4(),this.uses=0,this.tileSize=a,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(t){const a=t+this.timeAdded;a<this.fadeEndTime||(this.fadeEndTime=a)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(t){this.demTexture&&t.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(t,a,d){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",t){t.featureIndex&&(this.latestFeatureIndex=t.featureIndex,t.rawTileData?(this.latestRawTileData=t.rawTileData,this.latestFeatureIndex.rawTileData=t.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=t.collisionBoxArray,this.buckets=function(f,_){const E={};if(!_)return E;for(const I of f){const k=I.layerIds.map(z=>_.getLayer(z)).filter(Boolean);if(k.length!==0){I.layers=k,I.stateDependentLayerIds&&(I.stateDependentLayers=I.stateDependentLayerIds.map(z=>k.filter(R=>R.id===z)[0]));for(const z of k)E[z.id]=I}}return E}(t.buckets,a.style),this.hasSymbolBuckets=!1;for(const f in this.buckets){const _=this.buckets[f];if(_ instanceof c.a6){if(this.hasSymbolBuckets=!0,!d)break;_.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const f in this.buckets){const _=this.buckets[f];if(_ instanceof c.a6&&_.hasRTLText){this.hasRTLText=!0,jr().lazyLoad();break}}this.queryPadding=0;for(const f in this.buckets){const _=this.buckets[f];this.queryPadding=Math.max(this.queryPadding,a.style.getLayer(f).queryRadius(_))}t.imageAtlas&&(this.imageAtlas=t.imageAtlas),t.glyphAtlasImage&&(this.glyphAtlasImage=t.glyphAtlasImage)}else this.collisionBoxArray=new c.a5}unloadVectorData(){for(const t in this.buckets)this.buckets[t].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(t){return this.buckets[t.id]}upload(t){for(const d in this.buckets){const f=this.buckets[d];f.uploadPending()&&f.upload(t)}const a=t.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new Ue(t,this.imageAtlas.image,a.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new Ue(t,this.glyphAtlasImage,a.ALPHA),this.glyphAtlasImage=null)}prepare(t){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(t,this.imageAtlasTexture)}queryRenderedFeatures(t,a,d,f,_,E,I,k,z,R){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:f,cameraQueryGeometry:_,scale:E,tileSize:this.tileSize,pixelPosMatrix:R,transform:k,params:I,queryPadding:this.queryPadding*z},t,a,d):{}}querySourceFeatures(t,a){const d=this.latestFeatureIndex;if(!d||!d.rawTileData)return;const f=d.loadVTLayers(),_=a&&a.sourceLayer?a.sourceLayer:"",E=f._geojsonTileLayer||f[_];if(!E)return;const I=c.a7(a&&a.filter),{z:k,x:z,y:R}=this.tileID.canonical,O={z:k,x:z,y:R};for(let V=0;V<E.length;V++){const X=E.feature(V);if(I.needGeometry){const le=c.a8(X,!0);if(!I.filter(new c.z(this.tileID.overscaledZ),le,this.tileID.canonical))continue}else if(!I.filter(new c.z(this.tileID.overscaledZ),X))continue;const Q=d.getId(X,_),ie=new c.a9(X,k,z,R,Q);ie.tile=O,t.push(ie)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(t){const a=this.expirationTime;if(t.cacheControl){const d=c.aa(t.cacheControl);d["max-age"]&&(this.expirationTime=Date.now()+1e3*d["max-age"])}else t.expires&&(this.expirationTime=new Date(t.expires).getTime());if(this.expirationTime){const d=Date.now();let f=!1;if(this.expirationTime>d)f=!1;else if(a)if(this.expirationTime<a)f=!0;else{const _=this.expirationTime-a;_?this.expirationTime=d+Math.max(_,3e4):f=!0}else f=!0;f?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(t,a){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(t).length===0)return;const d=this.latestFeatureIndex.loadVTLayers();for(const f in this.buckets){if(!a.style.hasLayer(f))continue;const _=this.buckets[f],E=_.layers[0].sourceLayer||"_geojsonTileLayer",I=d[E],k=t[E];if(!I||!k||Object.keys(k).length===0)continue;_.update(k,I,this.imageAtlas&&this.imageAtlas.patternPositions||{});const z=a&&a.style&&a.style.getLayer(f);z&&(this.queryPadding=Math.max(this.queryPadding,z.queryRadius(_)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<G.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(t){this.symbolFadeHoldUntil=G.now()+t}setDependencies(t,a){const d={};for(const f of a)d[f]=!0;this.dependencies[t]=d}hasDependency(t,a){for(const d of t){const f=this.dependencies[d];if(f){for(const _ of a)if(f[_])return!0}}return!1}}class rt{constructor(t,a){this.max=t,this.onRemove=a,this.reset()}reset(){for(const t in this.data)for(const a of this.data[t])a.timeout&&clearTimeout(a.timeout),this.onRemove(a.value);return this.data={},this.order=[],this}add(t,a,d){const f=t.wrapped().key;this.data[f]===void 0&&(this.data[f]=[]);const _={value:a,timeout:void 0};if(d!==void 0&&(_.timeout=setTimeout(()=>{this.remove(t,_)},d)),this.data[f].push(_),this.order.push(f),this.order.length>this.max){const E=this._getAndRemoveByKey(this.order[0]);E&&this.onRemove(E)}return this}has(t){return t.wrapped().key in this.data}getAndRemove(t){return this.has(t)?this._getAndRemoveByKey(t.wrapped().key):null}_getAndRemoveByKey(t){const a=this.data[t].shift();return a.timeout&&clearTimeout(a.timeout),this.data[t].length===0&&delete this.data[t],this.order.splice(this.order.indexOf(t),1),a.value}getByKey(t){const a=this.data[t];return a?a[0].value:null}get(t){return this.has(t)?this.data[t.wrapped().key][0].value:null}remove(t,a){if(!this.has(t))return this;const d=t.wrapped().key,f=a===void 0?0:this.data[d].indexOf(a),_=this.data[d][f];return this.data[d].splice(f,1),_.timeout&&clearTimeout(_.timeout),this.data[d].length===0&&delete this.data[d],this.onRemove(_.value),this.order.splice(this.order.indexOf(d),1),this}setMaxSize(t){for(this.max=t;this.order.length>this.max;){const a=this._getAndRemoveByKey(this.order[0]);a&&this.onRemove(a)}return this}filter(t){const a=[];for(const d in this.data)for(const f of this.data[d])t(f.value)||a.push(f);for(const d of a)this.remove(d.value.tileID,d)}}class Ht{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(t,a,d){const f=String(a);if(this.stateChanges[t]=this.stateChanges[t]||{},this.stateChanges[t][f]=this.stateChanges[t][f]||{},c.e(this.stateChanges[t][f],d),this.deletedStates[t]===null){this.deletedStates[t]={};for(const _ in this.state[t])_!==f&&(this.deletedStates[t][_]=null)}else if(this.deletedStates[t]&&this.deletedStates[t][f]===null){this.deletedStates[t][f]={};for(const _ in this.state[t][f])d[_]||(this.deletedStates[t][f][_]=null)}else for(const _ in d)this.deletedStates[t]&&this.deletedStates[t][f]&&this.deletedStates[t][f][_]===null&&delete this.deletedStates[t][f][_]}removeFeatureState(t,a,d){if(this.deletedStates[t]===null)return;const f=String(a);if(this.deletedStates[t]=this.deletedStates[t]||{},d&&a!==void 0)this.deletedStates[t][f]!==null&&(this.deletedStates[t][f]=this.deletedStates[t][f]||{},this.deletedStates[t][f][d]=null);else if(a!==void 0)if(this.stateChanges[t]&&this.stateChanges[t][f])for(d in this.deletedStates[t][f]={},this.stateChanges[t][f])this.deletedStates[t][f][d]=null;else this.deletedStates[t][f]=null;else this.deletedStates[t]=null}getState(t,a){const d=String(a),f=c.e({},(this.state[t]||{})[d],(this.stateChanges[t]||{})[d]);if(this.deletedStates[t]===null)return{};if(this.deletedStates[t]){const _=this.deletedStates[t][a];if(_===null)return{};for(const E in _)delete f[E]}return f}initializeTileState(t,a){t.setFeatureState(this.state,a)}coalesceChanges(t,a){const d={};for(const f in this.stateChanges){this.state[f]=this.state[f]||{};const _={};for(const E in this.stateChanges[f])this.state[f][E]||(this.state[f][E]={}),c.e(this.state[f][E],this.stateChanges[f][E]),_[E]=this.state[f][E];d[f]=_}for(const f in this.deletedStates){this.state[f]=this.state[f]||{};const _={};if(this.deletedStates[f]===null)for(const E in this.state[f])_[E]={},this.state[f][E]={};else for(const E in this.deletedStates[f]){if(this.deletedStates[f][E]===null)this.state[f][E]={};else for(const I of Object.keys(this.deletedStates[f][E]))delete this.state[f][E][I];_[E]=this.state[f][E]}d[f]=d[f]||{},c.e(d[f],_)}if(this.stateChanges={},this.deletedStates={},Object.keys(d).length!==0)for(const f in t)t[f].setFeatureState(d,a)}}class Ut extends c.E{constructor(t,a,d){super(),this.id=t,this.dispatcher=d,this.on("data",f=>this._dataHandler(f)),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=((f,_,E,I)=>{const k=new(fr(_.type))(f,_,E,I);if(k.id!==f)throw new Error(`Expected Source id to be ${f} instead of ${k.id}`);return k})(t,a,d,this),this._tiles={},this._cache=new rt(0,f=>this._unloadTile(f)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new Ht,this._didEmitContent=!1,this._updated=!1}onAdd(t){this.map=t,this._maxTileCacheSize=t?t._maxTileCacheSize:null,this._maxTileCacheZoomLevels=t?t._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(t)}onRemove(t){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(t)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(this.used===void 0&&this.usedForTerrain===void 0||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const t in this._tiles){const a=this._tiles[t];if(a.state!=="loaded"&&a.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const t=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,t&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(t,a,d){return c._(this,void 0,void 0,function*(){try{yield this._source.loadTile(t),this._tileLoaded(t,a,d)}catch(f){t.state="errored",f.status!==404?this._source.fire(new c.j(f,{tile:t})):this.update(this.transform,this.terrain)}})}_unloadTile(t){this._source.unloadTile&&this._source.unloadTile(t)}_abortTile(t){this._source.abortTile&&this._source.abortTile(t),this._source.fire(new c.k("dataabort",{tile:t,coord:t.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(t){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const a in this._tiles){const d=this._tiles[a];d.upload(t),d.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(t=>t.tileID).sort(hi).map(t=>t.key)}getRenderableIds(t){const a=[];for(const d in this._tiles)this._isIdRenderable(d,t)&&a.push(this._tiles[d]);return t?a.sort((d,f)=>{const _=d.tileID,E=f.tileID,I=new c.P(_.canonical.x,_.canonical.y)._rotate(this.transform.angle),k=new c.P(E.canonical.x,E.canonical.y)._rotate(this.transform.angle);return _.overscaledZ-E.overscaledZ||k.y-I.y||k.x-I.x}).map(d=>d.tileID.key):a.map(d=>d.tileID).sort(hi).map(d=>d.key)}hasRenderableParent(t){const a=this.findLoadedParent(t,0);return!!a&&this._isIdRenderable(a.tileID.key)}_isIdRenderable(t,a){return this._tiles[t]&&this._tiles[t].hasData()&&!this._coveredTiles[t]&&(a||!this._tiles[t].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const t in this._tiles)this._tiles[t].state!=="errored"&&this._reloadTile(t,"reloading")}}_reloadTile(t,a){return c._(this,void 0,void 0,function*(){const d=this._tiles[t];d&&(d.state!=="loading"&&(d.state=a),yield this._loadTile(d,t,a))})}_tileLoaded(t,a,d){t.timeAdded=G.now(),d==="expired"&&(t.refreshedUponExpiration=!0),this._setTileReloadTimer(a,t),this.getSource().type==="raster-dem"&&t.dem&&this._backfillDEM(t),this._state.initializeTileState(t,this.map?this.map.painter:null),t.aborted||this._source.fire(new c.k("data",{dataType:"source",tile:t,coord:t.tileID}))}_backfillDEM(t){const a=this.getRenderableIds();for(let f=0;f<a.length;f++){const _=a[f];if(t.neighboringTiles&&t.neighboringTiles[_]){const E=this.getTileByID(_);d(t,E),d(E,t)}}function d(f,_){f.needsHillshadePrepare=!0,f.needsTerrainPrepare=!0;let E=_.tileID.canonical.x-f.tileID.canonical.x;const I=_.tileID.canonical.y-f.tileID.canonical.y,k=Math.pow(2,f.tileID.canonical.z),z=_.tileID.key;E===0&&I===0||Math.abs(I)>1||(Math.abs(E)>1&&(Math.abs(E+k)===1?E+=k:Math.abs(E-k)===1&&(E-=k)),_.dem&&f.dem&&(f.dem.backfillBorder(_.dem,E,I),f.neighboringTiles&&f.neighboringTiles[z]&&(f.neighboringTiles[z].backfilled=!0)))}}getTile(t){return this.getTileByID(t.key)}getTileByID(t){return this._tiles[t]}_retainLoadedChildren(t,a,d,f){for(const _ in this._tiles){let E=this._tiles[_];if(f[_]||!E.hasData()||E.tileID.overscaledZ<=a||E.tileID.overscaledZ>d)continue;let I=E.tileID;for(;E&&E.tileID.overscaledZ>a+1;){const z=E.tileID.scaledTo(E.tileID.overscaledZ-1);E=this._tiles[z.key],E&&E.hasData()&&(I=z)}let k=I;for(;k.overscaledZ>a;)if(k=k.scaledTo(k.overscaledZ-1),t[k.key]){f[I.key]=I;break}}}findLoadedParent(t,a){if(t.key in this._loadedParentTiles){const d=this._loadedParentTiles[t.key];return d&&d.tileID.overscaledZ>=a?d:null}for(let d=t.overscaledZ-1;d>=a;d--){const f=t.scaledTo(d),_=this._getLoadedTile(f);if(_)return _}}findLoadedSibling(t){return this._getLoadedTile(t)}_getLoadedTile(t){const a=this._tiles[t.key];return a&&a.hasData()?a:this._cache.getByKey(t.wrapped().key)}updateCacheSize(t){const a=Math.ceil(t.width/this._source.tileSize)+1,d=Math.ceil(t.height/this._source.tileSize)+1,f=Math.floor(a*d*(this._maxTileCacheZoomLevels===null?c.a.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),_=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,f):f;this._cache.setMaxSize(_)}handleWrapJump(t){const a=Math.round((t-(this._prevLng===void 0?t:this._prevLng))/360);if(this._prevLng=t,a){const d={};for(const f in this._tiles){const _=this._tiles[f];_.tileID=_.tileID.unwrapTo(_.tileID.wrap+a),d[_.tileID.key]=_}this._tiles=d;for(const f in this._timers)clearTimeout(this._timers[f]),delete this._timers[f];for(const f in this._tiles)this._setTileReloadTimer(f,this._tiles[f])}}_updateCoveredAndRetainedTiles(t,a,d,f,_,E){const I={},k={},z=Object.keys(t),R=G.now();for(const O of z){const V=t[O],X=this._tiles[O];if(!X||X.fadeEndTime!==0&&X.fadeEndTime<=R)continue;const Q=this.findLoadedParent(V,a),ie=this.findLoadedSibling(V),le=Q||ie||null;le&&(this._addTile(le.tileID),I[le.tileID.key]=le.tileID),k[O]=V}this._retainLoadedChildren(k,f,d,t);for(const O in I)t[O]||(this._coveredTiles[O]=!0,t[O]=I[O]);if(E){const O={},V={};for(const X of _)this._tiles[X.key].hasData()?O[X.key]=X:V[X.key]=X;for(const X in V){const Q=V[X].children(this._source.maxzoom);this._tiles[Q[0].key]&&this._tiles[Q[1].key]&&this._tiles[Q[2].key]&&this._tiles[Q[3].key]&&(O[Q[0].key]=t[Q[0].key]=Q[0],O[Q[1].key]=t[Q[1].key]=Q[1],O[Q[2].key]=t[Q[2].key]=Q[2],O[Q[3].key]=t[Q[3].key]=Q[3],delete V[X])}for(const X in V){const Q=V[X],ie=this.findLoadedParent(Q,this._source.minzoom),le=this.findLoadedSibling(Q),ce=ie||le||null;if(ce){O[ce.tileID.key]=t[ce.tileID.key]=ce.tileID;for(const me in O)O[me].isChildOf(ce.tileID)&&delete O[me]}}for(const X in this._tiles)O[X]||(this._coveredTiles[X]=!0)}}update(t,a){if(!this._sourceLoaded||this._paused)return;let d;this.transform=t,this.terrain=a,this.updateCacheSize(t),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?d=t.getVisibleUnwrappedCoordinates(this._source.tileID).map(R=>new c.S(R.canonical.z,R.wrap,R.canonical.z,R.canonical.x,R.canonical.y)):(d=t.coveringTiles({tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:a}),this._source.hasTile&&(d=d.filter(R=>this._source.hasTile(R)))):d=[];const f=t.coveringZoomLevel(this._source),_=Math.max(f-Ut.maxOverzooming,this._source.minzoom),E=Math.max(f+Ut.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){const R={};for(const O of d)if(O.canonical.z>this._source.minzoom){const V=O.scaledTo(O.canonical.z-1);R[V.key]=V;const X=O.scaledTo(Math.max(this._source.minzoom,Math.min(O.canonical.z,5)));R[X.key]=X}d=d.concat(Object.values(R))}const I=d.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,I&&this.fire(new c.k("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const k=this._updateRetainedTiles(d,f);qi(this._source.type)&&this._updateCoveredAndRetainedTiles(k,_,E,f,d,a);for(const R in k)this._tiles[R].clearFadeHold();const z=c.ab(this._tiles,k);for(const R of z){const O=this._tiles[R];O.hasSymbolBuckets&&!O.holdingForFade()?O.setHoldDuration(this.map._fadeDuration):O.hasSymbolBuckets&&!O.symbolFadeFinished()||this._removeTile(R)}this._updateLoadedParentTileCache(),this._updateLoadedSiblingTileCache()}releaseSymbolFadeTiles(){for(const t in this._tiles)this._tiles[t].holdingForFade()&&this._removeTile(t)}_updateRetainedTiles(t,a){var d;const f={},_={},E=Math.max(a-Ut.maxOverzooming,this._source.minzoom),I=Math.max(a+Ut.maxUnderzooming,this._source.minzoom),k={};for(const z of t){const R=this._addTile(z);f[z.key]=z,R.hasData()||a<this._source.maxzoom&&(k[z.key]=z)}this._retainLoadedChildren(k,a,I,f);for(const z of t){let R=this._tiles[z.key];if(R.hasData())continue;if(a+1>this._source.maxzoom){const V=z.children(this._source.maxzoom)[0],X=this.getTile(V);if(X&&X.hasData()){f[V.key]=V;continue}}else{const V=z.children(this._source.maxzoom);if(f[V[0].key]&&f[V[1].key]&&f[V[2].key]&&f[V[3].key])continue}let O=R.wasRequested();for(let V=z.overscaledZ-1;V>=E;--V){const X=z.scaledTo(V);if(_[X.key])break;if(_[X.key]=!0,R=this.getTile(X),!R&&O&&(R=this._addTile(X)),R){const Q=R.hasData();if((Q||!(!((d=this.map)===null||d===void 0)&&d.cancelPendingTileRequestsWhileZooming)||O)&&(f[X.key]=X),O=R.wasRequested(),Q)break}}}return f}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const t in this._tiles){const a=[];let d,f=this._tiles[t].tileID;for(;f.overscaledZ>0;){if(f.key in this._loadedParentTiles){d=this._loadedParentTiles[f.key];break}a.push(f.key);const _=f.scaledTo(f.overscaledZ-1);if(d=this._getLoadedTile(_),d)break;f=_}for(const _ of a)this._loadedParentTiles[_]=d}}_updateLoadedSiblingTileCache(){this._loadedSiblingTiles={};for(const t in this._tiles){const a=this._tiles[t].tileID,d=this._getLoadedTile(a);this._loadedSiblingTiles[a.key]=d}}_addTile(t){let a=this._tiles[t.key];if(a)return a;a=this._cache.getAndRemove(t),a&&(this._setTileReloadTimer(t.key,a),a.tileID=t,this._state.initializeTileState(a,this.map?this.map.painter:null),this._cacheTimers[t.key]&&(clearTimeout(this._cacheTimers[t.key]),delete this._cacheTimers[t.key],this._setTileReloadTimer(t.key,a)));const d=a;return a||(a=new Pr(t,this._source.tileSize*t.overscaleFactor()),this._loadTile(a,t.key,a.state)),a.uses++,this._tiles[t.key]=a,d||this._source.fire(new c.k("dataloading",{tile:a,coord:a.tileID,dataType:"source"})),a}_setTileReloadTimer(t,a){t in this._timers&&(clearTimeout(this._timers[t]),delete this._timers[t]);const d=a.getExpiryTimeout();d&&(this._timers[t]=setTimeout(()=>{this._reloadTile(t,"expired"),delete this._timers[t]},d))}_removeTile(t){const a=this._tiles[t];a&&(a.uses--,delete this._tiles[t],this._timers[t]&&(clearTimeout(this._timers[t]),delete this._timers[t]),a.uses>0||(a.hasData()&&a.state!=="reloading"?this._cache.add(a.tileID,a,a.getExpiryTimeout()):(a.aborted=!0,this._abortTile(a),this._unloadTile(a))))}_dataHandler(t){const a=t.sourceDataType;t.dataType==="source"&&a==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&t.dataType==="source"&&a==="content"&&(this.reload(),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0)}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const t in this._tiles)this._removeTile(t);this._cache.reset()}tilesIn(t,a,d){const f=[],_=this.transform;if(!_)return f;const E=d?_.getCameraQueryGeometry(t):t,I=t.map(Q=>_.pointCoordinate(Q,this.terrain)),k=E.map(Q=>_.pointCoordinate(Q,this.terrain)),z=this.getIds();let R=1/0,O=1/0,V=-1/0,X=-1/0;for(const Q of k)R=Math.min(R,Q.x),O=Math.min(O,Q.y),V=Math.max(V,Q.x),X=Math.max(X,Q.y);for(let Q=0;Q<z.length;Q++){const ie=this._tiles[z[Q]];if(ie.holdingForFade())continue;const le=ie.tileID,ce=Math.pow(2,_.zoom-ie.tileID.overscaledZ),me=a*ie.queryPadding*c.X/ie.tileSize/ce,te=[le.getTilePoint(new c.Z(R,O)),le.getTilePoint(new c.Z(V,X))];if(te[0].x-me<c.X&&te[0].y-me<c.X&&te[1].x+me>=0&&te[1].y+me>=0){const xe=I.map(ze=>le.getTilePoint(ze)),be=k.map(ze=>le.getTilePoint(ze));f.push({tile:ie,tileID:le,queryGeometry:xe,cameraQueryGeometry:be,scale:ce})}}return f}getVisibleCoordinates(t){const a=this.getRenderableIds(t).map(d=>this._tiles[d].tileID);for(const d of a)d.posMatrix=this.transform.calculatePosMatrix(d.toUnwrapped());return a}hasTransition(){if(this._source.hasTransition())return!0;if(qi(this._source.type)){const t=G.now();for(const a in this._tiles)if(this._tiles[a].fadeEndTime>=t)return!0}return!1}setFeatureState(t,a,d){this._state.updateState(t=t||"_geojsonTileLayer",a,d)}removeFeatureState(t,a,d){this._state.removeFeatureState(t=t||"_geojsonTileLayer",a,d)}getFeatureState(t,a){return this._state.getState(t=t||"_geojsonTileLayer",a)}setDependencies(t,a,d){const f=this._tiles[t];f&&f.setDependencies(a,d)}reloadTilesForDependencies(t,a){for(const d in this._tiles)this._tiles[d].hasDependency(t,a)&&this._reloadTile(d,"reloading");this._cache.filter(d=>!d.hasDependency(t,a))}}function hi(y,t){const a=Math.abs(2*y.wrap)-+(y.wrap<0),d=Math.abs(2*t.wrap)-+(t.wrap<0);return y.overscaledZ-t.overscaledZ||d-a||t.canonical.y-y.canonical.y||t.canonical.x-y.canonical.x}function qi(y){return y==="raster"||y==="image"||y==="video"}Ut.maxOverzooming=10,Ut.maxUnderzooming=3;class Xt{constructor(t,a){this.reset(t,a)}reset(t,a){this.points=t||[],this._distances=[0];for(let d=1;d<this.points.length;d++)this._distances[d]=this._distances[d-1]+this.points[d].dist(this.points[d-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(a||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(t){if(this.points.length===1)return this.points[0];t=c.ac(t,0,1);let a=1,d=this._distances[a];const f=t*this.paddedLength+this.padding;for(;d<f&&a<this._distances.length;)d=this._distances[++a];const _=a-1,E=this._distances[_],I=d-E,k=I>0?(f-E)/I:0;return this.points[_].mult(1-k).add(this.points[a].mult(k))}}function Ks(y,t){let a=!0;return y==="always"||y!=="never"&&t!=="never"||(a=!1),a}class uo{constructor(t,a,d){const f=this.boxCells=[],_=this.circleCells=[];this.xCellCount=Math.ceil(t/d),this.yCellCount=Math.ceil(a/d);for(let E=0;E<this.xCellCount*this.yCellCount;E++)f.push([]),_.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=t,this.height=a,this.xScale=this.xCellCount/t,this.yScale=this.yCellCount/a,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(t,a,d,f,_){this._forEachCell(a,d,f,_,this._insertBoxCell,this.boxUid++),this.boxKeys.push(t),this.bboxes.push(a),this.bboxes.push(d),this.bboxes.push(f),this.bboxes.push(_)}insertCircle(t,a,d,f){this._forEachCell(a-f,d-f,a+f,d+f,this._insertCircleCell,this.circleUid++),this.circleKeys.push(t),this.circles.push(a),this.circles.push(d),this.circles.push(f)}_insertBoxCell(t,a,d,f,_,E){this.boxCells[_].push(E)}_insertCircleCell(t,a,d,f,_,E){this.circleCells[_].push(E)}_query(t,a,d,f,_,E,I){if(d<0||t>this.width||f<0||a>this.height)return[];const k=[];if(t<=0&&a<=0&&this.width<=d&&this.height<=f){if(_)return[{key:null,x1:t,y1:a,x2:d,y2:f}];for(let z=0;z<this.boxKeys.length;z++)k.push({key:this.boxKeys[z],x1:this.bboxes[4*z],y1:this.bboxes[4*z+1],x2:this.bboxes[4*z+2],y2:this.bboxes[4*z+3]});for(let z=0;z<this.circleKeys.length;z++){const R=this.circles[3*z],O=this.circles[3*z+1],V=this.circles[3*z+2];k.push({key:this.circleKeys[z],x1:R-V,y1:O-V,x2:R+V,y2:O+V})}}else this._forEachCell(t,a,d,f,this._queryCell,k,{hitTest:_,overlapMode:E,seenUids:{box:{},circle:{}}},I);return k}query(t,a,d,f){return this._query(t,a,d,f,!1,null)}hitTest(t,a,d,f,_,E){return this._query(t,a,d,f,!0,_,E).length>0}hitTestCircle(t,a,d,f,_){const E=t-d,I=t+d,k=a-d,z=a+d;if(I<0||E>this.width||z<0||k>this.height)return!1;const R=[];return this._forEachCell(E,k,I,z,this._queryCellCircle,R,{hitTest:!0,overlapMode:f,circle:{x:t,y:a,radius:d},seenUids:{box:{},circle:{}}},_),R.length>0}_queryCell(t,a,d,f,_,E,I,k){const{seenUids:z,hitTest:R,overlapMode:O}=I,V=this.boxCells[_];if(V!==null){const Q=this.bboxes;for(const ie of V)if(!z.box[ie]){z.box[ie]=!0;const le=4*ie,ce=this.boxKeys[ie];if(t<=Q[le+2]&&a<=Q[le+3]&&d>=Q[le+0]&&f>=Q[le+1]&&(!k||k(ce))&&(!R||!Ks(O,ce.overlapMode))&&(E.push({key:ce,x1:Q[le],y1:Q[le+1],x2:Q[le+2],y2:Q[le+3]}),R))return!0}}const X=this.circleCells[_];if(X!==null){const Q=this.circles;for(const ie of X)if(!z.circle[ie]){z.circle[ie]=!0;const le=3*ie,ce=this.circleKeys[ie];if(this._circleAndRectCollide(Q[le],Q[le+1],Q[le+2],t,a,d,f)&&(!k||k(ce))&&(!R||!Ks(O,ce.overlapMode))){const me=Q[le],te=Q[le+1],xe=Q[le+2];if(E.push({key:ce,x1:me-xe,y1:te-xe,x2:me+xe,y2:te+xe}),R)return!0}}}return!1}_queryCellCircle(t,a,d,f,_,E,I,k){const{circle:z,seenUids:R,overlapMode:O}=I,V=this.boxCells[_];if(V!==null){const Q=this.bboxes;for(const ie of V)if(!R.box[ie]){R.box[ie]=!0;const le=4*ie,ce=this.boxKeys[ie];if(this._circleAndRectCollide(z.x,z.y,z.radius,Q[le+0],Q[le+1],Q[le+2],Q[le+3])&&(!k||k(ce))&&!Ks(O,ce.overlapMode))return E.push(!0),!0}}const X=this.circleCells[_];if(X!==null){const Q=this.circles;for(const ie of X)if(!R.circle[ie]){R.circle[ie]=!0;const le=3*ie,ce=this.circleKeys[ie];if(this._circlesCollide(Q[le],Q[le+1],Q[le+2],z.x,z.y,z.radius)&&(!k||k(ce))&&!Ks(O,ce.overlapMode))return E.push(!0),!0}}}_forEachCell(t,a,d,f,_,E,I,k){const z=this._convertToXCellCoord(t),R=this._convertToYCellCoord(a),O=this._convertToXCellCoord(d),V=this._convertToYCellCoord(f);for(let X=z;X<=O;X++)for(let Q=R;Q<=V;Q++)if(_.call(this,t,a,d,f,this.xCellCount*Q+X,E,I,k))return}_convertToXCellCoord(t){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(t*this.xScale)))}_convertToYCellCoord(t){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(t*this.yScale)))}_circlesCollide(t,a,d,f,_,E){const I=f-t,k=_-a,z=d+E;return z*z>I*I+k*k}_circleAndRectCollide(t,a,d,f,_,E,I){const k=(E-f)/2,z=Math.abs(t-(f+k));if(z>k+d)return!1;const R=(I-_)/2,O=Math.abs(a-(_+R));if(O>R+d)return!1;if(z<=k||O<=R)return!0;const V=z-k,X=O-R;return V*V+X*X<=d*d}}function co(y,t,a,d,f){const _=c.H();return t?(c.K(_,_,[1/f,1/f,1]),a||c.ad(_,_,d.angle)):c.L(_,d.labelPlaneMatrix,y),_}function Ds(y,t,a,d,f){if(t){const _=c.ae(y);return c.K(_,_,[f,f,1]),a||c.ad(_,_,-d.angle),_}return d.glCoordMatrix}function ae(y,t,a,d){let f;d?(f=[y,t,d(y,t),1],c.af(f,f,a)):(f=[y,t,0,1],In(f,f,a));const _=f[3];return{point:new c.P(f[0]/_,f[1]/_),signedDistanceFromCamera:_,isOccluded:!1}}function N(y,t){return .5+y/t*.5}function B(y,t){return y.x>=-t[0]&&y.x<=t[0]&&y.y>=-t[1]&&y.y<=t[1]}function K(y,t,a,d,f,_,E,I,k,z,R,O,V,X,Q){const ie=d?y.textSizeData:y.iconSizeData,le=c.ag(ie,a.transform.zoom),ce=[256/a.width*2+1,256/a.height*2+1],me=d?y.text.dynamicLayoutVertexArray:y.icon.dynamicLayoutVertexArray;me.clear();const te=y.lineVertexArray,xe=d?y.text.placedSymbolArray:y.icon.placedSymbolArray,be=a.transform.width/a.transform.height;let ze=!1;for(let qe=0;qe<xe.length;qe++){const Qe=xe.get(qe);if(Qe.hidden||Qe.writingMode===c.ah.vertical&&!ze){Lt(Qe.numGlyphs,me);continue}ze=!1;const at=ae(Qe.anchorX,Qe.anchorY,t,Q);if(!B(at.point,ce)){Lt(Qe.numGlyphs,me);continue}const pt=N(a.transform.cameraToCenterDistance,at.signedDistanceFromCamera),st=c.ai(ie,le,Qe),ot=E?st/pt:st*pt,wt={getElevation:Q,labelPlaneMatrix:f,lineVertexArray:te,pitchWithMap:E,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},projection:z,tileAnchorPoint:new c.P(Qe.anchorX,Qe.anchorY),unwrappedTileID:R,width:O,height:V,translation:X},Wt=Se(wt,Qe,ot,!1,I,t,_,y.glyphOffsetArray,me,be,k);ze=Wt.useVertical,(Wt.notEnoughRoom||ze||Wt.needsFlipping&&Se(wt,Qe,ot,!0,I,t,_,y.glyphOffsetArray,me,be,k).notEnoughRoom)&&Lt(Qe.numGlyphs,me)}d?y.text.dynamicLayoutVertexBuffer.updateData(me):y.icon.dynamicLayoutVertexBuffer.updateData(me)}function re(y,t,a,d,f,_,E,I){const k=_.glyphStartIndex+_.numGlyphs,z=_.lineStartIndex,R=_.lineStartIndex+_.lineLength,O=t.getoffsetX(_.glyphStartIndex),V=t.getoffsetX(k-1),X=it(y*O,a,d,f,_.segment,z,R,I,E);if(!X)return null;const Q=it(y*V,a,d,f,_.segment,z,R,I,E);return Q?I.projectionCache.anyProjectionOccluded?null:{first:X,last:Q}:null}function ye(y,t,a,d){return y===c.ah.horizontal&&Math.abs(a.y-t.y)>Math.abs(a.x-t.x)*d?{useVertical:!0}:(y===c.ah.vertical?t.y<a.y:t.x>a.x)?{needsFlipping:!0}:null}function Se(y,t,a,d,f,_,E,I,k,z,R){const O=a/24,V=t.lineOffsetX*O,X=t.lineOffsetY*O;let Q;if(t.numGlyphs>1){const ie=t.glyphStartIndex+t.numGlyphs,le=t.lineStartIndex,ce=t.lineStartIndex+t.lineLength,me=re(O,I,V,X,d,t,R,y);if(!me)return{notEnoughRoom:!0};const te=ae(me.first.point.x,me.first.point.y,E,y.getElevation).point,xe=ae(me.last.point.x,me.last.point.y,E,y.getElevation).point;if(f&&!d){const be=ye(t.writingMode,te,xe,z);if(be)return be}Q=[me.first];for(let be=t.glyphStartIndex+1;be<ie-1;be++)Q.push(it(O*I.getoffsetX(be),V,X,d,t.segment,le,ce,y,R));Q.push(me.last)}else{if(f&&!d){const le=ae(y.tileAnchorPoint.x,y.tileAnchorPoint.y,_,y.getElevation).point,ce=t.lineStartIndex+t.segment+1,me=new c.P(y.lineVertexArray.getx(ce),y.lineVertexArray.gety(ce)),te=ae(me.x,me.y,_,y.getElevation),xe=te.signedDistanceFromCamera>0?te.point:function(ze,qe,Qe,at,pt,st){return ke(ze,qe,Qe,1,pt,st)}(y.tileAnchorPoint,me,le,0,_,y),be=ye(t.writingMode,le,xe,z);if(be)return be}const ie=it(O*I.getoffsetX(t.glyphStartIndex),V,X,d,t.segment,t.lineStartIndex,t.lineStartIndex+t.lineLength,y,R);if(!ie||y.projectionCache.anyProjectionOccluded)return{notEnoughRoom:!0};Q=[ie]}for(const ie of Q)c.aj(k,ie.point,ie.angle);return{}}function ke(y,t,a,d,f,_){const E=y.add(y.sub(t)._unit()),I=f!==void 0?ae(E.x,E.y,f,_.getElevation).point:Be(E.x,E.y,_).point,k=a.sub(I);return a.add(k._mult(d/k.mag()))}function pe(y,t,a){const d=t.projectionCache;if(d.projections[y])return d.projections[y];const f=new c.P(t.lineVertexArray.getx(y),t.lineVertexArray.gety(y)),_=Be(f.x,f.y,t);if(_.signedDistanceFromCamera>0)return d.projections[y]=_.point,d.anyProjectionOccluded=d.anyProjectionOccluded||_.isOccluded,_.point;const E=y-a.direction;return function(I,k,z,R,O){return ke(I,k,z,R,void 0,O)}(a.distanceFromAnchor===0?t.tileAnchorPoint:new c.P(t.lineVertexArray.getx(E),t.lineVertexArray.gety(E)),f,a.previousVertex,a.absOffsetX-a.distanceFromAnchor+1,t)}function Be(y,t,a){const d=y+a.translation[0],f=t+a.translation[1];let _;return!a.pitchWithMap&&a.projection.useSpecialProjectionForSymbols?(_=a.projection.projectTileCoordinates(d,f,a.unwrappedTileID,a.getElevation),_.point.x=(.5*_.point.x+.5)*a.width,_.point.y=(.5*-_.point.y+.5)*a.height):(_=ae(d,f,a.labelPlaneMatrix,a.getElevation),_.isOccluded=!1),_}function We(y,t,a){return y._unit()._perp()._mult(t*a)}function Le(y,t,a,d,f,_,E,I,k){if(I.projectionCache.offsets[y])return I.projectionCache.offsets[y];const z=a.add(t);if(y+k.direction<d||y+k.direction>=f)return I.projectionCache.offsets[y]=z,z;const R=pe(y+k.direction,I,k),O=We(R.sub(a),E,k.direction),V=a.add(O),X=R.add(O);return I.projectionCache.offsets[y]=c.ak(_,z,V,X)||z,I.projectionCache.offsets[y]}function it(y,t,a,d,f,_,E,I,k){const z=d?y-t:y+t;let R=z>0?1:-1,O=0;d&&(R*=-1,O=Math.PI),R<0&&(O+=Math.PI);let V,X=R>0?_+f:_+f+1;I.projectionCache.cachedAnchorPoint?V=I.projectionCache.cachedAnchorPoint:(V=Be(I.tileAnchorPoint.x,I.tileAnchorPoint.y,I).point,I.projectionCache.cachedAnchorPoint=V);let Q,ie,le=V,ce=V,me=0,te=0;const xe=Math.abs(z),be=[];let ze;for(;me+te<=xe;){if(X+=R,X<_||X>=E)return null;me+=te,ce=le,ie=Q;const at={absOffsetX:xe,direction:R,distanceFromAnchor:me,previousVertex:ce};if(le=pe(X,I,at),a===0)be.push(ce),ze=le.sub(ce);else{let pt;const st=le.sub(ce);pt=st.mag()===0?We(pe(X+R,I,at).sub(le),a,R):We(st,a,R),ie||(ie=ce.add(pt)),Q=Le(X,pt,le,_,E,ie,a,I,at),be.push(ie),ze=Q.sub(ie)}te=ze.mag()}const qe=ze._mult((xe-me)/te)._add(ie||ce),Qe=O+Math.atan2(le.y-ce.y,le.x-ce.x);return be.push(qe),{point:qe,angle:k?Qe:0,path:be}}const Mt=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function Lt(y,t){for(let a=0;a<y;a++){const d=t.length;t.resize(d+4),t.float32.set(Mt,3*d)}}function In(y,t,a){const d=t[0],f=t[1];return y[0]=a[0]*d+a[4]*f+a[12],y[1]=a[1]*d+a[5]*f+a[13],y[3]=a[3]*d+a[7]*f+a[15],y}const Jt=100;class kn{constructor(t,a,d=new uo(t.width+200,t.height+200,25),f=new uo(t.width+200,t.height+200,25)){this.transform=t,this.mapProjection=a,this.grid=d,this.ignoredGrid=f,this.pitchFactor=Math.cos(t._pitch)*t.cameraToCenterDistance,this.screenRightBoundary=t.width+Jt,this.screenBottomBoundary=t.height+Jt,this.gridRightBoundary=t.width+200,this.gridBottomBoundary=t.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(t,a,d,f,_,E,I,k,z,R,O){const V=t.anchorPointX+k[0],X=t.anchorPointY+k[1],Q=this.projectAndGetPerspectiveRatio(f,V,X,_,R),ie=d*Q.perspectiveRatio;let le;if(E||I)le=this._projectCollisionBox(t,ie,f,_,E,I,k,Q,R,O);else{const be=Q.point.x+(O?O.x*ie:0),ze=Q.point.y+(O?O.y*ie:0);le={allPointsOccluded:!1,box:[be+t.x1*ie,ze+t.y1*ie,be+t.x2*ie,ze+t.y2*ie]}}const[ce,me,te,xe]=le.box;return this.mapProjection.useSpecialProjectionForSymbols&&(E?le.allPointsOccluded:this.mapProjection.isOccluded(V,X,_))||Q.perspectiveRatio<this.perspectiveRatioCutoff||!this.isInsideGrid(ce,me,te,xe)||a!=="always"&&this.grid.hitTest(ce,me,te,xe,a,z)?{box:[ce,me,te,xe],placeable:!1,offscreen:!1}:{box:[ce,me,te,xe],placeable:!0,offscreen:this.isOffscreen(ce,me,te,xe)}}placeCollisionCircles(t,a,d,f,_,E,I,k,z,R,O,V,X,Q,ie,le){const ce=[],me=new c.P(a.anchorX,a.anchorY),te=this.getPerspectiveRatio(E,me.x,me.y,I,le),xe=(O?_/te:_*te)/c.ap,be={getElevation:le,labelPlaneMatrix:k,lineVertexArray:d,pitchWithMap:O,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},projection:this.mapProjection,tileAnchorPoint:me,unwrappedTileID:I,width:this.transform.width,height:this.transform.height,translation:ie},ze=re(xe,f,a.lineOffsetX*xe,a.lineOffsetY*xe,!1,a,!1,be);let qe=!1,Qe=!1,at=!0;if(ze){const pt=.5*X*te+Q,st=new c.P(-100,-100),ot=new c.P(this.screenRightBoundary,this.screenBottomBoundary),wt=new Xt,Wt=ze.first,ht=ze.last;let tt=[];for(let $t=Wt.path.length-1;$t>=1;$t--)tt.push(Wt.path[$t]);for(let $t=1;$t<ht.path.length;$t++)tt.push(ht.path[$t]);const jt=2.5*pt;if(z){const $t=this.projectPathToScreenSpace(tt,be,z);tt=$t.some(un=>un.signedDistanceFromCamera<=0)?[]:$t.map(un=>un.point)}let sr=[];if(tt.length>0){const $t=tt[0].clone(),un=tt[0].clone();for(let Xn=1;Xn<tt.length;Xn++)$t.x=Math.min($t.x,tt[Xn].x),$t.y=Math.min($t.y,tt[Xn].y),un.x=Math.max(un.x,tt[Xn].x),un.y=Math.max(un.y,tt[Xn].y);sr=$t.x>=st.x&&un.x<=ot.x&&$t.y>=st.y&&un.y<=ot.y?[tt]:un.x<st.x||$t.x>ot.x||un.y<st.y||$t.y>ot.y?[]:c.al([tt],st.x,st.y,ot.x,ot.y)}for(const $t of sr){wt.reset($t,.25*pt);let un=0;un=wt.length<=.5*pt?1:Math.ceil(wt.paddedLength/jt)+1;for(let Xn=0;Xn<un;Xn++){const Cr=Xn/Math.max(un-1,1),ps=wt.lerp(Cr),hn=ps.x+Jt,fi=ps.y+Jt;ce.push(hn,fi,pt,0);const Ci=hn-pt,pi=fi-pt,Ii=hn+pt,ms=fi+pt;if(at=at&&this.isOffscreen(Ci,pi,Ii,ms),Qe=Qe||this.isInsideGrid(Ci,pi,Ii,ms),t!=="always"&&this.grid.hitTestCircle(hn,fi,pt,t,V)&&(qe=!0,!R))return{circles:[],offscreen:!1,collisionDetected:qe}}}}return{circles:!R&&qe||!Qe||te<this.perspectiveRatioCutoff?[]:ce,offscreen:at,collisionDetected:qe}}projectPathToScreenSpace(t,a,d){return t.map(f=>ae(f.x,f.y,d,a.getElevation))}queryRenderedSymbols(t){if(t.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const a=[];let d=1/0,f=1/0,_=-1/0,E=-1/0;for(const R of t){const O=new c.P(R.x+Jt,R.y+Jt);d=Math.min(d,O.x),f=Math.min(f,O.y),_=Math.max(_,O.x),E=Math.max(E,O.y),a.push(O)}const I=this.grid.query(d,f,_,E).concat(this.ignoredGrid.query(d,f,_,E)),k={},z={};for(const R of I){const O=R.key;if(k[O.bucketInstanceId]===void 0&&(k[O.bucketInstanceId]={}),k[O.bucketInstanceId][O.featureIndex])continue;const V=[new c.P(R.x1,R.y1),new c.P(R.x2,R.y1),new c.P(R.x2,R.y2),new c.P(R.x1,R.y2)];c.am(a,V)&&(k[O.bucketInstanceId][O.featureIndex]=!0,z[O.bucketInstanceId]===void 0&&(z[O.bucketInstanceId]=[]),z[O.bucketInstanceId].push(O.featureIndex))}return z}insertCollisionBox(t,a,d,f,_,E){(d?this.ignoredGrid:this.grid).insert({bucketInstanceId:f,featureIndex:_,collisionGroupID:E,overlapMode:a},t[0],t[1],t[2],t[3])}insertCollisionCircles(t,a,d,f,_,E){const I=d?this.ignoredGrid:this.grid,k={bucketInstanceId:f,featureIndex:_,collisionGroupID:E,overlapMode:a};for(let z=0;z<t.length;z+=4)I.insertCircle(k,t[z],t[z+1],t[z+2])}projectAndGetPerspectiveRatio(t,a,d,f,_){let E;_?(E=[a,d,_(a,d),1],c.af(E,E,t)):(E=[a,d,0,1],In(E,E,t));const I=E[3];return{point:new c.P((E[0]/I+1)/2*this.transform.width+Jt,(-E[1]/I+1)/2*this.transform.height+Jt),perspectiveRatio:.5+this.transform.cameraToCenterDistance/I*.5,isOccluded:!1,signedDistanceFromCamera:I}}getPerspectiveRatio(t,a,d,f,_){const E=this.mapProjection.useSpecialProjectionForSymbols?this.mapProjection.projectTileCoordinates(a,d,f,_):ae(a,d,t,_);return .5+this.transform.cameraToCenterDistance/E.signedDistanceFromCamera*.5}isOffscreen(t,a,d,f){return d<Jt||t>=this.screenRightBoundary||f<Jt||a>this.screenBottomBoundary}isInsideGrid(t,a,d,f){return d>=0&&t<this.gridRightBoundary&&f>=0&&a<this.gridBottomBoundary}getViewportMatrix(){const t=c.an([]);return c.J(t,t,[-100,-100,0]),t}_projectCollisionBox(t,a,d,f,_,E,I,k,z,R){let O=new c.P(1,0),V=new c.P(0,1);const X=new c.P(t.anchorPointX+I[0],t.anchorPointY+I[1]);if(E&&!_){const at=this.projectAndGetPerspectiveRatio(d,X.x+1,X.y,f,z).point.sub(k.point).unit(),pt=Math.atan(at.y/at.x)+(at.x<0?Math.PI:0),st=Math.sin(pt),ot=Math.cos(pt);O=new c.P(ot,st),V=new c.P(-st,ot)}else if(!E&&_){const at=-this.transform.angle,pt=Math.sin(at),st=Math.cos(at);O=new c.P(st,pt),V=new c.P(-pt,st)}let Q=k.point,ie=a;if(_){Q=X;const at=this.transform.zoom-Math.floor(this.transform.zoom);ie=Math.pow(2,-at),ie*=this.mapProjection.getPitchedTextCorrection(this.transform,X,f),R||(ie*=c.ac(.5+k.signedDistanceFromCamera/this.transform.cameraToCenterDistance*.5,0,4))}R&&(Q=Q.add(O.mult(R.x*ie)).add(V.mult(R.y*ie)));const le=t.x1*ie,ce=t.x2*ie,me=(le+ce)/2,te=t.y1*ie,xe=t.y2*ie,be=(te+xe)/2,ze=[{offsetX:le,offsetY:te},{offsetX:me,offsetY:te},{offsetX:ce,offsetY:te},{offsetX:ce,offsetY:be},{offsetX:ce,offsetY:xe},{offsetX:me,offsetY:xe},{offsetX:le,offsetY:xe},{offsetX:le,offsetY:be}];let qe=[];for(const{offsetX:at,offsetY:pt}of ze)qe.push(new c.P(Q.x+O.x*at+V.x*pt,Q.y+O.y*at+V.y*pt));let Qe=!1;if(_){const at=qe.map(pt=>this.projectAndGetPerspectiveRatio(d,pt.x,pt.y,f,z));Qe=at.some(pt=>!pt.isOccluded),qe=at.map(pt=>pt.point)}else Qe=!0;return{box:c.ao(qe),allPointsOccluded:!Qe}}}function fn(y,t,a){return t*(c.X/(y.tileSize*Math.pow(2,a-y.tileID.overscaledZ)))}class Ar{constructor(t,a,d,f){this.opacity=t?Math.max(0,Math.min(1,t.opacity+(t.placed?a:-a))):f&&d?1:0,this.placed=d}isHidden(){return this.opacity===0&&!this.placed}}class xr{constructor(t,a,d,f,_){this.text=new Ar(t?t.text:null,a,d,_),this.icon=new Ar(t?t.icon:null,a,f,_)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class on{constructor(t,a,d){this.text=t,this.icon=a,this.skipFade=d}}class Wn{constructor(){this.invProjMatrix=c.H(),this.viewportMatrix=c.H(),this.circles=[]}}class ur{constructor(t,a,d,f,_){this.bucketInstanceId=t,this.featureIndex=a,this.sourceLayerIndex=d,this.bucketIndex=f,this.tileID=_}}class Hr{constructor(t){this.crossSourceCollisions=t,this.maxGroupID=0,this.collisionGroups={}}get(t){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[t]){const a=++this.maxGroupID;this.collisionGroups[t]={ID:a,predicate:d=>d.collisionGroupID===a}}return this.collisionGroups[t]}}function ti(y,t,a,d,f){const{horizontalAlign:_,verticalAlign:E}=c.au(y);return new c.P(-(_-.5)*t+d[0]*f,-(E-.5)*a+d[1]*f)}class Xr{constructor(t,a,d,f,_,E){this.transform=t.clone(),this.terrain=d,this.collisionIndex=new kn(this.transform,a),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=f,this.retainedQueryData={},this.collisionGroups=new Hr(_),this.collisionCircleArrays={},this.collisionBoxArrays=new Map,this.prevPlacement=E,E&&(E.prevPlacement=void 0),this.placedOrientations={}}_getTerrainElevationFunc(t){const a=this.terrain;return a?(d,f)=>a.getElevation(t,d,f):null}getBucketParts(t,a,d,f){const _=d.getBucket(a),E=d.latestFeatureIndex;if(!_||!E||a.id!==_.layerIds[0])return;const I=d.collisionBoxArray,k=_.layers[0].layout,z=_.layers[0].paint,R=Math.pow(2,this.transform.zoom-d.tileID.overscaledZ),O=d.tileSize/c.X,V=d.tileID.toUnwrapped(),X=this.transform.calculatePosMatrix(V),Q=k.get("text-pitch-alignment")==="map",ie=k.get("text-rotation-alignment")==="map",le=fn(d,1,this.transform.zoom),ce=this.collisionIndex.mapProjection.translatePosition(this.transform,d,z.get("text-translate"),z.get("text-translate-anchor")),me=this.collisionIndex.mapProjection.translatePosition(this.transform,d,z.get("icon-translate"),z.get("icon-translate-anchor")),te=co(X,Q,ie,this.transform,le);let xe=null;if(Q){const ze=Ds(X,Q,ie,this.transform,le);xe=c.L([],this.transform.labelPlaneMatrix,ze)}this.retainedQueryData[_.bucketInstanceId]=new ur(_.bucketInstanceId,E,_.sourceLayerIndex,_.index,d.tileID);const be={bucket:_,layout:k,translationText:ce,translationIcon:me,posMatrix:X,unwrappedTileID:V,textLabelPlaneMatrix:te,labelToScreenMatrix:xe,scale:R,textPixelRatio:O,holdingForFade:d.holdingForFade(),collisionBoxArray:I,partiallyEvaluatedTextSize:c.ag(_.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(_.sourceID)};if(f)for(const ze of _.sortKeyRanges){const{sortKey:qe,symbolInstanceStart:Qe,symbolInstanceEnd:at}=ze;t.push({sortKey:qe,symbolInstanceStart:Qe,symbolInstanceEnd:at,parameters:be})}else t.push({symbolInstanceStart:0,symbolInstanceEnd:_.symbolInstances.length,parameters:be})}attemptAnchorPlacement(t,a,d,f,_,E,I,k,z,R,O,V,X,Q,ie,le,ce,me,te){const xe=c.aq[t.textAnchor],be=[t.textOffset0,t.textOffset1],ze=ti(xe,d,f,be,_),qe=this.collisionIndex.placeCollisionBox(a,V,k,z,R,I,E,le,O.predicate,te,ze);if((!me||this.collisionIndex.placeCollisionBox(me,V,k,z,R,I,E,ce,O.predicate,te,ze).placeable)&&qe.placeable){let Qe;if(this.prevPlacement&&this.prevPlacement.variableOffsets[X.crossTileID]&&this.prevPlacement.placements[X.crossTileID]&&this.prevPlacement.placements[X.crossTileID].text&&(Qe=this.prevPlacement.variableOffsets[X.crossTileID].anchor),X.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[X.crossTileID]={textOffset:be,width:d,height:f,anchor:xe,textBoxScale:_,prevAnchor:Qe},this.markUsedJustification(Q,xe,X,ie),Q.allowVerticalPlacement&&(this.markUsedOrientation(Q,ie,X),this.placedOrientations[X.crossTileID]=ie),{shift:ze,placedGlyphBoxes:qe}}}placeLayerBucketPart(t,a,d){const{bucket:f,layout:_,translationText:E,translationIcon:I,posMatrix:k,unwrappedTileID:z,textLabelPlaneMatrix:R,labelToScreenMatrix:O,textPixelRatio:V,holdingForFade:X,collisionBoxArray:Q,partiallyEvaluatedTextSize:ie,collisionGroup:le}=t.parameters,ce=_.get("text-optional"),me=_.get("icon-optional"),te=c.ar(_,"text-overlap","text-allow-overlap"),xe=te==="always",be=c.ar(_,"icon-overlap","icon-allow-overlap"),ze=be==="always",qe=_.get("text-rotation-alignment")==="map",Qe=_.get("text-pitch-alignment")==="map",at=_.get("icon-text-fit")!=="none",pt=_.get("symbol-z-order")==="viewport-y",st=xe&&(ze||!f.hasIconData()||me),ot=ze&&(xe||!f.hasTextData()||ce);!f.collisionArrays&&Q&&f.deserializeCollisionBoxes(Q);const wt=this._getTerrainElevationFunc(this.retainedQueryData[f.bucketInstanceId].tileID),Wt=(ht,tt,jt)=>{var sr,$t;if(a[ht.crossTileID])return;if(X)return void(this.placements[ht.crossTileID]=new on(!1,!1,!1));let un=!1,Xn=!1,Cr=!0,ps=null,hn={box:null,placeable:!1,offscreen:null},fi={box:null,placeable:!1,offscreen:null},Ci=null,pi=null,Ii=null,ms=0,xl=0,Ko=0;tt.textFeatureIndex?ms=tt.textFeatureIndex:ht.useRuntimeCollisionCircles&&(ms=ht.featureIndex),tt.verticalTextFeatureIndex&&(xl=tt.verticalTextFeatureIndex);const Ma=tt.textBox;if(Ma){const _s=ii=>{let mi=c.ah.horizontal;if(f.allowVerticalPlacement&&!ii&&this.prevPlacement){const Yi=this.prevPlacement.placedOrientations[ht.crossTileID];Yi&&(this.placedOrientations[ht.crossTileID]=Yi,mi=Yi,this.markUsedOrientation(f,mi,ht))}return mi},ys=(ii,mi)=>{if(f.allowVerticalPlacement&&ht.numVerticalGlyphVertices>0&&tt.verticalTextBox){for(const Yi of f.writingModes)if(Yi===c.ah.vertical?(hn=mi(),fi=hn):hn=ii(),hn&&hn.placeable)break}else hn=ii()},eo=ht.textAnchorOffsetStartIndex,vs=ht.textAnchorOffsetEndIndex;if(vs===eo){const ii=(mi,Yi)=>{const gn=this.collisionIndex.placeCollisionBox(mi,te,V,k,z,Qe,qe,E,le.predicate,wt);return gn&&gn.placeable&&(this.markUsedOrientation(f,Yi,ht),this.placedOrientations[ht.crossTileID]=Yi),gn};ys(()=>ii(Ma,c.ah.horizontal),()=>{const mi=tt.verticalTextBox;return f.allowVerticalPlacement&&ht.numVerticalGlyphVertices>0&&mi?ii(mi,c.ah.vertical):{box:null,offscreen:null}}),_s(hn&&hn.placeable)}else{let ii=c.aq[($t=(sr=this.prevPlacement)===null||sr===void 0?void 0:sr.variableOffsets[ht.crossTileID])===null||$t===void 0?void 0:$t.anchor];const mi=(gn,bo,wl)=>{const Yo=gn.x2-gn.x1,bh=gn.y2-gn.y1,Od=ht.textBoxScale,Sh=at&&be==="never"?bo:null;let Fs=null,Fd=te==="never"?1:2,iu="never";ii&&Fd++;for(let bl=0;bl<Fd;bl++){for(let lc=eo;lc<vs;lc++){const su=f.textAnchorOffsets.get(lc);if(ii&&su.textAnchor!==ii)continue;const Sl=this.attemptAnchorPlacement(su,gn,Yo,bh,Od,qe,Qe,V,k,z,le,iu,ht,f,wl,E,I,Sh,wt);if(Sl&&(Fs=Sl.placedGlyphBoxes,Fs&&Fs.placeable))return un=!0,ps=Sl.shift,Fs}ii?ii=null:iu=te}return d&&!Fs&&(Fs={box:this.collisionIndex.placeCollisionBox(Ma,"always",V,k,z,Qe,qe,E,le.predicate,wt,new c.P(0,0)).box,offscreen:!1,placeable:!1}),Fs};ys(()=>mi(Ma,tt.iconBox,c.ah.horizontal),()=>{const gn=tt.verticalTextBox;return f.allowVerticalPlacement&&(!hn||!hn.placeable)&&ht.numVerticalGlyphVertices>0&&gn?mi(gn,tt.verticalIconBox,c.ah.vertical):{box:null,occluded:!0,offscreen:null}}),hn&&(un=hn.placeable,Cr=hn.offscreen);const Yi=_s(hn&&hn.placeable);if(!un&&this.prevPlacement){const gn=this.prevPlacement.variableOffsets[ht.crossTileID];gn&&(this.variableOffsets[ht.crossTileID]=gn,this.markUsedJustification(f,gn.anchor,ht,Yi))}}}if(Ci=hn,un=Ci&&Ci.placeable,Cr=Ci&&Ci.offscreen,ht.useRuntimeCollisionCircles){const _s=f.text.placedSymbolArray.get(ht.centerJustifiedTextSymbolIndex),ys=c.ai(f.textSizeData,ie,_s),eo=_.get("text-padding");pi=this.collisionIndex.placeCollisionCircles(te,_s,f.lineVertexArray,f.glyphOffsetArray,ys,k,z,R,O,d,Qe,le.predicate,ht.collisionCircleDiameter,eo,E,wt),pi.circles.length&&pi.collisionDetected&&!d&&c.w("Collisions detected, but collision boxes are not shown"),un=xe||pi.circles.length>0&&!pi.collisionDetected,Cr=Cr&&pi.offscreen}if(tt.iconFeatureIndex&&(Ko=tt.iconFeatureIndex),tt.iconBox){const _s=ys=>this.collisionIndex.placeCollisionBox(ys,be,V,k,z,Qe,qe,I,le.predicate,wt,at&&ps?ps:void 0);fi&&fi.placeable&&tt.verticalIconBox?(Ii=_s(tt.verticalIconBox),Xn=Ii.placeable):(Ii=_s(tt.iconBox),Xn=Ii.placeable),Cr=Cr&&Ii.offscreen}const gs=ce||ht.numHorizontalGlyphVertices===0&&ht.numVerticalGlyphVertices===0,ac=me||ht.numIconVertices===0;gs||ac?ac?gs||(Xn=Xn&&un):un=Xn&&un:Xn=un=Xn&&un;const za=Xn&&Ii.placeable;if(un&&Ci.placeable&&this.collisionIndex.insertCollisionBox(Ci.box,te,_.get("text-ignore-placement"),f.bucketInstanceId,fi&&fi.placeable&&xl?xl:ms,le.ID),za&&this.collisionIndex.insertCollisionBox(Ii.box,be,_.get("icon-ignore-placement"),f.bucketInstanceId,Ko,le.ID),pi&&un&&this.collisionIndex.insertCollisionCircles(pi.circles,te,_.get("text-ignore-placement"),f.bucketInstanceId,ms,le.ID),d&&this.storeCollisionData(f.bucketInstanceId,jt,tt,Ci,Ii,pi),ht.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(f.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[ht.crossTileID]=new on(un||st,Xn||ot,Cr||f.justReloaded),a[ht.crossTileID]=!0};if(pt){if(t.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const ht=f.getSortedSymbolIndexes(this.transform.angle);for(let tt=ht.length-1;tt>=0;--tt){const jt=ht[tt];Wt(f.symbolInstances.get(jt),f.collisionArrays[jt],jt)}}else for(let ht=t.symbolInstanceStart;ht<t.symbolInstanceEnd;ht++)Wt(f.symbolInstances.get(ht),f.collisionArrays[ht],ht);if(d&&f.bucketInstanceId in this.collisionCircleArrays){const ht=this.collisionCircleArrays[f.bucketInstanceId];c.as(ht.invProjMatrix,k),ht.viewportMatrix=this.collisionIndex.getViewportMatrix()}f.justReloaded=!1}storeCollisionData(t,a,d,f,_,E){if(d.textBox||d.iconBox){let I,k;this.collisionBoxArrays.has(t)?I=this.collisionBoxArrays.get(t):(I=new Map,this.collisionBoxArrays.set(t,I)),I.has(a)?k=I.get(a):(k={text:null,icon:null},I.set(a,k)),d.textBox&&(k.text=f.box),d.iconBox&&(k.icon=_.box)}if(E){let I=this.collisionCircleArrays[t];I===void 0&&(I=this.collisionCircleArrays[t]=new Wn);for(let k=0;k<E.circles.length;k+=4)I.circles.push(E.circles[k+0]),I.circles.push(E.circles[k+1]),I.circles.push(E.circles[k+2]),I.circles.push(E.collisionDetected?1:0)}}markUsedJustification(t,a,d,f){let _;_=f===c.ah.vertical?d.verticalPlacedTextSymbolIndex:{left:d.leftJustifiedTextSymbolIndex,center:d.centerJustifiedTextSymbolIndex,right:d.rightJustifiedTextSymbolIndex}[c.at(a)];const E=[d.leftJustifiedTextSymbolIndex,d.centerJustifiedTextSymbolIndex,d.rightJustifiedTextSymbolIndex,d.verticalPlacedTextSymbolIndex];for(const I of E)I>=0&&(t.text.placedSymbolArray.get(I).crossTileID=_>=0&&I!==_?0:d.crossTileID)}markUsedOrientation(t,a,d){const f=a===c.ah.horizontal||a===c.ah.horizontalOnly?a:0,_=a===c.ah.vertical?a:0,E=[d.leftJustifiedTextSymbolIndex,d.centerJustifiedTextSymbolIndex,d.rightJustifiedTextSymbolIndex];for(const I of E)t.text.placedSymbolArray.get(I).placedOrientation=f;d.verticalPlacedTextSymbolIndex&&(t.text.placedSymbolArray.get(d.verticalPlacedTextSymbolIndex).placedOrientation=_)}commit(t){this.commitTime=t,this.zoomAtLastRecencyCheck=this.transform.zoom;const a=this.prevPlacement;let d=!1;this.prevZoomAdjustment=a?a.zoomAdjustment(this.transform.zoom):0;const f=a?a.symbolFadeChange(t):1,_=a?a.opacities:{},E=a?a.variableOffsets:{},I=a?a.placedOrientations:{};for(const k in this.placements){const z=this.placements[k],R=_[k];R?(this.opacities[k]=new xr(R,f,z.text,z.icon),d=d||z.text!==R.text.placed||z.icon!==R.icon.placed):(this.opacities[k]=new xr(null,f,z.text,z.icon,z.skipFade),d=d||z.text||z.icon)}for(const k in _){const z=_[k];if(!this.opacities[k]){const R=new xr(z,f,!1,!1);R.isHidden()||(this.opacities[k]=R,d=d||z.text.placed||z.icon.placed)}}for(const k in E)this.variableOffsets[k]||!this.opacities[k]||this.opacities[k].isHidden()||(this.variableOffsets[k]=E[k]);for(const k in I)this.placedOrientations[k]||!this.opacities[k]||this.opacities[k].isHidden()||(this.placedOrientations[k]=I[k]);if(a&&a.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");d?this.lastPlacementChangeTime=t:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=a?a.lastPlacementChangeTime:t)}updateLayerOpacities(t,a){const d={};for(const f of a){const _=f.getBucket(t);_&&f.latestFeatureIndex&&t.id===_.layerIds[0]&&this.updateBucketOpacities(_,f.tileID,d,f.collisionBoxArray)}}updateBucketOpacities(t,a,d,f){t.hasTextData()&&(t.text.opacityVertexArray.clear(),t.text.hasVisibleVertices=!1),t.hasIconData()&&(t.icon.opacityVertexArray.clear(),t.icon.hasVisibleVertices=!1),t.hasIconCollisionBoxData()&&t.iconCollisionBox.collisionVertexArray.clear(),t.hasTextCollisionBoxData()&&t.textCollisionBox.collisionVertexArray.clear();const _=t.layers[0],E=_.layout,I=new xr(null,0,!1,!1,!0),k=E.get("text-allow-overlap"),z=E.get("icon-allow-overlap"),R=_._unevaluatedLayout.hasValue("text-variable-anchor")||_._unevaluatedLayout.hasValue("text-variable-anchor-offset"),O=E.get("text-rotation-alignment")==="map",V=E.get("text-pitch-alignment")==="map",X=E.get("icon-text-fit")!=="none",Q=new xr(null,0,k&&(z||!t.hasIconData()||E.get("icon-optional")),z&&(k||!t.hasTextData()||E.get("text-optional")),!0);!t.collisionArrays&&f&&(t.hasIconCollisionBoxData()||t.hasTextCollisionBoxData())&&t.deserializeCollisionBoxes(f);const ie=(ce,me,te)=>{for(let xe=0;xe<me/4;xe++)ce.opacityVertexArray.emplaceBack(te);ce.hasVisibleVertices=ce.hasVisibleVertices||te!==el},le=this.collisionBoxArrays.get(t.bucketInstanceId);for(let ce=0;ce<t.symbolInstances.length;ce++){const me=t.symbolInstances.get(ce),{numHorizontalGlyphVertices:te,numVerticalGlyphVertices:xe,crossTileID:be}=me;let ze=this.opacities[be];d[be]?ze=I:ze||(ze=Q,this.opacities[be]=ze),d[be]=!0;const qe=me.numIconVertices>0,Qe=this.placedOrientations[me.crossTileID],at=Qe===c.ah.vertical,pt=Qe===c.ah.horizontal||Qe===c.ah.horizontalOnly;if(te>0||xe>0){const ot=Gi(ze.text);ie(t.text,te,at?el:ot),ie(t.text,xe,pt?el:ot);const wt=ze.text.isHidden();[me.rightJustifiedTextSymbolIndex,me.centerJustifiedTextSymbolIndex,me.leftJustifiedTextSymbolIndex].forEach(tt=>{tt>=0&&(t.text.placedSymbolArray.get(tt).hidden=wt||at?1:0)}),me.verticalPlacedTextSymbolIndex>=0&&(t.text.placedSymbolArray.get(me.verticalPlacedTextSymbolIndex).hidden=wt||pt?1:0);const Wt=this.variableOffsets[me.crossTileID];Wt&&this.markUsedJustification(t,Wt.anchor,me,Qe);const ht=this.placedOrientations[me.crossTileID];ht&&(this.markUsedJustification(t,"left",me,ht),this.markUsedOrientation(t,ht,me))}if(qe){const ot=Gi(ze.icon),wt=!(X&&me.verticalPlacedIconSymbolIndex&&at);me.placedIconSymbolIndex>=0&&(ie(t.icon,me.numIconVertices,wt?ot:el),t.icon.placedSymbolArray.get(me.placedIconSymbolIndex).hidden=ze.icon.isHidden()),me.verticalPlacedIconSymbolIndex>=0&&(ie(t.icon,me.numVerticalIconVertices,wt?el:ot),t.icon.placedSymbolArray.get(me.verticalPlacedIconSymbolIndex).hidden=ze.icon.isHidden())}const st=le&&le.has(ce)?le.get(ce):{text:null,icon:null};if(t.hasIconCollisionBoxData()||t.hasTextCollisionBoxData()){const ot=t.collisionArrays[ce];if(ot){let wt=new c.P(0,0);if(ot.textBox||ot.verticalTextBox){let Wt=!0;if(R){const ht=this.variableOffsets[be];ht?(wt=ti(ht.anchor,ht.width,ht.height,ht.textOffset,ht.textBoxScale),O&&wt._rotate(V?this.transform.angle:-this.transform.angle)):Wt=!1}if(ot.textBox||ot.verticalTextBox){let ht;ot.textBox&&(ht=at),ot.verticalTextBox&&(ht=pt),Qa(t.textCollisionBox.collisionVertexArray,ze.text.placed,!Wt||ht,st.text,wt.x,wt.y)}}if(ot.iconBox||ot.verticalIconBox){const Wt=!!(!pt&&ot.verticalIconBox);let ht;ot.iconBox&&(ht=Wt),ot.verticalIconBox&&(ht=!Wt),Qa(t.iconCollisionBox.collisionVertexArray,ze.icon.placed,ht,st.icon,X?wt.x:0,X?wt.y:0)}}}}if(t.sortFeatures(this.transform.angle),this.retainedQueryData[t.bucketInstanceId]&&(this.retainedQueryData[t.bucketInstanceId].featureSortOrder=t.featureSortOrder),t.hasTextData()&&t.text.opacityVertexBuffer&&t.text.opacityVertexBuffer.updateData(t.text.opacityVertexArray),t.hasIconData()&&t.icon.opacityVertexBuffer&&t.icon.opacityVertexBuffer.updateData(t.icon.opacityVertexArray),t.hasIconCollisionBoxData()&&t.iconCollisionBox.collisionVertexBuffer&&t.iconCollisionBox.collisionVertexBuffer.updateData(t.iconCollisionBox.collisionVertexArray),t.hasTextCollisionBoxData()&&t.textCollisionBox.collisionVertexBuffer&&t.textCollisionBox.collisionVertexBuffer.updateData(t.textCollisionBox.collisionVertexArray),t.text.opacityVertexArray.length!==t.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${t.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${t.text.layoutVertexArray.length}) / 4`);if(t.icon.opacityVertexArray.length!==t.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${t.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${t.icon.layoutVertexArray.length}) / 4`);if(t.bucketInstanceId in this.collisionCircleArrays){const ce=this.collisionCircleArrays[t.bucketInstanceId];t.placementInvProjMatrix=ce.invProjMatrix,t.placementViewportMatrix=ce.viewportMatrix,t.collisionCircleArray=ce.circles,delete this.collisionCircleArrays[t.bucketInstanceId]}}symbolFadeChange(t){return this.fadeDuration===0?1:(t-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(t){return Math.max(0,(this.transform.zoom-t)/1.5)}hasTransitions(t){return this.stale||t-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(t,a){const d=this.zoomAtLastRecencyCheck===a?1-this.zoomAdjustment(a):1;return this.zoomAtLastRecencyCheck=a,this.commitTime+this.fadeDuration*d>t}setStale(){this.stale=!0}}function Qa(y,t,a,d,f,_){d&&d.length!==0||(d=[0,0,0,0]);const E=d[0]-Jt,I=d[1]-Jt,k=d[2]-Jt,z=d[3]-Jt;y.emplaceBack(t?1:0,a?1:0,f||0,_||0,E,I),y.emplaceBack(t?1:0,a?1:0,f||0,_||0,k,I),y.emplaceBack(t?1:0,a?1:0,f||0,_||0,k,z),y.emplaceBack(t?1:0,a?1:0,f||0,_||0,E,z)}const Ln=Math.pow(2,25),Gc=Math.pow(2,24),Hc=Math.pow(2,17),Zi=Math.pow(2,16),zi=Math.pow(2,9),fd=Math.pow(2,8),Wi=Math.pow(2,1);function Gi(y){if(y.opacity===0&&!y.placed)return 0;if(y.opacity===1&&y.placed)return 4294967295;const t=y.placed?1:0,a=Math.floor(127*y.opacity);return a*Ln+t*Gc+a*Hc+t*Zi+a*zi+t*fd+a*Wi+t}const el=0;function fa(){return{isOccluded:(y,t,a)=>!1,getPitchedTextCorrection:(y,t,a)=>1,get useSpecialProjectionForSymbols(){return!1},projectTileCoordinates(y,t,a,d){throw new Error("Not implemented.")},translatePosition:(y,t,a,d)=>function(f,_,E,I,k=!1){if(!E[0]&&!E[1])return[0,0];const z=k?I==="map"?f.angle:0:I==="viewport"?-f.angle:0;if(z){const R=Math.sin(z),O=Math.cos(z);E=[E[0]*O-E[1]*R,E[0]*R+E[1]*O]}return[k?E[0]:fn(_,E[0],f.zoom),k?E[1]:fn(_,E[1],f.zoom)]}(y,t,a,d),getCircleRadiusCorrection:y=>1}}class Or{constructor(t){this._sortAcrossTiles=t.layout.get("symbol-z-order")!=="viewport-y"&&!t.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(t,a,d,f,_){const E=this._bucketParts;for(;this._currentTileIndex<t.length;)if(a.getBucketParts(E,f,t[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,_())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,E.sort((I,k)=>I.sortKey-k.sortKey));this._currentPartIndex<E.length;)if(a.placeLayerBucketPart(E[this._currentPartIndex],this._seenCrossTileIDs,d),this._currentPartIndex++,_())return!0;return!1}}class tl{constructor(t,a,d,f,_,E,I,k){this.placement=new Xr(t,fa(),a,E,I,k),this._currentPlacementIndex=d.length-1,this._forceFullPlacement=f,this._showCollisionBoxes=_,this._done=!1}isDone(){return this._done}continuePlacement(t,a,d){const f=G.now(),_=()=>!this._forceFullPlacement&&G.now()-f>2;for(;this._currentPlacementIndex>=0;){const E=a[t[this._currentPlacementIndex]],I=this.placement.collisionIndex.transform.zoom;if(E.type==="symbol"&&(!E.minzoom||E.minzoom<=I)&&(!E.maxzoom||E.maxzoom>I)){if(this._inProgressLayer||(this._inProgressLayer=new Or(E)),this._inProgressLayer.continuePlacement(d[E.source],this.placement,this._showCollisionBoxes,E,_))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(t){return this.placement.commit(t),this.placement}}const as=512/c.X/2;class Er{constructor(t,a,d){this.tileID=t,this.bucketInstanceId=d,this._symbolsByKey={};const f=new Map;for(let _=0;_<a.length;_++){const E=a.get(_),I=E.key,k=f.get(I);k?k.push(E):f.set(I,[E])}for(const[_,E]of f){const I={positions:E.map(k=>({x:Math.floor(k.anchorX*as),y:Math.floor(k.anchorY*as)})),crossTileIDs:E.map(k=>k.crossTileID)};if(I.positions.length>128){const k=new c.av(I.positions.length,16,Uint16Array);for(const{x:z,y:R}of I.positions)k.add(z,R);k.finish(),delete I.positions,I.index=k}this._symbolsByKey[_]=I}}getScaledCoordinates(t,a){const{x:d,y:f,z:_}=this.tileID.canonical,{x:E,y:I,z:k}=a.canonical,z=as/Math.pow(2,k-_),R=(I*c.X+t.anchorY)*z,O=f*c.X*as;return{x:Math.floor((E*c.X+t.anchorX)*z-d*c.X*as),y:Math.floor(R-O)}}findMatches(t,a,d){const f=this.tileID.canonical.z<a.canonical.z?1:Math.pow(2,this.tileID.canonical.z-a.canonical.z);for(let _=0;_<t.length;_++){const E=t.get(_);if(E.crossTileID)continue;const I=this._symbolsByKey[E.key];if(!I)continue;const k=this.getScaledCoordinates(E,a);if(I.index){const z=I.index.range(k.x-f,k.y-f,k.x+f,k.y+f).sort();for(const R of z){const O=I.crossTileIDs[R];if(!d[O]){d[O]=!0,E.crossTileID=O;break}}}else if(I.positions)for(let z=0;z<I.positions.length;z++){const R=I.positions[z],O=I.crossTileIDs[z];if(Math.abs(R.x-k.x)<=f&&Math.abs(R.y-k.y)<=f&&!d[O]){d[O]=!0,E.crossTileID=O;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map(({crossTileIDs:t})=>t)}}class nl{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Ls{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(t){const a=Math.round((t-this.lng)/360);if(a!==0)for(const d in this.indexes){const f=this.indexes[d],_={};for(const E in f){const I=f[E];I.tileID=I.tileID.unwrapTo(I.tileID.wrap+a),_[I.tileID.key]=I}this.indexes[d]=_}this.lng=t}addBucket(t,a,d){if(this.indexes[t.overscaledZ]&&this.indexes[t.overscaledZ][t.key]){if(this.indexes[t.overscaledZ][t.key].bucketInstanceId===a.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(t.overscaledZ,this.indexes[t.overscaledZ][t.key])}for(let _=0;_<a.symbolInstances.length;_++)a.symbolInstances.get(_).crossTileID=0;this.usedCrossTileIDs[t.overscaledZ]||(this.usedCrossTileIDs[t.overscaledZ]={});const f=this.usedCrossTileIDs[t.overscaledZ];for(const _ in this.indexes){const E=this.indexes[_];if(Number(_)>t.overscaledZ)for(const I in E){const k=E[I];k.tileID.isChildOf(t)&&k.findMatches(a.symbolInstances,t,f)}else{const I=E[t.scaledTo(Number(_)).key];I&&I.findMatches(a.symbolInstances,t,f)}}for(let _=0;_<a.symbolInstances.length;_++){const E=a.symbolInstances.get(_);E.crossTileID||(E.crossTileID=d.generate(),f[E.crossTileID]=!0)}return this.indexes[t.overscaledZ]===void 0&&(this.indexes[t.overscaledZ]={}),this.indexes[t.overscaledZ][t.key]=new Er(t,a.symbolInstances,a.bucketInstanceId),!0}removeBucketCrossTileIDs(t,a){for(const d of a.getCrossTileIDsLists())for(const f of d)delete this.usedCrossTileIDs[t][f]}removeStaleBuckets(t){let a=!1;for(const d in this.indexes){const f=this.indexes[d];for(const _ in f)t[f[_].bucketInstanceId]||(this.removeBucketCrossTileIDs(d,f[_]),delete f[_],a=!0)}return a}}class Bu{constructor(){this.layerIndexes={},this.crossTileIDs=new nl,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(t,a,d){let f=this.layerIndexes[t.id];f===void 0&&(f=this.layerIndexes[t.id]=new Ls);let _=!1;const E={};f.handleWrapJump(d);for(const I of a){const k=I.getBucket(t);k&&t.id===k.layerIds[0]&&(k.bucketInstanceId||(k.bucketInstanceId=++this.maxBucketInstanceId),f.addBucket(I.tileID,k,this.crossTileIDs)&&(_=!0),E[k.bucketInstanceId]=!0)}return f.removeStaleBuckets(E)&&(_=!0),_}pruneUnusedLayers(t){const a={};t.forEach(d=>{a[d]=!0});for(const d in this.layerIndexes)a[d]||delete this.layerIndexes[d]}}const Di=(y,t)=>c.t(y,t&&t.filter(a=>a.identifier!=="source.canvas")),pd=c.aw();class Nu extends c.E{constructor(t,a={}){super(),this._rtlPluginLoaded=()=>{for(const d in this.sourceCaches){const f=this.sourceCaches[d].getSource().type;f!=="vector"&&f!=="geojson"||this.sourceCaches[d].reload()}},this.map=t,this.dispatcher=new Zn(rn(),t._getMapId()),this.dispatcher.registerMessageHandler("GG",(d,f)=>this.getGlyphs(d,f)),this.dispatcher.registerMessageHandler("GI",(d,f)=>this.getImages(d,f)),this.imageManager=new mt,this.imageManager.setEventedParent(this),this.glyphManager=new zt(t._requestManager,a.localIdeographFontFamily),this.lineAtlas=new St(256,512),this.crossTileSymbolIndex=new Bu,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new c.ax,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("SR",c.ay()),jr().on(Ke,this._rtlPluginLoaded),this.on("data",d=>{if(d.dataType!=="source"||d.sourceDataType!=="metadata")return;const f=this.sourceCaches[d.sourceId];if(!f)return;const _=f.getSource();if(_&&_.vectorLayerIds)for(const E in this._layers){const I=this._layers[E];I.source===_.id&&this._validateLayer(I)}})}loadURL(t,a={},d){this.fire(new c.k("dataloading",{dataType:"style"})),a.validate=typeof a.validate!="boolean"||a.validate;const f=this.map._requestManager.transformRequest(t,"Style");this._loadStyleRequest=new AbortController;const _=this._loadStyleRequest;c.h(f,this._loadStyleRequest).then(E=>{this._loadStyleRequest=null,this._load(E.data,a,d)}).catch(E=>{this._loadStyleRequest=null,E&&!_.signal.aborted&&this.fire(new c.j(E))})}loadJSON(t,a={},d){this.fire(new c.k("dataloading",{dataType:"style"})),this._frameRequest=new AbortController,G.frameAsync(this._frameRequest).then(()=>{this._frameRequest=null,a.validate=a.validate!==!1,this._load(t,a,d)}).catch(()=>{})}loadEmpty(){this.fire(new c.k("dataloading",{dataType:"style"})),this._load(pd,{validate:!1})}_load(t,a,d){var f;const _=a.transformStyle?a.transformStyle(d,t):t;if(!a.validate||!Di(this,c.u(_))){this._loaded=!0,this.stylesheet=_;for(const E in _.sources)this.addSource(E,_.sources[E],{validate:!1});_.sprite?this._loadSprite(_.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(_.glyphs),this._createLayers(),this.light=new Et(this.stylesheet.light),this.sky=new It(this.stylesheet.sky),this.map.setTerrain((f=this.stylesheet.terrain)!==null&&f!==void 0?f:null),this.fire(new c.k("data",{dataType:"style"})),this.fire(new c.k("style.load"))}}_createLayers(){const t=c.az(this.stylesheet.layers);this.dispatcher.broadcast("SL",t),this._order=t.map(a=>a.id),this._layers={},this._serializedLayers=null;for(const a of t){const d=c.aA(a);d.setEventedParent(this,{layer:{id:a.id}}),this._layers[a.id]=d}}_loadSprite(t,a=!1,d=void 0){let f;this.imageManager.setLoaded(!1),this._spriteRequest=new AbortController,function(_,E,I,k){return c._(this,void 0,void 0,function*(){const z=de(_),R=I>1?"@2x":"",O={},V={};for(const{id:X,url:Q}of z){const ie=E.transformRequest(Te(Q,R,".json"),"SpriteJSON");O[X]=c.h(ie,k);const le=E.transformRequest(Te(Q,R,".png"),"SpriteImage");V[X]=he.getImage(le,k)}return yield Promise.all([...Object.values(O),...Object.values(V)]),function(X,Q){return c._(this,void 0,void 0,function*(){const ie={};for(const le in X){ie[le]={};const ce=G.getImageCanvasContext((yield Q[le]).data),me=(yield X[le]).data;for(const te in me){const{width:xe,height:be,x:ze,y:qe,sdf:Qe,pixelRatio:at,stretchX:pt,stretchY:st,content:ot,textFitWidth:wt,textFitHeight:Wt}=me[te];ie[le][te]={data:null,pixelRatio:at,sdf:Qe,stretchX:pt,stretchY:st,content:ot,textFitWidth:wt,textFitHeight:Wt,spriteData:{width:xe,height:be,x:ze,y:qe,context:ce}}}}return ie})}(O,V)})}(t,this.map._requestManager,this.map.getPixelRatio(),this._spriteRequest).then(_=>{if(this._spriteRequest=null,_)for(const E in _){this._spritesImagesIds[E]=[];const I=this._spritesImagesIds[E]?this._spritesImagesIds[E].filter(k=>!(k in _)):[];for(const k of I)this.imageManager.removeImage(k),this._changedImages[k]=!0;for(const k in _[E]){const z=E==="default"?k:`${E}:${k}`;this._spritesImagesIds[E].push(z),z in this.imageManager.images?this.imageManager.updateImage(z,_[E][k],!1):this.imageManager.addImage(z,_[E][k]),a&&(this._changedImages[z]=!0)}}}).catch(_=>{this._spriteRequest=null,f=_,this.fire(new c.j(f))}).finally(()=>{this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),a&&(this._changed=!0),this.dispatcher.broadcast("SI",this._availableImages),this.fire(new c.k("data",{dataType:"style"})),d&&d(f)})}_unloadSprite(){for(const t of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(t),this._changedImages[t]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new c.k("data",{dataType:"style"}))}_validateLayer(t){const a=this.sourceCaches[t.source];if(!a)return;const d=t.sourceLayer;if(!d)return;const f=a.getSource();(f.type==="geojson"||f.vectorLayerIds&&f.vectorLayerIds.indexOf(d)===-1)&&this.fire(new c.j(new Error(`Source layer "${d}" does not exist on source "${f.id}" as specified by style layer "${t.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const t in this.sourceCaches)if(!this.sourceCaches[t].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(t,a=!1){const d=this._serializedAllLayers();if(!t||t.length===0)return Object.values(a?c.aB(d):d);const f=[];for(const _ of t)if(d[_]){const E=a?c.aB(d[_]):d[_];f.push(E)}return f}_serializedAllLayers(){let t=this._serializedLayers;if(t)return t;t=this._serializedLayers={};const a=Object.keys(this._layers);for(const d of a){const f=this._layers[d];f.type!=="custom"&&(t[d]=f.serialize())}return t}hasTransitions(){if(this.light&&this.light.hasTransition()||this.sky&&this.sky.hasTransition())return!0;for(const t in this.sourceCaches)if(this.sourceCaches[t].hasTransition())return!0;for(const t in this._layers)if(this._layers[t].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(t){if(!this._loaded)return;const a=this._changed;if(a){const f=Object.keys(this._updatedLayers),_=Object.keys(this._removedLayers);(f.length||_.length)&&this._updateWorkerLayers(f,_);for(const E in this._updatedSources){const I=this._updatedSources[E];if(I==="reload")this._reloadSource(E);else{if(I!=="clear")throw new Error(`Invalid action ${I}`);this._clearSource(E)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const E in this._updatedPaintProps)this._layers[E].updateTransitions(t);this.light.updateTransitions(t),this.sky.updateTransitions(t),this._resetUpdates()}const d={};for(const f in this.sourceCaches){const _=this.sourceCaches[f];d[f]=_.used,_.used=!1}for(const f of this._order){const _=this._layers[f];_.recalculate(t,this._availableImages),!_.isHidden(t.zoom)&&_.source&&(this.sourceCaches[_.source].used=!0)}for(const f in d){const _=this.sourceCaches[f];!!d[f]!=!!_.used&&_.fire(new c.k("data",{sourceDataType:"visibility",dataType:"source",sourceId:f}))}this.light.recalculate(t),this.sky.recalculate(t),this.z=t.zoom,a&&this.fire(new c.k("data",{dataType:"style"}))}_updateTilesForChangedImages(){const t=Object.keys(this._changedImages);if(t.length){for(const a in this.sourceCaches)this.sourceCaches[a].reloadTilesForDependencies(["icons","patterns"],t);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const t in this.sourceCaches)this.sourceCaches[t].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(t,a){this.dispatcher.broadcast("UL",{layers:this._serializeByIds(t,!1),removedIds:a})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(t,a={}){var d;this._checkLoaded();const f=this.serialize();if(t=a.transformStyle?a.transformStyle(f,t):t,((d=a.validate)===null||d===void 0||d)&&Di(this,c.u(t)))return!1;(t=c.aB(t)).layers=c.az(t.layers);const _=c.aC(f,t),E=this._getOperationsToPerform(_);if(E.unimplemented.length>0)throw new Error(`Unimplemented: ${E.unimplemented.join(", ")}.`);if(E.operations.length===0)return!1;for(const I of E.operations)I();return this.stylesheet=t,this._serializedLayers=null,!0}_getOperationsToPerform(t){const a=[],d=[];for(const f of t)switch(f.command){case"setCenter":case"setZoom":case"setBearing":case"setPitch":continue;case"addLayer":a.push(()=>this.addLayer.apply(this,f.args));break;case"removeLayer":a.push(()=>this.removeLayer.apply(this,f.args));break;case"setPaintProperty":a.push(()=>this.setPaintProperty.apply(this,f.args));break;case"setLayoutProperty":a.push(()=>this.setLayoutProperty.apply(this,f.args));break;case"setFilter":a.push(()=>this.setFilter.apply(this,f.args));break;case"addSource":a.push(()=>this.addSource.apply(this,f.args));break;case"removeSource":a.push(()=>this.removeSource.apply(this,f.args));break;case"setLayerZoomRange":a.push(()=>this.setLayerZoomRange.apply(this,f.args));break;case"setLight":a.push(()=>this.setLight.apply(this,f.args));break;case"setGeoJSONSourceData":a.push(()=>this.setGeoJSONSourceData.apply(this,f.args));break;case"setGlyphs":a.push(()=>this.setGlyphs.apply(this,f.args));break;case"setSprite":a.push(()=>this.setSprite.apply(this,f.args));break;case"setSky":a.push(()=>this.setSky.apply(this,f.args));break;case"setTerrain":a.push(()=>this.map.setTerrain.apply(this,f.args));break;case"setTransition":a.push(()=>{});break;default:d.push(f.command)}return{operations:a,unimplemented:d}}addImage(t,a){if(this.getImage(t))return this.fire(new c.j(new Error(`An image named "${t}" already exists.`)));this.imageManager.addImage(t,a),this._afterImageUpdated(t)}updateImage(t,a){this.imageManager.updateImage(t,a)}getImage(t){return this.imageManager.getImage(t)}removeImage(t){if(!this.getImage(t))return this.fire(new c.j(new Error(`An image named "${t}" does not exist.`)));this.imageManager.removeImage(t),this._afterImageUpdated(t)}_afterImageUpdated(t){this._availableImages=this.imageManager.listImages(),this._changedImages[t]=!0,this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new c.k("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(t,a,d={}){if(this._checkLoaded(),this.sourceCaches[t]!==void 0)throw new Error(`Source "${t}" already exists.`);if(!a.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(a).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(a.type)>=0&&this._validate(c.u.source,`sources.${t}`,a,null,d))return;this.map&&this.map._collectResourceTiming&&(a.collectResourceTiming=!0);const f=this.sourceCaches[t]=new Ut(t,a,this.dispatcher);f.style=this,f.setEventedParent(this,()=>({isSourceLoaded:f.loaded(),source:f.serialize(),sourceId:t})),f.onAdd(this.map),this._changed=!0}removeSource(t){if(this._checkLoaded(),this.sourceCaches[t]===void 0)throw new Error("There is no source with this ID");for(const d in this._layers)if(this._layers[d].source===t)return this.fire(new c.j(new Error(`Source "${t}" cannot be removed while layer "${d}" is using it.`)));const a=this.sourceCaches[t];delete this.sourceCaches[t],delete this._updatedSources[t],a.fire(new c.k("data",{sourceDataType:"metadata",dataType:"source",sourceId:t})),a.setEventedParent(null),a.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(t,a){if(this._checkLoaded(),this.sourceCaches[t]===void 0)throw new Error(`There is no source with this ID=${t}`);const d=this.sourceCaches[t].getSource();if(d.type!=="geojson")throw new Error(`geojsonSource.type is ${d.type}, which is !== 'geojson`);d.setData(a),this._changed=!0}getSource(t){return this.sourceCaches[t]&&this.sourceCaches[t].getSource()}addLayer(t,a,d={}){this._checkLoaded();const f=t.id;if(this.getLayer(f))return void this.fire(new c.j(new Error(`Layer "${f}" already exists on this map.`)));let _;if(t.type==="custom"){if(Di(this,c.aD(t)))return;_=c.aA(t)}else{if("source"in t&&typeof t.source=="object"&&(this.addSource(f,t.source),t=c.aB(t),t=c.e(t,{source:f})),this._validate(c.u.layer,`layers.${f}`,t,{arrayIndex:-1},d))return;_=c.aA(t),this._validateLayer(_),_.setEventedParent(this,{layer:{id:f}})}const E=a?this._order.indexOf(a):this._order.length;if(a&&E===-1)this.fire(new c.j(new Error(`Cannot add layer "${f}" before non-existing layer "${a}".`)));else{if(this._order.splice(E,0,f),this._layerOrderChanged=!0,this._layers[f]=_,this._removedLayers[f]&&_.source&&_.type!=="custom"){const I=this._removedLayers[f];delete this._removedLayers[f],I.type!==_.type?this._updatedSources[_.source]="clear":(this._updatedSources[_.source]="reload",this.sourceCaches[_.source].pause())}this._updateLayer(_),_.onAdd&&_.onAdd(this.map)}}moveLayer(t,a){if(this._checkLoaded(),this._changed=!0,!this._layers[t])return void this.fire(new c.j(new Error(`The layer '${t}' does not exist in the map's style and cannot be moved.`)));if(t===a)return;const d=this._order.indexOf(t);this._order.splice(d,1);const f=a?this._order.indexOf(a):this._order.length;a&&f===-1?this.fire(new c.j(new Error(`Cannot move layer "${t}" before non-existing layer "${a}".`))):(this._order.splice(f,0,t),this._layerOrderChanged=!0)}removeLayer(t){this._checkLoaded();const a=this._layers[t];if(!a)return void this.fire(new c.j(new Error(`Cannot remove non-existing layer "${t}".`)));a.setEventedParent(null);const d=this._order.indexOf(t);this._order.splice(d,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[t]=a,delete this._layers[t],this._serializedLayers&&delete this._serializedLayers[t],delete this._updatedLayers[t],delete this._updatedPaintProps[t],a.onRemove&&a.onRemove(this.map)}getLayer(t){return this._layers[t]}getLayersOrder(){return[...this._order]}hasLayer(t){return t in this._layers}setLayerZoomRange(t,a,d){this._checkLoaded();const f=this.getLayer(t);f?f.minzoom===a&&f.maxzoom===d||(a!=null&&(f.minzoom=a),d!=null&&(f.maxzoom=d),this._updateLayer(f)):this.fire(new c.j(new Error(`Cannot set the zoom range of non-existing layer "${t}".`)))}setFilter(t,a,d={}){this._checkLoaded();const f=this.getLayer(t);if(f){if(!c.aE(f.filter,a))return a==null?(f.filter=void 0,void this._updateLayer(f)):void(this._validate(c.u.filter,`layers.${f.id}.filter`,a,null,d)||(f.filter=c.aB(a),this._updateLayer(f)))}else this.fire(new c.j(new Error(`Cannot filter non-existing layer "${t}".`)))}getFilter(t){return c.aB(this.getLayer(t).filter)}setLayoutProperty(t,a,d,f={}){this._checkLoaded();const _=this.getLayer(t);_?c.aE(_.getLayoutProperty(a),d)||(_.setLayoutProperty(a,d,f),this._updateLayer(_)):this.fire(new c.j(new Error(`Cannot style non-existing layer "${t}".`)))}getLayoutProperty(t,a){const d=this.getLayer(t);if(d)return d.getLayoutProperty(a);this.fire(new c.j(new Error(`Cannot get style of non-existing layer "${t}".`)))}setPaintProperty(t,a,d,f={}){this._checkLoaded();const _=this.getLayer(t);_?c.aE(_.getPaintProperty(a),d)||(_.setPaintProperty(a,d,f)&&this._updateLayer(_),this._changed=!0,this._updatedPaintProps[t]=!0,this._serializedLayers=null):this.fire(new c.j(new Error(`Cannot style non-existing layer "${t}".`)))}getPaintProperty(t,a){return this.getLayer(t).getPaintProperty(a)}setFeatureState(t,a){this._checkLoaded();const d=t.source,f=t.sourceLayer,_=this.sourceCaches[d];if(_===void 0)return void this.fire(new c.j(new Error(`The source '${d}' does not exist in the map's style.`)));const E=_.getSource().type;E==="geojson"&&f?this.fire(new c.j(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):E!=="vector"||f?(t.id===void 0&&this.fire(new c.j(new Error("The feature id parameter must be provided."))),_.setFeatureState(f,t.id,a)):this.fire(new c.j(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(t,a){this._checkLoaded();const d=t.source,f=this.sourceCaches[d];if(f===void 0)return void this.fire(new c.j(new Error(`The source '${d}' does not exist in the map's style.`)));const _=f.getSource().type,E=_==="vector"?t.sourceLayer:void 0;_!=="vector"||E?a&&typeof t.id!="string"&&typeof t.id!="number"?this.fire(new c.j(new Error("A feature id is required to remove its specific state property."))):f.removeFeatureState(E,t.id,a):this.fire(new c.j(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(t){this._checkLoaded();const a=t.source,d=t.sourceLayer,f=this.sourceCaches[a];if(f!==void 0)return f.getSource().type!=="vector"||d?(t.id===void 0&&this.fire(new c.j(new Error("The feature id parameter must be provided."))),f.getFeatureState(d,t.id)):void this.fire(new c.j(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new c.j(new Error(`The source '${a}' does not exist in the map's style.`)))}getTransition(){return c.e({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;const t=c.aF(this.sourceCaches,_=>_.serialize()),a=this._serializeByIds(this._order,!0),d=this.map.getTerrain()||void 0,f=this.stylesheet;return c.aG({version:f.version,name:f.name,metadata:f.metadata,light:f.light,sky:f.sky,center:f.center,zoom:f.zoom,bearing:f.bearing,pitch:f.pitch,sprite:f.sprite,glyphs:f.glyphs,transition:f.transition,sources:t,layers:a,terrain:d},_=>_!==void 0)}_updateLayer(t){this._updatedLayers[t.id]=!0,t.source&&!this._updatedSources[t.source]&&this.sourceCaches[t.source].getSource().type!=="raster"&&(this._updatedSources[t.source]="reload",this.sourceCaches[t.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(t){const a=E=>this._layers[E].type==="fill-extrusion",d={},f=[];for(let E=this._order.length-1;E>=0;E--){const I=this._order[E];if(a(I)){d[I]=E;for(const k of t){const z=k[I];if(z)for(const R of z)f.push(R)}}}f.sort((E,I)=>I.intersectionZ-E.intersectionZ);const _=[];for(let E=this._order.length-1;E>=0;E--){const I=this._order[E];if(a(I))for(let k=f.length-1;k>=0;k--){const z=f[k].feature;if(d[z.layer.id]<E)break;_.push(z),f.pop()}else for(const k of t){const z=k[I];if(z)for(const R of z)_.push(R.feature)}}return _}queryRenderedFeatures(t,a,d){a&&a.filter&&this._validate(c.u.filter,"queryRenderedFeatures.filter",a.filter,null,a);const f={};if(a&&a.layers){if(!Array.isArray(a.layers))return this.fire(new c.j(new Error("parameters.layers must be an Array."))),[];for(const I of a.layers){const k=this._layers[I];if(!k)return this.fire(new c.j(new Error(`The layer '${I}' does not exist in the map's style and cannot be queried for features.`))),[];f[k.source]=!0}}const _=[];a.availableImages=this._availableImages;const E=this._serializedAllLayers();for(const I in this.sourceCaches)a.layers&&!f[I]||_.push(er(this.sourceCaches[I],this._layers,E,t,a,d));return this.placement&&_.push(function(I,k,z,R,O,V,X){const Q={},ie=V.queryRenderedSymbols(R),le=[];for(const ce of Object.keys(ie).map(Number))le.push(X[ce]);le.sort(sn);for(const ce of le){const me=ce.featureIndex.lookupSymbolFeatures(ie[ce.bucketInstanceId],k,ce.bucketIndex,ce.sourceLayerIndex,O.filter,O.layers,O.availableImages,I);for(const te in me){const xe=Q[te]=Q[te]||[],be=me[te];be.sort((ze,qe)=>{const Qe=ce.featureSortOrder;if(Qe){const at=Qe.indexOf(ze.featureIndex);return Qe.indexOf(qe.featureIndex)-at}return qe.featureIndex-ze.featureIndex});for(const ze of be)xe.push(ze)}}for(const ce in Q)Q[ce].forEach(me=>{const te=me.feature,xe=z[I[ce].source].getFeatureState(te.layer["source-layer"],te.id);te.source=te.layer.source,te.layer["source-layer"]&&(te.sourceLayer=te.layer["source-layer"]),te.state=xe});return Q}(this._layers,E,this.sourceCaches,t,a,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(_)}querySourceFeatures(t,a){a&&a.filter&&this._validate(c.u.filter,"querySourceFeatures.filter",a.filter,null,a);const d=this.sourceCaches[t];return d?function(f,_){const E=f.getRenderableIds().map(z=>f.getTileByID(z)),I=[],k={};for(let z=0;z<E.length;z++){const R=E[z],O=R.tileID.canonical.key;k[O]||(k[O]=!0,R.querySourceFeatures(I,_))}return I}(d,a):[]}getLight(){return this.light.getLight()}setLight(t,a={}){this._checkLoaded();const d=this.light.getLight();let f=!1;for(const E in t)if(!c.aE(t[E],d[E])){f=!0;break}if(!f)return;const _={now:G.now(),transition:c.e({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(t,a),this.light.updateTransitions(_)}getSky(){var t;return(t=this.stylesheet)===null||t===void 0?void 0:t.sky}setSky(t,a={}){const d=this.getSky();let f=!1;if(!t&&!d)return;if(t&&!d)f=!0;else if(!t&&d)f=!0;else for(const E in t)if(!c.aE(t[E],d[E])){f=!0;break}if(!f)return;const _={now:G.now(),transition:c.e({duration:300,delay:0},this.stylesheet.transition)};this.stylesheet.sky=t,this.sky.setSky(t,a),this.sky.updateTransitions(_)}_validate(t,a,d,f,_={}){return(!_||_.validate!==!1)&&Di(this,t.call(c.u,c.e({key:a,style:this.serialize(),value:d,styleSpec:c.v},f)))}_remove(t=!0){this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null),jr().off(Ke,this._rtlPluginLoaded);for(const a in this._layers)this._layers[a].setEventedParent(null);for(const a in this.sourceCaches){const d=this.sourceCaches[a];d.setEventedParent(null),d.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),t&&this.dispatcher.broadcast("RM",void 0),this.dispatcher.remove(t)}_clearSource(t){this.sourceCaches[t].clearTiles()}_reloadSource(t){this.sourceCaches[t].resume(),this.sourceCaches[t].reload()}_updateSources(t){for(const a in this.sourceCaches)this.sourceCaches[a].update(t,this.map.terrain)}_generateCollisionBoxes(){for(const t in this.sourceCaches)this._reloadSource(t)}_updatePlacement(t,a,d,f,_=!1){let E=!1,I=!1;const k={};for(const z of this._order){const R=this._layers[z];if(R.type!=="symbol")continue;if(!k[R.source]){const V=this.sourceCaches[R.source];k[R.source]=V.getRenderableIds(!0).map(X=>V.getTileByID(X)).sort((X,Q)=>Q.tileID.overscaledZ-X.tileID.overscaledZ||(X.tileID.isLessThan(Q.tileID)?-1:1))}const O=this.crossTileSymbolIndex.addLayer(R,k[R.source],t.center.lng);E=E||O}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((_=_||this._layerOrderChanged||d===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(G.now(),t.zoom))&&(this.pauseablePlacement=new tl(t,this.map.terrain,this._order,_,a,d,f,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,k),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(G.now()),I=!0),E&&this.pauseablePlacement.placement.setStale()),I||E)for(const z of this._order){const R=this._layers[z];R.type==="symbol"&&this.placement.updateLayerOpacities(R,k[R.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(G.now())}_releaseSymbolFadeTiles(){for(const t in this.sourceCaches)this.sourceCaches[t].releaseSymbolFadeTiles()}getImages(t,a){return c._(this,void 0,void 0,function*(){const d=yield this.imageManager.getImages(a.icons);this._updateTilesForChangedImages();const f=this.sourceCaches[a.source];return f&&f.setDependencies(a.tileID.key,a.type,a.icons),d})}getGlyphs(t,a){return c._(this,void 0,void 0,function*(){const d=yield this.glyphManager.getGlyphs(a.stacks),f=this.sourceCaches[a.source];return f&&f.setDependencies(a.tileID.key,a.type,[""]),d})}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(t,a={}){this._checkLoaded(),t&&this._validate(c.u.glyphs,"glyphs",t,null,a)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=t,this.glyphManager.entries={},this.glyphManager.setURL(t))}addSprite(t,a,d={},f){this._checkLoaded();const _=[{id:t,url:a}],E=[...de(this.stylesheet.sprite),..._];this._validate(c.u.sprite,"sprite",E,null,d)||(this.stylesheet.sprite=E,this._loadSprite(_,!0,f))}removeSprite(t){this._checkLoaded();const a=de(this.stylesheet.sprite);if(a.find(d=>d.id===t)){if(this._spritesImagesIds[t])for(const d of this._spritesImagesIds[t])this.imageManager.removeImage(d),this._changedImages[d]=!0;a.splice(a.findIndex(d=>d.id===t),1),this.stylesheet.sprite=a.length>0?a:void 0,delete this._spritesImagesIds[t],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new c.k("data",{dataType:"style"}))}else this.fire(new c.j(new Error(`Sprite "${t}" doesn't exists on this map.`)))}getSprite(){return de(this.stylesheet.sprite)}setSprite(t,a={},d){this._checkLoaded(),t&&this._validate(c.u.sprite,"sprite",t,null,a)||(this.stylesheet.sprite=t,t?this._loadSprite(t,!0,d):(this._unloadSprite(),d&&d(null)))}}var Bo=c.Y([{name:"a_pos",type:"Int16",components:2}]);const ho={prelude:Pn(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture2D(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture2D(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}`),background:Pn(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),backgroundPattern:Pn(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:Pn(`varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);float antialiased_blur=v_data.z;float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);float ele=get_elevation(circle_center);v_visibility=calculate_visibility(u_matrix*vec4(circle_center,ele,1.0));if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,ele,1);} else {gl_Position=u_matrix*vec4(circle_center,ele,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}float antialiasblur=-max(1.0/u_device_pixel_ratio/(radius+stroke_width),blur);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:Pn("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:Pn(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,get_elevation(floor(a_pos*0.5)),1);gl_Position=u_matrix*pos;}`),heatmapTexture:Pn(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:Pn("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_anchor_pos;attribute vec2 a_placed;attribute vec2 a_box_real;uniform mat4 u_matrix;uniform vec2 u_pixel_extrude_scale;varying float v_placed;varying float v_notUsed;vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_matrix*vec4(posInTile,elevation,1.0);}void main() {gl_Position=projectTileWithElevation(a_anchor_pos,get_elevation(a_anchor_pos));gl_Position.xy=((a_box_real+0.5)*u_pixel_extrude_scale*2.0-1.0)*vec2(1.0,-1.0)*gl_Position.w;if (gl_Position.z/gl_Position.w < 1.1) {gl_Position.z=0.5;}v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:Pn("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:Pn("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,get_elevation(a_pos),1);}"),fill:Pn(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),fillOutline:Pn(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillOutlinePattern:Pn(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillPattern:Pn(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:Pn(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:Pn(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:Pn(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Pn(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),line:Pn(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:Pn(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:Pn(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:Pn(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),raster:Pn(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),symbolIcon:Pn(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;varying vec2 v_tex;varying float v_fade_opacity;vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_matrix*vec4(posInTile,elevation,1.0);}
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}gl_Position=finalPos;v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:Pn(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_translation;uniform float u_pitched_scale;varying vec2 v_data0;varying vec3 v_data1;vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_matrix*vec4(posInTile,elevation,1.0);}
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:Pn(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;varying vec4 v_data0;varying vec4 v_data1;vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_matrix*vec4(posInTile,elevation,1.0);}
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:Pn("uniform sampler2D u_texture;uniform vec4 u_fog_color;uniform vec4 u_horizon_color;uniform float u_fog_ground_blend;uniform float u_fog_ground_blend_opacity;uniform float u_horizon_fog_blend;varying vec2 v_texture_pos;varying float v_fog_depth;const float gamma=2.2;vec4 gammaToLinear(vec4 color) {return pow(color,vec4(gamma));}vec4 linearToGamma(vec4 color) {return pow(color,vec4(1.0/gamma));}void main() {vec4 surface_color=texture2D(u_texture,v_texture_pos);if (v_fog_depth > u_fog_ground_blend) {vec4 surface_color_linear=gammaToLinear(surface_color);float blend_color=smoothstep(0.0,1.0,max((v_fog_depth-u_horizon_fog_blend)/(1.0-u_horizon_fog_blend),0.0));vec4 fog_horizon_color_linear=mix(gammaToLinear(u_fog_color),gammaToLinear(u_horizon_color),blend_color);float factor_fog=max(v_fog_depth-u_fog_ground_blend,0.0)/(1.0-u_fog_ground_blend);gl_FragColor=linearToGamma(mix(surface_color_linear,fog_horizon_color_linear,pow(factor_fog,2.0)*u_fog_ground_blend_opacity));} else {gl_FragColor=surface_color;}}","attribute vec3 a_pos3d;uniform mat4 u_matrix;uniform mat4 u_fog_matrix;uniform float u_ele_delta;varying vec2 v_texture_pos;varying float v_fog_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=u_matrix*vec4(a_pos3d.xy,ele-ele_delta,1.0);vec4 pos=u_fog_matrix*vec4(a_pos3d.xy,ele,1.0);v_fog_depth=pos.z/pos.w*0.5+0.5;}"),terrainDepth:Pn("varying float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {gl_FragColor=pack(v_depth);}","attribute vec3 a_pos3d;uniform mat4 u_matrix;uniform float u_ele_delta;varying float v_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;gl_Position=u_matrix*vec4(a_pos3d.xy,ele-ele_delta,1.0);v_depth=gl_Position.z/gl_Position.w;}"),terrainCoords:Pn("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;varying vec2 v_texture_pos;void main() {vec4 rgba=texture2D(u_texture,v_texture_pos);gl_FragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}","attribute vec3 a_pos3d;uniform mat4 u_matrix;uniform float u_ele_delta;varying vec2 v_texture_pos;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=u_matrix*vec4(a_pos3d.xy,ele-ele_delta,1.0);}"),sky:Pn("uniform vec4 u_sky_color;uniform vec4 u_horizon_color;uniform float u_horizon;uniform float u_sky_horizon_blend;void main() {float y=gl_FragCoord.y;if (y > u_horizon) {float blend=y-u_horizon;if (blend < u_sky_horizon_blend) {gl_FragColor=mix(u_sky_color,u_horizon_color,pow(1.0-blend/u_sky_horizon_blend,2.0));} else {gl_FragColor=u_sky_color;}}}","attribute vec2 a_pos;void main() {gl_Position=vec4(a_pos,1.0,1.0);}")};function Pn(y,t){const a=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,d=t.match(/attribute ([\w]+) ([\w]+)/g),f=y.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),_=t.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),E=_?_.concat(f):f,I={};return{fragmentSource:y=y.replace(a,(k,z,R,O,V)=>(I[V]=!0,z==="define"?`
#ifndef HAS_UNIFORM_u_${V}
varying ${R} ${O} ${V};
#else
uniform ${R} ${O} u_${V};
#endif
`:`
#ifdef HAS_UNIFORM_u_${V}
    ${R} ${O} ${V} = u_${V};
#endif
`)),vertexSource:t=t.replace(a,(k,z,R,O,V)=>{const X=O==="float"?"vec2":"vec4",Q=V.match(/color/)?"color":X;return I[V]?z==="define"?`
#ifndef HAS_UNIFORM_u_${V}
uniform lowp float u_${V}_t;
attribute ${R} ${X} a_${V};
varying ${R} ${O} ${V};
#else
uniform ${R} ${O} u_${V};
#endif
`:Q==="vec4"?`
#ifndef HAS_UNIFORM_u_${V}
    ${V} = a_${V};
#else
    ${R} ${O} ${V} = u_${V};
#endif
`:`
#ifndef HAS_UNIFORM_u_${V}
    ${V} = unpack_mix_${Q}(a_${V}, u_${V}_t);
#else
    ${R} ${O} ${V} = u_${V};
#endif
`:z==="define"?`
#ifndef HAS_UNIFORM_u_${V}
uniform lowp float u_${V}_t;
attribute ${R} ${X} a_${V};
#else
uniform ${R} ${O} u_${V};
#endif
`:Q==="vec4"?`
#ifndef HAS_UNIFORM_u_${V}
    ${R} ${O} ${V} = a_${V};
#else
    ${R} ${O} ${V} = u_${V};
#endif
`:`
#ifndef HAS_UNIFORM_u_${V}
    ${R} ${O} ${V} = unpack_mix_${Q}(a_${V}, u_${V}_t);
#else
    ${R} ${O} ${V} = u_${V};
#endif
`}),staticAttributes:d,staticUniforms:E}}class Xc{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(t,a,d,f,_,E,I,k,z){this.context=t;let R=this.boundPaintVertexBuffers.length!==f.length;for(let O=0;!R&&O<f.length;O++)this.boundPaintVertexBuffers[O]!==f[O]&&(R=!0);!this.vao||this.boundProgram!==a||this.boundLayoutVertexBuffer!==d||R||this.boundIndexBuffer!==_||this.boundVertexOffset!==E||this.boundDynamicVertexBuffer!==I||this.boundDynamicVertexBuffer2!==k||this.boundDynamicVertexBuffer3!==z?this.freshBind(a,d,f,_,E,I,k,z):(t.bindVertexArray.set(this.vao),I&&I.bind(),_&&_.dynamicDraw&&_.bind(),k&&k.bind(),z&&z.bind())}freshBind(t,a,d,f,_,E,I,k){const z=t.numAttributes,R=this.context,O=R.gl;this.vao&&this.destroy(),this.vao=R.createVertexArray(),R.bindVertexArray.set(this.vao),this.boundProgram=t,this.boundLayoutVertexBuffer=a,this.boundPaintVertexBuffers=d,this.boundIndexBuffer=f,this.boundVertexOffset=_,this.boundDynamicVertexBuffer=E,this.boundDynamicVertexBuffer2=I,this.boundDynamicVertexBuffer3=k,a.enableAttributes(O,t);for(const V of d)V.enableAttributes(O,t);E&&E.enableAttributes(O,t),I&&I.enableAttributes(O,t),k&&k.enableAttributes(O,t),a.bind(),a.setVertexAttribPointers(O,t,_);for(const V of d)V.bind(),V.setVertexAttribPointers(O,t,_);E&&(E.bind(),E.setVertexAttribPointers(O,t,_)),f&&f.bind(),I&&(I.bind(),I.setVertexAttribPointers(O,t,_)),k&&(k.bind(),k.setVertexAttribPointers(O,t,_)),R.currentNumAttributes=z}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}const Uu=(y,t,a,d,f)=>({u_matrix:y,u_texture:0,u_ele_delta:t,u_fog_matrix:a,u_fog_color:d?d.properties.get("fog-color"):c.aM.white,u_fog_ground_blend:d?d.properties.get("fog-ground-blend"):1,u_fog_ground_blend_opacity:d?d.calculateFogBlendOpacity(f):0,u_horizon_color:d?d.properties.get("horizon-color"):c.aM.white,u_horizon_fog_blend:d?d.properties.get("horizon-fog-blend"):1});function No(y){const t=[];for(let a=0;a<y.length;a++){if(y[a]===null)continue;const d=y[a].split(" ");t.push(d.pop())}return t}class $l{constructor(t,a,d,f,_,E){const I=t.gl;this.program=I.createProgram();const k=No(a.staticAttributes),z=d?d.getBinderAttributes():[],R=k.concat(z),O=ho.prelude.staticUniforms?No(ho.prelude.staticUniforms):[],V=a.staticUniforms?No(a.staticUniforms):[],X=d?d.getBinderUniforms():[],Q=O.concat(V).concat(X),ie=[];for(const ze of Q)ie.indexOf(ze)<0&&ie.push(ze);const le=d?d.defines():[];_&&le.push("#define OVERDRAW_INSPECTOR;"),E&&le.push("#define TERRAIN3D;");const ce=le.concat(ho.prelude.fragmentSource,a.fragmentSource).join(`
`),me=le.concat(ho.prelude.vertexSource,a.vertexSource).join(`
`),te=I.createShader(I.FRAGMENT_SHADER);if(I.isContextLost())return void(this.failedToCreate=!0);if(I.shaderSource(te,ce),I.compileShader(te),!I.getShaderParameter(te,I.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${I.getShaderInfoLog(te)}`);I.attachShader(this.program,te);const xe=I.createShader(I.VERTEX_SHADER);if(I.isContextLost())return void(this.failedToCreate=!0);if(I.shaderSource(xe,me),I.compileShader(xe),!I.getShaderParameter(xe,I.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${I.getShaderInfoLog(xe)}`);I.attachShader(this.program,xe),this.attributes={};const be={};this.numAttributes=R.length;for(let ze=0;ze<this.numAttributes;ze++)R[ze]&&(I.bindAttribLocation(this.program,ze,R[ze]),this.attributes[R[ze]]=ze);if(I.linkProgram(this.program),!I.getProgramParameter(this.program,I.LINK_STATUS))throw new Error(`Program failed to link: ${I.getProgramInfoLog(this.program)}`);I.deleteShader(xe),I.deleteShader(te);for(let ze=0;ze<ie.length;ze++){const qe=ie[ze];if(qe&&!be[qe]){const Qe=I.getUniformLocation(this.program,qe);Qe&&(be[qe]=Qe)}}this.fixedUniforms=f(t,be),this.terrainUniforms=((ze,qe)=>({u_depth:new c.aH(ze,qe.u_depth),u_terrain:new c.aH(ze,qe.u_terrain),u_terrain_dim:new c.aI(ze,qe.u_terrain_dim),u_terrain_matrix:new c.aJ(ze,qe.u_terrain_matrix),u_terrain_unpack:new c.aK(ze,qe.u_terrain_unpack),u_terrain_exaggeration:new c.aI(ze,qe.u_terrain_exaggeration)}))(t,be),this.binderUniforms=d?d.getUniforms(t,be):[]}draw(t,a,d,f,_,E,I,k,z,R,O,V,X,Q,ie,le,ce,me){const te=t.gl;if(this.failedToCreate)return;if(t.program.set(this.program),t.setDepthMode(d),t.setStencilMode(f),t.setColorMode(_),t.setCullFace(E),k){t.activeTexture.set(te.TEXTURE2),te.bindTexture(te.TEXTURE_2D,k.depthTexture),t.activeTexture.set(te.TEXTURE3),te.bindTexture(te.TEXTURE_2D,k.texture);for(const be in this.terrainUniforms)this.terrainUniforms[be].set(k[be])}for(const be in this.fixedUniforms)this.fixedUniforms[be].set(I[be]);ie&&ie.setUniforms(t,this.binderUniforms,X,{zoom:Q});let xe=0;switch(a){case te.LINES:xe=2;break;case te.TRIANGLES:xe=3;break;case te.LINE_STRIP:xe=1}for(const be of V.get()){const ze=be.vaos||(be.vaos={});(ze[z]||(ze[z]=new Xc)).bind(t,this,R,ie?ie.getPaintVertexBuffers():[],O,be.vertexOffset,le,ce,me),te.drawElements(a,be.primitiveLength*xe,te.UNSIGNED_SHORT,be.primitiveOffset*xe*2)}}}function fo(y,t,a){const d=1/fn(a,1,t.transform.tileZoom),f=Math.pow(2,a.tileID.overscaledZ),_=a.tileSize*Math.pow(2,t.transform.tileZoom)/f,E=_*(a.tileID.canonical.x+a.tileID.wrap*f),I=_*a.tileID.canonical.y;return{u_image:0,u_texsize:a.imageAtlasTexture.size,u_scale:[d,y.fromScale,y.toScale],u_fade:y.t,u_pixel_coord_upper:[E>>16,I>>16],u_pixel_coord_lower:[65535&E,65535&I]}}const rl=(y,t,a,d)=>{const f=t.style.light,_=f.properties.get("position"),E=[_.x,_.y,_.z],I=function(){var z=new c.A(9);return c.A!=Float32Array&&(z[1]=0,z[2]=0,z[3]=0,z[5]=0,z[6]=0,z[7]=0),z[0]=1,z[4]=1,z[8]=1,z}();f.properties.get("anchor")==="viewport"&&function(z,R){var O=Math.sin(R),V=Math.cos(R);z[0]=V,z[1]=O,z[2]=0,z[3]=-O,z[4]=V,z[5]=0,z[6]=0,z[7]=0,z[8]=1}(I,-t.transform.angle),function(z,R,O){var V=R[0],X=R[1],Q=R[2];z[0]=V*O[0]+X*O[3]+Q*O[6],z[1]=V*O[1]+X*O[4]+Q*O[7],z[2]=V*O[2]+X*O[5]+Q*O[8]}(E,E,I);const k=f.properties.get("color");return{u_matrix:y,u_lightpos:E,u_lightintensity:f.properties.get("intensity"),u_lightcolor:[k.r,k.g,k.b],u_vertical_gradient:+a,u_opacity:d}},Vl=(y,t,a,d,f,_,E)=>c.e(rl(y,t,a,d),fo(_,t,E),{u_height_factor:-Math.pow(2,f.overscaledZ)/E.tileSize/8}),il=y=>({u_matrix:y}),Kc=(y,t,a,d)=>c.e(il(y),fo(a,t,d)),md=(y,t)=>({u_matrix:y,u_world:t}),Yc=(y,t,a,d,f)=>c.e(Kc(y,t,a,d),{u_world:f}),gd=(y,t,a,d)=>{const f=y.transform;let _,E;if(d.paint.get("circle-pitch-alignment")==="map"){const I=fn(a,1,f.zoom);_=!0,E=[I,I]}else _=!1,E=f.pixelsToGLUnits;return{u_camera_to_center_distance:f.cameraToCenterDistance,u_scale_with_map:+(d.paint.get("circle-pitch-scale")==="map"),u_matrix:y.translatePosMatrix(t.posMatrix,a,d.paint.get("circle-translate"),d.paint.get("circle-translate-anchor")),u_pitch_with_map:+_,u_device_pixel_ratio:y.pixelRatio,u_extrude_scale:E}},pa=(y,t,a)=>({u_matrix:y,u_inv_matrix:t,u_camera_to_center_distance:a.cameraToCenterDistance,u_viewport_size:[a.width,a.height]}),ql=(y,t,a=1)=>({u_matrix:y,u_color:t,u_overlay:0,u_overlay_scale:a}),Li=y=>({u_matrix:y}),Ti=(y,t,a,d)=>({u_matrix:y,u_extrude_scale:fn(t,1,a),u_intensity:d}),ju=(y,t,a,d)=>{const f=c.H();c.aP(f,0,y.width,y.height,0,0,1);const _=y.context.gl;return{u_matrix:f,u_world:[_.drawingBufferWidth,_.drawingBufferHeight],u_image:a,u_color_ramp:d,u_opacity:t.paint.get("heatmap-opacity")}};function $u(y,t){const a=Math.pow(2,t.canonical.z),d=t.canonical.y;return[new c.Z(0,d/a).toLngLat().lat,new c.Z(0,(d+1)/a).toLngLat().lat]}const Vu=(y,t,a,d)=>{const f=y.transform;return{u_matrix:vd(y,t,a,d),u_ratio:1/fn(t,1,f.zoom),u_device_pixel_ratio:y.pixelRatio,u_units_to_pixels:[1/f.pixelsToGLUnits[0],1/f.pixelsToGLUnits[1]]}},_d=(y,t,a,d,f)=>c.e(Vu(y,t,a,f),{u_image:0,u_image_height:d}),Uo=(y,t,a,d,f)=>{const _=y.transform,E=yd(t,_);return{u_matrix:vd(y,t,a,f),u_texsize:t.imageAtlasTexture.size,u_ratio:1/fn(t,1,_.zoom),u_device_pixel_ratio:y.pixelRatio,u_image:0,u_scale:[E,d.fromScale,d.toScale],u_fade:d.t,u_units_to_pixels:[1/_.pixelsToGLUnits[0],1/_.pixelsToGLUnits[1]]}},tp=(y,t,a,d,f,_)=>{const E=y.lineAtlas,I=yd(t,y.transform),k=a.layout.get("line-cap")==="round",z=E.getDash(d.from,k),R=E.getDash(d.to,k),O=z.width*f.fromScale,V=R.width*f.toScale;return c.e(Vu(y,t,a,_),{u_patternscale_a:[I/O,-z.height/2],u_patternscale_b:[I/V,-R.height/2],u_sdfgamma:E.width/(256*Math.min(O,V)*y.pixelRatio)/2,u_image:0,u_tex_y_a:z.y,u_tex_y_b:R.y,u_mix:f.t})};function yd(y,t){return 1/fn(y,1,t.tileZoom)}function vd(y,t,a,d){return y.translatePosMatrix(d?d.posMatrix:t.tileID.posMatrix,t,a.paint.get("line-translate"),a.paint.get("line-translate-anchor"))}const np=(y,t,a,d,f)=>{return{u_matrix:y,u_tl_parent:t,u_scale_parent:a,u_buffer_scale:1,u_fade_t:d.mix,u_opacity:d.opacity*f.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:f.paint.get("raster-brightness-min"),u_brightness_high:f.paint.get("raster-brightness-max"),u_saturation_factor:(E=f.paint.get("raster-saturation"),E>0?1-1/(1.001-E):-E),u_contrast_factor:(_=f.paint.get("raster-contrast"),_>0?1/(1-_):1+_),u_spin_weights:rp(f.paint.get("raster-hue-rotate"))};var _,E};function rp(y){y*=Math.PI/180;const t=Math.sin(y),a=Math.cos(y);return[(2*a+1)/3,(-Math.sqrt(3)*t-a+1)/3,(Math.sqrt(3)*t-a+1)/3]}const or=(y,t,a,d,f,_,E,I,k,z,R,O,V,X)=>{const Q=E.transform;return{u_is_size_zoom_constant:+(y==="constant"||y==="source"),u_is_size_feature_constant:+(y==="constant"||y==="camera"),u_size_t:t?t.uSizeT:0,u_size:t?t.uSize:0,u_camera_to_center_distance:Q.cameraToCenterDistance,u_pitch:Q.pitch/360*2*Math.PI,u_rotate_symbol:+a,u_aspect_ratio:Q.width/Q.height,u_fade_change:E.options.fadeDuration?E.symbolFadeChange:1,u_matrix:I,u_label_plane_matrix:k,u_coord_matrix:z,u_is_text:+O,u_pitch_with_map:+d,u_is_along_line:f,u_is_variable_anchor:_,u_texsize:V,u_texture:0,u_translation:R,u_pitched_scale:X}},Gn=(y,t,a,d,f,_,E,I,k,z,R,O,V,X,Q)=>{const ie=E.transform;return c.e(or(y,t,a,d,f,_,E,I,k,z,R,O,V,Q),{u_gamma_scale:d?Math.cos(ie._pitch)*ie.cameraToCenterDistance:1,u_device_pixel_ratio:E.pixelRatio,u_is_halo:+X})},Jc=(y,t,a,d,f,_,E,I,k,z,R,O,V,X)=>c.e(Gn(y,t,a,d,f,_,E,I,k,z,R,!0,O,!0,X),{u_texsize_icon:V,u_texture_icon:1}),qu=(y,t,a)=>({u_matrix:y,u_opacity:t,u_color:a}),Qc=(y,t,a,d,f,_)=>c.e(function(E,I,k,z){const R=k.imageManager.getPattern(E.from.toString()),O=k.imageManager.getPattern(E.to.toString()),{width:V,height:X}=k.imageManager.getPixelSize(),Q=Math.pow(2,z.tileID.overscaledZ),ie=z.tileSize*Math.pow(2,k.transform.tileZoom)/Q,le=ie*(z.tileID.canonical.x+z.tileID.wrap*Q),ce=ie*z.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:R.tl,u_pattern_br_a:R.br,u_pattern_tl_b:O.tl,u_pattern_br_b:O.br,u_texsize:[V,X],u_mix:I.t,u_pattern_size_a:R.displaySize,u_pattern_size_b:O.displaySize,u_scale_a:I.fromScale,u_scale_b:I.toScale,u_tile_units_to_pixels:1/fn(z,1,k.transform.tileZoom),u_pixel_coord_upper:[le>>16,ce>>16],u_pixel_coord_lower:[65535&le,65535&ce]}}(d,_,a,f),{u_matrix:y,u_opacity:t}),eh={fillExtrusion:(y,t)=>({u_matrix:new c.aJ(y,t.u_matrix),u_lightpos:new c.aN(y,t.u_lightpos),u_lightintensity:new c.aI(y,t.u_lightintensity),u_lightcolor:new c.aN(y,t.u_lightcolor),u_vertical_gradient:new c.aI(y,t.u_vertical_gradient),u_opacity:new c.aI(y,t.u_opacity)}),fillExtrusionPattern:(y,t)=>({u_matrix:new c.aJ(y,t.u_matrix),u_lightpos:new c.aN(y,t.u_lightpos),u_lightintensity:new c.aI(y,t.u_lightintensity),u_lightcolor:new c.aN(y,t.u_lightcolor),u_vertical_gradient:new c.aI(y,t.u_vertical_gradient),u_height_factor:new c.aI(y,t.u_height_factor),u_image:new c.aH(y,t.u_image),u_texsize:new c.aO(y,t.u_texsize),u_pixel_coord_upper:new c.aO(y,t.u_pixel_coord_upper),u_pixel_coord_lower:new c.aO(y,t.u_pixel_coord_lower),u_scale:new c.aN(y,t.u_scale),u_fade:new c.aI(y,t.u_fade),u_opacity:new c.aI(y,t.u_opacity)}),fill:(y,t)=>({u_matrix:new c.aJ(y,t.u_matrix)}),fillPattern:(y,t)=>({u_matrix:new c.aJ(y,t.u_matrix),u_image:new c.aH(y,t.u_image),u_texsize:new c.aO(y,t.u_texsize),u_pixel_coord_upper:new c.aO(y,t.u_pixel_coord_upper),u_pixel_coord_lower:new c.aO(y,t.u_pixel_coord_lower),u_scale:new c.aN(y,t.u_scale),u_fade:new c.aI(y,t.u_fade)}),fillOutline:(y,t)=>({u_matrix:new c.aJ(y,t.u_matrix),u_world:new c.aO(y,t.u_world)}),fillOutlinePattern:(y,t)=>({u_matrix:new c.aJ(y,t.u_matrix),u_world:new c.aO(y,t.u_world),u_image:new c.aH(y,t.u_image),u_texsize:new c.aO(y,t.u_texsize),u_pixel_coord_upper:new c.aO(y,t.u_pixel_coord_upper),u_pixel_coord_lower:new c.aO(y,t.u_pixel_coord_lower),u_scale:new c.aN(y,t.u_scale),u_fade:new c.aI(y,t.u_fade)}),circle:(y,t)=>({u_camera_to_center_distance:new c.aI(y,t.u_camera_to_center_distance),u_scale_with_map:new c.aH(y,t.u_scale_with_map),u_pitch_with_map:new c.aH(y,t.u_pitch_with_map),u_extrude_scale:new c.aO(y,t.u_extrude_scale),u_device_pixel_ratio:new c.aI(y,t.u_device_pixel_ratio),u_matrix:new c.aJ(y,t.u_matrix)}),collisionBox:(y,t)=>({u_matrix:new c.aJ(y,t.u_matrix),u_pixel_extrude_scale:new c.aO(y,t.u_pixel_extrude_scale)}),collisionCircle:(y,t)=>({u_matrix:new c.aJ(y,t.u_matrix),u_inv_matrix:new c.aJ(y,t.u_inv_matrix),u_camera_to_center_distance:new c.aI(y,t.u_camera_to_center_distance),u_viewport_size:new c.aO(y,t.u_viewport_size)}),debug:(y,t)=>({u_color:new c.aL(y,t.u_color),u_matrix:new c.aJ(y,t.u_matrix),u_overlay:new c.aH(y,t.u_overlay),u_overlay_scale:new c.aI(y,t.u_overlay_scale)}),clippingMask:(y,t)=>({u_matrix:new c.aJ(y,t.u_matrix)}),heatmap:(y,t)=>({u_extrude_scale:new c.aI(y,t.u_extrude_scale),u_intensity:new c.aI(y,t.u_intensity),u_matrix:new c.aJ(y,t.u_matrix)}),heatmapTexture:(y,t)=>({u_matrix:new c.aJ(y,t.u_matrix),u_world:new c.aO(y,t.u_world),u_image:new c.aH(y,t.u_image),u_color_ramp:new c.aH(y,t.u_color_ramp),u_opacity:new c.aI(y,t.u_opacity)}),hillshade:(y,t)=>({u_matrix:new c.aJ(y,t.u_matrix),u_image:new c.aH(y,t.u_image),u_latrange:new c.aO(y,t.u_latrange),u_light:new c.aO(y,t.u_light),u_shadow:new c.aL(y,t.u_shadow),u_highlight:new c.aL(y,t.u_highlight),u_accent:new c.aL(y,t.u_accent)}),hillshadePrepare:(y,t)=>({u_matrix:new c.aJ(y,t.u_matrix),u_image:new c.aH(y,t.u_image),u_dimension:new c.aO(y,t.u_dimension),u_zoom:new c.aI(y,t.u_zoom),u_unpack:new c.aK(y,t.u_unpack)}),line:(y,t)=>({u_matrix:new c.aJ(y,t.u_matrix),u_ratio:new c.aI(y,t.u_ratio),u_device_pixel_ratio:new c.aI(y,t.u_device_pixel_ratio),u_units_to_pixels:new c.aO(y,t.u_units_to_pixels)}),lineGradient:(y,t)=>({u_matrix:new c.aJ(y,t.u_matrix),u_ratio:new c.aI(y,t.u_ratio),u_device_pixel_ratio:new c.aI(y,t.u_device_pixel_ratio),u_units_to_pixels:new c.aO(y,t.u_units_to_pixels),u_image:new c.aH(y,t.u_image),u_image_height:new c.aI(y,t.u_image_height)}),linePattern:(y,t)=>({u_matrix:new c.aJ(y,t.u_matrix),u_texsize:new c.aO(y,t.u_texsize),u_ratio:new c.aI(y,t.u_ratio),u_device_pixel_ratio:new c.aI(y,t.u_device_pixel_ratio),u_image:new c.aH(y,t.u_image),u_units_to_pixels:new c.aO(y,t.u_units_to_pixels),u_scale:new c.aN(y,t.u_scale),u_fade:new c.aI(y,t.u_fade)}),lineSDF:(y,t)=>({u_matrix:new c.aJ(y,t.u_matrix),u_ratio:new c.aI(y,t.u_ratio),u_device_pixel_ratio:new c.aI(y,t.u_device_pixel_ratio),u_units_to_pixels:new c.aO(y,t.u_units_to_pixels),u_patternscale_a:new c.aO(y,t.u_patternscale_a),u_patternscale_b:new c.aO(y,t.u_patternscale_b),u_sdfgamma:new c.aI(y,t.u_sdfgamma),u_image:new c.aH(y,t.u_image),u_tex_y_a:new c.aI(y,t.u_tex_y_a),u_tex_y_b:new c.aI(y,t.u_tex_y_b),u_mix:new c.aI(y,t.u_mix)}),raster:(y,t)=>({u_matrix:new c.aJ(y,t.u_matrix),u_tl_parent:new c.aO(y,t.u_tl_parent),u_scale_parent:new c.aI(y,t.u_scale_parent),u_buffer_scale:new c.aI(y,t.u_buffer_scale),u_fade_t:new c.aI(y,t.u_fade_t),u_opacity:new c.aI(y,t.u_opacity),u_image0:new c.aH(y,t.u_image0),u_image1:new c.aH(y,t.u_image1),u_brightness_low:new c.aI(y,t.u_brightness_low),u_brightness_high:new c.aI(y,t.u_brightness_high),u_saturation_factor:new c.aI(y,t.u_saturation_factor),u_contrast_factor:new c.aI(y,t.u_contrast_factor),u_spin_weights:new c.aN(y,t.u_spin_weights)}),symbolIcon:(y,t)=>({u_is_size_zoom_constant:new c.aH(y,t.u_is_size_zoom_constant),u_is_size_feature_constant:new c.aH(y,t.u_is_size_feature_constant),u_size_t:new c.aI(y,t.u_size_t),u_size:new c.aI(y,t.u_size),u_camera_to_center_distance:new c.aI(y,t.u_camera_to_center_distance),u_pitch:new c.aI(y,t.u_pitch),u_rotate_symbol:new c.aH(y,t.u_rotate_symbol),u_aspect_ratio:new c.aI(y,t.u_aspect_ratio),u_fade_change:new c.aI(y,t.u_fade_change),u_matrix:new c.aJ(y,t.u_matrix),u_label_plane_matrix:new c.aJ(y,t.u_label_plane_matrix),u_coord_matrix:new c.aJ(y,t.u_coord_matrix),u_is_text:new c.aH(y,t.u_is_text),u_pitch_with_map:new c.aH(y,t.u_pitch_with_map),u_is_along_line:new c.aH(y,t.u_is_along_line),u_is_variable_anchor:new c.aH(y,t.u_is_variable_anchor),u_texsize:new c.aO(y,t.u_texsize),u_texture:new c.aH(y,t.u_texture),u_translation:new c.aO(y,t.u_translation),u_pitched_scale:new c.aI(y,t.u_pitched_scale)}),symbolSDF:(y,t)=>({u_is_size_zoom_constant:new c.aH(y,t.u_is_size_zoom_constant),u_is_size_feature_constant:new c.aH(y,t.u_is_size_feature_constant),u_size_t:new c.aI(y,t.u_size_t),u_size:new c.aI(y,t.u_size),u_camera_to_center_distance:new c.aI(y,t.u_camera_to_center_distance),u_pitch:new c.aI(y,t.u_pitch),u_rotate_symbol:new c.aH(y,t.u_rotate_symbol),u_aspect_ratio:new c.aI(y,t.u_aspect_ratio),u_fade_change:new c.aI(y,t.u_fade_change),u_matrix:new c.aJ(y,t.u_matrix),u_label_plane_matrix:new c.aJ(y,t.u_label_plane_matrix),u_coord_matrix:new c.aJ(y,t.u_coord_matrix),u_is_text:new c.aH(y,t.u_is_text),u_pitch_with_map:new c.aH(y,t.u_pitch_with_map),u_is_along_line:new c.aH(y,t.u_is_along_line),u_is_variable_anchor:new c.aH(y,t.u_is_variable_anchor),u_texsize:new c.aO(y,t.u_texsize),u_texture:new c.aH(y,t.u_texture),u_gamma_scale:new c.aI(y,t.u_gamma_scale),u_device_pixel_ratio:new c.aI(y,t.u_device_pixel_ratio),u_is_halo:new c.aH(y,t.u_is_halo),u_translation:new c.aO(y,t.u_translation),u_pitched_scale:new c.aI(y,t.u_pitched_scale)}),symbolTextAndIcon:(y,t)=>({u_is_size_zoom_constant:new c.aH(y,t.u_is_size_zoom_constant),u_is_size_feature_constant:new c.aH(y,t.u_is_size_feature_constant),u_size_t:new c.aI(y,t.u_size_t),u_size:new c.aI(y,t.u_size),u_camera_to_center_distance:new c.aI(y,t.u_camera_to_center_distance),u_pitch:new c.aI(y,t.u_pitch),u_rotate_symbol:new c.aH(y,t.u_rotate_symbol),u_aspect_ratio:new c.aI(y,t.u_aspect_ratio),u_fade_change:new c.aI(y,t.u_fade_change),u_matrix:new c.aJ(y,t.u_matrix),u_label_plane_matrix:new c.aJ(y,t.u_label_plane_matrix),u_coord_matrix:new c.aJ(y,t.u_coord_matrix),u_is_text:new c.aH(y,t.u_is_text),u_pitch_with_map:new c.aH(y,t.u_pitch_with_map),u_is_along_line:new c.aH(y,t.u_is_along_line),u_is_variable_anchor:new c.aH(y,t.u_is_variable_anchor),u_texsize:new c.aO(y,t.u_texsize),u_texsize_icon:new c.aO(y,t.u_texsize_icon),u_texture:new c.aH(y,t.u_texture),u_texture_icon:new c.aH(y,t.u_texture_icon),u_gamma_scale:new c.aI(y,t.u_gamma_scale),u_device_pixel_ratio:new c.aI(y,t.u_device_pixel_ratio),u_is_halo:new c.aH(y,t.u_is_halo),u_translation:new c.aO(y,t.u_translation),u_pitched_scale:new c.aI(y,t.u_pitched_scale)}),background:(y,t)=>({u_matrix:new c.aJ(y,t.u_matrix),u_opacity:new c.aI(y,t.u_opacity),u_color:new c.aL(y,t.u_color)}),backgroundPattern:(y,t)=>({u_matrix:new c.aJ(y,t.u_matrix),u_opacity:new c.aI(y,t.u_opacity),u_image:new c.aH(y,t.u_image),u_pattern_tl_a:new c.aO(y,t.u_pattern_tl_a),u_pattern_br_a:new c.aO(y,t.u_pattern_br_a),u_pattern_tl_b:new c.aO(y,t.u_pattern_tl_b),u_pattern_br_b:new c.aO(y,t.u_pattern_br_b),u_texsize:new c.aO(y,t.u_texsize),u_mix:new c.aI(y,t.u_mix),u_pattern_size_a:new c.aO(y,t.u_pattern_size_a),u_pattern_size_b:new c.aO(y,t.u_pattern_size_b),u_scale_a:new c.aI(y,t.u_scale_a),u_scale_b:new c.aI(y,t.u_scale_b),u_pixel_coord_upper:new c.aO(y,t.u_pixel_coord_upper),u_pixel_coord_lower:new c.aO(y,t.u_pixel_coord_lower),u_tile_units_to_pixels:new c.aI(y,t.u_tile_units_to_pixels)}),terrain:(y,t)=>({u_matrix:new c.aJ(y,t.u_matrix),u_texture:new c.aH(y,t.u_texture),u_ele_delta:new c.aI(y,t.u_ele_delta),u_fog_matrix:new c.aJ(y,t.u_fog_matrix),u_fog_color:new c.aL(y,t.u_fog_color),u_fog_ground_blend:new c.aI(y,t.u_fog_ground_blend),u_fog_ground_blend_opacity:new c.aI(y,t.u_fog_ground_blend_opacity),u_horizon_color:new c.aL(y,t.u_horizon_color),u_horizon_fog_blend:new c.aI(y,t.u_horizon_fog_blend)}),terrainDepth:(y,t)=>({u_matrix:new c.aJ(y,t.u_matrix),u_ele_delta:new c.aI(y,t.u_ele_delta)}),terrainCoords:(y,t)=>({u_matrix:new c.aJ(y,t.u_matrix),u_texture:new c.aH(y,t.u_texture),u_terrain_coords_id:new c.aI(y,t.u_terrain_coords_id),u_ele_delta:new c.aI(y,t.u_ele_delta)}),sky:(y,t)=>({u_sky_color:new c.aL(y,t.u_sky_color),u_horizon_color:new c.aL(y,t.u_horizon_color),u_horizon:new c.aI(y,t.u_horizon),u_sky_horizon_blend:new c.aI(y,t.u_sky_horizon_blend)})};class Ys{constructor(t,a,d){this.context=t;const f=t.gl;this.buffer=f.createBuffer(),this.dynamicDraw=!!d,this.context.unbindVAO(),t.bindElementBuffer.set(this.buffer),f.bufferData(f.ELEMENT_ARRAY_BUFFER,a.arrayBuffer,this.dynamicDraw?f.DYNAMIC_DRAW:f.STATIC_DRAW),this.dynamicDraw||delete a.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(t){const a=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),a.bufferSubData(a.ELEMENT_ARRAY_BUFFER,0,t.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const ip={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Zu{constructor(t,a,d,f){this.length=a.length,this.attributes=d,this.itemSize=a.bytesPerElement,this.dynamicDraw=f,this.context=t;const _=t.gl;this.buffer=_.createBuffer(),t.bindVertexBuffer.set(this.buffer),_.bufferData(_.ARRAY_BUFFER,a.arrayBuffer,this.dynamicDraw?_.DYNAMIC_DRAW:_.STATIC_DRAW),this.dynamicDraw||delete a.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(t){if(t.length!==this.length)throw new Error(`Length of new data is ${t.length}, which doesn't match current length of ${this.length}`);const a=this.context.gl;this.bind(),a.bufferSubData(a.ARRAY_BUFFER,0,t.arrayBuffer)}enableAttributes(t,a){for(let d=0;d<this.attributes.length;d++){const f=a.attributes[this.attributes[d].name];f!==void 0&&t.enableVertexAttribArray(f)}}setVertexAttribPointers(t,a,d){for(let f=0;f<this.attributes.length;f++){const _=this.attributes[f],E=a.attributes[_.name];E!==void 0&&t.vertexAttribPointer(E,_.components,t[ip[_.type]],!1,this.itemSize,_.offset+this.itemSize*(d||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const ma=new WeakMap;function pr(y){var t;if(ma.has(y))return ma.get(y);{const a=(t=y.getParameter(y.VERSION))===null||t===void 0?void 0:t.startsWith("WebGL 2.0");return ma.set(y,a),a}}class Mn{constructor(t){this.gl=t.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(t){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class Js extends Mn{getDefault(){return c.aM.transparent}set(t){const a=this.current;(t.r!==a.r||t.g!==a.g||t.b!==a.b||t.a!==a.a||this.dirty)&&(this.gl.clearColor(t.r,t.g,t.b,t.a),this.current=t,this.dirty=!1)}}class xd extends Mn{getDefault(){return 1}set(t){(t!==this.current||this.dirty)&&(this.gl.clearDepth(t),this.current=t,this.dirty=!1)}}class jo extends Mn{getDefault(){return 0}set(t){(t!==this.current||this.dirty)&&(this.gl.clearStencil(t),this.current=t,this.dirty=!1)}}class ls extends Mn{getDefault(){return[!0,!0,!0,!0]}set(t){const a=this.current;(t[0]!==a[0]||t[1]!==a[1]||t[2]!==a[2]||t[3]!==a[3]||this.dirty)&&(this.gl.colorMask(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)}}class th extends Mn{getDefault(){return!0}set(t){(t!==this.current||this.dirty)&&(this.gl.depthMask(t),this.current=t,this.dirty=!1)}}class wd extends Mn{getDefault(){return 255}set(t){(t!==this.current||this.dirty)&&(this.gl.stencilMask(t),this.current=t,this.dirty=!1)}}class nh extends Mn{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(t){const a=this.current;(t.func!==a.func||t.ref!==a.ref||t.mask!==a.mask||this.dirty)&&(this.gl.stencilFunc(t.func,t.ref,t.mask),this.current=t,this.dirty=!1)}}class Wu extends Mn{getDefault(){const t=this.gl;return[t.KEEP,t.KEEP,t.KEEP]}set(t){const a=this.current;(t[0]!==a[0]||t[1]!==a[1]||t[2]!==a[2]||this.dirty)&&(this.gl.stencilOp(t[0],t[1],t[2]),this.current=t,this.dirty=!1)}}class rh extends Mn{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const a=this.gl;t?a.enable(a.STENCIL_TEST):a.disable(a.STENCIL_TEST),this.current=t,this.dirty=!1}}class ih extends Mn{getDefault(){return[0,1]}set(t){const a=this.current;(t[0]!==a[0]||t[1]!==a[1]||this.dirty)&&(this.gl.depthRange(t[0],t[1]),this.current=t,this.dirty=!1)}}class Ri extends Mn{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const a=this.gl;t?a.enable(a.DEPTH_TEST):a.disable(a.DEPTH_TEST),this.current=t,this.dirty=!1}}class bd extends Mn{getDefault(){return this.gl.LESS}set(t){(t!==this.current||this.dirty)&&(this.gl.depthFunc(t),this.current=t,this.dirty=!1)}}class Kr extends Mn{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const a=this.gl;t?a.enable(a.BLEND):a.disable(a.BLEND),this.current=t,this.dirty=!1}}class Sd extends Mn{getDefault(){const t=this.gl;return[t.ONE,t.ZERO]}set(t){const a=this.current;(t[0]!==a[0]||t[1]!==a[1]||this.dirty)&&(this.gl.blendFunc(t[0],t[1]),this.current=t,this.dirty=!1)}}class Td extends Mn{getDefault(){return c.aM.transparent}set(t){const a=this.current;(t.r!==a.r||t.g!==a.g||t.b!==a.b||t.a!==a.a||this.dirty)&&(this.gl.blendColor(t.r,t.g,t.b,t.a),this.current=t,this.dirty=!1)}}class po extends Mn{getDefault(){return this.gl.FUNC_ADD}set(t){(t!==this.current||this.dirty)&&(this.gl.blendEquation(t),this.current=t,this.dirty=!1)}}class $o extends Mn{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const a=this.gl;t?a.enable(a.CULL_FACE):a.disable(a.CULL_FACE),this.current=t,this.dirty=!1}}class sh extends Mn{getDefault(){return this.gl.BACK}set(t){(t!==this.current||this.dirty)&&(this.gl.cullFace(t),this.current=t,this.dirty=!1)}}class ir extends Mn{getDefault(){return this.gl.CCW}set(t){(t!==this.current||this.dirty)&&(this.gl.frontFace(t),this.current=t,this.dirty=!1)}}class Vo extends Mn{getDefault(){return null}set(t){(t!==this.current||this.dirty)&&(this.gl.useProgram(t),this.current=t,this.dirty=!1)}}class oh extends Mn{getDefault(){return this.gl.TEXTURE0}set(t){(t!==this.current||this.dirty)&&(this.gl.activeTexture(t),this.current=t,this.dirty=!1)}}class Ed extends Mn{getDefault(){const t=this.gl;return[0,0,t.drawingBufferWidth,t.drawingBufferHeight]}set(t){const a=this.current;(t[0]!==a[0]||t[1]!==a[1]||t[2]!==a[2]||t[3]!==a[3]||this.dirty)&&(this.gl.viewport(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)}}class Gu extends Mn{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const a=this.gl;a.bindFramebuffer(a.FRAMEBUFFER,t),this.current=t,this.dirty=!1}}class Cd extends Mn{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const a=this.gl;a.bindRenderbuffer(a.RENDERBUFFER,t),this.current=t,this.dirty=!1}}class ah extends Mn{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const a=this.gl;a.bindTexture(a.TEXTURE_2D,t),this.current=t,this.dirty=!1}}class Id extends Mn{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const a=this.gl;a.bindBuffer(a.ARRAY_BUFFER,t),this.current=t,this.dirty=!1}}class Zl extends Mn{getDefault(){return null}set(t){const a=this.gl;a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,t),this.current=t,this.dirty=!1}}class us extends Mn{getDefault(){return null}set(t){var a;if(t===this.current&&!this.dirty)return;const d=this.gl;pr(d)?d.bindVertexArray(t):(a=d.getExtension("OES_vertex_array_object"))===null||a===void 0||a.bindVertexArrayOES(t),this.current=t,this.dirty=!1}}class qo extends Mn{getDefault(){return 4}set(t){if(t===this.current&&!this.dirty)return;const a=this.gl;a.pixelStorei(a.UNPACK_ALIGNMENT,t),this.current=t,this.dirty=!1}}class lh extends Mn{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const a=this.gl;a.pixelStorei(a.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t),this.current=t,this.dirty=!1}}class Hu extends Mn{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const a=this.gl;a.pixelStorei(a.UNPACK_FLIP_Y_WEBGL,t),this.current=t,this.dirty=!1}}class Wl extends Mn{constructor(t,a){super(t),this.context=t,this.parent=a}getDefault(){return null}}class Gl extends Wl{setDirty(){this.dirty=!0}set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const a=this.gl;a.framebufferTexture2D(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.TEXTURE_2D,t,0),this.current=t,this.dirty=!1}}class mo extends Wl{set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const a=this.gl;a.framebufferRenderbuffer(a.FRAMEBUFFER,a.DEPTH_ATTACHMENT,a.RENDERBUFFER,t),this.current=t,this.dirty=!1}}class Xu extends Wl{set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const a=this.gl;a.framebufferRenderbuffer(a.FRAMEBUFFER,a.DEPTH_STENCIL_ATTACHMENT,a.RENDERBUFFER,t),this.current=t,this.dirty=!1}}class sp{constructor(t,a,d,f,_){this.context=t,this.width=a,this.height=d;const E=t.gl,I=this.framebuffer=E.createFramebuffer();if(this.colorAttachment=new Gl(t,I),f)this.depthAttachment=_?new Xu(t,I):new mo(t,I);else if(_)throw new Error("Stencil cannot be set without depth");if(E.checkFramebufferStatus(E.FRAMEBUFFER)!==E.FRAMEBUFFER_COMPLETE)throw new Error("Framebuffer is not complete")}destroy(){const t=this.context.gl,a=this.colorAttachment.get();if(a&&t.deleteTexture(a),this.depthAttachment){const d=this.depthAttachment.get();d&&t.deleteRenderbuffer(d)}t.deleteFramebuffer(this.framebuffer)}}class mr{constructor(t,a,d){this.blendFunction=t,this.blendColor=a,this.mask=d}}mr.Replace=[1,0],mr.disabled=new mr(mr.Replace,c.aM.transparent,[!1,!1,!1,!1]),mr.unblended=new mr(mr.Replace,c.aM.transparent,[!0,!0,!0,!0]),mr.alphaBlended=new mr([1,771],c.aM.transparent,[!0,!0,!0,!0]);class uh{constructor(t){var a,d;if(this.gl=t,this.clearColor=new Js(this),this.clearDepth=new xd(this),this.clearStencil=new jo(this),this.colorMask=new ls(this),this.depthMask=new th(this),this.stencilMask=new wd(this),this.stencilFunc=new nh(this),this.stencilOp=new Wu(this),this.stencilTest=new rh(this),this.depthRange=new ih(this),this.depthTest=new Ri(this),this.depthFunc=new bd(this),this.blend=new Kr(this),this.blendFunc=new Sd(this),this.blendColor=new Td(this),this.blendEquation=new po(this),this.cullFace=new $o(this),this.cullFaceSide=new sh(this),this.frontFace=new ir(this),this.program=new Vo(this),this.activeTexture=new oh(this),this.viewport=new Ed(this),this.bindFramebuffer=new Gu(this),this.bindRenderbuffer=new Cd(this),this.bindTexture=new ah(this),this.bindVertexBuffer=new Id(this),this.bindElementBuffer=new Zl(this),this.bindVertexArray=new us(this),this.pixelStoreUnpack=new qo(this),this.pixelStoreUnpackPremultiplyAlpha=new lh(this),this.pixelStoreUnpackFlipY=new Hu(this),this.extTextureFilterAnisotropic=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=t.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=t.getParameter(t.MAX_TEXTURE_SIZE),pr(t)){this.HALF_FLOAT=t.HALF_FLOAT;const f=t.getExtension("EXT_color_buffer_half_float");this.RGBA16F=(a=t.RGBA16F)!==null&&a!==void 0?a:f==null?void 0:f.RGBA16F_EXT,this.RGB16F=(d=t.RGB16F)!==null&&d!==void 0?d:f==null?void 0:f.RGB16F_EXT,t.getExtension("EXT_color_buffer_float")}else{t.getExtension("EXT_color_buffer_half_float"),t.getExtension("OES_texture_half_float_linear");const f=t.getExtension("OES_texture_half_float");this.HALF_FLOAT=f==null?void 0:f.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(t,a){return new Ys(this,t,a)}createVertexBuffer(t,a,d){return new Zu(this,t,a,d)}createRenderbuffer(t,a,d){const f=this.gl,_=f.createRenderbuffer();return this.bindRenderbuffer.set(_),f.renderbufferStorage(f.RENDERBUFFER,t,a,d),this.bindRenderbuffer.set(null),_}createFramebuffer(t,a,d,f){return new sp(this,t,a,d,f)}clear({color:t,depth:a,stencil:d}){const f=this.gl;let _=0;t&&(_|=f.COLOR_BUFFER_BIT,this.clearColor.set(t),this.colorMask.set([!0,!0,!0,!0])),a!==void 0&&(_|=f.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(a),this.depthMask.set(!0)),d!==void 0&&(_|=f.STENCIL_BUFFER_BIT,this.clearStencil.set(d),this.stencilMask.set(255)),f.clear(_)}setCullFace(t){t.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(t.mode),this.frontFace.set(t.frontFace))}setDepthMode(t){t.func!==this.gl.ALWAYS||t.mask?(this.depthTest.set(!0),this.depthFunc.set(t.func),this.depthMask.set(t.mask),this.depthRange.set(t.range)):this.depthTest.set(!1)}setStencilMode(t){t.test.func!==this.gl.ALWAYS||t.mask?(this.stencilTest.set(!0),this.stencilMask.set(t.mask),this.stencilOp.set([t.fail,t.depthFail,t.pass]),this.stencilFunc.set({func:t.test.func,ref:t.ref,mask:t.test.mask})):this.stencilTest.set(!1)}setColorMode(t){c.aE(t.blendFunction,mr.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(t.blendFunction),this.blendColor.set(t.blendColor)),this.colorMask.set(t.mask)}createVertexArray(){var t;return pr(this.gl)?this.gl.createVertexArray():(t=this.gl.getExtension("OES_vertex_array_object"))===null||t===void 0?void 0:t.createVertexArrayOES()}deleteVertexArray(t){var a;return pr(this.gl)?this.gl.deleteVertexArray(t):(a=this.gl.getExtension("OES_vertex_array_object"))===null||a===void 0?void 0:a.deleteVertexArrayOES(t)}unbindVAO(){this.bindVertexArray.set(null)}}class an{constructor(t,a,d){this.func=t,this.mask=a,this.range=d}}an.ReadOnly=!1,an.ReadWrite=!0,an.disabled=new an(519,an.ReadOnly,[0,1]);const Hl=7680;class pn{constructor(t,a,d,f,_,E){this.test=t,this.ref=a,this.mask=d,this.fail=f,this.depthFail=_,this.pass=E}}pn.disabled=new pn({func:519,mask:0},0,0,Hl,Hl,Hl);class Un{constructor(t,a,d){this.enable=t,this.mode=a,this.frontFace=d}}let Rs;function sl(y,t,a,d,f){const _=y.context,E=_.gl,I=y.useProgram("collisionBox"),k=[];let z=0,R=0;for(let ce=0;ce<d.length;ce++){const me=d[ce],te=t.getTile(me).getBucket(a);if(!te)continue;const xe=f?te.textCollisionBox:te.iconCollisionBox,be=te.collisionCircleArray;if(be.length>0){const ze=c.H();c.aQ(ze,te.placementInvProjMatrix,y.transform.glCoordMatrix),c.aQ(ze,ze,te.placementViewportMatrix),k.push({circleArray:be,circleOffset:R,transform:me.posMatrix,invTransform:ze,coord:me}),z+=be.length/4,R=z}xe&&I.draw(_,E.LINES,an.disabled,pn.disabled,y.colorModeForRenderPass(),Un.disabled,{u_matrix:me.posMatrix,u_pixel_extrude_scale:[1/(O=y.transform).width,1/O.height]},y.style.map.terrain&&y.style.map.terrain.getTerrainData(me),a.id,xe.layoutVertexBuffer,xe.indexBuffer,xe.segments,null,y.transform.zoom,null,null,xe.collisionVertexBuffer)}var O;if(!f||!k.length)return;const V=y.useProgram("collisionCircle"),X=new c.aR;X.resize(4*z),X._trim();let Q=0;for(const ce of k)for(let me=0;me<ce.circleArray.length/4;me++){const te=4*me,xe=ce.circleArray[te+0],be=ce.circleArray[te+1],ze=ce.circleArray[te+2],qe=ce.circleArray[te+3];X.emplace(Q++,xe,be,ze,qe,0),X.emplace(Q++,xe,be,ze,qe,1),X.emplace(Q++,xe,be,ze,qe,2),X.emplace(Q++,xe,be,ze,qe,3)}(!Rs||Rs.length<2*z)&&(Rs=function(ce){const me=2*ce,te=new c.aT;te.resize(me),te._trim();for(let xe=0;xe<me;xe++){const be=6*xe;te.uint16[be+0]=4*xe+0,te.uint16[be+1]=4*xe+1,te.uint16[be+2]=4*xe+2,te.uint16[be+3]=4*xe+2,te.uint16[be+4]=4*xe+3,te.uint16[be+5]=4*xe+0}return te}(z));const ie=_.createIndexBuffer(Rs,!0),le=_.createVertexBuffer(X,c.aS.members,!0);for(const ce of k){const me=pa(ce.transform,ce.invTransform,y.transform);V.draw(_,E.TRIANGLES,an.disabled,pn.disabled,y.colorModeForRenderPass(),Un.disabled,me,y.style.map.terrain&&y.style.map.terrain.getTerrainData(ce.coord),a.id,le,ie,c.a0.simpleSegment(0,2*ce.circleOffset,ce.circleArray.length,ce.circleArray.length/2),null,y.transform.zoom,null,null,null)}le.destroy(),ie.destroy()}Un.disabled=new Un(!1,1029,2305),Un.backCCW=new Un(!0,1029,2305);const ol=c.an(new Float32Array(16));function ch(y,t,a,d,f,_){const{horizontalAlign:E,verticalAlign:I}=c.au(y);return new c.P((-(E-.5)*t/f+d[0])*_,(-(I-.5)*a/f+d[1])*_)}function ga(y,t,a,d,f,_){const E=t.tileAnchorPoint.add(new c.P(t.translation[0],t.translation[1]));if(t.pitchWithMap){let I=d.mult(_);a||(I=I.rotate(-f));const k=E.add(I);return ae(k.x,k.y,t.labelPlaneMatrix,t.getElevation).point}if(a){const I=Be(t.tileAnchorPoint.x+1,t.tileAnchorPoint.y,t).point.sub(y),k=Math.atan(I.y/I.x)+(I.x<0?Math.PI:0);return y.add(d.rotate(k))}return y.add(d)}function al(y,t,a,d,f,_,E,I,k,z,R,O,V,X){const Q=y.text.placedSymbolArray,ie=y.text.dynamicLayoutVertexArray,le=y.icon.dynamicLayoutVertexArray,ce={};ie.clear();for(let me=0;me<Q.length;me++){const te=Q.get(me),xe=te.hidden||!te.crossTileID||y.allowVerticalPlacement&&!te.placedOrientation?null:d[te.crossTileID];if(xe){const be=new c.P(te.anchorX,te.anchorY),ze={getElevation:X,width:f.width,height:f.height,labelPlaneMatrix:_,lineVertexArray:null,pitchWithMap:a,projection:R,projectionCache:null,tileAnchorPoint:be,translation:O,unwrappedTileID:V},qe=a?ae(be.x,be.y,E,X):Be(be.x,be.y,ze),Qe=N(f.cameraToCenterDistance,qe.signedDistanceFromCamera);let at=c.ai(y.textSizeData,k,te)*Qe/c.ap;a&&(at*=y.tilePixelRatio/I);const{width:pt,height:st,anchor:ot,textOffset:wt,textBoxScale:Wt}=xe,ht=ch(ot,pt,st,wt,Wt,at),tt=R.getPitchedTextCorrection(f,be.add(new c.P(O[0],O[1])),V),jt=ga(qe.point,ze,t,ht,f.angle,tt),sr=y.allowVerticalPlacement&&te.placedOrientation===c.ah.vertical?Math.PI/2:0;for(let $t=0;$t<te.numGlyphs;$t++)c.aj(ie,jt,sr);z&&te.associatedIconIndex>=0&&(ce[te.associatedIconIndex]={shiftedAnchor:jt,angle:sr})}else Lt(te.numGlyphs,ie)}if(z){le.clear();const me=y.icon.placedSymbolArray;for(let te=0;te<me.length;te++){const xe=me.get(te);if(xe.hidden)Lt(xe.numGlyphs,le);else{const be=ce[te];if(be)for(let ze=0;ze<xe.numGlyphs;ze++)c.aj(le,be.shiftedAnchor,be.angle);else Lt(xe.numGlyphs,le)}}y.icon.dynamicLayoutVertexBuffer.updateData(le)}y.text.dynamicLayoutVertexBuffer.updateData(ie)}function cs(y,t,a){return a.iconsInText&&t?"symbolTextAndIcon":y?"symbolSDF":"symbolIcon"}function hh(y,t,a,d,f,_,E,I,k,z,R,O){const V=y.context,X=V.gl,Q=y.transform,ie=fa(),le=I==="map",ce=k==="map",me=I!=="viewport"&&a.layout.get("symbol-placement")!=="point",te=le&&!ce&&!me,xe=!ce&&me,be=!a.layout.get("symbol-sort-key").isConstant();let ze=!1;const qe=y.depthModeForSublayer(0,an.ReadOnly),Qe=a._unevaluatedLayout.hasValue("text-variable-anchor")||a._unevaluatedLayout.hasValue("text-variable-anchor-offset"),at=[],pt=ie.getCircleRadiusCorrection(Q);for(const st of d){const ot=t.getTile(st),wt=ot.getBucket(a);if(!wt)continue;const Wt=f?wt.text:wt.icon;if(!Wt||!Wt.segments.get().length||!Wt.hasVisibleVertices)continue;const ht=Wt.programConfigurations.get(a.id),tt=f||wt.sdfIcons,jt=f?wt.textSizeData:wt.iconSizeData,sr=ce||Q.pitch!==0,$t=y.useProgram(cs(tt,f,wt),ht),un=c.ag(jt,Q.zoom),Xn=y.style.map.terrain&&y.style.map.terrain.getTerrainData(st);let Cr,ps,hn,fi,Ci=[0,0],pi=null;if(f)ps=ot.glyphAtlasTexture,hn=X.LINEAR,Cr=ot.glyphAtlasTexture.size,wt.iconsInText&&(Ci=ot.imageAtlasTexture.size,pi=ot.imageAtlasTexture,fi=sr||y.options.rotating||y.options.zooming||jt.kind==="composite"||jt.kind==="camera"?X.LINEAR:X.NEAREST);else{const gn=a.layout.get("icon-size").constantOr(0)!==1||wt.iconsNeedLinear;ps=ot.imageAtlasTexture,hn=tt||y.options.rotating||y.options.zooming||gn||sr?X.LINEAR:X.NEAREST,Cr=ot.imageAtlasTexture.size}const Ii=fn(ot,1,y.transform.zoom),ms=xe?st.posMatrix:ol,xl=co(ms,ce,le,y.transform,Ii),Ko=Ds(ms,ce,le,y.transform,Ii),Ma=Ds(st.posMatrix,ce,le,y.transform,Ii),gs=ie.translatePosition(y.transform,ot,_,E),ac=Qe&&wt.hasTextData(),za=a.layout.get("icon-text-fit")!=="none"&&ac&&wt.hasIconData();if(me){const gn=y.style.map.terrain?(wl,Yo)=>y.style.map.terrain.getElevation(st,wl,Yo):null,bo=a.layout.get("text-rotation-alignment")==="map";K(wt,st.posMatrix,y,f,xl,Ma,ce,z,bo,ie,st.toUnwrapped(),Q.width,Q.height,gs,gn)}const _s=st.posMatrix,ys=f&&Qe||za,eo=me||ys?ol:xl,vs=Ko,ii=tt&&a.paint.get(f?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let mi;mi=tt?wt.iconsInText?Jc(jt.kind,un,te,ce,me,ys,y,_s,eo,vs,gs,Cr,Ci,pt):Gn(jt.kind,un,te,ce,me,ys,y,_s,eo,vs,gs,f,Cr,!0,pt):or(jt.kind,un,te,ce,me,ys,y,_s,eo,vs,gs,f,Cr,pt);const Yi={program:$t,buffers:Wt,uniformValues:mi,atlasTexture:ps,atlasTextureIcon:pi,atlasInterpolation:hn,atlasInterpolationIcon:fi,isSDF:tt,hasHalo:ii};if(be&&wt.canOverlap){ze=!0;const gn=Wt.segments.get();for(const bo of gn)at.push({segments:new c.a0([bo]),sortKey:bo.sortKey,state:Yi,terrainData:Xn})}else at.push({segments:Wt.segments,sortKey:0,state:Yi,terrainData:Xn})}ze&&at.sort((st,ot)=>st.sortKey-ot.sortKey);for(const st of at){const ot=st.state;if(V.activeTexture.set(X.TEXTURE0),ot.atlasTexture.bind(ot.atlasInterpolation,X.CLAMP_TO_EDGE),ot.atlasTextureIcon&&(V.activeTexture.set(X.TEXTURE1),ot.atlasTextureIcon&&ot.atlasTextureIcon.bind(ot.atlasInterpolationIcon,X.CLAMP_TO_EDGE)),ot.isSDF){const wt=ot.uniformValues;ot.hasHalo&&(wt.u_is_halo=1,Zo(ot.buffers,st.segments,a,y,ot.program,qe,R,O,wt,st.terrainData)),wt.u_is_halo=0}Zo(ot.buffers,st.segments,a,y,ot.program,qe,R,O,ot.uniformValues,st.terrainData)}}function Zo(y,t,a,d,f,_,E,I,k,z){const R=d.context;f.draw(R,R.gl.TRIANGLES,_,E,I,Un.disabled,k,z,a.id,y.layoutVertexBuffer,y.indexBuffer,t,a.paint,d.transform.zoom,y.programConfigurations.get(a.id),y.dynamicLayoutVertexBuffer,y.opacityVertexBuffer)}function dh(y,t,a,d){const f=y.context,_=f.gl,E=pn.disabled,I=new mr([_.ONE,_.ONE],c.aM.transparent,[!0,!0,!0,!0]),k=t.getBucket(a);if(!k)return;const z=d.key;let R=a.heatmapFbos.get(z);R||(R=ya(f,t.tileSize,t.tileSize),a.heatmapFbos.set(z,R)),f.bindFramebuffer.set(R.framebuffer),f.viewport.set([0,0,t.tileSize,t.tileSize]),f.clear({color:c.aM.transparent});const O=k.programConfigurations.get(a.id),V=y.useProgram("heatmap",O),X=y.style.map.terrain.getTerrainData(d);V.draw(f,_.TRIANGLES,an.disabled,E,I,Un.disabled,Ti(d.posMatrix,t,y.transform.zoom,a.paint.get("heatmap-intensity")),X,a.id,k.layoutVertexBuffer,k.indexBuffer,k.segments,a.paint,y.transform.zoom,O)}function _a(y,t,a){const d=y.context,f=d.gl;d.setColorMode(y.colorModeForRenderPass());const _=ll(d,t),E=a.key,I=t.heatmapFbos.get(E);I&&(d.activeTexture.set(f.TEXTURE0),f.bindTexture(f.TEXTURE_2D,I.colorAttachment.get()),d.activeTexture.set(f.TEXTURE1),_.bind(f.LINEAR,f.CLAMP_TO_EDGE),y.useProgram("heatmapTexture").draw(d,f.TRIANGLES,an.disabled,pn.disabled,y.colorModeForRenderPass(),Un.disabled,ju(y,t,0,1),null,t.id,y.rasterBoundsBuffer,y.quadTriangleIndexBuffer,y.rasterBoundsSegments,t.paint,y.transform.zoom),I.destroy(),t.heatmapFbos.delete(E))}function ya(y,t,a){var d,f;const _=y.gl,E=_.createTexture();_.bindTexture(_.TEXTURE_2D,E),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_WRAP_S,_.CLAMP_TO_EDGE),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_WRAP_T,_.CLAMP_TO_EDGE),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_MIN_FILTER,_.LINEAR),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_MAG_FILTER,_.LINEAR);const I=(d=y.HALF_FLOAT)!==null&&d!==void 0?d:_.UNSIGNED_BYTE,k=(f=y.RGBA16F)!==null&&f!==void 0?f:_.RGBA;_.texImage2D(_.TEXTURE_2D,0,k,t,a,0,_.RGBA,I,null);const z=y.createFramebuffer(t,a,!1,!1);return z.colorAttachment.set(E),z}function ll(y,t){return t.colorRampTexture||(t.colorRampTexture=new Ue(y,t.colorRamp,y.gl.RGBA)),t.colorRampTexture}function Hi(y,t,a,d,f){if(!a||!d||!d.imageAtlas)return;const _=d.imageAtlas.patternPositions;let E=_[a.to.toString()],I=_[a.from.toString()];if(!E&&I&&(E=I),!I&&E&&(I=E),!E||!I){const k=f.getPaintProperty(t);E=_[k],I=_[k]}E&&I&&y.setConstantPatternPositions(E,I)}function Wo(y,t,a,d,f,_,E){const I=y.context.gl,k="fill-pattern",z=a.paint.get(k),R=z&&z.constantOr(1),O=a.getCrossfadeParameters();let V,X,Q,ie,le;E?(X=R&&!a.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",V=I.LINES):(X=R?"fillPattern":"fill",V=I.TRIANGLES);const ce=z.constantOr(null);for(const me of d){const te=t.getTile(me);if(R&&!te.patternsLoaded())continue;const xe=te.getBucket(a);if(!xe)continue;const be=xe.programConfigurations.get(a.id),ze=y.useProgram(X,be),qe=y.style.map.terrain&&y.style.map.terrain.getTerrainData(me);R&&(y.context.activeTexture.set(I.TEXTURE0),te.imageAtlasTexture.bind(I.LINEAR,I.CLAMP_TO_EDGE),be.updatePaintBuffers(O)),Hi(be,k,ce,te,a);const Qe=qe?me:null,at=y.translatePosMatrix(Qe?Qe.posMatrix:me.posMatrix,te,a.paint.get("fill-translate"),a.paint.get("fill-translate-anchor"));if(E){ie=xe.indexBuffer2,le=xe.segments2;const pt=[I.drawingBufferWidth,I.drawingBufferHeight];Q=X==="fillOutlinePattern"&&R?Yc(at,y,O,te,pt):md(at,pt)}else ie=xe.indexBuffer,le=xe.segments,Q=R?Kc(at,y,O,te):il(at);ze.draw(y.context,V,f,y.stencilModeForClipping(me),_,Un.disabled,Q,qe,a.id,xe.layoutVertexBuffer,ie,le,a.paint,y.transform.zoom,be)}}function Ku(y,t,a,d,f,_,E){const I=y.context,k=I.gl,z="fill-extrusion-pattern",R=a.paint.get(z),O=R.constantOr(1),V=a.getCrossfadeParameters(),X=a.paint.get("fill-extrusion-opacity"),Q=R.constantOr(null);for(const ie of d){const le=t.getTile(ie),ce=le.getBucket(a);if(!ce)continue;const me=y.style.map.terrain&&y.style.map.terrain.getTerrainData(ie),te=ce.programConfigurations.get(a.id),xe=y.useProgram(O?"fillExtrusionPattern":"fillExtrusion",te);O&&(y.context.activeTexture.set(k.TEXTURE0),le.imageAtlasTexture.bind(k.LINEAR,k.CLAMP_TO_EDGE),te.updatePaintBuffers(V)),Hi(te,z,Q,le,a);const be=y.translatePosMatrix(ie.posMatrix,le,a.paint.get("fill-extrusion-translate"),a.paint.get("fill-extrusion-translate-anchor")),ze=a.paint.get("fill-extrusion-vertical-gradient"),qe=O?Vl(be,y,ze,X,ie,V,le):rl(be,y,ze,X);xe.draw(I,I.gl.TRIANGLES,f,_,E,Un.backCCW,qe,me,a.id,ce.layoutVertexBuffer,ce.indexBuffer,ce.segments,a.paint,y.transform.zoom,te,y.style.map.terrain&&ce.centroidVertexBuffer)}}function ul(y,t,a,d,f,_,E){const I=y.context,k=I.gl,z=a.fbo;if(!z)return;const R=y.useProgram("hillshade"),O=y.style.map.terrain&&y.style.map.terrain.getTerrainData(t);I.activeTexture.set(k.TEXTURE0),k.bindTexture(k.TEXTURE_2D,z.colorAttachment.get()),R.draw(I,k.TRIANGLES,f,_,E,Un.disabled,((V,X,Q,ie)=>{const le=Q.paint.get("hillshade-shadow-color"),ce=Q.paint.get("hillshade-highlight-color"),me=Q.paint.get("hillshade-accent-color");let te=Q.paint.get("hillshade-illumination-direction")*(Math.PI/180);Q.paint.get("hillshade-illumination-anchor")==="viewport"&&(te-=V.transform.angle);const xe=!V.options.moving;return{u_matrix:ie?ie.posMatrix:V.transform.calculatePosMatrix(X.tileID.toUnwrapped(),xe),u_image:0,u_latrange:$u(0,X.tileID),u_light:[Q.paint.get("hillshade-exaggeration"),te],u_shadow:le,u_highlight:ce,u_accent:me}})(y,a,d,O?t:null),O,d.id,y.rasterBoundsBuffer,y.quadTriangleIndexBuffer,y.rasterBoundsSegments)}function cl(y,t,a,d,f,_){const E=y.context,I=E.gl,k=t.dem;if(k&&k.data){const z=k.dim,R=k.stride,O=k.getPixels();if(E.activeTexture.set(I.TEXTURE1),E.pixelStoreUnpackPremultiplyAlpha.set(!1),t.demTexture=t.demTexture||y.getTileTexture(R),t.demTexture){const X=t.demTexture;X.update(O,{premultiply:!1}),X.bind(I.NEAREST,I.CLAMP_TO_EDGE)}else t.demTexture=new Ue(E,O,I.RGBA,{premultiply:!1}),t.demTexture.bind(I.NEAREST,I.CLAMP_TO_EDGE);E.activeTexture.set(I.TEXTURE0);let V=t.fbo;if(!V){const X=new Ue(E,{width:z,height:z,data:null},I.RGBA);X.bind(I.LINEAR,I.CLAMP_TO_EDGE),V=t.fbo=E.createFramebuffer(z,z,!0,!1),V.colorAttachment.set(X.texture)}E.bindFramebuffer.set(V.framebuffer),E.viewport.set([0,0,z,z]),y.useProgram("hillshadePrepare").draw(E,I.TRIANGLES,d,f,_,Un.disabled,((X,Q)=>{const ie=Q.stride,le=c.H();return c.aP(le,0,c.X,-c.X,0,0,1),c.J(le,le,[0,-c.X,0]),{u_matrix:le,u_image:1,u_dimension:[ie,ie],u_zoom:X.overscaledZ,u_unpack:Q.getUnpackVector()}})(t.tileID,k),null,a.id,y.rasterBoundsBuffer,y.quadTriangleIndexBuffer,y.rasterBoundsSegments),t.needsHillshadePrepare=!1}}function va(y,t,a,d,f,_){const E=d.paint.get("raster-fade-duration");if(!_&&E>0){const I=G.now(),k=(I-y.timeAdded)/E,z=t?(I-t.timeAdded)/E:-1,R=a.getSource(),O=f.coveringZoomLevel({tileSize:R.tileSize,roundZoom:R.roundZoom}),V=!t||Math.abs(t.tileID.overscaledZ-O)>Math.abs(y.tileID.overscaledZ-O),X=V&&y.refreshedUponExpiration?1:c.ac(V?k:1-z,0,1);return y.refreshedUponExpiration&&k>=1&&(y.refreshedUponExpiration=!1),t?{opacity:1,mix:1-X}:{opacity:X,mix:0}}return{opacity:1,mix:0}}const Xi=new c.aM(1,0,0,1),An=new c.aM(0,1,0,1),Yu=new c.aM(0,0,1,1),op=new c.aM(1,0,1,1),kd=new c.aM(0,1,1,1);function hl(y,t,a,d){go(y,0,t+a/2,y.transform.width,a,d)}function Pd(y,t,a,d){go(y,t-a/2,0,a,y.transform.height,d)}function go(y,t,a,d,f,_){const E=y.context,I=E.gl;I.enable(I.SCISSOR_TEST),I.scissor(t*y.pixelRatio,a*y.pixelRatio,d*y.pixelRatio,f*y.pixelRatio),E.clear({color:_}),I.disable(I.SCISSOR_TEST)}function Ie(y,t,a){const d=y.context,f=d.gl,_=a.posMatrix,E=y.useProgram("debug"),I=an.disabled,k=pn.disabled,z=y.colorModeForRenderPass(),R="$debug",O=y.style.map.terrain&&y.style.map.terrain.getTerrainData(a);d.activeTexture.set(f.TEXTURE0);const V=t.getTileByID(a.key).latestRawTileData,X=Math.floor((V&&V.byteLength||0)/1024),Q=t.getTile(a).tileSize,ie=512/Math.min(Q,512)*(a.overscaledZ/y.transform.zoom)*.5;let le=a.canonical.toString();a.overscaledZ!==a.canonical.z&&(le+=` => ${a.overscaledZ}`),function(ce,me){ce.initDebugOverlayCanvas();const te=ce.debugOverlayCanvas,xe=ce.context.gl,be=ce.debugOverlayCanvas.getContext("2d");be.clearRect(0,0,te.width,te.height),be.shadowColor="white",be.shadowBlur=2,be.lineWidth=1.5,be.strokeStyle="white",be.textBaseline="top",be.font="bold 36px Open Sans, sans-serif",be.fillText(me,5,5),be.strokeText(me,5,5),ce.debugOverlayTexture.update(te),ce.debugOverlayTexture.bind(xe.LINEAR,xe.CLAMP_TO_EDGE)}(y,`${le} ${X}kB`),E.draw(d,f.TRIANGLES,I,k,mr.alphaBlended,Un.disabled,ql(_,c.aM.transparent,ie),null,R,y.debugBuffer,y.quadTriangleIndexBuffer,y.debugSegments),E.draw(d,f.LINE_STRIP,I,k,z,Un.disabled,ql(_,c.aM.red),O,R,y.debugBuffer,y.tileBorderIndexBuffer,y.debugSegments)}function Ve(y,t,a){const d=y.context,f=d.gl,_=y.colorModeForRenderPass(),E=new an(f.LEQUAL,an.ReadWrite,y.depthRangeFor3D),I=y.useProgram("terrain"),k=t.getTerrainMesh();d.bindFramebuffer.set(null),d.viewport.set([0,0,y.width,y.height]);for(const z of a){const R=y.renderToTexture.getTexture(z),O=t.getTerrainData(z.tileID);d.activeTexture.set(f.TEXTURE0),f.bindTexture(f.TEXTURE_2D,R.texture);const V=y.transform.calculatePosMatrix(z.tileID.toUnwrapped()),X=t.getMeshFrameDelta(y.transform.zoom),Q=y.transform.calculateFogMatrix(z.tileID.toUnwrapped()),ie=Uu(V,X,Q,y.style.sky,y.transform.pitch);I.draw(d,f.TRIANGLES,E,pn.disabled,_,Un.backCCW,ie,O,"terrain",k.vertexBuffer,k.indexBuffer,k.segments)}}class Oe{constructor(t,a,d){this.vertexBuffer=t,this.indexBuffer=a,this.segments=d}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.vertexBuffer=null,this.indexBuffer=null,this.segments=null}}class Tt{constructor(t,a){this.context=new uh(t),this.transform=a,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:c.an(new Float64Array(16)),renderTime:0},this.setup(),this.numSublayers=Ut.maxUnderzooming+Ut.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Bu}resize(t,a,d){if(this.width=Math.floor(t*d),this.height=Math.floor(a*d),this.pixelRatio=d,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const f of this.style._order)this.style._layers[f].resize()}setup(){const t=this.context,a=new c.aX;a.emplaceBack(0,0),a.emplaceBack(c.X,0),a.emplaceBack(0,c.X),a.emplaceBack(c.X,c.X),this.tileExtentBuffer=t.createVertexBuffer(a,Bo.members),this.tileExtentSegments=c.a0.simpleSegment(0,0,4,2);const d=new c.aX;d.emplaceBack(0,0),d.emplaceBack(c.X,0),d.emplaceBack(0,c.X),d.emplaceBack(c.X,c.X),this.debugBuffer=t.createVertexBuffer(d,Bo.members),this.debugSegments=c.a0.simpleSegment(0,0,4,5);const f=new c.$;f.emplaceBack(0,0,0,0),f.emplaceBack(c.X,0,c.X,0),f.emplaceBack(0,c.X,0,c.X),f.emplaceBack(c.X,c.X,c.X,c.X),this.rasterBoundsBuffer=t.createVertexBuffer(f,yr.members),this.rasterBoundsSegments=c.a0.simpleSegment(0,0,4,2);const _=new c.aX;_.emplaceBack(0,0),_.emplaceBack(1,0),_.emplaceBack(0,1),_.emplaceBack(1,1),this.viewportBuffer=t.createVertexBuffer(_,Bo.members),this.viewportSegments=c.a0.simpleSegment(0,0,4,2);const E=new c.aZ;E.emplaceBack(0),E.emplaceBack(1),E.emplaceBack(3),E.emplaceBack(2),E.emplaceBack(0),this.tileBorderIndexBuffer=t.createIndexBuffer(E);const I=new c.aY;I.emplaceBack(0,1,2),I.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=t.createIndexBuffer(I);const k=this.context.gl;this.stencilClearMode=new pn({func:k.ALWAYS,mask:0},0,255,k.ZERO,k.ZERO,k.ZERO)}clearStencil(){const t=this.context,a=t.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const d=c.H();c.aP(d,0,this.width,this.height,0,0,1),c.K(d,d,[a.drawingBufferWidth,a.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(t,a.TRIANGLES,an.disabled,this.stencilClearMode,mr.disabled,Un.disabled,Li(d),null,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(t,a){if(this.currentStencilSource===t.source||!t.isTileClipped()||!a||!a.length)return;this.currentStencilSource=t.source;const d=this.context,f=d.gl;this.nextStencilID+a.length>256&&this.clearStencil(),d.setColorMode(mr.disabled),d.setDepthMode(an.disabled);const _=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const E of a){const I=this._tileClippingMaskIDs[E.key]=this.nextStencilID++,k=this.style.map.terrain&&this.style.map.terrain.getTerrainData(E);_.draw(d,f.TRIANGLES,an.disabled,new pn({func:f.ALWAYS,mask:0},I,255,f.KEEP,f.KEEP,f.REPLACE),mr.disabled,Un.disabled,Li(E.posMatrix),k,"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const t=this.nextStencilID++,a=this.context.gl;return new pn({func:a.NOTEQUAL,mask:255},t,255,a.KEEP,a.KEEP,a.REPLACE)}stencilModeForClipping(t){const a=this.context.gl;return new pn({func:a.EQUAL,mask:255},this._tileClippingMaskIDs[t.key],0,a.KEEP,a.KEEP,a.REPLACE)}stencilConfigForOverlap(t){const a=this.context.gl,d=t.sort((E,I)=>I.overscaledZ-E.overscaledZ),f=d[d.length-1].overscaledZ,_=d[0].overscaledZ-f+1;if(_>1){this.currentStencilSource=void 0,this.nextStencilID+_>256&&this.clearStencil();const E={};for(let I=0;I<_;I++)E[I+f]=new pn({func:a.GEQUAL,mask:255},I+this.nextStencilID,255,a.KEEP,a.KEEP,a.REPLACE);return this.nextStencilID+=_,[E,d]}return[{[f]:pn.disabled},d]}colorModeForRenderPass(){const t=this.context.gl;return this._showOverdrawInspector?new mr([t.CONSTANT_COLOR,t.ONE],new c.aM(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?mr.unblended:mr.alphaBlended}depthModeForSublayer(t,a,d){if(!this.opaquePassEnabledForLayer())return an.disabled;const f=1-((1+this.currentLayer)*this.numSublayers+t)*this.depthEpsilon;return new an(d||this.context.gl.LEQUAL,a,[f,f])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(t,a){this.style=t,this.options=a,this.lineAtlas=t.lineAtlas,this.imageManager=t.imageManager,this.glyphManager=t.glyphManager,this.symbolFadeChange=t.placement.symbolFadeChange(G.now()),this.imageManager.beginFrame();const d=this.style._order,f=this.style.sourceCaches,_={},E={},I={};for(const k in f){const z=f[k];z.used&&z.prepare(this.context),_[k]=z.getVisibleCoordinates(),E[k]=_[k].slice().reverse(),I[k]=z.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let k=0;k<d.length;k++)if(this.style._layers[d[k]].is3D()){this.opaquePassCutoff=k;break}this.maybeDrawDepthAndCoords(!1),this.renderToTexture&&(this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0),this.renderPass="offscreen";for(const k of d){const z=this.style._layers[k];if(!z.hasOffscreenPass()||z.isHidden(this.transform.zoom))continue;const R=E[z.source];(z.type==="custom"||R.length)&&this.renderLayer(this,f[z.source],z,R)}if(this.context.bindFramebuffer.set(null),this.context.clear({color:a.showOverdrawInspector?c.aM.black:c.aM.transparent,depth:1}),this.clearStencil(),this.style.sky&&function(k,z){const R=k.context,O=R.gl,V=((ce,me,te)=>({u_sky_color:ce.properties.get("sky-color"),u_horizon_color:ce.properties.get("horizon-color"),u_horizon:(me.height/2+me.getHorizon())*te,u_sky_horizon_blend:ce.properties.get("sky-horizon-blend")*me.height/2*te}))(z,k.style.map.transform,k.pixelRatio),X=new an(O.LEQUAL,an.ReadWrite,[0,1]),Q=pn.disabled,ie=k.colorModeForRenderPass(),le=k.useProgram("sky");if(!z.mesh){const ce=new c.aX;ce.emplaceBack(-1,-1),ce.emplaceBack(1,-1),ce.emplaceBack(1,1),ce.emplaceBack(-1,1);const me=new c.aY;me.emplaceBack(0,1,2),me.emplaceBack(0,2,3),z.mesh=new Oe(R.createVertexBuffer(ce,Bo.members),R.createIndexBuffer(me),c.a0.simpleSegment(0,0,ce.length,me.length))}le.draw(R,O.TRIANGLES,X,Q,ie,Un.disabled,V,void 0,"sky",z.mesh.vertexBuffer,z.mesh.indexBuffer,z.mesh.segments)}(this,this.style.sky),this._showOverdrawInspector=a.showOverdrawInspector,this.depthRangeFor3D=[0,1-(t._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=d.length-1;this.currentLayer>=0;this.currentLayer--){const k=this.style._layers[d[this.currentLayer]],z=f[k.source],R=_[k.source];this._renderTileClippingMasks(k,R),this.renderLayer(this,z,k,R)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<d.length;this.currentLayer++){const k=this.style._layers[d[this.currentLayer]],z=f[k.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(k))continue;const R=(k.type==="symbol"?I:E)[k.source];this._renderTileClippingMasks(k,_[k.source]),this.renderLayer(this,z,k,R)}if(this.options.showTileBoundaries){const k=function(z,R){let O=null;const V=Object.values(z._layers).flatMap(le=>le.source&&!le.isHidden(R)?[z.sourceCaches[le.source]]:[]),X=V.filter(le=>le.getSource().type==="vector"),Q=V.filter(le=>le.getSource().type!=="vector"),ie=le=>{(!O||O.getSource().maxzoom<le.getSource().maxzoom)&&(O=le)};return X.forEach(le=>ie(le)),O||Q.forEach(le=>ie(le)),O}(this.style,this.transform.zoom);k&&function(z,R,O){for(let V=0;V<O.length;V++)Ie(z,R,O[V])}(this,k,k.getVisibleCoordinates())}this.options.showPadding&&function(k){const z=k.transform.padding;hl(k,k.transform.height-(z.top||0),3,Xi),hl(k,z.bottom||0,3,An),Pd(k,z.left||0,3,Yu),Pd(k,k.transform.width-(z.right||0),3,op);const R=k.transform.centerPoint;(function(O,V,X,Q){go(O,V-1,X-10,2,20,Q),go(O,V-10,X-1,20,2,Q)})(k,R.x,k.transform.height-R.y,kd)}(this),this.context.setDefault()}maybeDrawDepthAndCoords(t){if(!this.style||!this.style.map||!this.style.map.terrain)return;const a=this.terrainFacilitator.matrix,d=this.transform.modelViewProjectionMatrix;let f=this.terrainFacilitator.dirty;f||(f=t?!c.a_(a,d):!c.a$(a,d)),f||(f=this.style.map.terrain.sourceCache.tilesAfterTime(this.terrainFacilitator.renderTime).length>0),f&&(c.b0(a,d),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(_,E){const I=_.context,k=I.gl,z=mr.unblended,R=new an(k.LEQUAL,an.ReadWrite,[0,1]),O=E.getTerrainMesh(),V=E.sourceCache.getRenderableTiles(),X=_.useProgram("terrainDepth");I.bindFramebuffer.set(E.getFramebuffer("depth").framebuffer),I.viewport.set([0,0,_.width/devicePixelRatio,_.height/devicePixelRatio]),I.clear({color:c.aM.transparent,depth:1});for(const Q of V){const ie=E.getTerrainData(Q.tileID),le={u_matrix:_.transform.calculatePosMatrix(Q.tileID.toUnwrapped()),u_ele_delta:E.getMeshFrameDelta(_.transform.zoom)};X.draw(I,k.TRIANGLES,R,pn.disabled,z,Un.backCCW,le,ie,"terrain",O.vertexBuffer,O.indexBuffer,O.segments)}I.bindFramebuffer.set(null),I.viewport.set([0,0,_.width,_.height])}(this,this.style.map.terrain),function(_,E){const I=_.context,k=I.gl,z=mr.unblended,R=new an(k.LEQUAL,an.ReadWrite,[0,1]),O=E.getTerrainMesh(),V=E.getCoordsTexture(),X=E.sourceCache.getRenderableTiles(),Q=_.useProgram("terrainCoords");I.bindFramebuffer.set(E.getFramebuffer("coords").framebuffer),I.viewport.set([0,0,_.width/devicePixelRatio,_.height/devicePixelRatio]),I.clear({color:c.aM.transparent,depth:1}),E.coordsIndex=[];for(const ie of X){const le=E.getTerrainData(ie.tileID);I.activeTexture.set(k.TEXTURE0),k.bindTexture(k.TEXTURE_2D,V.texture);const ce={u_matrix:_.transform.calculatePosMatrix(ie.tileID.toUnwrapped()),u_terrain_coords_id:(255-E.coordsIndex.length)/255,u_texture:0,u_ele_delta:E.getMeshFrameDelta(_.transform.zoom)};Q.draw(I,k.TRIANGLES,R,pn.disabled,z,Un.backCCW,ce,le,"terrain",O.vertexBuffer,O.indexBuffer,O.segments),E.coordsIndex.push(ie.tileID.key)}I.bindFramebuffer.set(null),I.viewport.set([0,0,_.width,_.height])}(this,this.style.map.terrain))}renderLayer(t,a,d,f){if(!d.isHidden(this.transform.zoom)&&(d.type==="background"||d.type==="custom"||(f||[]).length))switch(this.id=d.id,d.type){case"symbol":(function(_,E,I,k,z){if(_.renderPass!=="translucent")return;const R=pn.disabled,O=_.colorModeForRenderPass();(I._unevaluatedLayout.hasValue("text-variable-anchor")||I._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&function(V,X,Q,ie,le,ce,me,te,xe){const be=X.transform,ze=fa(),qe=le==="map",Qe=ce==="map";for(const at of V){const pt=ie.getTile(at),st=pt.getBucket(Q);if(!st||!st.text||!st.text.segments.get().length)continue;const ot=c.ag(st.textSizeData,be.zoom),wt=fn(pt,1,X.transform.zoom),Wt=co(at.posMatrix,Qe,qe,X.transform,wt),ht=Q.layout.get("icon-text-fit")!=="none"&&st.hasIconData();if(ot){const tt=Math.pow(2,be.zoom-pt.tileID.overscaledZ),jt=X.style.map.terrain?($t,un)=>X.style.map.terrain.getElevation(at,$t,un):null,sr=ze.translatePosition(be,pt,me,te);al(st,qe,Qe,xe,be,Wt,at.posMatrix,tt,ot,ht,ze,sr,at.toUnwrapped(),jt)}}}(k,_,I,E,I.layout.get("text-rotation-alignment"),I.layout.get("text-pitch-alignment"),I.paint.get("text-translate"),I.paint.get("text-translate-anchor"),z),I.paint.get("icon-opacity").constantOr(1)!==0&&hh(_,E,I,k,!1,I.paint.get("icon-translate"),I.paint.get("icon-translate-anchor"),I.layout.get("icon-rotation-alignment"),I.layout.get("icon-pitch-alignment"),I.layout.get("icon-keep-upright"),R,O),I.paint.get("text-opacity").constantOr(1)!==0&&hh(_,E,I,k,!0,I.paint.get("text-translate"),I.paint.get("text-translate-anchor"),I.layout.get("text-rotation-alignment"),I.layout.get("text-pitch-alignment"),I.layout.get("text-keep-upright"),R,O),E.map.showCollisionBoxes&&(sl(_,E,I,k,!0),sl(_,E,I,k,!1))})(t,a,d,f,this.style.placement.variableOffsets);break;case"circle":(function(_,E,I,k){if(_.renderPass!=="translucent")return;const z=I.paint.get("circle-opacity"),R=I.paint.get("circle-stroke-width"),O=I.paint.get("circle-stroke-opacity"),V=!I.layout.get("circle-sort-key").isConstant();if(z.constantOr(1)===0&&(R.constantOr(1)===0||O.constantOr(1)===0))return;const X=_.context,Q=X.gl,ie=_.depthModeForSublayer(0,an.ReadOnly),le=pn.disabled,ce=_.colorModeForRenderPass(),me=[];for(let te=0;te<k.length;te++){const xe=k[te],be=E.getTile(xe),ze=be.getBucket(I);if(!ze)continue;const qe=ze.programConfigurations.get(I.id),Qe=_.useProgram("circle",qe),at=ze.layoutVertexBuffer,pt=ze.indexBuffer,st=_.style.map.terrain&&_.style.map.terrain.getTerrainData(xe),ot={programConfiguration:qe,program:Qe,layoutVertexBuffer:at,indexBuffer:pt,uniformValues:gd(_,xe,be,I),terrainData:st};if(V){const wt=ze.segments.get();for(const Wt of wt)me.push({segments:new c.a0([Wt]),sortKey:Wt.sortKey,state:ot})}else me.push({segments:ze.segments,sortKey:0,state:ot})}V&&me.sort((te,xe)=>te.sortKey-xe.sortKey);for(const te of me){const{programConfiguration:xe,program:be,layoutVertexBuffer:ze,indexBuffer:qe,uniformValues:Qe,terrainData:at}=te.state;be.draw(X,Q.TRIANGLES,ie,le,ce,Un.disabled,Qe,at,I.id,ze,qe,te.segments,I.paint,_.transform.zoom,xe)}})(t,a,d,f);break;case"heatmap":(function(_,E,I,k){if(I.paint.get("heatmap-opacity")===0)return;const z=_.context;if(_.style.map.terrain){for(const R of k){const O=E.getTile(R);E.hasRenderableParent(R)||(_.renderPass==="offscreen"?dh(_,O,I,R):_.renderPass==="translucent"&&_a(_,I,R))}z.viewport.set([0,0,_.width,_.height])}else _.renderPass==="offscreen"?function(R,O,V,X){const Q=R.context,ie=Q.gl,le=pn.disabled,ce=new mr([ie.ONE,ie.ONE],c.aM.transparent,[!0,!0,!0,!0]);(function(me,te,xe){const be=me.gl;me.activeTexture.set(be.TEXTURE1),me.viewport.set([0,0,te.width/4,te.height/4]);let ze=xe.heatmapFbos.get(c.aU);ze?(be.bindTexture(be.TEXTURE_2D,ze.colorAttachment.get()),me.bindFramebuffer.set(ze.framebuffer)):(ze=ya(me,te.width/4,te.height/4),xe.heatmapFbos.set(c.aU,ze))})(Q,R,V),Q.clear({color:c.aM.transparent});for(let me=0;me<X.length;me++){const te=X[me];if(O.hasRenderableParent(te))continue;const xe=O.getTile(te),be=xe.getBucket(V);if(!be)continue;const ze=be.programConfigurations.get(V.id),qe=R.useProgram("heatmap",ze),{zoom:Qe}=R.transform;qe.draw(Q,ie.TRIANGLES,an.disabled,le,ce,Un.disabled,Ti(te.posMatrix,xe,Qe,V.paint.get("heatmap-intensity")),null,V.id,be.layoutVertexBuffer,be.indexBuffer,be.segments,V.paint,R.transform.zoom,ze)}Q.viewport.set([0,0,R.width,R.height])}(_,E,I,k):_.renderPass==="translucent"&&function(R,O){const V=R.context,X=V.gl;V.setColorMode(R.colorModeForRenderPass());const Q=O.heatmapFbos.get(c.aU);Q&&(V.activeTexture.set(X.TEXTURE0),X.bindTexture(X.TEXTURE_2D,Q.colorAttachment.get()),V.activeTexture.set(X.TEXTURE1),ll(V,O).bind(X.LINEAR,X.CLAMP_TO_EDGE),R.useProgram("heatmapTexture").draw(V,X.TRIANGLES,an.disabled,pn.disabled,R.colorModeForRenderPass(),Un.disabled,ju(R,O,0,1),null,O.id,R.viewportBuffer,R.quadTriangleIndexBuffer,R.viewportSegments,O.paint,R.transform.zoom))}(_,I)})(t,a,d,f);break;case"line":(function(_,E,I,k){if(_.renderPass!=="translucent")return;const z=I.paint.get("line-opacity"),R=I.paint.get("line-width");if(z.constantOr(1)===0||R.constantOr(1)===0)return;const O=_.depthModeForSublayer(0,an.ReadOnly),V=_.colorModeForRenderPass(),X=I.paint.get("line-dasharray"),Q=I.paint.get("line-pattern"),ie=Q.constantOr(1),le=I.paint.get("line-gradient"),ce=I.getCrossfadeParameters(),me=ie?"linePattern":X?"lineSDF":le?"lineGradient":"line",te=_.context,xe=te.gl;let be=!0;for(const ze of k){const qe=E.getTile(ze);if(ie&&!qe.patternsLoaded())continue;const Qe=qe.getBucket(I);if(!Qe)continue;const at=Qe.programConfigurations.get(I.id),pt=_.context.program.get(),st=_.useProgram(me,at),ot=be||st.program!==pt,wt=_.style.map.terrain&&_.style.map.terrain.getTerrainData(ze),Wt=Q.constantOr(null);if(Wt&&qe.imageAtlas){const jt=qe.imageAtlas,sr=jt.patternPositions[Wt.to.toString()],$t=jt.patternPositions[Wt.from.toString()];sr&&$t&&at.setConstantPatternPositions(sr,$t)}const ht=wt?ze:null,tt=ie?Uo(_,qe,I,ce,ht):X?tp(_,qe,I,X,ce,ht):le?_d(_,qe,I,Qe.lineClipsArray.length,ht):Vu(_,qe,I,ht);if(ie)te.activeTexture.set(xe.TEXTURE0),qe.imageAtlasTexture.bind(xe.LINEAR,xe.CLAMP_TO_EDGE),at.updatePaintBuffers(ce);else if(X&&(ot||_.lineAtlas.dirty))te.activeTexture.set(xe.TEXTURE0),_.lineAtlas.bind(te);else if(le){const jt=Qe.gradients[I.id];let sr=jt.texture;if(I.gradientVersion!==jt.version){let $t=256;if(I.stepInterpolant){const un=E.getSource().maxzoom,Xn=ze.canonical.z===un?Math.ceil(1<<_.transform.maxZoom-ze.canonical.z):1;$t=c.ac(c.aV(Qe.maxLineLength/c.X*1024*Xn),256,te.maxTextureSize)}jt.gradient=c.aW({expression:I.gradientExpression(),evaluationKey:"lineProgress",resolution:$t,image:jt.gradient||void 0,clips:Qe.lineClipsArray}),jt.texture?jt.texture.update(jt.gradient):jt.texture=new Ue(te,jt.gradient,xe.RGBA),jt.version=I.gradientVersion,sr=jt.texture}te.activeTexture.set(xe.TEXTURE0),sr.bind(I.stepInterpolant?xe.NEAREST:xe.LINEAR,xe.CLAMP_TO_EDGE)}st.draw(te,xe.TRIANGLES,O,_.stencilModeForClipping(ze),V,Un.disabled,tt,wt,I.id,Qe.layoutVertexBuffer,Qe.indexBuffer,Qe.segments,I.paint,_.transform.zoom,at,Qe.layoutVertexBuffer2),be=!1}})(t,a,d,f);break;case"fill":(function(_,E,I,k){const z=I.paint.get("fill-color"),R=I.paint.get("fill-opacity");if(R.constantOr(1)===0)return;const O=_.colorModeForRenderPass(),V=I.paint.get("fill-pattern"),X=_.opaquePassEnabledForLayer()&&!V.constantOr(1)&&z.constantOr(c.aM.transparent).a===1&&R.constantOr(0)===1?"opaque":"translucent";if(_.renderPass===X){const Q=_.depthModeForSublayer(1,_.renderPass==="opaque"?an.ReadWrite:an.ReadOnly);Wo(_,E,I,k,Q,O,!1)}if(_.renderPass==="translucent"&&I.paint.get("fill-antialias")){const Q=_.depthModeForSublayer(I.getPaintProperty("fill-outline-color")?2:0,an.ReadOnly);Wo(_,E,I,k,Q,O,!0)}})(t,a,d,f);break;case"fill-extrusion":(function(_,E,I,k){const z=I.paint.get("fill-extrusion-opacity");if(z!==0&&_.renderPass==="translucent"){const R=new an(_.context.gl.LEQUAL,an.ReadWrite,_.depthRangeFor3D);if(z!==1||I.paint.get("fill-extrusion-pattern").constantOr(1))Ku(_,E,I,k,R,pn.disabled,mr.disabled),Ku(_,E,I,k,R,_.stencilModeFor3D(),_.colorModeForRenderPass());else{const O=_.colorModeForRenderPass();Ku(_,E,I,k,R,pn.disabled,O)}}})(t,a,d,f);break;case"hillshade":(function(_,E,I,k){if(_.renderPass!=="offscreen"&&_.renderPass!=="translucent")return;const z=_.context,R=_.depthModeForSublayer(0,an.ReadOnly),O=_.colorModeForRenderPass(),[V,X]=_.renderPass==="translucent"?_.stencilConfigForOverlap(k):[{},k];for(const Q of X){const ie=E.getTile(Q);ie.needsHillshadePrepare!==void 0&&ie.needsHillshadePrepare&&_.renderPass==="offscreen"?cl(_,ie,I,R,pn.disabled,O):_.renderPass==="translucent"&&ul(_,Q,ie,I,R,V[Q.overscaledZ],O)}z.viewport.set([0,0,_.width,_.height])})(t,a,d,f);break;case"raster":(function(_,E,I,k){if(_.renderPass!=="translucent"||I.paint.get("raster-opacity")===0||!k.length)return;const z=_.context,R=z.gl,O=E.getSource(),V=_.useProgram("raster"),X=_.colorModeForRenderPass(),[Q,ie]=O instanceof Gr?[{},k]:_.stencilConfigForOverlap(k),le=ie[ie.length-1].overscaledZ,ce=!_.options.moving;for(const me of ie){const te=_.depthModeForSublayer(me.overscaledZ-le,I.paint.get("raster-opacity")===1?an.ReadWrite:an.ReadOnly,R.LESS),xe=E.getTile(me);xe.registerFadeDuration(I.paint.get("raster-fade-duration"));const be=E.findLoadedParent(me,0),ze=E.findLoadedSibling(me),qe=va(xe,be||ze||null,E,I,_.transform,_.style.map.terrain);let Qe,at;const pt=I.paint.get("raster-resampling")==="nearest"?R.NEAREST:R.LINEAR;z.activeTexture.set(R.TEXTURE0),xe.texture.bind(pt,R.CLAMP_TO_EDGE,R.LINEAR_MIPMAP_NEAREST),z.activeTexture.set(R.TEXTURE1),be?(be.texture.bind(pt,R.CLAMP_TO_EDGE,R.LINEAR_MIPMAP_NEAREST),Qe=Math.pow(2,be.tileID.overscaledZ-xe.tileID.overscaledZ),at=[xe.tileID.canonical.x*Qe%1,xe.tileID.canonical.y*Qe%1]):xe.texture.bind(pt,R.CLAMP_TO_EDGE,R.LINEAR_MIPMAP_NEAREST),xe.texture.useMipmap&&z.extTextureFilterAnisotropic&&_.transform.pitch>20&&R.texParameterf(R.TEXTURE_2D,z.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,z.extTextureFilterAnisotropicMax);const st=_.style.map.terrain&&_.style.map.terrain.getTerrainData(me),ot=st?me:null,wt=ot?ot.posMatrix:_.transform.calculatePosMatrix(me.toUnwrapped(),ce),Wt=np(wt,at||[0,0],Qe||1,qe,I);O instanceof Gr?V.draw(z,R.TRIANGLES,te,pn.disabled,X,Un.disabled,Wt,st,I.id,O.boundsBuffer,_.quadTriangleIndexBuffer,O.boundsSegments):V.draw(z,R.TRIANGLES,te,Q[me.overscaledZ],X,Un.disabled,Wt,st,I.id,_.rasterBoundsBuffer,_.quadTriangleIndexBuffer,_.rasterBoundsSegments)}})(t,a,d,f);break;case"background":(function(_,E,I,k){const z=I.paint.get("background-color"),R=I.paint.get("background-opacity");if(R===0)return;const O=_.context,V=O.gl,X=_.transform,Q=X.tileSize,ie=I.paint.get("background-pattern");if(_.isPatternMissing(ie))return;const le=!ie&&z.a===1&&R===1&&_.opaquePassEnabledForLayer()?"opaque":"translucent";if(_.renderPass!==le)return;const ce=pn.disabled,me=_.depthModeForSublayer(0,le==="opaque"?an.ReadWrite:an.ReadOnly),te=_.colorModeForRenderPass(),xe=_.useProgram(ie?"backgroundPattern":"background"),be=k||X.coveringTiles({tileSize:Q,terrain:_.style.map.terrain});ie&&(O.activeTexture.set(V.TEXTURE0),_.imageManager.bind(_.context));const ze=I.getCrossfadeParameters();for(const qe of be){const Qe=k?qe.posMatrix:_.transform.calculatePosMatrix(qe.toUnwrapped()),at=ie?Qc(Qe,R,_,ie,{tileID:qe,tileSize:Q},ze):qu(Qe,R,z),pt=_.style.map.terrain&&_.style.map.terrain.getTerrainData(qe);xe.draw(O,V.TRIANGLES,me,ce,te,Un.disabled,at,pt,I.id,_.tileExtentBuffer,_.quadTriangleIndexBuffer,_.tileExtentSegments)}})(t,0,d,f);break;case"custom":(function(_,E,I){const k=_.context,z=I.implementation;if(_.renderPass==="offscreen"){const R=z.prerender;R&&(_.setCustomLayerDefaults(),k.setColorMode(_.colorModeForRenderPass()),R.call(z,k.gl,_.transform.customLayerMatrix()),k.setDirty(),_.setBaseState())}else if(_.renderPass==="translucent"){_.setCustomLayerDefaults(),k.setColorMode(_.colorModeForRenderPass()),k.setStencilMode(pn.disabled);const R=z.renderingMode==="3d"?new an(_.context.gl.LEQUAL,an.ReadWrite,_.depthRangeFor3D):_.depthModeForSublayer(0,an.ReadOnly);k.setDepthMode(R),z.render(k.gl,_.transform.customLayerMatrix(),{farZ:_.transform.farZ,nearZ:_.transform.nearZ,fov:_.transform._fov,modelViewProjectionMatrix:_.transform.modelViewProjectionMatrix,projectionMatrix:_.transform.projectionMatrix}),k.setDirty(),_.setBaseState(),k.bindFramebuffer.set(null)}})(t,0,d)}}translatePosMatrix(t,a,d,f,_){if(!d[0]&&!d[1])return t;const E=_?f==="map"?this.transform.angle:0:f==="viewport"?-this.transform.angle:0;if(E){const z=Math.sin(E),R=Math.cos(E);d=[d[0]*R-d[1]*z,d[0]*z+d[1]*R]}const I=[_?d[0]:fn(a,d[0],this.transform.zoom),_?d[1]:fn(a,d[1],this.transform.zoom),0],k=new Float32Array(16);return c.J(k,t,I),k}saveTileTexture(t){const a=this._tileTextures[t.size[0]];a?a.push(t):this._tileTextures[t.size[0]]=[t]}getTileTexture(t){const a=this._tileTextures[t];return a&&a.length>0?a.pop():null}isPatternMissing(t){if(!t)return!1;if(!t.from||!t.to)return!0;const a=this.imageManager.getPattern(t.from.toString()),d=this.imageManager.getPattern(t.to.toString());return!a||!d}useProgram(t,a){this.cache=this.cache||{};const d=t+(a?a.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"")+(this.style.map.terrain?"/terrain":"");return this.cache[d]||(this.cache[d]=new $l(this.context,ho[t],a,eh[t],this._showOverdrawInspector,this.style.map.terrain)),this.cache[d]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const t=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(t.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new Ue(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}overLimit(){const{drawingBufferWidth:t,drawingBufferHeight:a}=this.context.gl;return this.width!==t||this.height!==a}}class Gt{constructor(t,a){this.points=t,this.planes=a}static fromInvProjectionMatrix(t,a,d){const f=Math.pow(2,d),_=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(I=>{const k=1/(I=c.af([],I,t))[3]/a*f;return c.b1(I,I,[k,k,1/I[3],k])}),E=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(I=>{const k=function(V,X){var Q=X[0],ie=X[1],le=X[2],ce=Q*Q+ie*ie+le*le;return ce>0&&(ce=1/Math.sqrt(ce)),V[0]=X[0]*ce,V[1]=X[1]*ce,V[2]=X[2]*ce,V}([],function(V,X,Q){var ie=X[0],le=X[1],ce=X[2],me=Q[0],te=Q[1],xe=Q[2];return V[0]=le*xe-ce*te,V[1]=ce*me-ie*xe,V[2]=ie*te-le*me,V}([],ve([],_[I[0]],_[I[1]]),ve([],_[I[2]],_[I[1]]))),z=-((R=k)[0]*(O=_[I[1]])[0]+R[1]*O[1]+R[2]*O[2]);var R,O;return k.concat(z)});return new Gt(_,E)}}class Tn{constructor(t,a){this.min=t,this.max=a,this.center=function(d,f,_){return d[0]=.5*f[0],d[1]=.5*f[1],d[2]=.5*f[2],d}([],function(d,f,_){return d[0]=f[0]+_[0],d[1]=f[1]+_[1],d[2]=f[2]+_[2],d}([],this.min,this.max))}quadrant(t){const a=[t%2==0,t<2],d=Ze(this.min),f=Ze(this.max);for(let _=0;_<a.length;_++)d[_]=a[_]?this.min[_]:this.center[_],f[_]=a[_]?this.center[_]:this.max[_];return f[2]=this.max[2],new Tn(d,f)}distanceX(t){return Math.max(Math.min(this.max[0],t[0]),this.min[0])-t[0]}distanceY(t){return Math.max(Math.min(this.max[1],t[1]),this.min[1])-t[1]}intersects(t){const a=[[this.min[0],this.min[1],this.min[2],1],[this.max[0],this.min[1],this.min[2],1],[this.max[0],this.max[1],this.min[2],1],[this.min[0],this.max[1],this.min[2],1],[this.min[0],this.min[1],this.max[2],1],[this.max[0],this.min[1],this.max[2],1],[this.max[0],this.max[1],this.max[2],1],[this.min[0],this.max[1],this.max[2],1]];let d=!0;for(let f=0;f<t.planes.length;f++){const _=t.planes[f];let E=0;for(let I=0;I<a.length;I++)c.b2(_,a[I])>=0&&E++;if(E===0)return 0;E!==a.length&&(d=!1)}if(d)return 2;for(let f=0;f<3;f++){let _=Number.MAX_VALUE,E=-Number.MAX_VALUE;for(let I=0;I<t.points.length;I++){const k=t.points[I][f]-this.min[f];_=Math.min(_,k),E=Math.max(E,k)}if(E<0||_>this.max[f]-this.min[f])return 0}return 1}}class gr{constructor(t=0,a=0,d=0,f=0){if(isNaN(t)||t<0||isNaN(a)||a<0||isNaN(d)||d<0||isNaN(f)||f<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=t,this.bottom=a,this.left=d,this.right=f}interpolate(t,a,d){return a.top!=null&&t.top!=null&&(this.top=c.y.number(t.top,a.top,d)),a.bottom!=null&&t.bottom!=null&&(this.bottom=c.y.number(t.bottom,a.bottom,d)),a.left!=null&&t.left!=null&&(this.left=c.y.number(t.left,a.left,d)),a.right!=null&&t.right!=null&&(this.right=c.y.number(t.right,a.right,d)),this}getCenter(t,a){const d=c.ac((this.left+t-this.right)/2,0,t),f=c.ac((this.top+a-this.bottom)/2,0,a);return new c.P(d,f)}equals(t){return this.top===t.top&&this.bottom===t.bottom&&this.left===t.left&&this.right===t.right}clone(){return new gr(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}const Hn=85.051129;class Go{constructor(t,a,d,f,_){this.tileSize=512,this._renderWorldCopies=_===void 0||!!_,this._minZoom=t||0,this._maxZoom=a||22,this._minPitch=d??0,this._maxPitch=f??60,this.setMaxBounds(),this.width=0,this.height=0,this._center=new c.N(0,0),this._elevation=0,this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new gr,this._posMatrixCache={},this._alignedPosMatrixCache={},this._fogMatrixCache={},this.minElevationForCurrentTile=0}clone(){const t=new Go(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return t.apply(this),t}apply(t){this.tileSize=t.tileSize,this.latRange=t.latRange,this.lngRange=t.lngRange,this.width=t.width,this.height=t.height,this._center=t._center,this._elevation=t._elevation,this.minElevationForCurrentTile=t.minElevationForCurrentTile,this.zoom=t.zoom,this.angle=t.angle,this._fov=t._fov,this._pitch=t._pitch,this._unmodified=t._unmodified,this._edgeInsets=t._edgeInsets.clone(),this._calcMatrices()}get minZoom(){return this._minZoom}set minZoom(t){this._minZoom!==t&&(this._minZoom=t,this.zoom=Math.max(this.zoom,t))}get maxZoom(){return this._maxZoom}set maxZoom(t){this._maxZoom!==t&&(this._maxZoom=t,this.zoom=Math.min(this.zoom,t))}get minPitch(){return this._minPitch}set minPitch(t){this._minPitch!==t&&(this._minPitch=t,this.pitch=Math.max(this.pitch,t))}get maxPitch(){return this._maxPitch}set maxPitch(t){this._maxPitch!==t&&(this._maxPitch=t,this.pitch=Math.min(this.pitch,t))}get renderWorldCopies(){return this._renderWorldCopies}set renderWorldCopies(t){t===void 0?t=!0:t===null&&(t=!1),this._renderWorldCopies=t}get worldSize(){return this.tileSize*this.scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new c.P(this.width,this.height)}get bearing(){return-this.angle/Math.PI*180}set bearing(t){const a=-c.b3(t,-180,180)*Math.PI/180;this.angle!==a&&(this._unmodified=!1,this.angle=a,this._calcMatrices(),this.rotationMatrix=function(){var d=new c.A(4);return c.A!=Float32Array&&(d[1]=0,d[2]=0),d[0]=1,d[3]=1,d}(),function(d,f,_){var E=f[0],I=f[1],k=f[2],z=f[3],R=Math.sin(_),O=Math.cos(_);d[0]=E*O+k*R,d[1]=I*O+z*R,d[2]=E*-R+k*O,d[3]=I*-R+z*O}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(t){const a=c.ac(t,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==a&&(this._unmodified=!1,this._pitch=a,this._calcMatrices())}get fov(){return this._fov/Math.PI*180}set fov(t){t=Math.max(.01,Math.min(60,t)),this._fov!==t&&(this._unmodified=!1,this._fov=t/180*Math.PI,this._calcMatrices())}get zoom(){return this._zoom}set zoom(t){const a=Math.min(Math.max(t,this.minZoom),this.maxZoom);this._zoom!==a&&(this._unmodified=!1,this._zoom=a,this.tileZoom=Math.max(0,Math.floor(a)),this.scale=this.zoomScale(a),this._constrain(),this._calcMatrices())}get center(){return this._center}set center(t){t.lat===this._center.lat&&t.lng===this._center.lng||(this._unmodified=!1,this._center=t,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}set elevation(t){t!==this._elevation&&(this._elevation=t,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}set padding(t){this._edgeInsets.equals(t)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,t,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}isPaddingEqual(t){return this._edgeInsets.equals(t)}interpolatePadding(t,a,d){this._unmodified=!1,this._edgeInsets.interpolate(t,a,d),this._constrain(),this._calcMatrices()}coveringZoomLevel(t){const a=(t.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/t.tileSize));return Math.max(0,a)}getVisibleUnwrappedCoordinates(t){const a=[new c.b4(0,t)];if(this._renderWorldCopies){const d=this.pointCoordinate(new c.P(0,0)),f=this.pointCoordinate(new c.P(this.width,0)),_=this.pointCoordinate(new c.P(this.width,this.height)),E=this.pointCoordinate(new c.P(0,this.height)),I=Math.floor(Math.min(d.x,f.x,_.x,E.x)),k=Math.floor(Math.max(d.x,f.x,_.x,E.x)),z=1;for(let R=I-z;R<=k+z;R++)R!==0&&a.push(new c.b4(R,t))}return a}coveringTiles(t){var a,d;let f=this.coveringZoomLevel(t);const _=f;if(t.minzoom!==void 0&&f<t.minzoom)return[];t.maxzoom!==void 0&&f>t.maxzoom&&(f=t.maxzoom);const E=this.pointCoordinate(this.getCameraPoint()),I=c.Z.fromLngLat(this.center),k=Math.pow(2,f),z=[k*E.x,k*E.y,0],R=[k*I.x,k*I.y,0],O=Gt.fromInvProjectionMatrix(this.invModelViewProjectionMatrix,this.worldSize,f);let V=t.minzoom||0;!t.terrain&&this.pitch<=60&&this._edgeInsets.top<.1&&(V=f);const X=t.terrain?2/Math.min(this.tileSize,t.tileSize)*this.tileSize:3,Q=te=>({aabb:new Tn([te*k,0,0],[(te+1)*k,k,0]),zoom:0,x:0,y:0,wrap:te,fullyVisible:!1}),ie=[],le=[],ce=f,me=t.reparseOverscaled?_:f;if(this._renderWorldCopies)for(let te=1;te<=3;te++)ie.push(Q(-te)),ie.push(Q(te));for(ie.push(Q(0));ie.length>0;){const te=ie.pop(),xe=te.x,be=te.y;let ze=te.fullyVisible;if(!ze){const st=te.aabb.intersects(O);if(st===0)continue;ze=st===2}const qe=t.terrain?z:R,Qe=te.aabb.distanceX(qe),at=te.aabb.distanceY(qe),pt=Math.max(Math.abs(Qe),Math.abs(at));if(te.zoom===ce||pt>X+(1<<ce-te.zoom)-2&&te.zoom>=V){const st=ce-te.zoom,ot=z[0]-.5-(xe<<st),wt=z[1]-.5-(be<<st);le.push({tileID:new c.S(te.zoom===ce?me:te.zoom,te.wrap,te.zoom,xe,be),distanceSq:ee([R[0]-.5-xe,R[1]-.5-be]),tileDistanceToCamera:Math.sqrt(ot*ot+wt*wt)})}else for(let st=0;st<4;st++){const ot=(xe<<1)+st%2,wt=(be<<1)+(st>>1),Wt=te.zoom+1;let ht=te.aabb.quadrant(st);if(t.terrain){const tt=new c.S(Wt,te.wrap,Wt,ot,wt),jt=t.terrain.getMinMaxElevation(tt),sr=(a=jt.minElevation)!==null&&a!==void 0?a:this.elevation,$t=(d=jt.maxElevation)!==null&&d!==void 0?d:this.elevation;ht=new Tn([ht.min[0],ht.min[1],sr],[ht.max[0],ht.max[1],$t])}ie.push({aabb:ht,zoom:Wt,x:ot,y:wt,wrap:te.wrap,fullyVisible:ze})}}return le.sort((te,xe)=>te.distanceSq-xe.distanceSq).map(te=>te.tileID)}resize(t,a){this.width=t,this.height=a,this.pixelsToGLUnits=[2/t,-2/a],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(t){return Math.pow(2,t)}scaleZoom(t){return Math.log(t)/Math.LN2}project(t){const a=c.ac(t.lat,-85.051129,Hn);return new c.P(c.O(t.lng)*this.worldSize,c.Q(a)*this.worldSize)}unproject(t){return new c.Z(t.x/this.worldSize,t.y/this.worldSize).toLngLat()}get point(){return this.project(this.center)}getCameraPosition(){return{lngLat:this.pointLocation(this.getCameraPoint()),altitude:Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter+this.elevation}}recalculateZoom(t){const a=this.elevation,d=Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter,f=this.pointLocation(this.centerPoint,t),_=t.getElevationForLngLatZoom(f,this.tileZoom);if(!(this.elevation-_))return;const E=d+a-_,I=Math.cos(this._pitch)*this.cameraToCenterDistance/E/c.b5(1,f.lat),k=this.scaleZoom(I/this.tileSize);this._elevation=_,this._center=f,this.zoom=k}setLocationAtPoint(t,a){const d=this.pointCoordinate(a),f=this.pointCoordinate(this.centerPoint),_=this.locationCoordinate(t),E=new c.Z(_.x-(d.x-f.x),_.y-(d.y-f.y));this.center=this.coordinateLocation(E),this._renderWorldCopies&&(this.center=this.center.wrap())}locationPoint(t,a){return a?this.coordinatePoint(this.locationCoordinate(t),a.getElevationForLngLatZoom(t,this.tileZoom),this.pixelMatrix3D):this.coordinatePoint(this.locationCoordinate(t))}pointLocation(t,a){return this.coordinateLocation(this.pointCoordinate(t,a))}locationCoordinate(t){return c.Z.fromLngLat(t)}coordinateLocation(t){return t&&t.toLngLat()}pointCoordinate(t,a){if(a){const V=a.pointCoordinate(t);if(V!=null)return V}const d=[t.x,t.y,0,1],f=[t.x,t.y,1,1];c.af(d,d,this.pixelMatrixInverse),c.af(f,f,this.pixelMatrixInverse);const _=d[3],E=f[3],I=d[1]/_,k=f[1]/E,z=d[2]/_,R=f[2]/E,O=z===R?0:(0-z)/(R-z);return new c.Z(c.y.number(d[0]/_,f[0]/E,O)/this.worldSize,c.y.number(I,k,O)/this.worldSize)}coordinatePoint(t,a=0,d=this.pixelMatrix){const f=[t.x*this.worldSize,t.y*this.worldSize,a,1];return c.af(f,f,d),new c.P(f[0]/f[3],f[1]/f[3])}getBounds(){const t=Math.max(0,this.height/2-this.getHorizon());return new Ce().extend(this.pointLocation(new c.P(0,t))).extend(this.pointLocation(new c.P(this.width,t))).extend(this.pointLocation(new c.P(this.width,this.height))).extend(this.pointLocation(new c.P(0,this.height)))}getMaxBounds(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new Ce([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null}getHorizon(){return Math.tan(Math.PI/2-this._pitch)*this.cameraToCenterDistance*.85}setMaxBounds(t){t?(this.lngRange=[t.getWest(),t.getEast()],this.latRange=[t.getSouth(),t.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-85.051129,Hn])}calculateTileMatrix(t){const a=t.canonical,d=this.worldSize/this.zoomScale(a.z),f=a.x+Math.pow(2,a.z)*t.wrap,_=c.an(new Float64Array(16));return c.J(_,_,[f*d,a.y*d,0]),c.K(_,_,[d/c.X,d/c.X,1]),_}calculatePosMatrix(t,a=!1){const d=t.key,f=a?this._alignedPosMatrixCache:this._posMatrixCache;if(f[d])return f[d];const _=this.calculateTileMatrix(t);return c.L(_,a?this.alignedModelViewProjectionMatrix:this.modelViewProjectionMatrix,_),f[d]=new Float32Array(_),f[d]}calculateFogMatrix(t){const a=t.key,d=this._fogMatrixCache;if(d[a])return d[a];const f=this.calculateTileMatrix(t);return c.L(f,this.fogMatrix,f),d[a]=new Float32Array(f),d[a]}customLayerMatrix(){return this.mercatorMatrix.slice()}getConstrained(t,a){a=c.ac(+a,this.minZoom,this.maxZoom);const d={center:new c.N(t.lng,t.lat),zoom:a};let f=this.lngRange;if(!this._renderWorldCopies&&f===null){const te=179.9999999999;f=[-te,te]}const _=this.tileSize*this.zoomScale(d.zoom);let E=0,I=_,k=0,z=_,R=0,O=0;const{x:V,y:X}=this.size;if(this.latRange){const te=this.latRange;E=c.Q(te[1])*_,I=c.Q(te[0])*_,I-E<X&&(R=X/(I-E))}f&&(k=c.b3(c.O(f[0])*_,0,_),z=c.b3(c.O(f[1])*_,0,_),z<k&&(z+=_),z-k<V&&(O=V/(z-k)));const{x:Q,y:ie}=this.project.call({worldSize:_},t);let le,ce;const me=Math.max(O||0,R||0);if(me){const te=new c.P(O?(z+k)/2:Q,R?(I+E)/2:ie);return d.center=this.unproject.call({worldSize:_},te).wrap(),d.zoom+=this.scaleZoom(me),d}if(this.latRange){const te=X/2;ie-te<E&&(ce=E+te),ie+te>I&&(ce=I-te)}if(f){const te=(k+z)/2;let xe=Q;this._renderWorldCopies&&(xe=c.b3(Q,te-_/2,te+_/2));const be=V/2;xe-be<k&&(le=k+be),xe+be>z&&(le=z-be)}if(le!==void 0||ce!==void 0){const te=new c.P(le??Q,ce??ie);d.center=this.unproject.call({worldSize:_},te).wrap()}return d}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const t=this._unmodified,{center:a,zoom:d}=this.getConstrained(this.center,this.zoom);this.center=a,this.zoom=d,this._unmodified=t,this._constraining=!1}_calcMatrices(){if(!this.height)return;const t=this.centerOffset,a=this.point.x,d=this.point.y;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height,this._pixelPerMeter=c.b5(1,this.center.lat)*this.worldSize;let f=c.an(new Float64Array(16));c.K(f,f,[this.width/2,-this.height/2,1]),c.J(f,f,[1,-1,0]),this.labelPlaneMatrix=f,f=c.an(new Float64Array(16)),c.K(f,f,[1,-1,1]),c.J(f,f,[-1,-1,0]),c.K(f,f,[2/this.width,2/this.height,1]),this.glCoordMatrix=f;const _=this.cameraToCenterDistance+this._elevation*this._pixelPerMeter/Math.cos(this._pitch),E=Math.min(this.elevation,this.minElevationForCurrentTile),I=_-E*this._pixelPerMeter/Math.cos(this._pitch),k=E<0?I:_,z=Math.PI/2+this._pitch,R=this._fov*(.5+t.y/this.height),O=Math.sin(R)*k/Math.sin(c.ac(Math.PI-z-R,.01,Math.PI-.01)),V=this.getHorizon(),X=2*Math.atan(V/this.cameraToCenterDistance)*(.5+t.y/(2*V)),Q=Math.sin(X)*k/Math.sin(c.ac(Math.PI-z-X,.01,Math.PI-.01)),ie=Math.min(O,Q);this.farZ=1.01*(Math.cos(Math.PI/2-this._pitch)*ie+k),this.nearZ=this.height/50,f=new Float64Array(16),c.b6(f,this._fov,this.width/this.height,this.nearZ,this.farZ),f[8]=2*-t.x/this.width,f[9]=2*t.y/this.height,this.projectionMatrix=c.ae(f),c.K(f,f,[1,-1,1]),c.J(f,f,[0,0,-this.cameraToCenterDistance]),c.b7(f,f,this._pitch),c.ad(f,f,this.angle),c.J(f,f,[-a,-d,0]),this.mercatorMatrix=c.K([],f,[this.worldSize,this.worldSize,this.worldSize]),c.K(f,f,[1,1,this._pixelPerMeter]),this.pixelMatrix=c.L(new Float64Array(16),this.labelPlaneMatrix,f),c.J(f,f,[0,0,-this.elevation]),this.modelViewProjectionMatrix=f,this.invModelViewProjectionMatrix=c.as([],f),this.fogMatrix=new Float64Array(16),c.b6(this.fogMatrix,this._fov,this.width/this.height,_,this.farZ),this.fogMatrix[8]=2*-t.x/this.width,this.fogMatrix[9]=2*t.y/this.height,c.K(this.fogMatrix,this.fogMatrix,[1,-1,1]),c.J(this.fogMatrix,this.fogMatrix,[0,0,-this.cameraToCenterDistance]),c.b7(this.fogMatrix,this.fogMatrix,this._pitch),c.ad(this.fogMatrix,this.fogMatrix,this.angle),c.J(this.fogMatrix,this.fogMatrix,[-a,-d,0]),c.K(this.fogMatrix,this.fogMatrix,[1,1,this._pixelPerMeter]),c.J(this.fogMatrix,this.fogMatrix,[0,0,-this.elevation]),this.pixelMatrix3D=c.L(new Float64Array(16),this.labelPlaneMatrix,f);const le=this.width%2/2,ce=this.height%2/2,me=Math.cos(this.angle),te=Math.sin(this.angle),xe=a-Math.round(a)+me*le+te*ce,be=d-Math.round(d)+me*ce+te*le,ze=new Float64Array(f);if(c.J(ze,ze,[xe>.5?xe-1:xe,be>.5?be-1:be,0]),this.alignedModelViewProjectionMatrix=ze,f=c.as(new Float64Array(16),this.pixelMatrix),!f)throw new Error("failed to invert matrix");this.pixelMatrixInverse=f,this._posMatrixCache={},this._alignedPosMatrixCache={},this._fogMatrixCache={}}maxPitchScaleFactor(){if(!this.pixelMatrixInverse)return 1;const t=this.pointCoordinate(new c.P(0,0)),a=[t.x*this.worldSize,t.y*this.worldSize,0,1];return c.af(a,a,this.pixelMatrix)[3]/this.cameraToCenterDistance}getCameraPoint(){const t=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new c.P(0,t))}getCameraQueryGeometry(t){const a=this.getCameraPoint();if(t.length===1)return[t[0],a];{let d=a.x,f=a.y,_=a.x,E=a.y;for(const I of t)d=Math.min(d,I.x),f=Math.min(f,I.y),_=Math.max(_,I.x),E=Math.max(E,I.y);return[new c.P(d,f),new c.P(_,f),new c.P(_,E),new c.P(d,E),new c.P(d,f)]}}lngLatToCameraDepth(t,a){const d=this.locationCoordinate(t),f=[d.x*this.worldSize,d.y*this.worldSize,a,1];return c.af(f,f,this.modelViewProjectionMatrix),f[2]/f[3]}}function Xl(y,t){let a,d=!1,f=null,_=null;const E=()=>{f=null,d&&(y.apply(_,a),f=setTimeout(E,t),d=!1)};return(...I)=>(d=!0,_=this,a=I,f||E(),f)}class Ei{constructor(t){this._getCurrentHash=()=>{const a=window.location.hash.replace("#","");if(this._hashName){let d;return a.split("&").map(f=>f.split("=")).forEach(f=>{f[0]===this._hashName&&(d=f)}),(d&&d[1]||"").split("/")}return a.split("/")},this._onHashChange=()=>{const a=this._getCurrentHash();if(a.length>=3&&!a.some(d=>isNaN(d))){const d=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(a[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+a[2],+a[1]],zoom:+a[0],bearing:d,pitch:+(a[4]||0)}),!0}return!1},this._updateHashUnthrottled=()=>{const a=window.location.href.replace(/(#.*)?$/,this.getHashString());window.history.replaceState(window.history.state,null,a)},this._removeHash=()=>{const a=this._getCurrentHash();if(a.length===0)return;const d=a.join("/");let f=d;f.split("&").length>0&&(f=f.split("&")[0]),this._hashName&&(f=`${this._hashName}=${d}`);let _=window.location.hash.replace(f,"");_.startsWith("#&")?_=_.slice(0,1)+_.slice(2):_==="#"&&(_="");let E=window.location.href.replace(/(#.+)?$/,_);E=E.replace("&&","&"),window.history.replaceState(window.history.state,null,E)},this._updateHash=Xl(this._updateHashUnthrottled,300),this._hashName=t&&encodeURIComponent(t)}addTo(t){return this._map=t,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),this._removeHash(),delete this._map,this}getHashString(t){const a=this._map.getCenter(),d=Math.round(100*this._map.getZoom())/100,f=Math.ceil((d*Math.LN2+Math.log(512/360/.5))/Math.LN10),_=Math.pow(10,f),E=Math.round(a.lng*_)/_,I=Math.round(a.lat*_)/_,k=this._map.getBearing(),z=this._map.getPitch();let R="";if(R+=t?`/${E}/${I}/${d}`:`${d}/${I}/${E}`,(k||z)&&(R+="/"+Math.round(10*k)/10),z&&(R+=`/${Math.round(z)}`),this._hashName){const O=this._hashName;let V=!1;const X=window.location.hash.slice(1).split("&").map(Q=>{const ie=Q.split("=")[0];return ie===O?(V=!0,`${ie}=${R}`):Q}).filter(Q=>Q);return V||X.push(`${O}=${R}`),`#${X.join("&")}`}return`#${R}`}}const xa={linearity:.3,easing:c.b8(0,0,.3,1)},fh=c.e({deceleration:2500,maxSpeed:1400},xa),dl=c.e({deceleration:20,maxSpeed:1400},xa),Kl=c.e({deceleration:1e3,maxSpeed:360},xa),wa=c.e({deceleration:1e3,maxSpeed:90},xa);class jn{constructor(t){this._map=t,this.clear()}clear(){this._inertiaBuffer=[]}record(t){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:G.now(),settings:t})}_drainInertiaBuffer(){const t=this._inertiaBuffer,a=G.now();for(;t.length>0&&a-t[0].time>160;)t.shift()}_onMoveEnd(t){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const a={zoom:0,bearing:0,pitch:0,pan:new c.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:_}of this._inertiaBuffer)a.zoom+=_.zoomDelta||0,a.bearing+=_.bearingDelta||0,a.pitch+=_.pitchDelta||0,_.panDelta&&a.pan._add(_.panDelta),_.around&&(a.around=_.around),_.pinchAround&&(a.pinchAround=_.pinchAround);const d=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,f={};if(a.pan.mag()){const _=fl(a.pan.mag(),d,c.e({},fh,t||{}));f.offset=a.pan.mult(_.amount/a.pan.mag()),f.center=this._map.transform.center,Yl(f,_)}if(a.zoom){const _=fl(a.zoom,d,dl);f.zoom=this._map.transform.zoom+_.amount,Yl(f,_)}if(a.bearing){const _=fl(a.bearing,d,Kl);f.bearing=this._map.transform.bearing+c.ac(_.amount,-179,179),Yl(f,_)}if(a.pitch){const _=fl(a.pitch,d,wa);f.pitch=this._map.transform.pitch+_.amount,Yl(f,_)}if(f.zoom||f.bearing){const _=a.pinchAround===void 0?a.around:a.pinchAround;f.around=_?this._map.unproject(_):this._map.getCenter()}return this.clear(),c.e(f,{noMoveStart:!0})}}function Yl(y,t){(!y.duration||y.duration<t.duration)&&(y.duration=t.duration,y.easing=t.easing)}function fl(y,t,a){const{maxSpeed:d,linearity:f,deceleration:_}=a,E=c.ac(y*f/(t/1e3),-d,d),I=Math.abs(E)/(_*f);return{easing:a.easing,duration:1e3*I,amount:E*(I/2)}}class $r extends c.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,a,d,f={}){const _=q.mousePos(a.getCanvas(),d),E=a.unproject(_);super(t,c.e({point:_,lngLat:E,originalEvent:d},f)),this._defaultPrevented=!1,this.target=a}}class ba extends c.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,a,d){const f=t==="touchend"?d.changedTouches:d.touches,_=q.touchPos(a.getCanvasContainer(),f),E=_.map(k=>a.unproject(k)),I=_.reduce((k,z,R,O)=>k.add(z.div(O.length)),new c.P(0,0));super(t,{points:_,point:I,lngLats:E,lngLat:a.unproject(I),originalEvent:d}),this._defaultPrevented=!1}}class Ad extends c.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,a,d){super(t,{originalEvent:d}),this._defaultPrevented=!1}}class Md{constructor(t,a){this._map=t,this._clickTolerance=a.clickTolerance}reset(){delete this._mousedownPos}wheel(t){return this._firePreventable(new Ad(t.type,this._map,t))}mousedown(t,a){return this._mousedownPos=a,this._firePreventable(new $r(t.type,this._map,t))}mouseup(t){this._map.fire(new $r(t.type,this._map,t))}click(t,a){this._mousedownPos&&this._mousedownPos.dist(a)>=this._clickTolerance||this._map.fire(new $r(t.type,this._map,t))}dblclick(t){return this._firePreventable(new $r(t.type,this._map,t))}mouseover(t){this._map.fire(new $r(t.type,this._map,t))}mouseout(t){this._map.fire(new $r(t.type,this._map,t))}touchstart(t){return this._firePreventable(new ba(t.type,this._map,t))}touchmove(t){this._map.fire(new ba(t.type,this._map,t))}touchend(t){this._map.fire(new ba(t.type,this._map,t))}touchcancel(t){this._map.fire(new ba(t.type,this._map,t))}_firePreventable(t){if(this._map.fire(t),t.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class cr{constructor(t){this._map=t}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(t){this._map.fire(new $r(t.type,this._map,t))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new $r("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(t){this._delayContextMenu?this._contextMenuEvent=t:this._ignoreContextMenu||this._map.fire(new $r(t.type,this._map,t)),this._map.listens("contextmenu")&&t.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Yr{constructor(t){this._map=t}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(t){return this.transform.pointLocation(c.P.convert(t),this._map.terrain)}}class di{constructor(t,a){this._map=t,this._tr=new Yr(t),this._el=t.getCanvasContainer(),this._container=t.getContainer(),this._clickTolerance=a.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(t,a){this.isEnabled()&&t.shiftKey&&t.button===0&&(q.disableDrag(),this._startPos=this._lastPos=a,this._active=!0)}mousemoveWindow(t,a){if(!this._active)return;const d=a;if(this._lastPos.equals(d)||!this._box&&d.dist(this._startPos)<this._clickTolerance)return;const f=this._startPos;this._lastPos=d,this._box||(this._box=q.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",t));const _=Math.min(f.x,d.x),E=Math.max(f.x,d.x),I=Math.min(f.y,d.y),k=Math.max(f.y,d.y);q.setTransform(this._box,`translate(${_}px,${I}px)`),this._box.style.width=E-_+"px",this._box.style.height=k-I+"px"}mouseupWindow(t,a){if(!this._active||t.button!==0)return;const d=this._startPos,f=a;if(this.reset(),q.suppressClick(),d.x!==f.x||d.y!==f.y)return this._map.fire(new c.k("boxzoomend",{originalEvent:t})),{cameraAnimation:_=>_.fitScreenCoordinates(d,f,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",t)}keydown(t){this._active&&t.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",t))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(q.remove(this._box),this._box=null),q.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(t,a){return this._map.fire(new c.k(t,{originalEvent:a}))}}function pl(y,t){if(y.length!==t.length)throw new Error(`The number of touches and points are not equal - touches ${y.length}, points ${t.length}`);const a={};for(let d=0;d<y.length;d++)a[y[d].identifier]=t[d];return a}class ml{constructor(t){this.reset(),this.numTouches=t.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(t,a,d){(this.centroid||d.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=t.timeStamp),d.length===this.numTouches&&(this.centroid=function(f){const _=new c.P(0,0);for(const E of f)_._add(E);return _.div(f.length)}(a),this.touches=pl(d,a)))}touchmove(t,a,d){if(this.aborted||!this.centroid)return;const f=pl(d,a);for(const _ in this.touches){const E=f[_];(!E||E.dist(this.touches[_])>30)&&(this.aborted=!0)}}touchend(t,a,d){if((!this.centroid||t.timeStamp-this.startTime>500)&&(this.aborted=!0),d.length===0){const f=!this.aborted&&this.centroid;if(this.reset(),f)return f}}}class Jl{constructor(t){this.singleTap=new ml(t),this.numTaps=t.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(t,a,d){this.singleTap.touchstart(t,a,d)}touchmove(t,a,d){this.singleTap.touchmove(t,a,d)}touchend(t,a,d){const f=this.singleTap.touchend(t,a,d);if(f){const _=t.timeStamp-this.lastTime<500,E=!this.lastTap||this.lastTap.dist(f)<30;if(_&&E||this.reset(),this.count++,this.lastTime=t.timeStamp,this.lastTap=f,this.count===this.numTaps)return this.reset(),f}}}class Sa{constructor(t){this._tr=new Yr(t),this._zoomIn=new Jl({numTouches:1,numTaps:2}),this._zoomOut=new Jl({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(t,a,d){this._zoomIn.touchstart(t,a,d),this._zoomOut.touchstart(t,a,d)}touchmove(t,a,d){this._zoomIn.touchmove(t,a,d),this._zoomOut.touchmove(t,a,d)}touchend(t,a,d){const f=this._zoomIn.touchend(t,a,d),_=this._zoomOut.touchend(t,a,d),E=this._tr;return f?(this._active=!0,t.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:I=>I.easeTo({duration:300,zoom:E.zoom+1,around:E.unproject(f)},{originalEvent:t})}):_?(this._active=!0,t.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:I=>I.easeTo({duration:300,zoom:E.zoom-1,around:E.unproject(_)},{originalEvent:t})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class hs{constructor(t){this._enabled=!!t.enable,this._moveStateManager=t.moveStateManager,this._clickTolerance=t.clickTolerance||1,this._moveFunction=t.move,this._activateOnStart=!!t.activateOnStart,t.assignEvents(this),this.reset()}reset(t){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(t)}_move(...t){const a=this._moveFunction(...t);if(a.bearingDelta||a.pitchDelta||a.around||a.panDelta)return this._active=!0,a}dragStart(t,a){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(t)&&(this._moveStateManager.startMove(t),this._lastPoint=a.length?a[0]:a,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(t,a){if(!this.isEnabled())return;const d=this._lastPoint;if(!d)return;if(t.preventDefault(),!this._moveStateManager.isValidMoveEvent(t))return void this.reset(t);const f=a.length?a[0]:a;return!this._moved&&f.dist(d)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=f,this._move(d,f))}dragEnd(t){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(t)&&(this._moved&&q.suppressClick(),this.reset(t))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const Ju={0:1,2:2};class Ho{constructor(t){this._correctEvent=t.checkCorrectEvent}startMove(t){const a=q.mouseButton(t);this._eventButton=a}endMove(t){delete this._eventButton}isValidStartEvent(t){return this._correctEvent(t)}isValidMoveEvent(t){return!function(a,d){const f=Ju[d];return a.buttons===void 0||(a.buttons&f)!==f}(t,this._eventButton)}isValidEndEvent(t){return q.mouseButton(t)===this._eventButton}}class _o{constructor(){this._firstTouch=void 0}_isOneFingerTouch(t){return t.targetTouches.length===1}_isSameTouchEvent(t){return t.targetTouches[0].identifier===this._firstTouch}startMove(t){this._firstTouch=t.targetTouches[0].identifier}endMove(t){delete this._firstTouch}isValidStartEvent(t){return this._isOneFingerTouch(t)}isValidMoveEvent(t){return this._isOneFingerTouch(t)&&this._isSameTouchEvent(t)}isValidEndEvent(t){return this._isOneFingerTouch(t)&&this._isSameTouchEvent(t)}}const Ta=y=>{y.mousedown=y.dragStart,y.mousemoveWindow=y.dragMove,y.mouseup=y.dragEnd,y.contextmenu=t=>{t.preventDefault()}},ph=({enable:y,clickTolerance:t,bearingDegreesPerPixelMoved:a=.8})=>{const d=new Ho({checkCorrectEvent:f=>q.mouseButton(f)===0&&f.ctrlKey||q.mouseButton(f)===2});return new hs({clickTolerance:t,move:(f,_)=>({bearingDelta:(_.x-f.x)*a}),moveStateManager:d,enable:y,assignEvents:Ta})},mh=({enable:y,clickTolerance:t,pitchDegreesPerPixelMoved:a=-.5})=>{const d=new Ho({checkCorrectEvent:f=>q.mouseButton(f)===0&&f.ctrlKey||q.mouseButton(f)===2});return new hs({clickTolerance:t,move:(f,_)=>({pitchDelta:(_.y-f.y)*a}),moveStateManager:d,enable:y,assignEvents:Ta})};class Ea{constructor(t,a){this._clickTolerance=t.clickTolerance||1,this._map=a,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new c.P(0,0)}_shouldBePrevented(t){return t<(this._map.cooperativeGestures.isEnabled()?2:1)}touchstart(t,a,d){return this._calculateTransform(t,a,d)}touchmove(t,a,d){if(this._active){if(!this._shouldBePrevented(d.length))return t.preventDefault(),this._calculateTransform(t,a,d);this._map.cooperativeGestures.notifyGestureBlocked("touch_pan",t)}}touchend(t,a,d){this._calculateTransform(t,a,d),this._active&&this._shouldBePrevented(d.length)&&this.reset()}touchcancel(){this.reset()}_calculateTransform(t,a,d){d.length>0&&(this._active=!0);const f=pl(d,a),_=new c.P(0,0),E=new c.P(0,0);let I=0;for(const z in f){const R=f[z],O=this._touches[z];O&&(_._add(R),E._add(R.sub(O)),I++,f[z]=R)}if(this._touches=f,this._shouldBePrevented(I)||!E.mag())return;const k=E.div(I);return this._sum._add(k),this._sum.mag()<this._clickTolerance?void 0:{around:_.div(I),panDelta:k}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Ca{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(t,a,d){this._firstTwoTouches||d.length<2||(this._firstTwoTouches=[d[0].identifier,d[1].identifier],this._start([a[0],a[1]]))}touchmove(t,a,d){if(!this._firstTwoTouches)return;t.preventDefault();const[f,_]=this._firstTwoTouches,E=Xo(d,a,f),I=Xo(d,a,_);if(!E||!I)return;const k=this._aroundCenter?null:E.add(I).div(2);return this._move([E,I],k,t)}touchend(t,a,d){if(!this._firstTwoTouches)return;const[f,_]=this._firstTwoTouches,E=Xo(d,a,f),I=Xo(d,a,_);E&&I||(this._active&&q.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(t){this._enabled=!0,this._aroundCenter=!!t&&t.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}}function Xo(y,t,a){for(let d=0;d<y.length;d++)if(y[d].identifier===a)return t[d]}function Ql(y,t){return Math.log(y/t)/Math.LN2}class gh extends Ca{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(t){this._startDistance=this._distance=t[0].dist(t[1])}_move(t,a){const d=this._distance;if(this._distance=t[0].dist(t[1]),this._active||!(Math.abs(Ql(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Ql(this._distance,d),pinchAround:a}}}function Qu(y,t){return 180*y.angleWith(t)/Math.PI}class _h extends Ca{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(t){this._startVector=this._vector=t[0].sub(t[1]),this._minDiameter=t[0].dist(t[1])}_move(t,a,d){const f=this._vector;if(this._vector=t[0].sub(t[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:Qu(this._vector,f),pinchAround:a}}_isBelowThreshold(t){this._minDiameter=Math.min(this._minDiameter,t.mag());const a=25/(Math.PI*this._minDiameter)*360,d=Qu(t,this._startVector);return Math.abs(d)<a}}function ec(y){return Math.abs(y.y)>Math.abs(y.x)}class _r extends Ca{constructor(t){super(),this._currentTouchCount=0,this._map=t}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(t,a,d){super.touchstart(t,a,d),this._currentTouchCount=d.length}_start(t){this._lastPoints=t,ec(t[0].sub(t[1]))&&(this._valid=!1)}_move(t,a,d){if(this._map.cooperativeGestures.isEnabled()&&this._currentTouchCount<3)return;const f=t[0].sub(this._lastPoints[0]),_=t[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(f,_,d.timeStamp),this._valid?(this._lastPoints=t,this._active=!0,{pitchDelta:(f.y+_.y)/2*-.5}):void 0}gestureBeginsVertically(t,a,d){if(this._valid!==void 0)return this._valid;const f=t.mag()>=2,_=a.mag()>=2;if(!f&&!_)return;if(!f||!_)return this._firstMove===void 0&&(this._firstMove=d),d-this._firstMove<100&&void 0;const E=t.y>0==a.y>0;return ec(t)&&ec(a)&&E}}const ni={panStep:100,bearingStep:15,pitchStep:10};class ds{constructor(t){this._tr=new Yr(t);const a=ni;this._panStep=a.panStep,this._bearingStep=a.bearingStep,this._pitchStep=a.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(t){if(t.altKey||t.ctrlKey||t.metaKey)return;let a=0,d=0,f=0,_=0,E=0;switch(t.keyCode){case 61:case 107:case 171:case 187:a=1;break;case 189:case 109:case 173:a=-1;break;case 37:t.shiftKey?d=-1:(t.preventDefault(),_=-1);break;case 39:t.shiftKey?d=1:(t.preventDefault(),_=1);break;case 38:t.shiftKey?f=1:(t.preventDefault(),E=-1);break;case 40:t.shiftKey?f=-1:(t.preventDefault(),E=1);break;default:return}return this._rotationDisabled&&(d=0,f=0),{cameraAnimation:I=>{const k=this._tr;I.easeTo({duration:300,easeId:"keyboardHandler",easing:Qs,zoom:a?Math.round(k.zoom)+a*(t.shiftKey?2:1):k.zoom,bearing:k.bearing+d*this._bearingStep,pitch:k.pitch+f*this._pitchStep,offset:[-_*this._panStep,-E*this._panStep],center:k.center},{originalEvent:t})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Qs(y){return y*(2-y)}const tc=4.000244140625;class Os{constructor(t,a){this._onTimeout=d=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(d)},this._map=t,this._tr=new Yr(t),this._triggerRenderFrame=a,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222}setZoomRate(t){this._defaultZoomRate=t}setWheelZoomRate(t){this._wheelZoomRate=t}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(t){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!t&&t.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}_shouldBePrevented(t){return!!this._map.cooperativeGestures.isEnabled()&&!(t.ctrlKey||this._map.cooperativeGestures.isBypassed(t))}wheel(t){if(!this.isEnabled())return;if(this._shouldBePrevented(t))return void this._map.cooperativeGestures.notifyGestureBlocked("wheel_zoom",t);let a=t.deltaMode===WheelEvent.DOM_DELTA_LINE?40*t.deltaY:t.deltaY;const d=G.now(),f=d-(this._lastWheelEventTime||0);this._lastWheelEventTime=d,a!==0&&a%tc==0?this._type="wheel":a!==0&&Math.abs(a)<4?this._type="trackpad":f>400?(this._type=null,this._lastValue=a,this._timeout=setTimeout(this._onTimeout,40,t)):this._type||(this._type=Math.abs(f*a)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,a+=this._lastValue)),t.shiftKey&&a&&(a/=4),this._type&&(this._lastWheelEvent=t,this._delta-=a,this._active||this._start(t)),t.preventDefault()}_start(t){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const a=q.mousePos(this._map.getCanvas(),t),d=this._tr;this._around=a.y>d.transform.height/2-d.transform.getHorizon()?c.N.convert(this._aroundCenter?d.center:d.unproject(a)):c.N.convert(d.center),this._aroundPoint=d.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const t=this._tr.transform;if(this._delta!==0){const k=this._type==="wheel"&&Math.abs(this._delta)>tc?this._wheelZoomRate:this._defaultZoomRate;let z=2/(1+Math.exp(-Math.abs(this._delta*k)));this._delta<0&&z!==0&&(z=1/z);const R=typeof this._targetZoom=="number"?t.zoomScale(this._targetZoom):t.scale;this._targetZoom=Math.min(t.maxZoom,Math.max(t.minZoom,t.scaleZoom(R*z))),this._type==="wheel"&&(this._startZoom=t.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const a=typeof this._targetZoom=="number"?this._targetZoom:t.zoom,d=this._startZoom,f=this._easing;let _,E=!1;const I=G.now()-this._lastWheelEventTime;if(this._type==="wheel"&&d&&f&&I){const k=Math.min(I/200,1),z=f(k);_=c.y.number(d,a,z),k<1?this._frameId||(this._frameId=!0):E=!0}else _=a,E=!0;return this._active=!0,E&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!E,zoomDelta:_-t.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(t){let a=c.b9;if(this._prevEase){const d=this._prevEase,f=(G.now()-d.start)/d.duration,_=d.easing(f+.01)-d.easing(f),E=.27/Math.sqrt(_*_+1e-4)*.01,I=Math.sqrt(.0729-E*E);a=c.b8(E,I,.25,1)}return this._prevEase={start:G.now(),duration:t,easing:a},a}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class yo{constructor(t,a){this._clickZoom=t,this._tapZoom=a}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class eu{constructor(t){this._tr=new Yr(t),this.reset()}reset(){this._active=!1}dblclick(t,a){return t.preventDefault(),{cameraAnimation:d=>{d.easeTo({duration:300,zoom:this._tr.zoom+(t.shiftKey?-1:1),around:this._tr.unproject(a)},{originalEvent:t})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class yh{constructor(){this._tap=new Jl({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(t,a,d){if(!this._swipePoint)if(this._tapTime){const f=a[0],_=t.timeStamp-this._tapTime<500,E=this._tapPoint.dist(f)<30;_&&E?d.length>0&&(this._swipePoint=f,this._swipeTouch=d[0].identifier):this.reset()}else this._tap.touchstart(t,a,d)}touchmove(t,a,d){if(this._tapTime){if(this._swipePoint){if(d[0].identifier!==this._swipeTouch)return;const f=a[0],_=f.y-this._swipePoint.y;return this._swipePoint=f,t.preventDefault(),this._active=!0,{zoomDelta:_/128}}}else this._tap.touchmove(t,a,d)}touchend(t,a,d){if(this._tapTime)this._swipePoint&&d.length===0&&this.reset();else{const f=this._tap.touchend(t,a,d);f&&(this._tapTime=t.timeStamp,this._tapPoint=f)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Ia{constructor(t,a,d){this._el=t,this._mousePan=a,this._touchPan=d}enable(t){this._inertiaOptions=t||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class gl{constructor(t,a,d){this._pitchWithRotate=t.pitchWithRotate,this._mouseRotate=a,this._mousePitch=d}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class ka{constructor(t,a,d,f){this._el=t,this._touchZoom=a,this._touchRotate=d,this._tapDragZoom=f,this._rotationDisabled=!1,this._enabled=!0}enable(t){this._touchZoom.enable(t),this._rotationDisabled||this._touchRotate.enable(t),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}class vo{constructor(t,a){this._bypassKey=navigator.userAgent.indexOf("Mac")!==-1?"metaKey":"ctrlKey",this._map=t,this._options=a,this._enabled=!1}isActive(){return!1}reset(){}_setupUI(){if(this._container)return;const t=this._map.getCanvasContainer();t.classList.add("maplibregl-cooperative-gestures"),this._container=q.create("div","maplibregl-cooperative-gesture-screen",t);let a=this._map._getUIString("CooperativeGesturesHandler.WindowsHelpText");this._bypassKey==="metaKey"&&(a=this._map._getUIString("CooperativeGesturesHandler.MacHelpText"));const d=this._map._getUIString("CooperativeGesturesHandler.MobileHelpText"),f=document.createElement("div");f.className="maplibregl-desktop-message",f.textContent=a,this._container.appendChild(f);const _=document.createElement("div");_.className="maplibregl-mobile-message",_.textContent=d,this._container.appendChild(_),this._container.setAttribute("aria-hidden","true")}_destroyUI(){this._container&&(q.remove(this._container),this._map.getCanvasContainer().classList.remove("maplibregl-cooperative-gestures")),delete this._container}enable(){this._setupUI(),this._enabled=!0}disable(){this._enabled=!1,this._destroyUI()}isEnabled(){return this._enabled}isBypassed(t){return t[this._bypassKey]}notifyGestureBlocked(t,a){this._enabled&&(this._map.fire(new c.k("cooperativegestureprevented",{gestureType:t,originalEvent:a})),this._container.classList.add("maplibregl-show"),setTimeout(()=>{this._container.classList.remove("maplibregl-show")},100))}}const ri=y=>y.zoom||y.drag||y.pitch||y.rotate;class vt extends c.k{}function nc(y){return y.panDelta&&y.panDelta.mag()||y.zoomDelta||y.bearingDelta||y.pitchDelta}class vh{constructor(t,a){this.handleWindowEvent=f=>{this.handleEvent(f,`${f.type}Window`)},this.handleEvent=(f,_)=>{if(f.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const E=f.type==="renderFrame"?void 0:f,I={needsRenderFrame:!1},k={},z={},R=f.touches,O=R?this._getMapTouches(R):void 0,V=O?q.touchPos(this._map.getCanvas(),O):q.mousePos(this._map.getCanvas(),f);for(const{handlerName:ie,handler:le,allowed:ce}of this._handlers){if(!le.isEnabled())continue;let me;this._blockedByActive(z,ce,ie)?le.reset():le[_||f.type]&&(me=le[_||f.type](f,V,O),this.mergeHandlerResult(I,k,me,ie,E),me&&me.needsRenderFrame&&this._triggerRenderFrame()),(me||le.isActive())&&(z[ie]=le)}const X={};for(const ie in this._previousActiveHandlers)z[ie]||(X[ie]=E);this._previousActiveHandlers=z,(Object.keys(X).length||nc(I))&&(this._changes.push([I,k,X]),this._triggerRenderFrame()),(Object.keys(z).length||nc(I))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:Q}=I;Q&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],Q(this._map))},this._map=t,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new jn(t),this._bearingSnap=a.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(a);const d=this._el;this._listeners=[[d,"touchstart",{passive:!0}],[d,"touchmove",{passive:!1}],[d,"touchend",void 0],[d,"touchcancel",void 0],[d,"mousedown",void 0],[d,"mousemove",void 0],[d,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[d,"mouseover",void 0],[d,"mouseout",void 0],[d,"dblclick",void 0],[d,"click",void 0],[d,"keydown",{capture:!1}],[d,"keyup",void 0],[d,"wheel",{passive:!1}],[d,"contextmenu",void 0],[window,"blur",void 0]];for(const[f,_,E]of this._listeners)q.addEventListener(f,_,f===document?this.handleWindowEvent:this.handleEvent,E)}destroy(){for(const[t,a,d]of this._listeners)q.removeEventListener(t,a,t===document?this.handleWindowEvent:this.handleEvent,d)}_addDefaultHandlers(t){const a=this._map,d=a.getCanvasContainer();this._add("mapEvent",new Md(a,t));const f=a.boxZoom=new di(a,t);this._add("boxZoom",f),t.interactive&&t.boxZoom&&f.enable();const _=a.cooperativeGestures=new vo(a,t.cooperativeGestures);this._add("cooperativeGestures",_),t.cooperativeGestures&&_.enable();const E=new Sa(a),I=new eu(a);a.doubleClickZoom=new yo(I,E),this._add("tapZoom",E),this._add("clickZoom",I),t.interactive&&t.doubleClickZoom&&a.doubleClickZoom.enable();const k=new yh;this._add("tapDragZoom",k);const z=a.touchPitch=new _r(a);this._add("touchPitch",z),t.interactive&&t.touchPitch&&a.touchPitch.enable(t.touchPitch);const R=ph(t),O=mh(t);a.dragRotate=new gl(t,R,O),this._add("mouseRotate",R,["mousePitch"]),this._add("mousePitch",O,["mouseRotate"]),t.interactive&&t.dragRotate&&a.dragRotate.enable();const V=(({enable:me,clickTolerance:te})=>{const xe=new Ho({checkCorrectEvent:be=>q.mouseButton(be)===0&&!be.ctrlKey});return new hs({clickTolerance:te,move:(be,ze)=>({around:ze,panDelta:ze.sub(be)}),activateOnStart:!0,moveStateManager:xe,enable:me,assignEvents:Ta})})(t),X=new Ea(t,a);a.dragPan=new Ia(d,V,X),this._add("mousePan",V),this._add("touchPan",X,["touchZoom","touchRotate"]),t.interactive&&t.dragPan&&a.dragPan.enable(t.dragPan);const Q=new _h,ie=new gh;a.touchZoomRotate=new ka(d,ie,Q,k),this._add("touchRotate",Q,["touchPan","touchZoom"]),this._add("touchZoom",ie,["touchPan","touchRotate"]),t.interactive&&t.touchZoomRotate&&a.touchZoomRotate.enable(t.touchZoomRotate);const le=a.scrollZoom=new Os(a,()=>this._triggerRenderFrame());this._add("scrollZoom",le,["mousePan"]),t.interactive&&t.scrollZoom&&a.scrollZoom.enable(t.scrollZoom);const ce=a.keyboard=new ds(a);this._add("keyboard",ce),t.interactive&&t.keyboard&&a.keyboard.enable(),this._add("blockableMapEvent",new cr(a))}_add(t,a,d){this._handlers.push({handlerName:t,handler:a,allowed:d}),this._handlersById[t]=a}stop(t){if(!this._updatingCamera){for(const{handler:a}of this._handlers)a.reset();this._inertia.clear(),this._fireEvents({},{},t),this._changes=[]}}isActive(){for(const{handler:t}of this._handlers)if(t.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!ri(this._eventsInProgress)||this.isZooming()}_blockedByActive(t,a,d){for(const f in t)if(f!==d&&(!a||a.indexOf(f)<0))return!0;return!1}_getMapTouches(t){const a=[];for(const d of t)this._el.contains(d.target)&&a.push(d);return a}mergeHandlerResult(t,a,d,f,_){if(!d)return;c.e(t,d);const E={handlerName:f,originalEvent:d.originalEvent||_};d.zoomDelta!==void 0&&(a.zoom=E),d.panDelta!==void 0&&(a.drag=E),d.pitchDelta!==void 0&&(a.pitch=E),d.bearingDelta!==void 0&&(a.rotate=E)}_applyChanges(){const t={},a={},d={};for(const[f,_,E]of this._changes)f.panDelta&&(t.panDelta=(t.panDelta||new c.P(0,0))._add(f.panDelta)),f.zoomDelta&&(t.zoomDelta=(t.zoomDelta||0)+f.zoomDelta),f.bearingDelta&&(t.bearingDelta=(t.bearingDelta||0)+f.bearingDelta),f.pitchDelta&&(t.pitchDelta=(t.pitchDelta||0)+f.pitchDelta),f.around!==void 0&&(t.around=f.around),f.pinchAround!==void 0&&(t.pinchAround=f.pinchAround),f.noInertia&&(t.noInertia=f.noInertia),c.e(a,_),c.e(d,E);this._updateMapTransform(t,a,d),this._changes=[]}_updateMapTransform(t,a,d){const f=this._map,_=f._getTransformForUpdate(),E=f.terrain;if(!(nc(t)||E&&this._terrainMovement))return this._fireEvents(a,d,!0);let{panDelta:I,zoomDelta:k,bearingDelta:z,pitchDelta:R,around:O,pinchAround:V}=t;V!==void 0&&(O=V),f._stop(!0),O=O||f.transform.centerPoint;const X=_.pointLocation(I?O.sub(I):O);z&&(_.bearing+=z),R&&(_.pitch+=R),k&&(_.zoom+=k),E?this._terrainMovement||!a.drag&&!a.zoom?a.drag&&this._terrainMovement?_.center=_.pointLocation(_.centerPoint.sub(I)):_.setLocationAtPoint(X,O):(this._terrainMovement=!0,this._map._elevationFreeze=!0,_.setLocationAtPoint(X,O)):_.setLocationAtPoint(X,O),f._applyUpdatedTransform(_),this._map._update(),t.noInertia||this._inertia.record(t),this._fireEvents(a,d,!0)}_fireEvents(t,a,d){const f=ri(this._eventsInProgress),_=ri(t),E={};for(const O in t){const{originalEvent:V}=t[O];this._eventsInProgress[O]||(E[`${O}start`]=V),this._eventsInProgress[O]=t[O]}!f&&_&&this._fireEvent("movestart",_.originalEvent);for(const O in E)this._fireEvent(O,E[O]);_&&this._fireEvent("move",_.originalEvent);for(const O in t){const{originalEvent:V}=t[O];this._fireEvent(O,V)}const I={};let k;for(const O in this._eventsInProgress){const{handlerName:V,originalEvent:X}=this._eventsInProgress[O];this._handlersById[V].isActive()||(delete this._eventsInProgress[O],k=a[V]||X,I[`${O}end`]=k)}for(const O in I)this._fireEvent(O,I[O]);const z=ri(this._eventsInProgress),R=(f||_)&&!z;if(R&&this._terrainMovement){this._map._elevationFreeze=!1,this._terrainMovement=!1;const O=this._map._getTransformForUpdate();O.recalculateZoom(this._map.terrain),this._map._applyUpdatedTransform(O)}if(d&&R){this._updatingCamera=!0;const O=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),V=X=>X!==0&&-this._bearingSnap<X&&X<this._bearingSnap;!O||!O.essential&&G.prefersReducedMotion?(this._map.fire(new c.k("moveend",{originalEvent:k})),V(this._map.getBearing())&&this._map.resetNorth()):(V(O.bearing||this._map.getBearing())&&(O.bearing=0),O.freezeElevation=!0,this._map.easeTo(O,{originalEvent:k})),this._updatingCamera=!1}}_fireEvent(t,a){this._map.fire(new c.k(t,a?{originalEvent:a}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(t=>{delete this._frameId,this.handleEvent(new vt("renderFrame",{timeStamp:t})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}class zd extends c.E{constructor(t,a){super(),this._renderFrameCallback=()=>{const d=Math.min((G.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(d)),d<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=t,this._bearingSnap=a.bearingSnap,this.on("moveend",()=>{delete this._requestedCameraState})}getCenter(){return new c.N(this.transform.center.lng,this.transform.center.lat)}setCenter(t,a){return this.jumpTo({center:t},a)}panBy(t,a,d){return t=c.P.convert(t).mult(-1),this.panTo(this.transform.center,c.e({offset:t},a),d)}panTo(t,a,d){return this.easeTo(c.e({center:t},a),d)}getZoom(){return this.transform.zoom}setZoom(t,a){return this.jumpTo({zoom:t},a),this}zoomTo(t,a,d){return this.easeTo(c.e({zoom:t},a),d)}zoomIn(t,a){return this.zoomTo(this.getZoom()+1,t,a),this}zoomOut(t,a){return this.zoomTo(this.getZoom()-1,t,a),this}getBearing(){return this.transform.bearing}setBearing(t,a){return this.jumpTo({bearing:t},a),this}getPadding(){return this.transform.padding}setPadding(t,a){return this.jumpTo({padding:t},a),this}rotateTo(t,a,d){return this.easeTo(c.e({bearing:t},a),d)}resetNorth(t,a){return this.rotateTo(0,c.e({duration:1e3},t),a),this}resetNorthPitch(t,a){return this.easeTo(c.e({bearing:0,pitch:0,duration:1e3},t),a),this}snapToNorth(t,a){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(t,a):this}getPitch(){return this.transform.pitch}setPitch(t,a){return this.jumpTo({pitch:t},a),this}cameraForBounds(t,a){t=Ce.convert(t).adjustAntiMeridian();const d=a&&a.bearing||0;return this._cameraForBoxAndBearing(t.getNorthWest(),t.getSouthEast(),d,a)}_cameraForBoxAndBearing(t,a,d,f){const _={top:0,bottom:0,right:0,left:0};if(typeof(f=c.e({padding:_,offset:[0,0],maxZoom:this.transform.maxZoom},f)).padding=="number"){const st=f.padding;f.padding={top:st,bottom:st,right:st,left:st}}f.padding=c.e(_,f.padding);const E=this.transform,I=E.padding,k=new Ce(t,a),z=E.project(k.getNorthWest()),R=E.project(k.getNorthEast()),O=E.project(k.getSouthEast()),V=E.project(k.getSouthWest()),X=c.ba(-d),Q=z.rotate(X),ie=R.rotate(X),le=O.rotate(X),ce=V.rotate(X),me=new c.P(Math.max(Q.x,ie.x,ce.x,le.x),Math.max(Q.y,ie.y,ce.y,le.y)),te=new c.P(Math.min(Q.x,ie.x,ce.x,le.x),Math.min(Q.y,ie.y,ce.y,le.y)),xe=me.sub(te),be=(E.width-(I.left+I.right+f.padding.left+f.padding.right))/xe.x,ze=(E.height-(I.top+I.bottom+f.padding.top+f.padding.bottom))/xe.y;if(ze<0||be<0)return void c.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");const qe=Math.min(E.scaleZoom(E.scale*Math.min(be,ze)),f.maxZoom),Qe=c.P.convert(f.offset),at=new c.P((f.padding.left-f.padding.right)/2,(f.padding.top-f.padding.bottom)/2).rotate(c.ba(d)),pt=Qe.add(at).mult(E.scale/E.zoomScale(qe));return{center:E.unproject(z.add(O).div(2).sub(pt)),zoom:qe,bearing:d}}fitBounds(t,a,d){return this._fitInternal(this.cameraForBounds(t,a),a,d)}fitScreenCoordinates(t,a,d,f,_){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(c.P.convert(t)),this.transform.pointLocation(c.P.convert(a)),d,f),f,_)}_fitInternal(t,a,d){return t?(delete(a=c.e(t,a)).padding,a.linear?this.easeTo(a,d):this.flyTo(a,d)):this}jumpTo(t,a){this.stop();const d=this._getTransformForUpdate();let f=!1,_=!1,E=!1;return"zoom"in t&&d.zoom!==+t.zoom&&(f=!0,d.zoom=+t.zoom),t.center!==void 0&&(d.center=c.N.convert(t.center)),"bearing"in t&&d.bearing!==+t.bearing&&(_=!0,d.bearing=+t.bearing),"pitch"in t&&d.pitch!==+t.pitch&&(E=!0,d.pitch=+t.pitch),t.padding==null||d.isPaddingEqual(t.padding)||(d.padding=t.padding),this._applyUpdatedTransform(d),this.fire(new c.k("movestart",a)).fire(new c.k("move",a)),f&&this.fire(new c.k("zoomstart",a)).fire(new c.k("zoom",a)).fire(new c.k("zoomend",a)),_&&this.fire(new c.k("rotatestart",a)).fire(new c.k("rotate",a)).fire(new c.k("rotateend",a)),E&&this.fire(new c.k("pitchstart",a)).fire(new c.k("pitch",a)).fire(new c.k("pitchend",a)),this.fire(new c.k("moveend",a))}calculateCameraOptionsFromTo(t,a,d,f=0){const _=c.Z.fromLngLat(t,a),E=c.Z.fromLngLat(d,f),I=E.x-_.x,k=E.y-_.y,z=E.z-_.z,R=Math.hypot(I,k,z);if(R===0)throw new Error("Can't calculate camera options with same From and To");const O=Math.hypot(I,k),V=this.transform.scaleZoom(this.transform.cameraToCenterDistance/R/this.transform.tileSize),X=180*Math.atan2(I,-k)/Math.PI;let Q=180*Math.acos(O/R)/Math.PI;return Q=z<0?90-Q:90+Q,{center:E.toLngLat(),zoom:V,pitch:Q,bearing:X}}easeTo(t,a){var d;this._stop(!1,t.easeId),((t=c.e({offset:[0,0],duration:500,easing:c.b9},t)).animate===!1||!t.essential&&G.prefersReducedMotion)&&(t.duration=0);const f=this._getTransformForUpdate(),_=f.zoom,E=f.bearing,I=f.pitch,k=f.padding,z="bearing"in t?this._normalizeBearing(t.bearing,E):E,R="pitch"in t?+t.pitch:I,O="padding"in t?t.padding:f.padding,V=c.P.convert(t.offset);let X=f.centerPoint.add(V);const Q=f.pointLocation(X),{center:ie,zoom:le}=f.getConstrained(c.N.convert(t.center||Q),(d=t.zoom)!==null&&d!==void 0?d:_);this._normalizeCenter(ie,f);const ce=f.project(Q),me=f.project(ie).sub(ce),te=f.zoomScale(le-_);let xe,be;t.around&&(xe=c.N.convert(t.around),be=f.locationPoint(xe));const ze={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||le!==_,this._rotating=this._rotating||E!==z,this._pitching=this._pitching||R!==I,this._padding=!f.isPaddingEqual(O),this._easeId=t.easeId,this._prepareEase(a,t.noMoveStart,ze),this.terrain&&this._prepareElevation(ie),this._ease(qe=>{if(this._zooming&&(f.zoom=c.y.number(_,le,qe)),this._rotating&&(f.bearing=c.y.number(E,z,qe)),this._pitching&&(f.pitch=c.y.number(I,R,qe)),this._padding&&(f.interpolatePadding(k,O,qe),X=f.centerPoint.add(V)),this.terrain&&!t.freezeElevation&&this._updateElevation(qe),xe)f.setLocationAtPoint(xe,be);else{const Qe=f.zoomScale(f.zoom-_),at=le>_?Math.min(2,te):Math.max(.5,te),pt=Math.pow(at,1-qe),st=f.unproject(ce.add(me.mult(qe*pt)).mult(Qe));f.setLocationAtPoint(f.renderWorldCopies?st.wrap():st,X)}this._applyUpdatedTransform(f),this._fireMoveEvents(a)},qe=>{this.terrain&&t.freezeElevation&&this._finalizeElevation(),this._afterEase(a,qe)},t),this}_prepareEase(t,a,d={}){this._moving=!0,a||d.moving||this.fire(new c.k("movestart",t)),this._zooming&&!d.zooming&&this.fire(new c.k("zoomstart",t)),this._rotating&&!d.rotating&&this.fire(new c.k("rotatestart",t)),this._pitching&&!d.pitching&&this.fire(new c.k("pitchstart",t))}_prepareElevation(t){this._elevationCenter=t,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(t,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(t){this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);const a=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(t<1&&a!==this._elevationTarget){const d=this._elevationTarget-this._elevationStart;this._elevationStart+=t*(d-(a-(d*t+this._elevationStart))/(1-t)),this._elevationTarget=a}this.transform.elevation=c.y.number(this._elevationStart,this._elevationTarget,t)}_finalizeElevation(){this._elevationFreeze=!1,this.transform.recalculateZoom(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate||this.terrain?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_elevateCameraIfInsideTerrain(t){const a=t.getCameraPosition(),d=this.terrain.getElevationForLngLatZoom(a.lngLat,t.zoom);if(a.altitude<d){const f=this.calculateCameraOptionsFromTo(a.lngLat,d,t.center,t.elevation);return{pitch:f.pitch,zoom:f.zoom}}return{}}_applyUpdatedTransform(t){const a=[];if(this.terrain&&a.push(f=>this._elevateCameraIfInsideTerrain(f)),this.transformCameraUpdate&&a.push(f=>this.transformCameraUpdate(f)),!a.length)return;const d=t.clone();for(const f of a){const _=d.clone(),{center:E,zoom:I,pitch:k,bearing:z,elevation:R}=f(_);E&&(_.center=E),I!==void 0&&(_.zoom=I),k!==void 0&&(_.pitch=k),z!==void 0&&(_.bearing=z),R!==void 0&&(_.elevation=R),d.apply(_)}this.transform.apply(d)}_fireMoveEvents(t){this.fire(new c.k("move",t)),this._zooming&&this.fire(new c.k("zoom",t)),this._rotating&&this.fire(new c.k("rotate",t)),this._pitching&&this.fire(new c.k("pitch",t))}_afterEase(t,a){if(this._easeId&&a&&this._easeId===a)return;delete this._easeId;const d=this._zooming,f=this._rotating,_=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,d&&this.fire(new c.k("zoomend",t)),f&&this.fire(new c.k("rotateend",t)),_&&this.fire(new c.k("pitchend",t)),this.fire(new c.k("moveend",t))}flyTo(t,a){var d;if(!t.essential&&G.prefersReducedMotion){const tt=c.M(t,["center","zoom","bearing","pitch","around"]);return this.jumpTo(tt,a)}this.stop(),t=c.e({offset:[0,0],speed:1.2,curve:1.42,easing:c.b9},t);const f=this._getTransformForUpdate(),_=f.zoom,E=f.bearing,I=f.pitch,k=f.padding,z="bearing"in t?this._normalizeBearing(t.bearing,E):E,R="pitch"in t?+t.pitch:I,O="padding"in t?t.padding:f.padding,V=c.P.convert(t.offset);let X=f.centerPoint.add(V);const Q=f.pointLocation(X),{center:ie,zoom:le}=f.getConstrained(c.N.convert(t.center||Q),(d=t.zoom)!==null&&d!==void 0?d:_);this._normalizeCenter(ie,f);const ce=f.zoomScale(le-_),me=f.project(Q),te=f.project(ie).sub(me);let xe=t.curve;const be=Math.max(f.width,f.height),ze=be/ce,qe=te.mag();if("minZoom"in t){const tt=c.ac(Math.min(t.minZoom,_,le),f.minZoom,f.maxZoom),jt=be/f.zoomScale(tt-_);xe=Math.sqrt(jt/qe*2)}const Qe=xe*xe;function at(tt){const jt=(ze*ze-be*be+(tt?-1:1)*Qe*Qe*qe*qe)/(2*(tt?ze:be)*Qe*qe);return Math.log(Math.sqrt(jt*jt+1)-jt)}function pt(tt){return(Math.exp(tt)-Math.exp(-tt))/2}function st(tt){return(Math.exp(tt)+Math.exp(-tt))/2}const ot=at(!1);let wt=function(tt){return st(ot)/st(ot+xe*tt)},Wt=function(tt){return be*((st(ot)*(pt(jt=ot+xe*tt)/st(jt))-pt(ot))/Qe)/qe;var jt},ht=(at(!0)-ot)/xe;if(Math.abs(qe)<1e-6||!isFinite(ht)){if(Math.abs(be-ze)<1e-6)return this.easeTo(t,a);const tt=ze<be?-1:1;ht=Math.abs(Math.log(ze/be))/xe,Wt=()=>0,wt=jt=>Math.exp(tt*xe*jt)}return t.duration="duration"in t?+t.duration:1e3*ht/("screenSpeed"in t?+t.screenSpeed/xe:+t.speed),t.maxDuration&&t.duration>t.maxDuration&&(t.duration=0),this._zooming=!0,this._rotating=E!==z,this._pitching=R!==I,this._padding=!f.isPaddingEqual(O),this._prepareEase(a,!1),this.terrain&&this._prepareElevation(ie),this._ease(tt=>{const jt=tt*ht,sr=1/wt(jt);f.zoom=tt===1?le:_+f.scaleZoom(sr),this._rotating&&(f.bearing=c.y.number(E,z,tt)),this._pitching&&(f.pitch=c.y.number(I,R,tt)),this._padding&&(f.interpolatePadding(k,O,tt),X=f.centerPoint.add(V)),this.terrain&&!t.freezeElevation&&this._updateElevation(tt);const $t=tt===1?ie:f.unproject(me.add(te.mult(Wt(jt))).mult(sr));f.setLocationAtPoint(f.renderWorldCopies?$t.wrap():$t,X),this._applyUpdatedTransform(f),this._fireMoveEvents(a)},()=>{this.terrain&&t.freezeElevation&&this._finalizeElevation(),this._afterEase(a)},t),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(t,a){var d;if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const f=this._onEaseEnd;delete this._onEaseEnd,f.call(this,a)}return t||(d=this.handlers)===null||d===void 0||d.stop(!1),this}_ease(t,a,d){d.animate===!1||d.duration===0?(t(1),a()):(this._easeStart=G.now(),this._easeOptions=d,this._onEaseFrame=t,this._onEaseEnd=a,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(t,a){t=c.b3(t,-180,180);const d=Math.abs(t-a);return Math.abs(t-360-a)<d&&(t-=360),Math.abs(t+360-a)<d&&(t+=360),t}_normalizeCenter(t,a){if(!a.renderWorldCopies||a.lngRange)return;const d=t.lng-a.center.lng;t.lng+=d>180?-360:d<-180?360:0}queryTerrainElevation(t){return this.terrain?this.terrain.getElevationForLngLatZoom(c.N.convert(t),this.transform.tileZoom)-this.transform.elevation:null}}const _l={compact:!0,customAttribution:'<a href="https://maplibre.org/" target="_blank">MapLibre</a>'};class xo{constructor(t=_l){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=a=>{!a||a.sourceDataType!=="metadata"&&a.sourceDataType!=="visibility"&&a.dataType!=="style"&&a.type!=="terrain"||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=t}getDefaultPosition(){return"bottom-right"}onAdd(t){return this._map=t,this._compact=this.options.compact,this._container=q.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=q.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=q.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){q.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(t,a){const d=this._map._getUIString(`AttributionControl.${a}`);t.title=d,t.setAttribute("aria-label",d)}_updateAttributions(){if(!this._map.style)return;let t=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?t=t.concat(this.options.customAttribution.map(f=>typeof f!="string"?"":f)):typeof this.options.customAttribution=="string"&&t.push(this.options.customAttribution)),this._map.style.stylesheet){const f=this._map.style.stylesheet;this.styleOwner=f.owner,this.styleId=f.id}const a=this._map.style.sourceCaches;for(const f in a){const _=a[f];if(_.used||_.usedForTerrain){const E=_.getSource();E.attribution&&t.indexOf(E.attribution)<0&&t.push(E.attribution)}}t=t.filter(f=>String(f).trim()),t.sort((f,_)=>f.length-_.length),t=t.filter((f,_)=>{for(let E=_+1;E<t.length;E++)if(t[E].indexOf(f)>=0)return!1;return!0});const d=t.join(" | ");d!==this._attribHTML&&(this._attribHTML=d,t.length?(this._innerContainer.innerHTML=d,this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class Pa{constructor(t={}){this._updateCompact=()=>{const a=this._container.children;if(a.length){const d=a[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&d.classList.add("maplibregl-compact"):d.classList.remove("maplibregl-compact")}},this.options=t}getDefaultPosition(){return"bottom-left"}onAdd(t){this._map=t,this._compact=this.options&&this.options.compact,this._container=q.create("div","maplibregl-ctrl");const a=q.create("a","maplibregl-ctrl-logo");return a.target="_blank",a.rel="noopener nofollow",a.href="https://maplibre.org/",a.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),a.setAttribute("rel","noopener nofollow"),this._container.appendChild(a),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){q.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class mn{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(t){const a=++this._id;return this._queue.push({callback:t,id:a,cancelled:!1}),a}remove(t){const a=this._currentlyRunning,d=a?this._queue.concat(a):this._queue;for(const f of d)if(f.id===t)return void(f.cancelled=!0)}run(t=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const a=this._currentlyRunning=this._queue;this._queue=[];for(const d of a)if(!d.cancelled&&(d.callback(t),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}var H=c.Y([{name:"a_pos3d",type:"Int16",components:3}]);class yl extends c.E{constructor(t){super(),this.sourceCache=t,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.deltaZoom=1,t.usedForTerrain=!0,t.tileSize=this.tileSize*2**this.deltaZoom}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(t,a){this.sourceCache.update(t,a),this._renderableTilesKeys=[];const d={};for(const f of t.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:a}))d[f.key]=!0,this._renderableTilesKeys.push(f.key),this._tiles[f.key]||(f.posMatrix=new Float64Array(16),c.aP(f.posMatrix,0,c.X,0,c.X,0,1),this._tiles[f.key]=new Pr(f,this.tileSize));for(const f in this._tiles)d[f]||delete this._tiles[f]}freeRtt(t){for(const a in this._tiles){const d=this._tiles[a];(!t||d.tileID.equals(t)||d.tileID.isChildOf(t)||t.isChildOf(d.tileID))&&(d.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map(t=>this.getTileByID(t))}getTileByID(t){return this._tiles[t]}getTerrainCoords(t){const a={};for(const d of this._renderableTilesKeys){const f=this._tiles[d].tileID;if(f.canonical.equals(t.canonical)){const _=t.clone();_.posMatrix=new Float64Array(16),c.aP(_.posMatrix,0,c.X,0,c.X,0,1),a[d]=_}else if(f.canonical.isChildOf(t.canonical)){const _=t.clone();_.posMatrix=new Float64Array(16);const E=f.canonical.z-t.canonical.z,I=f.canonical.x-(f.canonical.x>>E<<E),k=f.canonical.y-(f.canonical.y>>E<<E),z=c.X>>E;c.aP(_.posMatrix,0,z,0,z,0,1),c.J(_.posMatrix,_.posMatrix,[-I*z,-k*z,0]),a[d]=_}else if(t.canonical.isChildOf(f.canonical)){const _=t.clone();_.posMatrix=new Float64Array(16);const E=t.canonical.z-f.canonical.z,I=t.canonical.x-(t.canonical.x>>E<<E),k=t.canonical.y-(t.canonical.y>>E<<E),z=c.X>>E;c.aP(_.posMatrix,0,c.X,0,c.X,0,1),c.J(_.posMatrix,_.posMatrix,[I*z,k*z,0]),c.K(_.posMatrix,_.posMatrix,[1/2**E,1/2**E,0]),a[d]=_}}return a}getSourceTile(t,a){const d=this.sourceCache._source;let f=t.overscaledZ-this.deltaZoom;if(f>d.maxzoom&&(f=d.maxzoom),f<d.minzoom)return null;this._sourceTileCache[t.key]||(this._sourceTileCache[t.key]=t.scaledTo(f).key);let _=this.sourceCache.getTileByID(this._sourceTileCache[t.key]);if((!_||!_.dem)&&a)for(;f>=d.minzoom&&(!_||!_.dem);)_=this.sourceCache.getTileByID(t.scaledTo(f--).key);return _}tilesAfterTime(t=Date.now()){return Object.values(this._tiles).filter(a=>a.timeAdded>=t)}}class vl{constructor(t,a,d){this.painter=t,this.sourceCache=new yl(a),this.options=d,this.exaggeration=typeof d.exaggeration=="number"?d.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(t,a,d,f=c.X){var _;if(!(a>=0&&a<f&&d>=0&&d<f))return 0;const E=this.getTerrainData(t),I=(_=E.tile)===null||_===void 0?void 0:_.dem;if(!I)return 0;const k=function(Q,ie,le){var ce=ie[0],me=ie[1];return Q[0]=le[0]*ce+le[4]*me+le[12],Q[1]=le[1]*ce+le[5]*me+le[13],Q}([],[a/f*c.X,d/f*c.X],E.u_terrain_matrix),z=[k[0]*I.dim,k[1]*I.dim],R=Math.floor(z[0]),O=Math.floor(z[1]),V=z[0]-R,X=z[1]-O;return I.get(R,O)*(1-V)*(1-X)+I.get(R+1,O)*V*(1-X)+I.get(R,O+1)*(1-V)*X+I.get(R+1,O+1)*V*X}getElevationForLngLatZoom(t,a){if(!c.bb(a,t.wrap()))return 0;const{tileID:d,mercatorX:f,mercatorY:_}=this._getOverscaledTileIDFromLngLatZoom(t,a);return this.getElevation(d,f%c.X,_%c.X,c.X)}getElevation(t,a,d,f=c.X){return this.getDEMElevation(t,a,d,f)*this.exaggeration}getTerrainData(t){if(!this._emptyDemTexture){const f=this.painter.context,_=new c.R({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new Ue(f,_,f.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new Ue(f,new c.R({width:1,height:1}),f.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(f.gl.NEAREST,f.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=c.an([])}const a=this.sourceCache.getSourceTile(t,!0);if(a&&a.dem&&(!a.demTexture||a.needsTerrainPrepare)){const f=this.painter.context;a.demTexture=this.painter.getTileTexture(a.dem.stride),a.demTexture?a.demTexture.update(a.dem.getPixels(),{premultiply:!1}):a.demTexture=new Ue(f,a.dem.getPixels(),f.gl.RGBA,{premultiply:!1}),a.demTexture.bind(f.gl.NEAREST,f.gl.CLAMP_TO_EDGE),a.needsTerrainPrepare=!1}const d=a&&a+a.tileID.key+t.key;if(d&&!this._demMatrixCache[d]){const f=this.sourceCache.sourceCache._source.maxzoom;let _=t.canonical.z-a.tileID.canonical.z;t.overscaledZ>t.canonical.z&&(t.canonical.z>=f?_=t.canonical.z-f:c.w("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const E=t.canonical.x-(t.canonical.x>>_<<_),I=t.canonical.y-(t.canonical.y>>_<<_),k=c.bc(new Float64Array(16),[1/(c.X<<_),1/(c.X<<_),0]);c.J(k,k,[E*c.X,I*c.X,0]),this._demMatrixCache[t.key]={matrix:k,coord:t}}return{u_depth:2,u_terrain:3,u_terrain_dim:a&&a.dem&&a.dem.dim||1,u_terrain_matrix:d?this._demMatrixCache[t.key].matrix:this._emptyDemMatrix,u_terrain_unpack:a&&a.dem&&a.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(a&&a.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:a}}getFramebuffer(t){const a=this.painter,d=a.width/devicePixelRatio,f=a.height/devicePixelRatio;return!this._fbo||this._fbo.width===d&&this._fbo.height===f||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new Ue(a.context,{width:d,height:f,data:null},a.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(a.context.gl.NEAREST,a.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new Ue(a.context,{width:d,height:f,data:null},a.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(a.context.gl.NEAREST,a.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=a.context.createFramebuffer(d,f,!0,!1),this._fbo.depthAttachment.set(a.context.createRenderbuffer(a.context.gl.DEPTH_COMPONENT16,d,f))),this._fbo.colorAttachment.set(t==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const t=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const a=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let _=0,E=0;_<this._coordsTextureSize;_++)for(let I=0;I<this._coordsTextureSize;I++,E+=4)a[E+0]=255&I,a[E+1]=255&_,a[E+2]=I>>8<<4|_>>8,a[E+3]=0;const d=new c.R({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(a.buffer)),f=new Ue(t,d,t.gl.RGBA,{premultiply:!1});return f.bind(t.gl.NEAREST,t.gl.CLAMP_TO_EDGE),this._coordsTexture=f,f}pointCoordinate(t){this.painter.maybeDrawDepthAndCoords(!0);const a=new Uint8Array(4),d=this.painter.context,f=d.gl,_=Math.round(t.x*this.painter.pixelRatio/devicePixelRatio),E=Math.round(t.y*this.painter.pixelRatio/devicePixelRatio),I=Math.round(this.painter.height/devicePixelRatio);d.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),f.readPixels(_,I-E-1,1,1,f.RGBA,f.UNSIGNED_BYTE,a),d.bindFramebuffer.set(null);const k=a[0]+(a[2]>>4<<8),z=a[1]+((15&a[2])<<8),R=this.coordsIndex[255-a[3]],O=R&&this.sourceCache.getTileByID(R);if(!O)return null;const V=this._coordsTextureSize,X=(1<<O.tileID.canonical.z)*V;return new c.Z((O.tileID.canonical.x*V+k)/X+O.tileID.wrap,(O.tileID.canonical.y*V+z)/X,this.getElevation(O.tileID,k,z,V))}depthAtPoint(t){const a=new Uint8Array(4),d=this.painter.context,f=d.gl;return d.bindFramebuffer.set(this.getFramebuffer("depth").framebuffer),f.readPixels(t.x,this.painter.height/devicePixelRatio-t.y-1,1,1,f.RGBA,f.UNSIGNED_BYTE,a),d.bindFramebuffer.set(null),(a[0]/16777216+a[1]/65536+a[2]/256+a[3])/256}getTerrainMesh(){if(this._mesh)return this._mesh;const t=this.painter.context,a=new c.bd,d=new c.aY,f=this.meshSize,_=c.X/f,E=f*f;for(let O=0;O<=f;O++)for(let V=0;V<=f;V++)a.emplaceBack(V*_,O*_,0);for(let O=0;O<E;O+=f+1)for(let V=0;V<f;V++)d.emplaceBack(V+O,f+V+O+1,f+V+O+2),d.emplaceBack(V+O,f+V+O+2,V+O+1);const I=a.length,k=I+2*(f+1);for(const O of[0,1])for(let V=0;V<=f;V++)for(const X of[0,1])a.emplaceBack(V*_,O*c.X,X);for(let O=0;O<2*f;O+=2)d.emplaceBack(k+O,k+O+1,k+O+3),d.emplaceBack(k+O,k+O+3,k+O+2),d.emplaceBack(I+O,I+O+3,I+O+1),d.emplaceBack(I+O,I+O+2,I+O+3);const z=a.length,R=z+2*(f+1);for(const O of[0,1])for(let V=0;V<=f;V++)for(const X of[0,1])a.emplaceBack(O*c.X,V*_,X);for(let O=0;O<2*f;O+=2)d.emplaceBack(z+O,z+O+1,z+O+3),d.emplaceBack(z+O,z+O+3,z+O+2),d.emplaceBack(R+O,R+O+3,R+O+1),d.emplaceBack(R+O,R+O+2,R+O+3);return this._mesh=new Oe(t.createVertexBuffer(a,H.members),t.createIndexBuffer(d),c.a0.simpleSegment(0,0,a.length,d.length)),this._mesh}getMeshFrameDelta(t){return 2*Math.PI*c.be/Math.pow(2,t)/5}getMinTileElevationForLngLatZoom(t,a){var d;const{tileID:f}=this._getOverscaledTileIDFromLngLatZoom(t,a);return(d=this.getMinMaxElevation(f).minElevation)!==null&&d!==void 0?d:0}getMinMaxElevation(t){const a=this.getTerrainData(t).tile,d={minElevation:null,maxElevation:null};return a&&a.dem&&(d.minElevation=a.dem.min*this.exaggeration,d.maxElevation=a.dem.max*this.exaggeration),d}_getOverscaledTileIDFromLngLatZoom(t,a){const d=c.Z.fromLngLat(t.wrap()),f=(1<<a)*c.X,_=d.x*f,E=d.y*f,I=Math.floor(_/c.X),k=Math.floor(E/c.X);return{tileID:new c.S(a,0,a,I,k),mercatorX:_,mercatorY:E}}}class fs{constructor(t,a,d){this._context=t,this._size=a,this._tileSize=d,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const t of this._objects)t.texture.destroy(),t.fbo.destroy()}_createObject(t){const a=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),d=new Ue(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return d.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),a.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),a.colorAttachment.set(d.texture),{id:t,fbo:a,texture:d,stamp:-1,inUse:!1}}getObjectForId(t){return this._objects[t]}useObject(t){t.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter(a=>t.id!==a),this._recentlyUsed.push(t.id)}stampObject(t){t.stamp=++this._stamp}getOrCreateFreeObject(){for(const a of this._recentlyUsed)if(!this._objects[a].inUse)return this._objects[a];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const t=this._createObject(this._objects.length);return this._objects.push(t),t}freeObject(t){t.inUse=!1}freeAllObjects(){for(const t of this._objects)this.freeObject(t)}isFull(){return!(this._objects.length<this._size)&&this._objects.some(t=>!t.inUse)===!1}}const ln={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0};class Dd{constructor(t,a){this.painter=t,this.terrain=a,this.pool=new fs(t.context,30,a.sourceCache.tileSize*a.qualityFactor)}destruct(){this.pool.destruct()}getTexture(t){return this.pool.getObjectForId(t.rtt[this._stacks.length-1].id).texture}prepareForRender(t,a){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=t._order.filter(d=>!t._layers[d].isHidden(a)),this._coordsDescendingInv={};for(const d in t.sourceCaches){this._coordsDescendingInv[d]={};const f=t.sourceCaches[d].getVisibleCoordinates();for(const _ of f){const E=this.terrain.sourceCache.getTerrainCoords(_);for(const I in E)this._coordsDescendingInv[d][I]||(this._coordsDescendingInv[d][I]=[]),this._coordsDescendingInv[d][I].push(E[I])}}this._coordsDescendingInvStr={};for(const d of t._order){const f=t._layers[d],_=f.source;if(ln[f.type]&&!this._coordsDescendingInvStr[_]){this._coordsDescendingInvStr[_]={};for(const E in this._coordsDescendingInv[_])this._coordsDescendingInvStr[_][E]=this._coordsDescendingInv[_][E].map(I=>I.key).sort().join()}}for(const d of this._renderableTiles)for(const f in this._coordsDescendingInvStr){const _=this._coordsDescendingInvStr[f][d.tileID.key];_&&_!==d.rttCoords[f]&&(d.rtt=[])}}renderLayer(t){if(t.isHidden(this.painter.transform.zoom))return!1;const a=t.type,d=this.painter,f=this._renderableLayerIds[this._renderableLayerIds.length-1]===t.id;if(ln[a]&&(this._prevType&&ln[this._prevType]||this._stacks.push([]),this._prevType=a,this._stacks[this._stacks.length-1].push(t.id),!f))return!0;if(ln[this._prevType]||ln[a]&&f){this._prevType=a;const _=this._stacks.length-1,E=this._stacks[_]||[];for(const I of this._renderableTiles){if(this.pool.isFull()&&(Ve(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(I),I.rtt[_]){const z=this.pool.getObjectForId(I.rtt[_].id);if(z.stamp===I.rtt[_].stamp){this.pool.useObject(z);continue}}const k=this.pool.getOrCreateFreeObject();this.pool.useObject(k),this.pool.stampObject(k),I.rtt[_]={id:k.id,stamp:k.stamp},d.context.bindFramebuffer.set(k.fbo.framebuffer),d.context.clear({color:c.aM.transparent,stencil:0}),d.currentStencilSource=void 0;for(let z=0;z<E.length;z++){const R=d.style._layers[E[z]],O=R.source?this._coordsDescendingInv[R.source][I.tileID.key]:[I.tileID];d.context.viewport.set([0,0,k.fbo.width,k.fbo.height]),d._renderTileClippingMasks(R,O),d.renderLayer(d,d.style.sourceCaches[R.source],R,O),R.source&&(I.rttCoords[R.source]=this._coordsDescendingInvStr[R.source][I.tileID.key])}}return Ve(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects(),ln[a]}return!1}}const xh={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"MapLibre logo","Map.Title":"Map","Marker.Title":"Map marker","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","Popup.Close":"Close popup","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","TerrainControl.Enable":"Enable terrain","TerrainControl.Disable":"Disable terrain","CooperativeGesturesHandler.WindowsHelpText":"Use Ctrl + scroll to zoom the map","CooperativeGesturesHandler.MacHelpText":"Use  + scroll to zoom the map","CooperativeGesturesHandler.MobileHelpText":"Use two fingers to move the map"},Ld=D,Aa={hash:!1,interactive:!0,bearingSnap:7,attributionControl:_l,maplibreLogo:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,refreshExpiredTiles:!0,scrollZoom:!0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,trackResize:!0,center:[0,0],zoom:0,bearing:0,pitch:0,renderWorldCopies:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:c.a.MAX_TILE_CACHE_ZOOM_LEVELS,transformRequest:null,transformCameraUpdate:null,fadeDuration:300,crossSourceCollisions:!0,clickTolerance:3,localIdeographFontFamily:"sans-serif",pitchWithRotate:!0,validateStyle:!0,maxCanvasSize:[4096,4096],cancelPendingTileRequestsWhileZooming:!0},wh=y=>{y.touchstart=y.dragStart,y.touchmoveWindow=y.dragMove,y.touchend=y.dragEnd},ap={showCompass:!0,showZoom:!0,visualizePitch:!1};class lp{constructor(t,a,d=!1){this.mousedown=E=>{this.startMouse(c.e({},E,{ctrlKey:!0,preventDefault:()=>E.preventDefault()}),q.mousePos(this.element,E)),q.addEventListener(window,"mousemove",this.mousemove),q.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=E=>{this.moveMouse(E,q.mousePos(this.element,E))},this.mouseup=E=>{this.mouseRotate.dragEnd(E),this.mousePitch&&this.mousePitch.dragEnd(E),this.offTemp()},this.touchstart=E=>{E.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=q.touchPos(this.element,E.targetTouches)[0],this.startTouch(E,this._startPos),q.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),q.addEventListener(window,"touchend",this.touchend))},this.touchmove=E=>{E.targetTouches.length!==1?this.reset():(this._lastPos=q.touchPos(this.element,E.targetTouches)[0],this.moveTouch(E,this._lastPos))},this.touchend=E=>{E.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),this.touchRotate.reset(),this.touchPitch&&this.touchPitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10;const f=t.dragRotate._mouseRotate.getClickTolerance(),_=t.dragRotate._mousePitch.getClickTolerance();this.element=a,this.mouseRotate=ph({clickTolerance:f,enable:!0}),this.touchRotate=(({enable:E,clickTolerance:I,bearingDegreesPerPixelMoved:k=.8})=>{const z=new _o;return new hs({clickTolerance:I,move:(R,O)=>({bearingDelta:(O.x-R.x)*k}),moveStateManager:z,enable:E,assignEvents:wh})})({clickTolerance:f,enable:!0}),this.map=t,d&&(this.mousePitch=mh({clickTolerance:_,enable:!0}),this.touchPitch=(({enable:E,clickTolerance:I,pitchDegreesPerPixelMoved:k=-.5})=>{const z=new _o;return new hs({clickTolerance:I,move:(R,O)=>({pitchDelta:(O.y-R.y)*k}),moveStateManager:z,enable:E,assignEvents:wh})})({clickTolerance:_,enable:!0})),q.addEventListener(a,"mousedown",this.mousedown),q.addEventListener(a,"touchstart",this.touchstart,{passive:!1}),q.addEventListener(a,"touchcancel",this.reset)}startMouse(t,a){this.mouseRotate.dragStart(t,a),this.mousePitch&&this.mousePitch.dragStart(t,a),q.disableDrag()}startTouch(t,a){this.touchRotate.dragStart(t,a),this.touchPitch&&this.touchPitch.dragStart(t,a),q.disableDrag()}moveMouse(t,a){const d=this.map,{bearingDelta:f}=this.mouseRotate.dragMove(t,a)||{};if(f&&d.setBearing(d.getBearing()+f),this.mousePitch){const{pitchDelta:_}=this.mousePitch.dragMove(t,a)||{};_&&d.setPitch(d.getPitch()+_)}}moveTouch(t,a){const d=this.map,{bearingDelta:f}=this.touchRotate.dragMove(t,a)||{};if(f&&d.setBearing(d.getBearing()+f),this.touchPitch){const{pitchDelta:_}=this.touchPitch.dragMove(t,a)||{};_&&d.setPitch(d.getPitch()+_)}}off(){const t=this.element;q.removeEventListener(t,"mousedown",this.mousedown),q.removeEventListener(t,"touchstart",this.touchstart,{passive:!1}),q.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),q.removeEventListener(window,"touchend",this.touchend),q.removeEventListener(t,"touchcancel",this.reset),this.offTemp()}offTemp(){q.enableDrag(),q.removeEventListener(window,"mousemove",this.mousemove),q.removeEventListener(window,"mouseup",this.mouseup),q.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),q.removeEventListener(window,"touchend",this.touchend)}}let Ki;function ar(y,t,a){const d=new c.N(y.lng,y.lat);if(y=new c.N(y.lng,y.lat),t){const f=new c.N(y.lng-360,y.lat),_=new c.N(y.lng+360,y.lat),E=a.locationPoint(y).distSqr(t);a.locationPoint(f).distSqr(t)<E?y=f:a.locationPoint(_).distSqr(t)<E&&(y=_)}for(;Math.abs(y.lng-a.center.lng)>180;){const f=a.locationPoint(y);if(f.x>=0&&f.y>=0&&f.x<=a.width&&f.y<=a.height)break;y.lng>a.center.lng?y.lng-=360:y.lng+=360}return y.lng!==d.lng&&a.locationPoint(y).y>a.height/2-a.getHorizon()?y:d}const Oi={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function rc(y,t,a){const d=y.classList;for(const f in Oi)d.remove(`maplibregl-${a}-anchor-${f}`);d.add(`maplibregl-${a}-anchor-${t}`)}class ic extends c.E{constructor(t){if(super(),this._onKeyPress=a=>{const d=a.code,f=a.charCode||a.keyCode;d!=="Space"&&d!=="Enter"&&f!==32&&f!==13||this.togglePopup()},this._onMapClick=a=>{const d=a.originalEvent.target,f=this._element;this._popup&&(d===f||f.contains(d))&&this.togglePopup()},this._update=a=>{var d;if(!this._map)return;const f=this._map.loaded()&&!this._map.isMoving();((a==null?void 0:a.type)==="terrain"||(a==null?void 0:a.type)==="render"&&!f)&&this._map.once("render",this._update),this._lngLat=this._map.transform.renderWorldCopies?ar(this._lngLat,this._flatPos,this._map.transform):(d=this._lngLat)===null||d===void 0?void 0:d.wrap(),this._flatPos=this._pos=this._map.project(this._lngLat)._add(this._offset),this._map.terrain&&(this._flatPos=this._map.transform.locationPoint(this._lngLat)._add(this._offset));let _="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?_=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(_=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let E="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?E="rotateX(0deg)":this._pitchAlignment==="map"&&(E=`rotateX(${this._map.getPitch()}deg)`),this._subpixelPositioning||a&&a.type!=="moveend"||(this._pos=this._pos.round()),q.setTransform(this._element,`${Oi[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${E} ${_}`),G.frameAsync(new AbortController).then(()=>{this._updateOpacity(a&&a.type==="moveend")}).catch(()=>{})},this._onMove=a=>{if(!this._isDragging){const d=this._clickTolerance||this._map._clickTolerance;this._isDragging=a.point.dist(this._pointerdownPos)>=d}this._isDragging&&(this._pos=a.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new c.k("dragstart"))),this.fire(new c.k("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new c.k("dragend")),this._state="inactive"},this._addDragHandler=a=>{this._element.contains(a.originalEvent.target)&&(a.preventDefault(),this._positionDelta=a.point.sub(this._pos).add(this._offset),this._pointerdownPos=a.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=t&&t.anchor||"center",this._color=t&&t.color||"#3FB1CE",this._scale=t&&t.scale||1,this._draggable=t&&t.draggable||!1,this._clickTolerance=t&&t.clickTolerance||0,this._subpixelPositioning=t&&t.subpixelPositioning||!1,this._isDragging=!1,this._state="inactive",this._rotation=t&&t.rotation||0,this._rotationAlignment=t&&t.rotationAlignment||"auto",this._pitchAlignment=t&&t.pitchAlignment&&t.pitchAlignment!=="auto"?t.pitchAlignment:this._rotationAlignment,this.setOpacity(),this.setOpacity(t==null?void 0:t.opacity,t==null?void 0:t.opacityWhenCovered),t&&t.element)this._element=t.element,this._offset=c.P.convert(t&&t.offset||[0,0]);else{this._defaultMarker=!0,this._element=q.create("div");const a=q.createNS("http://www.w3.org/2000/svg","svg"),d=41,f=27;a.setAttributeNS(null,"display","block"),a.setAttributeNS(null,"height",`${d}px`),a.setAttributeNS(null,"width",`${f}px`),a.setAttributeNS(null,"viewBox",`0 0 ${f} ${d}`);const _=q.createNS("http://www.w3.org/2000/svg","g");_.setAttributeNS(null,"stroke","none"),_.setAttributeNS(null,"stroke-width","1"),_.setAttributeNS(null,"fill","none"),_.setAttributeNS(null,"fill-rule","evenodd");const E=q.createNS("http://www.w3.org/2000/svg","g");E.setAttributeNS(null,"fill-rule","nonzero");const I=q.createNS("http://www.w3.org/2000/svg","g");I.setAttributeNS(null,"transform","translate(3.0, 29.0)"),I.setAttributeNS(null,"fill","#000000");const k=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const ce of k){const me=q.createNS("http://www.w3.org/2000/svg","ellipse");me.setAttributeNS(null,"opacity","0.04"),me.setAttributeNS(null,"cx","10.5"),me.setAttributeNS(null,"cy","5.80029008"),me.setAttributeNS(null,"rx",ce.rx),me.setAttributeNS(null,"ry",ce.ry),I.appendChild(me)}const z=q.createNS("http://www.w3.org/2000/svg","g");z.setAttributeNS(null,"fill",this._color);const R=q.createNS("http://www.w3.org/2000/svg","path");R.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),z.appendChild(R);const O=q.createNS("http://www.w3.org/2000/svg","g");O.setAttributeNS(null,"opacity","0.25"),O.setAttributeNS(null,"fill","#000000");const V=q.createNS("http://www.w3.org/2000/svg","path");V.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),O.appendChild(V);const X=q.createNS("http://www.w3.org/2000/svg","g");X.setAttributeNS(null,"transform","translate(6.0, 7.0)"),X.setAttributeNS(null,"fill","#FFFFFF");const Q=q.createNS("http://www.w3.org/2000/svg","g");Q.setAttributeNS(null,"transform","translate(8.0, 8.0)");const ie=q.createNS("http://www.w3.org/2000/svg","circle");ie.setAttributeNS(null,"fill","#000000"),ie.setAttributeNS(null,"opacity","0.25"),ie.setAttributeNS(null,"cx","5.5"),ie.setAttributeNS(null,"cy","5.5"),ie.setAttributeNS(null,"r","5.4999962");const le=q.createNS("http://www.w3.org/2000/svg","circle");le.setAttributeNS(null,"fill","#FFFFFF"),le.setAttributeNS(null,"cx","5.5"),le.setAttributeNS(null,"cy","5.5"),le.setAttributeNS(null,"r","5.4999962"),Q.appendChild(ie),Q.appendChild(le),E.appendChild(I),E.appendChild(z),E.appendChild(O),E.appendChild(X),E.appendChild(Q),a.appendChild(E),a.setAttributeNS(null,"height",d*this._scale+"px"),a.setAttributeNS(null,"width",f*this._scale+"px"),this._element.appendChild(a),this._offset=c.P.convert(t&&t.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",a=>{a.preventDefault()}),this._element.addEventListener("mousedown",a=>{a.preventDefault()}),rc(this._element,this._anchor,"marker"),t&&t.className)for(const a of t.className.split(" "))this._element.classList.add(a);this._popup=null}addTo(t){return this.remove(),this._map=t,this._element.setAttribute("aria-label",t._getUIString("Marker.Title")),t.getCanvasContainer().appendChild(this._element),t.on("move",this._update),t.on("moveend",this._update),t.on("terrain",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("terrain",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),q.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(t){return this._lngLat=c.N.convert(t),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(t){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),t){if(!("offset"in t.options)){const f=Math.abs(13.5)/Math.SQRT2;t.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[f,-1*(38.1-13.5+f)],"bottom-right":[-f,-1*(38.1-13.5+f)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=t,this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}setSubpixelPositioning(t){return this._subpixelPositioning=t,this}getPopup(){return this._popup}togglePopup(){const t=this._popup;return this._element.style.opacity===this._opacityWhenCovered?this:t?(t.isOpen()?t.remove():(t.setLngLat(this._lngLat),t.addTo(this._map)),this):this}_updateOpacity(t=!1){var a,d;if(!(!((a=this._map)===null||a===void 0)&&a.terrain))return void(this._element.style.opacity!==this._opacity&&(this._element.style.opacity=this._opacity));if(t)this._opacityTimeout=null;else{if(this._opacityTimeout)return;this._opacityTimeout=setTimeout(()=>{this._opacityTimeout=null},100)}const f=this._map,_=f.terrain.depthAtPoint(this._pos),E=f.terrain.getElevationForLngLatZoom(this._lngLat,f.transform.tileZoom);if(f.transform.lngLatToCameraDepth(this._lngLat,E)-_<.006)return void(this._element.style.opacity=this._opacity);const I=-this._offset.y/f.transform._pixelPerMeter,k=Math.sin(f.getPitch()*Math.PI/180)*I,z=f.terrain.depthAtPoint(new c.P(this._pos.x,this._pos.y-this._offset.y)),R=f.transform.lngLatToCameraDepth(this._lngLat,E+k)-z>.006;!((d=this._popup)===null||d===void 0)&&d.isOpen()&&R&&this._popup.remove(),this._element.style.opacity=R?this._opacityWhenCovered:this._opacity}getOffset(){return this._offset}setOffset(t){return this._offset=c.P.convert(t),this._update(),this}addClassName(t){this._element.classList.add(t)}removeClassName(t){this._element.classList.remove(t)}toggleClassName(t){return this._element.classList.toggle(t)}setDraggable(t){return this._draggable=!!t,this._map&&(t?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(t){return this._rotation=t||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(t){return this._rotationAlignment=t||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(t){return this._pitchAlignment=t&&t!=="auto"?t:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}setOpacity(t,a){return t===void 0&&a===void 0&&(this._opacity="1",this._opacityWhenCovered="0.2"),t!==void 0&&(this._opacity=t),a!==void 0&&(this._opacityWhenCovered=a),this._map&&this._updateOpacity(!0),this}}const Rd={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let tu=0,nu=!1;const Jr={maxWidth:100,unit:"metric"};function ru(y,t,a){const d=a&&a.maxWidth||100,f=y._container.clientHeight/2,_=y.unproject([0,f]),E=y.unproject([d,f]),I=_.distanceTo(E);if(a&&a.unit==="imperial"){const k=3.2808*I;k>5280?Ct(t,d,k/5280,y._getUIString("ScaleControl.Miles")):Ct(t,d,k,y._getUIString("ScaleControl.Feet"))}else a&&a.unit==="nautical"?Ct(t,d,I/1852,y._getUIString("ScaleControl.NauticalMiles")):I>=1e3?Ct(t,d,I/1e3,y._getUIString("ScaleControl.Kilometers")):Ct(t,d,I,y._getUIString("ScaleControl.Meters"))}function Ct(y,t,a,d){const f=function(_){const E=Math.pow(10,`${Math.floor(_)}`.length-1);let I=_/E;return I=I>=10?10:I>=5?5:I>=3?3:I>=2?2:I>=1?1:function(k){const z=Math.pow(10,Math.ceil(-Math.log(k)/Math.LN10));return Math.round(k*z)/z}(I),E*I}(a);y.style.width=t*(f/a)+"px",y.innerHTML=`${f}&nbsp;${d}`}const Ft={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",subpixelPositioning:!1},sc=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function oc(y){if(y){if(typeof y=="number"){const t=Math.round(Math.abs(y)/Math.SQRT2);return{center:new c.P(0,0),top:new c.P(0,y),"top-left":new c.P(t,t),"top-right":new c.P(-t,t),bottom:new c.P(0,-y),"bottom-left":new c.P(t,-t),"bottom-right":new c.P(-t,-t),left:new c.P(y,0),right:new c.P(-y,0)}}if(y instanceof c.P||Array.isArray(y)){const t=c.P.convert(y);return{center:t,top:t,"top-left":t,"top-right":t,bottom:t,"bottom-left":t,"bottom-right":t,left:t,right:t}}return{center:c.P.convert(y.center||[0,0]),top:c.P.convert(y.top||[0,0]),"top-left":c.P.convert(y["top-left"]||[0,0]),"top-right":c.P.convert(y["top-right"]||[0,0]),bottom:c.P.convert(y.bottom||[0,0]),"bottom-left":c.P.convert(y["bottom-left"]||[0,0]),"bottom-right":c.P.convert(y["bottom-right"]||[0,0]),left:c.P.convert(y.left||[0,0]),right:c.P.convert(y.right||[0,0])}}return oc(new c.P(0,0))}const wo=D;w.AJAXError=c.bh,w.Evented=c.E,w.LngLat=c.N,w.MercatorCoordinate=c.Z,w.Point=c.P,w.addProtocol=c.bi,w.config=c.a,w.removeProtocol=c.bj,w.AttributionControl=xo,w.BoxZoomHandler=di,w.CanvasSource=rr,w.CooperativeGesturesHandler=vo,w.DoubleClickZoomHandler=yo,w.DragPanHandler=Ia,w.DragRotateHandler=gl,w.EdgeInsets=gr,w.FullscreenControl=class extends c.E{constructor(y={}){super(),this._onFullscreenChange=()=>{var t;let a=window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement;for(;!((t=a==null?void 0:a.shadowRoot)===null||t===void 0)&&t.fullscreenElement;)a=a.shadowRoot.fullscreenElement;a===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,y&&y.container&&(y.container instanceof HTMLElement?this._container=y.container:c.w("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(y){return this._map=y,this._container||(this._container=this._map.getContainer()),this._controlContainer=q.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){q.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const y=this._fullscreenButton=q.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);q.create("span","maplibregl-ctrl-icon",y).setAttribute("aria-hidden","true"),y.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const y=this._getTitle();this._fullscreenButton.setAttribute("aria-label",y),this._fullscreenButton.title=y}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new c.k("fullscreenstart")),this._prevCooperativeGesturesEnabled=this._map.cooperativeGestures.isEnabled(),this._map.cooperativeGestures.disable()):(this.fire(new c.k("fullscreenend")),this._prevCooperativeGesturesEnabled&&this._map.cooperativeGestures.enable())}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},w.GeoJSONSource=Tr,w.GeolocateControl=class extends c.E{constructor(y){super(),this._onSuccess=t=>{if(this._map){if(this._isOutOfMapMaxBounds(t))return this._setErrorState(),this.fire(new c.k("outofmaxbounds",t)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=t,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(t),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(t),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new c.k("geolocate",t)),this._finish()}},this._updateCamera=t=>{const a=new c.N(t.coords.longitude,t.coords.latitude),d=t.coords.accuracy,f=this._map.getBearing(),_=c.e({bearing:f},this.options.fitBoundsOptions),E=Ce.fromLngLat(a,d);this._map.fitBounds(E,_,{geolocateSource:!0})},this._updateMarker=t=>{if(t){const a=new c.N(t.coords.longitude,t.coords.latitude);this._accuracyCircleMarker.setLngLat(a).addTo(this._map),this._userLocationDotMarker.setLngLat(a).addTo(this._map),this._accuracy=t.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onZoom=()=>{this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},this._onError=t=>{if(this._map){if(this.options.trackUserLocation)if(t.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const a=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=a,this._geolocateButton.setAttribute("aria-label",a),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(t.code===3&&nu)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new c.k("error",t)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=()=>{this._map&&(this._container.addEventListener("contextmenu",t=>t.preventDefault()),this._geolocateButton=q.create("button","maplibregl-ctrl-geolocate",this._container),q.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",this._geolocateButton.disabled=!0)},this._finishSetupUI=t=>{if(this._map){if(t===!1){c.w("Geolocation support is not available so the GeolocateControl will be disabled.");const a=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=a,this._geolocateButton.setAttribute("aria-label",a)}else{const a=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.disabled=!1,this._geolocateButton.title=a,this._geolocateButton.setAttribute("aria-label",a)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=q.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new ic({element:this._dotElement}),this._circleElement=q.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new ic({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",()=>this.trigger()),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",a=>{a.geolocateSource||this._watchState!=="ACTIVE_LOCK"||a.originalEvent&&a.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new c.k("trackuserlocationend")),this.fire(new c.k("userlocationlostfocus")))})}},this.options=c.e({},Rd,y)}onAdd(y){return this._map=y,this._container=q.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),function(){return c._(this,arguments,void 0,function*(t=!1){if(Ki!==void 0&&!t)return Ki;if(window.navigator.permissions===void 0)return Ki=!!window.navigator.geolocation,Ki;try{Ki=(yield window.navigator.permissions.query({name:"geolocation"})).state!=="denied"}catch{Ki=!!window.navigator.geolocation}return Ki})}().then(t=>this._finishSetupUI(t)),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),q.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,tu=0,nu=!1}_isOutOfMapMaxBounds(y){const t=this._map.getMaxBounds(),a=y.coords;return t&&(a.longitude<t.getWest()||a.longitude>t.getEast()||a.latitude<t.getSouth()||a.latitude>t.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadius(){const y=this._map.getBounds(),t=y.getSouthEast(),a=y.getNorthEast(),d=t.distanceTo(a),f=Math.ceil(this._accuracy/(d/this._map._container.clientHeight)*2);this._circleElement.style.width=`${f}px`,this._circleElement.style.height=`${f}px`}trigger(){if(!this._setup)return c.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new c.k("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":tu--,nu=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new c.k("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new c.k("trackuserlocationstart")),this.fire(new c.k("userlocationfocus"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let y;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),tu++,tu>1?(y={maximumAge:6e5,timeout:0},nu=!0):(y=this.options.positionOptions,nu=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,y)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},w.Hash=Ei,w.ImageSource=Gr,w.KeyboardHandler=ds,w.LngLatBounds=Ce,w.LogoControl=Pa,w.Map=class extends zd{constructor(y){c.bf.mark(c.bg.create);const t=Object.assign(Object.assign({},Aa),y);if(t.minZoom!=null&&t.maxZoom!=null&&t.minZoom>t.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(t.minPitch!=null&&t.maxPitch!=null&&t.minPitch>t.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(t.minPitch!=null&&t.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(t.maxPitch!=null&&t.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(super(new Go(t.minZoom,t.maxZoom,t.minPitch,t.maxPitch,t.renderWorldCopies),{bearingSnap:t.bearingSnap}),this._idleTriggered=!1,this._crossFadingFactor=1,this._renderTaskQueue=new mn,this._controls=[],this._mapId=c.a4(),this._contextLost=a=>{a.preventDefault(),this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this.fire(new c.k("webglcontextlost",{originalEvent:a}))},this._contextRestored=a=>{this._setupPainter(),this.resize(),this._update(),this.fire(new c.k("webglcontextrestored",{originalEvent:a}))},this._onMapScroll=a=>{if(a.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=t.interactive,this._maxTileCacheSize=t.maxTileCacheSize,this._maxTileCacheZoomLevels=t.maxTileCacheZoomLevels,this._failIfMajorPerformanceCaveat=t.failIfMajorPerformanceCaveat===!0,this._preserveDrawingBuffer=t.preserveDrawingBuffer===!0,this._antialias=t.antialias===!0,this._trackResize=t.trackResize===!0,this._bearingSnap=t.bearingSnap,this._refreshExpiredTiles=t.refreshExpiredTiles===!0,this._fadeDuration=t.fadeDuration,this._crossSourceCollisions=t.crossSourceCollisions===!0,this._collectResourceTiming=t.collectResourceTiming===!0,this._locale=Object.assign(Object.assign({},xh),t.locale),this._clickTolerance=t.clickTolerance,this._overridePixelRatio=t.pixelRatio,this._maxCanvasSize=t.maxCanvasSize,this.transformCameraUpdate=t.transformCameraUpdate,this.cancelPendingTileRequestsWhileZooming=t.cancelPendingTileRequestsWhileZooming===!0,this._imageQueueHandle=he.addThrottleControl(()=>this.isMoving()),this._requestManager=new De(t.transformRequest),typeof t.container=="string"){if(this._container=document.getElementById(t.container),!this._container)throw new Error(`Container '${t.container}' not found.`)}else{if(!(t.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=t.container}if(t.maxBounds&&this.setMaxBounds(t.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",()=>this._update(!1)).on("moveend",()=>this._update(!1)).on("zoom",()=>this._update(!0)).on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}).once("idle",()=>{this._idleTriggered=!0}),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let a=!1;const d=Xl(f=>{this._trackResize&&!this._removed&&(this.resize(f),this.redraw())},50);this._resizeObserver=new ResizeObserver(f=>{a?d(f):a=!0}),this._resizeObserver.observe(this._container)}this.handlers=new vh(this,t),this._hash=t.hash&&new Ei(typeof t.hash=="string"&&t.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:t.center,zoom:t.zoom,bearing:t.bearing,pitch:t.pitch}),t.bounds&&(this.resize(),this.fitBounds(t.bounds,c.e({},t.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=t.localIdeographFontFamily,this._validateStyle=t.validateStyle,t.style&&this.setStyle(t.style,{localIdeographFontFamily:t.localIdeographFontFamily}),t.attributionControl&&this.addControl(new xo(typeof t.attributionControl=="boolean"?void 0:t.attributionControl)),t.maplibreLogo&&this.addControl(new Pa,t.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",a=>{this._update(a.dataType==="style"),this.fire(new c.k(`${a.dataType}data`,a))}),this.on("dataloading",a=>{this.fire(new c.k(`${a.dataType}dataloading`,a))}),this.on("dataabort",a=>{this.fire(new c.k("sourcedataabort",a))})}_getMapId(){return this._mapId}addControl(y,t){if(t===void 0&&(t=y.getDefaultPosition?y.getDefaultPosition():"top-right"),!y||!y.onAdd)return this.fire(new c.j(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const a=y.onAdd(this);this._controls.push(y);const d=this._controlPositions[t];return t.indexOf("bottom")!==-1?d.insertBefore(a,d.firstChild):d.appendChild(a),this}removeControl(y){if(!y||!y.onRemove)return this.fire(new c.j(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const t=this._controls.indexOf(y);return t>-1&&this._controls.splice(t,1),y.onRemove(this),this}hasControl(y){return this._controls.indexOf(y)>-1}calculateCameraOptionsFromTo(y,t,a,d){return d==null&&this.terrain&&(d=this.terrain.getElevationForLngLatZoom(a,this.transform.tileZoom)),super.calculateCameraOptionsFromTo(y,t,a,d)}resize(y){var t;const a=this._containerDimensions(),d=a[0],f=a[1],_=this._getClampedPixelRatio(d,f);if(this._resizeCanvas(d,f,_),this.painter.resize(d,f,_),this.painter.overLimit()){const I=this.painter.context.gl;this._maxCanvasSize=[I.drawingBufferWidth,I.drawingBufferHeight];const k=this._getClampedPixelRatio(d,f);this._resizeCanvas(d,f,k),this.painter.resize(d,f,k)}this.transform.resize(d,f),(t=this._requestedCameraState)===null||t===void 0||t.resize(d,f);const E=!this._moving;return E&&(this.stop(),this.fire(new c.k("movestart",y)).fire(new c.k("move",y))),this.fire(new c.k("resize",y)),E&&this.fire(new c.k("moveend",y)),this}_getClampedPixelRatio(y,t){const{0:a,1:d}=this._maxCanvasSize,f=this.getPixelRatio(),_=y*f,E=t*f;return Math.min(_>a?a/_:1,E>d?d/E:1)*f}getPixelRatio(){var y;return(y=this._overridePixelRatio)!==null&&y!==void 0?y:devicePixelRatio}setPixelRatio(y){this._overridePixelRatio=y,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(y){return this.transform.setMaxBounds(Ce.convert(y)),this._update()}setMinZoom(y){if((y=y??-2)>=-2&&y<=this.transform.maxZoom)return this.transform.minZoom=y,this._update(),this.getZoom()<y&&this.setZoom(y),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(y){if((y=y??22)>=this.transform.minZoom)return this.transform.maxZoom=y,this._update(),this.getZoom()>y&&this.setZoom(y),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(y){if((y=y??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(y>=0&&y<=this.transform.maxPitch)return this.transform.minPitch=y,this._update(),this.getPitch()<y&&this.setPitch(y),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(y){if((y=y??60)>85)throw new Error("maxPitch must be less than or equal to 85");if(y>=this.transform.minPitch)return this.transform.maxPitch=y,this._update(),this.getPitch()>y&&this.setPitch(y),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(y){return this.transform.renderWorldCopies=y,this._update()}project(y){return this.transform.locationPoint(c.N.convert(y),this.style&&this.terrain)}unproject(y){return this.transform.pointLocation(c.P.convert(y),this.terrain)}isMoving(){var y;return this._moving||((y=this.handlers)===null||y===void 0?void 0:y.isMoving())}isZooming(){var y;return this._zooming||((y=this.handlers)===null||y===void 0?void 0:y.isZooming())}isRotating(){var y;return this._rotating||((y=this.handlers)===null||y===void 0?void 0:y.isRotating())}_createDelegatedListener(y,t,a){if(y==="mouseenter"||y==="mouseover"){let d=!1;return{layers:t,listener:a,delegates:{mousemove:_=>{const E=t.filter(k=>this.getLayer(k)),I=E.length!==0?this.queryRenderedFeatures(_.point,{layers:E}):[];I.length?d||(d=!0,a.call(this,new $r(y,this,_.originalEvent,{features:I}))):d=!1},mouseout:()=>{d=!1}}}}if(y==="mouseleave"||y==="mouseout"){let d=!1;return{layers:t,listener:a,delegates:{mousemove:E=>{const I=t.filter(k=>this.getLayer(k));(I.length!==0?this.queryRenderedFeatures(E.point,{layers:I}):[]).length?d=!0:d&&(d=!1,a.call(this,new $r(y,this,E.originalEvent)))},mouseout:E=>{d&&(d=!1,a.call(this,new $r(y,this,E.originalEvent)))}}}}{const d=f=>{const _=t.filter(I=>this.getLayer(I)),E=_.length!==0?this.queryRenderedFeatures(f.point,{layers:_}):[];E.length&&(f.features=E,a.call(this,f),delete f.features)};return{layers:t,listener:a,delegates:{[y]:d}}}}_saveDelegatedListener(y,t){this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[y]=this._delegatedListeners[y]||[],this._delegatedListeners[y].push(t)}_removeDelegatedListener(y,t,a){if(!this._delegatedListeners||!this._delegatedListeners[y])return;const d=this._delegatedListeners[y];for(let f=0;f<d.length;f++){const _=d[f];if(_.listener===a&&_.layers.length===t.length&&_.layers.every(E=>t.includes(E))){for(const E in _.delegates)this.off(E,_.delegates[E]);return void d.splice(f,1)}}}on(y,t,a){if(a===void 0)return super.on(y,t);const d=this._createDelegatedListener(y,typeof t=="string"?[t]:t,a);this._saveDelegatedListener(y,d);for(const f in d.delegates)this.on(f,d.delegates[f]);return this}once(y,t,a){if(a===void 0)return super.once(y,t);const d=typeof t=="string"?[t]:t,f=this._createDelegatedListener(y,d,a);for(const _ in f.delegates){const E=f.delegates[_];f.delegates[_]=(...I)=>{this._removeDelegatedListener(y,d,a),E(...I)}}this._saveDelegatedListener(y,f);for(const _ in f.delegates)this.once(_,f.delegates[_]);return this}off(y,t,a){return a===void 0?super.off(y,t):(this._removeDelegatedListener(y,typeof t=="string"?[t]:t,a),this)}queryRenderedFeatures(y,t){if(!this.style)return[];let a;const d=y instanceof c.P||Array.isArray(y),f=d?y:[[0,0],[this.transform.width,this.transform.height]];if(t=t||(d?{}:y)||{},f instanceof c.P||typeof f[0]=="number")a=[c.P.convert(f)];else{const _=c.P.convert(f[0]),E=c.P.convert(f[1]);a=[_,new c.P(E.x,_.y),E,new c.P(_.x,E.y),_]}return this.style.queryRenderedFeatures(a,t,this.transform)}querySourceFeatures(y,t){return this.style.querySourceFeatures(y,t)}setStyle(y,t){return(t=c.e({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},t)).diff!==!1&&t.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&y?(this._diffStyle(y,t),this):(this._localIdeographFontFamily=t.localIdeographFontFamily,this._updateStyle(y,t))}setTransformRequest(y){return this._requestManager.setTransformRequest(y),this}_getUIString(y){const t=this._locale[y];if(t==null)throw new Error(`Missing UI string '${y}'`);return t}_updateStyle(y,t){if(t.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",()=>this._updateStyle(y,t));const a=this.style&&t.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!y)),y?(this.style=new Nu(this,t||{}),this.style.setEventedParent(this,{style:this.style}),typeof y=="string"?this.style.loadURL(y,t,a):this.style.loadJSON(y,t,a),this):(delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new Nu(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(y,t){if(typeof y=="string"){const a=this._requestManager.transformRequest(y,"Style");c.h(a,new AbortController).then(d=>{this._updateDiff(d.data,t)}).catch(d=>{d&&this.fire(new c.j(d))})}else typeof y=="object"&&this._updateDiff(y,t)}_updateDiff(y,t){try{this.style.setState(y,t)&&this._update(!0)}catch(a){c.w(`Unable to perform style diff: ${a.message||a.error||a}.  Rebuilding the style from scratch.`),this._updateStyle(y,t)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():c.w("There is no style added to the map.")}addSource(y,t){return this._lazyInitEmptyStyle(),this.style.addSource(y,t),this._update(!0)}isSourceLoaded(y){const t=this.style&&this.style.sourceCaches[y];if(t!==void 0)return t.loaded();this.fire(new c.j(new Error(`There is no source with ID '${y}'`)))}setTerrain(y){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),y){const t=this.style.sourceCaches[y.source];if(!t)throw new Error(`cannot load terrain, because there exists no source with ID: ${y.source}`);this.terrain===null&&t.reload();for(const a in this.style._layers){const d=this.style._layers[a];d.type==="hillshade"&&d.source===y.source&&c.w("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new vl(this.painter,t,y),this.painter.renderToTexture=new Dd(this.painter,this.terrain),this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._terrainDataCallback=a=>{a.dataType==="style"?this.terrain.sourceCache.freeRtt():a.dataType==="source"&&a.tile&&(a.sourceId!==y.source||this._elevationFreeze||(this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.terrain.sourceCache.freeRtt(a.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform.minElevationForCurrentTile=0,this.transform.elevation=0;return this.fire(new c.k("terrain",{terrain:y})),this}getTerrain(){var y,t;return(t=(y=this.terrain)===null||y===void 0?void 0:y.options)!==null&&t!==void 0?t:null}areTilesLoaded(){const y=this.style&&this.style.sourceCaches;for(const t in y){const a=y[t]._tiles;for(const d in a){const f=a[d];if(f.state!=="loaded"&&f.state!=="errored")return!1}}return!0}removeSource(y){return this.style.removeSource(y),this._update(!0)}getSource(y){return this.style.getSource(y)}addImage(y,t,a={}){const{pixelRatio:d=1,sdf:f=!1,stretchX:_,stretchY:E,content:I,textFitWidth:k,textFitHeight:z}=a;if(this._lazyInitEmptyStyle(),!(t instanceof HTMLImageElement||c.b(t))){if(t.width===void 0||t.height===void 0)return this.fire(new c.j(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:R,height:O,data:V}=t,X=t;return this.style.addImage(y,{data:new c.R({width:R,height:O},new Uint8Array(V)),pixelRatio:d,stretchX:_,stretchY:E,content:I,textFitWidth:k,textFitHeight:z,sdf:f,version:0,userImage:X}),X.onAdd&&X.onAdd(this,y),this}}{const{width:R,height:O,data:V}=G.getImageData(t);this.style.addImage(y,{data:new c.R({width:R,height:O},V),pixelRatio:d,stretchX:_,stretchY:E,content:I,textFitWidth:k,textFitHeight:z,sdf:f,version:0})}}updateImage(y,t){const a=this.style.getImage(y);if(!a)return this.fire(new c.j(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const d=t instanceof HTMLImageElement||c.b(t)?G.getImageData(t):t,{width:f,height:_,data:E}=d;if(f===void 0||_===void 0)return this.fire(new c.j(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(f!==a.data.width||_!==a.data.height)return this.fire(new c.j(new Error("The width and height of the updated image must be that same as the previous version of the image")));const I=!(t instanceof HTMLImageElement||c.b(t));return a.data.replace(E,I),this.style.updateImage(y,a),this}getImage(y){return this.style.getImage(y)}hasImage(y){return y?!!this.style.getImage(y):(this.fire(new c.j(new Error("Missing required image id"))),!1)}removeImage(y){this.style.removeImage(y)}loadImage(y){return he.getImage(this._requestManager.transformRequest(y,"Image"),new AbortController)}listImages(){return this.style.listImages()}addLayer(y,t){return this._lazyInitEmptyStyle(),this.style.addLayer(y,t),this._update(!0)}moveLayer(y,t){return this.style.moveLayer(y,t),this._update(!0)}removeLayer(y){return this.style.removeLayer(y),this._update(!0)}getLayer(y){return this.style.getLayer(y)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(y,t,a){return this.style.setLayerZoomRange(y,t,a),this._update(!0)}setFilter(y,t,a={}){return this.style.setFilter(y,t,a),this._update(!0)}getFilter(y){return this.style.getFilter(y)}setPaintProperty(y,t,a,d={}){return this.style.setPaintProperty(y,t,a,d),this._update(!0)}getPaintProperty(y,t){return this.style.getPaintProperty(y,t)}setLayoutProperty(y,t,a,d={}){return this.style.setLayoutProperty(y,t,a,d),this._update(!0)}getLayoutProperty(y,t){return this.style.getLayoutProperty(y,t)}setGlyphs(y,t={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(y,t),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(y,t,a={}){return this._lazyInitEmptyStyle(),this.style.addSprite(y,t,a,d=>{d||this._update(!0)}),this}removeSprite(y){return this._lazyInitEmptyStyle(),this.style.removeSprite(y),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(y,t={}){return this._lazyInitEmptyStyle(),this.style.setSprite(y,t,a=>{a||this._update(!0)}),this}setLight(y,t={}){return this._lazyInitEmptyStyle(),this.style.setLight(y,t),this._update(!0)}getLight(){return this.style.getLight()}setSky(y){return this._lazyInitEmptyStyle(),this.style.setSky(y),this._update(!0)}getSky(){return this.style.getSky()}setFeatureState(y,t){return this.style.setFeatureState(y,t),this._update()}removeFeatureState(y,t){return this.style.removeFeatureState(y,t),this._update()}getFeatureState(y){return this.style.getFeatureState(y)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let y=0,t=0;return this._container&&(y=this._container.clientWidth||400,t=this._container.clientHeight||300),[y,t]}_setupContainer(){const y=this._container;y.classList.add("maplibregl-map");const t=this._canvasContainer=q.create("div","maplibregl-canvas-container",y);this._interactive&&t.classList.add("maplibregl-interactive"),this._canvas=q.create("canvas","maplibregl-canvas",t),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex",this._interactive?"0":"-1"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region");const a=this._containerDimensions(),d=this._getClampedPixelRatio(a[0],a[1]);this._resizeCanvas(a[0],a[1],d);const f=this._controlContainer=q.create("div","maplibregl-control-container",y),_=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(E=>{_[E]=q.create("div",`maplibregl-ctrl-${E} `,f)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(y,t,a){this._canvas.width=Math.floor(a*y),this._canvas.height=Math.floor(a*t),this._canvas.style.width=`${y}px`,this._canvas.style.height=`${t}px`}_setupPainter(){const y={alpha:!0,stencil:!0,depth:!0,failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1};let t=null;this._canvas.addEventListener("webglcontextcreationerror",d=>{t={requestedAttributes:y},d&&(t.statusMessage=d.statusMessage,t.type=d.type)},{once:!0});const a=this._canvas.getContext("webgl2",y)||this._canvas.getContext("webgl",y);if(!a){const d="Failed to initialize WebGL";throw t?(t.message=d,new Error(JSON.stringify(t))):new Error(d)}this.painter=new Tt(a,this.transform),Ee.testSupport(a)}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(y){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||y,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(y){return this._update(),this._renderTaskQueue.add(y)}_cancelRenderFrame(y){this._renderTaskQueue.remove(y)}_render(y){const t=this._idleTriggered?this._fadeDuration:0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(y),this._removed)return;let a=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const f=this.transform.zoom,_=G.now();this.style.zoomHistory.update(f,_);const E=new c.z(f,{now:_,fadeDuration:t,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),I=E.crossFadingFactor();I===1&&I===this._crossFadingFactor||(a=!0,this._crossFadingFactor=I),this.style.update(E)}this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.sourceCache.update(this.transform,this.terrain),this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._elevationFreeze||(this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform.minElevationForCurrentTile=0,this.transform.elevation=0),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,t,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:t,showPadding:this.showPadding}),this.fire(new c.k("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,c.bf.mark(c.bg.load),this.fire(new c.k("load"))),this.style&&(this.style.hasTransitions()||a)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const d=this._sourcesDirty||this._styleDirty||this._placementDirty;return d||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new c.k("idle")),!this._loaded||this._fullyLoaded||d||(this._fullyLoaded=!0,c.bf.mark(c.bg.fullLoad)),this}redraw(){return this.style&&(this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._render(0)),this}remove(){var y;this._hash&&this._hash.remove();for(const a of this._controls)a.onRemove(this);this._controls=[],this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),he.removeThrottleControl(this._imageQueueHandle),(y=this._resizeObserver)===null||y===void 0||y.disconnect();const t=this.painter.context.gl.getExtension("WEBGL_lose_context");t!=null&&t.loseContext&&t.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),q.remove(this._canvasContainer),q.remove(this._controlContainer),this._container.classList.remove("maplibregl-map"),c.bf.clearMetrics(),this._removed=!0,this.fire(new c.k("remove"))}triggerRepaint(){this.style&&!this._frameRequest&&(this._frameRequest=new AbortController,G.frameAsync(this._frameRequest).then(y=>{c.bf.frame(y),this._frameRequest=null,this._render(y)}).catch(()=>{}))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(y){this._showTileBoundaries!==y&&(this._showTileBoundaries=y,this._update())}get showPadding(){return!!this._showPadding}set showPadding(y){this._showPadding!==y&&(this._showPadding=y,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(y){this._showCollisionBoxes!==y&&(this._showCollisionBoxes=y,y?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(y){this._showOverdrawInspector!==y&&(this._showOverdrawInspector=y,this._update())}get repaint(){return!!this._repaint}set repaint(y){this._repaint!==y&&(this._repaint=y,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(y){this._vertices=y,this._update()}get version(){return Ld}getCameraTargetElevation(){return this.transform.elevation}},w.MapMouseEvent=$r,w.MapTouchEvent=ba,w.MapWheelEvent=Ad,w.Marker=ic,w.NavigationControl=class{constructor(y){this._updateZoomButtons=()=>{const t=this._map.getZoom(),a=t===this._map.getMaxZoom(),d=t===this._map.getMinZoom();this._zoomInButton.disabled=a,this._zoomOutButton.disabled=d,this._zoomInButton.setAttribute("aria-disabled",a.toString()),this._zoomOutButton.setAttribute("aria-disabled",d.toString())},this._rotateCompassArrow=()=>{const t=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${this._map.transform.angle*(180/Math.PI)}deg)`:`rotate(${this._map.transform.angle*(180/Math.PI)}deg)`;this._compassIcon.style.transform=t},this._setButtonTitle=(t,a)=>{const d=this._map._getUIString(`NavigationControl.${a}`);t.title=d,t.setAttribute("aria-label",d)},this.options=c.e({},ap,y),this._container=q.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",t=>t.preventDefault()),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",t=>this._map.zoomIn({},{originalEvent:t})),q.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",t=>this._map.zoomOut({},{originalEvent:t})),q.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",t=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:t}):this._map.resetNorth({},{originalEvent:t})}),this._compassIcon=q.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(y){return this._map=y,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new lp(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){q.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(y,t){const a=q.create("button",y,this._container);return a.type="button",a.addEventListener("click",t),a}},w.Popup=class extends c.E{constructor(y){super(),this.remove=()=>(this._content&&q.remove(this._content),this._container&&(q.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),this._map._canvasContainer.classList.remove("maplibregl-track-pointer"),delete this._map,this.fire(new c.k("close"))),this),this._onMouseUp=t=>{this._update(t.point)},this._onMouseMove=t=>{this._update(t.point)},this._onDrag=t=>{this._update(t.point)},this._update=t=>{var a;if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=q.create("div","maplibregl-popup",this._map.getContainer()),this._tip=q.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(const I of this.options.className.split(" "))this._container.classList.add(I);this._closeButton&&this._closeButton.setAttribute("aria-label",this._map._getUIString("Popup.Close")),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._lngLat=this._map.transform.renderWorldCopies&&!this._trackPointer?ar(this._lngLat,this._flatPos,this._map.transform):(a=this._lngLat)===null||a===void 0?void 0:a.wrap(),this._trackPointer&&!t)return;const d=this._flatPos=this._pos=this._trackPointer&&t?t:this._map.project(this._lngLat);this._map.terrain&&(this._flatPos=this._trackPointer&&t?t:this._map.transform.locationPoint(this._lngLat));let f=this.options.anchor;const _=oc(this.options.offset);if(!f){const I=this._container.offsetWidth,k=this._container.offsetHeight;let z;z=d.y+_.bottom.y<k?["top"]:d.y>this._map.transform.height-k?["bottom"]:[],d.x<I/2?z.push("left"):d.x>this._map.transform.width-I/2&&z.push("right"),f=z.length===0?"bottom":z.join("-")}let E=d.add(_[f]);this.options.subpixelPositioning||(E=E.round()),q.setTransform(this._container,`${Oi[f]} translate(${E.x}px,${E.y}px)`),rc(this._container,f,"popup")},this._onClose=()=>{this.remove()},this.options=c.e(Object.create(Ft),y)}addTo(y){return this._map&&this.remove(),this._map=y,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new c.k("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(y){return this._lngLat=c.N.convert(y),this._pos=null,this._flatPos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._flatPos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(y){return this.setDOMContent(document.createTextNode(y))}setHTML(y){const t=document.createDocumentFragment(),a=document.createElement("body");let d;for(a.innerHTML=y;d=a.firstChild,d;)t.appendChild(d);return this.setDOMContent(t)}getMaxWidth(){var y;return(y=this._container)===null||y===void 0?void 0:y.style.maxWidth}setMaxWidth(y){return this.options.maxWidth=y,this._update(),this}setDOMContent(y){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=q.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(y),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(y){return this._container&&this._container.classList.add(y),this}removeClassName(y){return this._container&&this._container.classList.remove(y),this}setOffset(y){return this.options.offset=y,this._update(),this}toggleClassName(y){if(this._container)return this._container.classList.toggle(y)}setSubpixelPositioning(y){this.options.subpixelPositioning=y}_createCloseButton(){this.options.closeButton&&(this._closeButton=q.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const y=this._container.querySelector(sc);y&&y.focus()}},w.RasterDEMTileSource=Yt,w.RasterTileSource=Rt,w.ScaleControl=class{constructor(y){this._onMove=()=>{ru(this._map,this._container,this.options)},this.setUnit=t=>{this.options.unit=t,ru(this._map,this._container,this.options)},this.options=Object.assign(Object.assign({},Jr),y)}getDefaultPosition(){return"bottom-left"}onAdd(y){return this._map=y,this._container=q.create("div","maplibregl-ctrl maplibregl-ctrl-scale",y.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){q.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},w.ScrollZoomHandler=Os,w.Style=Nu,w.TerrainControl=class{constructor(y){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.Disable")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.Enable"))},this.options=y}onAdd(y){return this._map=y,this._container=q.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=q.create("button","maplibregl-ctrl-terrain",this._container),q.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){q.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},w.TwoFingersTouchPitchHandler=_r,w.TwoFingersTouchRotateHandler=_h,w.TwoFingersTouchZoomHandler=gh,w.TwoFingersTouchZoomRotateHandler=ka,w.VectorTileSource=bn,w.VideoSource=vr,w.addSourceType=(y,t)=>c._(void 0,void 0,void 0,function*(){if(fr(y))throw new Error(`A source type called "${y}" already exists.`);((a,d)=>{dr[a]=d})(y,t)}),w.clearPrewarmedResources=function(){const y=Nn;y&&(y.isPreloaded()&&y.numActive()===1?(y.release(Sn),Nn=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},w.getMaxParallelImageRequests=function(){return c.a.MAX_PARALLEL_IMAGE_REQUESTS},w.getRTLTextPluginStatus=function(){return jr().getRTLTextPluginStatus()},w.getVersion=function(){return wo},w.getWorkerCount=function(){return cn.workerCount},w.getWorkerUrl=function(){return c.a.WORKER_URL},w.importScriptInWorkers=function(y){return Qt().broadcast("IS",y)},w.prewarm=function(){rn().acquire(Sn)},w.setMaxParallelImageRequests=function(y){c.a.MAX_PARALLEL_IMAGE_REQUESTS=y},w.setRTLTextPlugin=function(y,t){return jr().setRTLTextPlugin(y,t)},w.setWorkerCount=function(y){cn.workerCount=y},w.setWorkerUrl=function(y){c.a.WORKER_URL=y}});var b=o;return b})})(p5);var CI=p5.exports;const II=F0(CI),g5="map",kI="#D8F2FF",PI="#666666",Qb="#ffffff",AI="#999999",MI="#08254d",_5="#6EE143",y5=0,zI={fillColor:"#6EE143",fillOpacity:0,strokeColor:"#000000",strokeOpacity:1,strokeWidth:3.5},DI={fillColor:"#6EE143",fillOpacity:0,strokeColor:"#000000",strokeOpacity:1,strokeWidth:3.5},LI={id:"43f36e14-e3f5-43c1-84c0-50a9c80dc5c7",name:"MapLibre",zoom:.8619833357855968,pitch:0,center:[17.65431710431244,32.954120326746775],glyphs:"https://demotiles.maplibre.org/font/{fontstack}/{range}.pbf",layers:[{id:"background",type:"background",paint:{"background-color":kI},filter:["all"],layout:{visibility:"visible"},maxzoom:24},{id:"coastline",type:"line",paint:{"line-blur":.5,"line-color":PI,"line-width":{stops:[[0,2],[6,6],[14,9],[22,18]]}},filter:["all"],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},source:"maplibre",maxzoom:24,minzoom:0,"source-layer":"countries"},{id:"countries-fill",type:"fill",paint:{"fill-color":Qb},filter:["all"],layout:{visibility:"visible"},source:"maplibre",maxzoom:24,"source-layer":"countries"},{id:"countries-boundary",type:"line",paint:{"line-color":AI,"line-width":{stops:[[1,1],[6,2],[14,6],[22,12]]},"line-opacity":{stops:[[3,.5],[6,1]]}},layout:{"line-cap":"round","line-join":"round",visibility:"visible"},source:"maplibre",maxzoom:24,"source-layer":"countries"},{id:"countries-label",type:"symbol",paint:{"text-color":MI,"text-halo-blur":{stops:[[2,.2],[6,0]]},"text-halo-color":"rgba(255, 255, 255, 1)","text-halo-width":{stops:[[2,1],[6,1.6]]}},filter:["all"],layout:{"text-font":["Open Sans Semibold"],"text-size":{stops:[[2,10],[4,12],[6,16]]},"text-field":{stops:[[2,"{ABBREV}"],[4,"{NAME}"]]},visibility:"visible","text-max-width":10,"text-transform":{stops:[[0,"uppercase"],[2,"none"]]}},source:"maplibre",maxzoom:24,minzoom:2,"source-layer":"centroids"},{id:"crimea-fill",type:"fill",source:"crimea",paint:{"fill-color":Qb}}],bearing:0,sources:{maplibre:{url:"https://demotiles.maplibre.org/tiles/tiles.json",type:"vector"},crimea:{type:"geojson",data:{type:"Feature",geometry:{type:"Polygon",coordinates:[[[34.00905273547181,46.55925987559425],[33.64325260204026,46.34533545368038],[33.628682598560204,46.12569762665683],[33.64292861730951,46.10476396128129],[33.648473474905984,46.09033047763651],[33.63876482059936,46.077976784785335],[33.62782672238245,46.06747935719011],[33.62911357645072,46.05708111413949],[33.642686868727424,46.02192963417187],[33.6429723910654,46.01521185644708],[33.636224138774026,46.006705833212465],[33.63052626465907,45.99692992186792],[33.63193836679693,45.988472992911284],[33.64276684834442,45.984575360297384],[33.646928693041986,45.97981936210982],[33.638745893564305,45.96829769147004],[33.61958133326394,45.951176418494185],[33.63181380398527,45.9445404758078],[33.638921676216,45.94737012930554],[33.64561542516918,45.95403251372139],[33.65666403976448,45.95687114427736],[33.6825817382811,45.95878100879199],[33.738791807037614,45.94836945227263],[33.758180142697,45.94072970008301],[33.77735917288169,45.92923970233858],[33.75927796793485,45.92241179584471],[33.72529865009221,45.91587363154565],[33.70875012326826,45.91008760988058],[33.69378857293381,45.91480850795665],[33.69092650243843,45.89657370898402],[33.693592356906805,45.87271465766318],[33.69226765972388,45.86041392418218],[33.6704813511748,45.8584273836251],[33.65936345808916,45.85944682601249],[33.653870582376726,45.86425922279372],[33.65107345584843,45.87089907254003],[33.63067378180233,45.88040685247182],[33.61945300059696,45.88147266102649],[33.60987421595539,45.88048951126686],[33.59906957603934,45.877610457390375],[33.57828877687868,45.86810261756233],[33.55357394560386,45.84700625141778],[33.530220674480375,45.84221983655459],[33.5192297395441,45.84121682367507],[33.50832088442496,45.84313067048083],[33.48901101848409,45.85268298292175],[33.482152996405716,45.854578171799005],[33.46719955896293,45.849912739405056],[33.42447496599681,45.83075886348303],[33.40940172404095,45.82691953557702],[33.37918350072067,45.802867525073566],[33.37362145339398,45.79619281922518],[33.33805543634864,45.78577808972071],[33.26498872665803,45.75410774187094],[33.22887541283427,45.75131270772724],[33.19548267281132,45.7644887297206],[33.1789202379222,45.78010311364778],[33.1688456078636,45.78470227904205],[33.161012432811674,45.77921593899549],[33.15951585299757,45.76864464913777],[33.165962301438725,45.762685940125465],[33.1750888126426,45.759218220695715],[33.181464829753,45.75490447884948],[33.17613930782352,45.7437961960276],[33.16369168844906,45.735912015025065],[32.93692665480876,45.662114646778264],[32.86839112407645,45.63044340698664],[32.83803944575723,45.60834075026611],[32.82702772424804,45.59576101516498],[32.82433467080986,45.58705137380335],[32.82563941622885,45.579605763895614],[32.82993674258438,45.56978311819469],[32.82851940940563,45.56227808675749],[32.813310142795274,45.55930933158257],[32.80213583657516,45.560145780074464],[32.78258622159436,45.565158335073846],[32.77333922465823,45.56689313356526],[32.758306734735356,45.565030173463356],[32.750177256846115,45.55943726334968],[32.74340732630185,45.55261895849793],[32.73524549539499,45.54598788110354],[32.72031700779701,45.53735927760957],[32.70536040418847,45.53169142131733],[32.68589438933773,45.52663379187257],[32.66370583186284,45.52563107058867],[32.64312077736798,45.52188979044979],[32.525284074162556,45.45838108691365],[32.49490411219156,45.43524910229854],[32.48107654411925,45.408986638827514],[32.48514589713025,45.39458067125969],[32.51256939517424,45.34060655033625],[32.535915460470335,45.33777248012882],[32.57027153843481,45.32510892683359],[32.590830644991826,45.32038723212662],[32.66380378113439,45.320421746458976],[32.67760722618917,45.32609231279554],[32.71316246802607,45.353283572618125],[32.72817188836078,45.36074681043402],[32.750518060251466,45.36371725645313],[32.89973931692998,45.35412322462227],[32.941197846443885,45.34245505845169],[32.97701667405008,45.32596743563991],[33.04296090827762,45.2853982930032],[33.05274355585479,45.28154273654923],[33.06850284417635,45.27703461892352],[33.07825272648239,45.272210805127315],[33.089426322403455,45.25656353201492],[33.09897492343546,45.247820101667884],[33.12384611720435,45.238235755071685],[33.15767197859745,45.20755227709648],[33.172959979330074,45.19681657531794],[33.21837666514142,45.187878368659824],[33.24017433636709,45.180191106261134],[33.248571989896675,45.16588271012458],[33.259649216030766,45.155918961282026],[33.28309785485047,45.16064860772312],[33.31767999550894,45.17535522412791],[33.35458473323109,45.18598673360148],[33.39725661527919,45.18973663076909],[33.41344561756824,45.18490731877088],[33.468468576977216,45.149132412229676],[33.537128652906205,45.11719769268973],[33.56161328289443,45.094099022711475],[33.57837628774928,45.053145935448015],[33.58247744978442,45.027377243150454],[33.5851414316958,45.01816461606674],[33.6031021265521,44.993103583251695],[33.605922209331794,44.986905272229734],[33.60843524291815,44.97039962759274],[33.61943161357851,44.93184946652454],[33.619484500808824,44.90819321920554],[33.61549738593425,44.88894092276257],[33.608561183117274,44.871288478948514],[33.59889474705494,44.859790298912856],[33.55904244709464,44.850057575124595],[33.54667558363471,44.83724531175508],[33.53701832136994,44.81871953508235],[33.5303157846202,44.798338017069625],[33.5249116915937,44.78918633101301],[33.51669091675143,44.784809980590666],[33.524785531609865,44.77183212449111],[33.5302902535075,44.75724515985675],[33.53710734694323,44.73034290771247],[33.54650992495621,44.70989226909535],[33.5481286806762,44.699106546699085],[33.543995566510915,44.68230506537358],[33.53580273994743,44.6726082589706],[33.52337411931097,44.661863083605255],[33.515320778874354,44.6491266698327],[33.516377841582795,44.63464990118433],[33.52466971637648,44.62863961572572],[33.557474298027785,44.62473000923737],[33.5710648827386,44.620853511273225],[33.55105839203679,44.61506440493406],[33.499905706797676,44.61452599304897],[33.48451102966331,44.60992438254493],[33.47658499621011,44.60714391514574],[33.46705078205747,44.60616254193252],[33.44476599234898,44.607062134677875],[33.4353466482458,44.60509936890821],[33.413591053005575,44.593500212748125],[33.40543527945235,44.59055535193136],[33.37510958624222,44.58564691897425],[33.37074452434078,44.58851022190515],[33.372237834990756,44.576810695127364],[33.37913003799301,44.56412673079859],[33.48759131590526,44.51024086451031],[33.50011215135888,44.50041002882833],[33.517917009115365,44.49074142372788],[33.53836387802215,44.49164280212756],[33.56041892763031,44.4966411022441],[33.57822378538677,44.497542389459795],[33.59062975079095,44.48975808594983],[33.619577003408466,44.46229988129974],[33.62635433636015,44.45336293328907],[33.63175322871038,44.434828756313124],[33.645537634715026,44.42498521035591],[33.721007257593925,44.39946630464436],[33.74168386660085,44.39560878121904],[33.80727466517129,44.39454176175843],[33.81841706002561,44.39552670349164],[33.83909366903248,44.40143600575672],[33.85149963444792,44.40143600575945],[33.91467816197718,44.38387049706651],[33.938111652185,44.38083293528811],[33.957065210440874,44.38272116790142],[34.06614966692763,44.42019923628979],[34.088893936836286,44.42200415824283],[34.10279321289039,44.42487551014821],[34.135933345669,44.44163597968952],[34.14696087047267,44.44959070749778],[34.16058918507403,44.466287285335795],[34.170123399227776,44.48186111741296],[34.182759104731986,44.49267838558103],[34.22923417224524,44.49949719774551],[34.24301857824986,44.50744404277697],[34.263903954150294,44.53186886058606],[34.26631622520165,44.53555362837611],[34.26631622520165,44.54153064468656],[34.27033667695244,44.545378535987936],[34.2757355693048,44.54644280144541],[34.285384653508004,44.54562413743594],[34.299973149863405,44.54554227040174],[34.32260254971496,44.543577427039224],[34.3308731933177,44.54546040325087],[34.340292537420794,44.55798473830754],[34.38042135640006,44.631830317636684],[34.41495238900856,44.673669777529994],[34.424193090575585,44.68239452736094],[34.42959198292681,44.68884644523774],[34.469399167794535,44.730194532749294],[34.47376422969597,44.73011292571252],[34.47376422969597,44.72635887754967],[34.475142670296464,44.723502373339585],[34.499724861011515,44.74292382044041],[34.532800295801195,44.752620844929055],[34.61217550038418,44.76534519537847],[34.65065696715081,44.777088262503725],[34.72084256772871,44.811080759265764],[34.756796893391225,44.82094054159748],[34.82646979041766,44.81208604604609],[34.84289620758207,44.816893835303176],[34.856910353686715,44.82373813182468],[34.889648317948144,44.817871641692506],[34.90733830566026,44.820886440346584],[34.922960632465504,44.83050015059965],[34.92950822531711,44.83652826953224],[34.94179932067178,44.84019370922482],[34.95282684547897,44.841415470643284],[34.98567967978991,44.840275160795755],[35.0053224583441,44.83538786296728],[35.017958163849414,44.82219008824552],[35.02703289780189,44.80890779582285],[35.037933245998005,44.79869792240089],[35.08073333784134,44.793525442788905],[35.1080207326404,44.824553365795765],[35.130368105574235,44.86879838545747],[35.15485200090768,44.90071251697748],[35.17111229780758,44.90746386008772],[35.21522068940149,44.91421441031795],[35.233163085981715,44.925728224907715],[35.25636688416236,44.95896657181197],[35.27300098099195,44.96690119386028],[35.29748487632534,44.95605693543271],[35.30496087491386,44.96121482614441],[35.315240372954605,44.965711070514175],[35.31935217217088,44.96941359539801],[35.36757236298112,44.94362319076086],[35.36103086422793,44.97364475976596],[35.362152264014156,44.98593980935419],[35.374674561627444,44.997835734117416],[35.389439658813274,45.00180049366759],[35.42270785247763,45.00087540764923],[35.43504325012745,45.00470780964241],[35.43504325012745,45.011446929213974],[35.40631957913584,45.02015821022701],[35.40089948016896,45.025046135473445],[35.39790908073891,45.03482073400548],[35.40052568024015,45.042216617888045],[35.40631957913584,45.051328088783805],[35.40744097892215,45.06294640963205],[35.41734667704213,45.0708666385693],[35.469304867139925,45.10068964922732],[35.5070260597534,45.113341616151644],[35.54758335202416,45.12019982412133],[35.59019654390909,45.11993606213795],[35.63411803553862,45.11439677872579],[35.70669729572677,45.09480210570922],[35.771782422456766,45.06572995732262],[35.78430472007,45.057941041321754],[35.81250040352472,45.031852200991295],[35.81941570220667,45.021152336906454],[35.82763930064016,44.99895365027004],[35.848198296721705,44.99208088455586],[35.916977483614176,45.00172895661731],[35.99360646900681,44.997896355361604],[36.00893226608571,45.00926125333629],[36.02539976723364,45.03288661039673],[36.047827762958946,45.048074065419456],[36.078666257082034,45.03883000769565],[36.079137312377895,45.046610970582435],[36.135020401727616,45.02125162210126],[36.2241716847341,45.00751061631556],[36.24398308095806,45.011474706353084],[36.24828178013877,45.01649549321965],[36.25332807917695,45.03247980324494],[36.25743987839326,45.03842324279259],[36.267158676549116,45.043573724415154],[36.2783726744118,45.04555455542638],[36.36740852558336,45.04833265291825],[36.44029951169139,45.06787222615526],[36.45375630913995,45.07631970334319],[36.455251508854985,45.09202341204062],[36.44142091149291,45.10709638287736],[36.41432041665814,45.12872568311289],[36.40852651776157,45.149160473330085],[36.409997342308856,45.171615955386955],[36.418312796420764,45.23001671705953],[36.42672329481775,45.25186253492981],[36.43756477765089,45.27227491599612],[36.4497132753354,45.28542626329343],[36.45905827355429,45.28753019598713],[36.4814862692796,45.28845064200263],[36.4909554290368,45.29213135137758],[36.49637552800283,45.300940007322055],[36.49394582846682,45.305015191082816],[36.48871262946426,45.30935296803605],[36.48460083024801,45.315924724862185],[36.489647129296515,45.336413860372005],[36.502169426909745,45.34731734941451],[36.52104632331191,45.35033842661815],[36.544281237819945,45.34731734942025],[36.57455903204905,45.33601971904315],[36.585399229982954,45.333917585593355],[36.59810088537549,45.334837278577254],[36.630808379142394,45.34048649352954],[36.637536777859964,45.3511265071989],[36.63099527910589,45.3741073632589],[36.61359545390113,45.40895280985421],[36.59845655678569,45.421547717459106],[36.58331765967199,45.42731944465129],[36.566309762912795,45.42548305000767],[36.54836736633254,45.41210180010589],[36.53285466928139,45.4090840212946],[36.51565987255873,45.41957994832251],[36.49117597722616,45.44279525429408],[36.47043008117939,45.4458112314303],[36.411182792482634,45.43610707766504],[36.391371396258705,45.43991025572652],[36.35959840231365,45.45407156049933],[36.33960010612526,45.45695583486963],[36.33025510790637,45.454464879327446],[36.32053630976225,45.44856480887407],[36.31156511147125,45.4438443081136],[36.29885591389362,45.442795254299995],[36.3072664122906,45.46115087970253],[36.30016421364425,45.47320989503609],[36.283717016779036,45.476355300848866],[36.267082919949445,45.46704963343626],[36.25213092279836,45.46115087970253],[36.13681364478941,45.46219959214511],[36.11700224855986,45.45721803432335],[36.097003952371466,45.441483909606006],[36.06952965760803,45.43046741078453],[36.0655449627526,45.42553028973455],[36.05134056545904,45.39535242162091],[36.022557970944945,45.368441166003805],[35.986486277818386,45.362926059418186],[35.94723728529826,45.372380198658874],[35.87220216002379,45.404075760536614],[35.85388596351393,45.413916621802144],[35.84715756479628,45.426379251448395],[35.8524047739447,45.44386497541683],[35.85950697259193,45.45933624762881],[35.857824872912545,45.469953901705],[35.83278027768503,45.47087138287168],[35.8167068807486,45.46392436820739],[35.80362388324218,45.44963442058864],[35.79469305616038,45.42980210462429],[35.791889556694684,45.41209230278156],[35.772265060435046,45.39214572935421],[35.767405661361295,45.38873311015669],[35.75189296431793,45.386632934388984],[35.7481549650407,45.379938103368545],[35.746846665290036,45.369960021421576],[35.74423006578874,45.36076812520648],[35.71619507113218,45.34040932557082],[35.69451467527287,45.32989869277279],[35.51720627467216,45.29506847418358],[35.48038698168983,45.2979608697527],[35.33194061536096,45.371562726652314],[35.04491375777232,45.669545248704424],[35.00230056589345,45.7290693869553],[34.70631294999043,46.024929846739866],[34.35868883309806,46.106725558140795],[34.00905273547181,46.55925987559425]]]}}}},version:8,metadata:{"maptiler:copyright":"This style was generated on MapTiler Cloud. Usage is governed by the license terms in https://github.com/maplibre/demotiles/blob/gh-pages/LICENSE","openmaptiles:version":"3.x"}};let rs=null;const RI=()=>{const e=Jm();return Bt.useCallback(()=>(rs=new II.Map({container:g5,style:LI,center:[27,-17],zoom:2.5}),e(jl.actions.setIsMapInitialized(!0)),()=>{e(jl.actions.setIsMapInitialized(!1)),rs.remove(),rs=null}),[e])},Xf=()=>{const e=ss(r=>r.main.isMapInitialized);return Bt.useCallback(r=>{if(!e||rs===null)return()=>null;const o=r();return typeof o=="function"?()=>{!e||rs===null||o()}:o},[e])},v5=()=>{const e=Xf();return Bt.useCallback((r,o)=>e(()=>(rs.on(r,o),()=>rs.off(r,o))),[e])},OI=()=>{const e=v5();return Bt.useCallback(r=>e("click",r),[e])},e2={strokeColor:"black",strokeOpacity:1,strokeWidth:2,fillColor:"white",fillOpacity:.5},Kf=()=>{const e=Xf();return Bt.useCallback((r,o=e2)=>e(()=>{const h=c=>o[c]??e2[c],g=`geo-json-${Math.random()}`,b=`${g}-fill`,w=`${g}-stroke`;return rs.addSource(g,{type:"geojson",data:r}),rs.addLayer({id:b,type:"fill",source:g,paint:{"fill-color":h("fillColor"),"fill-opacity":h("fillOpacity")}}),rs.addLayer({id:w,type:"line",source:g,paint:{"line-color":h("strokeColor"),"line-opacity":h("strokeOpacity"),"line-width":h("strokeWidth")}}),()=>{rs.removeLayer(b),rs.removeLayer(w),rs.removeSource(g)}}),[e])},FI={padding:100},BI=()=>{const e=Xf();return Bt.useCallback((r,o=FI)=>e(()=>{rs.fitBounds([[r[0],r[1]],[r[2],r[3]]],o)}),[e])},NI={},UI=()=>{const e=Xf();return Bt.useCallback((r,o,h,g=NI)=>e(()=>{rs.flyTo({center:[r,o],zoom:h,...g})}),[e])},jI=()=>{const e=Xf();return Bt.useCallback(r=>e(()=>{rs.flyTo({zoom:r})}),[e])},$I=()=>{const e=Xf();return Bt.useCallback((r,o)=>e(()=>{const h=rs.unproject([r,o]);return[h.lng,h.lat]}),[e])},VI=()=>{const e=jI(),r=Jm(),o=ss(g=>g.main.focusedCountry);if(!o)return null;const h=()=>{r(jl.actions.setFocusedCountry(null)),r(jl.actions.setFocusedState(null)),e(1)};return ft.jsx(t5,{title:o.name,extraDescriptions:[`Country Name: ${o.name}`],getDatasets:()=>W4(o.codeIso3),onClickBack:h})},x5=e=>w5(["mousemove","touchmove"],b5(e)),qI=e=>w5(["mouseup","touchend"],b5(e)),w5=(e,r)=>(e.forEach(o=>document.addEventListener(o,r)),()=>{e.forEach(o=>document.removeEventListener(o,r))}),b5=e=>r=>{var o;!r.clientX&&!r.clientY&&((o=r.touches)!=null&&o[0])&&(r.clientX=r.touches[0].clientX,r.clientY=r.touches[0].clientY),e(r)},ZI="_container_16n2u_1",WI={container:ZI},S5=200,GI=.5,HI=()=>Math.max(Math.min(document.body.clientWidth*.5,500),S5),XI=()=>{const[e,r]=Bt.useState(null),[o,h]=Bt.useState(null),g=ss(D=>D.main.menuWidthPx),b=Bt.useCallback(D=>{h({x:D.clientX,y:D.clientY}),r(g)},[g]);Bt.useEffect(()=>qI(()=>{h(null),r(null)}),[]);const w=Jm();Bt.useEffect(()=>x5(D=>{if(o!==null){const j=D.clientX-o.x;let J=e+j;const G=document.body.clientWidth*GI;J=Math.max(J,S5),J=Math.min(J,G),w(jl.actions.setMenuWidthPx(J))}}),[w,o,g,e]);const c=Bt.useCallback(()=>{const D=HI();w(jl.actions.setMenuWidthPx(D))},[w]);return Bt.useEffect(()=>{c();const D=()=>c();return window.addEventListener("resize",D),()=>window.removeEventListener("resize",D)},[c]),ft.jsx("div",{className:WI.container,onMouseDown:b,onTouchStart:b})},KI="_attributions_3x5ia_1",YI="_attribution_3x5ia_1",JI="_attributionKey_3x5ia_13",QI="_attributionValue_3x5ia_19",ek="_attributionUrl_3x5ia_23",tk="_line_3x5ia_46",Tc={attributions:KI,attribution:YI,attributionKey:JI,attributionValue:QI,attributionUrl:ek,line:tk},nk=()=>{const e=Bt.useMemo(()=>[{key:"This data in this map was compiled by Maria Powell and her team for a forthcoming publication",value:ft.jsxs(ft.Fragment,{children:["Powell, M.E., Salvi Cruz, S., Farb, A., Prasad Kodibagkar, A., Ghosh, S., Rudzicz, F., Rameau, A., Bensoussan, Y., Towards Protocol Harmonization: A Scoping Review of Publicly-Accessible Speech and Voice Datasets in Three Voice-Affecting Disease Cohorts,",ft.jsx("i",{children:"Journal of Speech, Language, and Hearing Research"}),", Forthcoming."]})},{key:"Country Borders (default)",value:"MapLibre DemoTiles",url:"https://demotiles.maplibre.org/style.json"},{key:"Country Borders (hovered / focused)",value:"World Administrative Boundaries",url:"https://public.opendatasoft.com/explore/dataset/world-administrative-boundaries"},{key:"USA State Borders",value:"US State Boundaries",url:"https://public.opendatasoft.com/explore/dataset/us-state-boundaries/"},{key:"Canada Province and Territory Borders",value:"Provinces and territories - Canada",url:"https://data.opendatasoft.com/explore/dataset/georef-canada-province%40public"},{key:"Software Dependencies",values:[{name:"MapLibre",url:"https://maplibre.org/"},{name:"React",url:"https://react.dev/"},{name:"Redux",url:"https://redux.js.org/"},{name:"Vite",url:"https://vite.dev/"},{name:"Turf.js",url:"https://turfjs.org/"},{name:"Lodash",url:"https://lodash.com/"},{name:"Font Awesome",url:"https://fontawesome.com/"}]}].map(({key:r,values:o,value:h,url:g},b)=>ft.jsxs("div",{className:Tc.attribution,children:[o&&ft.jsxs(ft.Fragment,{children:[ft.jsxs("div",{className:Tc.attributionKey,children:[r,":"]}),ft.jsx("ul",{children:o.map(({name:w,url:c},D)=>ft.jsxs("li",{children:[ft.jsx("div",{children:w}),ft.jsx("div",{className:Tc.line}),ft.jsx("a",{href:c,target:"_",rel:"noreferrer",className:Tc.attributionUrl,children:c})]},D))})]}),h&&ft.jsxs("div",{children:[ft.jsxs("div",{className:Tc.attributionKey,children:[r,":"]}),ft.jsx("div",{className:Tc.attributionValue,children:h})]}),g&&ft.jsx("a",{href:g,target:"_",rel:"noreferrer",className:Tc.attributionUrl,children:g})]},b)),[]);return ft.jsxs(ft.Fragment,{children:[ft.jsx(Rf,{title:"About",descriptions:["This map tracks publicly accessible speech and voice datasets collected for neurological, mood, and speech disorder research in different countries. Information about the institutional source of the datasets, the number of speakers, languages, and types of voice samples are included, but the focus of the map is on the governance of these voice datasets. The type of accessibility (open or safeguarded), access instructions, and licensing are detailed and can be compared between datasets, institutions, and countries/regions. This map complements a forthcoming searchable tool that can be used to find voice datasets specific to disease categories, diagnoses, or vocal tasks.","In an upcoming iteration of the map, a research ethics element will be added to the dataset information, focusing on the informed consent process that participants went through to contribute their voice data. The aim is to provide information about the research ethics process and related documentation (e.g., consent forms, IRB/REB documentation) to make these datasets more easily useable for researchers whose institutions have stringent data governance requirements."]}),ft.jsx(Rf,{title:"Contact",descriptions:[ft.jsxs(ft.Fragment,{children:["You can contact us with questions or comments by emailing"," ",ft.jsx("a",{href:"mailto:alden_blatter@sfu.ca",target:"_",rel:"noreferrer",children:"alden_blatter@sfu.ca"})]})]}),ft.jsx(Rf,{title:"Attributions",children:ft.jsx("div",{className:Tc.attributions,children:e})})]})},hx=e=>e==="USA"?"State":e==="CAN"?"Province / Territory":"State",rk=3,t2=100,T5=()=>{const e=BI(),r=UI(),o=ik();return Bt.useCallback(h=>{const g=h.bbox[0];if(h.bbox[2]-g>180){const[c,D]=h.coordLonLat;r(c,D,rk,{...o})}else e(h.bbox)},[e,r,o])},ik=()=>{const e=ss(h=>h.main.menuWidthPx),[r,o]=Bt.useState({width:document.body.clientWidth,height:document.body.clientHeight});return Bt.useEffect(()=>{const h=()=>{o({width:document.body.clientWidth,height:document.body.clientHeight})};return window.addEventListener("resize",h),()=>window.removeEventListener("resize",h)},[]),Bt.useMemo(()=>{const{width:h,height:g}=r,b=(h-e)/4,w=g/4,c=Math.min(b,t2),D=Math.min(w,t2);return{padding:{right:c,left:c+e,top:D,bottom:D}}},[e,r])},sk=()=>{const e=Jm(),r=T5(),o=ss(b=>b.main.focusedCountry),h=ss(b=>b.main.focusedState);if(!o||!h)return null;const g=()=>{e(jl.actions.setFocusedState(null)),r(o)};return ft.jsx(t5,{title:`${h.name}, ${o.name}`,extraDescriptions:[`${hx(o.codeIso3)} Name: ${h.name}`,`Country Name: ${o.name}`],getDatasets:()=>K4(o.codeIso3,h.stateCode),onClickBack:g})},ok="_header_xgzbu_1",ak="_headerAccent_xgzbu_14",lk="_content_xgzbu_20",uk="_subheaderText_xgzbu_25",Wh={header:ok,headerAccent:ak,content:lk,subheaderText:uk},ck=()=>{const e=ss(g=>g.main.focusedCountry),r=ss(g=>g.main.focusedState),o=ss(g=>g.main.menuWidthPx);let h;return r?h=ft.jsx(sk,{}):e?h=ft.jsx(VI,{}):h=ft.jsx(nk,{}),ft.jsxs(B4,{style:{width:`${o}px`},children:[ft.jsx(XI,{}),ft.jsxs("div",{className:Wh.header,children:[ft.jsx("div",{className:Wh.headerAccent}),ft.jsxs("div",{className:Wh.headerTexts,children:[ft.jsx("h1",{className:Wh.headerText,children:"Global Voice Datasets Repository Map"}),ft.jsx("h3",{className:Wh.subheaderText,children:"Accessibility, Licensing, and Research Ethics"})]}),ft.jsx("div",{className:Wh.headerAccent})]}),ft.jsx("div",{className:Wh.content,children:h})]})},{min:hk,max:dk}=Math,nd=(e,r=0,o=1)=>hk(dk(r,e),o),mw=e=>{e._clipped=!1,e._unclipped=e.slice(0);for(let r=0;r<=3;r++)r<3?((e[r]<0||e[r]>255)&&(e._clipped=!0),e[r]=nd(e[r],0,255)):r===3&&(e[r]=nd(e[r],0,1));return e},E5={};for(let e of["Boolean","Number","String","Function","Array","Date","RegExp","Undefined","Null"])E5[`[object ${e}]`]=e.toLowerCase();function Dn(e){return E5[Object.prototype.toString.call(e)]||"object"}const xn=(e,r=null)=>e.length>=3?Array.prototype.slice.call(e):Dn(e[0])=="object"&&r?r.split("").filter(o=>e[0][o]!==void 0).map(o=>e[0][o]):e[0].slice(0),Yf=e=>{if(e.length<2)return null;const r=e.length-1;return Dn(e[r])=="string"?e[r].toLowerCase():null},{PI:iy,min:C5,max:I5}=Math,ua=e=>Math.round(e*100)/100,dx=e=>Math.round(e*100)/100,Cu=iy*2,Q1=iy/3,fk=iy/180,pk=180/iy;function k5(e){return[...e.slice(0,3).reverse(),...e.slice(3)]}const vn={format:{},autodetect:[]};class ut{constructor(...r){const o=this;if(Dn(r[0])==="object"&&r[0].constructor&&r[0].constructor===this.constructor)return r[0];let h=Yf(r),g=!1;if(!h){g=!0,vn.sorted||(vn.autodetect=vn.autodetect.sort((b,w)=>w.p-b.p),vn.sorted=!0);for(let b of vn.autodetect)if(h=b.test(...r),h)break}if(vn.format[h]){const b=vn.format[h].apply(null,g?r:r.slice(0,-1));o._rgb=mw(b)}else throw new Error("unknown format: "+r);o._rgb.length===3&&o._rgb.push(1)}toString(){return Dn(this.hex)=="function"?this.hex():`[${this._rgb.join(",")}]`}}const mk="3.1.2",Bn=(...e)=>new ut(...e);Bn.version=mk;const qf={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",laserlemon:"#ffff54",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrod:"#fafad2",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",maroon2:"#7f0000",maroon3:"#b03060",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",purple2:"#7f007f",purple3:"#a020f0",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"},gk=/^#?([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$/,_k=/^#?([A-Fa-f0-9]{8}|[A-Fa-f0-9]{4})$/,P5=e=>{if(e.match(gk)){(e.length===4||e.length===7)&&(e=e.substr(1)),e.length===3&&(e=e.split(""),e=e[0]+e[0]+e[1]+e[1]+e[2]+e[2]);const r=parseInt(e,16),o=r>>16,h=r>>8&255,g=r&255;return[o,h,g,1]}if(e.match(_k)){(e.length===5||e.length===9)&&(e=e.substr(1)),e.length===4&&(e=e.split(""),e=e[0]+e[0]+e[1]+e[1]+e[2]+e[2]+e[3]+e[3]);const r=parseInt(e,16),o=r>>24&255,h=r>>16&255,g=r>>8&255,b=Math.round((r&255)/255*100)/100;return[o,h,g,b]}throw new Error(`unknown hex color: ${e}`)},{round:R_}=Math,A5=(...e)=>{let[r,o,h,g]=xn(e,"rgba"),b=Yf(e)||"auto";g===void 0&&(g=1),b==="auto"&&(b=g<1?"rgba":"rgb"),r=R_(r),o=R_(o),h=R_(h);let c="000000"+(r<<16|o<<8|h).toString(16);c=c.substr(c.length-6);let D="0"+R_(g*255).toString(16);switch(D=D.substr(D.length-2),b.toLowerCase()){case"rgba":return`#${c}${D}`;case"argb":return`#${D}${c}`;default:return`#${c}`}};ut.prototype.name=function(){const e=A5(this._rgb,"rgb");for(let r of Object.keys(qf))if(qf[r]===e)return r.toLowerCase();return e};vn.format.named=e=>{if(e=e.toLowerCase(),qf[e])return P5(qf[e]);throw new Error("unknown color name: "+e)};vn.autodetect.push({p:5,test:(e,...r)=>{if(!r.length&&Dn(e)==="string"&&qf[e.toLowerCase()])return"named"}});ut.prototype.alpha=function(e,r=!1){return e!==void 0&&Dn(e)==="number"?r?(this._rgb[3]=e,this):new ut([this._rgb[0],this._rgb[1],this._rgb[2],e],"rgb"):this._rgb[3]};ut.prototype.clipped=function(){return this._rgb._clipped||!1};const Ul={Kn:18,labWhitePoint:"d65",Xn:.95047,Yn:1,Zn:1.08883,t0:.137931034,t1:.206896552,t2:.12841855,t3:.008856452,kE:216/24389,kKE:8,kK:24389/27,RefWhiteRGB:{X:.95047,Y:1,Z:1.08883},MtxRGB2XYZ:{m00:.4124564390896922,m01:.21267285140562253,m02:.0193338955823293,m10:.357576077643909,m11:.715152155287818,m12:.11919202588130297,m20:.18043748326639894,m21:.07217499330655958,m22:.9503040785363679},MtxXYZ2RGB:{m00:3.2404541621141045,m01:-.9692660305051868,m02:.055643430959114726,m10:-1.5371385127977166,m11:1.8760108454466942,m12:-.2040259135167538,m20:-.498531409556016,m21:.041556017530349834,m22:1.0572251882231791},As:.9414285350000001,Bs:1.040417467,Cs:1.089532651,MtxAdaptMa:{m00:.8951,m01:-.7502,m02:.0389,m10:.2664,m11:1.7135,m12:-.0685,m20:-.1614,m21:.0367,m22:1.0296},MtxAdaptMaI:{m00:.9869929054667123,m01:.43230526972339456,m02:-.008528664575177328,m10:-.14705425642099013,m11:.5183602715367776,m12:.04004282165408487,m20:.15996265166373125,m21:.0492912282128556,m22:.9684866957875502}},yk=new Map([["a",[1.0985,.35585]],["b",[1.0985,.35585]],["c",[.98074,1.18232]],["d50",[.96422,.82521]],["d55",[.95682,.92149]],["d65",[.95047,1.08883]],["e",[1,1,1]],["f2",[.99186,.67393]],["f7",[.95041,1.08747]],["f11",[1.00962,.6435]],["icc",[.96422,.82521]]]);function Pu(e){const r=yk.get(String(e).toLowerCase());if(!r)throw new Error("unknown Lab illuminant "+e);Ul.labWhitePoint=e,Ul.Xn=r[0],Ul.Zn=r[1]}function Zm(){return Ul.labWhitePoint}const gw=(...e)=>{e=xn(e,"lab");const[r,o,h]=e,[g,b,w]=vk(r,o,h),[c,D,j]=M5(g,b,w);return[c,D,j,e.length>3?e[3]:1]},vk=(e,r,o)=>{const{kE:h,kK:g,kKE:b,Xn:w,Yn:c,Zn:D}=Ul,j=(e+16)/116,J=.002*r+j,G=j-.005*o,q=J*J*J,Ee=G*G*G,Ae=q>h?q:(116*J-16)/g,Fe=e>b?Math.pow((e+16)/116,3):e/g,Ne=Ee>h?Ee:(116*G-16)/g,se=Ae*w,ue=Fe*c,he=Ne*D;return[se,ue,he]},ev=e=>{const r=Math.sign(e);return e=Math.abs(e),(e<=.0031308?e*12.92:1.055*Math.pow(e,1/2.4)-.055)*r},M5=(e,r,o)=>{const{MtxAdaptMa:h,MtxAdaptMaI:g,MtxXYZ2RGB:b,RefWhiteRGB:w,Xn:c,Yn:D,Zn:j}=Ul,J=c*h.m00+D*h.m10+j*h.m20,G=c*h.m01+D*h.m11+j*h.m21,q=c*h.m02+D*h.m12+j*h.m22,Ee=w.X*h.m00+w.Y*h.m10+w.Z*h.m20,Ae=w.X*h.m01+w.Y*h.m11+w.Z*h.m21,Fe=w.X*h.m02+w.Y*h.m12+w.Z*h.m22,Ne=(e*h.m00+r*h.m10+o*h.m20)*(Ee/J),se=(e*h.m01+r*h.m11+o*h.m21)*(Ae/G),ue=(e*h.m02+r*h.m12+o*h.m22)*(Fe/q),he=Ne*g.m00+se*g.m10+ue*g.m20,De=Ne*g.m01+se*g.m11+ue*g.m21,Ze=Ne*g.m02+se*g.m12+ue*g.m22,je=ev(he*b.m00+De*b.m10+Ze*b.m20),ve=ev(he*b.m01+De*b.m11+Ze*b.m21),ee=ev(he*b.m02+De*b.m12+Ze*b.m22);return[je*255,ve*255,ee*255]},_w=(...e)=>{const[r,o,h,...g]=xn(e,"rgb"),[b,w,c]=z5(r,o,h),[D,j,J]=xk(b,w,c);return[D,j,J,...g.length>0&&g[0]<1?[g[0]]:[]]};function xk(e,r,o){const{Xn:h,Yn:g,Zn:b,kE:w,kK:c}=Ul,D=e/h,j=r/g,J=o/b,G=D>w?Math.pow(D,1/3):(c*D+16)/116,q=j>w?Math.pow(j,1/3):(c*j+16)/116,Ee=J>w?Math.pow(J,1/3):(c*J+16)/116;return[116*q-16,500*(G-q),200*(q-Ee)]}function tv(e){const r=Math.sign(e);return e=Math.abs(e),(e<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4))*r}const z5=(e,r,o)=>{e=tv(e/255),r=tv(r/255),o=tv(o/255);const{MtxRGB2XYZ:h,MtxAdaptMa:g,MtxAdaptMaI:b,Xn:w,Yn:c,Zn:D,As:j,Bs:J,Cs:G}=Ul;let q=e*h.m00+r*h.m10+o*h.m20,Ee=e*h.m01+r*h.m11+o*h.m21,Ae=e*h.m02+r*h.m12+o*h.m22;const Fe=w*g.m00+c*g.m10+D*g.m20,Ne=w*g.m01+c*g.m11+D*g.m21,se=w*g.m02+c*g.m12+D*g.m22;let ue=q*g.m00+Ee*g.m10+Ae*g.m20,he=q*g.m01+Ee*g.m11+Ae*g.m21,De=q*g.m02+Ee*g.m12+Ae*g.m22;return ue*=Fe/j,he*=Ne/J,De*=se/G,q=ue*b.m00+he*b.m10+De*b.m20,Ee=ue*b.m01+he*b.m11+De*b.m21,Ae=ue*b.m02+he*b.m12+De*b.m22,[q,Ee,Ae]};ut.prototype.lab=function(){return _w(this._rgb)};const wk=(...e)=>new ut(...e,"lab");Object.assign(Bn,{lab:wk,getLabWhitePoint:Zm,setLabWhitePoint:Pu});vn.format.lab=gw;vn.autodetect.push({p:2,test:(...e)=>{if(e=xn(e,"lab"),Dn(e)==="array"&&e.length===3)return"lab"}});ut.prototype.darken=function(e=1){const r=this,o=r.lab();return o[0]-=Ul.Kn*e,new ut(o,"lab").alpha(r.alpha(),!0)};ut.prototype.brighten=function(e=1){return this.darken(-e)};ut.prototype.darker=ut.prototype.darken;ut.prototype.brighter=ut.prototype.brighten;ut.prototype.get=function(e){const[r,o]=e.split("."),h=this[r]();if(o){const g=r.indexOf(o)-(r.substr(0,2)==="ok"?2:0);if(g>-1)return h[g];throw new Error(`unknown channel ${o} in mode ${r}`)}else return h};const{pow:bk}=Math,Sk=1e-7,Tk=20;ut.prototype.luminance=function(e,r="rgb"){if(e!==void 0&&Dn(e)==="number"){if(e===0)return new ut([0,0,0,this._rgb[3]],"rgb");if(e===1)return new ut([255,255,255,this._rgb[3]],"rgb");let o=this.luminance(),h=Tk;const g=(w,c)=>{const D=w.interpolate(c,.5,r),j=D.luminance();return Math.abs(e-j)<Sk||!h--?D:j>e?g(w,D):g(D,c)},b=(o>e?g(new ut([0,0,0]),this):g(this,new ut([255,255,255]))).rgb();return new ut([...b,this._rgb[3]])}return Ek(...this._rgb.slice(0,3))};const Ek=(e,r,o)=>(e=nv(e),r=nv(r),o=nv(o),.2126*e+.7152*r+.0722*o),nv=e=>(e/=255,e<=.03928?e/12.92:bk((e+.055)/1.055,2.4)),Ms={},Zf=(e,r,o=.5,...h)=>{let g=h[0]||"lrgb";if(!Ms[g]&&!h.length&&(g=Object.keys(Ms)[0]),!Ms[g])throw new Error(`interpolation mode ${g} is not defined`);return Dn(e)!=="object"&&(e=new ut(e)),Dn(r)!=="object"&&(r=new ut(r)),Ms[g](e,r,o).alpha(e.alpha()+o*(r.alpha()-e.alpha()))};ut.prototype.mix=ut.prototype.interpolate=function(e,r=.5,...o){return Zf(this,e,r,...o)};ut.prototype.premultiply=function(e=!1){const r=this._rgb,o=r[3];return e?(this._rgb=[r[0]*o,r[1]*o,r[2]*o,o],this):new ut([r[0]*o,r[1]*o,r[2]*o,o],"rgb")};const{sin:Ck,cos:Ik}=Math,D5=(...e)=>{let[r,o,h]=xn(e,"lch");return isNaN(h)&&(h=0),h=h*fk,[r,Ik(h)*o,Ck(h)*o]},yw=(...e)=>{e=xn(e,"lch");const[r,o,h]=e,[g,b,w]=D5(r,o,h),[c,D,j]=gw(g,b,w);return[c,D,j,e.length>3?e[3]:1]},kk=(...e)=>{const r=k5(xn(e,"hcl"));return yw(...r)},{sqrt:Pk,atan2:Ak,round:Mk}=Math,L5=(...e)=>{const[r,o,h]=xn(e,"lab"),g=Pk(o*o+h*h);let b=(Ak(h,o)*pk+360)%360;return Mk(g*1e4)===0&&(b=Number.NaN),[r,g,b]},vw=(...e)=>{const[r,o,h,...g]=xn(e,"rgb"),[b,w,c]=_w(r,o,h),[D,j,J]=L5(b,w,c);return[D,j,J,...g.length>0&&g[0]<1?[g[0]]:[]]};ut.prototype.lch=function(){return vw(this._rgb)};ut.prototype.hcl=function(){return k5(vw(this._rgb))};const zk=(...e)=>new ut(...e,"lch"),Dk=(...e)=>new ut(...e,"hcl");Object.assign(Bn,{lch:zk,hcl:Dk});vn.format.lch=yw;vn.format.hcl=kk;["lch","hcl"].forEach(e=>vn.autodetect.push({p:2,test:(...r)=>{if(r=xn(r,e),Dn(r)==="array"&&r.length===3)return e}}));ut.prototype.saturate=function(e=1){const r=this,o=r.lch();return o[1]+=Ul.Kn*e,o[1]<0&&(o[1]=0),new ut(o,"lch").alpha(r.alpha(),!0)};ut.prototype.desaturate=function(e=1){return this.saturate(-e)};ut.prototype.set=function(e,r,o=!1){const[h,g]=e.split("."),b=this[h]();if(g){const w=h.indexOf(g)-(h.substr(0,2)==="ok"?2:0);if(w>-1){if(Dn(r)=="string")switch(r.charAt(0)){case"+":b[w]+=+r;break;case"-":b[w]+=+r;break;case"*":b[w]*=+r.substr(1);break;case"/":b[w]/=+r.substr(1);break;default:b[w]=+r}else if(Dn(r)==="number")b[w]=r;else throw new Error("unsupported value for Color.set");const c=new ut(b,h);return o?(this._rgb=c._rgb,this):c}throw new Error(`unknown channel ${g} in mode ${h}`)}else return b};ut.prototype.tint=function(e=.5,...r){return Zf(this,"white",e,...r)};ut.prototype.shade=function(e=.5,...r){return Zf(this,"black",e,...r)};const Lk=(e,r,o)=>{const h=e._rgb,g=r._rgb;return new ut(h[0]+o*(g[0]-h[0]),h[1]+o*(g[1]-h[1]),h[2]+o*(g[2]-h[2]),"rgb")};Ms.rgb=Lk;const{sqrt:rv,pow:pf}=Math,Rk=(e,r,o)=>{const[h,g,b]=e._rgb,[w,c,D]=r._rgb;return new ut(rv(pf(h,2)*(1-o)+pf(w,2)*o),rv(pf(g,2)*(1-o)+pf(c,2)*o),rv(pf(b,2)*(1-o)+pf(D,2)*o),"rgb")};Ms.lrgb=Rk;const Ok=(e,r,o)=>{const h=e.lab(),g=r.lab();return new ut(h[0]+o*(g[0]-h[0]),h[1]+o*(g[1]-h[1]),h[2]+o*(g[2]-h[2]),"lab")};Ms.lab=Ok;const Jf=(e,r,o,h)=>{let g,b;h==="hsl"?(g=e.hsl(),b=r.hsl()):h==="hsv"?(g=e.hsv(),b=r.hsv()):h==="hcg"?(g=e.hcg(),b=r.hcg()):h==="hsi"?(g=e.hsi(),b=r.hsi()):h==="lch"||h==="hcl"?(h="hcl",g=e.hcl(),b=r.hcl()):h==="oklch"&&(g=e.oklch().reverse(),b=r.oklch().reverse());let w,c,D,j,J,G;(h.substr(0,1)==="h"||h==="oklch")&&([w,D,J]=g,[c,j,G]=b);let q,Ee,Ae,Fe;return!isNaN(w)&&!isNaN(c)?(c>w&&c-w>180?Fe=c-(w+360):c<w&&w-c>180?Fe=c+360-w:Fe=c-w,Ee=w+o*Fe):isNaN(w)?isNaN(c)?Ee=Number.NaN:(Ee=c,(J==1||J==0)&&h!="hsv"&&(q=j)):(Ee=w,(G==1||G==0)&&h!="hsv"&&(q=D)),q===void 0&&(q=D+o*(j-D)),Ae=J+o*(G-J),h==="oklch"?new ut([Ae,q,Ee],h):new ut([Ee,q,Ae],h)},R5=(e,r,o)=>Jf(e,r,o,"lch");Ms.lch=R5;Ms.hcl=R5;const Fk=e=>{if(Dn(e)=="number"&&e>=0&&e<=16777215){const r=e>>16,o=e>>8&255,h=e&255;return[r,o,h,1]}throw new Error("unknown num color: "+e)},Bk=(...e)=>{const[r,o,h]=xn(e,"rgb");return(r<<16)+(o<<8)+h};ut.prototype.num=function(){return Bk(this._rgb)};const Nk=(...e)=>new ut(...e,"num");Object.assign(Bn,{num:Nk});vn.format.num=Fk;vn.autodetect.push({p:5,test:(...e)=>{if(e.length===1&&Dn(e[0])==="number"&&e[0]>=0&&e[0]<=16777215)return"num"}});const Uk=(e,r,o)=>{const h=e.num(),g=r.num();return new ut(h+o*(g-h),"num")};Ms.num=Uk;const{floor:jk}=Math,$k=(...e)=>{e=xn(e,"hcg");let[r,o,h]=e,g,b,w;h=h*255;const c=o*255;if(o===0)g=b=w=h;else{r===360&&(r=0),r>360&&(r-=360),r<0&&(r+=360),r/=60;const D=jk(r),j=r-D,J=h*(1-o),G=J+c*(1-j),q=J+c*j,Ee=J+c;switch(D){case 0:[g,b,w]=[Ee,q,J];break;case 1:[g,b,w]=[G,Ee,J];break;case 2:[g,b,w]=[J,Ee,q];break;case 3:[g,b,w]=[J,G,Ee];break;case 4:[g,b,w]=[q,J,Ee];break;case 5:[g,b,w]=[Ee,J,G];break}}return[g,b,w,e.length>3?e[3]:1]},Vk=(...e)=>{const[r,o,h]=xn(e,"rgb"),g=C5(r,o,h),b=I5(r,o,h),w=b-g,c=w*100/255,D=g/(255-w)*100;let j;return w===0?j=Number.NaN:(r===b&&(j=(o-h)/w),o===b&&(j=2+(h-r)/w),h===b&&(j=4+(r-o)/w),j*=60,j<0&&(j+=360)),[j,c,D]};ut.prototype.hcg=function(){return Vk(this._rgb)};const qk=(...e)=>new ut(...e,"hcg");Bn.hcg=qk;vn.format.hcg=$k;vn.autodetect.push({p:1,test:(...e)=>{if(e=xn(e,"hcg"),Dn(e)==="array"&&e.length===3)return"hcg"}});const Zk=(e,r,o)=>Jf(e,r,o,"hcg");Ms.hcg=Zk;const{cos:mf}=Math,Wk=(...e)=>{e=xn(e,"hsi");let[r,o,h]=e,g,b,w;return isNaN(r)&&(r=0),isNaN(o)&&(o=0),r>360&&(r-=360),r<0&&(r+=360),r/=360,r<1/3?(w=(1-o)/3,g=(1+o*mf(Cu*r)/mf(Q1-Cu*r))/3,b=1-(w+g)):r<2/3?(r-=1/3,g=(1-o)/3,b=(1+o*mf(Cu*r)/mf(Q1-Cu*r))/3,w=1-(g+b)):(r-=2/3,b=(1-o)/3,w=(1+o*mf(Cu*r)/mf(Q1-Cu*r))/3,g=1-(b+w)),g=nd(h*g*3),b=nd(h*b*3),w=nd(h*w*3),[g*255,b*255,w*255,e.length>3?e[3]:1]},{min:Gk,sqrt:Hk,acos:Xk}=Math,Kk=(...e)=>{let[r,o,h]=xn(e,"rgb");r/=255,o/=255,h/=255;let g;const b=Gk(r,o,h),w=(r+o+h)/3,c=w>0?1-b/w:0;return c===0?g=NaN:(g=(r-o+(r-h))/2,g/=Hk((r-o)*(r-o)+(r-h)*(o-h)),g=Xk(g),h>o&&(g=Cu-g),g/=Cu),[g*360,c,w]};ut.prototype.hsi=function(){return Kk(this._rgb)};const Yk=(...e)=>new ut(...e,"hsi");Bn.hsi=Yk;vn.format.hsi=Wk;vn.autodetect.push({p:2,test:(...e)=>{if(e=xn(e,"hsi"),Dn(e)==="array"&&e.length===3)return"hsi"}});const Jk=(e,r,o)=>Jf(e,r,o,"hsi");Ms.hsi=Jk;const fx=(...e)=>{e=xn(e,"hsl");const[r,o,h]=e;let g,b,w;if(o===0)g=b=w=h*255;else{const c=[0,0,0],D=[0,0,0],j=h<.5?h*(1+o):h+o-h*o,J=2*h-j,G=r/360;c[0]=G+1/3,c[1]=G,c[2]=G-1/3;for(let q=0;q<3;q++)c[q]<0&&(c[q]+=1),c[q]>1&&(c[q]-=1),6*c[q]<1?D[q]=J+(j-J)*6*c[q]:2*c[q]<1?D[q]=j:3*c[q]<2?D[q]=J+(j-J)*(2/3-c[q])*6:D[q]=J;[g,b,w]=[D[0]*255,D[1]*255,D[2]*255]}return e.length>3?[g,b,w,e[3]]:[g,b,w,1]},O5=(...e)=>{e=xn(e,"rgba");let[r,o,h]=e;r/=255,o/=255,h/=255;const g=C5(r,o,h),b=I5(r,o,h),w=(b+g)/2;let c,D;return b===g?(c=0,D=Number.NaN):c=w<.5?(b-g)/(b+g):(b-g)/(2-b-g),r==b?D=(o-h)/(b-g):o==b?D=2+(h-r)/(b-g):h==b&&(D=4+(r-o)/(b-g)),D*=60,D<0&&(D+=360),e.length>3&&e[3]!==void 0?[D,c,w,e[3]]:[D,c,w]};ut.prototype.hsl=function(){return O5(this._rgb)};const Qk=(...e)=>new ut(...e,"hsl");Bn.hsl=Qk;vn.format.hsl=fx;vn.autodetect.push({p:2,test:(...e)=>{if(e=xn(e,"hsl"),Dn(e)==="array"&&e.length===3)return"hsl"}});const eP=(e,r,o)=>Jf(e,r,o,"hsl");Ms.hsl=eP;const{floor:tP}=Math,nP=(...e)=>{e=xn(e,"hsv");let[r,o,h]=e,g,b,w;if(h*=255,o===0)g=b=w=h;else{r===360&&(r=0),r>360&&(r-=360),r<0&&(r+=360),r/=60;const c=tP(r),D=r-c,j=h*(1-o),J=h*(1-o*D),G=h*(1-o*(1-D));switch(c){case 0:[g,b,w]=[h,G,j];break;case 1:[g,b,w]=[J,h,j];break;case 2:[g,b,w]=[j,h,G];break;case 3:[g,b,w]=[j,J,h];break;case 4:[g,b,w]=[G,j,h];break;case 5:[g,b,w]=[h,j,J];break}}return[g,b,w,e.length>3?e[3]:1]},{min:rP,max:iP}=Math,sP=(...e)=>{e=xn(e,"rgb");let[r,o,h]=e;const g=rP(r,o,h),b=iP(r,o,h),w=b-g;let c,D,j;return j=b/255,b===0?(c=Number.NaN,D=0):(D=w/b,r===b&&(c=(o-h)/w),o===b&&(c=2+(h-r)/w),h===b&&(c=4+(r-o)/w),c*=60,c<0&&(c+=360)),[c,D,j]};ut.prototype.hsv=function(){return sP(this._rgb)};const oP=(...e)=>new ut(...e,"hsv");Bn.hsv=oP;vn.format.hsv=nP;vn.autodetect.push({p:2,test:(...e)=>{if(e=xn(e,"hsv"),Dn(e)==="array"&&e.length===3)return"hsv"}});const aP=(e,r,o)=>Jf(e,r,o,"hsv");Ms.hsv=aP;function z0(e,r){let o=e.length;Array.isArray(e[0])||(e=[e]),Array.isArray(r[0])||(r=r.map(w=>[w]));let h=r[0].length,g=r[0].map((w,c)=>r.map(D=>D[c])),b=e.map(w=>g.map(c=>Array.isArray(w)?w.reduce((D,j,J)=>D+j*(c[J]||0),0):c.reduce((D,j)=>D+j*w,0)));return o===1&&(b=b[0]),h===1?b.map(w=>w[0]):b}const xw=(...e)=>{e=xn(e,"lab");const[r,o,h,...g]=e,[b,w,c]=lP([r,o,h]),[D,j,J]=M5(b,w,c);return[D,j,J,...g.length>0&&g[0]<1?[g[0]]:[]]};function lP(e){var r=[[1.2268798758459243,-.5578149944602171,.2813910456659647],[-.0405757452148008,1.112286803280317,-.0717110580655164],[-.0763729366746601,-.4214933324022432,1.5869240198367816]],o=[[1,.3963377773761749,.2158037573099136],[1,-.1055613458156586,-.0638541728258133],[1,-.0894841775298119,-1.2914855480194092]],h=z0(o,e);return z0(r,h.map(g=>g**3))}const ww=(...e)=>{const[r,o,h,...g]=xn(e,"rgb"),b=z5(r,o,h);return[...uP(b),...g.length>0&&g[0]<1?[g[0]]:[]]};function uP(e){const r=[[.819022437996703,.3619062600528904,-.1288737815209879],[.0329836539323885,.9292868615863434,.0361446663506424],[.0481771893596242,.2642395317527308,.6335478284694309]],o=[[.210454268309314,.7936177747023054,-.0040720430116193],[1.9779985324311684,-2.42859224204858,.450593709617411],[.0259040424655478,.7827717124575296,-.8086757549230774]],h=z0(r,e);return z0(o,h.map(g=>Math.cbrt(g)))}ut.prototype.oklab=function(){return ww(this._rgb)};const cP=(...e)=>new ut(...e,"oklab");Object.assign(Bn,{oklab:cP});vn.format.oklab=xw;vn.autodetect.push({p:2,test:(...e)=>{if(e=xn(e,"oklab"),Dn(e)==="array"&&e.length===3)return"oklab"}});const hP=(e,r,o)=>{const h=e.oklab(),g=r.oklab();return new ut(h[0]+o*(g[0]-h[0]),h[1]+o*(g[1]-h[1]),h[2]+o*(g[2]-h[2]),"oklab")};Ms.oklab=hP;const dP=(e,r,o)=>Jf(e,r,o,"oklch");Ms.oklch=dP;const{pow:iv,sqrt:sv,PI:ov,cos:n2,sin:r2,atan2:fP}=Math,pP=(e,r="lrgb",o=null)=>{const h=e.length;o||(o=Array.from(new Array(h)).map(()=>1));const g=h/o.reduce(function(G,q){return G+q});if(o.forEach((G,q)=>{o[q]*=g}),e=e.map(G=>new ut(G)),r==="lrgb")return mP(e,o);const b=e.shift(),w=b.get(r),c=[];let D=0,j=0;for(let G=0;G<w.length;G++)if(w[G]=(w[G]||0)*o[0],c.push(isNaN(w[G])?0:o[0]),r.charAt(G)==="h"&&!isNaN(w[G])){const q=w[G]/180*ov;D+=n2(q)*o[0],j+=r2(q)*o[0]}let J=b.alpha()*o[0];e.forEach((G,q)=>{const Ee=G.get(r);J+=G.alpha()*o[q+1];for(let Ae=0;Ae<w.length;Ae++)if(!isNaN(Ee[Ae]))if(c[Ae]+=o[q+1],r.charAt(Ae)==="h"){const Fe=Ee[Ae]/180*ov;D+=n2(Fe)*o[q+1],j+=r2(Fe)*o[q+1]}else w[Ae]+=Ee[Ae]*o[q+1]});for(let G=0;G<w.length;G++)if(r.charAt(G)==="h"){let q=fP(j/c[G],D/c[G])/ov*180;for(;q<0;)q+=360;for(;q>=360;)q-=360;w[G]=q}else w[G]=w[G]/c[G];return J/=h,new ut(w,r).alpha(J>.99999?1:J,!0)},mP=(e,r)=>{const o=e.length,h=[0,0,0,0];for(let g=0;g<e.length;g++){const b=e[g],w=r[g]/o,c=b._rgb;h[0]+=iv(c[0],2)*w,h[1]+=iv(c[1],2)*w,h[2]+=iv(c[2],2)*w,h[3]+=c[3]*w}return h[0]=sv(h[0]),h[1]=sv(h[1]),h[2]=sv(h[2]),h[3]>.9999999&&(h[3]=1),new ut(mw(h))},{pow:gP}=Math;function D0(e){let r="rgb",o=Bn("#ccc"),h=0,g=[0,1],b=[],w=[0,0],c=!1,D=[],j=!1,J=0,G=1,q=!1,Ee={},Ae=!0,Fe=1;const Ne=function(ve){if(ve=ve||["#fff","#000"],ve&&Dn(ve)==="string"&&Bn.brewer&&Bn.brewer[ve.toLowerCase()]&&(ve=Bn.brewer[ve.toLowerCase()]),Dn(ve)==="array"){ve.length===1&&(ve=[ve[0],ve[0]]),ve=ve.slice(0);for(let ee=0;ee<ve.length;ee++)ve[ee]=Bn(ve[ee]);b.length=0;for(let ee=0;ee<ve.length;ee++)b.push(ee/(ve.length-1))}return Ze(),D=ve},se=function(ve){if(c!=null){const ee=c.length-1;let de=0;for(;de<ee&&ve>=c[de];)de++;return de-1}return 0};let ue=ve=>ve,he=ve=>ve;const De=function(ve,ee){let de,Te;if(ee==null&&(ee=!1),isNaN(ve)||ve===null)return o;ee?Te=ve:c&&c.length>2?Te=se(ve)/(c.length-2):G!==J?Te=(ve-J)/(G-J):Te=1,Te=he(Te),ee||(Te=ue(Te)),Fe!==1&&(Te=gP(Te,Fe)),Te=w[0]+Te*(1-w[0]-w[1]),Te=nd(Te,0,1);const Ue=Math.floor(Te*1e4);if(Ae&&Ee[Ue])de=Ee[Ue];else{if(Dn(D)==="array")for(let Xe=0;Xe<b.length;Xe++){const mt=b[Xe];if(Te<=mt){de=D[Xe];break}if(Te>=mt&&Xe===b.length-1){de=D[Xe];break}if(Te>mt&&Te<b[Xe+1]){Te=(Te-mt)/(b[Xe+1]-mt),de=Bn.interpolate(D[Xe],D[Xe+1],Te,r);break}}else Dn(D)==="function"&&(de=D(Te));Ae&&(Ee[Ue]=de)}return de};var Ze=()=>Ee={};Ne(e);const je=function(ve){const ee=Bn(De(ve));return j&&ee[j]?ee[j]():ee};return je.classes=function(ve){if(ve!=null){if(Dn(ve)==="array")c=ve,g=[ve[0],ve[ve.length-1]];else{const ee=Bn.analyze(g);ve===0?c=[ee.min,ee.max]:c=Bn.limits(ee,"e",ve)}return je}return c},je.domain=function(ve){if(!arguments.length)return g;J=ve[0],G=ve[ve.length-1],b=[];const ee=D.length;if(ve.length===ee&&J!==G)for(let de of Array.from(ve))b.push((de-J)/(G-J));else{for(let de=0;de<ee;de++)b.push(de/(ee-1));if(ve.length>2){const de=ve.map((Ue,Xe)=>Xe/(ve.length-1)),Te=ve.map(Ue=>(Ue-J)/(G-J));Te.every((Ue,Xe)=>de[Xe]===Ue)||(he=Ue=>{if(Ue<=0||Ue>=1)return Ue;let Xe=0;for(;Ue>=Te[Xe+1];)Xe++;const mt=(Ue-Te[Xe])/(Te[Xe+1]-Te[Xe]);return de[Xe]+mt*(de[Xe+1]-de[Xe])})}}return g=[J,G],je},je.mode=function(ve){return arguments.length?(r=ve,Ze(),je):r},je.range=function(ve,ee){return Ne(ve),je},je.out=function(ve){return j=ve,je},je.spread=function(ve){return arguments.length?(h=ve,je):h},je.correctLightness=function(ve){return ve==null&&(ve=!0),q=ve,Ze(),q?ue=function(ee){const de=De(0,!0).lab()[0],Te=De(1,!0).lab()[0],Ue=de>Te;let Xe=De(ee,!0).lab()[0];const mt=de+(Te-de)*ee;let Kt=Xe-mt,qn=0,Qn=1,zt=20;for(;Math.abs(Kt)>.01&&zt-- >0;)(function(){return Ue&&(Kt*=-1),Kt<0?(qn=ee,ee+=(Qn-ee)*.5):(Qn=ee,ee+=(qn-ee)*.5),Xe=De(ee,!0).lab()[0],Kt=Xe-mt})();return ee}:ue=ee=>ee,je},je.padding=function(ve){return ve!=null?(Dn(ve)==="number"&&(ve=[ve,ve]),w=ve,je):w},je.colors=function(ve,ee){arguments.length<2&&(ee="hex");let de=[];if(arguments.length===0)de=D.slice(0);else if(ve===1)de=[je(.5)];else if(ve>1){const Te=g[0],Ue=g[1]-Te;de=_P(0,ve).map(Xe=>je(Te+Xe/(ve-1)*Ue))}else{e=[];let Te=[];if(c&&c.length>2)for(let Ue=1,Xe=c.length,mt=1<=Xe;mt?Ue<Xe:Ue>Xe;mt?Ue++:Ue--)Te.push((c[Ue-1]+c[Ue])*.5);else Te=g;de=Te.map(Ue=>je(Ue))}return Bn[ee]&&(de=de.map(Te=>Te[ee]())),de},je.cache=function(ve){return ve!=null?(Ae=ve,je):Ae},je.gamma=function(ve){return ve!=null?(Fe=ve,je):Fe},je.nodata=function(ve){return ve!=null?(o=Bn(ve),je):o},je}function _P(e,r,o){let h=[],g=e<r,b=r;for(let w=e;g?w<b:w>b;g?w++:w--)h.push(w);return h}const yP=function(e){let r=[1,1];for(let o=1;o<e;o++){let h=[1];for(let g=1;g<=r.length;g++)h[g]=(r[g]||0)+r[g-1];r=h}return r},vP=function(e){let r,o,h,g;if(e=e.map(b=>new ut(b)),e.length===2)[o,h]=e.map(b=>b.lab()),r=function(b){const w=[0,1,2].map(c=>o[c]+b*(h[c]-o[c]));return new ut(w,"lab")};else if(e.length===3)[o,h,g]=e.map(b=>b.lab()),r=function(b){const w=[0,1,2].map(c=>(1-b)*(1-b)*o[c]+2*(1-b)*b*h[c]+b*b*g[c]);return new ut(w,"lab")};else if(e.length===4){let b;[o,h,g,b]=e.map(w=>w.lab()),r=function(w){const c=[0,1,2].map(D=>(1-w)*(1-w)*(1-w)*o[D]+3*(1-w)*(1-w)*w*h[D]+3*(1-w)*w*w*g[D]+w*w*w*b[D]);return new ut(c,"lab")}}else if(e.length>=5){let b,w,c;b=e.map(D=>D.lab()),c=e.length-1,w=yP(c),r=function(D){const j=1-D,J=[0,1,2].map(G=>b.reduce((q,Ee,Ae)=>q+w[Ae]*j**(c-Ae)*D**Ae*Ee[G],0));return new ut(J,"lab")}}else throw new RangeError("No point in running bezier with only one color.");return r},xP=e=>{const r=vP(e);return r.scale=()=>D0(r),r},{round:F5}=Math;ut.prototype.rgb=function(e=!0){return e===!1?this._rgb.slice(0,3):this._rgb.slice(0,3).map(F5)};ut.prototype.rgba=function(e=!0){return this._rgb.slice(0,4).map((r,o)=>o<3?e===!1?r:F5(r):r)};const wP=(...e)=>new ut(...e,"rgb");Object.assign(Bn,{rgb:wP});vn.format.rgb=(...e)=>{const r=xn(e,"rgba");return r[3]===void 0&&(r[3]=1),r};vn.autodetect.push({p:3,test:(...e)=>{if(e=xn(e,"rgba"),Dn(e)==="array"&&(e.length===3||e.length===4&&Dn(e[3])=="number"&&e[3]>=0&&e[3]<=1))return"rgb"}});const Ja=(e,r,o)=>{if(!Ja[o])throw new Error("unknown blend mode "+o);return Ja[o](e,r)},Zc=e=>(r,o)=>{const h=Bn(o).rgb(),g=Bn(r).rgb();return Bn.rgb(e(h,g))},Wc=e=>(r,o)=>{const h=[];return h[0]=e(r[0],o[0]),h[1]=e(r[1],o[1]),h[2]=e(r[2],o[2]),h},bP=e=>e,SP=(e,r)=>e*r/255,TP=(e,r)=>e>r?r:e,EP=(e,r)=>e>r?e:r,CP=(e,r)=>255*(1-(1-e/255)*(1-r/255)),IP=(e,r)=>r<128?2*e*r/255:255*(1-2*(1-e/255)*(1-r/255)),kP=(e,r)=>255*(1-(1-r/255)/(e/255)),PP=(e,r)=>e===255?255:(e=255*(r/255)/(1-e/255),e>255?255:e);Ja.normal=Zc(Wc(bP));Ja.multiply=Zc(Wc(SP));Ja.screen=Zc(Wc(CP));Ja.overlay=Zc(Wc(IP));Ja.darken=Zc(Wc(TP));Ja.lighten=Zc(Wc(EP));Ja.dodge=Zc(Wc(PP));Ja.burn=Zc(Wc(kP));const{pow:AP,sin:MP,cos:zP}=Math;function DP(e=300,r=-1.5,o=1,h=1,g=[0,1]){let b=0,w;Dn(g)==="array"?w=g[1]-g[0]:(w=0,g=[g,g]);const c=function(D){const j=Cu*((e+120)/360+r*D),J=AP(g[0]+w*D,h),q=(b!==0?o[0]+D*b:o)*J*(1-J)/2,Ee=zP(j),Ae=MP(j),Fe=J+q*(-.14861*Ee+1.78277*Ae),Ne=J+q*(-.29227*Ee-.90649*Ae),se=J+q*(1.97294*Ee);return Bn(mw([Fe*255,Ne*255,se*255,1]))};return c.start=function(D){return D==null?e:(e=D,c)},c.rotations=function(D){return D==null?r:(r=D,c)},c.gamma=function(D){return D==null?h:(h=D,c)},c.hue=function(D){return D==null?o:(o=D,Dn(o)==="array"?(b=o[1]-o[0],b===0&&(o=o[1])):b=0,c)},c.lightness=function(D){return D==null?g:(Dn(D)==="array"?(g=D,w=D[1]-D[0]):(g=[D,D],w=0),c)},c.scale=()=>Bn.scale(c),c.hue(o),c}const LP="0123456789abcdef",{floor:RP,random:OP}=Math,FP=()=>{let e="#";for(let r=0;r<6;r++)e+=LP.charAt(RP(OP()*16));return new ut(e,"hex")},{log:i2,pow:BP,floor:NP,abs:UP}=Math;function B5(e,r=null){const o={min:Number.MAX_VALUE,max:Number.MAX_VALUE*-1,sum:0,values:[],count:0};return Dn(e)==="object"&&(e=Object.values(e)),e.forEach(h=>{r&&Dn(h)==="object"&&(h=h[r]),h!=null&&!isNaN(h)&&(o.values.push(h),o.sum+=h,h<o.min&&(o.min=h),h>o.max&&(o.max=h),o.count+=1)}),o.domain=[o.min,o.max],o.limits=(h,g)=>N5(o,h,g),o}function N5(e,r="equal",o=7){Dn(e)=="array"&&(e=B5(e));const{min:h,max:g}=e,b=e.values.sort((c,D)=>c-D);if(o===1)return[h,g];const w=[];if(r.substr(0,1)==="c"&&(w.push(h),w.push(g)),r.substr(0,1)==="e"){w.push(h);for(let c=1;c<o;c++)w.push(h+c/o*(g-h));w.push(g)}else if(r.substr(0,1)==="l"){if(h<=0)throw new Error("Logarithmic scales are only possible for values > 0");const c=Math.LOG10E*i2(h),D=Math.LOG10E*i2(g);w.push(h);for(let j=1;j<o;j++)w.push(BP(10,c+j/o*(D-c)));w.push(g)}else if(r.substr(0,1)==="q"){w.push(h);for(let c=1;c<o;c++){const D=(b.length-1)*c/o,j=NP(D);if(j===D)w.push(b[j]);else{const J=D-j;w.push(b[j]*(1-J)+b[j+1]*J)}}w.push(g)}else if(r.substr(0,1)==="k"){let c;const D=b.length,j=new Array(D),J=new Array(o);let G=!0,q=0,Ee=null;Ee=[],Ee.push(h);for(let Ne=1;Ne<o;Ne++)Ee.push(h+Ne/o*(g-h));for(Ee.push(g);G;){for(let se=0;se<o;se++)J[se]=0;for(let se=0;se<D;se++){const ue=b[se];let he=Number.MAX_VALUE,De;for(let Ze=0;Ze<o;Ze++){const je=UP(Ee[Ze]-ue);je<he&&(he=je,De=Ze),J[De]++,j[se]=De}}const Ne=new Array(o);for(let se=0;se<o;se++)Ne[se]=null;for(let se=0;se<D;se++)c=j[se],Ne[c]===null?Ne[c]=b[se]:Ne[c]+=b[se];for(let se=0;se<o;se++)Ne[se]*=1/J[se];G=!1;for(let se=0;se<o;se++)if(Ne[se]!==Ee[se]){G=!0;break}Ee=Ne,q++,q>200&&(G=!1)}const Ae={};for(let Ne=0;Ne<o;Ne++)Ae[Ne]=[];for(let Ne=0;Ne<D;Ne++)c=j[Ne],Ae[c].push(b[Ne]);let Fe=[];for(let Ne=0;Ne<o;Ne++)Fe.push(Ae[Ne][0]),Fe.push(Ae[Ne][Ae[Ne].length-1]);Fe=Fe.sort((Ne,se)=>Ne-se),w.push(Fe[0]);for(let Ne=1;Ne<Fe.length;Ne+=2){const se=Fe[Ne];!isNaN(se)&&w.indexOf(se)===-1&&w.push(se)}}return w}const jP=(e,r)=>{e=new ut(e),r=new ut(r);const o=e.luminance(),h=r.luminance();return o>h?(o+.05)/(h+.05):(h+.05)/(o+.05)};/**
 * @license
 *
 * The APCA contrast prediction algorithm is based of the formulas published
 * in the APCA-1.0.98G specification by Myndex. The specification is available at:
 * https://raw.githubusercontent.com/Myndex/apca-w3/master/images/APCAw3_0.1.17_APCA0.0.98G.svg
 *
 * Note that the APCA implementation is still beta, so please update to
 * future versions of chroma.js when they become available.
 *
 * You can read more about the APCA Readability Criterion at
 * https://readtech.org/ARC/
 */const s2=.027,$P=5e-4,VP=.1,o2=1.14,O_=.022,a2=1.414,qP=(e,r)=>{e=new ut(e),r=new ut(r),e.alpha()<1&&(e=Zf(r,e,e.alpha(),"rgb"));const o=l2(...e.rgb()),h=l2(...r.rgb()),g=o>=O_?o:o+Math.pow(O_-o,a2),b=h>=O_?h:h+Math.pow(O_-h,a2),w=Math.pow(b,.56)-Math.pow(g,.57),c=Math.pow(b,.65)-Math.pow(g,.62),D=Math.abs(b-g)<$P?0:g<b?w*o2:c*o2;return(Math.abs(D)<VP?0:D>0?D-s2:D+s2)*100};function l2(e,r,o){return .2126729*Math.pow(e/255,2.4)+.7151522*Math.pow(r/255,2.4)+.072175*Math.pow(o/255,2.4)}const{sqrt:Su,pow:wi,min:ZP,max:WP,atan2:u2,abs:c2,cos:F_,sin:h2,exp:GP,PI:d2}=Math;function HP(e,r,o=1,h=1,g=1){var b=function(St){return 360*St/(2*d2)},w=function(St){return 2*d2*St/360};e=new ut(e),r=new ut(r);const[c,D,j]=Array.from(e.lab()),[J,G,q]=Array.from(r.lab()),Ee=(c+J)/2,Ae=Su(wi(D,2)+wi(j,2)),Fe=Su(wi(G,2)+wi(q,2)),Ne=(Ae+Fe)/2,se=.5*(1-Su(wi(Ne,7)/(wi(Ne,7)+wi(25,7)))),ue=D*(1+se),he=G*(1+se),De=Su(wi(ue,2)+wi(j,2)),Ze=Su(wi(he,2)+wi(q,2)),je=(De+Ze)/2,ve=b(u2(j,ue)),ee=b(u2(q,he)),de=ve>=0?ve:ve+360,Te=ee>=0?ee:ee+360,Ue=c2(de-Te)>180?(de+Te+360)/2:(de+Te)/2,Xe=1-.17*F_(w(Ue-30))+.24*F_(w(2*Ue))+.32*F_(w(3*Ue+6))-.2*F_(w(4*Ue-63));let mt=Te-de;mt=c2(mt)<=180?mt:Te<=de?mt+360:mt-360,mt=2*Su(De*Ze)*h2(w(mt)/2);const Kt=J-c,qn=Ze-De,Qn=1+.015*wi(Ee-50,2)/Su(20+wi(Ee-50,2)),zt=1+.045*je,Je=1+.015*je*Xe,nt=30*GP(-wi((Ue-275)/25,2)),ct=-(2*Su(wi(je,7)/(wi(je,7)+wi(25,7))))*h2(2*w(nt)),It=Su(wi(Kt/(o*Qn),2)+wi(qn/(h*zt),2)+wi(mt/(g*Je),2)+ct*(qn/(h*zt))*(mt/(g*Je)));return WP(0,ZP(100,It))}function XP(e,r,o="lab"){e=new ut(e),r=new ut(r);const h=e.get(o),g=r.get(o);let b=0;for(let w in h){const c=(h[w]||0)-(g[w]||0);b+=c*c}return Math.sqrt(b)}const KP=(...e)=>{try{return new ut(...e),!0}catch{return!1}},YP={cool(){return D0([Bn.hsl(180,1,.9),Bn.hsl(250,.7,.4)])},hot(){return D0(["#000","#f00","#ff0","#fff"]).mode("rgb")}},px={OrRd:["#fff7ec","#fee8c8","#fdd49e","#fdbb84","#fc8d59","#ef6548","#d7301f","#b30000","#7f0000"],PuBu:["#fff7fb","#ece7f2","#d0d1e6","#a6bddb","#74a9cf","#3690c0","#0570b0","#045a8d","#023858"],BuPu:["#f7fcfd","#e0ecf4","#bfd3e6","#9ebcda","#8c96c6","#8c6bb1","#88419d","#810f7c","#4d004b"],Oranges:["#fff5eb","#fee6ce","#fdd0a2","#fdae6b","#fd8d3c","#f16913","#d94801","#a63603","#7f2704"],BuGn:["#f7fcfd","#e5f5f9","#ccece6","#99d8c9","#66c2a4","#41ae76","#238b45","#006d2c","#00441b"],YlOrBr:["#ffffe5","#fff7bc","#fee391","#fec44f","#fe9929","#ec7014","#cc4c02","#993404","#662506"],YlGn:["#ffffe5","#f7fcb9","#d9f0a3","#addd8e","#78c679","#41ab5d","#238443","#006837","#004529"],Reds:["#fff5f0","#fee0d2","#fcbba1","#fc9272","#fb6a4a","#ef3b2c","#cb181d","#a50f15","#67000d"],RdPu:["#fff7f3","#fde0dd","#fcc5c0","#fa9fb5","#f768a1","#dd3497","#ae017e","#7a0177","#49006a"],Greens:["#f7fcf5","#e5f5e0","#c7e9c0","#a1d99b","#74c476","#41ab5d","#238b45","#006d2c","#00441b"],YlGnBu:["#ffffd9","#edf8b1","#c7e9b4","#7fcdbb","#41b6c4","#1d91c0","#225ea8","#253494","#081d58"],Purples:["#fcfbfd","#efedf5","#dadaeb","#bcbddc","#9e9ac8","#807dba","#6a51a3","#54278f","#3f007d"],GnBu:["#f7fcf0","#e0f3db","#ccebc5","#a8ddb5","#7bccc4","#4eb3d3","#2b8cbe","#0868ac","#084081"],Greys:["#ffffff","#f0f0f0","#d9d9d9","#bdbdbd","#969696","#737373","#525252","#252525","#000000"],YlOrRd:["#ffffcc","#ffeda0","#fed976","#feb24c","#fd8d3c","#fc4e2a","#e31a1c","#bd0026","#800026"],PuRd:["#f7f4f9","#e7e1ef","#d4b9da","#c994c7","#df65b0","#e7298a","#ce1256","#980043","#67001f"],Blues:["#f7fbff","#deebf7","#c6dbef","#9ecae1","#6baed6","#4292c6","#2171b5","#08519c","#08306b"],PuBuGn:["#fff7fb","#ece2f0","#d0d1e6","#a6bddb","#67a9cf","#3690c0","#02818a","#016c59","#014636"],Viridis:["#440154","#482777","#3f4a8a","#31678e","#26838f","#1f9d8a","#6cce5a","#b6de2b","#fee825"],Spectral:["#9e0142","#d53e4f","#f46d43","#fdae61","#fee08b","#ffffbf","#e6f598","#abdda4","#66c2a5","#3288bd","#5e4fa2"],RdYlGn:["#a50026","#d73027","#f46d43","#fdae61","#fee08b","#ffffbf","#d9ef8b","#a6d96a","#66bd63","#1a9850","#006837"],RdBu:["#67001f","#b2182b","#d6604d","#f4a582","#fddbc7","#f7f7f7","#d1e5f0","#92c5de","#4393c3","#2166ac","#053061"],PiYG:["#8e0152","#c51b7d","#de77ae","#f1b6da","#fde0ef","#f7f7f7","#e6f5d0","#b8e186","#7fbc41","#4d9221","#276419"],PRGn:["#40004b","#762a83","#9970ab","#c2a5cf","#e7d4e8","#f7f7f7","#d9f0d3","#a6dba0","#5aae61","#1b7837","#00441b"],RdYlBu:["#a50026","#d73027","#f46d43","#fdae61","#fee090","#ffffbf","#e0f3f8","#abd9e9","#74add1","#4575b4","#313695"],BrBG:["#543005","#8c510a","#bf812d","#dfc27d","#f6e8c3","#f5f5f5","#c7eae5","#80cdc1","#35978f","#01665e","#003c30"],RdGy:["#67001f","#b2182b","#d6604d","#f4a582","#fddbc7","#ffffff","#e0e0e0","#bababa","#878787","#4d4d4d","#1a1a1a"],PuOr:["#7f3b08","#b35806","#e08214","#fdb863","#fee0b6","#f7f7f7","#d8daeb","#b2abd2","#8073ac","#542788","#2d004b"],Set2:["#66c2a5","#fc8d62","#8da0cb","#e78ac3","#a6d854","#ffd92f","#e5c494","#b3b3b3"],Accent:["#7fc97f","#beaed4","#fdc086","#ffff99","#386cb0","#f0027f","#bf5b17","#666666"],Set1:["#e41a1c","#377eb8","#4daf4a","#984ea3","#ff7f00","#ffff33","#a65628","#f781bf","#999999"],Set3:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462","#b3de69","#fccde5","#d9d9d9","#bc80bd","#ccebc5","#ffed6f"],Dark2:["#1b9e77","#d95f02","#7570b3","#e7298a","#66a61e","#e6ab02","#a6761d","#666666"],Paired:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f","#ff7f00","#cab2d6","#6a3d9a","#ffff99","#b15928"],Pastel2:["#b3e2cd","#fdcdac","#cbd5e8","#f4cae4","#e6f5c9","#fff2ae","#f1e2cc","#cccccc"],Pastel1:["#fbb4ae","#b3cde3","#ccebc5","#decbe4","#fed9a6","#ffffcc","#e5d8bd","#fddaec","#f2f2f2"]},U5=Object.keys(px),f2=new Map(U5.map(e=>[e.toLowerCase(),e])),JP=typeof Proxy=="function"?new Proxy(px,{get(e,r){const o=r.toLowerCase();if(f2.has(o))return e[f2.get(o)]},getOwnPropertyNames(){return Object.getOwnPropertyNames(U5)}}):px,QP=(...e)=>{e=xn(e,"cmyk");const[r,o,h,g]=e,b=e.length>4?e[4]:1;return g===1?[0,0,0,b]:[r>=1?0:255*(1-r)*(1-g),o>=1?0:255*(1-o)*(1-g),h>=1?0:255*(1-h)*(1-g),b]},{max:p2}=Math,eA=(...e)=>{let[r,o,h]=xn(e,"rgb");r=r/255,o=o/255,h=h/255;const g=1-p2(r,p2(o,h)),b=g<1?1/(1-g):0,w=(1-r-g)*b,c=(1-o-g)*b,D=(1-h-g)*b;return[w,c,D,g]};ut.prototype.cmyk=function(){return eA(this._rgb)};const tA=(...e)=>new ut(...e,"cmyk");Object.assign(Bn,{cmyk:tA});vn.format.cmyk=QP;vn.autodetect.push({p:2,test:(...e)=>{if(e=xn(e,"cmyk"),Dn(e)==="array"&&e.length===4)return"cmyk"}});const nA=(...e)=>{const r=xn(e,"hsla");let o=Yf(e)||"lsa";return r[0]=ua(r[0]||0)+"deg",r[1]=ua(r[1]*100)+"%",r[2]=ua(r[2]*100)+"%",o==="hsla"||r.length>3&&r[3]<1?(r[3]="/ "+(r.length>3?r[3]:1),o="hsla"):r.length=3,`${o.substr(0,3)}(${r.join(" ")})`},rA=(...e)=>{const r=xn(e,"lab");let o=Yf(e)||"lab";return r[0]=ua(r[0])+"%",r[1]=ua(r[1]),r[2]=ua(r[2]),o==="laba"||r.length>3&&r[3]<1?r[3]="/ "+(r.length>3?r[3]:1):r.length=3,`lab(${r.join(" ")})`},iA=(...e)=>{const r=xn(e,"lch");let o=Yf(e)||"lab";return r[0]=ua(r[0])+"%",r[1]=ua(r[1]),r[2]=isNaN(r[2])?"none":ua(r[2])+"deg",o==="lcha"||r.length>3&&r[3]<1?r[3]="/ "+(r.length>3?r[3]:1):r.length=3,`lch(${r.join(" ")})`},sA=(...e)=>{const r=xn(e,"lab");return r[0]=ua(r[0]*100)+"%",r[1]=dx(r[1]),r[2]=dx(r[2]),r.length>3&&r[3]<1?r[3]="/ "+(r.length>3?r[3]:1):r.length=3,`oklab(${r.join(" ")})`},j5=(...e)=>{const[r,o,h,...g]=xn(e,"rgb"),[b,w,c]=ww(r,o,h),[D,j,J]=L5(b,w,c);return[D,j,J,...g.length>0&&g[0]<1?[g[0]]:[]]},oA=(...e)=>{const r=xn(e,"lch");return r[0]=ua(r[0]*100)+"%",r[1]=dx(r[1]),r[2]=isNaN(r[2])?"none":ua(r[2])+"deg",r.length>3&&r[3]<1?r[3]="/ "+(r.length>3?r[3]:1):r.length=3,`oklch(${r.join(" ")})`},{round:av}=Math,aA=(...e)=>{const r=xn(e,"rgba");let o=Yf(e)||"rgb";if(o.substr(0,3)==="hsl")return nA(O5(r),o);if(o.substr(0,3)==="lab"){const h=Zm();Pu("d50");const g=rA(_w(r),o);return Pu(h),g}if(o.substr(0,3)==="lch"){const h=Zm();Pu("d50");const g=iA(vw(r),o);return Pu(h),g}return o.substr(0,5)==="oklab"?sA(ww(r)):o.substr(0,5)==="oklch"?oA(j5(r)):(r[0]=av(r[0]),r[1]=av(r[1]),r[2]=av(r[2]),(o==="rgba"||r.length>3&&r[3]<1)&&(r[3]="/ "+(r.length>3?r[3]:1),o="rgba"),`${o.substr(0,3)}(${r.slice(0,o==="rgb"?3:4).join(" ")})`)},$5=(...e)=>{e=xn(e,"lch");const[r,o,h,...g]=e,[b,w,c]=D5(r,o,h),[D,j,J]=xw(b,w,c);return[D,j,J,...g.length>0&&g[0]<1?[g[0]]:[]]},Mu=/((?:-?\d+)|(?:-?\d+(?:\.\d+)?)%|none)/.source,Ka=/((?:-?(?:\d+(?:\.\d*)?|\.\d+)%?)|none)/.source,L0=/((?:-?(?:\d+(?:\.\d*)?|\.\d+)%)|none)/.source,da=/\s*/.source,Qf=/\s+/.source,bw=/\s*,\s*/.source,sy=/((?:-?(?:\d+(?:\.\d*)?|\.\d+)(?:deg)?)|none)/.source,ep=/\s*(?:\/\s*((?:[01]|[01]?\.\d+)|\d+(?:\.\d+)?%))?/.source,V5=new RegExp("^rgba?\\("+da+[Mu,Mu,Mu].join(Qf)+ep+"\\)$"),q5=new RegExp("^rgb\\("+da+[Mu,Mu,Mu].join(bw)+da+"\\)$"),Z5=new RegExp("^rgba\\("+da+[Mu,Mu,Mu,Ka].join(bw)+da+"\\)$"),W5=new RegExp("^hsla?\\("+da+[sy,L0,L0].join(Qf)+ep+"\\)$"),G5=new RegExp("^hsl?\\("+da+[sy,L0,L0].join(bw)+da+"\\)$"),H5=/^hsla\(\s*(-?\d+(?:\.\d+)?),\s*(-?\d+(?:\.\d+)?)%\s*,\s*(-?\d+(?:\.\d+)?)%\s*,\s*([01]|[01]?\.\d+)\)$/,X5=new RegExp("^lab\\("+da+[Ka,Ka,Ka].join(Qf)+ep+"\\)$"),K5=new RegExp("^lch\\("+da+[Ka,Ka,sy].join(Qf)+ep+"\\)$"),Y5=new RegExp("^oklab\\("+da+[Ka,Ka,Ka].join(Qf)+ep+"\\)$"),J5=new RegExp("^oklch\\("+da+[Ka,Ka,sy].join(Qf)+ep+"\\)$"),{round:Q5}=Math,gf=e=>e.map((r,o)=>o<=2?nd(Q5(r),0,255):r),bi=(e,r=0,o=100,h=!1)=>(typeof e=="string"&&e.endsWith("%")&&(e=parseFloat(e.substring(0,e.length-1))/100,h?e=r+(e+1)*.5*(o-r):e=r+e*(o-r)),+e),Zs=(e,r)=>e==="none"?r:e,Sw=e=>{if(e=e.toLowerCase().trim(),e==="transparent")return[0,0,0,0];let r;if(vn.format.named)try{return vn.format.named(e)}catch{}if((r=e.match(V5))||(r=e.match(q5))){let o=r.slice(1,4);for(let g=0;g<3;g++)o[g]=+bi(Zs(o[g],0),0,255);o=gf(o);const h=r[4]!==void 0?+bi(r[4],0,1):1;return o[3]=h,o}if(r=e.match(Z5)){const o=r.slice(1,5);for(let h=0;h<4;h++)o[h]=+bi(o[h],0,255);return o}if((r=e.match(W5))||(r=e.match(G5))){const o=r.slice(1,4);o[0]=+Zs(o[0].replace("deg",""),0),o[1]=+bi(Zs(o[1],0),0,100)*.01,o[2]=+bi(Zs(o[2],0),0,100)*.01;const h=gf(fx(o)),g=r[4]!==void 0?+bi(r[4],0,1):1;return h[3]=g,h}if(r=e.match(H5)){const o=r.slice(1,4);o[1]*=.01,o[2]*=.01;const h=fx(o);for(let g=0;g<3;g++)h[g]=Q5(h[g]);return h[3]=+r[4],h}if(r=e.match(X5)){const o=r.slice(1,4);o[0]=bi(Zs(o[0],0),0,100),o[1]=bi(Zs(o[1],0),-125,125,!0),o[2]=bi(Zs(o[2],0),-125,125,!0);const h=Zm();Pu("d50");const g=gf(gw(o));Pu(h);const b=r[4]!==void 0?+bi(r[4],0,1):1;return g[3]=b,g}if(r=e.match(K5)){const o=r.slice(1,4);o[0]=bi(o[0],0,100),o[1]=bi(Zs(o[1],0),0,150,!1),o[2]=+Zs(o[2].replace("deg",""),0);const h=Zm();Pu("d50");const g=gf(yw(o));Pu(h);const b=r[4]!==void 0?+bi(r[4],0,1):1;return g[3]=b,g}if(r=e.match(Y5)){const o=r.slice(1,4);o[0]=bi(Zs(o[0],0),0,1),o[1]=bi(Zs(o[1],0),-.4,.4,!0),o[2]=bi(Zs(o[2],0),-.4,.4,!0);const h=gf(xw(o)),g=r[4]!==void 0?+bi(r[4],0,1):1;return h[3]=g,h}if(r=e.match(J5)){const o=r.slice(1,4);o[0]=bi(Zs(o[0],0),0,1),o[1]=bi(Zs(o[1],0),0,.4,!1),o[2]=+Zs(o[2].replace("deg",""),0);const h=gf($5(o)),g=r[4]!==void 0?+bi(r[4],0,1):1;return h[3]=g,h}};Sw.test=e=>V5.test(e)||W5.test(e)||X5.test(e)||K5.test(e)||Y5.test(e)||J5.test(e)||q5.test(e)||Z5.test(e)||G5.test(e)||H5.test(e)||e==="transparent";ut.prototype.css=function(e){return aA(this._rgb,e)};const lA=(...e)=>new ut(...e,"css");Bn.css=lA;vn.format.css=Sw;vn.autodetect.push({p:5,test:(e,...r)=>{if(!r.length&&Dn(e)==="string"&&Sw.test(e))return"css"}});vn.format.gl=(...e)=>{const r=xn(e,"rgba");return r[0]*=255,r[1]*=255,r[2]*=255,r};const uA=(...e)=>new ut(...e,"gl");Bn.gl=uA;ut.prototype.gl=function(){const e=this._rgb;return[e[0]/255,e[1]/255,e[2]/255,e[3]]};ut.prototype.hex=function(e){return A5(this._rgb,e)};const cA=(...e)=>new ut(...e,"hex");Bn.hex=cA;vn.format.hex=P5;vn.autodetect.push({p:4,test:(e,...r)=>{if(!r.length&&Dn(e)==="string"&&[3,4,5,6,7,8,9].indexOf(e.length)>=0)return"hex"}});const{log:B_}=Math,eS=e=>{const r=e/100;let o,h,g;return r<66?(o=255,h=r<6?0:-155.25485562709179-.44596950469579133*(h=r-2)+104.49216199393888*B_(h),g=r<20?0:-254.76935184120902+.8274096064007395*(g=r-10)+115.67994401066147*B_(g)):(o=351.97690566805693+.114206453784165*(o=r-55)-40.25366309332127*B_(o),h=325.4494125711974+.07943456536662342*(h=r-50)-28.0852963507957*B_(h),g=255),[o,h,g,1]},{round:hA}=Math,dA=(...e)=>{const r=xn(e,"rgb"),o=r[0],h=r[2];let g=1e3,b=4e4;const w=.4;let c;for(;b-g>w;){c=(b+g)*.5;const D=eS(c);D[2]/D[0]>=h/o?b=c:g=c}return hA(c)};ut.prototype.temp=ut.prototype.kelvin=ut.prototype.temperature=function(){return dA(this._rgb)};const lv=(...e)=>new ut(...e,"temp");Object.assign(Bn,{temp:lv,kelvin:lv,temperature:lv});vn.format.temp=vn.format.kelvin=vn.format.temperature=eS;ut.prototype.oklch=function(){return j5(this._rgb)};const fA=(...e)=>new ut(...e,"oklch");Object.assign(Bn,{oklch:fA});vn.format.oklch=$5;vn.autodetect.push({p:2,test:(...e)=>{if(e=xn(e,"oklch"),Dn(e)==="array"&&e.length===3)return"oklch"}});Object.assign(Bn,{analyze:B5,average:pP,bezier:xP,blend:Ja,brewer:JP,Color:ut,colors:qf,contrast:jP,contrastAPCA:qP,cubehelix:DP,deltaE:HP,distance:XP,input:vn,interpolate:Zf,limits:N5,mix:Zf,random:FP,scale:D0,scales:YP,valid:KP});const pA="YELLOW",mA="RED",R0=.6,tS=.5,gA=Bn.scale([pA,mA]),O0=(e,r)=>{const o=g=>Math.log2(g),h=o(e)/o(r);return gA(h).hex()},_A=()=>{const[e,r]=Bt.useState(null);Bt.useEffect(()=>{(async()=>{const h=await Z4(),g=await G4(),b={};for(const[D,j]of Object.entries(h)){const J=O0(j,g);b[D]=J}const w={type:"FeatureCollection",features:[]},c=await cw();for(const[D,j]of Object.entries(b)){const J=c.find(G=>G.codeIso3===D);w.features.push({...J.geojson,properties:{color:j}})}r(w)})()},[]);const o=Kf();return Bt.useCallback(()=>e===null?()=>null:o(e,{fillColor:["get","color"],fillOpacity:R0,strokeOpacity:tS}),[e,o])},yA=()=>{const e=ss(g=>g.main.focusedCountry),[r,o]=Bt.useState(null);Bt.useEffect(()=>{if(!e||!ld(e.codeIso3)){o(null);return}(async()=>{const g=await X4(e.codeIso3),b=await Y4(e.codeIso3),w={};for(const[j,J]of Object.entries(g)){const G=O0(J,b);w[j]=G}const c={type:"FeatureCollection",features:[]},D=await D4(e.codeIso3);for(const[j,J]of Object.entries(w)){const G=D.find(q=>q.stateCode===j);c.features.push({...G.geojson,properties:{color:J}})}o(c)})()},[e]);const h=Kf();return Bt.useCallback(()=>r===null?()=>null:h(r,{fillColor:["get","color"],fillOpacity:R0,strokeOpacity:tS}),[r,h])},vA="_card_no9l0_1",xA="_title_no9l0_10",wA="_legendItem_no9l0_14",bA="_legendItemColor_no9l0_20",SA="_legendItemColorFill_no9l0_28",Dl={card:vA,title:xA,legendItem:wA,legendItemColor:bA,legendItemColorFill:SA},TA=()=>{const e=ss(h=>h.main.focusedCountry),[r,o]=Bt.useState(0);return Bt.useEffect(()=>{(async()=>{if(!e||!ld(e.codeIso3)){const h=await G4();o(h)}else{const h=await Y4(e.codeIso3);o(h)}})()},[e]),ft.jsxs(B4,{className:Dl.card,children:[ft.jsx("h2",{className:Dl.title,children:"Legend"}),ft.jsxs("div",{className:Dl.legendItem,children:[ft.jsx("div",{className:Dl.legendItemColor,children:ft.jsx("div",{className:Dl.legendItemColorFill,style:{opacity:R0,backgroundColor:O0(1,r)}})}),ft.jsx("div",{className:Dl.legendItemText,children:"1 Dataset"})]}),ft.jsxs("div",{className:Dl.legendItem,children:[ft.jsx("div",{className:Dl.legendItemColor,children:ft.jsx("div",{className:Dl.legendItemColorFill,style:{opacity:R0,backgroundColor:O0(r,r)}})}),ft.jsxs("div",{className:Dl.legendItemText,children:[r," Datasets"]})]})]})},EA=()=>{const e=Kf(),r=ss(h=>h.main.focusedCountry),o=CA();return Bt.useCallback(()=>{if(r===null)return()=>null;const h=[],g=!!r.statesData;return h.push(e(r.geojson,{fillColor:_5,fillOpacity:g?0:y5,strokeWidth:3})),h.push(o()),()=>h.forEach(b=>b())},[r,o,e])},CA=()=>{const e=Kf(),r=ss(o=>o.main.focusedCountry);return Bt.useCallback(()=>{if(!(r!=null&&r.statesData))return()=>null;const o={type:"FeatureCollection",features:r.statesData.map(h=>({...h.geojson,properties:{color:"#ffffff"}}))};return e(o,{fillColor:["get","color"],fillOpacity:0,strokeOpacity:.5})},[r,e])},IA=()=>{const e=Kf(),r=ss(o=>o.main.focusedState);return Bt.useCallback(()=>r?e(r.geojson,{fillColor:_5,fillOpacity:y5}):()=>null,[r,e])},kA="_container_1r1dt_1",PA="_triangle_1r1dt_13",AA="_content_1r1dt_23",MA="_title_1r1dt_32",zA="_description_1r1dt_40",hm={container:kA,triangle:PA,content:AA,title:MA,description:zA},DA=({x:e,y:r})=>{const[o,h]=Bt.useState(!1),[g,b]=Bt.useState(!1),[w,c]=Bt.useState(null),[D,j]=Bt.useState(null),J=ss(Ne=>Ne.main.focusedCountry),G=$I();Bt.useEffect(()=>{(async()=>{if(o||g){c(null),j(null);return}const Ne=G(e,r),se=Ne[0],ue=Ne[1],he=await L4(se,ue);if(c(he),J&&he&&J.name===he.name&&J.statesData){const De=await R4(se,ue,J.statesData);j(De)}})()},[J,G,o,g,e,r]);const q=v5();Bt.useEffect(()=>q("movestart",()=>h(!0)),[q]),Bt.useEffect(()=>q("moveend",()=>h(!1)),[q]),Bt.useEffect(()=>q("zoomstart",()=>b(!0)),[q]),Bt.useEffect(()=>q("zoomend",()=>b(!1)),[q]);const[Ee,Ae]=Bt.useState(null);Bt.useEffect(()=>{(async()=>{if(w&&D){const Ne=await fC(w.codeIso3,D.stateCode);Ae({title:`${D.name}, ${w.name}`,descriptions:[`Number of Datasets: ${Ne}`,`${hx(w.codeIso3)} Name: ${D.name}`,`${hx(w.codeIso3)} Code: ${D.stateCode}`,`Country Name: ${w.name}`,`Country Code: ${w.codeIso3}`]})}else if(w&&!D){const Ne=await dC(w.codeIso3);Ae({title:`${w.name}`,descriptions:[`Number of Datasets: ${Ne}`,`Country Name: ${w.name}`,`Country Code: ${w.codeIso3}`]})}else Ae(null)})()},[w,D]);const Fe=Kf();return Bt.useEffect(()=>{if(D)return Fe(D.geojson,DI);if(w)return Fe(w.geojson,zI)},[w,D,Fe]),Ee===null?null:ft.jsxs("div",{className:hm.container,style:{top:r,left:e},children:[ft.jsx("div",{className:hm.triangle}),ft.jsxs("div",{className:hm.content,children:[ft.jsx("h3",{className:hm.title,children:Ee.title}),Ee.descriptions.map((Ne,se)=>ft.jsx("p",{className:hm.description,children:Ne},se))]})]})};let uv=null;const LA=100,RA=()=>{const[e,r]=Bt.useState(null);return Bt.useEffect(()=>x5(o=>{uv&&clearTimeout(uv),r(null),!!o.target.closest(`#${g5}`)&&(uv=setTimeout(()=>{r(ft.jsx(DA,{x:o.clientX,y:o.clientY}))},LA))}),[]),e},OA="_container_17w4n_1",FA="_map_17w4n_11",m2={container:OA,map:FA},BA=()=>{const e=Jm(),r=RI();Bt.useEffect(()=>r(),[r]);const o=T5(),h=OI(),g=ss(G=>G.main.focusedCountry),b=ss(G=>G.main.focusedState);Bt.useEffect(()=>h(async G=>{const q=G.lngLat.lng,Ee=G.lngLat.lat,Ae=await L4(q,Ee);let Fe=null;Ae&&g&&Ae.name===g.name&&g.statesData&&(Fe=await R4(q,Ee,g.statesData)),e(jl.actions.setFocusedCountry(Ae)),e(jl.actions.setFocusedState(Fe)),Fe?o(Fe):Ae&&o(Ae)}),[h,e,o,g]);const w=RA(),c=_A();Bt.useEffect(()=>{if(!g||!ld(g.codeIso3))return c()},[g,b,c]);const D=yA();Bt.useEffect(()=>{if(g&&ld(g.codeIso3))return D()},[g,b,D]);const j=EA();Bt.useEffect(()=>j(),[j]);const J=IA();return Bt.useEffect(()=>J(),[J]),ft.jsxs("div",{className:m2.container,children:[ft.jsx("div",{className:m2.map,id:"map"}),w,ft.jsx(ck,{}),ft.jsx(TA,{})]})},NA=fI({reducer:{main:jl.reducer}});cv.createRoot(document.getElementById("root")).render(ft.jsx(Ol.StrictMode,{children:ft.jsx(BE,{store:NA,children:ft.jsx(BA,{})})}));
