function GS(e,r){for(var o=0;o<r.length;o++){const h=r[o];if(typeof h!="string"&&!Array.isArray(h)){for(const _ in h)if(_!=="default"&&!(_ in e)){const b=Object.getOwnPropertyDescriptor(h,_);b&&Object.defineProperty(e,_,b.get?b:{enumerable:!0,get:()=>h[_]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const _ of document.querySelectorAll('link[rel="modulepreload"]'))h(_);new MutationObserver(_=>{for(const b of _)if(b.type==="childList")for(const w of b.addedNodes)w.tagName==="LINK"&&w.rel==="modulepreload"&&h(w)}).observe(document,{childList:!0,subtree:!0});function o(_){const b={};return _.integrity&&(b.integrity=_.integrity),_.referrerPolicy&&(b.referrerPolicy=_.referrerPolicy),_.crossOrigin==="use-credentials"?b.credentials="include":_.crossOrigin==="anonymous"?b.credentials="omit":b.credentials="same-origin",b}function h(_){if(_.ep)return;_.ep=!0;const b=o(_);fetch(_.href,b)}})();var Kh=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function B0(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var _2={exports:{}},N0={},y2={exports:{}},On={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Xm=Symbol.for("react.element"),WS=Symbol.for("react.portal"),HS=Symbol.for("react.fragment"),XS=Symbol.for("react.strict_mode"),KS=Symbol.for("react.profiler"),YS=Symbol.for("react.provider"),JS=Symbol.for("react.context"),QS=Symbol.for("react.forward_ref"),e6=Symbol.for("react.suspense"),t6=Symbol.for("react.memo"),n6=Symbol.for("react.lazy"),zw=Symbol.iterator;function r6(e){return e===null||typeof e!="object"?null:(e=zw&&e[zw]||e["@@iterator"],typeof e=="function"?e:null)}var v2={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},x2=Object.assign,w2={};function Xf(e,r,o){this.props=e,this.context=r,this.refs=w2,this.updater=o||v2}Xf.prototype.isReactComponent={};Xf.prototype.setState=function(e,r){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,r,"setState")};Xf.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function b2(){}b2.prototype=Xf.prototype;function _x(e,r,o){this.props=e,this.context=r,this.refs=w2,this.updater=o||v2}var yx=_x.prototype=new b2;yx.constructor=_x;x2(yx,Xf.prototype);yx.isPureReactComponent=!0;var Dw=Array.isArray,S2=Object.prototype.hasOwnProperty,vx={current:null},T2={key:!0,ref:!0,__self:!0,__source:!0};function E2(e,r,o){var h,_={},b=null,w=null;if(r!=null)for(h in r.ref!==void 0&&(w=r.ref),r.key!==void 0&&(b=""+r.key),r)S2.call(r,h)&&!T2.hasOwnProperty(h)&&(_[h]=r[h]);var c=arguments.length-2;if(c===1)_.children=o;else if(1<c){for(var D=Array(c),U=0;U<c;U++)D[U]=arguments[U+2];_.children=D}if(e&&e.defaultProps)for(h in c=e.defaultProps,c)_[h]===void 0&&(_[h]=c[h]);return{$$typeof:Xm,type:e,key:b,ref:w,props:_,_owner:vx.current}}function i6(e,r){return{$$typeof:Xm,type:e.type,key:r,ref:e.ref,props:e.props,_owner:e._owner}}function xx(e){return typeof e=="object"&&e!==null&&e.$$typeof===Xm}function s6(e){var r={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(o){return r[o]})}var Rw=/\/+/g;function S1(e,r){return typeof e=="object"&&e!==null&&e.key!=null?s6(""+e.key):r.toString(36)}function j_(e,r,o,h,_){var b=typeof e;(b==="undefined"||b==="boolean")&&(e=null);var w=!1;if(e===null)w=!0;else switch(b){case"string":case"number":w=!0;break;case"object":switch(e.$$typeof){case Xm:case WS:w=!0}}if(w)return w=e,_=_(w),e=h===""?"."+S1(w,0):h,Dw(_)?(o="",e!=null&&(o=e.replace(Rw,"$&/")+"/"),j_(_,r,o,"",function(U){return U})):_!=null&&(xx(_)&&(_=i6(_,o+(!_.key||w&&w.key===_.key?"":(""+_.key).replace(Rw,"$&/")+"/")+e)),r.push(_)),1;if(w=0,h=h===""?".":h+":",Dw(e))for(var c=0;c<e.length;c++){b=e[c];var D=h+S1(b,c);w+=j_(b,r,o,D,_)}else if(D=r6(e),typeof D=="function")for(e=D.call(e),c=0;!(b=e.next()).done;)b=b.value,D=h+S1(b,c++),w+=j_(b,r,o,D,_);else if(b==="object")throw r=String(e),Error("Objects are not valid as a React child (found: "+(r==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":r)+"). If you meant to render a collection of children, use an array instead.");return w}function v_(e,r,o){if(e==null)return e;var h=[],_=0;return j_(e,h,"","",function(b){return r.call(o,b,_++)}),h}function o6(e){if(e._status===-1){var r=e._result;r=r(),r.then(function(o){(e._status===0||e._status===-1)&&(e._status=1,e._result=o)},function(o){(e._status===0||e._status===-1)&&(e._status=2,e._result=o)}),e._status===-1&&(e._status=0,e._result=r)}if(e._status===1)return e._result.default;throw e._result}var Xs={current:null},$_={transition:null},a6={ReactCurrentDispatcher:Xs,ReactCurrentBatchConfig:$_,ReactCurrentOwner:vx};function C2(){throw Error("act(...) is not supported in production builds of React.")}On.Children={map:v_,forEach:function(e,r,o){v_(e,function(){r.apply(this,arguments)},o)},count:function(e){var r=0;return v_(e,function(){r++}),r},toArray:function(e){return v_(e,function(r){return r})||[]},only:function(e){if(!xx(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};On.Component=Xf;On.Fragment=HS;On.Profiler=KS;On.PureComponent=_x;On.StrictMode=XS;On.Suspense=e6;On.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=a6;On.act=C2;On.cloneElement=function(e,r,o){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var h=x2({},e.props),_=e.key,b=e.ref,w=e._owner;if(r!=null){if(r.ref!==void 0&&(b=r.ref,w=vx.current),r.key!==void 0&&(_=""+r.key),e.type&&e.type.defaultProps)var c=e.type.defaultProps;for(D in r)S2.call(r,D)&&!T2.hasOwnProperty(D)&&(h[D]=r[D]===void 0&&c!==void 0?c[D]:r[D])}var D=arguments.length-2;if(D===1)h.children=o;else if(1<D){c=Array(D);for(var U=0;U<D;U++)c[U]=arguments[U+2];h.children=c}return{$$typeof:Xm,type:e.type,key:_,ref:b,props:h,_owner:w}};On.createContext=function(e){return e={$$typeof:JS,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:YS,_context:e},e.Consumer=e};On.createElement=E2;On.createFactory=function(e){var r=E2.bind(null,e);return r.type=e,r};On.createRef=function(){return{current:null}};On.forwardRef=function(e){return{$$typeof:QS,render:e}};On.isValidElement=xx;On.lazy=function(e){return{$$typeof:n6,_payload:{_status:-1,_result:e},_init:o6}};On.memo=function(e,r){return{$$typeof:t6,type:e,compare:r===void 0?null:r}};On.startTransition=function(e){var r=$_.transition;$_.transition={};try{e()}finally{$_.transition=r}};On.unstable_act=C2;On.useCallback=function(e,r){return Xs.current.useCallback(e,r)};On.useContext=function(e){return Xs.current.useContext(e)};On.useDebugValue=function(){};On.useDeferredValue=function(e){return Xs.current.useDeferredValue(e)};On.useEffect=function(e,r){return Xs.current.useEffect(e,r)};On.useId=function(){return Xs.current.useId()};On.useImperativeHandle=function(e,r,o){return Xs.current.useImperativeHandle(e,r,o)};On.useInsertionEffect=function(e,r){return Xs.current.useInsertionEffect(e,r)};On.useLayoutEffect=function(e,r){return Xs.current.useLayoutEffect(e,r)};On.useMemo=function(e,r){return Xs.current.useMemo(e,r)};On.useReducer=function(e,r,o){return Xs.current.useReducer(e,r,o)};On.useRef=function(e){return Xs.current.useRef(e)};On.useState=function(e){return Xs.current.useState(e)};On.useSyncExternalStore=function(e,r,o){return Xs.current.useSyncExternalStore(e,r,o)};On.useTransition=function(){return Xs.current.useTransition()};On.version="18.3.1";y2.exports=On;var Rt=y2.exports;const Ol=B0(Rt),Lw=GS({__proto__:null,default:Ol},[Rt]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var l6=Rt,u6=Symbol.for("react.element"),c6=Symbol.for("react.fragment"),h6=Object.prototype.hasOwnProperty,d6=l6.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,f6={key:!0,ref:!0,__self:!0,__source:!0};function I2(e,r,o){var h,_={},b=null,w=null;o!==void 0&&(b=""+o),r.key!==void 0&&(b=""+r.key),r.ref!==void 0&&(w=r.ref);for(h in r)h6.call(r,h)&&!f6.hasOwnProperty(h)&&(_[h]=r[h]);if(e&&e.defaultProps)for(h in r=e.defaultProps,r)_[h]===void 0&&(_[h]=r[h]);return{$$typeof:u6,type:e,key:b,ref:w,props:_,_owner:d6.current}}N0.Fragment=c6;N0.jsx=I2;N0.jsxs=I2;_2.exports=N0;var Qe=_2.exports,dv={},k2={exports:{}},Fo={},P2={exports:{}},A2={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function r(Je,rt){var Et=Je.length;Je.push(rt);e:for(;0<Et;){var ht=Et-1>>>1,It=Je[ht];if(0<_(It,rt))Je[ht]=rt,Je[Et]=It,Et=ht;else break e}}function o(Je){return Je.length===0?null:Je[0]}function h(Je){if(Je.length===0)return null;var rt=Je[0],Et=Je.pop();if(Et!==rt){Je[0]=Et;e:for(var ht=0,It=Je.length,St=It>>>1;ht<St;){var Sn=2*(ht+1)-1,cn=Je[Sn],Cn=Sn+1,Nn=Je[Cn];if(0>_(cn,Et))Cn<It&&0>_(Nn,cn)?(Je[ht]=Nn,Je[Cn]=Et,ht=Cn):(Je[ht]=cn,Je[Sn]=Et,ht=Sn);else if(Cn<It&&0>_(Nn,Et))Je[ht]=Nn,Je[Cn]=Et,ht=Cn;else break e}}return rt}function _(Je,rt){var Et=Je.sortIndex-rt.sortIndex;return Et!==0?Et:Je.id-rt.id}if(typeof performance=="object"&&typeof performance.now=="function"){var b=performance;e.unstable_now=function(){return b.now()}}else{var w=Date,c=w.now();e.unstable_now=function(){return w.now()-c}}var D=[],U=[],J=1,W=null,q=3,Ee=!1,ze=!1,Ne=!1,Be=typeof setTimeout=="function"?setTimeout:null,se=typeof clearTimeout=="function"?clearTimeout:null,ue=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function he(Je){for(var rt=o(U);rt!==null;){if(rt.callback===null)h(U);else if(rt.startTime<=Je)h(U),rt.sortIndex=rt.expirationTime,r(D,rt);else break;rt=o(U)}}function De(Je){if(Ne=!1,he(Je),!ze)if(o(D)!==null)ze=!0,Qn(Ze);else{var rt=o(U);rt!==null&&zt(De,rt.startTime-Je)}}function Ze(Je,rt){ze=!1,Ne&&(Ne=!1,se(ee),ee=-1),Ee=!0;var Et=q;try{for(he(rt),W=o(D);W!==null&&(!(W.expirationTime>rt)||Je&&!Ue());){var ht=W.callback;if(typeof ht=="function"){W.callback=null,q=W.priorityLevel;var It=ht(W.expirationTime<=rt);rt=e.unstable_now(),typeof It=="function"?W.callback=It:W===o(D)&&h(D),he(rt)}else h(D);W=o(D)}if(W!==null)var St=!0;else{var Sn=o(U);Sn!==null&&zt(De,Sn.startTime-rt),St=!1}return St}finally{W=null,q=Et,Ee=!1}}var je=!1,ve=null,ee=-1,de=5,Te=-1;function Ue(){return!(e.unstable_now()-Te<de)}function Xe(){if(ve!==null){var Je=e.unstable_now();Te=Je;var rt=!0;try{rt=ve(!0,Je)}finally{rt?mt():(je=!1,ve=null)}}else je=!1}var mt;if(typeof ue=="function")mt=function(){ue(Xe)};else if(typeof MessageChannel<"u"){var Kt=new MessageChannel,qn=Kt.port2;Kt.port1.onmessage=Xe,mt=function(){qn.postMessage(null)}}else mt=function(){Be(Xe,0)};function Qn(Je){ve=Je,je||(je=!0,mt())}function zt(Je,rt){ee=Be(function(){Je(e.unstable_now())},rt)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(Je){Je.callback=null},e.unstable_continueExecution=function(){ze||Ee||(ze=!0,Qn(Ze))},e.unstable_forceFrameRate=function(Je){0>Je||125<Je?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):de=0<Je?Math.floor(1e3/Je):5},e.unstable_getCurrentPriorityLevel=function(){return q},e.unstable_getFirstCallbackNode=function(){return o(D)},e.unstable_next=function(Je){switch(q){case 1:case 2:case 3:var rt=3;break;default:rt=q}var Et=q;q=rt;try{return Je()}finally{q=Et}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(Je,rt){switch(Je){case 1:case 2:case 3:case 4:case 5:break;default:Je=3}var Et=q;q=Je;try{return rt()}finally{q=Et}},e.unstable_scheduleCallback=function(Je,rt,Et){var ht=e.unstable_now();switch(typeof Et=="object"&&Et!==null?(Et=Et.delay,Et=typeof Et=="number"&&0<Et?ht+Et:ht):Et=ht,Je){case 1:var It=-1;break;case 2:It=250;break;case 5:It=1073741823;break;case 4:It=1e4;break;default:It=5e3}return It=Et+It,Je={id:J++,callback:rt,priorityLevel:Je,startTime:Et,expirationTime:It,sortIndex:-1},Et>ht?(Je.sortIndex=Et,r(U,Je),o(D)===null&&Je===o(U)&&(Ne?(se(ee),ee=-1):Ne=!0,zt(De,Et-ht))):(Je.sortIndex=It,r(D,Je),ze||Ee||(ze=!0,Qn(Ze))),Je},e.unstable_shouldYield=Ue,e.unstable_wrapCallback=function(Je){var rt=q;return function(){var Et=q;q=rt;try{return Je.apply(this,arguments)}finally{q=Et}}}})(A2);P2.exports=A2;var p6=P2.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var m6=Rt,Ro=p6;function ut(e){for(var r="https://reactjs.org/docs/error-decoder.html?invariant="+e,o=1;o<arguments.length;o++)r+="&args[]="+encodeURIComponent(arguments[o]);return"Minified React error #"+e+"; visit "+r+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var M2=new Set,Pm={};function dd(e,r){Nf(e,r),Nf(e+"Capture",r)}function Nf(e,r){for(Pm[e]=r,e=0;e<r.length;e++)M2.add(r[e])}var zu=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),fv=Object.prototype.hasOwnProperty,g6=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Ow={},Fw={};function _6(e){return fv.call(Fw,e)?!0:fv.call(Ow,e)?!1:g6.test(e)?Fw[e]=!0:(Ow[e]=!0,!1)}function y6(e,r,o,h){if(o!==null&&o.type===0)return!1;switch(typeof r){case"function":case"symbol":return!0;case"boolean":return h?!1:o!==null?!o.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function v6(e,r,o,h){if(r===null||typeof r>"u"||y6(e,r,o,h))return!0;if(h)return!1;if(o!==null)switch(o.type){case 3:return!r;case 4:return r===!1;case 5:return isNaN(r);case 6:return isNaN(r)||1>r}return!1}function Ks(e,r,o,h,_,b,w){this.acceptsBooleans=r===2||r===3||r===4,this.attributeName=h,this.attributeNamespace=_,this.mustUseProperty=o,this.propertyName=e,this.type=r,this.sanitizeURL=b,this.removeEmptyString=w}var as={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){as[e]=new Ks(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var r=e[0];as[r]=new Ks(r,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){as[e]=new Ks(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){as[e]=new Ks(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){as[e]=new Ks(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){as[e]=new Ks(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){as[e]=new Ks(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){as[e]=new Ks(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){as[e]=new Ks(e,5,!1,e.toLowerCase(),null,!1,!1)});var wx=/[\-:]([a-z])/g;function bx(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var r=e.replace(wx,bx);as[r]=new Ks(r,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var r=e.replace(wx,bx);as[r]=new Ks(r,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var r=e.replace(wx,bx);as[r]=new Ks(r,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){as[e]=new Ks(e,1,!1,e.toLowerCase(),null,!1,!1)});as.xlinkHref=new Ks("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){as[e]=new Ks(e,1,!1,e.toLowerCase(),null,!0,!0)});function Sx(e,r,o,h){var _=as.hasOwnProperty(r)?as[r]:null;(_!==null?_.type!==0:h||!(2<r.length)||r[0]!=="o"&&r[0]!=="O"||r[1]!=="n"&&r[1]!=="N")&&(v6(r,o,_,h)&&(o=null),h||_===null?_6(r)&&(o===null?e.removeAttribute(r):e.setAttribute(r,""+o)):_.mustUseProperty?e[_.propertyName]=o===null?_.type===3?!1:"":o:(r=_.attributeName,h=_.attributeNamespace,o===null?e.removeAttribute(r):(_=_.type,o=_===3||_===4&&o===!0?"":""+o,h?e.setAttributeNS(h,r,o):e.setAttribute(r,o))))}var Fu=m6.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,x_=Symbol.for("react.element"),vf=Symbol.for("react.portal"),xf=Symbol.for("react.fragment"),Tx=Symbol.for("react.strict_mode"),pv=Symbol.for("react.profiler"),z2=Symbol.for("react.provider"),D2=Symbol.for("react.context"),Ex=Symbol.for("react.forward_ref"),mv=Symbol.for("react.suspense"),gv=Symbol.for("react.suspense_list"),Cx=Symbol.for("react.memo"),Cc=Symbol.for("react.lazy"),R2=Symbol.for("react.offscreen"),Bw=Symbol.iterator;function om(e){return e===null||typeof e!="object"?null:(e=Bw&&e[Bw]||e["@@iterator"],typeof e=="function"?e:null)}var Wr=Object.assign,T1;function mm(e){if(T1===void 0)try{throw Error()}catch(o){var r=o.stack.trim().match(/\n( *(at )?)/);T1=r&&r[1]||""}return`
`+T1+e}var E1=!1;function C1(e,r){if(!e||E1)return"";E1=!0;var o=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(r)if(r=function(){throw Error()},Object.defineProperty(r.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(r,[])}catch(U){var h=U}Reflect.construct(e,[],r)}else{try{r.call()}catch(U){h=U}e.call(r.prototype)}else{try{throw Error()}catch(U){h=U}e()}}catch(U){if(U&&h&&typeof U.stack=="string"){for(var _=U.stack.split(`
`),b=h.stack.split(`
`),w=_.length-1,c=b.length-1;1<=w&&0<=c&&_[w]!==b[c];)c--;for(;1<=w&&0<=c;w--,c--)if(_[w]!==b[c]){if(w!==1||c!==1)do if(w--,c--,0>c||_[w]!==b[c]){var D=`
`+_[w].replace(" at new "," at ");return e.displayName&&D.includes("<anonymous>")&&(D=D.replace("<anonymous>",e.displayName)),D}while(1<=w&&0<=c);break}}}finally{E1=!1,Error.prepareStackTrace=o}return(e=e?e.displayName||e.name:"")?mm(e):""}function x6(e){switch(e.tag){case 5:return mm(e.type);case 16:return mm("Lazy");case 13:return mm("Suspense");case 19:return mm("SuspenseList");case 0:case 2:case 15:return e=C1(e.type,!1),e;case 11:return e=C1(e.type.render,!1),e;case 1:return e=C1(e.type,!0),e;default:return""}}function _v(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case xf:return"Fragment";case vf:return"Portal";case pv:return"Profiler";case Tx:return"StrictMode";case mv:return"Suspense";case gv:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case D2:return(e.displayName||"Context")+".Consumer";case z2:return(e._context.displayName||"Context")+".Provider";case Ex:var r=e.render;return e=e.displayName,e||(e=r.displayName||r.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Cx:return r=e.displayName||null,r!==null?r:_v(e.type)||"Memo";case Cc:r=e._payload,e=e._init;try{return _v(e(r))}catch{}}return null}function w6(e){var r=e.type;switch(e.tag){case 24:return"Cache";case 9:return(r.displayName||"Context")+".Consumer";case 10:return(r._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=r.render,e=e.displayName||e.name||"",r.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return r;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return _v(r);case 8:return r===Tx?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof r=="function")return r.displayName||r.name||null;if(typeof r=="string")return r}return null}function Uc(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function L2(e){var r=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(r==="checkbox"||r==="radio")}function b6(e){var r=L2(e)?"checked":"value",o=Object.getOwnPropertyDescriptor(e.constructor.prototype,r),h=""+e[r];if(!e.hasOwnProperty(r)&&typeof o<"u"&&typeof o.get=="function"&&typeof o.set=="function"){var _=o.get,b=o.set;return Object.defineProperty(e,r,{configurable:!0,get:function(){return _.call(this)},set:function(w){h=""+w,b.call(this,w)}}),Object.defineProperty(e,r,{enumerable:o.enumerable}),{getValue:function(){return h},setValue:function(w){h=""+w},stopTracking:function(){e._valueTracker=null,delete e[r]}}}}function w_(e){e._valueTracker||(e._valueTracker=b6(e))}function O2(e){if(!e)return!1;var r=e._valueTracker;if(!r)return!0;var o=r.getValue(),h="";return e&&(h=L2(e)?e.checked?"true":"false":e.value),e=h,e!==o?(r.setValue(e),!0):!1}function e0(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function yv(e,r){var o=r.checked;return Wr({},r,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:o??e._wrapperState.initialChecked})}function Nw(e,r){var o=r.defaultValue==null?"":r.defaultValue,h=r.checked!=null?r.checked:r.defaultChecked;o=Uc(r.value!=null?r.value:o),e._wrapperState={initialChecked:h,initialValue:o,controlled:r.type==="checkbox"||r.type==="radio"?r.checked!=null:r.value!=null}}function F2(e,r){r=r.checked,r!=null&&Sx(e,"checked",r,!1)}function vv(e,r){F2(e,r);var o=Uc(r.value),h=r.type;if(o!=null)h==="number"?(o===0&&e.value===""||e.value!=o)&&(e.value=""+o):e.value!==""+o&&(e.value=""+o);else if(h==="submit"||h==="reset"){e.removeAttribute("value");return}r.hasOwnProperty("value")?xv(e,r.type,o):r.hasOwnProperty("defaultValue")&&xv(e,r.type,Uc(r.defaultValue)),r.checked==null&&r.defaultChecked!=null&&(e.defaultChecked=!!r.defaultChecked)}function Uw(e,r,o){if(r.hasOwnProperty("value")||r.hasOwnProperty("defaultValue")){var h=r.type;if(!(h!=="submit"&&h!=="reset"||r.value!==void 0&&r.value!==null))return;r=""+e._wrapperState.initialValue,o||r===e.value||(e.value=r),e.defaultValue=r}o=e.name,o!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,o!==""&&(e.name=o)}function xv(e,r,o){(r!=="number"||e0(e.ownerDocument)!==e)&&(o==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+o&&(e.defaultValue=""+o))}var gm=Array.isArray;function zf(e,r,o,h){if(e=e.options,r){r={};for(var _=0;_<o.length;_++)r["$"+o[_]]=!0;for(o=0;o<e.length;o++)_=r.hasOwnProperty("$"+e[o].value),e[o].selected!==_&&(e[o].selected=_),_&&h&&(e[o].defaultSelected=!0)}else{for(o=""+Uc(o),r=null,_=0;_<e.length;_++){if(e[_].value===o){e[_].selected=!0,h&&(e[_].defaultSelected=!0);return}r!==null||e[_].disabled||(r=e[_])}r!==null&&(r.selected=!0)}}function wv(e,r){if(r.dangerouslySetInnerHTML!=null)throw Error(ut(91));return Wr({},r,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function jw(e,r){var o=r.value;if(o==null){if(o=r.children,r=r.defaultValue,o!=null){if(r!=null)throw Error(ut(92));if(gm(o)){if(1<o.length)throw Error(ut(93));o=o[0]}r=o}r==null&&(r=""),o=r}e._wrapperState={initialValue:Uc(o)}}function B2(e,r){var o=Uc(r.value),h=Uc(r.defaultValue);o!=null&&(o=""+o,o!==e.value&&(e.value=o),r.defaultValue==null&&e.defaultValue!==o&&(e.defaultValue=o)),h!=null&&(e.defaultValue=""+h)}function $w(e){var r=e.textContent;r===e._wrapperState.initialValue&&r!==""&&r!==null&&(e.value=r)}function N2(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function bv(e,r){return e==null||e==="http://www.w3.org/1999/xhtml"?N2(r):e==="http://www.w3.org/2000/svg"&&r==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var b_,U2=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(r,o,h,_){MSApp.execUnsafeLocalFunction(function(){return e(r,o,h,_)})}:e}(function(e,r){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=r;else{for(b_=b_||document.createElement("div"),b_.innerHTML="<svg>"+r.valueOf().toString()+"</svg>",r=b_.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;r.firstChild;)e.appendChild(r.firstChild)}});function Am(e,r){if(r){var o=e.firstChild;if(o&&o===e.lastChild&&o.nodeType===3){o.nodeValue=r;return}}e.textContent=r}var xm={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},S6=["Webkit","ms","Moz","O"];Object.keys(xm).forEach(function(e){S6.forEach(function(r){r=r+e.charAt(0).toUpperCase()+e.substring(1),xm[r]=xm[e]})});function j2(e,r,o){return r==null||typeof r=="boolean"||r===""?"":o||typeof r!="number"||r===0||xm.hasOwnProperty(e)&&xm[e]?(""+r).trim():r+"px"}function $2(e,r){e=e.style;for(var o in r)if(r.hasOwnProperty(o)){var h=o.indexOf("--")===0,_=j2(o,r[o],h);o==="float"&&(o="cssFloat"),h?e.setProperty(o,_):e[o]=_}}var T6=Wr({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Sv(e,r){if(r){if(T6[e]&&(r.children!=null||r.dangerouslySetInnerHTML!=null))throw Error(ut(137,e));if(r.dangerouslySetInnerHTML!=null){if(r.children!=null)throw Error(ut(60));if(typeof r.dangerouslySetInnerHTML!="object"||!("__html"in r.dangerouslySetInnerHTML))throw Error(ut(61))}if(r.style!=null&&typeof r.style!="object")throw Error(ut(62))}}function Tv(e,r){if(e.indexOf("-")===-1)return typeof r.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ev=null;function Ix(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Cv=null,Df=null,Rf=null;function Vw(e){if(e=Jm(e)){if(typeof Cv!="function")throw Error(ut(280));var r=e.stateNode;r&&(r=q0(r),Cv(e.stateNode,e.type,r))}}function V2(e){Df?Rf?Rf.push(e):Rf=[e]:Df=e}function q2(){if(Df){var e=Df,r=Rf;if(Rf=Df=null,Vw(e),r)for(e=0;e<r.length;e++)Vw(r[e])}}function Z2(e,r){return e(r)}function G2(){}var I1=!1;function W2(e,r,o){if(I1)return e(r,o);I1=!0;try{return Z2(e,r,o)}finally{I1=!1,(Df!==null||Rf!==null)&&(G2(),q2())}}function Mm(e,r){var o=e.stateNode;if(o===null)return null;var h=q0(o);if(h===null)return null;o=h[r];e:switch(r){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(h=!h.disabled)||(e=e.type,h=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!h;break e;default:e=!1}if(e)return null;if(o&&typeof o!="function")throw Error(ut(231,r,typeof o));return o}var Iv=!1;if(zu)try{var am={};Object.defineProperty(am,"passive",{get:function(){Iv=!0}}),window.addEventListener("test",am,am),window.removeEventListener("test",am,am)}catch{Iv=!1}function E6(e,r,o,h,_,b,w,c,D){var U=Array.prototype.slice.call(arguments,3);try{r.apply(o,U)}catch(J){this.onError(J)}}var wm=!1,t0=null,n0=!1,kv=null,C6={onError:function(e){wm=!0,t0=e}};function I6(e,r,o,h,_,b,w,c,D){wm=!1,t0=null,E6.apply(C6,arguments)}function k6(e,r,o,h,_,b,w,c,D){if(I6.apply(this,arguments),wm){if(wm){var U=t0;wm=!1,t0=null}else throw Error(ut(198));n0||(n0=!0,kv=U)}}function fd(e){var r=e,o=e;if(e.alternate)for(;r.return;)r=r.return;else{e=r;do r=e,r.flags&4098&&(o=r.return),e=r.return;while(e)}return r.tag===3?o:null}function H2(e){if(e.tag===13){var r=e.memoizedState;if(r===null&&(e=e.alternate,e!==null&&(r=e.memoizedState)),r!==null)return r.dehydrated}return null}function qw(e){if(fd(e)!==e)throw Error(ut(188))}function P6(e){var r=e.alternate;if(!r){if(r=fd(e),r===null)throw Error(ut(188));return r!==e?null:e}for(var o=e,h=r;;){var _=o.return;if(_===null)break;var b=_.alternate;if(b===null){if(h=_.return,h!==null){o=h;continue}break}if(_.child===b.child){for(b=_.child;b;){if(b===o)return qw(_),e;if(b===h)return qw(_),r;b=b.sibling}throw Error(ut(188))}if(o.return!==h.return)o=_,h=b;else{for(var w=!1,c=_.child;c;){if(c===o){w=!0,o=_,h=b;break}if(c===h){w=!0,h=_,o=b;break}c=c.sibling}if(!w){for(c=b.child;c;){if(c===o){w=!0,o=b,h=_;break}if(c===h){w=!0,h=b,o=_;break}c=c.sibling}if(!w)throw Error(ut(189))}}if(o.alternate!==h)throw Error(ut(190))}if(o.tag!==3)throw Error(ut(188));return o.stateNode.current===o?e:r}function X2(e){return e=P6(e),e!==null?K2(e):null}function K2(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var r=K2(e);if(r!==null)return r;e=e.sibling}return null}var Y2=Ro.unstable_scheduleCallback,Zw=Ro.unstable_cancelCallback,A6=Ro.unstable_shouldYield,M6=Ro.unstable_requestPaint,ci=Ro.unstable_now,z6=Ro.unstable_getCurrentPriorityLevel,kx=Ro.unstable_ImmediatePriority,J2=Ro.unstable_UserBlockingPriority,r0=Ro.unstable_NormalPriority,D6=Ro.unstable_LowPriority,Q2=Ro.unstable_IdlePriority,U0=null,Fl=null;function R6(e){if(Fl&&typeof Fl.onCommitFiberRoot=="function")try{Fl.onCommitFiberRoot(U0,e,void 0,(e.current.flags&128)===128)}catch{}}var Xa=Math.clz32?Math.clz32:F6,L6=Math.log,O6=Math.LN2;function F6(e){return e>>>=0,e===0?32:31-(L6(e)/O6|0)|0}var S_=64,T_=4194304;function _m(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function i0(e,r){var o=e.pendingLanes;if(o===0)return 0;var h=0,_=e.suspendedLanes,b=e.pingedLanes,w=o&268435455;if(w!==0){var c=w&~_;c!==0?h=_m(c):(b&=w,b!==0&&(h=_m(b)))}else w=o&~_,w!==0?h=_m(w):b!==0&&(h=_m(b));if(h===0)return 0;if(r!==0&&r!==h&&!(r&_)&&(_=h&-h,b=r&-r,_>=b||_===16&&(b&4194240)!==0))return r;if(h&4&&(h|=o&16),r=e.entangledLanes,r!==0)for(e=e.entanglements,r&=h;0<r;)o=31-Xa(r),_=1<<o,h|=e[o],r&=~_;return h}function B6(e,r){switch(e){case 1:case 2:case 4:return r+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return r+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function N6(e,r){for(var o=e.suspendedLanes,h=e.pingedLanes,_=e.expirationTimes,b=e.pendingLanes;0<b;){var w=31-Xa(b),c=1<<w,D=_[w];D===-1?(!(c&o)||c&h)&&(_[w]=B6(c,r)):D<=r&&(e.expiredLanes|=c),b&=~c}}function Pv(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function e3(){var e=S_;return S_<<=1,!(S_&4194240)&&(S_=64),e}function k1(e){for(var r=[],o=0;31>o;o++)r.push(e);return r}function Km(e,r,o){e.pendingLanes|=r,r!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,r=31-Xa(r),e[r]=o}function U6(e,r){var o=e.pendingLanes&~r;e.pendingLanes=r,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=r,e.mutableReadLanes&=r,e.entangledLanes&=r,r=e.entanglements;var h=e.eventTimes;for(e=e.expirationTimes;0<o;){var _=31-Xa(o),b=1<<_;r[_]=0,h[_]=-1,e[_]=-1,o&=~b}}function Px(e,r){var o=e.entangledLanes|=r;for(e=e.entanglements;o;){var h=31-Xa(o),_=1<<h;_&r|e[h]&r&&(e[h]|=r),o&=~_}}var hr=0;function t3(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var n3,Ax,r3,i3,s3,Av=!1,E_=[],zc=null,Dc=null,Rc=null,zm=new Map,Dm=new Map,kc=[],j6="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Gw(e,r){switch(e){case"focusin":case"focusout":zc=null;break;case"dragenter":case"dragleave":Dc=null;break;case"mouseover":case"mouseout":Rc=null;break;case"pointerover":case"pointerout":zm.delete(r.pointerId);break;case"gotpointercapture":case"lostpointercapture":Dm.delete(r.pointerId)}}function lm(e,r,o,h,_,b){return e===null||e.nativeEvent!==b?(e={blockedOn:r,domEventName:o,eventSystemFlags:h,nativeEvent:b,targetContainers:[_]},r!==null&&(r=Jm(r),r!==null&&Ax(r)),e):(e.eventSystemFlags|=h,r=e.targetContainers,_!==null&&r.indexOf(_)===-1&&r.push(_),e)}function $6(e,r,o,h,_){switch(r){case"focusin":return zc=lm(zc,e,r,o,h,_),!0;case"dragenter":return Dc=lm(Dc,e,r,o,h,_),!0;case"mouseover":return Rc=lm(Rc,e,r,o,h,_),!0;case"pointerover":var b=_.pointerId;return zm.set(b,lm(zm.get(b)||null,e,r,o,h,_)),!0;case"gotpointercapture":return b=_.pointerId,Dm.set(b,lm(Dm.get(b)||null,e,r,o,h,_)),!0}return!1}function o3(e){var r=Jh(e.target);if(r!==null){var o=fd(r);if(o!==null){if(r=o.tag,r===13){if(r=H2(o),r!==null){e.blockedOn=r,s3(e.priority,function(){r3(o)});return}}else if(r===3&&o.stateNode.current.memoizedState.isDehydrated){e.blockedOn=o.tag===3?o.stateNode.containerInfo:null;return}}}e.blockedOn=null}function V_(e){if(e.blockedOn!==null)return!1;for(var r=e.targetContainers;0<r.length;){var o=Mv(e.domEventName,e.eventSystemFlags,r[0],e.nativeEvent);if(o===null){o=e.nativeEvent;var h=new o.constructor(o.type,o);Ev=h,o.target.dispatchEvent(h),Ev=null}else return r=Jm(o),r!==null&&Ax(r),e.blockedOn=o,!1;r.shift()}return!0}function Ww(e,r,o){V_(e)&&o.delete(r)}function V6(){Av=!1,zc!==null&&V_(zc)&&(zc=null),Dc!==null&&V_(Dc)&&(Dc=null),Rc!==null&&V_(Rc)&&(Rc=null),zm.forEach(Ww),Dm.forEach(Ww)}function um(e,r){e.blockedOn===r&&(e.blockedOn=null,Av||(Av=!0,Ro.unstable_scheduleCallback(Ro.unstable_NormalPriority,V6)))}function Rm(e){function r(_){return um(_,e)}if(0<E_.length){um(E_[0],e);for(var o=1;o<E_.length;o++){var h=E_[o];h.blockedOn===e&&(h.blockedOn=null)}}for(zc!==null&&um(zc,e),Dc!==null&&um(Dc,e),Rc!==null&&um(Rc,e),zm.forEach(r),Dm.forEach(r),o=0;o<kc.length;o++)h=kc[o],h.blockedOn===e&&(h.blockedOn=null);for(;0<kc.length&&(o=kc[0],o.blockedOn===null);)o3(o),o.blockedOn===null&&kc.shift()}var Lf=Fu.ReactCurrentBatchConfig,s0=!0;function q6(e,r,o,h){var _=hr,b=Lf.transition;Lf.transition=null;try{hr=1,Mx(e,r,o,h)}finally{hr=_,Lf.transition=b}}function Z6(e,r,o,h){var _=hr,b=Lf.transition;Lf.transition=null;try{hr=4,Mx(e,r,o,h)}finally{hr=_,Lf.transition=b}}function Mx(e,r,o,h){if(s0){var _=Mv(e,r,o,h);if(_===null)B1(e,r,h,o0,o),Gw(e,h);else if($6(_,e,r,o,h))h.stopPropagation();else if(Gw(e,h),r&4&&-1<j6.indexOf(e)){for(;_!==null;){var b=Jm(_);if(b!==null&&n3(b),b=Mv(e,r,o,h),b===null&&B1(e,r,h,o0,o),b===_)break;_=b}_!==null&&h.stopPropagation()}else B1(e,r,h,null,o)}}var o0=null;function Mv(e,r,o,h){if(o0=null,e=Ix(h),e=Jh(e),e!==null)if(r=fd(e),r===null)e=null;else if(o=r.tag,o===13){if(e=H2(r),e!==null)return e;e=null}else if(o===3){if(r.stateNode.current.memoizedState.isDehydrated)return r.tag===3?r.stateNode.containerInfo:null;e=null}else r!==e&&(e=null);return o0=e,null}function a3(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(z6()){case kx:return 1;case J2:return 4;case r0:case D6:return 16;case Q2:return 536870912;default:return 16}default:return 16}}var Ac=null,zx=null,q_=null;function l3(){if(q_)return q_;var e,r=zx,o=r.length,h,_="value"in Ac?Ac.value:Ac.textContent,b=_.length;for(e=0;e<o&&r[e]===_[e];e++);var w=o-e;for(h=1;h<=w&&r[o-h]===_[b-h];h++);return q_=_.slice(e,1<h?1-h:void 0)}function Z_(e){var r=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&r===13&&(e=13)):e=r,e===10&&(e=13),32<=e||e===13?e:0}function C_(){return!0}function Hw(){return!1}function Bo(e){function r(o,h,_,b,w){this._reactName=o,this._targetInst=_,this.type=h,this.nativeEvent=b,this.target=w,this.currentTarget=null;for(var c in e)e.hasOwnProperty(c)&&(o=e[c],this[c]=o?o(b):b[c]);return this.isDefaultPrevented=(b.defaultPrevented!=null?b.defaultPrevented:b.returnValue===!1)?C_:Hw,this.isPropagationStopped=Hw,this}return Wr(r.prototype,{preventDefault:function(){this.defaultPrevented=!0;var o=this.nativeEvent;o&&(o.preventDefault?o.preventDefault():typeof o.returnValue!="unknown"&&(o.returnValue=!1),this.isDefaultPrevented=C_)},stopPropagation:function(){var o=this.nativeEvent;o&&(o.stopPropagation?o.stopPropagation():typeof o.cancelBubble!="unknown"&&(o.cancelBubble=!0),this.isPropagationStopped=C_)},persist:function(){},isPersistent:C_}),r}var Kf={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Dx=Bo(Kf),Ym=Wr({},Kf,{view:0,detail:0}),G6=Bo(Ym),P1,A1,cm,j0=Wr({},Ym,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Rx,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==cm&&(cm&&e.type==="mousemove"?(P1=e.screenX-cm.screenX,A1=e.screenY-cm.screenY):A1=P1=0,cm=e),P1)},movementY:function(e){return"movementY"in e?e.movementY:A1}}),Xw=Bo(j0),W6=Wr({},j0,{dataTransfer:0}),H6=Bo(W6),X6=Wr({},Ym,{relatedTarget:0}),M1=Bo(X6),K6=Wr({},Kf,{animationName:0,elapsedTime:0,pseudoElement:0}),Y6=Bo(K6),J6=Wr({},Kf,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Q6=Bo(J6),eT=Wr({},Kf,{data:0}),Kw=Bo(eT),tT={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},nT={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},rT={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function iT(e){var r=this.nativeEvent;return r.getModifierState?r.getModifierState(e):(e=rT[e])?!!r[e]:!1}function Rx(){return iT}var sT=Wr({},Ym,{key:function(e){if(e.key){var r=tT[e.key]||e.key;if(r!=="Unidentified")return r}return e.type==="keypress"?(e=Z_(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?nT[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Rx,charCode:function(e){return e.type==="keypress"?Z_(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Z_(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),oT=Bo(sT),aT=Wr({},j0,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Yw=Bo(aT),lT=Wr({},Ym,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Rx}),uT=Bo(lT),cT=Wr({},Kf,{propertyName:0,elapsedTime:0,pseudoElement:0}),hT=Bo(cT),dT=Wr({},j0,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),fT=Bo(dT),pT=[9,13,27,32],Lx=zu&&"CompositionEvent"in window,bm=null;zu&&"documentMode"in document&&(bm=document.documentMode);var mT=zu&&"TextEvent"in window&&!bm,u3=zu&&(!Lx||bm&&8<bm&&11>=bm),Jw=" ",Qw=!1;function c3(e,r){switch(e){case"keyup":return pT.indexOf(r.keyCode)!==-1;case"keydown":return r.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function h3(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var wf=!1;function gT(e,r){switch(e){case"compositionend":return h3(r);case"keypress":return r.which!==32?null:(Qw=!0,Jw);case"textInput":return e=r.data,e===Jw&&Qw?null:e;default:return null}}function _T(e,r){if(wf)return e==="compositionend"||!Lx&&c3(e,r)?(e=l3(),q_=zx=Ac=null,wf=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(r.ctrlKey||r.altKey||r.metaKey)||r.ctrlKey&&r.altKey){if(r.char&&1<r.char.length)return r.char;if(r.which)return String.fromCharCode(r.which)}return null;case"compositionend":return u3&&r.locale!=="ko"?null:r.data;default:return null}}var yT={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function eb(e){var r=e&&e.nodeName&&e.nodeName.toLowerCase();return r==="input"?!!yT[e.type]:r==="textarea"}function d3(e,r,o,h){V2(h),r=a0(r,"onChange"),0<r.length&&(o=new Dx("onChange","change",null,o,h),e.push({event:o,listeners:r}))}var Sm=null,Lm=null;function vT(e){S3(e,0)}function $0(e){var r=Tf(e);if(O2(r))return e}function xT(e,r){if(e==="change")return r}var f3=!1;if(zu){var z1;if(zu){var D1="oninput"in document;if(!D1){var tb=document.createElement("div");tb.setAttribute("oninput","return;"),D1=typeof tb.oninput=="function"}z1=D1}else z1=!1;f3=z1&&(!document.documentMode||9<document.documentMode)}function nb(){Sm&&(Sm.detachEvent("onpropertychange",p3),Lm=Sm=null)}function p3(e){if(e.propertyName==="value"&&$0(Lm)){var r=[];d3(r,Lm,e,Ix(e)),W2(vT,r)}}function wT(e,r,o){e==="focusin"?(nb(),Sm=r,Lm=o,Sm.attachEvent("onpropertychange",p3)):e==="focusout"&&nb()}function bT(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return $0(Lm)}function ST(e,r){if(e==="click")return $0(r)}function TT(e,r){if(e==="input"||e==="change")return $0(r)}function ET(e,r){return e===r&&(e!==0||1/e===1/r)||e!==e&&r!==r}var Ja=typeof Object.is=="function"?Object.is:ET;function Om(e,r){if(Ja(e,r))return!0;if(typeof e!="object"||e===null||typeof r!="object"||r===null)return!1;var o=Object.keys(e),h=Object.keys(r);if(o.length!==h.length)return!1;for(h=0;h<o.length;h++){var _=o[h];if(!fv.call(r,_)||!Ja(e[_],r[_]))return!1}return!0}function rb(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function ib(e,r){var o=rb(e);e=0;for(var h;o;){if(o.nodeType===3){if(h=e+o.textContent.length,e<=r&&h>=r)return{node:o,offset:r-e};e=h}e:{for(;o;){if(o.nextSibling){o=o.nextSibling;break e}o=o.parentNode}o=void 0}o=rb(o)}}function m3(e,r){return e&&r?e===r?!0:e&&e.nodeType===3?!1:r&&r.nodeType===3?m3(e,r.parentNode):"contains"in e?e.contains(r):e.compareDocumentPosition?!!(e.compareDocumentPosition(r)&16):!1:!1}function g3(){for(var e=window,r=e0();r instanceof e.HTMLIFrameElement;){try{var o=typeof r.contentWindow.location.href=="string"}catch{o=!1}if(o)e=r.contentWindow;else break;r=e0(e.document)}return r}function Ox(e){var r=e&&e.nodeName&&e.nodeName.toLowerCase();return r&&(r==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||r==="textarea"||e.contentEditable==="true")}function CT(e){var r=g3(),o=e.focusedElem,h=e.selectionRange;if(r!==o&&o&&o.ownerDocument&&m3(o.ownerDocument.documentElement,o)){if(h!==null&&Ox(o)){if(r=h.start,e=h.end,e===void 0&&(e=r),"selectionStart"in o)o.selectionStart=r,o.selectionEnd=Math.min(e,o.value.length);else if(e=(r=o.ownerDocument||document)&&r.defaultView||window,e.getSelection){e=e.getSelection();var _=o.textContent.length,b=Math.min(h.start,_);h=h.end===void 0?b:Math.min(h.end,_),!e.extend&&b>h&&(_=h,h=b,b=_),_=ib(o,b);var w=ib(o,h);_&&w&&(e.rangeCount!==1||e.anchorNode!==_.node||e.anchorOffset!==_.offset||e.focusNode!==w.node||e.focusOffset!==w.offset)&&(r=r.createRange(),r.setStart(_.node,_.offset),e.removeAllRanges(),b>h?(e.addRange(r),e.extend(w.node,w.offset)):(r.setEnd(w.node,w.offset),e.addRange(r)))}}for(r=[],e=o;e=e.parentNode;)e.nodeType===1&&r.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof o.focus=="function"&&o.focus(),o=0;o<r.length;o++)e=r[o],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var IT=zu&&"documentMode"in document&&11>=document.documentMode,bf=null,zv=null,Tm=null,Dv=!1;function sb(e,r,o){var h=o.window===o?o.document:o.nodeType===9?o:o.ownerDocument;Dv||bf==null||bf!==e0(h)||(h=bf,"selectionStart"in h&&Ox(h)?h={start:h.selectionStart,end:h.selectionEnd}:(h=(h.ownerDocument&&h.ownerDocument.defaultView||window).getSelection(),h={anchorNode:h.anchorNode,anchorOffset:h.anchorOffset,focusNode:h.focusNode,focusOffset:h.focusOffset}),Tm&&Om(Tm,h)||(Tm=h,h=a0(zv,"onSelect"),0<h.length&&(r=new Dx("onSelect","select",null,r,o),e.push({event:r,listeners:h}),r.target=bf)))}function I_(e,r){var o={};return o[e.toLowerCase()]=r.toLowerCase(),o["Webkit"+e]="webkit"+r,o["Moz"+e]="moz"+r,o}var Sf={animationend:I_("Animation","AnimationEnd"),animationiteration:I_("Animation","AnimationIteration"),animationstart:I_("Animation","AnimationStart"),transitionend:I_("Transition","TransitionEnd")},R1={},_3={};zu&&(_3=document.createElement("div").style,"AnimationEvent"in window||(delete Sf.animationend.animation,delete Sf.animationiteration.animation,delete Sf.animationstart.animation),"TransitionEvent"in window||delete Sf.transitionend.transition);function V0(e){if(R1[e])return R1[e];if(!Sf[e])return e;var r=Sf[e],o;for(o in r)if(r.hasOwnProperty(o)&&o in _3)return R1[e]=r[o];return e}var y3=V0("animationend"),v3=V0("animationiteration"),x3=V0("animationstart"),w3=V0("transitionend"),b3=new Map,ob="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Vc(e,r){b3.set(e,r),dd(r,[e])}for(var L1=0;L1<ob.length;L1++){var O1=ob[L1],kT=O1.toLowerCase(),PT=O1[0].toUpperCase()+O1.slice(1);Vc(kT,"on"+PT)}Vc(y3,"onAnimationEnd");Vc(v3,"onAnimationIteration");Vc(x3,"onAnimationStart");Vc("dblclick","onDoubleClick");Vc("focusin","onFocus");Vc("focusout","onBlur");Vc(w3,"onTransitionEnd");Nf("onMouseEnter",["mouseout","mouseover"]);Nf("onMouseLeave",["mouseout","mouseover"]);Nf("onPointerEnter",["pointerout","pointerover"]);Nf("onPointerLeave",["pointerout","pointerover"]);dd("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));dd("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));dd("onBeforeInput",["compositionend","keypress","textInput","paste"]);dd("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));dd("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));dd("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ym="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),AT=new Set("cancel close invalid load scroll toggle".split(" ").concat(ym));function ab(e,r,o){var h=e.type||"unknown-event";e.currentTarget=o,k6(h,r,void 0,e),e.currentTarget=null}function S3(e,r){r=(r&4)!==0;for(var o=0;o<e.length;o++){var h=e[o],_=h.event;h=h.listeners;e:{var b=void 0;if(r)for(var w=h.length-1;0<=w;w--){var c=h[w],D=c.instance,U=c.currentTarget;if(c=c.listener,D!==b&&_.isPropagationStopped())break e;ab(_,c,U),b=D}else for(w=0;w<h.length;w++){if(c=h[w],D=c.instance,U=c.currentTarget,c=c.listener,D!==b&&_.isPropagationStopped())break e;ab(_,c,U),b=D}}}if(n0)throw e=kv,n0=!1,kv=null,e}function Dr(e,r){var o=r[Bv];o===void 0&&(o=r[Bv]=new Set);var h=e+"__bubble";o.has(h)||(T3(r,e,2,!1),o.add(h))}function F1(e,r,o){var h=0;r&&(h|=4),T3(o,e,h,r)}var k_="_reactListening"+Math.random().toString(36).slice(2);function Fm(e){if(!e[k_]){e[k_]=!0,M2.forEach(function(o){o!=="selectionchange"&&(AT.has(o)||F1(o,!1,e),F1(o,!0,e))});var r=e.nodeType===9?e:e.ownerDocument;r===null||r[k_]||(r[k_]=!0,F1("selectionchange",!1,r))}}function T3(e,r,o,h){switch(a3(r)){case 1:var _=q6;break;case 4:_=Z6;break;default:_=Mx}o=_.bind(null,r,o,e),_=void 0,!Iv||r!=="touchstart"&&r!=="touchmove"&&r!=="wheel"||(_=!0),h?_!==void 0?e.addEventListener(r,o,{capture:!0,passive:_}):e.addEventListener(r,o,!0):_!==void 0?e.addEventListener(r,o,{passive:_}):e.addEventListener(r,o,!1)}function B1(e,r,o,h,_){var b=h;if(!(r&1)&&!(r&2)&&h!==null)e:for(;;){if(h===null)return;var w=h.tag;if(w===3||w===4){var c=h.stateNode.containerInfo;if(c===_||c.nodeType===8&&c.parentNode===_)break;if(w===4)for(w=h.return;w!==null;){var D=w.tag;if((D===3||D===4)&&(D=w.stateNode.containerInfo,D===_||D.nodeType===8&&D.parentNode===_))return;w=w.return}for(;c!==null;){if(w=Jh(c),w===null)return;if(D=w.tag,D===5||D===6){h=b=w;continue e}c=c.parentNode}}h=h.return}W2(function(){var U=b,J=Ix(o),W=[];e:{var q=b3.get(e);if(q!==void 0){var Ee=Dx,ze=e;switch(e){case"keypress":if(Z_(o)===0)break e;case"keydown":case"keyup":Ee=oT;break;case"focusin":ze="focus",Ee=M1;break;case"focusout":ze="blur",Ee=M1;break;case"beforeblur":case"afterblur":Ee=M1;break;case"click":if(o.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Ee=Xw;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Ee=H6;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Ee=uT;break;case y3:case v3:case x3:Ee=Y6;break;case w3:Ee=hT;break;case"scroll":Ee=G6;break;case"wheel":Ee=fT;break;case"copy":case"cut":case"paste":Ee=Q6;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Ee=Yw}var Ne=(r&4)!==0,Be=!Ne&&e==="scroll",se=Ne?q!==null?q+"Capture":null:q;Ne=[];for(var ue=U,he;ue!==null;){he=ue;var De=he.stateNode;if(he.tag===5&&De!==null&&(he=De,se!==null&&(De=Mm(ue,se),De!=null&&Ne.push(Bm(ue,De,he)))),Be)break;ue=ue.return}0<Ne.length&&(q=new Ee(q,ze,null,o,J),W.push({event:q,listeners:Ne}))}}if(!(r&7)){e:{if(q=e==="mouseover"||e==="pointerover",Ee=e==="mouseout"||e==="pointerout",q&&o!==Ev&&(ze=o.relatedTarget||o.fromElement)&&(Jh(ze)||ze[Du]))break e;if((Ee||q)&&(q=J.window===J?J:(q=J.ownerDocument)?q.defaultView||q.parentWindow:window,Ee?(ze=o.relatedTarget||o.toElement,Ee=U,ze=ze?Jh(ze):null,ze!==null&&(Be=fd(ze),ze!==Be||ze.tag!==5&&ze.tag!==6)&&(ze=null)):(Ee=null,ze=U),Ee!==ze)){if(Ne=Xw,De="onMouseLeave",se="onMouseEnter",ue="mouse",(e==="pointerout"||e==="pointerover")&&(Ne=Yw,De="onPointerLeave",se="onPointerEnter",ue="pointer"),Be=Ee==null?q:Tf(Ee),he=ze==null?q:Tf(ze),q=new Ne(De,ue+"leave",Ee,o,J),q.target=Be,q.relatedTarget=he,De=null,Jh(J)===U&&(Ne=new Ne(se,ue+"enter",ze,o,J),Ne.target=he,Ne.relatedTarget=Be,De=Ne),Be=De,Ee&&ze)t:{for(Ne=Ee,se=ze,ue=0,he=Ne;he;he=mf(he))ue++;for(he=0,De=se;De;De=mf(De))he++;for(;0<ue-he;)Ne=mf(Ne),ue--;for(;0<he-ue;)se=mf(se),he--;for(;ue--;){if(Ne===se||se!==null&&Ne===se.alternate)break t;Ne=mf(Ne),se=mf(se)}Ne=null}else Ne=null;Ee!==null&&lb(W,q,Ee,Ne,!1),ze!==null&&Be!==null&&lb(W,Be,ze,Ne,!0)}}e:{if(q=U?Tf(U):window,Ee=q.nodeName&&q.nodeName.toLowerCase(),Ee==="select"||Ee==="input"&&q.type==="file")var Ze=xT;else if(eb(q))if(f3)Ze=TT;else{Ze=bT;var je=wT}else(Ee=q.nodeName)&&Ee.toLowerCase()==="input"&&(q.type==="checkbox"||q.type==="radio")&&(Ze=ST);if(Ze&&(Ze=Ze(e,U))){d3(W,Ze,o,J);break e}je&&je(e,q,U),e==="focusout"&&(je=q._wrapperState)&&je.controlled&&q.type==="number"&&xv(q,"number",q.value)}switch(je=U?Tf(U):window,e){case"focusin":(eb(je)||je.contentEditable==="true")&&(bf=je,zv=U,Tm=null);break;case"focusout":Tm=zv=bf=null;break;case"mousedown":Dv=!0;break;case"contextmenu":case"mouseup":case"dragend":Dv=!1,sb(W,o,J);break;case"selectionchange":if(IT)break;case"keydown":case"keyup":sb(W,o,J)}var ve;if(Lx)e:{switch(e){case"compositionstart":var ee="onCompositionStart";break e;case"compositionend":ee="onCompositionEnd";break e;case"compositionupdate":ee="onCompositionUpdate";break e}ee=void 0}else wf?c3(e,o)&&(ee="onCompositionEnd"):e==="keydown"&&o.keyCode===229&&(ee="onCompositionStart");ee&&(u3&&o.locale!=="ko"&&(wf||ee!=="onCompositionStart"?ee==="onCompositionEnd"&&wf&&(ve=l3()):(Ac=J,zx="value"in Ac?Ac.value:Ac.textContent,wf=!0)),je=a0(U,ee),0<je.length&&(ee=new Kw(ee,e,null,o,J),W.push({event:ee,listeners:je}),ve?ee.data=ve:(ve=h3(o),ve!==null&&(ee.data=ve)))),(ve=mT?gT(e,o):_T(e,o))&&(U=a0(U,"onBeforeInput"),0<U.length&&(J=new Kw("onBeforeInput","beforeinput",null,o,J),W.push({event:J,listeners:U}),J.data=ve))}S3(W,r)})}function Bm(e,r,o){return{instance:e,listener:r,currentTarget:o}}function a0(e,r){for(var o=r+"Capture",h=[];e!==null;){var _=e,b=_.stateNode;_.tag===5&&b!==null&&(_=b,b=Mm(e,o),b!=null&&h.unshift(Bm(e,b,_)),b=Mm(e,r),b!=null&&h.push(Bm(e,b,_))),e=e.return}return h}function mf(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function lb(e,r,o,h,_){for(var b=r._reactName,w=[];o!==null&&o!==h;){var c=o,D=c.alternate,U=c.stateNode;if(D!==null&&D===h)break;c.tag===5&&U!==null&&(c=U,_?(D=Mm(o,b),D!=null&&w.unshift(Bm(o,D,c))):_||(D=Mm(o,b),D!=null&&w.push(Bm(o,D,c)))),o=o.return}w.length!==0&&e.push({event:r,listeners:w})}var MT=/\r\n?/g,zT=/\u0000|\uFFFD/g;function ub(e){return(typeof e=="string"?e:""+e).replace(MT,`
`).replace(zT,"")}function P_(e,r,o){if(r=ub(r),ub(e)!==r&&o)throw Error(ut(425))}function l0(){}var Rv=null,Lv=null;function Ov(e,r){return e==="textarea"||e==="noscript"||typeof r.children=="string"||typeof r.children=="number"||typeof r.dangerouslySetInnerHTML=="object"&&r.dangerouslySetInnerHTML!==null&&r.dangerouslySetInnerHTML.__html!=null}var Fv=typeof setTimeout=="function"?setTimeout:void 0,DT=typeof clearTimeout=="function"?clearTimeout:void 0,cb=typeof Promise=="function"?Promise:void 0,RT=typeof queueMicrotask=="function"?queueMicrotask:typeof cb<"u"?function(e){return cb.resolve(null).then(e).catch(LT)}:Fv;function LT(e){setTimeout(function(){throw e})}function N1(e,r){var o=r,h=0;do{var _=o.nextSibling;if(e.removeChild(o),_&&_.nodeType===8)if(o=_.data,o==="/$"){if(h===0){e.removeChild(_),Rm(r);return}h--}else o!=="$"&&o!=="$?"&&o!=="$!"||h++;o=_}while(o);Rm(r)}function Lc(e){for(;e!=null;e=e.nextSibling){var r=e.nodeType;if(r===1||r===3)break;if(r===8){if(r=e.data,r==="$"||r==="$!"||r==="$?")break;if(r==="/$")return null}}return e}function hb(e){e=e.previousSibling;for(var r=0;e;){if(e.nodeType===8){var o=e.data;if(o==="$"||o==="$!"||o==="$?"){if(r===0)return e;r--}else o==="/$"&&r++}e=e.previousSibling}return null}var Yf=Math.random().toString(36).slice(2),Ll="__reactFiber$"+Yf,Nm="__reactProps$"+Yf,Du="__reactContainer$"+Yf,Bv="__reactEvents$"+Yf,OT="__reactListeners$"+Yf,FT="__reactHandles$"+Yf;function Jh(e){var r=e[Ll];if(r)return r;for(var o=e.parentNode;o;){if(r=o[Du]||o[Ll]){if(o=r.alternate,r.child!==null||o!==null&&o.child!==null)for(e=hb(e);e!==null;){if(o=e[Ll])return o;e=hb(e)}return r}e=o,o=e.parentNode}return null}function Jm(e){return e=e[Ll]||e[Du],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Tf(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(ut(33))}function q0(e){return e[Nm]||null}var Nv=[],Ef=-1;function qc(e){return{current:e}}function Rr(e){0>Ef||(e.current=Nv[Ef],Nv[Ef]=null,Ef--)}function kr(e,r){Ef++,Nv[Ef]=e.current,e.current=r}var jc={},Ds=qc(jc),ao=qc(!1),id=jc;function Uf(e,r){var o=e.type.contextTypes;if(!o)return jc;var h=e.stateNode;if(h&&h.__reactInternalMemoizedUnmaskedChildContext===r)return h.__reactInternalMemoizedMaskedChildContext;var _={},b;for(b in o)_[b]=r[b];return h&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=r,e.__reactInternalMemoizedMaskedChildContext=_),_}function lo(e){return e=e.childContextTypes,e!=null}function u0(){Rr(ao),Rr(Ds)}function db(e,r,o){if(Ds.current!==jc)throw Error(ut(168));kr(Ds,r),kr(ao,o)}function E3(e,r,o){var h=e.stateNode;if(r=r.childContextTypes,typeof h.getChildContext!="function")return o;h=h.getChildContext();for(var _ in h)if(!(_ in r))throw Error(ut(108,w6(e)||"Unknown",_));return Wr({},o,h)}function c0(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||jc,id=Ds.current,kr(Ds,e),kr(ao,ao.current),!0}function fb(e,r,o){var h=e.stateNode;if(!h)throw Error(ut(169));o?(e=E3(e,r,id),h.__reactInternalMemoizedMergedChildContext=e,Rr(ao),Rr(Ds),kr(Ds,e)):Rr(ao),kr(ao,o)}var Eu=null,Z0=!1,U1=!1;function C3(e){Eu===null?Eu=[e]:Eu.push(e)}function BT(e){Z0=!0,C3(e)}function Zc(){if(!U1&&Eu!==null){U1=!0;var e=0,r=hr;try{var o=Eu;for(hr=1;e<o.length;e++){var h=o[e];do h=h(!0);while(h!==null)}Eu=null,Z0=!1}catch(_){throw Eu!==null&&(Eu=Eu.slice(e+1)),Y2(kx,Zc),_}finally{hr=r,U1=!1}}return null}var Cf=[],If=0,h0=null,d0=0,oa=[],aa=0,sd=null,Iu=1,ku="";function Wh(e,r){Cf[If++]=d0,Cf[If++]=h0,h0=e,d0=r}function I3(e,r,o){oa[aa++]=Iu,oa[aa++]=ku,oa[aa++]=sd,sd=e;var h=Iu;e=ku;var _=32-Xa(h)-1;h&=~(1<<_),o+=1;var b=32-Xa(r)+_;if(30<b){var w=_-_%5;b=(h&(1<<w)-1).toString(32),h>>=w,_-=w,Iu=1<<32-Xa(r)+_|o<<_|h,ku=b+e}else Iu=1<<b|o<<_|h,ku=e}function Fx(e){e.return!==null&&(Wh(e,1),I3(e,1,0))}function Bx(e){for(;e===h0;)h0=Cf[--If],Cf[If]=null,d0=Cf[--If],Cf[If]=null;for(;e===sd;)sd=oa[--aa],oa[aa]=null,ku=oa[--aa],oa[aa]=null,Iu=oa[--aa],oa[aa]=null}var Do=null,Mo=null,Ur=!1,Wa=null;function k3(e,r){var o=la(5,null,null,0);o.elementType="DELETED",o.stateNode=r,o.return=e,r=e.deletions,r===null?(e.deletions=[o],e.flags|=16):r.push(o)}function pb(e,r){switch(e.tag){case 5:var o=e.type;return r=r.nodeType!==1||o.toLowerCase()!==r.nodeName.toLowerCase()?null:r,r!==null?(e.stateNode=r,Do=e,Mo=Lc(r.firstChild),!0):!1;case 6:return r=e.pendingProps===""||r.nodeType!==3?null:r,r!==null?(e.stateNode=r,Do=e,Mo=null,!0):!1;case 13:return r=r.nodeType!==8?null:r,r!==null?(o=sd!==null?{id:Iu,overflow:ku}:null,e.memoizedState={dehydrated:r,treeContext:o,retryLane:1073741824},o=la(18,null,null,0),o.stateNode=r,o.return=e,e.child=o,Do=e,Mo=null,!0):!1;default:return!1}}function Uv(e){return(e.mode&1)!==0&&(e.flags&128)===0}function jv(e){if(Ur){var r=Mo;if(r){var o=r;if(!pb(e,r)){if(Uv(e))throw Error(ut(418));r=Lc(o.nextSibling);var h=Do;r&&pb(e,r)?k3(h,o):(e.flags=e.flags&-4097|2,Ur=!1,Do=e)}}else{if(Uv(e))throw Error(ut(418));e.flags=e.flags&-4097|2,Ur=!1,Do=e}}}function mb(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Do=e}function A_(e){if(e!==Do)return!1;if(!Ur)return mb(e),Ur=!0,!1;var r;if((r=e.tag!==3)&&!(r=e.tag!==5)&&(r=e.type,r=r!=="head"&&r!=="body"&&!Ov(e.type,e.memoizedProps)),r&&(r=Mo)){if(Uv(e))throw P3(),Error(ut(418));for(;r;)k3(e,r),r=Lc(r.nextSibling)}if(mb(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(ut(317));e:{for(e=e.nextSibling,r=0;e;){if(e.nodeType===8){var o=e.data;if(o==="/$"){if(r===0){Mo=Lc(e.nextSibling);break e}r--}else o!=="$"&&o!=="$!"&&o!=="$?"||r++}e=e.nextSibling}Mo=null}}else Mo=Do?Lc(e.stateNode.nextSibling):null;return!0}function P3(){for(var e=Mo;e;)e=Lc(e.nextSibling)}function jf(){Mo=Do=null,Ur=!1}function Nx(e){Wa===null?Wa=[e]:Wa.push(e)}var NT=Fu.ReactCurrentBatchConfig;function hm(e,r,o){if(e=o.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(o._owner){if(o=o._owner,o){if(o.tag!==1)throw Error(ut(309));var h=o.stateNode}if(!h)throw Error(ut(147,e));var _=h,b=""+e;return r!==null&&r.ref!==null&&typeof r.ref=="function"&&r.ref._stringRef===b?r.ref:(r=function(w){var c=_.refs;w===null?delete c[b]:c[b]=w},r._stringRef=b,r)}if(typeof e!="string")throw Error(ut(284));if(!o._owner)throw Error(ut(290,e))}return e}function M_(e,r){throw e=Object.prototype.toString.call(r),Error(ut(31,e==="[object Object]"?"object with keys {"+Object.keys(r).join(", ")+"}":e))}function gb(e){var r=e._init;return r(e._payload)}function A3(e){function r(se,ue){if(e){var he=se.deletions;he===null?(se.deletions=[ue],se.flags|=16):he.push(ue)}}function o(se,ue){if(!e)return null;for(;ue!==null;)r(se,ue),ue=ue.sibling;return null}function h(se,ue){for(se=new Map;ue!==null;)ue.key!==null?se.set(ue.key,ue):se.set(ue.index,ue),ue=ue.sibling;return se}function _(se,ue){return se=Nc(se,ue),se.index=0,se.sibling=null,se}function b(se,ue,he){return se.index=he,e?(he=se.alternate,he!==null?(he=he.index,he<ue?(se.flags|=2,ue):he):(se.flags|=2,ue)):(se.flags|=1048576,ue)}function w(se){return e&&se.alternate===null&&(se.flags|=2),se}function c(se,ue,he,De){return ue===null||ue.tag!==6?(ue=W1(he,se.mode,De),ue.return=se,ue):(ue=_(ue,he),ue.return=se,ue)}function D(se,ue,he,De){var Ze=he.type;return Ze===xf?J(se,ue,he.props.children,De,he.key):ue!==null&&(ue.elementType===Ze||typeof Ze=="object"&&Ze!==null&&Ze.$$typeof===Cc&&gb(Ze)===ue.type)?(De=_(ue,he.props),De.ref=hm(se,ue,he),De.return=se,De):(De=J_(he.type,he.key,he.props,null,se.mode,De),De.ref=hm(se,ue,he),De.return=se,De)}function U(se,ue,he,De){return ue===null||ue.tag!==4||ue.stateNode.containerInfo!==he.containerInfo||ue.stateNode.implementation!==he.implementation?(ue=H1(he,se.mode,De),ue.return=se,ue):(ue=_(ue,he.children||[]),ue.return=se,ue)}function J(se,ue,he,De,Ze){return ue===null||ue.tag!==7?(ue=nd(he,se.mode,De,Ze),ue.return=se,ue):(ue=_(ue,he),ue.return=se,ue)}function W(se,ue,he){if(typeof ue=="string"&&ue!==""||typeof ue=="number")return ue=W1(""+ue,se.mode,he),ue.return=se,ue;if(typeof ue=="object"&&ue!==null){switch(ue.$$typeof){case x_:return he=J_(ue.type,ue.key,ue.props,null,se.mode,he),he.ref=hm(se,null,ue),he.return=se,he;case vf:return ue=H1(ue,se.mode,he),ue.return=se,ue;case Cc:var De=ue._init;return W(se,De(ue._payload),he)}if(gm(ue)||om(ue))return ue=nd(ue,se.mode,he,null),ue.return=se,ue;M_(se,ue)}return null}function q(se,ue,he,De){var Ze=ue!==null?ue.key:null;if(typeof he=="string"&&he!==""||typeof he=="number")return Ze!==null?null:c(se,ue,""+he,De);if(typeof he=="object"&&he!==null){switch(he.$$typeof){case x_:return he.key===Ze?D(se,ue,he,De):null;case vf:return he.key===Ze?U(se,ue,he,De):null;case Cc:return Ze=he._init,q(se,ue,Ze(he._payload),De)}if(gm(he)||om(he))return Ze!==null?null:J(se,ue,he,De,null);M_(se,he)}return null}function Ee(se,ue,he,De,Ze){if(typeof De=="string"&&De!==""||typeof De=="number")return se=se.get(he)||null,c(ue,se,""+De,Ze);if(typeof De=="object"&&De!==null){switch(De.$$typeof){case x_:return se=se.get(De.key===null?he:De.key)||null,D(ue,se,De,Ze);case vf:return se=se.get(De.key===null?he:De.key)||null,U(ue,se,De,Ze);case Cc:var je=De._init;return Ee(se,ue,he,je(De._payload),Ze)}if(gm(De)||om(De))return se=se.get(he)||null,J(ue,se,De,Ze,null);M_(ue,De)}return null}function ze(se,ue,he,De){for(var Ze=null,je=null,ve=ue,ee=ue=0,de=null;ve!==null&&ee<he.length;ee++){ve.index>ee?(de=ve,ve=null):de=ve.sibling;var Te=q(se,ve,he[ee],De);if(Te===null){ve===null&&(ve=de);break}e&&ve&&Te.alternate===null&&r(se,ve),ue=b(Te,ue,ee),je===null?Ze=Te:je.sibling=Te,je=Te,ve=de}if(ee===he.length)return o(se,ve),Ur&&Wh(se,ee),Ze;if(ve===null){for(;ee<he.length;ee++)ve=W(se,he[ee],De),ve!==null&&(ue=b(ve,ue,ee),je===null?Ze=ve:je.sibling=ve,je=ve);return Ur&&Wh(se,ee),Ze}for(ve=h(se,ve);ee<he.length;ee++)de=Ee(ve,se,ee,he[ee],De),de!==null&&(e&&de.alternate!==null&&ve.delete(de.key===null?ee:de.key),ue=b(de,ue,ee),je===null?Ze=de:je.sibling=de,je=de);return e&&ve.forEach(function(Ue){return r(se,Ue)}),Ur&&Wh(se,ee),Ze}function Ne(se,ue,he,De){var Ze=om(he);if(typeof Ze!="function")throw Error(ut(150));if(he=Ze.call(he),he==null)throw Error(ut(151));for(var je=Ze=null,ve=ue,ee=ue=0,de=null,Te=he.next();ve!==null&&!Te.done;ee++,Te=he.next()){ve.index>ee?(de=ve,ve=null):de=ve.sibling;var Ue=q(se,ve,Te.value,De);if(Ue===null){ve===null&&(ve=de);break}e&&ve&&Ue.alternate===null&&r(se,ve),ue=b(Ue,ue,ee),je===null?Ze=Ue:je.sibling=Ue,je=Ue,ve=de}if(Te.done)return o(se,ve),Ur&&Wh(se,ee),Ze;if(ve===null){for(;!Te.done;ee++,Te=he.next())Te=W(se,Te.value,De),Te!==null&&(ue=b(Te,ue,ee),je===null?Ze=Te:je.sibling=Te,je=Te);return Ur&&Wh(se,ee),Ze}for(ve=h(se,ve);!Te.done;ee++,Te=he.next())Te=Ee(ve,se,ee,Te.value,De),Te!==null&&(e&&Te.alternate!==null&&ve.delete(Te.key===null?ee:Te.key),ue=b(Te,ue,ee),je===null?Ze=Te:je.sibling=Te,je=Te);return e&&ve.forEach(function(Xe){return r(se,Xe)}),Ur&&Wh(se,ee),Ze}function Be(se,ue,he,De){if(typeof he=="object"&&he!==null&&he.type===xf&&he.key===null&&(he=he.props.children),typeof he=="object"&&he!==null){switch(he.$$typeof){case x_:e:{for(var Ze=he.key,je=ue;je!==null;){if(je.key===Ze){if(Ze=he.type,Ze===xf){if(je.tag===7){o(se,je.sibling),ue=_(je,he.props.children),ue.return=se,se=ue;break e}}else if(je.elementType===Ze||typeof Ze=="object"&&Ze!==null&&Ze.$$typeof===Cc&&gb(Ze)===je.type){o(se,je.sibling),ue=_(je,he.props),ue.ref=hm(se,je,he),ue.return=se,se=ue;break e}o(se,je);break}else r(se,je);je=je.sibling}he.type===xf?(ue=nd(he.props.children,se.mode,De,he.key),ue.return=se,se=ue):(De=J_(he.type,he.key,he.props,null,se.mode,De),De.ref=hm(se,ue,he),De.return=se,se=De)}return w(se);case vf:e:{for(je=he.key;ue!==null;){if(ue.key===je)if(ue.tag===4&&ue.stateNode.containerInfo===he.containerInfo&&ue.stateNode.implementation===he.implementation){o(se,ue.sibling),ue=_(ue,he.children||[]),ue.return=se,se=ue;break e}else{o(se,ue);break}else r(se,ue);ue=ue.sibling}ue=H1(he,se.mode,De),ue.return=se,se=ue}return w(se);case Cc:return je=he._init,Be(se,ue,je(he._payload),De)}if(gm(he))return ze(se,ue,he,De);if(om(he))return Ne(se,ue,he,De);M_(se,he)}return typeof he=="string"&&he!==""||typeof he=="number"?(he=""+he,ue!==null&&ue.tag===6?(o(se,ue.sibling),ue=_(ue,he),ue.return=se,se=ue):(o(se,ue),ue=W1(he,se.mode,De),ue.return=se,se=ue),w(se)):o(se,ue)}return Be}var $f=A3(!0),M3=A3(!1),f0=qc(null),p0=null,kf=null,Ux=null;function jx(){Ux=kf=p0=null}function $x(e){var r=f0.current;Rr(f0),e._currentValue=r}function $v(e,r,o){for(;e!==null;){var h=e.alternate;if((e.childLanes&r)!==r?(e.childLanes|=r,h!==null&&(h.childLanes|=r)):h!==null&&(h.childLanes&r)!==r&&(h.childLanes|=r),e===o)break;e=e.return}}function Of(e,r){p0=e,Ux=kf=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&r&&(oo=!0),e.firstContext=null)}function ha(e){var r=e._currentValue;if(Ux!==e)if(e={context:e,memoizedValue:r,next:null},kf===null){if(p0===null)throw Error(ut(308));kf=e,p0.dependencies={lanes:0,firstContext:e}}else kf=kf.next=e;return r}var Qh=null;function Vx(e){Qh===null?Qh=[e]:Qh.push(e)}function z3(e,r,o,h){var _=r.interleaved;return _===null?(o.next=o,Vx(r)):(o.next=_.next,_.next=o),r.interleaved=o,Ru(e,h)}function Ru(e,r){e.lanes|=r;var o=e.alternate;for(o!==null&&(o.lanes|=r),o=e,e=e.return;e!==null;)e.childLanes|=r,o=e.alternate,o!==null&&(o.childLanes|=r),o=e,e=e.return;return o.tag===3?o.stateNode:null}var Ic=!1;function qx(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function D3(e,r){e=e.updateQueue,r.updateQueue===e&&(r.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Au(e,r){return{eventTime:e,lane:r,tag:0,payload:null,callback:null,next:null}}function Oc(e,r,o){var h=e.updateQueue;if(h===null)return null;if(h=h.shared,Jn&2){var _=h.pending;return _===null?r.next=r:(r.next=_.next,_.next=r),h.pending=r,Ru(e,o)}return _=h.interleaved,_===null?(r.next=r,Vx(h)):(r.next=_.next,_.next=r),h.interleaved=r,Ru(e,o)}function G_(e,r,o){if(r=r.updateQueue,r!==null&&(r=r.shared,(o&4194240)!==0)){var h=r.lanes;h&=e.pendingLanes,o|=h,r.lanes=o,Px(e,o)}}function _b(e,r){var o=e.updateQueue,h=e.alternate;if(h!==null&&(h=h.updateQueue,o===h)){var _=null,b=null;if(o=o.firstBaseUpdate,o!==null){do{var w={eventTime:o.eventTime,lane:o.lane,tag:o.tag,payload:o.payload,callback:o.callback,next:null};b===null?_=b=w:b=b.next=w,o=o.next}while(o!==null);b===null?_=b=r:b=b.next=r}else _=b=r;o={baseState:h.baseState,firstBaseUpdate:_,lastBaseUpdate:b,shared:h.shared,effects:h.effects},e.updateQueue=o;return}e=o.lastBaseUpdate,e===null?o.firstBaseUpdate=r:e.next=r,o.lastBaseUpdate=r}function m0(e,r,o,h){var _=e.updateQueue;Ic=!1;var b=_.firstBaseUpdate,w=_.lastBaseUpdate,c=_.shared.pending;if(c!==null){_.shared.pending=null;var D=c,U=D.next;D.next=null,w===null?b=U:w.next=U,w=D;var J=e.alternate;J!==null&&(J=J.updateQueue,c=J.lastBaseUpdate,c!==w&&(c===null?J.firstBaseUpdate=U:c.next=U,J.lastBaseUpdate=D))}if(b!==null){var W=_.baseState;w=0,J=U=D=null,c=b;do{var q=c.lane,Ee=c.eventTime;if((h&q)===q){J!==null&&(J=J.next={eventTime:Ee,lane:0,tag:c.tag,payload:c.payload,callback:c.callback,next:null});e:{var ze=e,Ne=c;switch(q=r,Ee=o,Ne.tag){case 1:if(ze=Ne.payload,typeof ze=="function"){W=ze.call(Ee,W,q);break e}W=ze;break e;case 3:ze.flags=ze.flags&-65537|128;case 0:if(ze=Ne.payload,q=typeof ze=="function"?ze.call(Ee,W,q):ze,q==null)break e;W=Wr({},W,q);break e;case 2:Ic=!0}}c.callback!==null&&c.lane!==0&&(e.flags|=64,q=_.effects,q===null?_.effects=[c]:q.push(c))}else Ee={eventTime:Ee,lane:q,tag:c.tag,payload:c.payload,callback:c.callback,next:null},J===null?(U=J=Ee,D=W):J=J.next=Ee,w|=q;if(c=c.next,c===null){if(c=_.shared.pending,c===null)break;q=c,c=q.next,q.next=null,_.lastBaseUpdate=q,_.shared.pending=null}}while(!0);if(J===null&&(D=W),_.baseState=D,_.firstBaseUpdate=U,_.lastBaseUpdate=J,r=_.shared.interleaved,r!==null){_=r;do w|=_.lane,_=_.next;while(_!==r)}else b===null&&(_.shared.lanes=0);ad|=w,e.lanes=w,e.memoizedState=W}}function yb(e,r,o){if(e=r.effects,r.effects=null,e!==null)for(r=0;r<e.length;r++){var h=e[r],_=h.callback;if(_!==null){if(h.callback=null,h=o,typeof _!="function")throw Error(ut(191,_));_.call(h)}}}var Qm={},Bl=qc(Qm),Um=qc(Qm),jm=qc(Qm);function ed(e){if(e===Qm)throw Error(ut(174));return e}function Zx(e,r){switch(kr(jm,r),kr(Um,e),kr(Bl,Qm),e=r.nodeType,e){case 9:case 11:r=(r=r.documentElement)?r.namespaceURI:bv(null,"");break;default:e=e===8?r.parentNode:r,r=e.namespaceURI||null,e=e.tagName,r=bv(r,e)}Rr(Bl),kr(Bl,r)}function Vf(){Rr(Bl),Rr(Um),Rr(jm)}function R3(e){ed(jm.current);var r=ed(Bl.current),o=bv(r,e.type);r!==o&&(kr(Um,e),kr(Bl,o))}function Gx(e){Um.current===e&&(Rr(Bl),Rr(Um))}var Zr=qc(0);function g0(e){for(var r=e;r!==null;){if(r.tag===13){var o=r.memoizedState;if(o!==null&&(o=o.dehydrated,o===null||o.data==="$?"||o.data==="$!"))return r}else if(r.tag===19&&r.memoizedProps.revealOrder!==void 0){if(r.flags&128)return r}else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===e)break;for(;r.sibling===null;){if(r.return===null||r.return===e)return null;r=r.return}r.sibling.return=r.return,r=r.sibling}return null}var j1=[];function Wx(){for(var e=0;e<j1.length;e++)j1[e]._workInProgressVersionPrimary=null;j1.length=0}var W_=Fu.ReactCurrentDispatcher,$1=Fu.ReactCurrentBatchConfig,od=0,Gr=null,Mi=null,qi=null,_0=!1,Em=!1,$m=0,UT=0;function Ps(){throw Error(ut(321))}function Hx(e,r){if(r===null)return!1;for(var o=0;o<r.length&&o<e.length;o++)if(!Ja(e[o],r[o]))return!1;return!0}function Xx(e,r,o,h,_,b){if(od=b,Gr=r,r.memoizedState=null,r.updateQueue=null,r.lanes=0,W_.current=e===null||e.memoizedState===null?qT:ZT,e=o(h,_),Em){b=0;do{if(Em=!1,$m=0,25<=b)throw Error(ut(301));b+=1,qi=Mi=null,r.updateQueue=null,W_.current=GT,e=o(h,_)}while(Em)}if(W_.current=y0,r=Mi!==null&&Mi.next!==null,od=0,qi=Mi=Gr=null,_0=!1,r)throw Error(ut(300));return e}function Kx(){var e=$m!==0;return $m=0,e}function Rl(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return qi===null?Gr.memoizedState=qi=e:qi=qi.next=e,qi}function da(){if(Mi===null){var e=Gr.alternate;e=e!==null?e.memoizedState:null}else e=Mi.next;var r=qi===null?Gr.memoizedState:qi.next;if(r!==null)qi=r,Mi=e;else{if(e===null)throw Error(ut(310));Mi=e,e={memoizedState:Mi.memoizedState,baseState:Mi.baseState,baseQueue:Mi.baseQueue,queue:Mi.queue,next:null},qi===null?Gr.memoizedState=qi=e:qi=qi.next=e}return qi}function Vm(e,r){return typeof r=="function"?r(e):r}function V1(e){var r=da(),o=r.queue;if(o===null)throw Error(ut(311));o.lastRenderedReducer=e;var h=Mi,_=h.baseQueue,b=o.pending;if(b!==null){if(_!==null){var w=_.next;_.next=b.next,b.next=w}h.baseQueue=_=b,o.pending=null}if(_!==null){b=_.next,h=h.baseState;var c=w=null,D=null,U=b;do{var J=U.lane;if((od&J)===J)D!==null&&(D=D.next={lane:0,action:U.action,hasEagerState:U.hasEagerState,eagerState:U.eagerState,next:null}),h=U.hasEagerState?U.eagerState:e(h,U.action);else{var W={lane:J,action:U.action,hasEagerState:U.hasEagerState,eagerState:U.eagerState,next:null};D===null?(c=D=W,w=h):D=D.next=W,Gr.lanes|=J,ad|=J}U=U.next}while(U!==null&&U!==b);D===null?w=h:D.next=c,Ja(h,r.memoizedState)||(oo=!0),r.memoizedState=h,r.baseState=w,r.baseQueue=D,o.lastRenderedState=h}if(e=o.interleaved,e!==null){_=e;do b=_.lane,Gr.lanes|=b,ad|=b,_=_.next;while(_!==e)}else _===null&&(o.lanes=0);return[r.memoizedState,o.dispatch]}function q1(e){var r=da(),o=r.queue;if(o===null)throw Error(ut(311));o.lastRenderedReducer=e;var h=o.dispatch,_=o.pending,b=r.memoizedState;if(_!==null){o.pending=null;var w=_=_.next;do b=e(b,w.action),w=w.next;while(w!==_);Ja(b,r.memoizedState)||(oo=!0),r.memoizedState=b,r.baseQueue===null&&(r.baseState=b),o.lastRenderedState=b}return[b,h]}function L3(){}function O3(e,r){var o=Gr,h=da(),_=r(),b=!Ja(h.memoizedState,_);if(b&&(h.memoizedState=_,oo=!0),h=h.queue,Yx(N3.bind(null,o,h,e),[e]),h.getSnapshot!==r||b||qi!==null&&qi.memoizedState.tag&1){if(o.flags|=2048,qm(9,B3.bind(null,o,h,_,r),void 0,null),Zi===null)throw Error(ut(349));od&30||F3(o,r,_)}return _}function F3(e,r,o){e.flags|=16384,e={getSnapshot:r,value:o},r=Gr.updateQueue,r===null?(r={lastEffect:null,stores:null},Gr.updateQueue=r,r.stores=[e]):(o=r.stores,o===null?r.stores=[e]:o.push(e))}function B3(e,r,o,h){r.value=o,r.getSnapshot=h,U3(r)&&j3(e)}function N3(e,r,o){return o(function(){U3(r)&&j3(e)})}function U3(e){var r=e.getSnapshot;e=e.value;try{var o=r();return!Ja(e,o)}catch{return!0}}function j3(e){var r=Ru(e,1);r!==null&&Ka(r,e,1,-1)}function vb(e){var r=Rl();return typeof e=="function"&&(e=e()),r.memoizedState=r.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Vm,lastRenderedState:e},r.queue=e,e=e.dispatch=VT.bind(null,Gr,e),[r.memoizedState,e]}function qm(e,r,o,h){return e={tag:e,create:r,destroy:o,deps:h,next:null},r=Gr.updateQueue,r===null?(r={lastEffect:null,stores:null},Gr.updateQueue=r,r.lastEffect=e.next=e):(o=r.lastEffect,o===null?r.lastEffect=e.next=e:(h=o.next,o.next=e,e.next=h,r.lastEffect=e)),e}function $3(){return da().memoizedState}function H_(e,r,o,h){var _=Rl();Gr.flags|=e,_.memoizedState=qm(1|r,o,void 0,h===void 0?null:h)}function G0(e,r,o,h){var _=da();h=h===void 0?null:h;var b=void 0;if(Mi!==null){var w=Mi.memoizedState;if(b=w.destroy,h!==null&&Hx(h,w.deps)){_.memoizedState=qm(r,o,b,h);return}}Gr.flags|=e,_.memoizedState=qm(1|r,o,b,h)}function xb(e,r){return H_(8390656,8,e,r)}function Yx(e,r){return G0(2048,8,e,r)}function V3(e,r){return G0(4,2,e,r)}function q3(e,r){return G0(4,4,e,r)}function Z3(e,r){if(typeof r=="function")return e=e(),r(e),function(){r(null)};if(r!=null)return e=e(),r.current=e,function(){r.current=null}}function G3(e,r,o){return o=o!=null?o.concat([e]):null,G0(4,4,Z3.bind(null,r,e),o)}function Jx(){}function W3(e,r){var o=da();r=r===void 0?null:r;var h=o.memoizedState;return h!==null&&r!==null&&Hx(r,h[1])?h[0]:(o.memoizedState=[e,r],e)}function H3(e,r){var o=da();r=r===void 0?null:r;var h=o.memoizedState;return h!==null&&r!==null&&Hx(r,h[1])?h[0]:(e=e(),o.memoizedState=[e,r],e)}function X3(e,r,o){return od&21?(Ja(o,r)||(o=e3(),Gr.lanes|=o,ad|=o,e.baseState=!0),r):(e.baseState&&(e.baseState=!1,oo=!0),e.memoizedState=o)}function jT(e,r){var o=hr;hr=o!==0&&4>o?o:4,e(!0);var h=$1.transition;$1.transition={};try{e(!1),r()}finally{hr=o,$1.transition=h}}function K3(){return da().memoizedState}function $T(e,r,o){var h=Bc(e);if(o={lane:h,action:o,hasEagerState:!1,eagerState:null,next:null},Y3(e))J3(r,o);else if(o=z3(e,r,o,h),o!==null){var _=Hs();Ka(o,e,h,_),Q3(o,r,h)}}function VT(e,r,o){var h=Bc(e),_={lane:h,action:o,hasEagerState:!1,eagerState:null,next:null};if(Y3(e))J3(r,_);else{var b=e.alternate;if(e.lanes===0&&(b===null||b.lanes===0)&&(b=r.lastRenderedReducer,b!==null))try{var w=r.lastRenderedState,c=b(w,o);if(_.hasEagerState=!0,_.eagerState=c,Ja(c,w)){var D=r.interleaved;D===null?(_.next=_,Vx(r)):(_.next=D.next,D.next=_),r.interleaved=_;return}}catch{}finally{}o=z3(e,r,_,h),o!==null&&(_=Hs(),Ka(o,e,h,_),Q3(o,r,h))}}function Y3(e){var r=e.alternate;return e===Gr||r!==null&&r===Gr}function J3(e,r){Em=_0=!0;var o=e.pending;o===null?r.next=r:(r.next=o.next,o.next=r),e.pending=r}function Q3(e,r,o){if(o&4194240){var h=r.lanes;h&=e.pendingLanes,o|=h,r.lanes=o,Px(e,o)}}var y0={readContext:ha,useCallback:Ps,useContext:Ps,useEffect:Ps,useImperativeHandle:Ps,useInsertionEffect:Ps,useLayoutEffect:Ps,useMemo:Ps,useReducer:Ps,useRef:Ps,useState:Ps,useDebugValue:Ps,useDeferredValue:Ps,useTransition:Ps,useMutableSource:Ps,useSyncExternalStore:Ps,useId:Ps,unstable_isNewReconciler:!1},qT={readContext:ha,useCallback:function(e,r){return Rl().memoizedState=[e,r===void 0?null:r],e},useContext:ha,useEffect:xb,useImperativeHandle:function(e,r,o){return o=o!=null?o.concat([e]):null,H_(4194308,4,Z3.bind(null,r,e),o)},useLayoutEffect:function(e,r){return H_(4194308,4,e,r)},useInsertionEffect:function(e,r){return H_(4,2,e,r)},useMemo:function(e,r){var o=Rl();return r=r===void 0?null:r,e=e(),o.memoizedState=[e,r],e},useReducer:function(e,r,o){var h=Rl();return r=o!==void 0?o(r):r,h.memoizedState=h.baseState=r,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:r},h.queue=e,e=e.dispatch=$T.bind(null,Gr,e),[h.memoizedState,e]},useRef:function(e){var r=Rl();return e={current:e},r.memoizedState=e},useState:vb,useDebugValue:Jx,useDeferredValue:function(e){return Rl().memoizedState=e},useTransition:function(){var e=vb(!1),r=e[0];return e=jT.bind(null,e[1]),Rl().memoizedState=e,[r,e]},useMutableSource:function(){},useSyncExternalStore:function(e,r,o){var h=Gr,_=Rl();if(Ur){if(o===void 0)throw Error(ut(407));o=o()}else{if(o=r(),Zi===null)throw Error(ut(349));od&30||F3(h,r,o)}_.memoizedState=o;var b={value:o,getSnapshot:r};return _.queue=b,xb(N3.bind(null,h,b,e),[e]),h.flags|=2048,qm(9,B3.bind(null,h,b,o,r),void 0,null),o},useId:function(){var e=Rl(),r=Zi.identifierPrefix;if(Ur){var o=ku,h=Iu;o=(h&~(1<<32-Xa(h)-1)).toString(32)+o,r=":"+r+"R"+o,o=$m++,0<o&&(r+="H"+o.toString(32)),r+=":"}else o=UT++,r=":"+r+"r"+o.toString(32)+":";return e.memoizedState=r},unstable_isNewReconciler:!1},ZT={readContext:ha,useCallback:W3,useContext:ha,useEffect:Yx,useImperativeHandle:G3,useInsertionEffect:V3,useLayoutEffect:q3,useMemo:H3,useReducer:V1,useRef:$3,useState:function(){return V1(Vm)},useDebugValue:Jx,useDeferredValue:function(e){var r=da();return X3(r,Mi.memoizedState,e)},useTransition:function(){var e=V1(Vm)[0],r=da().memoizedState;return[e,r]},useMutableSource:L3,useSyncExternalStore:O3,useId:K3,unstable_isNewReconciler:!1},GT={readContext:ha,useCallback:W3,useContext:ha,useEffect:Yx,useImperativeHandle:G3,useInsertionEffect:V3,useLayoutEffect:q3,useMemo:H3,useReducer:q1,useRef:$3,useState:function(){return q1(Vm)},useDebugValue:Jx,useDeferredValue:function(e){var r=da();return Mi===null?r.memoizedState=e:X3(r,Mi.memoizedState,e)},useTransition:function(){var e=q1(Vm)[0],r=da().memoizedState;return[e,r]},useMutableSource:L3,useSyncExternalStore:O3,useId:K3,unstable_isNewReconciler:!1};function Za(e,r){if(e&&e.defaultProps){r=Wr({},r),e=e.defaultProps;for(var o in e)r[o]===void 0&&(r[o]=e[o]);return r}return r}function Vv(e,r,o,h){r=e.memoizedState,o=o(h,r),o=o==null?r:Wr({},r,o),e.memoizedState=o,e.lanes===0&&(e.updateQueue.baseState=o)}var W0={isMounted:function(e){return(e=e._reactInternals)?fd(e)===e:!1},enqueueSetState:function(e,r,o){e=e._reactInternals;var h=Hs(),_=Bc(e),b=Au(h,_);b.payload=r,o!=null&&(b.callback=o),r=Oc(e,b,_),r!==null&&(Ka(r,e,_,h),G_(r,e,_))},enqueueReplaceState:function(e,r,o){e=e._reactInternals;var h=Hs(),_=Bc(e),b=Au(h,_);b.tag=1,b.payload=r,o!=null&&(b.callback=o),r=Oc(e,b,_),r!==null&&(Ka(r,e,_,h),G_(r,e,_))},enqueueForceUpdate:function(e,r){e=e._reactInternals;var o=Hs(),h=Bc(e),_=Au(o,h);_.tag=2,r!=null&&(_.callback=r),r=Oc(e,_,h),r!==null&&(Ka(r,e,h,o),G_(r,e,h))}};function wb(e,r,o,h,_,b,w){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(h,b,w):r.prototype&&r.prototype.isPureReactComponent?!Om(o,h)||!Om(_,b):!0}function e4(e,r,o){var h=!1,_=jc,b=r.contextType;return typeof b=="object"&&b!==null?b=ha(b):(_=lo(r)?id:Ds.current,h=r.contextTypes,b=(h=h!=null)?Uf(e,_):jc),r=new r(o,b),e.memoizedState=r.state!==null&&r.state!==void 0?r.state:null,r.updater=W0,e.stateNode=r,r._reactInternals=e,h&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=_,e.__reactInternalMemoizedMaskedChildContext=b),r}function bb(e,r,o,h){e=r.state,typeof r.componentWillReceiveProps=="function"&&r.componentWillReceiveProps(o,h),typeof r.UNSAFE_componentWillReceiveProps=="function"&&r.UNSAFE_componentWillReceiveProps(o,h),r.state!==e&&W0.enqueueReplaceState(r,r.state,null)}function qv(e,r,o,h){var _=e.stateNode;_.props=o,_.state=e.memoizedState,_.refs={},qx(e);var b=r.contextType;typeof b=="object"&&b!==null?_.context=ha(b):(b=lo(r)?id:Ds.current,_.context=Uf(e,b)),_.state=e.memoizedState,b=r.getDerivedStateFromProps,typeof b=="function"&&(Vv(e,r,b,o),_.state=e.memoizedState),typeof r.getDerivedStateFromProps=="function"||typeof _.getSnapshotBeforeUpdate=="function"||typeof _.UNSAFE_componentWillMount!="function"&&typeof _.componentWillMount!="function"||(r=_.state,typeof _.componentWillMount=="function"&&_.componentWillMount(),typeof _.UNSAFE_componentWillMount=="function"&&_.UNSAFE_componentWillMount(),r!==_.state&&W0.enqueueReplaceState(_,_.state,null),m0(e,o,_,h),_.state=e.memoizedState),typeof _.componentDidMount=="function"&&(e.flags|=4194308)}function qf(e,r){try{var o="",h=r;do o+=x6(h),h=h.return;while(h);var _=o}catch(b){_=`
Error generating stack: `+b.message+`
`+b.stack}return{value:e,source:r,stack:_,digest:null}}function Z1(e,r,o){return{value:e,source:null,stack:o??null,digest:r??null}}function Zv(e,r){try{console.error(r.value)}catch(o){setTimeout(function(){throw o})}}var WT=typeof WeakMap=="function"?WeakMap:Map;function t4(e,r,o){o=Au(-1,o),o.tag=3,o.payload={element:null};var h=r.value;return o.callback=function(){x0||(x0=!0,tx=h),Zv(e,r)},o}function n4(e,r,o){o=Au(-1,o),o.tag=3;var h=e.type.getDerivedStateFromError;if(typeof h=="function"){var _=r.value;o.payload=function(){return h(_)},o.callback=function(){Zv(e,r)}}var b=e.stateNode;return b!==null&&typeof b.componentDidCatch=="function"&&(o.callback=function(){Zv(e,r),typeof h!="function"&&(Fc===null?Fc=new Set([this]):Fc.add(this));var w=r.stack;this.componentDidCatch(r.value,{componentStack:w!==null?w:""})}),o}function Sb(e,r,o){var h=e.pingCache;if(h===null){h=e.pingCache=new WT;var _=new Set;h.set(r,_)}else _=h.get(r),_===void 0&&(_=new Set,h.set(r,_));_.has(o)||(_.add(o),e=aE.bind(null,e,r,o),r.then(e,e))}function Tb(e){do{var r;if((r=e.tag===13)&&(r=e.memoizedState,r=r!==null?r.dehydrated!==null:!0),r)return e;e=e.return}while(e!==null);return null}function Eb(e,r,o,h,_){return e.mode&1?(e.flags|=65536,e.lanes=_,e):(e===r?e.flags|=65536:(e.flags|=128,o.flags|=131072,o.flags&=-52805,o.tag===1&&(o.alternate===null?o.tag=17:(r=Au(-1,1),r.tag=2,Oc(o,r,1))),o.lanes|=1),e)}var HT=Fu.ReactCurrentOwner,oo=!1;function Ws(e,r,o,h){r.child=e===null?M3(r,null,o,h):$f(r,e.child,o,h)}function Cb(e,r,o,h,_){o=o.render;var b=r.ref;return Of(r,_),h=Xx(e,r,o,h,b,_),o=Kx(),e!==null&&!oo?(r.updateQueue=e.updateQueue,r.flags&=-2053,e.lanes&=~_,Lu(e,r,_)):(Ur&&o&&Fx(r),r.flags|=1,Ws(e,r,h,_),r.child)}function Ib(e,r,o,h,_){if(e===null){var b=o.type;return typeof b=="function"&&!ow(b)&&b.defaultProps===void 0&&o.compare===null&&o.defaultProps===void 0?(r.tag=15,r.type=b,r4(e,r,b,h,_)):(e=J_(o.type,null,h,r,r.mode,_),e.ref=r.ref,e.return=r,r.child=e)}if(b=e.child,!(e.lanes&_)){var w=b.memoizedProps;if(o=o.compare,o=o!==null?o:Om,o(w,h)&&e.ref===r.ref)return Lu(e,r,_)}return r.flags|=1,e=Nc(b,h),e.ref=r.ref,e.return=r,r.child=e}function r4(e,r,o,h,_){if(e!==null){var b=e.memoizedProps;if(Om(b,h)&&e.ref===r.ref)if(oo=!1,r.pendingProps=h=b,(e.lanes&_)!==0)e.flags&131072&&(oo=!0);else return r.lanes=e.lanes,Lu(e,r,_)}return Gv(e,r,o,h,_)}function i4(e,r,o){var h=r.pendingProps,_=h.children,b=e!==null?e.memoizedState:null;if(h.mode==="hidden")if(!(r.mode&1))r.memoizedState={baseLanes:0,cachePool:null,transitions:null},kr(Af,Ao),Ao|=o;else{if(!(o&1073741824))return e=b!==null?b.baseLanes|o:o,r.lanes=r.childLanes=1073741824,r.memoizedState={baseLanes:e,cachePool:null,transitions:null},r.updateQueue=null,kr(Af,Ao),Ao|=e,null;r.memoizedState={baseLanes:0,cachePool:null,transitions:null},h=b!==null?b.baseLanes:o,kr(Af,Ao),Ao|=h}else b!==null?(h=b.baseLanes|o,r.memoizedState=null):h=o,kr(Af,Ao),Ao|=h;return Ws(e,r,_,o),r.child}function s4(e,r){var o=r.ref;(e===null&&o!==null||e!==null&&e.ref!==o)&&(r.flags|=512,r.flags|=2097152)}function Gv(e,r,o,h,_){var b=lo(o)?id:Ds.current;return b=Uf(r,b),Of(r,_),o=Xx(e,r,o,h,b,_),h=Kx(),e!==null&&!oo?(r.updateQueue=e.updateQueue,r.flags&=-2053,e.lanes&=~_,Lu(e,r,_)):(Ur&&h&&Fx(r),r.flags|=1,Ws(e,r,o,_),r.child)}function kb(e,r,o,h,_){if(lo(o)){var b=!0;c0(r)}else b=!1;if(Of(r,_),r.stateNode===null)X_(e,r),e4(r,o,h),qv(r,o,h,_),h=!0;else if(e===null){var w=r.stateNode,c=r.memoizedProps;w.props=c;var D=w.context,U=o.contextType;typeof U=="object"&&U!==null?U=ha(U):(U=lo(o)?id:Ds.current,U=Uf(r,U));var J=o.getDerivedStateFromProps,W=typeof J=="function"||typeof w.getSnapshotBeforeUpdate=="function";W||typeof w.UNSAFE_componentWillReceiveProps!="function"&&typeof w.componentWillReceiveProps!="function"||(c!==h||D!==U)&&bb(r,w,h,U),Ic=!1;var q=r.memoizedState;w.state=q,m0(r,h,w,_),D=r.memoizedState,c!==h||q!==D||ao.current||Ic?(typeof J=="function"&&(Vv(r,o,J,h),D=r.memoizedState),(c=Ic||wb(r,o,c,h,q,D,U))?(W||typeof w.UNSAFE_componentWillMount!="function"&&typeof w.componentWillMount!="function"||(typeof w.componentWillMount=="function"&&w.componentWillMount(),typeof w.UNSAFE_componentWillMount=="function"&&w.UNSAFE_componentWillMount()),typeof w.componentDidMount=="function"&&(r.flags|=4194308)):(typeof w.componentDidMount=="function"&&(r.flags|=4194308),r.memoizedProps=h,r.memoizedState=D),w.props=h,w.state=D,w.context=U,h=c):(typeof w.componentDidMount=="function"&&(r.flags|=4194308),h=!1)}else{w=r.stateNode,D3(e,r),c=r.memoizedProps,U=r.type===r.elementType?c:Za(r.type,c),w.props=U,W=r.pendingProps,q=w.context,D=o.contextType,typeof D=="object"&&D!==null?D=ha(D):(D=lo(o)?id:Ds.current,D=Uf(r,D));var Ee=o.getDerivedStateFromProps;(J=typeof Ee=="function"||typeof w.getSnapshotBeforeUpdate=="function")||typeof w.UNSAFE_componentWillReceiveProps!="function"&&typeof w.componentWillReceiveProps!="function"||(c!==W||q!==D)&&bb(r,w,h,D),Ic=!1,q=r.memoizedState,w.state=q,m0(r,h,w,_);var ze=r.memoizedState;c!==W||q!==ze||ao.current||Ic?(typeof Ee=="function"&&(Vv(r,o,Ee,h),ze=r.memoizedState),(U=Ic||wb(r,o,U,h,q,ze,D)||!1)?(J||typeof w.UNSAFE_componentWillUpdate!="function"&&typeof w.componentWillUpdate!="function"||(typeof w.componentWillUpdate=="function"&&w.componentWillUpdate(h,ze,D),typeof w.UNSAFE_componentWillUpdate=="function"&&w.UNSAFE_componentWillUpdate(h,ze,D)),typeof w.componentDidUpdate=="function"&&(r.flags|=4),typeof w.getSnapshotBeforeUpdate=="function"&&(r.flags|=1024)):(typeof w.componentDidUpdate!="function"||c===e.memoizedProps&&q===e.memoizedState||(r.flags|=4),typeof w.getSnapshotBeforeUpdate!="function"||c===e.memoizedProps&&q===e.memoizedState||(r.flags|=1024),r.memoizedProps=h,r.memoizedState=ze),w.props=h,w.state=ze,w.context=D,h=U):(typeof w.componentDidUpdate!="function"||c===e.memoizedProps&&q===e.memoizedState||(r.flags|=4),typeof w.getSnapshotBeforeUpdate!="function"||c===e.memoizedProps&&q===e.memoizedState||(r.flags|=1024),h=!1)}return Wv(e,r,o,h,b,_)}function Wv(e,r,o,h,_,b){s4(e,r);var w=(r.flags&128)!==0;if(!h&&!w)return _&&fb(r,o,!1),Lu(e,r,b);h=r.stateNode,HT.current=r;var c=w&&typeof o.getDerivedStateFromError!="function"?null:h.render();return r.flags|=1,e!==null&&w?(r.child=$f(r,e.child,null,b),r.child=$f(r,null,c,b)):Ws(e,r,c,b),r.memoizedState=h.state,_&&fb(r,o,!0),r.child}function o4(e){var r=e.stateNode;r.pendingContext?db(e,r.pendingContext,r.pendingContext!==r.context):r.context&&db(e,r.context,!1),Zx(e,r.containerInfo)}function Pb(e,r,o,h,_){return jf(),Nx(_),r.flags|=256,Ws(e,r,o,h),r.child}var Hv={dehydrated:null,treeContext:null,retryLane:0};function Xv(e){return{baseLanes:e,cachePool:null,transitions:null}}function a4(e,r,o){var h=r.pendingProps,_=Zr.current,b=!1,w=(r.flags&128)!==0,c;if((c=w)||(c=e!==null&&e.memoizedState===null?!1:(_&2)!==0),c?(b=!0,r.flags&=-129):(e===null||e.memoizedState!==null)&&(_|=1),kr(Zr,_&1),e===null)return jv(r),e=r.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(r.mode&1?e.data==="$!"?r.lanes=8:r.lanes=1073741824:r.lanes=1,null):(w=h.children,e=h.fallback,b?(h=r.mode,b=r.child,w={mode:"hidden",children:w},!(h&1)&&b!==null?(b.childLanes=0,b.pendingProps=w):b=K0(w,h,0,null),e=nd(e,h,o,null),b.return=r,e.return=r,b.sibling=e,r.child=b,r.child.memoizedState=Xv(o),r.memoizedState=Hv,e):Qx(r,w));if(_=e.memoizedState,_!==null&&(c=_.dehydrated,c!==null))return XT(e,r,w,h,c,_,o);if(b){b=h.fallback,w=r.mode,_=e.child,c=_.sibling;var D={mode:"hidden",children:h.children};return!(w&1)&&r.child!==_?(h=r.child,h.childLanes=0,h.pendingProps=D,r.deletions=null):(h=Nc(_,D),h.subtreeFlags=_.subtreeFlags&14680064),c!==null?b=Nc(c,b):(b=nd(b,w,o,null),b.flags|=2),b.return=r,h.return=r,h.sibling=b,r.child=h,h=b,b=r.child,w=e.child.memoizedState,w=w===null?Xv(o):{baseLanes:w.baseLanes|o,cachePool:null,transitions:w.transitions},b.memoizedState=w,b.childLanes=e.childLanes&~o,r.memoizedState=Hv,h}return b=e.child,e=b.sibling,h=Nc(b,{mode:"visible",children:h.children}),!(r.mode&1)&&(h.lanes=o),h.return=r,h.sibling=null,e!==null&&(o=r.deletions,o===null?(r.deletions=[e],r.flags|=16):o.push(e)),r.child=h,r.memoizedState=null,h}function Qx(e,r){return r=K0({mode:"visible",children:r},e.mode,0,null),r.return=e,e.child=r}function z_(e,r,o,h){return h!==null&&Nx(h),$f(r,e.child,null,o),e=Qx(r,r.pendingProps.children),e.flags|=2,r.memoizedState=null,e}function XT(e,r,o,h,_,b,w){if(o)return r.flags&256?(r.flags&=-257,h=Z1(Error(ut(422))),z_(e,r,w,h)):r.memoizedState!==null?(r.child=e.child,r.flags|=128,null):(b=h.fallback,_=r.mode,h=K0({mode:"visible",children:h.children},_,0,null),b=nd(b,_,w,null),b.flags|=2,h.return=r,b.return=r,h.sibling=b,r.child=h,r.mode&1&&$f(r,e.child,null,w),r.child.memoizedState=Xv(w),r.memoizedState=Hv,b);if(!(r.mode&1))return z_(e,r,w,null);if(_.data==="$!"){if(h=_.nextSibling&&_.nextSibling.dataset,h)var c=h.dgst;return h=c,b=Error(ut(419)),h=Z1(b,h,void 0),z_(e,r,w,h)}if(c=(w&e.childLanes)!==0,oo||c){if(h=Zi,h!==null){switch(w&-w){case 4:_=2;break;case 16:_=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:_=32;break;case 536870912:_=268435456;break;default:_=0}_=_&(h.suspendedLanes|w)?0:_,_!==0&&_!==b.retryLane&&(b.retryLane=_,Ru(e,_),Ka(h,e,_,-1))}return sw(),h=Z1(Error(ut(421))),z_(e,r,w,h)}return _.data==="$?"?(r.flags|=128,r.child=e.child,r=lE.bind(null,e),_._reactRetry=r,null):(e=b.treeContext,Mo=Lc(_.nextSibling),Do=r,Ur=!0,Wa=null,e!==null&&(oa[aa++]=Iu,oa[aa++]=ku,oa[aa++]=sd,Iu=e.id,ku=e.overflow,sd=r),r=Qx(r,h.children),r.flags|=4096,r)}function Ab(e,r,o){e.lanes|=r;var h=e.alternate;h!==null&&(h.lanes|=r),$v(e.return,r,o)}function G1(e,r,o,h,_){var b=e.memoizedState;b===null?e.memoizedState={isBackwards:r,rendering:null,renderingStartTime:0,last:h,tail:o,tailMode:_}:(b.isBackwards=r,b.rendering=null,b.renderingStartTime=0,b.last=h,b.tail=o,b.tailMode=_)}function l4(e,r,o){var h=r.pendingProps,_=h.revealOrder,b=h.tail;if(Ws(e,r,h.children,o),h=Zr.current,h&2)h=h&1|2,r.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=r.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Ab(e,o,r);else if(e.tag===19)Ab(e,o,r);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===r)break e;for(;e.sibling===null;){if(e.return===null||e.return===r)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}h&=1}if(kr(Zr,h),!(r.mode&1))r.memoizedState=null;else switch(_){case"forwards":for(o=r.child,_=null;o!==null;)e=o.alternate,e!==null&&g0(e)===null&&(_=o),o=o.sibling;o=_,o===null?(_=r.child,r.child=null):(_=o.sibling,o.sibling=null),G1(r,!1,_,o,b);break;case"backwards":for(o=null,_=r.child,r.child=null;_!==null;){if(e=_.alternate,e!==null&&g0(e)===null){r.child=_;break}e=_.sibling,_.sibling=o,o=_,_=e}G1(r,!0,o,null,b);break;case"together":G1(r,!1,null,null,void 0);break;default:r.memoizedState=null}return r.child}function X_(e,r){!(r.mode&1)&&e!==null&&(e.alternate=null,r.alternate=null,r.flags|=2)}function Lu(e,r,o){if(e!==null&&(r.dependencies=e.dependencies),ad|=r.lanes,!(o&r.childLanes))return null;if(e!==null&&r.child!==e.child)throw Error(ut(153));if(r.child!==null){for(e=r.child,o=Nc(e,e.pendingProps),r.child=o,o.return=r;e.sibling!==null;)e=e.sibling,o=o.sibling=Nc(e,e.pendingProps),o.return=r;o.sibling=null}return r.child}function KT(e,r,o){switch(r.tag){case 3:o4(r),jf();break;case 5:R3(r);break;case 1:lo(r.type)&&c0(r);break;case 4:Zx(r,r.stateNode.containerInfo);break;case 10:var h=r.type._context,_=r.memoizedProps.value;kr(f0,h._currentValue),h._currentValue=_;break;case 13:if(h=r.memoizedState,h!==null)return h.dehydrated!==null?(kr(Zr,Zr.current&1),r.flags|=128,null):o&r.child.childLanes?a4(e,r,o):(kr(Zr,Zr.current&1),e=Lu(e,r,o),e!==null?e.sibling:null);kr(Zr,Zr.current&1);break;case 19:if(h=(o&r.childLanes)!==0,e.flags&128){if(h)return l4(e,r,o);r.flags|=128}if(_=r.memoizedState,_!==null&&(_.rendering=null,_.tail=null,_.lastEffect=null),kr(Zr,Zr.current),h)break;return null;case 22:case 23:return r.lanes=0,i4(e,r,o)}return Lu(e,r,o)}var u4,Kv,c4,h4;u4=function(e,r){for(var o=r.child;o!==null;){if(o.tag===5||o.tag===6)e.appendChild(o.stateNode);else if(o.tag!==4&&o.child!==null){o.child.return=o,o=o.child;continue}if(o===r)break;for(;o.sibling===null;){if(o.return===null||o.return===r)return;o=o.return}o.sibling.return=o.return,o=o.sibling}};Kv=function(){};c4=function(e,r,o,h){var _=e.memoizedProps;if(_!==h){e=r.stateNode,ed(Bl.current);var b=null;switch(o){case"input":_=yv(e,_),h=yv(e,h),b=[];break;case"select":_=Wr({},_,{value:void 0}),h=Wr({},h,{value:void 0}),b=[];break;case"textarea":_=wv(e,_),h=wv(e,h),b=[];break;default:typeof _.onClick!="function"&&typeof h.onClick=="function"&&(e.onclick=l0)}Sv(o,h);var w;o=null;for(U in _)if(!h.hasOwnProperty(U)&&_.hasOwnProperty(U)&&_[U]!=null)if(U==="style"){var c=_[U];for(w in c)c.hasOwnProperty(w)&&(o||(o={}),o[w]="")}else U!=="dangerouslySetInnerHTML"&&U!=="children"&&U!=="suppressContentEditableWarning"&&U!=="suppressHydrationWarning"&&U!=="autoFocus"&&(Pm.hasOwnProperty(U)?b||(b=[]):(b=b||[]).push(U,null));for(U in h){var D=h[U];if(c=_!=null?_[U]:void 0,h.hasOwnProperty(U)&&D!==c&&(D!=null||c!=null))if(U==="style")if(c){for(w in c)!c.hasOwnProperty(w)||D&&D.hasOwnProperty(w)||(o||(o={}),o[w]="");for(w in D)D.hasOwnProperty(w)&&c[w]!==D[w]&&(o||(o={}),o[w]=D[w])}else o||(b||(b=[]),b.push(U,o)),o=D;else U==="dangerouslySetInnerHTML"?(D=D?D.__html:void 0,c=c?c.__html:void 0,D!=null&&c!==D&&(b=b||[]).push(U,D)):U==="children"?typeof D!="string"&&typeof D!="number"||(b=b||[]).push(U,""+D):U!=="suppressContentEditableWarning"&&U!=="suppressHydrationWarning"&&(Pm.hasOwnProperty(U)?(D!=null&&U==="onScroll"&&Dr("scroll",e),b||c===D||(b=[])):(b=b||[]).push(U,D))}o&&(b=b||[]).push("style",o);var U=b;(r.updateQueue=U)&&(r.flags|=4)}};h4=function(e,r,o,h){o!==h&&(r.flags|=4)};function dm(e,r){if(!Ur)switch(e.tailMode){case"hidden":r=e.tail;for(var o=null;r!==null;)r.alternate!==null&&(o=r),r=r.sibling;o===null?e.tail=null:o.sibling=null;break;case"collapsed":o=e.tail;for(var h=null;o!==null;)o.alternate!==null&&(h=o),o=o.sibling;h===null?r||e.tail===null?e.tail=null:e.tail.sibling=null:h.sibling=null}}function As(e){var r=e.alternate!==null&&e.alternate.child===e.child,o=0,h=0;if(r)for(var _=e.child;_!==null;)o|=_.lanes|_.childLanes,h|=_.subtreeFlags&14680064,h|=_.flags&14680064,_.return=e,_=_.sibling;else for(_=e.child;_!==null;)o|=_.lanes|_.childLanes,h|=_.subtreeFlags,h|=_.flags,_.return=e,_=_.sibling;return e.subtreeFlags|=h,e.childLanes=o,r}function YT(e,r,o){var h=r.pendingProps;switch(Bx(r),r.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return As(r),null;case 1:return lo(r.type)&&u0(),As(r),null;case 3:return h=r.stateNode,Vf(),Rr(ao),Rr(Ds),Wx(),h.pendingContext&&(h.context=h.pendingContext,h.pendingContext=null),(e===null||e.child===null)&&(A_(r)?r.flags|=4:e===null||e.memoizedState.isDehydrated&&!(r.flags&256)||(r.flags|=1024,Wa!==null&&(ix(Wa),Wa=null))),Kv(e,r),As(r),null;case 5:Gx(r);var _=ed(jm.current);if(o=r.type,e!==null&&r.stateNode!=null)c4(e,r,o,h,_),e.ref!==r.ref&&(r.flags|=512,r.flags|=2097152);else{if(!h){if(r.stateNode===null)throw Error(ut(166));return As(r),null}if(e=ed(Bl.current),A_(r)){h=r.stateNode,o=r.type;var b=r.memoizedProps;switch(h[Ll]=r,h[Nm]=b,e=(r.mode&1)!==0,o){case"dialog":Dr("cancel",h),Dr("close",h);break;case"iframe":case"object":case"embed":Dr("load",h);break;case"video":case"audio":for(_=0;_<ym.length;_++)Dr(ym[_],h);break;case"source":Dr("error",h);break;case"img":case"image":case"link":Dr("error",h),Dr("load",h);break;case"details":Dr("toggle",h);break;case"input":Nw(h,b),Dr("invalid",h);break;case"select":h._wrapperState={wasMultiple:!!b.multiple},Dr("invalid",h);break;case"textarea":jw(h,b),Dr("invalid",h)}Sv(o,b),_=null;for(var w in b)if(b.hasOwnProperty(w)){var c=b[w];w==="children"?typeof c=="string"?h.textContent!==c&&(b.suppressHydrationWarning!==!0&&P_(h.textContent,c,e),_=["children",c]):typeof c=="number"&&h.textContent!==""+c&&(b.suppressHydrationWarning!==!0&&P_(h.textContent,c,e),_=["children",""+c]):Pm.hasOwnProperty(w)&&c!=null&&w==="onScroll"&&Dr("scroll",h)}switch(o){case"input":w_(h),Uw(h,b,!0);break;case"textarea":w_(h),$w(h);break;case"select":case"option":break;default:typeof b.onClick=="function"&&(h.onclick=l0)}h=_,r.updateQueue=h,h!==null&&(r.flags|=4)}else{w=_.nodeType===9?_:_.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=N2(o)),e==="http://www.w3.org/1999/xhtml"?o==="script"?(e=w.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof h.is=="string"?e=w.createElement(o,{is:h.is}):(e=w.createElement(o),o==="select"&&(w=e,h.multiple?w.multiple=!0:h.size&&(w.size=h.size))):e=w.createElementNS(e,o),e[Ll]=r,e[Nm]=h,u4(e,r,!1,!1),r.stateNode=e;e:{switch(w=Tv(o,h),o){case"dialog":Dr("cancel",e),Dr("close",e),_=h;break;case"iframe":case"object":case"embed":Dr("load",e),_=h;break;case"video":case"audio":for(_=0;_<ym.length;_++)Dr(ym[_],e);_=h;break;case"source":Dr("error",e),_=h;break;case"img":case"image":case"link":Dr("error",e),Dr("load",e),_=h;break;case"details":Dr("toggle",e),_=h;break;case"input":Nw(e,h),_=yv(e,h),Dr("invalid",e);break;case"option":_=h;break;case"select":e._wrapperState={wasMultiple:!!h.multiple},_=Wr({},h,{value:void 0}),Dr("invalid",e);break;case"textarea":jw(e,h),_=wv(e,h),Dr("invalid",e);break;default:_=h}Sv(o,_),c=_;for(b in c)if(c.hasOwnProperty(b)){var D=c[b];b==="style"?$2(e,D):b==="dangerouslySetInnerHTML"?(D=D?D.__html:void 0,D!=null&&U2(e,D)):b==="children"?typeof D=="string"?(o!=="textarea"||D!=="")&&Am(e,D):typeof D=="number"&&Am(e,""+D):b!=="suppressContentEditableWarning"&&b!=="suppressHydrationWarning"&&b!=="autoFocus"&&(Pm.hasOwnProperty(b)?D!=null&&b==="onScroll"&&Dr("scroll",e):D!=null&&Sx(e,b,D,w))}switch(o){case"input":w_(e),Uw(e,h,!1);break;case"textarea":w_(e),$w(e);break;case"option":h.value!=null&&e.setAttribute("value",""+Uc(h.value));break;case"select":e.multiple=!!h.multiple,b=h.value,b!=null?zf(e,!!h.multiple,b,!1):h.defaultValue!=null&&zf(e,!!h.multiple,h.defaultValue,!0);break;default:typeof _.onClick=="function"&&(e.onclick=l0)}switch(o){case"button":case"input":case"select":case"textarea":h=!!h.autoFocus;break e;case"img":h=!0;break e;default:h=!1}}h&&(r.flags|=4)}r.ref!==null&&(r.flags|=512,r.flags|=2097152)}return As(r),null;case 6:if(e&&r.stateNode!=null)h4(e,r,e.memoizedProps,h);else{if(typeof h!="string"&&r.stateNode===null)throw Error(ut(166));if(o=ed(jm.current),ed(Bl.current),A_(r)){if(h=r.stateNode,o=r.memoizedProps,h[Ll]=r,(b=h.nodeValue!==o)&&(e=Do,e!==null))switch(e.tag){case 3:P_(h.nodeValue,o,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&P_(h.nodeValue,o,(e.mode&1)!==0)}b&&(r.flags|=4)}else h=(o.nodeType===9?o:o.ownerDocument).createTextNode(h),h[Ll]=r,r.stateNode=h}return As(r),null;case 13:if(Rr(Zr),h=r.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Ur&&Mo!==null&&r.mode&1&&!(r.flags&128))P3(),jf(),r.flags|=98560,b=!1;else if(b=A_(r),h!==null&&h.dehydrated!==null){if(e===null){if(!b)throw Error(ut(318));if(b=r.memoizedState,b=b!==null?b.dehydrated:null,!b)throw Error(ut(317));b[Ll]=r}else jf(),!(r.flags&128)&&(r.memoizedState=null),r.flags|=4;As(r),b=!1}else Wa!==null&&(ix(Wa),Wa=null),b=!0;if(!b)return r.flags&65536?r:null}return r.flags&128?(r.lanes=o,r):(h=h!==null,h!==(e!==null&&e.memoizedState!==null)&&h&&(r.child.flags|=8192,r.mode&1&&(e===null||Zr.current&1?Di===0&&(Di=3):sw())),r.updateQueue!==null&&(r.flags|=4),As(r),null);case 4:return Vf(),Kv(e,r),e===null&&Fm(r.stateNode.containerInfo),As(r),null;case 10:return $x(r.type._context),As(r),null;case 17:return lo(r.type)&&u0(),As(r),null;case 19:if(Rr(Zr),b=r.memoizedState,b===null)return As(r),null;if(h=(r.flags&128)!==0,w=b.rendering,w===null)if(h)dm(b,!1);else{if(Di!==0||e!==null&&e.flags&128)for(e=r.child;e!==null;){if(w=g0(e),w!==null){for(r.flags|=128,dm(b,!1),h=w.updateQueue,h!==null&&(r.updateQueue=h,r.flags|=4),r.subtreeFlags=0,h=o,o=r.child;o!==null;)b=o,e=h,b.flags&=14680066,w=b.alternate,w===null?(b.childLanes=0,b.lanes=e,b.child=null,b.subtreeFlags=0,b.memoizedProps=null,b.memoizedState=null,b.updateQueue=null,b.dependencies=null,b.stateNode=null):(b.childLanes=w.childLanes,b.lanes=w.lanes,b.child=w.child,b.subtreeFlags=0,b.deletions=null,b.memoizedProps=w.memoizedProps,b.memoizedState=w.memoizedState,b.updateQueue=w.updateQueue,b.type=w.type,e=w.dependencies,b.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),o=o.sibling;return kr(Zr,Zr.current&1|2),r.child}e=e.sibling}b.tail!==null&&ci()>Zf&&(r.flags|=128,h=!0,dm(b,!1),r.lanes=4194304)}else{if(!h)if(e=g0(w),e!==null){if(r.flags|=128,h=!0,o=e.updateQueue,o!==null&&(r.updateQueue=o,r.flags|=4),dm(b,!0),b.tail===null&&b.tailMode==="hidden"&&!w.alternate&&!Ur)return As(r),null}else 2*ci()-b.renderingStartTime>Zf&&o!==1073741824&&(r.flags|=128,h=!0,dm(b,!1),r.lanes=4194304);b.isBackwards?(w.sibling=r.child,r.child=w):(o=b.last,o!==null?o.sibling=w:r.child=w,b.last=w)}return b.tail!==null?(r=b.tail,b.rendering=r,b.tail=r.sibling,b.renderingStartTime=ci(),r.sibling=null,o=Zr.current,kr(Zr,h?o&1|2:o&1),r):(As(r),null);case 22:case 23:return iw(),h=r.memoizedState!==null,e!==null&&e.memoizedState!==null!==h&&(r.flags|=8192),h&&r.mode&1?Ao&1073741824&&(As(r),r.subtreeFlags&6&&(r.flags|=8192)):As(r),null;case 24:return null;case 25:return null}throw Error(ut(156,r.tag))}function JT(e,r){switch(Bx(r),r.tag){case 1:return lo(r.type)&&u0(),e=r.flags,e&65536?(r.flags=e&-65537|128,r):null;case 3:return Vf(),Rr(ao),Rr(Ds),Wx(),e=r.flags,e&65536&&!(e&128)?(r.flags=e&-65537|128,r):null;case 5:return Gx(r),null;case 13:if(Rr(Zr),e=r.memoizedState,e!==null&&e.dehydrated!==null){if(r.alternate===null)throw Error(ut(340));jf()}return e=r.flags,e&65536?(r.flags=e&-65537|128,r):null;case 19:return Rr(Zr),null;case 4:return Vf(),null;case 10:return $x(r.type._context),null;case 22:case 23:return iw(),null;case 24:return null;default:return null}}var D_=!1,Ms=!1,QT=typeof WeakSet=="function"?WeakSet:Set,Dt=null;function Pf(e,r){var o=e.ref;if(o!==null)if(typeof o=="function")try{o(null)}catch(h){ti(e,r,h)}else o.current=null}function Yv(e,r,o){try{o()}catch(h){ti(e,r,h)}}var Mb=!1;function eE(e,r){if(Rv=s0,e=g3(),Ox(e)){if("selectionStart"in e)var o={start:e.selectionStart,end:e.selectionEnd};else e:{o=(o=e.ownerDocument)&&o.defaultView||window;var h=o.getSelection&&o.getSelection();if(h&&h.rangeCount!==0){o=h.anchorNode;var _=h.anchorOffset,b=h.focusNode;h=h.focusOffset;try{o.nodeType,b.nodeType}catch{o=null;break e}var w=0,c=-1,D=-1,U=0,J=0,W=e,q=null;t:for(;;){for(var Ee;W!==o||_!==0&&W.nodeType!==3||(c=w+_),W!==b||h!==0&&W.nodeType!==3||(D=w+h),W.nodeType===3&&(w+=W.nodeValue.length),(Ee=W.firstChild)!==null;)q=W,W=Ee;for(;;){if(W===e)break t;if(q===o&&++U===_&&(c=w),q===b&&++J===h&&(D=w),(Ee=W.nextSibling)!==null)break;W=q,q=W.parentNode}W=Ee}o=c===-1||D===-1?null:{start:c,end:D}}else o=null}o=o||{start:0,end:0}}else o=null;for(Lv={focusedElem:e,selectionRange:o},s0=!1,Dt=r;Dt!==null;)if(r=Dt,e=r.child,(r.subtreeFlags&1028)!==0&&e!==null)e.return=r,Dt=e;else for(;Dt!==null;){r=Dt;try{var ze=r.alternate;if(r.flags&1024)switch(r.tag){case 0:case 11:case 15:break;case 1:if(ze!==null){var Ne=ze.memoizedProps,Be=ze.memoizedState,se=r.stateNode,ue=se.getSnapshotBeforeUpdate(r.elementType===r.type?Ne:Za(r.type,Ne),Be);se.__reactInternalSnapshotBeforeUpdate=ue}break;case 3:var he=r.stateNode.containerInfo;he.nodeType===1?he.textContent="":he.nodeType===9&&he.documentElement&&he.removeChild(he.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(ut(163))}}catch(De){ti(r,r.return,De)}if(e=r.sibling,e!==null){e.return=r.return,Dt=e;break}Dt=r.return}return ze=Mb,Mb=!1,ze}function Cm(e,r,o){var h=r.updateQueue;if(h=h!==null?h.lastEffect:null,h!==null){var _=h=h.next;do{if((_.tag&e)===e){var b=_.destroy;_.destroy=void 0,b!==void 0&&Yv(r,o,b)}_=_.next}while(_!==h)}}function H0(e,r){if(r=r.updateQueue,r=r!==null?r.lastEffect:null,r!==null){var o=r=r.next;do{if((o.tag&e)===e){var h=o.create;o.destroy=h()}o=o.next}while(o!==r)}}function Jv(e){var r=e.ref;if(r!==null){var o=e.stateNode;switch(e.tag){case 5:e=o;break;default:e=o}typeof r=="function"?r(e):r.current=e}}function d4(e){var r=e.alternate;r!==null&&(e.alternate=null,d4(r)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(r=e.stateNode,r!==null&&(delete r[Ll],delete r[Nm],delete r[Bv],delete r[OT],delete r[FT])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function f4(e){return e.tag===5||e.tag===3||e.tag===4}function zb(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||f4(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Qv(e,r,o){var h=e.tag;if(h===5||h===6)e=e.stateNode,r?o.nodeType===8?o.parentNode.insertBefore(e,r):o.insertBefore(e,r):(o.nodeType===8?(r=o.parentNode,r.insertBefore(e,o)):(r=o,r.appendChild(e)),o=o._reactRootContainer,o!=null||r.onclick!==null||(r.onclick=l0));else if(h!==4&&(e=e.child,e!==null))for(Qv(e,r,o),e=e.sibling;e!==null;)Qv(e,r,o),e=e.sibling}function ex(e,r,o){var h=e.tag;if(h===5||h===6)e=e.stateNode,r?o.insertBefore(e,r):o.appendChild(e);else if(h!==4&&(e=e.child,e!==null))for(ex(e,r,o),e=e.sibling;e!==null;)ex(e,r,o),e=e.sibling}var is=null,Ga=!1;function Sc(e,r,o){for(o=o.child;o!==null;)p4(e,r,o),o=o.sibling}function p4(e,r,o){if(Fl&&typeof Fl.onCommitFiberUnmount=="function")try{Fl.onCommitFiberUnmount(U0,o)}catch{}switch(o.tag){case 5:Ms||Pf(o,r);case 6:var h=is,_=Ga;is=null,Sc(e,r,o),is=h,Ga=_,is!==null&&(Ga?(e=is,o=o.stateNode,e.nodeType===8?e.parentNode.removeChild(o):e.removeChild(o)):is.removeChild(o.stateNode));break;case 18:is!==null&&(Ga?(e=is,o=o.stateNode,e.nodeType===8?N1(e.parentNode,o):e.nodeType===1&&N1(e,o),Rm(e)):N1(is,o.stateNode));break;case 4:h=is,_=Ga,is=o.stateNode.containerInfo,Ga=!0,Sc(e,r,o),is=h,Ga=_;break;case 0:case 11:case 14:case 15:if(!Ms&&(h=o.updateQueue,h!==null&&(h=h.lastEffect,h!==null))){_=h=h.next;do{var b=_,w=b.destroy;b=b.tag,w!==void 0&&(b&2||b&4)&&Yv(o,r,w),_=_.next}while(_!==h)}Sc(e,r,o);break;case 1:if(!Ms&&(Pf(o,r),h=o.stateNode,typeof h.componentWillUnmount=="function"))try{h.props=o.memoizedProps,h.state=o.memoizedState,h.componentWillUnmount()}catch(c){ti(o,r,c)}Sc(e,r,o);break;case 21:Sc(e,r,o);break;case 22:o.mode&1?(Ms=(h=Ms)||o.memoizedState!==null,Sc(e,r,o),Ms=h):Sc(e,r,o);break;default:Sc(e,r,o)}}function Db(e){var r=e.updateQueue;if(r!==null){e.updateQueue=null;var o=e.stateNode;o===null&&(o=e.stateNode=new QT),r.forEach(function(h){var _=uE.bind(null,e,h);o.has(h)||(o.add(h),h.then(_,_))})}}function Va(e,r){var o=r.deletions;if(o!==null)for(var h=0;h<o.length;h++){var _=o[h];try{var b=e,w=r,c=w;e:for(;c!==null;){switch(c.tag){case 5:is=c.stateNode,Ga=!1;break e;case 3:is=c.stateNode.containerInfo,Ga=!0;break e;case 4:is=c.stateNode.containerInfo,Ga=!0;break e}c=c.return}if(is===null)throw Error(ut(160));p4(b,w,_),is=null,Ga=!1;var D=_.alternate;D!==null&&(D.return=null),_.return=null}catch(U){ti(_,r,U)}}if(r.subtreeFlags&12854)for(r=r.child;r!==null;)m4(r,e),r=r.sibling}function m4(e,r){var o=e.alternate,h=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Va(r,e),Dl(e),h&4){try{Cm(3,e,e.return),H0(3,e)}catch(Ne){ti(e,e.return,Ne)}try{Cm(5,e,e.return)}catch(Ne){ti(e,e.return,Ne)}}break;case 1:Va(r,e),Dl(e),h&512&&o!==null&&Pf(o,o.return);break;case 5:if(Va(r,e),Dl(e),h&512&&o!==null&&Pf(o,o.return),e.flags&32){var _=e.stateNode;try{Am(_,"")}catch(Ne){ti(e,e.return,Ne)}}if(h&4&&(_=e.stateNode,_!=null)){var b=e.memoizedProps,w=o!==null?o.memoizedProps:b,c=e.type,D=e.updateQueue;if(e.updateQueue=null,D!==null)try{c==="input"&&b.type==="radio"&&b.name!=null&&F2(_,b),Tv(c,w);var U=Tv(c,b);for(w=0;w<D.length;w+=2){var J=D[w],W=D[w+1];J==="style"?$2(_,W):J==="dangerouslySetInnerHTML"?U2(_,W):J==="children"?Am(_,W):Sx(_,J,W,U)}switch(c){case"input":vv(_,b);break;case"textarea":B2(_,b);break;case"select":var q=_._wrapperState.wasMultiple;_._wrapperState.wasMultiple=!!b.multiple;var Ee=b.value;Ee!=null?zf(_,!!b.multiple,Ee,!1):q!==!!b.multiple&&(b.defaultValue!=null?zf(_,!!b.multiple,b.defaultValue,!0):zf(_,!!b.multiple,b.multiple?[]:"",!1))}_[Nm]=b}catch(Ne){ti(e,e.return,Ne)}}break;case 6:if(Va(r,e),Dl(e),h&4){if(e.stateNode===null)throw Error(ut(162));_=e.stateNode,b=e.memoizedProps;try{_.nodeValue=b}catch(Ne){ti(e,e.return,Ne)}}break;case 3:if(Va(r,e),Dl(e),h&4&&o!==null&&o.memoizedState.isDehydrated)try{Rm(r.containerInfo)}catch(Ne){ti(e,e.return,Ne)}break;case 4:Va(r,e),Dl(e);break;case 13:Va(r,e),Dl(e),_=e.child,_.flags&8192&&(b=_.memoizedState!==null,_.stateNode.isHidden=b,!b||_.alternate!==null&&_.alternate.memoizedState!==null||(nw=ci())),h&4&&Db(e);break;case 22:if(J=o!==null&&o.memoizedState!==null,e.mode&1?(Ms=(U=Ms)||J,Va(r,e),Ms=U):Va(r,e),Dl(e),h&8192){if(U=e.memoizedState!==null,(e.stateNode.isHidden=U)&&!J&&e.mode&1)for(Dt=e,J=e.child;J!==null;){for(W=Dt=J;Dt!==null;){switch(q=Dt,Ee=q.child,q.tag){case 0:case 11:case 14:case 15:Cm(4,q,q.return);break;case 1:Pf(q,q.return);var ze=q.stateNode;if(typeof ze.componentWillUnmount=="function"){h=q,o=q.return;try{r=h,ze.props=r.memoizedProps,ze.state=r.memoizedState,ze.componentWillUnmount()}catch(Ne){ti(h,o,Ne)}}break;case 5:Pf(q,q.return);break;case 22:if(q.memoizedState!==null){Lb(W);continue}}Ee!==null?(Ee.return=q,Dt=Ee):Lb(W)}J=J.sibling}e:for(J=null,W=e;;){if(W.tag===5){if(J===null){J=W;try{_=W.stateNode,U?(b=_.style,typeof b.setProperty=="function"?b.setProperty("display","none","important"):b.display="none"):(c=W.stateNode,D=W.memoizedProps.style,w=D!=null&&D.hasOwnProperty("display")?D.display:null,c.style.display=j2("display",w))}catch(Ne){ti(e,e.return,Ne)}}}else if(W.tag===6){if(J===null)try{W.stateNode.nodeValue=U?"":W.memoizedProps}catch(Ne){ti(e,e.return,Ne)}}else if((W.tag!==22&&W.tag!==23||W.memoizedState===null||W===e)&&W.child!==null){W.child.return=W,W=W.child;continue}if(W===e)break e;for(;W.sibling===null;){if(W.return===null||W.return===e)break e;J===W&&(J=null),W=W.return}J===W&&(J=null),W.sibling.return=W.return,W=W.sibling}}break;case 19:Va(r,e),Dl(e),h&4&&Db(e);break;case 21:break;default:Va(r,e),Dl(e)}}function Dl(e){var r=e.flags;if(r&2){try{e:{for(var o=e.return;o!==null;){if(f4(o)){var h=o;break e}o=o.return}throw Error(ut(160))}switch(h.tag){case 5:var _=h.stateNode;h.flags&32&&(Am(_,""),h.flags&=-33);var b=zb(e);ex(e,b,_);break;case 3:case 4:var w=h.stateNode.containerInfo,c=zb(e);Qv(e,c,w);break;default:throw Error(ut(161))}}catch(D){ti(e,e.return,D)}e.flags&=-3}r&4096&&(e.flags&=-4097)}function tE(e,r,o){Dt=e,g4(e)}function g4(e,r,o){for(var h=(e.mode&1)!==0;Dt!==null;){var _=Dt,b=_.child;if(_.tag===22&&h){var w=_.memoizedState!==null||D_;if(!w){var c=_.alternate,D=c!==null&&c.memoizedState!==null||Ms;c=D_;var U=Ms;if(D_=w,(Ms=D)&&!U)for(Dt=_;Dt!==null;)w=Dt,D=w.child,w.tag===22&&w.memoizedState!==null?Ob(_):D!==null?(D.return=w,Dt=D):Ob(_);for(;b!==null;)Dt=b,g4(b),b=b.sibling;Dt=_,D_=c,Ms=U}Rb(e)}else _.subtreeFlags&8772&&b!==null?(b.return=_,Dt=b):Rb(e)}}function Rb(e){for(;Dt!==null;){var r=Dt;if(r.flags&8772){var o=r.alternate;try{if(r.flags&8772)switch(r.tag){case 0:case 11:case 15:Ms||H0(5,r);break;case 1:var h=r.stateNode;if(r.flags&4&&!Ms)if(o===null)h.componentDidMount();else{var _=r.elementType===r.type?o.memoizedProps:Za(r.type,o.memoizedProps);h.componentDidUpdate(_,o.memoizedState,h.__reactInternalSnapshotBeforeUpdate)}var b=r.updateQueue;b!==null&&yb(r,b,h);break;case 3:var w=r.updateQueue;if(w!==null){if(o=null,r.child!==null)switch(r.child.tag){case 5:o=r.child.stateNode;break;case 1:o=r.child.stateNode}yb(r,w,o)}break;case 5:var c=r.stateNode;if(o===null&&r.flags&4){o=c;var D=r.memoizedProps;switch(r.type){case"button":case"input":case"select":case"textarea":D.autoFocus&&o.focus();break;case"img":D.src&&(o.src=D.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(r.memoizedState===null){var U=r.alternate;if(U!==null){var J=U.memoizedState;if(J!==null){var W=J.dehydrated;W!==null&&Rm(W)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(ut(163))}Ms||r.flags&512&&Jv(r)}catch(q){ti(r,r.return,q)}}if(r===e){Dt=null;break}if(o=r.sibling,o!==null){o.return=r.return,Dt=o;break}Dt=r.return}}function Lb(e){for(;Dt!==null;){var r=Dt;if(r===e){Dt=null;break}var o=r.sibling;if(o!==null){o.return=r.return,Dt=o;break}Dt=r.return}}function Ob(e){for(;Dt!==null;){var r=Dt;try{switch(r.tag){case 0:case 11:case 15:var o=r.return;try{H0(4,r)}catch(D){ti(r,o,D)}break;case 1:var h=r.stateNode;if(typeof h.componentDidMount=="function"){var _=r.return;try{h.componentDidMount()}catch(D){ti(r,_,D)}}var b=r.return;try{Jv(r)}catch(D){ti(r,b,D)}break;case 5:var w=r.return;try{Jv(r)}catch(D){ti(r,w,D)}}}catch(D){ti(r,r.return,D)}if(r===e){Dt=null;break}var c=r.sibling;if(c!==null){c.return=r.return,Dt=c;break}Dt=r.return}}var nE=Math.ceil,v0=Fu.ReactCurrentDispatcher,ew=Fu.ReactCurrentOwner,ua=Fu.ReactCurrentBatchConfig,Jn=0,Zi=null,Ti=null,ss=0,Ao=0,Af=qc(0),Di=0,Zm=null,ad=0,X0=0,tw=0,Im=null,so=null,nw=0,Zf=1/0,Tu=null,x0=!1,tx=null,Fc=null,R_=!1,Mc=null,w0=0,km=0,nx=null,K_=-1,Y_=0;function Hs(){return Jn&6?ci():K_!==-1?K_:K_=ci()}function Bc(e){return e.mode&1?Jn&2&&ss!==0?ss&-ss:NT.transition!==null?(Y_===0&&(Y_=e3()),Y_):(e=hr,e!==0||(e=window.event,e=e===void 0?16:a3(e.type)),e):1}function Ka(e,r,o,h){if(50<km)throw km=0,nx=null,Error(ut(185));Km(e,o,h),(!(Jn&2)||e!==Zi)&&(e===Zi&&(!(Jn&2)&&(X0|=o),Di===4&&Pc(e,ss)),uo(e,h),o===1&&Jn===0&&!(r.mode&1)&&(Zf=ci()+500,Z0&&Zc()))}function uo(e,r){var o=e.callbackNode;N6(e,r);var h=i0(e,e===Zi?ss:0);if(h===0)o!==null&&Zw(o),e.callbackNode=null,e.callbackPriority=0;else if(r=h&-h,e.callbackPriority!==r){if(o!=null&&Zw(o),r===1)e.tag===0?BT(Fb.bind(null,e)):C3(Fb.bind(null,e)),RT(function(){!(Jn&6)&&Zc()}),o=null;else{switch(t3(h)){case 1:o=kx;break;case 4:o=J2;break;case 16:o=r0;break;case 536870912:o=Q2;break;default:o=r0}o=T4(o,_4.bind(null,e))}e.callbackPriority=r,e.callbackNode=o}}function _4(e,r){if(K_=-1,Y_=0,Jn&6)throw Error(ut(327));var o=e.callbackNode;if(Ff()&&e.callbackNode!==o)return null;var h=i0(e,e===Zi?ss:0);if(h===0)return null;if(h&30||h&e.expiredLanes||r)r=b0(e,h);else{r=h;var _=Jn;Jn|=2;var b=v4();(Zi!==e||ss!==r)&&(Tu=null,Zf=ci()+500,td(e,r));do try{sE();break}catch(c){y4(e,c)}while(!0);jx(),v0.current=b,Jn=_,Ti!==null?r=0:(Zi=null,ss=0,r=Di)}if(r!==0){if(r===2&&(_=Pv(e),_!==0&&(h=_,r=rx(e,_))),r===1)throw o=Zm,td(e,0),Pc(e,h),uo(e,ci()),o;if(r===6)Pc(e,h);else{if(_=e.current.alternate,!(h&30)&&!rE(_)&&(r=b0(e,h),r===2&&(b=Pv(e),b!==0&&(h=b,r=rx(e,b))),r===1))throw o=Zm,td(e,0),Pc(e,h),uo(e,ci()),o;switch(e.finishedWork=_,e.finishedLanes=h,r){case 0:case 1:throw Error(ut(345));case 2:Hh(e,so,Tu);break;case 3:if(Pc(e,h),(h&130023424)===h&&(r=nw+500-ci(),10<r)){if(i0(e,0)!==0)break;if(_=e.suspendedLanes,(_&h)!==h){Hs(),e.pingedLanes|=e.suspendedLanes&_;break}e.timeoutHandle=Fv(Hh.bind(null,e,so,Tu),r);break}Hh(e,so,Tu);break;case 4:if(Pc(e,h),(h&4194240)===h)break;for(r=e.eventTimes,_=-1;0<h;){var w=31-Xa(h);b=1<<w,w=r[w],w>_&&(_=w),h&=~b}if(h=_,h=ci()-h,h=(120>h?120:480>h?480:1080>h?1080:1920>h?1920:3e3>h?3e3:4320>h?4320:1960*nE(h/1960))-h,10<h){e.timeoutHandle=Fv(Hh.bind(null,e,so,Tu),h);break}Hh(e,so,Tu);break;case 5:Hh(e,so,Tu);break;default:throw Error(ut(329))}}}return uo(e,ci()),e.callbackNode===o?_4.bind(null,e):null}function rx(e,r){var o=Im;return e.current.memoizedState.isDehydrated&&(td(e,r).flags|=256),e=b0(e,r),e!==2&&(r=so,so=o,r!==null&&ix(r)),e}function ix(e){so===null?so=e:so.push.apply(so,e)}function rE(e){for(var r=e;;){if(r.flags&16384){var o=r.updateQueue;if(o!==null&&(o=o.stores,o!==null))for(var h=0;h<o.length;h++){var _=o[h],b=_.getSnapshot;_=_.value;try{if(!Ja(b(),_))return!1}catch{return!1}}}if(o=r.child,r.subtreeFlags&16384&&o!==null)o.return=r,r=o;else{if(r===e)break;for(;r.sibling===null;){if(r.return===null||r.return===e)return!0;r=r.return}r.sibling.return=r.return,r=r.sibling}}return!0}function Pc(e,r){for(r&=~tw,r&=~X0,e.suspendedLanes|=r,e.pingedLanes&=~r,e=e.expirationTimes;0<r;){var o=31-Xa(r),h=1<<o;e[o]=-1,r&=~h}}function Fb(e){if(Jn&6)throw Error(ut(327));Ff();var r=i0(e,0);if(!(r&1))return uo(e,ci()),null;var o=b0(e,r);if(e.tag!==0&&o===2){var h=Pv(e);h!==0&&(r=h,o=rx(e,h))}if(o===1)throw o=Zm,td(e,0),Pc(e,r),uo(e,ci()),o;if(o===6)throw Error(ut(345));return e.finishedWork=e.current.alternate,e.finishedLanes=r,Hh(e,so,Tu),uo(e,ci()),null}function rw(e,r){var o=Jn;Jn|=1;try{return e(r)}finally{Jn=o,Jn===0&&(Zf=ci()+500,Z0&&Zc())}}function ld(e){Mc!==null&&Mc.tag===0&&!(Jn&6)&&Ff();var r=Jn;Jn|=1;var o=ua.transition,h=hr;try{if(ua.transition=null,hr=1,e)return e()}finally{hr=h,ua.transition=o,Jn=r,!(Jn&6)&&Zc()}}function iw(){Ao=Af.current,Rr(Af)}function td(e,r){e.finishedWork=null,e.finishedLanes=0;var o=e.timeoutHandle;if(o!==-1&&(e.timeoutHandle=-1,DT(o)),Ti!==null)for(o=Ti.return;o!==null;){var h=o;switch(Bx(h),h.tag){case 1:h=h.type.childContextTypes,h!=null&&u0();break;case 3:Vf(),Rr(ao),Rr(Ds),Wx();break;case 5:Gx(h);break;case 4:Vf();break;case 13:Rr(Zr);break;case 19:Rr(Zr);break;case 10:$x(h.type._context);break;case 22:case 23:iw()}o=o.return}if(Zi=e,Ti=e=Nc(e.current,null),ss=Ao=r,Di=0,Zm=null,tw=X0=ad=0,so=Im=null,Qh!==null){for(r=0;r<Qh.length;r++)if(o=Qh[r],h=o.interleaved,h!==null){o.interleaved=null;var _=h.next,b=o.pending;if(b!==null){var w=b.next;b.next=_,h.next=w}o.pending=h}Qh=null}return e}function y4(e,r){do{var o=Ti;try{if(jx(),W_.current=y0,_0){for(var h=Gr.memoizedState;h!==null;){var _=h.queue;_!==null&&(_.pending=null),h=h.next}_0=!1}if(od=0,qi=Mi=Gr=null,Em=!1,$m=0,ew.current=null,o===null||o.return===null){Di=1,Zm=r,Ti=null;break}e:{var b=e,w=o.return,c=o,D=r;if(r=ss,c.flags|=32768,D!==null&&typeof D=="object"&&typeof D.then=="function"){var U=D,J=c,W=J.tag;if(!(J.mode&1)&&(W===0||W===11||W===15)){var q=J.alternate;q?(J.updateQueue=q.updateQueue,J.memoizedState=q.memoizedState,J.lanes=q.lanes):(J.updateQueue=null,J.memoizedState=null)}var Ee=Tb(w);if(Ee!==null){Ee.flags&=-257,Eb(Ee,w,c,b,r),Ee.mode&1&&Sb(b,U,r),r=Ee,D=U;var ze=r.updateQueue;if(ze===null){var Ne=new Set;Ne.add(D),r.updateQueue=Ne}else ze.add(D);break e}else{if(!(r&1)){Sb(b,U,r),sw();break e}D=Error(ut(426))}}else if(Ur&&c.mode&1){var Be=Tb(w);if(Be!==null){!(Be.flags&65536)&&(Be.flags|=256),Eb(Be,w,c,b,r),Nx(qf(D,c));break e}}b=D=qf(D,c),Di!==4&&(Di=2),Im===null?Im=[b]:Im.push(b),b=w;do{switch(b.tag){case 3:b.flags|=65536,r&=-r,b.lanes|=r;var se=t4(b,D,r);_b(b,se);break e;case 1:c=D;var ue=b.type,he=b.stateNode;if(!(b.flags&128)&&(typeof ue.getDerivedStateFromError=="function"||he!==null&&typeof he.componentDidCatch=="function"&&(Fc===null||!Fc.has(he)))){b.flags|=65536,r&=-r,b.lanes|=r;var De=n4(b,c,r);_b(b,De);break e}}b=b.return}while(b!==null)}w4(o)}catch(Ze){r=Ze,Ti===o&&o!==null&&(Ti=o=o.return);continue}break}while(!0)}function v4(){var e=v0.current;return v0.current=y0,e===null?y0:e}function sw(){(Di===0||Di===3||Di===2)&&(Di=4),Zi===null||!(ad&268435455)&&!(X0&268435455)||Pc(Zi,ss)}function b0(e,r){var o=Jn;Jn|=2;var h=v4();(Zi!==e||ss!==r)&&(Tu=null,td(e,r));do try{iE();break}catch(_){y4(e,_)}while(!0);if(jx(),Jn=o,v0.current=h,Ti!==null)throw Error(ut(261));return Zi=null,ss=0,Di}function iE(){for(;Ti!==null;)x4(Ti)}function sE(){for(;Ti!==null&&!A6();)x4(Ti)}function x4(e){var r=S4(e.alternate,e,Ao);e.memoizedProps=e.pendingProps,r===null?w4(e):Ti=r,ew.current=null}function w4(e){var r=e;do{var o=r.alternate;if(e=r.return,r.flags&32768){if(o=JT(o,r),o!==null){o.flags&=32767,Ti=o;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Di=6,Ti=null;return}}else if(o=YT(o,r,Ao),o!==null){Ti=o;return}if(r=r.sibling,r!==null){Ti=r;return}Ti=r=e}while(r!==null);Di===0&&(Di=5)}function Hh(e,r,o){var h=hr,_=ua.transition;try{ua.transition=null,hr=1,oE(e,r,o,h)}finally{ua.transition=_,hr=h}return null}function oE(e,r,o,h){do Ff();while(Mc!==null);if(Jn&6)throw Error(ut(327));o=e.finishedWork;var _=e.finishedLanes;if(o===null)return null;if(e.finishedWork=null,e.finishedLanes=0,o===e.current)throw Error(ut(177));e.callbackNode=null,e.callbackPriority=0;var b=o.lanes|o.childLanes;if(U6(e,b),e===Zi&&(Ti=Zi=null,ss=0),!(o.subtreeFlags&2064)&&!(o.flags&2064)||R_||(R_=!0,T4(r0,function(){return Ff(),null})),b=(o.flags&15990)!==0,o.subtreeFlags&15990||b){b=ua.transition,ua.transition=null;var w=hr;hr=1;var c=Jn;Jn|=4,ew.current=null,eE(e,o),m4(o,e),CT(Lv),s0=!!Rv,Lv=Rv=null,e.current=o,tE(o),M6(),Jn=c,hr=w,ua.transition=b}else e.current=o;if(R_&&(R_=!1,Mc=e,w0=_),b=e.pendingLanes,b===0&&(Fc=null),R6(o.stateNode),uo(e,ci()),r!==null)for(h=e.onRecoverableError,o=0;o<r.length;o++)_=r[o],h(_.value,{componentStack:_.stack,digest:_.digest});if(x0)throw x0=!1,e=tx,tx=null,e;return w0&1&&e.tag!==0&&Ff(),b=e.pendingLanes,b&1?e===nx?km++:(km=0,nx=e):km=0,Zc(),null}function Ff(){if(Mc!==null){var e=t3(w0),r=ua.transition,o=hr;try{if(ua.transition=null,hr=16>e?16:e,Mc===null)var h=!1;else{if(e=Mc,Mc=null,w0=0,Jn&6)throw Error(ut(331));var _=Jn;for(Jn|=4,Dt=e.current;Dt!==null;){var b=Dt,w=b.child;if(Dt.flags&16){var c=b.deletions;if(c!==null){for(var D=0;D<c.length;D++){var U=c[D];for(Dt=U;Dt!==null;){var J=Dt;switch(J.tag){case 0:case 11:case 15:Cm(8,J,b)}var W=J.child;if(W!==null)W.return=J,Dt=W;else for(;Dt!==null;){J=Dt;var q=J.sibling,Ee=J.return;if(d4(J),J===U){Dt=null;break}if(q!==null){q.return=Ee,Dt=q;break}Dt=Ee}}}var ze=b.alternate;if(ze!==null){var Ne=ze.child;if(Ne!==null){ze.child=null;do{var Be=Ne.sibling;Ne.sibling=null,Ne=Be}while(Ne!==null)}}Dt=b}}if(b.subtreeFlags&2064&&w!==null)w.return=b,Dt=w;else e:for(;Dt!==null;){if(b=Dt,b.flags&2048)switch(b.tag){case 0:case 11:case 15:Cm(9,b,b.return)}var se=b.sibling;if(se!==null){se.return=b.return,Dt=se;break e}Dt=b.return}}var ue=e.current;for(Dt=ue;Dt!==null;){w=Dt;var he=w.child;if(w.subtreeFlags&2064&&he!==null)he.return=w,Dt=he;else e:for(w=ue;Dt!==null;){if(c=Dt,c.flags&2048)try{switch(c.tag){case 0:case 11:case 15:H0(9,c)}}catch(Ze){ti(c,c.return,Ze)}if(c===w){Dt=null;break e}var De=c.sibling;if(De!==null){De.return=c.return,Dt=De;break e}Dt=c.return}}if(Jn=_,Zc(),Fl&&typeof Fl.onPostCommitFiberRoot=="function")try{Fl.onPostCommitFiberRoot(U0,e)}catch{}h=!0}return h}finally{hr=o,ua.transition=r}}return!1}function Bb(e,r,o){r=qf(o,r),r=t4(e,r,1),e=Oc(e,r,1),r=Hs(),e!==null&&(Km(e,1,r),uo(e,r))}function ti(e,r,o){if(e.tag===3)Bb(e,e,o);else for(;r!==null;){if(r.tag===3){Bb(r,e,o);break}else if(r.tag===1){var h=r.stateNode;if(typeof r.type.getDerivedStateFromError=="function"||typeof h.componentDidCatch=="function"&&(Fc===null||!Fc.has(h))){e=qf(o,e),e=n4(r,e,1),r=Oc(r,e,1),e=Hs(),r!==null&&(Km(r,1,e),uo(r,e));break}}r=r.return}}function aE(e,r,o){var h=e.pingCache;h!==null&&h.delete(r),r=Hs(),e.pingedLanes|=e.suspendedLanes&o,Zi===e&&(ss&o)===o&&(Di===4||Di===3&&(ss&130023424)===ss&&500>ci()-nw?td(e,0):tw|=o),uo(e,r)}function b4(e,r){r===0&&(e.mode&1?(r=T_,T_<<=1,!(T_&130023424)&&(T_=4194304)):r=1);var o=Hs();e=Ru(e,r),e!==null&&(Km(e,r,o),uo(e,o))}function lE(e){var r=e.memoizedState,o=0;r!==null&&(o=r.retryLane),b4(e,o)}function uE(e,r){var o=0;switch(e.tag){case 13:var h=e.stateNode,_=e.memoizedState;_!==null&&(o=_.retryLane);break;case 19:h=e.stateNode;break;default:throw Error(ut(314))}h!==null&&h.delete(r),b4(e,o)}var S4;S4=function(e,r,o){if(e!==null)if(e.memoizedProps!==r.pendingProps||ao.current)oo=!0;else{if(!(e.lanes&o)&&!(r.flags&128))return oo=!1,KT(e,r,o);oo=!!(e.flags&131072)}else oo=!1,Ur&&r.flags&1048576&&I3(r,d0,r.index);switch(r.lanes=0,r.tag){case 2:var h=r.type;X_(e,r),e=r.pendingProps;var _=Uf(r,Ds.current);Of(r,o),_=Xx(null,r,h,e,_,o);var b=Kx();return r.flags|=1,typeof _=="object"&&_!==null&&typeof _.render=="function"&&_.$$typeof===void 0?(r.tag=1,r.memoizedState=null,r.updateQueue=null,lo(h)?(b=!0,c0(r)):b=!1,r.memoizedState=_.state!==null&&_.state!==void 0?_.state:null,qx(r),_.updater=W0,r.stateNode=_,_._reactInternals=r,qv(r,h,e,o),r=Wv(null,r,h,!0,b,o)):(r.tag=0,Ur&&b&&Fx(r),Ws(null,r,_,o),r=r.child),r;case 16:h=r.elementType;e:{switch(X_(e,r),e=r.pendingProps,_=h._init,h=_(h._payload),r.type=h,_=r.tag=hE(h),e=Za(h,e),_){case 0:r=Gv(null,r,h,e,o);break e;case 1:r=kb(null,r,h,e,o);break e;case 11:r=Cb(null,r,h,e,o);break e;case 14:r=Ib(null,r,h,Za(h.type,e),o);break e}throw Error(ut(306,h,""))}return r;case 0:return h=r.type,_=r.pendingProps,_=r.elementType===h?_:Za(h,_),Gv(e,r,h,_,o);case 1:return h=r.type,_=r.pendingProps,_=r.elementType===h?_:Za(h,_),kb(e,r,h,_,o);case 3:e:{if(o4(r),e===null)throw Error(ut(387));h=r.pendingProps,b=r.memoizedState,_=b.element,D3(e,r),m0(r,h,null,o);var w=r.memoizedState;if(h=w.element,b.isDehydrated)if(b={element:h,isDehydrated:!1,cache:w.cache,pendingSuspenseBoundaries:w.pendingSuspenseBoundaries,transitions:w.transitions},r.updateQueue.baseState=b,r.memoizedState=b,r.flags&256){_=qf(Error(ut(423)),r),r=Pb(e,r,h,o,_);break e}else if(h!==_){_=qf(Error(ut(424)),r),r=Pb(e,r,h,o,_);break e}else for(Mo=Lc(r.stateNode.containerInfo.firstChild),Do=r,Ur=!0,Wa=null,o=M3(r,null,h,o),r.child=o;o;)o.flags=o.flags&-3|4096,o=o.sibling;else{if(jf(),h===_){r=Lu(e,r,o);break e}Ws(e,r,h,o)}r=r.child}return r;case 5:return R3(r),e===null&&jv(r),h=r.type,_=r.pendingProps,b=e!==null?e.memoizedProps:null,w=_.children,Ov(h,_)?w=null:b!==null&&Ov(h,b)&&(r.flags|=32),s4(e,r),Ws(e,r,w,o),r.child;case 6:return e===null&&jv(r),null;case 13:return a4(e,r,o);case 4:return Zx(r,r.stateNode.containerInfo),h=r.pendingProps,e===null?r.child=$f(r,null,h,o):Ws(e,r,h,o),r.child;case 11:return h=r.type,_=r.pendingProps,_=r.elementType===h?_:Za(h,_),Cb(e,r,h,_,o);case 7:return Ws(e,r,r.pendingProps,o),r.child;case 8:return Ws(e,r,r.pendingProps.children,o),r.child;case 12:return Ws(e,r,r.pendingProps.children,o),r.child;case 10:e:{if(h=r.type._context,_=r.pendingProps,b=r.memoizedProps,w=_.value,kr(f0,h._currentValue),h._currentValue=w,b!==null)if(Ja(b.value,w)){if(b.children===_.children&&!ao.current){r=Lu(e,r,o);break e}}else for(b=r.child,b!==null&&(b.return=r);b!==null;){var c=b.dependencies;if(c!==null){w=b.child;for(var D=c.firstContext;D!==null;){if(D.context===h){if(b.tag===1){D=Au(-1,o&-o),D.tag=2;var U=b.updateQueue;if(U!==null){U=U.shared;var J=U.pending;J===null?D.next=D:(D.next=J.next,J.next=D),U.pending=D}}b.lanes|=o,D=b.alternate,D!==null&&(D.lanes|=o),$v(b.return,o,r),c.lanes|=o;break}D=D.next}}else if(b.tag===10)w=b.type===r.type?null:b.child;else if(b.tag===18){if(w=b.return,w===null)throw Error(ut(341));w.lanes|=o,c=w.alternate,c!==null&&(c.lanes|=o),$v(w,o,r),w=b.sibling}else w=b.child;if(w!==null)w.return=b;else for(w=b;w!==null;){if(w===r){w=null;break}if(b=w.sibling,b!==null){b.return=w.return,w=b;break}w=w.return}b=w}Ws(e,r,_.children,o),r=r.child}return r;case 9:return _=r.type,h=r.pendingProps.children,Of(r,o),_=ha(_),h=h(_),r.flags|=1,Ws(e,r,h,o),r.child;case 14:return h=r.type,_=Za(h,r.pendingProps),_=Za(h.type,_),Ib(e,r,h,_,o);case 15:return r4(e,r,r.type,r.pendingProps,o);case 17:return h=r.type,_=r.pendingProps,_=r.elementType===h?_:Za(h,_),X_(e,r),r.tag=1,lo(h)?(e=!0,c0(r)):e=!1,Of(r,o),e4(r,h,_),qv(r,h,_,o),Wv(null,r,h,!0,e,o);case 19:return l4(e,r,o);case 22:return i4(e,r,o)}throw Error(ut(156,r.tag))};function T4(e,r){return Y2(e,r)}function cE(e,r,o,h){this.tag=e,this.key=o,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=r,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=h,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function la(e,r,o,h){return new cE(e,r,o,h)}function ow(e){return e=e.prototype,!(!e||!e.isReactComponent)}function hE(e){if(typeof e=="function")return ow(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Ex)return 11;if(e===Cx)return 14}return 2}function Nc(e,r){var o=e.alternate;return o===null?(o=la(e.tag,r,e.key,e.mode),o.elementType=e.elementType,o.type=e.type,o.stateNode=e.stateNode,o.alternate=e,e.alternate=o):(o.pendingProps=r,o.type=e.type,o.flags=0,o.subtreeFlags=0,o.deletions=null),o.flags=e.flags&14680064,o.childLanes=e.childLanes,o.lanes=e.lanes,o.child=e.child,o.memoizedProps=e.memoizedProps,o.memoizedState=e.memoizedState,o.updateQueue=e.updateQueue,r=e.dependencies,o.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext},o.sibling=e.sibling,o.index=e.index,o.ref=e.ref,o}function J_(e,r,o,h,_,b){var w=2;if(h=e,typeof e=="function")ow(e)&&(w=1);else if(typeof e=="string")w=5;else e:switch(e){case xf:return nd(o.children,_,b,r);case Tx:w=8,_|=8;break;case pv:return e=la(12,o,r,_|2),e.elementType=pv,e.lanes=b,e;case mv:return e=la(13,o,r,_),e.elementType=mv,e.lanes=b,e;case gv:return e=la(19,o,r,_),e.elementType=gv,e.lanes=b,e;case R2:return K0(o,_,b,r);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case z2:w=10;break e;case D2:w=9;break e;case Ex:w=11;break e;case Cx:w=14;break e;case Cc:w=16,h=null;break e}throw Error(ut(130,e==null?e:typeof e,""))}return r=la(w,o,r,_),r.elementType=e,r.type=h,r.lanes=b,r}function nd(e,r,o,h){return e=la(7,e,h,r),e.lanes=o,e}function K0(e,r,o,h){return e=la(22,e,h,r),e.elementType=R2,e.lanes=o,e.stateNode={isHidden:!1},e}function W1(e,r,o){return e=la(6,e,null,r),e.lanes=o,e}function H1(e,r,o){return r=la(4,e.children!==null?e.children:[],e.key,r),r.lanes=o,r.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},r}function dE(e,r,o,h,_){this.tag=r,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=k1(0),this.expirationTimes=k1(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=k1(0),this.identifierPrefix=h,this.onRecoverableError=_,this.mutableSourceEagerHydrationData=null}function aw(e,r,o,h,_,b,w,c,D){return e=new dE(e,r,o,c,D),r===1?(r=1,b===!0&&(r|=8)):r=0,b=la(3,null,null,r),e.current=b,b.stateNode=e,b.memoizedState={element:h,isDehydrated:o,cache:null,transitions:null,pendingSuspenseBoundaries:null},qx(b),e}function fE(e,r,o){var h=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:vf,key:h==null?null:""+h,children:e,containerInfo:r,implementation:o}}function E4(e){if(!e)return jc;e=e._reactInternals;e:{if(fd(e)!==e||e.tag!==1)throw Error(ut(170));var r=e;do{switch(r.tag){case 3:r=r.stateNode.context;break e;case 1:if(lo(r.type)){r=r.stateNode.__reactInternalMemoizedMergedChildContext;break e}}r=r.return}while(r!==null);throw Error(ut(171))}if(e.tag===1){var o=e.type;if(lo(o))return E3(e,o,r)}return r}function C4(e,r,o,h,_,b,w,c,D){return e=aw(o,h,!0,e,_,b,w,c,D),e.context=E4(null),o=e.current,h=Hs(),_=Bc(o),b=Au(h,_),b.callback=r??null,Oc(o,b,_),e.current.lanes=_,Km(e,_,h),uo(e,h),e}function Y0(e,r,o,h){var _=r.current,b=Hs(),w=Bc(_);return o=E4(o),r.context===null?r.context=o:r.pendingContext=o,r=Au(b,w),r.payload={element:e},h=h===void 0?null:h,h!==null&&(r.callback=h),e=Oc(_,r,w),e!==null&&(Ka(e,_,w,b),G_(e,_,w)),w}function S0(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function Nb(e,r){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var o=e.retryLane;e.retryLane=o!==0&&o<r?o:r}}function lw(e,r){Nb(e,r),(e=e.alternate)&&Nb(e,r)}function pE(){return null}var I4=typeof reportError=="function"?reportError:function(e){console.error(e)};function uw(e){this._internalRoot=e}J0.prototype.render=uw.prototype.render=function(e){var r=this._internalRoot;if(r===null)throw Error(ut(409));Y0(e,r,null,null)};J0.prototype.unmount=uw.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var r=e.containerInfo;ld(function(){Y0(null,e,null,null)}),r[Du]=null}};function J0(e){this._internalRoot=e}J0.prototype.unstable_scheduleHydration=function(e){if(e){var r=i3();e={blockedOn:null,target:e,priority:r};for(var o=0;o<kc.length&&r!==0&&r<kc[o].priority;o++);kc.splice(o,0,e),o===0&&o3(e)}};function cw(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Q0(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function Ub(){}function mE(e,r,o,h,_){if(_){if(typeof h=="function"){var b=h;h=function(){var U=S0(w);b.call(U)}}var w=C4(r,h,e,0,null,!1,!1,"",Ub);return e._reactRootContainer=w,e[Du]=w.current,Fm(e.nodeType===8?e.parentNode:e),ld(),w}for(;_=e.lastChild;)e.removeChild(_);if(typeof h=="function"){var c=h;h=function(){var U=S0(D);c.call(U)}}var D=aw(e,0,!1,null,null,!1,!1,"",Ub);return e._reactRootContainer=D,e[Du]=D.current,Fm(e.nodeType===8?e.parentNode:e),ld(function(){Y0(r,D,o,h)}),D}function ey(e,r,o,h,_){var b=o._reactRootContainer;if(b){var w=b;if(typeof _=="function"){var c=_;_=function(){var D=S0(w);c.call(D)}}Y0(r,w,e,_)}else w=mE(o,r,e,_,h);return S0(w)}n3=function(e){switch(e.tag){case 3:var r=e.stateNode;if(r.current.memoizedState.isDehydrated){var o=_m(r.pendingLanes);o!==0&&(Px(r,o|1),uo(r,ci()),!(Jn&6)&&(Zf=ci()+500,Zc()))}break;case 13:ld(function(){var h=Ru(e,1);if(h!==null){var _=Hs();Ka(h,e,1,_)}}),lw(e,1)}};Ax=function(e){if(e.tag===13){var r=Ru(e,134217728);if(r!==null){var o=Hs();Ka(r,e,134217728,o)}lw(e,134217728)}};r3=function(e){if(e.tag===13){var r=Bc(e),o=Ru(e,r);if(o!==null){var h=Hs();Ka(o,e,r,h)}lw(e,r)}};i3=function(){return hr};s3=function(e,r){var o=hr;try{return hr=e,r()}finally{hr=o}};Cv=function(e,r,o){switch(r){case"input":if(vv(e,o),r=o.name,o.type==="radio"&&r!=null){for(o=e;o.parentNode;)o=o.parentNode;for(o=o.querySelectorAll("input[name="+JSON.stringify(""+r)+'][type="radio"]'),r=0;r<o.length;r++){var h=o[r];if(h!==e&&h.form===e.form){var _=q0(h);if(!_)throw Error(ut(90));O2(h),vv(h,_)}}}break;case"textarea":B2(e,o);break;case"select":r=o.value,r!=null&&zf(e,!!o.multiple,r,!1)}};Z2=rw;G2=ld;var gE={usingClientEntryPoint:!1,Events:[Jm,Tf,q0,V2,q2,rw]},fm={findFiberByHostInstance:Jh,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},_E={bundleType:fm.bundleType,version:fm.version,rendererPackageName:fm.rendererPackageName,rendererConfig:fm.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Fu.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=X2(e),e===null?null:e.stateNode},findFiberByHostInstance:fm.findFiberByHostInstance||pE,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var L_=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!L_.isDisabled&&L_.supportsFiber)try{U0=L_.inject(_E),Fl=L_}catch{}}Fo.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=gE;Fo.createPortal=function(e,r){var o=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!cw(r))throw Error(ut(200));return fE(e,r,null,o)};Fo.createRoot=function(e,r){if(!cw(e))throw Error(ut(299));var o=!1,h="",_=I4;return r!=null&&(r.unstable_strictMode===!0&&(o=!0),r.identifierPrefix!==void 0&&(h=r.identifierPrefix),r.onRecoverableError!==void 0&&(_=r.onRecoverableError)),r=aw(e,1,!1,null,null,o,!1,h,_),e[Du]=r.current,Fm(e.nodeType===8?e.parentNode:e),new uw(r)};Fo.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var r=e._reactInternals;if(r===void 0)throw typeof e.render=="function"?Error(ut(188)):(e=Object.keys(e).join(","),Error(ut(268,e)));return e=X2(r),e=e===null?null:e.stateNode,e};Fo.flushSync=function(e){return ld(e)};Fo.hydrate=function(e,r,o){if(!Q0(r))throw Error(ut(200));return ey(null,e,r,!0,o)};Fo.hydrateRoot=function(e,r,o){if(!cw(e))throw Error(ut(405));var h=o!=null&&o.hydratedSources||null,_=!1,b="",w=I4;if(o!=null&&(o.unstable_strictMode===!0&&(_=!0),o.identifierPrefix!==void 0&&(b=o.identifierPrefix),o.onRecoverableError!==void 0&&(w=o.onRecoverableError)),r=C4(r,null,e,1,o??null,_,!1,b,w),e[Du]=r.current,Fm(e),h)for(e=0;e<h.length;e++)o=h[e],_=o._getVersion,_=_(o._source),r.mutableSourceEagerHydrationData==null?r.mutableSourceEagerHydrationData=[o,_]:r.mutableSourceEagerHydrationData.push(o,_);return new J0(r)};Fo.render=function(e,r,o){if(!Q0(r))throw Error(ut(200));return ey(null,e,r,!1,o)};Fo.unmountComponentAtNode=function(e){if(!Q0(e))throw Error(ut(40));return e._reactRootContainer?(ld(function(){ey(null,null,e,!1,function(){e._reactRootContainer=null,e[Du]=null})}),!0):!1};Fo.unstable_batchedUpdates=rw;Fo.unstable_renderSubtreeIntoContainer=function(e,r,o,h){if(!Q0(o))throw Error(ut(200));if(e==null||e._reactInternals===void 0)throw Error(ut(38));return ey(e,r,o,!1,h)};Fo.version="18.3.1-next-f1338f8080-20240426";function k4(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(k4)}catch(e){console.error(e)}}k4(),k2.exports=Fo;var yE=k2.exports,jb=yE;dv.createRoot=jb.createRoot,dv.hydrateRoot=jb.hydrateRoot;var P4={exports:{}},A4={};/**
 * @license React
 * use-sync-external-store-with-selector.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var eg=Rt;function vE(e,r){return e===r&&(e!==0||1/e===1/r)||e!==e&&r!==r}var xE=typeof Object.is=="function"?Object.is:vE,wE=eg.useSyncExternalStore,bE=eg.useRef,SE=eg.useEffect,TE=eg.useMemo,EE=eg.useDebugValue;A4.useSyncExternalStoreWithSelector=function(e,r,o,h,_){var b=bE(null);if(b.current===null){var w={hasValue:!1,value:null};b.current=w}else w=b.current;b=TE(function(){function D(Ee){if(!U){if(U=!0,J=Ee,Ee=h(Ee),_!==void 0&&w.hasValue){var ze=w.value;if(_(ze,Ee))return W=ze}return W=Ee}if(ze=W,xE(J,Ee))return ze;var Ne=h(Ee);return _!==void 0&&_(ze,Ne)?ze:(J=Ee,W=Ne)}var U=!1,J,W,q=o===void 0?null:o;return[function(){return D(r())},q===null?void 0:function(){return D(q())}]},[r,o,h,_]);var c=wE(e,b[0],b[1]);return SE(function(){w.hasValue=!0,w.value=c},[c]),EE(c),c};P4.exports=A4;var CE=P4.exports,zo="default"in Lw?Ol:Lw,$b=Symbol.for("react-redux-context"),Vb=typeof globalThis<"u"?globalThis:{};function IE(){if(!zo.createContext)return{};const e=Vb[$b]??(Vb[$b]=new Map);let r=e.get(zo.createContext);return r||(r=zo.createContext(null),e.set(zo.createContext,r)),r}var $c=IE(),kE=()=>{throw new Error("uSES not initialized!")};function hw(e=$c){return function(){return zo.useContext(e)}}var M4=hw(),z4=kE,PE=e=>{z4=e},AE=(e,r)=>e===r;function ME(e=$c){const r=e===$c?M4:hw(e),o=(h,_={})=>{const{equalityFn:b=AE,devModeChecks:w={}}=typeof _=="function"?{equalityFn:_}:_,{store:c,subscription:D,getServerState:U,stabilityCheck:J,identityFunctionCheck:W}=r();zo.useRef(!0);const q=zo.useCallback({[h.name](ze){return h(ze)}}[h.name],[h,J,w.stabilityCheck]),Ee=z4(D.addNestedSub,c.getState,U||c.getState,q,b);return zo.useDebugValue(Ee),Ee};return Object.assign(o,{withTypes:()=>o}),o}var os=ME();function zE(e){e()}function DE(){let e=null,r=null;return{clear(){e=null,r=null},notify(){zE(()=>{let o=e;for(;o;)o.callback(),o=o.next})},get(){const o=[];let h=e;for(;h;)o.push(h),h=h.next;return o},subscribe(o){let h=!0;const _=r={callback:o,next:null,prev:r};return _.prev?_.prev.next=_:e=_,function(){!h||e===null||(h=!1,_.next?_.next.prev=_.prev:r=_.prev,_.prev?_.prev.next=_.next:e=_.next)}}}}var qb={notify(){},get:()=>[]};function RE(e,r){let o,h=qb,_=0,b=!1;function w(Ne){J();const Be=h.subscribe(Ne);let se=!1;return()=>{se||(se=!0,Be(),W())}}function c(){h.notify()}function D(){ze.onStateChange&&ze.onStateChange()}function U(){return b}function J(){_++,o||(o=e.subscribe(D),h=DE())}function W(){_--,o&&_===0&&(o(),o=void 0,h.clear(),h=qb)}function q(){b||(b=!0,J())}function Ee(){b&&(b=!1,W())}const ze={addNestedSub:w,notifyNestedSubs:c,handleChangeWrapper:D,isSubscribed:U,trySubscribe:q,tryUnsubscribe:Ee,getListeners:()=>h};return ze}var LE=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",OE=typeof navigator<"u"&&navigator.product==="ReactNative",FE=LE||OE?zo.useLayoutEffect:zo.useEffect;function BE({store:e,context:r,children:o,serverState:h,stabilityCheck:_="once",identityFunctionCheck:b="once"}){const w=zo.useMemo(()=>{const U=RE(e);return{store:e,subscription:U,getServerState:h?()=>h:void 0,stabilityCheck:_,identityFunctionCheck:b}},[e,h,_,b]),c=zo.useMemo(()=>e.getState(),[e]);FE(()=>{const{subscription:U}=w;return U.onStateChange=U.notifyNestedSubs,U.trySubscribe(),c!==e.getState()&&U.notifyNestedSubs(),()=>{U.tryUnsubscribe(),U.onStateChange=void 0}},[w,c]);const D=r||$c;return zo.createElement(D.Provider,{value:w},o)}var NE=BE;function D4(e=$c){const r=e===$c?M4:hw(e),o=()=>{const{store:h}=r();return h};return Object.assign(o,{withTypes:()=>o}),o}var UE=D4();function jE(e=$c){const r=e===$c?UE:D4(e),o=()=>r().dispatch;return Object.assign(o,{withTypes:()=>o}),o}var tg=jE();PE(CE.useSyncExternalStoreWithSelector);const $E="modulepreload",VE=function(e){return"/"+e},Zb={},sx=function(r,o,h){let _=Promise.resolve();if(o&&o.length>0){document.getElementsByTagName("link");const w=document.querySelector("meta[property=csp-nonce]"),c=(w==null?void 0:w.nonce)||(w==null?void 0:w.getAttribute("nonce"));_=Promise.allSettled(o.map(D=>{if(D=VE(D),D in Zb)return;Zb[D]=!0;const U=D.endsWith(".css"),J=U?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${D}"]${J}`))return;const W=document.createElement("link");if(W.rel=U?"stylesheet":$E,U||(W.as="script"),W.crossOrigin="",W.href=D,c&&W.setAttribute("nonce",c),document.head.appendChild(W),U)return new Promise((q,Ee)=>{W.addEventListener("load",q),W.addEventListener("error",()=>Ee(new Error(`Unable to preload CSS for ${D}`)))})}))}function b(w){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=w,window.dispatchEvent(c),!c.defaultPrevented)throw w}return _.then(w=>{for(const c of w||[])c.status==="rejected"&&b(c.reason);return r().catch(b)})},qE=sx(()=>import("./country-borders-P9p-TcxA.js"),[]),T0={USA:sx(()=>import("./state-borders-usa-_8J44aaB.js"),[]),CAN:sx(()=>import("./state-borders-can-CwVHHxpH.js"),[])},dw=async()=>(await qE).default,ud=e=>e in T0,R4=async e=>{if(!(e in T0))throw Error(`Could not find state data for country ${e}`);return(await T0[e]).default};function ZE(e,r){var o=0,h=0,_=0,b=0,w=0,c=0,D=0,U=0,J=null,W=null,q=e[0],Ee=e[1],ze=r.length;for(o;o<ze;o++){h=0;var Ne=r[o].length-1,Be=r[o];if(J=Be[0],J[0]!==Be[Ne][0]&&J[1]!==Be[Ne][1])throw new Error("First and last coordinates in a ring must be the same");for(w=J[0]-q,c=J[1]-Ee,h;h<Ne;h++){if(W=Be[h+1],U=W[1]-Ee,c<0&&U<0||c>0&&U>0){J=W,c=U,w=J[0]-q;continue}if(D=W[0]-e[0],U>0&&c<=0){if(b=w*U-D*c,b>0)_=_+1;else if(b===0)return 0}else if(c>0&&U<=0){if(b=w*U-D*c,b<0)_=_+1;else if(b===0)return 0}else if(U===0&&c<0){if(b=w*U-D*c,b===0)return 0}else if(c===0&&U<0){if(b=w*U-D*c,b===0)return 0}else if(c===0&&U===0){if(D<=0&&w>=0)return 0;if(w<=0&&D>=0)return 0}J=W,c=U,w=D}}return _%2!==0}function GE(e){if(!e)throw new Error("coord is required");if(!Array.isArray(e)){if(e.type==="Feature"&&e.geometry!==null&&e.geometry.type==="Point")return[...e.geometry.coordinates];if(e.type==="Point")return[...e.coordinates]}if(Array.isArray(e)&&e.length>=2&&!Array.isArray(e[0])&&!Array.isArray(e[1]))return[...e];throw new Error("coord must be GeoJSON Point or an Array of numbers")}function WE(e){return e.type==="Feature"?e.geometry:e}function HE(e,r,o={}){if(!e)throw new Error("point is required");if(!r)throw new Error("polygon is required");const h=GE(e),_=WE(r),b=_.type,w=r.bbox;let c=_.coordinates;if(w&&XE(h,w)===!1)return!1;b==="Polygon"&&(c=[c]);let D=!1;for(var U=0;U<c.length;++U){const J=ZE(h,c[U]);if(J===0)return!o.ignoreBoundary;J&&(D=!0)}return D}function XE(e,r){return r[0]<=e[0]&&r[1]<=e[1]&&r[2]>=e[0]&&r[3]>=e[1]}var KE=HE;const L4=async(e,r)=>{e=F4(e);const o=await dw();for(let h=0;h<o.length;h++){const _=o[h];if(B4(e,r,_.bbox,_.geojson))return await JE(_)}return null},O4=async(e,r,o)=>{e=F4(e);for(let h=0;h<o.length;h++){const _=o[h];if(B4(e,r,_.bbox,_.geojson))return _}return null},F4=e=>{for(;e>180;)e-=360;for(;e<-180;)e+=360;return e},B4=(e,r,o,h)=>YE(e,r,o)?KE([e,r],h):!1,YE=(e,r,o)=>{const h=o[0],_=o[1],b=o[2],w=o[3];return e>=h&&e<=b&&r>=_&&r<=w},JE=async e=>{let r=null;return ud(e.codeIso3)&&(r=await R4(e.codeIso3)),{...e,statesData:r}},QE="_container_ppg42_1",eC={container:QE},N4=({children:e,style:r,className:o})=>Qe.jsx("div",{style:r,className:`${eC.container} ${o??""}`,children:e});var E0={exports:{}};/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */E0.exports;(function(e,r){(function(){var o,h="4.17.21",_=200,b="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",w="Expected a function",c="Invalid `variable` option passed into `_.template`",D="__lodash_hash_undefined__",U=500,J="__lodash_placeholder__",W=1,q=2,Ee=4,ze=1,Ne=2,Be=1,se=2,ue=4,he=8,De=16,Ze=32,je=64,ve=128,ee=256,de=512,Te=30,Ue="...",Xe=800,mt=16,Kt=1,qn=2,Qn=3,zt=1/0,Je=9007199254740991,rt=17976931348623157e292,Et=NaN,ht=4294967295,It=ht-1,St=ht>>>1,Sn=[["ary",ve],["bind",Be],["bindKey",se],["curry",he],["curryRight",De],["flip",de],["partial",Ze],["partialRight",je],["rearg",ee]],cn="[object Arguments]",Cn="[object Array]",Nn="[object AsyncFunction]",Zt="[object Boolean]",rn="[object Date]",Zn="[object DOMException]",Qt="[object Error]",wn="[object Function]",er="[object GeneratorFunction]",sn="[object Map]",dn="[object Number]",Ce="[object Null]",Fn="[object Object]",bn="[object Promise]",Ot="[object Proxy]",Yt="[object RegExp]",Tr="[object Set]",yr="[object String]",Hr="[object Symbol]",vr="[object Undefined]",rr="[object WeakMap]",dr="[object WeakSet]",fr="[object ArrayBuffer]",Ke="[object DataView]",hi="[object Float32Array]",Lr="[object Float64Array]",jr="[object Int8Array]",Pr="[object Int16Array]",it="[object Int32Array]",Ht="[object Uint8Array]",Ut="[object Uint8ClampedArray]",di="[object Uint16Array]",Gi="[object Uint32Array]",Xt=/\b__p \+= '';/g,Ys=/\b(__p \+=) '' \+/g,co=/(__e\(.*?\)|\b__t\)) \+\n'';/g,ho=/&(?:amp|lt|gt|quot|#39);/g,Rs=/[&<>"']/g,ae=RegExp(ho.source),N=RegExp(Rs.source),B=/<%-([\s\S]+?)%>/g,K=/<%([\s\S]+?)%>/g,re=/<%=([\s\S]+?)%>/g,ye=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Se=/^\w*$/,ke=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,pe=/[\\^$.*+?()[\]{}|]/g,Fe=RegExp(pe.source),Ge=/^\s+/,Re=/\s/,st=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Mt=/\{\n\/\* \[wrapped with (.+)\] \*/,Lt=/,? & /,In=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Jt=/[()=,{}\[\]\/\s]/,kn=/\\(\\)?/g,fn=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Ar=/\w*$/,xr=/^[-+]0x[0-9a-f]+$/i,on=/^0b[01]+$/i,Gn=/^\[object .+?Constructor\]$/,ur=/^0o[0-7]+$/i,Xr=/^(?:0|[1-9]\d*)$/,ni=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Kr=/($^)/,el=/['\n\r\u2028\u2029\\]/g,Rn="\\ud800-\\udfff",Hc="\\u0300-\\u036f",Xc="\\ufe20-\\ufe2f",Wi="\\u20d0-\\u20ff",Ri=Hc+Xc+Wi,md="\\u2700-\\u27bf",Hi="a-z\\xdf-\\xf6\\xf8-\\xff",Xi="\\xac\\xb1\\xd7\\xf7",tl="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",pa="\\u2000-\\u206f",Or=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",nl="A-Z\\xc0-\\xd6\\xd8-\\xde",ls="\\ufe0e\\ufe0f",Er=Xi+tl+pa+Or,rl="[']",Ls="["+Rn+"]",Bu="["+Er+"]",Li="["+Ri+"]",gd="\\d+",Nu="["+md+"]",No="["+Hi+"]",fo="[^"+Rn+Er+gd+md+Hi+nl+"]",Pn="\\ud83c[\\udffb-\\udfff]",Kc="(?:"+Li+"|"+Pn+")",Uu="[^"+Rn+"]",Uo="(?:\\ud83c[\\udde6-\\uddff]){2}",$l="[\\ud800-\\udbff][\\udc00-\\udfff]",po="["+nl+"]",il="\\u200d",Vl="(?:"+No+"|"+fo+")",sl="(?:"+po+"|"+fo+")",Yc="(?:"+rl+"(?:d|ll|m|re|s|t|ve))?",_d="(?:"+rl+"(?:D|LL|M|RE|S|T|VE))?",Jc=Kc+"?",yd="["+ls+"]?",ma="(?:"+il+"(?:"+[Uu,Uo,$l].join("|")+")"+yd+Jc+")*",ql="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Oi="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",Ei=yd+Jc+ma,ju="(?:"+[Nu,Uo,$l].join("|")+")"+Ei,$u="(?:"+[Uu+Li+"?",Li,Uo,$l,Ls].join("|")+")",Vu=RegExp(rl,"g"),vd=RegExp(Li,"g"),jo=RegExp(Pn+"(?="+Pn+")|"+$u+Ei,"g"),ip=RegExp([po+"?"+No+"+"+Yc+"(?="+[Bu,po,"$"].join("|")+")",sl+"+"+_d+"(?="+[Bu,po+Vl,"$"].join("|")+")",po+"?"+Vl+"+"+Yc,po+"+"+_d,Oi,ql,gd,ju].join("|"),"g"),xd=RegExp("["+il+Rn+Ri+ls+"]"),wd=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,sp=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],op=-1,or={};or[hi]=or[Lr]=or[jr]=or[Pr]=or[it]=or[Ht]=or[Ut]=or[di]=or[Gi]=!0,or[cn]=or[Cn]=or[fr]=or[Zt]=or[Ke]=or[rn]=or[Qt]=or[wn]=or[sn]=or[dn]=or[Fn]=or[Yt]=or[Tr]=or[yr]=or[rr]=!1;var Wn={};Wn[cn]=Wn[Cn]=Wn[fr]=Wn[Ke]=Wn[Zt]=Wn[rn]=Wn[hi]=Wn[Lr]=Wn[jr]=Wn[Pr]=Wn[it]=Wn[sn]=Wn[dn]=Wn[Fn]=Wn[Yt]=Wn[Tr]=Wn[yr]=Wn[Hr]=Wn[Ht]=Wn[Ut]=Wn[di]=Wn[Gi]=!0,Wn[Qt]=Wn[wn]=Wn[rr]=!1;var Qc={:"A",:"A",:"A",:"A",:"A",:"A",:"a",:"a",:"a",:"a",:"a",:"a",:"C",:"c",:"D",:"d",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"N",:"n",:"O",:"O",:"O",:"O",:"O",:"O",:"o",:"o",:"o",:"o",:"o",:"o",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"Y",:"y",:"y",:"Ae",:"ae",:"Th",:"th",:"ss",:"A",:"A",:"A",:"a",:"a",:"a",:"C",:"C",:"C",:"C",:"c",:"c",:"c",:"c",:"D",:"D",:"d",:"d",:"E",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"e",:"G",:"G",:"G",:"G",:"g",:"g",:"g",:"g",:"H",:"H",:"h",:"h",:"I",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"i",:"J",:"j",:"K",:"k",:"k",:"L",:"L",:"L",:"L",:"L",:"l",:"l",:"l",:"l",:"l",:"N",:"N",:"N",:"N",:"n",:"n",:"n",:"n",:"O",:"O",:"O",:"o",:"o",:"o",:"R",:"R",:"R",:"r",:"r",:"r",:"S",:"S",:"S",:"S",:"s",:"s",:"s",:"s",:"T",:"T",:"T",:"t",:"t",:"t",:"U",:"U",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"u",:"u",:"W",:"w",:"Y",:"y",:"Y",:"Z",:"Z",:"Z",:"z",:"z",:"z",:"IJ",:"ij",:"Oe",:"oe",:"'n",:"s"},qu={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},eh={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},th={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Js=parseFloat,ap=parseInt,Zu=typeof Kh=="object"&&Kh&&Kh.Object===Object&&Kh,ga=typeof self=="object"&&self&&self.Object===Object&&self,pr=Zu||ga||Function("return this")(),Mn=r&&!r.nodeType&&r,Qs=Mn&&!0&&e&&!e.nodeType&&e,bd=Qs&&Qs.exports===Mn,$o=bd&&Zu.process,us=function(){try{var Ie=Qs&&Qs.require&&Qs.require("util").types;return Ie||$o&&$o.binding&&$o.binding("util")}catch{}}(),nh=us&&us.isArrayBuffer,Sd=us&&us.isDate,rh=us&&us.isMap,Gu=us&&us.isRegExp,ih=us&&us.isSet,sh=us&&us.isTypedArray;function Fi(Ie,Ve,Oe){switch(Oe.length){case 0:return Ie.call(Ve);case 1:return Ie.call(Ve,Oe[0]);case 2:return Ie.call(Ve,Oe[0],Oe[1]);case 3:return Ie.call(Ve,Oe[0],Oe[1],Oe[2])}return Ie.apply(Ve,Oe)}function Td(Ie,Ve,Oe,Tt){for(var Wt=-1,Tn=Ie==null?0:Ie.length;++Wt<Tn;){var gr=Ie[Wt];Ve(Tt,gr,Oe(gr),Ie)}return Tt}function Yr(Ie,Ve){for(var Oe=-1,Tt=Ie==null?0:Ie.length;++Oe<Tt&&Ve(Ie[Oe],Oe,Ie)!==!1;);return Ie}function Ed(Ie,Ve){for(var Oe=Ie==null?0:Ie.length;Oe--&&Ve(Ie[Oe],Oe,Ie)!==!1;);return Ie}function Cd(Ie,Ve){for(var Oe=-1,Tt=Ie==null?0:Ie.length;++Oe<Tt;)if(!Ve(Ie[Oe],Oe,Ie))return!1;return!0}function mo(Ie,Ve){for(var Oe=-1,Tt=Ie==null?0:Ie.length,Wt=0,Tn=[];++Oe<Tt;){var gr=Ie[Oe];Ve(gr,Oe,Ie)&&(Tn[Wt++]=gr)}return Tn}function Vo(Ie,Ve){var Oe=Ie==null?0:Ie.length;return!!Oe&&Zo(Ie,Ve,0)>-1}function oh(Ie,Ve,Oe){for(var Tt=-1,Wt=Ie==null?0:Ie.length;++Tt<Wt;)if(Oe(Ve,Ie[Tt]))return!0;return!1}function ir(Ie,Ve){for(var Oe=-1,Tt=Ie==null?0:Ie.length,Wt=Array(Tt);++Oe<Tt;)Wt[Oe]=Ve(Ie[Oe],Oe,Ie);return Wt}function qo(Ie,Ve){for(var Oe=-1,Tt=Ve.length,Wt=Ie.length;++Oe<Tt;)Ie[Wt+Oe]=Ve[Oe];return Ie}function ah(Ie,Ve,Oe,Tt){var Wt=-1,Tn=Ie==null?0:Ie.length;for(Tt&&Tn&&(Oe=Ie[++Wt]);++Wt<Tn;)Oe=Ve(Oe,Ie[Wt],Wt,Ie);return Oe}function Id(Ie,Ve,Oe,Tt){var Wt=Ie==null?0:Ie.length;for(Tt&&Wt&&(Oe=Ie[--Wt]);Wt--;)Oe=Ve(Oe,Ie[Wt],Wt,Ie);return Oe}function Wu(Ie,Ve){for(var Oe=-1,Tt=Ie==null?0:Ie.length;++Oe<Tt;)if(Ve(Ie[Oe],Oe,Ie))return!0;return!1}var kd=Wl("length");function lh(Ie){return Ie.split("")}function Pd(Ie){return Ie.match(In)||[]}function Zl(Ie,Ve,Oe){var Tt;return Oe(Ie,function(Wt,Tn,gr){if(Ve(Wt,Tn,gr))return Tt=Tn,!1}),Tt}function cs(Ie,Ve,Oe,Tt){for(var Wt=Ie.length,Tn=Oe+(Tt?1:-1);Tt?Tn--:++Tn<Wt;)if(Ve(Ie[Tn],Tn,Ie))return Tn;return-1}function Zo(Ie,Ve,Oe){return Ve===Ve?cl(Ie,Ve,Oe):cs(Ie,Hu,Oe)}function uh(Ie,Ve,Oe,Tt){for(var Wt=Oe-1,Tn=Ie.length;++Wt<Tn;)if(Tt(Ie[Wt],Ve))return Wt;return-1}function Hu(Ie){return Ie!==Ie}function Gl(Ie,Ve){var Oe=Ie==null?0:Ie.length;return Oe?mr(Ie,Ve)/Oe:Et}function Wl(Ie){return function(Ve){return Ve==null?o:Ve[Ie]}}function go(Ie){return function(Ve){return Ie==null?o:Ie[Ve]}}function Xu(Ie,Ve,Oe,Tt,Wt){return Wt(Ie,function(Tn,gr,Hn){Oe=Tt?(Tt=!1,Tn):Ve(Oe,Tn,gr,Hn)}),Oe}function lp(Ie,Ve){var Oe=Ie.length;for(Ie.sort(Ve);Oe--;)Ie[Oe]=Ie[Oe].value;return Ie}function mr(Ie,Ve){for(var Oe,Tt=-1,Wt=Ie.length;++Tt<Wt;){var Tn=Ve(Ie[Tt]);Tn!==o&&(Oe=Oe===o?Tn:Oe+Tn)}return Oe}function ch(Ie,Ve){for(var Oe=-1,Tt=Array(Ie);++Oe<Ie;)Tt[Oe]=Ve(Oe);return Tt}function an(Ie,Ve){return ir(Ve,function(Oe){return[Oe,Ie[Oe]]})}function Hl(Ie){return Ie&&Ie.slice(0,An(Ie)+1).replace(Ge,"")}function pn(Ie){return function(Ve){return Ie(Ve)}}function Un(Ie,Ve){return ir(Ve,function(Oe){return Ie[Oe]})}function Os(Ie,Ve){return Ie.has(Ve)}function ol(Ie,Ve){for(var Oe=-1,Tt=Ie.length;++Oe<Tt&&Zo(Ve,Ie[Oe],0)>-1;);return Oe}function al(Ie,Ve){for(var Oe=Ie.length;Oe--&&Zo(Ve,Ie[Oe],0)>-1;);return Oe}function hh(Ie,Ve){for(var Oe=Ie.length,Tt=0;Oe--;)Ie[Oe]===Ve&&++Tt;return Tt}var _a=go(Qc),ll=go(qu);function hs(Ie){return"\\"+th[Ie]}function dh(Ie,Ve){return Ie==null?o:Ie[Ve]}function Go(Ie){return xd.test(Ie)}function fh(Ie){return wd.test(Ie)}function ya(Ie){for(var Ve,Oe=[];!(Ve=Ie.next()).done;)Oe.push(Ve.value);return Oe}function va(Ie){var Ve=-1,Oe=Array(Ie.size);return Ie.forEach(function(Tt,Wt){Oe[++Ve]=[Wt,Tt]}),Oe}function ul(Ie,Ve){return function(Oe){return Ie(Ve(Oe))}}function Ki(Ie,Ve){for(var Oe=-1,Tt=Ie.length,Wt=0,Tn=[];++Oe<Tt;){var gr=Ie[Oe];(gr===Ve||gr===J)&&(Ie[Oe]=J,Tn[Wt++]=Oe)}return Tn}function Wo(Ie){var Ve=-1,Oe=Array(Ie.size);return Ie.forEach(function(Tt){Oe[++Ve]=Tt}),Oe}function Ku(Ie){var Ve=-1,Oe=Array(Ie.size);return Ie.forEach(function(Tt){Oe[++Ve]=[Tt,Tt]}),Oe}function cl(Ie,Ve,Oe){for(var Tt=Oe-1,Wt=Ie.length;++Tt<Wt;)if(Ie[Tt]===Ve)return Tt;return-1}function hl(Ie,Ve,Oe){for(var Tt=Oe+1;Tt--;)if(Ie[Tt]===Ve)return Tt;return Tt}function xa(Ie){return Go(Ie)?up(Ie):kd(Ie)}function Yi(Ie){return Go(Ie)?Ad(Ie):lh(Ie)}function An(Ie){for(var Ve=Ie.length;Ve--&&Re.test(Ie.charAt(Ve)););return Ve}var Yu=go(eh);function up(Ie){for(var Ve=jo.lastIndex=0;jo.test(Ie);)++Ve;return Ve}function Ad(Ie){return Ie.match(jo)||[]}function dl(Ie){return Ie.match(ip)||[]}var Md=function Ie(Ve){Ve=Ve==null?pr:_o.defaults(pr.Object(),Ve,_o.pick(pr,sp));var Oe=Ve.Array,Tt=Ve.Date,Wt=Ve.Error,Tn=Ve.Function,gr=Ve.Math,Hn=Ve.Object,Ho=Ve.RegExp,Xl=Ve.String,Ci=Ve.TypeError,wa=Oe.prototype,ph=Tn.prototype,fl=Hn.prototype,Kl=Ve["__core-js_shared__"],ba=ph.toString,jn=fl.hasOwnProperty,Yl=0,pl=function(){var u=/[^.]+$/.exec(Kl&&Kl.keys&&Kl.keys.IE_PROTO||"");return u?"Symbol(src)_1."+u:""}(),$r=fl.toString,Sa=ba.call(Hn),zd=pr._,Dd=Ho("^"+ba.call(jn).replace(pe,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),cr=bd?Ve.Buffer:o,Jr=Ve.Symbol,fi=Ve.Uint8Array,ml=cr?cr.allocUnsafe:o,gl=ul(Hn.getPrototypeOf,Hn),Jl=Hn.create,Ta=fl.propertyIsEnumerable,ds=wa.splice,Ju=Jr?Jr.isConcatSpreadable:o,Xo=Jr?Jr.iterator:o,yo=Jr?Jr.toStringTag:o,Ea=function(){try{var u=Il(Hn,"defineProperty");return u({},"",{}),u}catch{}}(),mh=Ve.clearTimeout!==pr.clearTimeout&&Ve.clearTimeout,gh=Tt&&Tt.now!==pr.Date.now&&Tt.now,Ca=Ve.setTimeout!==pr.setTimeout&&Ve.setTimeout,Ia=gr.ceil,Ko=gr.floor,Ql=Hn.getOwnPropertySymbols,_h=cr?cr.isBuffer:o,Qu=Ve.isFinite,yh=wa.join,ec=ul(Hn.keys,Hn),_r=gr.max,ri=gr.min,fs=Tt.now,eo=Ve.parseInt,tc=gr.random,Fs=wa.reverse,vo=Il(Ve,"DataView"),eu=Il(Ve,"Map"),vh=Il(Ve,"Promise"),ka=Il(Ve,"Set"),_l=Il(Ve,"WeakMap"),Pa=Il(Hn,"create"),xo=_l&&new _l,ii={},vt=_u(vo),nc=_u(eu),xh=_u(vh),Rd=_u(ka),yl=_u(_l),wo=Jr?Jr.prototype:o,Aa=wo?wo.valueOf:o,mn=wo?wo.toString:o;function H(u){if(zr(u)&&!en(u)&&!(u instanceof ln)){if(u instanceof ps)return u;if(jn.call(u,"__wrapped__"))return Sg(u)}return new ps(u)}var vl=function(){function u(){}return function(m){if(!br(m))return{};if(Jl)return Jl(m);u.prototype=m;var T=new u;return u.prototype=o,T}}();function xl(){}function ps(u,m){this.__wrapped__=u,this.__actions__=[],this.__chain__=!!m,this.__index__=0,this.__values__=o}H.templateSettings={escape:B,evaluate:K,interpolate:re,variable:"",imports:{_:H}},H.prototype=xl.prototype,H.prototype.constructor=H,ps.prototype=vl(xl.prototype),ps.prototype.constructor=ps;function ln(u){this.__wrapped__=u,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=ht,this.__views__=[]}function Ld(){var u=new ln(this.__wrapped__);return u.__actions__=es(this.__actions__),u.__dir__=this.__dir__,u.__filtered__=this.__filtered__,u.__iteratees__=es(this.__iteratees__),u.__takeCount__=this.__takeCount__,u.__views__=es(this.__views__),u}function wh(){if(this.__filtered__){var u=new ln(this);u.__dir__=-1,u.__filtered__=!0}else u=this.clone(),u.__dir__*=-1;return u}function Od(){var u=this.__wrapped__.value(),m=this.__dir__,T=en(u),A=m<0,$=T?u.length:0,Y=Sp(0,$,this.__views__),fe=Y.start,we=Y.end,Ae=we-fe,We=A?we:fe-1,He=this.__iteratees__,tt=He.length,bt=0,Nt=ri(Ae,this.__takeCount__);if(!T||!A&&$==Ae&&Nt==Ae)return ig(u,this.__actions__);var tn=[];e:for(;Ae--&&bt<Nt;){We+=m;for(var En=-1,nn=u[We];++En<tt;){var Ln=He[En],Vn=Ln.iteratee,ko=Ln.type,qs=Vn(nn);if(ko==qn)nn=qs;else if(!qs){if(ko==Kt)continue e;break e}}tn[bt++]=nn}return tn}ln.prototype=vl(xl.prototype),ln.prototype.constructor=ln;function Ma(u){var m=-1,T=u==null?0:u.length;for(this.clear();++m<T;){var A=u[m];this.set(A[0],A[1])}}function bh(){this.__data__=Pa?Pa(null):{},this.size=0}function cp(u){var m=this.has(u)&&delete this.__data__[u];return this.size-=m?1:0,m}function hp(u){var m=this.__data__;if(Pa){var T=m[u];return T===D?o:T}return jn.call(m,u)?m[u]:o}function Ji(u){var m=this.__data__;return Pa?m[u]!==o:jn.call(m,u)}function ar(u,m){var T=this.__data__;return this.size+=this.has(u)?0:1,T[u]=Pa&&m===o?D:m,this}Ma.prototype.clear=bh,Ma.prototype.delete=cp,Ma.prototype.get=hp,Ma.prototype.has=Ji,Ma.prototype.set=ar;function Bi(u){var m=-1,T=u==null?0:u.length;for(this.clear();++m<T;){var A=u[m];this.set(A[0],A[1])}}function rc(){this.__data__=[],this.size=0}function ic(u){var m=this.__data__,T=Q(m,u);if(T<0)return!1;var A=m.length-1;return T==A?m.pop():ds.call(m,T,1),--this.size,!0}function Fd(u){var m=this.__data__,T=Q(m,u);return T<0?o:m[T][1]}function tu(u){return Q(this.__data__,u)>-1}function nu(u,m){var T=this.__data__,A=Q(T,u);return A<0?(++this.size,T.push([u,m])):T[A][1]=m,this}Bi.prototype.clear=rc,Bi.prototype.delete=ic,Bi.prototype.get=Fd,Bi.prototype.has=tu,Bi.prototype.set=nu;function Qr(u){var m=-1,T=u==null?0:u.length;for(this.clear();++m<T;){var A=u[m];this.set(A[0],A[1])}}function ru(){this.size=0,this.__data__={hash:new Ma,map:new(eu||Bi),string:new Ma}}function Ct(u){var m=pu(this,u).delete(u);return this.size-=m?1:0,m}function Bt(u){return pu(this,u).get(u)}function sc(u){return pu(this,u).has(u)}function oc(u,m){var T=pu(this,u),A=T.size;return T.set(u,m),this.size+=T.size==A?0:1,this}Qr.prototype.clear=ru,Qr.prototype.delete=Ct,Qr.prototype.get=Bt,Qr.prototype.has=sc,Qr.prototype.set=oc;function bo(u){var m=-1,T=u==null?0:u.length;for(this.__data__=new Qr;++m<T;)this.add(u[m])}function y(u){return this.__data__.set(u,D),this}function t(u){return this.__data__.has(u)}bo.prototype.add=bo.prototype.push=y,bo.prototype.has=t;function a(u){var m=this.__data__=new Bi(u);this.size=m.size}function d(){this.__data__=new Bi,this.size=0}function f(u){var m=this.__data__,T=m.delete(u);return this.size=m.size,T}function g(u){return this.__data__.get(u)}function E(u){return this.__data__.has(u)}function I(u,m){var T=this.__data__;if(T instanceof Bi){var A=T.__data__;if(!eu||A.length<_-1)return A.push([u,m]),this.size=++T.size,this;T=this.__data__=new Qr(A)}return T.set(u,m),this.size=T.size,this}a.prototype.clear=d,a.prototype.delete=f,a.prototype.get=g,a.prototype.has=E,a.prototype.set=I;function k(u,m){var T=en(u),A=!T&&yu(u),$=!T&&!A&&ja(u),Y=!T&&!A&&!$&&S(u),fe=T||A||$||Y,we=fe?ch(u.length,Xl):[],Ae=we.length;for(var We in u)(m||jn.call(u,We))&&!(fe&&(We=="length"||$&&(We=="offset"||We=="parent")||Y&&(We=="buffer"||We=="byteLength"||We=="byteOffset")||Na(We,Ae)))&&we.push(We);return we}function z(u){var m=u.length;return m?u[Ud(0,m-1)]:o}function L(u,m){return Lh(es(u),xe(m,0,u.length))}function O(u){return Lh(es(u))}function V(u,m,T){(T!==o&&!Es(u[m],T)||T===o&&!(m in u))&&me(u,m,T)}function X(u,m,T){var A=u[m];(!(jn.call(u,m)&&Es(A,T))||T===o&&!(m in u))&&me(u,m,T)}function Q(u,m){for(var T=u.length;T--;)if(Es(u[T][0],m))return T;return-1}function ie(u,m,T,A){return pt(u,function($,Y,fe){m(A,$,T($),fe)}),A}function le(u,m){return u&&bs(m,yn(m),u)}function ce(u,m){return u&&bs(m,$n(m),u)}function me(u,m,T){m=="__proto__"&&Ea?Ea(u,m,{configurable:!0,enumerable:!0,value:T,writable:!0}):u[m]=T}function te(u,m){for(var T=-1,A=m.length,$=Oe(A),Y=u==null;++T<A;)$[T]=Y?o:Cs(u,m[T]);return $}function xe(u,m,T){return u===u&&(T!==o&&(u=u<=T?u:T),m!==o&&(u=u>=m?u:m)),u}function be(u,m,T,A,$,Y){var fe,we=m&W,Ae=m&q,We=m&Ee;if(T&&(fe=$?T(u,A,$,Y):T(u)),fe!==o)return fe;if(!br(u))return u;var He=en(u);if(He){if(fe=_g(u),!we)return es(u,fe)}else{var tt=yi(u),bt=tt==wn||tt==er;if(ja(u))return ag(u,we);if(tt==Fn||tt==cn||bt&&!$){if(fe=Ae||bt?{}:yg(u),!we)return Ae?Wd(u,ce(fe,u)):ly(u,le(fe,u))}else{if(!Wn[tt])return $?u:{};fe=fy(u,tt,we)}}Y||(Y=new a);var Nt=Y.get(u);if(Nt)return Nt;Y.set(u,fe),p(u)?u.forEach(function(nn){fe.add(be(nn,m,T,nn,u,Y))}):df(u)&&u.forEach(function(nn,Ln){fe.set(Ln,be(nn,m,T,Ln,u,Y))});var tn=We?Ae?bp:Cl:Ae?$n:yn,En=He?o:tn(u);return Yr(En||u,function(nn,Ln){En&&(Ln=nn,nn=u[Ln]),X(fe,Ln,be(nn,m,T,Ln,u,Y))}),fe}function Me(u){var m=yn(u);return function(T){return qe(T,u,m)}}function qe(u,m,T){var A=T.length;if(u==null)return!A;for(u=Hn(u);A--;){var $=T[A],Y=m[$],fe=u[$];if(fe===o&&!($ in u)||!Y(fe))return!1}return!0}function et(u,m,T){if(typeof u!="function")throw new Ci(w);return fc(function(){u.apply(o,T)},m)}function lt(u,m,T,A){var $=-1,Y=Vo,fe=!0,we=u.length,Ae=[],We=m.length;if(!we)return Ae;T&&(m=ir(m,pn(T))),A?(Y=oh,fe=!1):m.length>=_&&(Y=Os,fe=!1,m=new bo(m));e:for(;++$<we;){var He=u[$],tt=T==null?He:T(He);if(He=A||He!==0?He:0,fe&&tt===tt){for(var bt=We;bt--;)if(m[bt]===tt)continue e;Ae.push(He)}else Y(m,tt,A)||Ae.push(He)}return Ae}var pt=gp($t),ot=gp(un,!0);function at(u,m){var T=!0;return pt(u,function(A,$,Y){return T=!!m(A,$,Y),T}),T}function wt(u,m,T){for(var A=-1,$=u.length;++A<$;){var Y=u[A],fe=m(Y);if(fe!=null&&(we===o?fe===fe&&!x(fe):T(fe,we)))var we=fe,Ae=Y}return Ae}function Gt(u,m,T,A){var $=u.length;for(T=Z(T),T<0&&(T=-T>$?0:$+T),A=A===o||A>$?$:Z(A),A<0&&(A+=$),A=T>A?0:ne(A);T<A;)u[T++]=m;return u}function dt(u,m){var T=[];return pt(u,function(A,$,Y){m(A,$,Y)&&T.push(A)}),T}function nt(u,m,T,A,$){var Y=-1,fe=u.length;for(T||(T=my),$||($=[]);++Y<fe;){var we=u[Y];m>0&&T(we)?m>1?nt(we,m-1,T,A,$):qo($,we):A||($[$.length]=we)}return $}var jt=_p(),sr=_p(!0);function $t(u,m){return u&&jt(u,m,yn)}function un(u,m){return u&&sr(u,m,yn)}function Xn(u,m){return mo(m,function(T){return To(u[T])})}function Cr(u,m){m=Qo(m,u);for(var T=0,A=m.length;u!=null&&T<A;)u=u[ea(m[T++])];return T&&T==A?u:o}function ms(u,m,T){var A=m(u);return en(u)?A:qo(A,T(u))}function hn(u){return u==null?u===o?vr:Ce:yo&&yo in Hn(u)?gg(u):wy(u)}function pi(u,m){return u>m}function Ii(u,m){return u!=null&&jn.call(u,m)}function mi(u,m){return u!=null&&m in Hn(u)}function ki(u,m,T){return u>=ri(m,T)&&u<_r(m,T)}function gs(u,m,T){for(var A=T?oh:Vo,$=u[0].length,Y=u.length,fe=Y,we=Oe(Y),Ae=1/0,We=[];fe--;){var He=u[fe];fe&&m&&(He=ir(He,pn(m))),Ae=ri(He.length,Ae),we[fe]=!T&&(m||$>=120&&He.length>=120)?new bo(fe&&He):o}He=u[0];var tt=-1,bt=we[0];e:for(;++tt<$&&We.length<Ae;){var Nt=He[tt],tn=m?m(Nt):Nt;if(Nt=T||Nt!==0?Nt:0,!(bt?Os(bt,tn):A(We,tn,T))){for(fe=Y;--fe;){var En=we[fe];if(!(En?Os(En,tn):A(u[fe],tn,T)))continue e}bt&&bt.push(tn),We.push(Nt)}}return We}function wl(u,m,T,A){return $t(u,function($,Y,fe){m(A,T($),Y,fe)}),A}function Yo(u,m,T){m=Qo(m,u),u=dc(u,m);var A=u==null?u:u[ea(Us(m))];return A==null?o:Fi(A,u,T)}function za(u){return zr(u)&&hn(u)==cn}function _s(u){return zr(u)&&hn(u)==fr}function ac(u){return zr(u)&&hn(u)==rn}function Da(u,m,T,A,$){return u===m?!0:u==null||m==null||!zr(u)&&!zr(m)?u!==u&&m!==m:ys(u,m,T,A,Da,$)}function ys(u,m,T,A,$,Y){var fe=en(u),we=en(m),Ae=fe?Cn:yi(u),We=we?Cn:yi(m);Ae=Ae==cn?Fn:Ae,We=We==cn?Fn:We;var He=Ae==Fn,tt=We==Fn,bt=Ae==We;if(bt&&ja(u)){if(!ja(m))return!1;fe=!0,He=!1}if(bt&&!He)return Y||(Y=new a),fe||S(u)?mg(u,m,T,A,$,Y):dy(u,m,Ae,T,A,$,Y);if(!(T&ze)){var Nt=He&&jn.call(u,"__wrapped__"),tn=tt&&jn.call(m,"__wrapped__");if(Nt||tn){var En=Nt?u.value():u,nn=tn?m.value():m;return Y||(Y=new a),$(En,nn,T,A,Y)}}return bt?(Y||(Y=new a),wp(u,m,T,A,$,Y)):!1}function vs(u){return zr(u)&&yi(u)==sn}function to(u,m,T,A){var $=T.length,Y=$,fe=!A;if(u==null)return!Y;for(u=Hn(u);$--;){var we=T[$];if(fe&&we[2]?we[1]!==u[we[0]]:!(we[0]in u))return!1}for(;++$<Y;){we=T[$];var Ae=we[0],We=u[Ae],He=we[1];if(fe&&we[2]){if(We===o&&!(Ae in u))return!1}else{var tt=new a;if(A)var bt=A(We,He,Ae,u,m,tt);if(!(bt===o?Da(He,We,ze|Ne,A,tt):bt))return!1}}return!0}function xs(u){if(!br(u)||gy(u))return!1;var m=To(u)?Dd:Gn;return m.test(_u(u))}function si(u){return zr(u)&&hn(u)==Yt}function gi(u){return zr(u)&&yi(u)==Tr}function Qi(u){return zr(u)&&zl(u.length)&&!!or[hn(u)]}function gn(u){return typeof u=="function"?u:u==null?io:typeof u=="object"?en(u)?Th(u[0],u[1]):Bd(u):Aw(u)}function So(u){if(!Rh(u))return ec(u);var m=[];for(var T in Hn(u))jn.call(u,T)&&T!="constructor"&&m.push(T);return m}function bl(u){if(!br(u))return xy(u);var m=Rh(u),T=[];for(var A in u)A=="constructor"&&(m||!jn.call(u,A))||T.push(A);return T}function Jo(u,m){return u<m}function Sh(u,m){var T=-1,A=Vr(u)?Oe(u.length):[];return pt(u,function($,Y,fe){A[++T]=m($,Y,fe)}),A}function Bd(u){var m=mu(u);return m.length==1&&m[0][2]?kp(m[0][0],m[0][1]):function(T){return T===u||to(T,u,m)}}function Th(u,m){return Cp(u)&&Ip(m)?kp(ea(u),m):function(T){var A=Cs(T,u);return A===o&&A===m?Nr(T,u):Da(m,A,ze|Ne)}}function Bs(u,m,T,A,$){u!==m&&jt(m,function(Y,fe){if($||($=new a),br(Y))Nd(u,m,fe,T,Bs,A,$);else{var we=A?A(Ap(u,fe),Y,fe+"",u,m,$):o;we===o&&(we=Y),V(u,fe,we)}},$n)}function Nd(u,m,T,A,$,Y,fe){var we=Ap(u,T),Ae=Ap(m,T),We=fe.get(Ae);if(We){V(u,T,We);return}var He=Y?Y(we,Ae,T+"",u,m,fe):o,tt=He===o;if(tt){var bt=en(Ae),Nt=!bt&&ja(Ae),tn=!bt&&!Nt&&S(Ae);He=Ae,bt||Nt||tn?en(we)?He=we:Mr(we)?He=es(we):Nt?(tt=!1,He=ag(Ae,!0)):tn?(tt=!1,He=mp(Ae,!0)):He=[]:n(Ae)||yu(Ae)?(He=we,yu(we)?He=Pe(we):(!br(we)||To(we))&&(He=yg(Ae))):tt=!1}tt&&(fe.set(Ae,He),$(He,Ae,A,Y,fe),fe.delete(Ae)),V(u,T,He)}function iu(u,m){var T=u.length;if(T)return m+=m<0?T:0,Na(m,T)?u[m]:o}function Sl(u,m,T){m.length?m=ir(m,function(Y){return en(Y)?function(fe){return Cr(fe,Y.length===1?Y[0]:Y)}:Y}):m=[io];var A=-1;m=ir(m,pn(Vt()));var $=Sh(u,function(Y,fe,we){var Ae=ir(m,function(We){return We(Y)});return{criteria:Ae,index:++A,value:Y}});return lp($,function(Y,fe){return Ni(Y,fe,T)})}function lc(u,m){return su(u,m,function(T,A){return Nr(u,A)})}function su(u,m,T){for(var A=-1,$=m.length,Y={};++A<$;){var fe=m[A],we=Cr(u,fe);T(we,fe)&&Ns(Y,Qo(fe,u),we)}return Y}function Tl(u){return function(m){return Cr(m,u)}}function Ra(u,m,T,A){var $=A?uh:Zo,Y=-1,fe=m.length,we=u;for(u===m&&(m=es(m)),T&&(we=ir(u,pn(T)));++Y<fe;)for(var Ae=0,We=m[Y],He=T?T(We):We;(Ae=$(we,He,Ae,A))>-1;)we!==u&&ds.call(we,Ae,1),ds.call(u,Ae,1);return u}function Eh(u,m){for(var T=u?m.length:0,A=T-1;T--;){var $=m[T];if(T==A||$!==Y){var Y=$;Na($)?ds.call(u,$,1):cc(u,$)}}return u}function Ud(u,m){return u+Ko(tc()*(m-u+1))}function ng(u,m,T,A){for(var $=-1,Y=_r(Ia((m-u)/(T||1)),0),fe=Oe(Y);Y--;)fe[A?Y:++$]=u,u+=T;return fe}function dp(u,m){var T="";if(!u||m<1||m>Je)return T;do m%2&&(T+=u),m=Ko(m/2),m&&(u+=u);while(m);return T}function _n(u,m){return Mp(Jd(u,m,io),u+"")}function Ch(u){return z(ks(u))}function uc(u,m){var T=ks(u);return Lh(T,xe(m,0,T.length))}function Ns(u,m,T,A){if(!br(u))return u;m=Qo(m,u);for(var $=-1,Y=m.length,fe=Y-1,we=u;we!=null&&++$<Y;){var Ae=ea(m[$]),We=T;if(Ae==="__proto__"||Ae==="constructor"||Ae==="prototype")return u;if($!=fe){var He=we[Ae];We=A?A(He,Ae,we):o,We===o&&(We=br(He)?He:Na(m[$+1])?[]:{})}X(we,Ae,We),we=we[Ae]}return u}var no=xo?function(u,m){return xo.set(u,m),u}:io,El=Ea?function(u,m){return Ea(u,"toString",{configurable:!0,enumerable:!1,value:_1(m),writable:!0})}:io;function rg(u){return Lh(ks(u))}function _i(u,m,T){var A=-1,$=u.length;m<0&&(m=-m>$?0:$+m),T=T>$?$:T,T<0&&(T+=$),$=m>T?0:T-m>>>0,m>>>=0;for(var Y=Oe($);++A<$;)Y[A]=u[A+m];return Y}function ay(u,m){var T;return pt(u,function(A,$,Y){return T=m(A,$,Y),!T}),!!T}function Ih(u,m,T){var A=0,$=u==null?A:u.length;if(typeof m=="number"&&m===m&&$<=St){for(;A<$;){var Y=A+$>>>1,fe=u[Y];fe!==null&&!x(fe)&&(T?fe<=m:fe<m)?A=Y+1:$=Y}return $}return Ir(u,m,io,T)}function Ir(u,m,T,A){var $=0,Y=u==null?0:u.length;if(Y===0)return 0;m=T(m);for(var fe=m!==m,we=m===null,Ae=x(m),We=m===o;$<Y;){var He=Ko(($+Y)/2),tt=T(u[He]),bt=tt!==o,Nt=tt===null,tn=tt===tt,En=x(tt);if(fe)var nn=A||tn;else We?nn=tn&&(A||bt):we?nn=tn&&bt&&(A||!Nt):Ae?nn=tn&&bt&&!Nt&&(A||!En):Nt||En?nn=!1:nn=A?tt<=m:tt<m;nn?$=He+1:Y=He}return ri(Y,It)}function jd(u,m){for(var T=-1,A=u.length,$=0,Y=[];++T<A;){var fe=u[T],we=m?m(fe):fe;if(!T||!Es(we,Ae)){var Ae=we;Y[$++]=fe===0?0:fe}}return Y}function fp(u){return typeof u=="number"?u:x(u)?Et:+u}function oi(u){if(typeof u=="string")return u;if(en(u))return ir(u,oi)+"";if(x(u))return mn?mn.call(u):"";var m=u+"";return m=="0"&&1/u==-zt?"-0":m}function ws(u,m,T){var A=-1,$=Vo,Y=u.length,fe=!0,we=[],Ae=we;if(T)fe=!1,$=oh;else if(Y>=_){var We=m?null:Dh(u);if(We)return Wo(We);fe=!1,$=Os,Ae=new bo}else Ae=m?[]:we;e:for(;++A<Y;){var He=u[A],tt=m?m(He):He;if(He=T||He!==0?He:0,fe&&tt===tt){for(var bt=Ae.length;bt--;)if(Ae[bt]===tt)continue e;m&&Ae.push(tt),we.push(He)}else $(Ae,tt,T)||(Ae!==we&&Ae.push(tt),we.push(He))}return we}function cc(u,m){return m=Qo(m,u),u=dc(u,m),u==null||delete u[ea(Us(m))]}function $d(u,m,T,A){return Ns(u,m,T(Cr(u,m)),A)}function kh(u,m,T,A){for(var $=u.length,Y=A?$:-1;(A?Y--:++Y<$)&&m(u[Y],Y,u););return T?_i(u,A?0:Y,A?Y+1:$):_i(u,A?Y+1:0,A?$:Y)}function ig(u,m){var T=u;return T instanceof ln&&(T=T.value()),ah(m,function(A,$){return $.func.apply($.thisArg,qo([A],$.args))},T)}function Vd(u,m,T){var A=u.length;if(A<2)return A?ws(u[0]):[];for(var $=-1,Y=Oe(A);++$<A;)for(var fe=u[$],we=-1;++we<A;)we!=$&&(Y[$]=lt(Y[$]||fe,u[we],m,T));return ws(nt(Y,1),m,T)}function sg(u,m,T){for(var A=-1,$=u.length,Y=m.length,fe={};++A<$;){var we=A<Y?m[A]:o;T(fe,u[A],we)}return fe}function Ph(u){return Mr(u)?u:[]}function pp(u){return typeof u=="function"?u:io}function Qo(u,m){return en(u)?u:Cp(u,m)?[u]:bg(_e(u))}var og=_n;function La(u,m,T){var A=u.length;return T=T===o?A:T,!m&&T>=A?u:_i(u,m,T)}var ou=mh||function(u){return pr.clearTimeout(u)};function ag(u,m){if(m)return u.slice();var T=u.length,A=ml?ml(T):new u.constructor(T);return u.copy(A),A}function au(u){var m=new u.constructor(u.byteLength);return new fi(m).set(new fi(u)),m}function qd(u,m){var T=m?au(u.buffer):u.buffer;return new u.constructor(T,u.byteOffset,u.byteLength)}function Zd(u){var m=new u.constructor(u.source,Ar.exec(u));return m.lastIndex=u.lastIndex,m}function lg(u){return Aa?Hn(Aa.call(u)):{}}function mp(u,m){var T=m?au(u.buffer):u.buffer;return new u.constructor(T,u.byteOffset,u.length)}function ug(u,m){if(u!==m){var T=u!==o,A=u===null,$=u===u,Y=x(u),fe=m!==o,we=m===null,Ae=m===m,We=x(m);if(!we&&!We&&!Y&&u>m||Y&&fe&&Ae&&!we&&!We||A&&fe&&Ae||!T&&Ae||!$)return 1;if(!A&&!Y&&!We&&u<m||We&&T&&$&&!A&&!Y||we&&T&&$||!fe&&$||!Ae)return-1}return 0}function Ni(u,m,T){for(var A=-1,$=u.criteria,Y=m.criteria,fe=$.length,we=T.length;++A<fe;){var Ae=ug($[A],Y[A]);if(Ae){if(A>=we)return Ae;var We=T[A];return Ae*(We=="desc"?-1:1)}}return u.index-m.index}function lu(u,m,T,A){for(var $=-1,Y=u.length,fe=T.length,we=-1,Ae=m.length,We=_r(Y-fe,0),He=Oe(Ae+We),tt=!A;++we<Ae;)He[we]=m[we];for(;++$<fe;)(tt||$<Y)&&(He[T[$]]=u[$]);for(;We--;)He[we++]=u[$++];return He}function Gd(u,m,T,A){for(var $=-1,Y=u.length,fe=-1,we=T.length,Ae=-1,We=m.length,He=_r(Y-we,0),tt=Oe(He+We),bt=!A;++$<He;)tt[$]=u[$];for(var Nt=$;++Ae<We;)tt[Nt+Ae]=m[Ae];for(;++fe<we;)(bt||$<Y)&&(tt[Nt+T[fe]]=u[$++]);return tt}function es(u,m){var T=-1,A=u.length;for(m||(m=Oe(A));++T<A;)m[T]=u[T];return m}function bs(u,m,T,A){var $=!T;T||(T={});for(var Y=-1,fe=m.length;++Y<fe;){var we=m[Y],Ae=A?A(T[we],u[we],we,T,u):o;Ae===o&&(Ae=u[we]),$?me(T,we,Ae):X(T,we,Ae)}return T}function ly(u,m){return bs(u,gu(u),m)}function Wd(u,m){return bs(u,Yd(u),m)}function Hd(u,m){return function(T,A){var $=en(T)?Td:ie,Y=m?m():{};return $(T,u,Vt(A,2),Y)}}function uu(u){return _n(function(m,T){var A=-1,$=T.length,Y=$>1?T[$-1]:o,fe=$>2?T[2]:o;for(Y=u.length>3&&typeof Y=="function"?($--,Y):o,fe&&Fr(T[0],T[1],fe)&&(Y=$<3?o:Y,$=1),m=Hn(m);++A<$;){var we=T[A];we&&u(m,we,A,Y)}return m})}function gp(u,m){return function(T,A){if(T==null)return T;if(!Vr(T))return u(T,A);for(var $=T.length,Y=m?$:-1,fe=Hn(T);(m?Y--:++Y<$)&&A(fe[Y],Y,fe)!==!1;);return T}}function _p(u){return function(m,T,A){for(var $=-1,Y=Hn(m),fe=A(m),we=fe.length;we--;){var Ae=fe[u?we:++$];if(T(Y[Ae],Ae,Y)===!1)break}return m}}function uy(u,m,T){var A=m&Be,$=hu(u);function Y(){var fe=this&&this!==pr&&this instanceof Y?$:u;return fe.apply(A?T:this,arguments)}return Y}function Xd(u){return function(m){m=_e(m);var T=Go(m)?Yi(m):o,A=T?T[0]:m.charAt(0),$=T?La(T,1).join(""):m.slice(1);return A[u]()+$}}function cu(u){return function(m){return ah(kw(sm(m).replace(Vu,"")),u,"")}}function hu(u){return function(){var m=arguments;switch(m.length){case 0:return new u;case 1:return new u(m[0]);case 2:return new u(m[0],m[1]);case 3:return new u(m[0],m[1],m[2]);case 4:return new u(m[0],m[1],m[2],m[3]);case 5:return new u(m[0],m[1],m[2],m[3],m[4]);case 6:return new u(m[0],m[1],m[2],m[3],m[4],m[5]);case 7:return new u(m[0],m[1],m[2],m[3],m[4],m[5],m[6])}var T=vl(u.prototype),A=u.apply(T,m);return br(A)?A:T}}function Ah(u,m,T){var A=hu(u);function $(){for(var Y=arguments.length,fe=Oe(Y),we=Y,Ae=fu($);we--;)fe[we]=arguments[we];var We=Y<3&&fe[0]!==Ae&&fe[Y-1]!==Ae?[]:Ki(fe,Ae);if(Y-=We.length,Y<T)return xp(u,m,hc,$.placeholder,o,fe,We,o,o,T-Y);var He=this&&this!==pr&&this instanceof $?A:u;return Fi(He,this,fe)}return $}function Ss(u){return function(m,T,A){var $=Hn(m);if(!Vr(m)){var Y=Vt(T,3);m=yn(m),T=function(we){return Y($[we],we,$)}}var fe=u(m,T,A);return fe>-1?$[Y?m[fe]:fe]:o}}function yp(u){return Ba(function(m){var T=m.length,A=T,$=ps.prototype.thru;for(u&&m.reverse();A--;){var Y=m[A];if(typeof Y!="function")throw new Ci(w);if($&&!fe&&du(Y)=="wrapper")var fe=new ps([],!0)}for(A=fe?A:T;++A<T;){Y=m[A];var we=du(Y),Ae=we=="wrapper"?wr(Y):o;Ae&&kl(Ae[0])&&Ae[1]==(ve|he|Ze|ee)&&!Ae[4].length&&Ae[9]==1?fe=fe[du(Ae[0])].apply(fe,Ae[3]):fe=Y.length==1&&kl(Y)?fe[we]():fe.thru(Y)}return function(){var We=arguments,He=We[0];if(fe&&We.length==1&&en(He))return fe.plant(He).value();for(var tt=0,bt=T?m[tt].apply(this,We):He;++tt<T;)bt=m[tt].call(this,bt);return bt}})}function hc(u,m,T,A,$,Y,fe,we,Ae,We){var He=m&ve,tt=m&Be,bt=m&se,Nt=m&(he|De),tn=m&de,En=bt?o:hu(u);function nn(){for(var Ln=arguments.length,Vn=Oe(Ln),ko=Ln;ko--;)Vn[ko]=arguments[ko];if(Nt)var qs=fu(nn),Po=hh(Vn,qs);if(A&&(Vn=lu(Vn,A,$,Nt)),Y&&(Vn=Gd(Vn,Y,fe,Nt)),Ln-=Po,Nt&&Ln<We){var ui=Ki(Vn,qs);return xp(u,m,hc,nn.placeholder,T,Vn,ui,we,Ae,We-Ln)}var $a=tt?T:this,bu=bt?$a[u]:u;return Ln=Vn.length,we?Vn=Pp(Vn,we):tn&&Ln>1&&Vn.reverse(),He&&Ae<Ln&&(Vn.length=Ae),this&&this!==pr&&this instanceof nn&&(bu=En||hu(bu)),bu.apply($a,Vn)}return nn}function cg(u,m){return function(T,A){return wl(T,u,m(A),{})}}function Mh(u,m){return function(T,A){var $;if(T===o&&A===o)return m;if(T!==o&&($=T),A!==o){if($===o)return A;typeof T=="string"||typeof A=="string"?(T=oi(T),A=oi(A)):(T=fp(T),A=fp(A)),$=u(T,A)}return $}}function vp(u){return Ba(function(m){return m=ir(m,pn(Vt())),_n(function(T){var A=this;return u(m,function($){return Fi($,A,T)})})})}function Kd(u,m){m=m===o?" ":oi(m);var T=m.length;if(T<2)return T?dp(m,u):m;var A=dp(m,Ia(u/xa(m)));return Go(m)?La(Yi(A),0,u).join(""):A.slice(0,u)}function cy(u,m,T,A){var $=m&Be,Y=hu(u);function fe(){for(var we=-1,Ae=arguments.length,We=-1,He=A.length,tt=Oe(He+Ae),bt=this&&this!==pr&&this instanceof fe?Y:u;++We<He;)tt[We]=A[We];for(;Ae--;)tt[We++]=arguments[++we];return Fi(bt,$?T:this,tt)}return fe}function hg(u){return function(m,T,A){return A&&typeof A!="number"&&Fr(m,T,A)&&(T=A=o),m=G(m),T===o?(T=m,m=0):T=G(T),A=A===o?m<T?1:-1:G(A),ng(m,T,A,u)}}function zh(u){return function(m,T){return typeof m=="string"&&typeof T=="string"||(m=oe(m),T=oe(T)),u(m,T)}}function xp(u,m,T,A,$,Y,fe,we,Ae,We){var He=m&he,tt=He?fe:o,bt=He?o:fe,Nt=He?Y:o,tn=He?o:Y;m|=He?Ze:je,m&=~(He?je:Ze),m&ue||(m&=~(Be|se));var En=[u,m,$,Nt,tt,tn,bt,we,Ae,We],nn=T.apply(o,En);return kl(u)&&xg(nn,En),nn.placeholder=A,wg(nn,u,m)}function Oa(u){var m=gr[u];return function(T,A){if(T=oe(T),A=A==null?0:ri(Z(A),292),A&&Qu(T)){var $=(_e(T)+"e").split("e"),Y=m($[0]+"e"+(+$[1]+A));return $=(_e(Y)+"e").split("e"),+($[0]+"e"+(+$[1]-A))}return m(T)}}var Dh=ka&&1/Wo(new ka([,-0]))[1]==zt?function(u){return new ka(u)}:x1;function dg(u){return function(m){var T=yi(m);return T==sn?va(m):T==Tr?Ku(m):an(m,u(m))}}function Fa(u,m,T,A,$,Y,fe,we){var Ae=m&se;if(!Ae&&typeof u!="function")throw new Ci(w);var We=A?A.length:0;if(We||(m&=~(Ze|je),A=$=o),fe=fe===o?fe:_r(Z(fe),0),we=we===o?we:Z(we),We-=$?$.length:0,m&je){var He=A,tt=$;A=$=o}var bt=Ae?o:wr(u),Nt=[u,m,T,A,$,He,tt,Y,fe,we];if(bt&&vy(Nt,bt),u=Nt[0],m=Nt[1],T=Nt[2],A=Nt[3],$=Nt[4],we=Nt[9]=Nt[9]===o?Ae?0:u.length:_r(Nt[9]-We,0),!we&&m&(he|De)&&(m&=~(he|De)),!m||m==Be)var tn=uy(u,m,T);else m==he||m==De?tn=Ah(u,m,we):(m==Ze||m==(Be|Ze))&&!$.length?tn=cy(u,m,T,A):tn=hc.apply(o,Nt);var En=bt?no:xg;return wg(En(tn,Nt),u,m)}function fg(u,m,T,A){return u===o||Es(u,fl[T])&&!jn.call(A,T)?m:u}function pg(u,m,T,A,$,Y){return br(u)&&br(m)&&(Y.set(m,u),Bs(u,m,o,pg,Y),Y.delete(m)),u}function hy(u){return n(u)?o:u}function mg(u,m,T,A,$,Y){var fe=T&ze,we=u.length,Ae=m.length;if(we!=Ae&&!(fe&&Ae>we))return!1;var We=Y.get(u),He=Y.get(m);if(We&&He)return We==m&&He==u;var tt=-1,bt=!0,Nt=T&Ne?new bo:o;for(Y.set(u,m),Y.set(m,u);++tt<we;){var tn=u[tt],En=m[tt];if(A)var nn=fe?A(En,tn,tt,m,u,Y):A(tn,En,tt,u,m,Y);if(nn!==o){if(nn)continue;bt=!1;break}if(Nt){if(!Wu(m,function(Ln,Vn){if(!Os(Nt,Vn)&&(tn===Ln||$(tn,Ln,T,A,Y)))return Nt.push(Vn)})){bt=!1;break}}else if(!(tn===En||$(tn,En,T,A,Y))){bt=!1;break}}return Y.delete(u),Y.delete(m),bt}function dy(u,m,T,A,$,Y,fe){switch(T){case Ke:if(u.byteLength!=m.byteLength||u.byteOffset!=m.byteOffset)return!1;u=u.buffer,m=m.buffer;case fr:return!(u.byteLength!=m.byteLength||!Y(new fi(u),new fi(m)));case Zt:case rn:case dn:return Es(+u,+m);case Qt:return u.name==m.name&&u.message==m.message;case Yt:case yr:return u==m+"";case sn:var we=va;case Tr:var Ae=A&ze;if(we||(we=Wo),u.size!=m.size&&!Ae)return!1;var We=fe.get(u);if(We)return We==m;A|=Ne,fe.set(u,m);var He=mg(we(u),we(m),A,$,Y,fe);return fe.delete(u),He;case Hr:if(Aa)return Aa.call(u)==Aa.call(m)}return!1}function wp(u,m,T,A,$,Y){var fe=T&ze,we=Cl(u),Ae=we.length,We=Cl(m),He=We.length;if(Ae!=He&&!fe)return!1;for(var tt=Ae;tt--;){var bt=we[tt];if(!(fe?bt in m:jn.call(m,bt)))return!1}var Nt=Y.get(u),tn=Y.get(m);if(Nt&&tn)return Nt==m&&tn==u;var En=!0;Y.set(u,m),Y.set(m,u);for(var nn=fe;++tt<Ae;){bt=we[tt];var Ln=u[bt],Vn=m[bt];if(A)var ko=fe?A(Vn,Ln,bt,m,u,Y):A(Ln,Vn,bt,u,m,Y);if(!(ko===o?Ln===Vn||$(Ln,Vn,T,A,Y):ko)){En=!1;break}nn||(nn=bt=="constructor")}if(En&&!nn){var qs=u.constructor,Po=m.constructor;qs!=Po&&"constructor"in u&&"constructor"in m&&!(typeof qs=="function"&&qs instanceof qs&&typeof Po=="function"&&Po instanceof Po)&&(En=!1)}return Y.delete(u),Y.delete(m),En}function Ba(u){return Mp(Jd(u,o,Dp),u+"")}function Cl(u){return ms(u,yn,gu)}function bp(u){return ms(u,$n,Yd)}var wr=xo?function(u){return xo.get(u)}:x1;function du(u){for(var m=u.name+"",T=ii[m],A=jn.call(ii,m)?T.length:0;A--;){var $=T[A],Y=$.func;if(Y==null||Y==u)return $.name}return m}function fu(u){var m=jn.call(H,"placeholder")?H:u;return m.placeholder}function Vt(){var u=H.iteratee||y1;return u=u===y1?gn:u,arguments.length?u(arguments[0],arguments[1]):u}function pu(u,m){var T=u.__data__;return vg(m)?T[typeof m=="string"?"string":"hash"]:T.map}function mu(u){for(var m=yn(u),T=m.length;T--;){var A=m[T],$=u[A];m[T]=[A,$,Ip($)]}return m}function Il(u,m){var T=dh(u,m);return xs(T)?T:o}function gg(u){var m=jn.call(u,yo),T=u[yo];try{u[yo]=o;var A=!0}catch{}var $=$r.call(u);return A&&(m?u[yo]=T:delete u[yo]),$}var gu=Ql?function(u){return u==null?[]:(u=Hn(u),mo(Ql(u),function(m){return Ta.call(u,m)}))}:w1,Yd=Ql?function(u){for(var m=[];u;)qo(m,gu(u)),u=gl(u);return m}:w1,yi=hn;(vo&&yi(new vo(new ArrayBuffer(1)))!=Ke||eu&&yi(new eu)!=sn||vh&&yi(vh.resolve())!=bn||ka&&yi(new ka)!=Tr||_l&&yi(new _l)!=rr)&&(yi=function(u){var m=hn(u),T=m==Fn?u.constructor:o,A=T?_u(T):"";if(A)switch(A){case vt:return Ke;case nc:return sn;case xh:return bn;case Rd:return Tr;case yl:return rr}return m});function Sp(u,m,T){for(var A=-1,$=T.length;++A<$;){var Y=T[A],fe=Y.size;switch(Y.type){case"drop":u+=fe;break;case"dropRight":m-=fe;break;case"take":m=ri(m,u+fe);break;case"takeRight":u=_r(u,m-fe);break}}return{start:u,end:m}}function Tp(u){var m=u.match(Mt);return m?m[1].split(Lt):[]}function Ep(u,m,T){m=Qo(m,u);for(var A=-1,$=m.length,Y=!1;++A<$;){var fe=ea(m[A]);if(!(Y=u!=null&&T(u,fe)))break;u=u[fe]}return Y||++A!=$?Y:($=u==null?0:u.length,!!$&&zl($)&&Na(fe,$)&&(en(u)||yu(u)))}function _g(u){var m=u.length,T=new u.constructor(m);return m&&typeof u[0]=="string"&&jn.call(u,"index")&&(T.index=u.index,T.input=u.input),T}function yg(u){return typeof u.constructor=="function"&&!Rh(u)?vl(gl(u)):{}}function fy(u,m,T){var A=u.constructor;switch(m){case fr:return au(u);case Zt:case rn:return new A(+u);case Ke:return qd(u,T);case hi:case Lr:case jr:case Pr:case it:case Ht:case Ut:case di:case Gi:return mp(u,T);case sn:return new A;case dn:case yr:return new A(u);case Yt:return Zd(u);case Tr:return new A;case Hr:return lg(u)}}function py(u,m){var T=m.length;if(!T)return u;var A=T-1;return m[A]=(T>1?"& ":"")+m[A],m=m.join(T>2?", ":" "),u.replace(st,`{
/* [wrapped with `+m+`] */
`)}function my(u){return en(u)||yu(u)||!!(Ju&&u&&u[Ju])}function Na(u,m){var T=typeof u;return m=m??Je,!!m&&(T=="number"||T!="symbol"&&Xr.test(u))&&u>-1&&u%1==0&&u<m}function Fr(u,m,T){if(!br(T))return!1;var A=typeof m;return(A=="number"?Vr(T)&&Na(m,T.length):A=="string"&&m in T)?Es(T[m],u):!1}function Cp(u,m){if(en(u))return!1;var T=typeof u;return T=="number"||T=="symbol"||T=="boolean"||u==null||x(u)?!0:Se.test(u)||!ye.test(u)||m!=null&&u in Hn(m)}function vg(u){var m=typeof u;return m=="string"||m=="number"||m=="symbol"||m=="boolean"?u!=="__proto__":u===null}function kl(u){var m=du(u),T=H[m];if(typeof T!="function"||!(m in ln.prototype))return!1;if(u===T)return!0;var A=wr(T);return!!A&&u===A[0]}function gy(u){return!!pl&&pl in u}var _y=Kl?To:b1;function Rh(u){var m=u&&u.constructor,T=typeof m=="function"&&m.prototype||fl;return u===T}function Ip(u){return u===u&&!br(u)}function kp(u,m){return function(T){return T==null?!1:T[u]===m&&(m!==o||u in Hn(T))}}function yy(u){var m=Vh(u,function(A){return T.size===U&&T.clear(),A}),T=m.cache;return m}function vy(u,m){var T=u[1],A=m[1],$=T|A,Y=$<(Be|se|ve),fe=A==ve&&T==he||A==ve&&T==ee&&u[7].length<=m[8]||A==(ve|ee)&&m[7].length<=m[8]&&T==he;if(!(Y||fe))return u;A&Be&&(u[2]=m[2],$|=T&Be?0:ue);var we=m[3];if(we){var Ae=u[3];u[3]=Ae?lu(Ae,we,m[4]):we,u[4]=Ae?Ki(u[3],J):m[4]}return we=m[5],we&&(Ae=u[5],u[5]=Ae?Gd(Ae,we,m[6]):we,u[6]=Ae?Ki(u[5],J):m[6]),we=m[7],we&&(u[7]=we),A&ve&&(u[8]=u[8]==null?m[8]:ri(u[8],m[8])),u[9]==null&&(u[9]=m[9]),u[0]=m[0],u[1]=$,u}function xy(u){var m=[];if(u!=null)for(var T in Hn(u))m.push(T);return m}function wy(u){return $r.call(u)}function Jd(u,m,T){return m=_r(m===o?u.length-1:m,0),function(){for(var A=arguments,$=-1,Y=_r(A.length-m,0),fe=Oe(Y);++$<Y;)fe[$]=A[m+$];$=-1;for(var we=Oe(m+1);++$<m;)we[$]=A[$];return we[m]=T(fe),Fi(u,this,we)}}function dc(u,m){return m.length<2?u:Cr(u,_i(m,0,-1))}function Pp(u,m){for(var T=u.length,A=ri(m.length,T),$=es(u);A--;){var Y=m[A];u[A]=Na(Y,T)?$[Y]:o}return u}function Ap(u,m){if(!(m==="constructor"&&typeof u[m]=="function")&&m!="__proto__")return u[m]}var xg=pc(no),fc=Ca||function(u,m){return pr.setTimeout(u,m)},Mp=pc(El);function wg(u,m,T){var A=m+"";return Mp(u,py(A,by(Tp(A),T)))}function pc(u){var m=0,T=0;return function(){var A=fs(),$=mt-(A-T);if(T=A,$>0){if(++m>=Xe)return arguments[0]}else m=0;return u.apply(o,arguments)}}function Lh(u,m){var T=-1,A=u.length,$=A-1;for(m=m===o?A:m;++T<m;){var Y=Ud(T,$),fe=u[Y];u[Y]=u[T],u[T]=fe}return u.length=m,u}var bg=yy(function(u){var m=[];return u.charCodeAt(0)===46&&m.push(""),u.replace(ke,function(T,A,$,Y){m.push($?Y.replace(kn,"$1"):A||T)}),m});function ea(u){if(typeof u=="string"||x(u))return u;var m=u+"";return m=="0"&&1/u==-zt?"-0":m}function _u(u){if(u!=null){try{return ba.call(u)}catch{}try{return u+""}catch{}}return""}function by(u,m){return Yr(Sn,function(T){var A="_."+T[0];m&T[1]&&!Vo(u,A)&&u.push(A)}),u.sort()}function Sg(u){if(u instanceof ln)return u.clone();var m=new ps(u.__wrapped__,u.__chain__);return m.__actions__=es(u.__actions__),m.__index__=u.__index__,m.__values__=u.__values__,m}function Sy(u,m,T){(T?Fr(u,m,T):m===o)?m=1:m=_r(Z(m),0);var A=u==null?0:u.length;if(!A||m<1)return[];for(var $=0,Y=0,fe=Oe(Ia(A/m));$<A;)fe[Y++]=_i(u,$,$+=m);return fe}function Tg(u){for(var m=-1,T=u==null?0:u.length,A=0,$=[];++m<T;){var Y=u[m];Y&&($[A++]=Y)}return $}function zp(){var u=arguments.length;if(!u)return[];for(var m=Oe(u-1),T=arguments[0],A=u;A--;)m[A-1]=arguments[A];return qo(en(T)?es(T):[T],nt(m,1))}var Eg=_n(function(u,m){return Mr(u)?lt(u,nt(m,1,Mr,!0)):[]}),Cg=_n(function(u,m){var T=Us(m);return Mr(T)&&(T=o),Mr(u)?lt(u,nt(m,1,Mr,!0),Vt(T,2)):[]}),Ig=_n(function(u,m){var T=Us(m);return Mr(T)&&(T=o),Mr(u)?lt(u,nt(m,1,Mr,!0),o,T):[]});function Ty(u,m,T){var A=u==null?0:u.length;return A?(m=T||m===o?1:Z(m),_i(u,m<0?0:m,A)):[]}function Qd(u,m,T){var A=u==null?0:u.length;return A?(m=T||m===o?1:Z(m),m=A-m,_i(u,0,m<0?0:m)):[]}function Ey(u,m){return u&&u.length?kh(u,Vt(m,3),!0,!0):[]}function kg(u,m){return u&&u.length?kh(u,Vt(m,3),!0):[]}function Cy(u,m,T,A){var $=u==null?0:u.length;return $?(T&&typeof T!="number"&&Fr(u,m,T)&&(T=0,A=$),Gt(u,m,T,A)):[]}function Pg(u,m,T){var A=u==null?0:u.length;if(!A)return-1;var $=T==null?0:Z(T);return $<0&&($=_r(A+$,0)),cs(u,Vt(m,3),$)}function Ag(u,m,T){var A=u==null?0:u.length;if(!A)return-1;var $=A-1;return T!==o&&($=Z(T),$=T<0?_r(A+$,0):ri($,A-1)),cs(u,Vt(m,3),$,!0)}function Dp(u){var m=u==null?0:u.length;return m?nt(u,1):[]}function Iy(u){var m=u==null?0:u.length;return m?nt(u,zt):[]}function ky(u,m){var T=u==null?0:u.length;return T?(m=m===o?1:Z(m),nt(u,m)):[]}function Oh(u){for(var m=-1,T=u==null?0:u.length,A={};++m<T;){var $=u[m];A[$[0]]=$[1]}return A}function Br(u){return u&&u.length?u[0]:o}function Mg(u,m,T){var A=u==null?0:u.length;if(!A)return-1;var $=T==null?0:Z(T);return $<0&&($=_r(A+$,0)),Zo(u,m,$)}function zg(u){var m=u==null?0:u.length;return m?_i(u,0,-1):[]}var Dg=_n(function(u){var m=ir(u,Ph);return m.length&&m[0]===u[0]?gs(m):[]}),Kn=_n(function(u){var m=Us(u),T=ir(u,Ph);return m===Us(T)?m=o:T.pop(),T.length&&T[0]===u[0]?gs(T,Vt(m,2)):[]}),Rp=_n(function(u){var m=Us(u),T=ir(u,Ph);return m=typeof m=="function"?m:o,m&&T.pop(),T.length&&T[0]===u[0]?gs(T,o,m):[]});function Rg(u,m){return u==null?"":yh.call(u,m)}function Us(u){var m=u==null?0:u.length;return m?u[m-1]:o}function Ua(u,m,T){var A=u==null?0:u.length;if(!A)return-1;var $=A;return T!==o&&($=Z(T),$=$<0?_r(A+$,0):ri($,A-1)),m===m?hl(u,m,$):cs(u,Hu,$,!0)}function mc(u,m){return u&&u.length?iu(u,Z(m)):o}var Lg=_n(Og);function Og(u,m){return u&&u.length&&m&&m.length?Ra(u,m):u}function Py(u,m,T){return u&&u.length&&m&&m.length?Ra(u,m,Vt(T,2)):u}function Ay(u,m,T){return u&&u.length&&m&&m.length?Ra(u,m,o,T):u}var My=Ba(function(u,m){var T=u==null?0:u.length,A=te(u,m);return Eh(u,ir(m,function($){return Na($,T)?+$:$}).sort(ug)),A});function zy(u,m){var T=[];if(!(u&&u.length))return T;var A=-1,$=[],Y=u.length;for(m=Vt(m,3);++A<Y;){var fe=u[A];m(fe,A,u)&&(T.push(fe),$.push(A))}return Eh(u,$),T}function Lp(u){return u==null?u:Fs.call(u)}function Dy(u,m,T){var A=u==null?0:u.length;return A?(T&&typeof T!="number"&&Fr(u,m,T)?(m=0,T=A):(m=m==null?0:Z(m),T=T===o?A:Z(T)),_i(u,m,T)):[]}function Ry(u,m){return Ih(u,m)}function Ly(u,m,T){return Ir(u,m,Vt(T,2))}function ef(u,m){var T=u==null?0:u.length;if(T){var A=Ih(u,m);if(A<T&&Es(u[A],m))return A}return-1}function gc(u,m){return Ih(u,m,!0)}function Fg(u,m,T){return Ir(u,m,Vt(T,2),!0)}function Op(u,m){var T=u==null?0:u.length;if(T){var A=Ih(u,m,!0)-1;if(Es(u[A],m))return A}return-1}function Fp(u){return u&&u.length?jd(u):[]}function Oy(u,m){return u&&u.length?jd(u,Vt(m,2)):[]}function Fy(u){var m=u==null?0:u.length;return m?_i(u,1,m):[]}function By(u,m,T){return u&&u.length?(m=T||m===o?1:Z(m),_i(u,0,m<0?0:m)):[]}function Bg(u,m,T){var A=u==null?0:u.length;return A?(m=T||m===o?1:Z(m),m=A-m,_i(u,m<0?0:m,A)):[]}function Ng(u,m){return u&&u.length?kh(u,Vt(m,3),!1,!0):[]}function ts(u,m){return u&&u.length?kh(u,Vt(m,3)):[]}var Bp=_n(function(u){return ws(nt(u,1,Mr,!0))}),Ug=_n(function(u){var m=Us(u);return Mr(m)&&(m=o),ws(nt(u,1,Mr,!0),Vt(m,2))}),Pl=_n(function(u){var m=Us(u);return m=typeof m=="function"?m:o,ws(nt(u,1,Mr,!0),o,m)});function Fh(u){return u&&u.length?ws(u):[]}function Bh(u,m){return u&&u.length?ws(u,Vt(m,2)):[]}function _c(u,m){return m=typeof m=="function"?m:o,u&&u.length?ws(u,o,m):[]}function yc(u){if(!(u&&u.length))return[];var m=0;return u=mo(u,function(T){if(Mr(T))return m=_r(T.length,m),!0}),ch(m,function(T){return ir(u,Wl(T))})}function Nh(u,m){if(!(u&&u.length))return[];var T=yc(u);return m==null?T:ir(T,function(A){return Fi(m,o,A)})}var Ny=_n(function(u,m){return Mr(u)?lt(u,m):[]}),Uy=_n(function(u){return Vd(mo(u,Mr))}),jg=_n(function(u){var m=Us(u);return Mr(m)&&(m=o),Vd(mo(u,Mr),Vt(m,2))}),$g=_n(function(u){var m=Us(u);return m=typeof m=="function"?m:o,Vd(mo(u,Mr),o,m)}),jy=_n(yc);function Vg(u,m){return sg(u||[],m||[],X)}function qg(u,m){return sg(u||[],m||[],Ns)}var Np=_n(function(u){var m=u.length,T=m>1?u[m-1]:o;return T=typeof T=="function"?(u.pop(),T):o,Nh(u,T)});function tf(u){var m=H(u);return m.__chain__=!0,m}function $y(u,m){return m(u),u}function nf(u,m){return m(u)}var Zg=Ba(function(u){var m=u.length,T=m?u[0]:0,A=this.__wrapped__,$=function(Y){return te(Y,u)};return m>1||this.__actions__.length||!(A instanceof ln)||!Na(T)?this.thru($):(A=A.slice(T,+T+(m?1:0)),A.__actions__.push({func:nf,args:[$],thisArg:o}),new ps(A,this.__chain__).thru(function(Y){return m&&!Y.length&&Y.push(o),Y}))});function Gg(){return tf(this)}function Uh(){return new ps(this.value(),this.__chain__)}function ta(){this.__values__===o&&(this.__values__=j(this.value()));var u=this.__index__>=this.__values__.length,m=u?o:this.__values__[this.__index__++];return{done:u,value:m}}function Al(){return this}function Wg(u){for(var m,T=this;T instanceof xl;){var A=Sg(T);A.__index__=0,A.__values__=o,m?$.__wrapped__=A:m=A;var $=A;T=T.__wrapped__}return $.__wrapped__=u,m}function Up(){var u=this.__wrapped__;if(u instanceof ln){var m=u;return this.__actions__.length&&(m=new ln(this)),m=m.reverse(),m.__actions__.push({func:nf,args:[Lp],thisArg:o}),new ps(m,this.__chain__)}return this.thru(Lp)}function Vy(){return ig(this.__wrapped__,this.__actions__)}var qy=Hd(function(u,m,T){jn.call(u,T)?++u[T]:me(u,T,1)});function rf(u,m,T){var A=en(u)?Cd:at;return T&&Fr(u,m,T)&&(m=o),A(u,Vt(m,3))}function jp(u,m){var T=en(u)?mo:dt;return T(u,Vt(m,3))}var Zy=Ss(Pg),$p=Ss(Ag);function Vp(u,m){return nt(af(u,m),1)}function vc(u,m){return nt(af(u,m),zt)}function Hg(u,m,T){return T=T===o?1:Z(T),nt(af(u,m),T)}function qp(u,m){var T=en(u)?Yr:pt;return T(u,Vt(m,3))}function sf(u,m){var T=en(u)?Ed:ot;return T(u,Vt(m,3))}var Xg=Hd(function(u,m,T){jn.call(u,T)?u[T].push(m):me(u,T,[m])});function of(u,m,T,A){u=Vr(u)?u:ks(u),T=T&&!A?Z(T):0;var $=u.length;return T<0&&(T=_r($+T,0)),v(u)?T<=$&&u.indexOf(m,T)>-1:!!$&&Zo(u,m,T)>-1}var Kg=_n(function(u,m,T){var A=-1,$=typeof m=="function",Y=Vr(u)?Oe(u.length):[];return pt(u,function(fe){Y[++A]=$?Fi(m,fe,T):Yo(fe,m,T)}),Y}),Gy=Hd(function(u,m,T){me(u,T,m)});function af(u,m){var T=en(u)?ir:Sh;return T(u,Vt(m,3))}function Yg(u,m,T,A){return u==null?[]:(en(m)||(m=m==null?[]:[m]),T=A?o:T,en(T)||(T=T==null?[]:[T]),Sl(u,m,T))}var Wy=Hd(function(u,m,T){u[T?0:1].push(m)},function(){return[[],[]]});function Hy(u,m,T){var A=en(u)?ah:Xu,$=arguments.length<3;return A(u,Vt(m,4),T,$,pt)}function Xy(u,m,T){var A=en(u)?Id:Xu,$=arguments.length<3;return A(u,Vt(m,4),T,$,ot)}function Ky(u,m){var T=en(u)?mo:dt;return T(u,qh(Vt(m,3)))}function Zp(u){var m=en(u)?z:Ch;return m(u)}function Ml(u,m,T){(T?Fr(u,m,T):m===o)?m=1:m=Z(m);var A=en(u)?L:uc;return A(u,m)}function Jg(u){var m=en(u)?O:rg;return m(u)}function Qg(u){if(u==null)return 0;if(Vr(u))return v(u)?xa(u):u.length;var m=yi(u);return m==sn||m==Tr?u.size:So(u).length}function e_(u,m,T){var A=en(u)?Wu:ay;return T&&Fr(u,m,T)&&(m=o),A(u,Vt(m,3))}var t_=_n(function(u,m){if(u==null)return[];var T=m.length;return T>1&&Fr(u,m[0],m[1])?m=[]:T>2&&Fr(m[0],m[1],m[2])&&(m=[m[0]]),Sl(u,nt(m,1),[])}),jh=gh||function(){return pr.Date.now()};function Gp(u,m){if(typeof m!="function")throw new Ci(w);return u=Z(u),function(){if(--u<1)return m.apply(this,arguments)}}function xc(u,m,T){return m=T?o:m,m=u&&m==null?u.length:m,Fa(u,ve,o,o,o,o,m)}function Wp(u,m){var T;if(typeof m!="function")throw new Ci(w);return u=Z(u),function(){return--u>0&&(T=m.apply(this,arguments)),u<=1&&(m=o),T}}var $h=_n(function(u,m,T){var A=Be;if(T.length){var $=Ki(T,fu($h));A|=Ze}return Fa(u,A,m,T,$)}),Hp=_n(function(u,m,T){var A=Be|se;if(T.length){var $=Ki(T,fu(Hp));A|=Ze}return Fa(m,A,u,T,$)});function Ts(u,m,T){m=T?o:m;var A=Fa(u,he,o,o,o,o,o,m);return A.placeholder=Ts.placeholder,A}function wc(u,m,T){m=T?o:m;var A=Fa(u,De,o,o,o,o,o,m);return A.placeholder=wc.placeholder,A}function Xp(u,m,T){var A,$,Y,fe,we,Ae,We=0,He=!1,tt=!1,bt=!0;if(typeof u!="function")throw new Ci(w);m=oe(m)||0,br(T)&&(He=!!T.leading,tt="maxWait"in T,Y=tt?_r(oe(T.maxWait)||0,m):Y,bt="trailing"in T?!!T.trailing:bt);function Nt(ui){var $a=A,bu=$;return A=$=o,We=ui,fe=u.apply(bu,$a),fe}function tn(ui){return We=ui,we=fc(Ln,m),He?Nt(ui):fe}function En(ui){var $a=ui-Ae,bu=ui-We,Mw=m-$a;return tt?ri(Mw,Y-bu):Mw}function nn(ui){var $a=ui-Ae,bu=ui-We;return Ae===o||$a>=m||$a<0||tt&&bu>=Y}function Ln(){var ui=jh();if(nn(ui))return Vn(ui);we=fc(Ln,En(ui))}function Vn(ui){return we=o,bt&&A?Nt(ui):(A=$=o,fe)}function ko(){we!==o&&ou(we),We=0,A=Ae=$=we=o}function qs(){return we===o?fe:Vn(jh())}function Po(){var ui=jh(),$a=nn(ui);if(A=arguments,$=this,Ae=ui,$a){if(we===o)return tn(Ae);if(tt)return ou(we),we=fc(Ln,m),Nt(Ae)}return we===o&&(we=fc(Ln,m)),fe}return Po.cancel=ko,Po.flush=qs,Po}var n_=_n(function(u,m){return et(u,1,m)}),r_=_n(function(u,m,T){return et(u,oe(m)||0,T)});function i_(u){return Fa(u,de)}function Vh(u,m){if(typeof u!="function"||m!=null&&typeof m!="function")throw new Ci(w);var T=function(){var A=arguments,$=m?m.apply(this,A):A[0],Y=T.cache;if(Y.has($))return Y.get($);var fe=u.apply(this,A);return T.cache=Y.set($,fe)||Y,fe};return T.cache=new(Vh.Cache||Qr),T}Vh.Cache=Qr;function qh(u){if(typeof u!="function")throw new Ci(w);return function(){var m=arguments;switch(m.length){case 0:return!u.call(this);case 1:return!u.call(this,m[0]);case 2:return!u.call(this,m[0],m[1]);case 3:return!u.call(this,m[0],m[1],m[2])}return!u.apply(this,m)}}function Yy(u){return Wp(2,u)}var s_=og(function(u,m){m=m.length==1&&en(m[0])?ir(m[0],pn(Vt())):ir(nt(m,1),pn(Vt()));var T=m.length;return _n(function(A){for(var $=-1,Y=ri(A.length,T);++$<Y;)A[$]=m[$].call(this,A[$]);return Fi(u,this,A)})}),na=_n(function(u,m){var T=Ki(m,fu(na));return Fa(u,Ze,o,m,T)}),Kp=_n(function(u,m){var T=Ki(m,fu(Kp));return Fa(u,je,o,m,T)}),o_=Ba(function(u,m){return Fa(u,ee,o,o,o,m)});function a_(u,m){if(typeof u!="function")throw new Ci(w);return m=m===o?m:Z(m),_n(u,m)}function l_(u,m){if(typeof u!="function")throw new Ci(w);return m=m==null?0:_r(Z(m),0),_n(function(T){var A=T[m],$=La(T,0,m);return A&&qo($,A),Fi(u,this,$)})}function Jy(u,m,T){var A=!0,$=!0;if(typeof u!="function")throw new Ci(w);return br(T)&&(A="leading"in T?!!T.leading:A,$="trailing"in T?!!T.trailing:$),Xp(u,m,{leading:A,maxWait:m,trailing:$})}function Qy(u){return xc(u,1)}function u_(u,m){return na(pp(m),u)}function bc(){if(!arguments.length)return[];var u=arguments[0];return en(u)?u:[u]}function c_(u){return be(u,Ee)}function lf(u,m){return m=typeof m=="function"?m:o,be(u,Ee,m)}function h_(u){return be(u,W|Ee)}function uf(u,m){return m=typeof m=="function"?m:o,be(u,W|Ee,m)}function cf(u,m){return m==null||qe(u,m,yn(m))}function Es(u,m){return u===m||u!==u&&m!==m}var e1=zh(pi),t1=zh(function(u,m){return u>=m}),yu=za(function(){return arguments}())?za:function(u){return zr(u)&&jn.call(u,"callee")&&!Ta.call(u,"callee")},en=Oe.isArray,vi=nh?pn(nh):_s;function Vr(u){return u!=null&&zl(u.length)&&!To(u)}function Mr(u){return zr(u)&&Vr(u)}function d_(u){return u===!0||u===!1||zr(u)&&hn(u)==Zt}var ja=_h||b1,Yp=Sd?pn(Sd):ac;function n1(u){return zr(u)&&u.nodeType===1&&!n(u)}function f_(u){if(u==null)return!0;if(Vr(u)&&(en(u)||typeof u=="string"||typeof u.splice=="function"||ja(u)||S(u)||yu(u)))return!u.length;var m=yi(u);if(m==sn||m==Tr)return!u.size;if(Rh(u))return!So(u).length;for(var T in u)if(jn.call(u,T))return!1;return!0}function p_(u,m){return Da(u,m)}function r1(u,m,T){T=typeof T=="function"?T:o;var A=T?T(u,m):o;return A===o?Da(u,m,o,T):!!A}function hf(u){if(!zr(u))return!1;var m=hn(u);return m==Qt||m==Zn||typeof u.message=="string"&&typeof u.name=="string"&&!n(u)}function Jp(u){return typeof u=="number"&&Qu(u)}function To(u){if(!br(u))return!1;var m=hn(u);return m==wn||m==er||m==Nn||m==Ot}function Qp(u){return typeof u=="number"&&u==Z(u)}function zl(u){return typeof u=="number"&&u>-1&&u%1==0&&u<=Je}function br(u){var m=typeof u;return u!=null&&(m=="object"||m=="function")}function zr(u){return u!=null&&typeof u=="object"}var df=rh?pn(rh):vs;function ff(u,m){return u===m||to(u,m,mu(m))}function Zh(u,m,T){return T=typeof T=="function"?T:o,to(u,m,mu(m),T)}function em(u){return i(u)&&u!=+u}function tm(u){if(_y(u))throw new Wt(b);return xs(u)}function nm(u){return u===null}function i1(u){return u==null}function i(u){return typeof u=="number"||zr(u)&&hn(u)==dn}function n(u){if(!zr(u)||hn(u)!=Fn)return!1;var m=gl(u);if(m===null)return!0;var T=jn.call(m,"constructor")&&m.constructor;return typeof T=="function"&&T instanceof T&&ba.call(T)==Sa}var s=Gu?pn(Gu):si;function l(u){return Qp(u)&&u>=-Je&&u<=Je}var p=ih?pn(ih):gi;function v(u){return typeof u=="string"||!en(u)&&zr(u)&&hn(u)==yr}function x(u){return typeof u=="symbol"||zr(u)&&hn(u)==Hr}var S=sh?pn(sh):Qi;function C(u){return u===o}function P(u){return zr(u)&&yi(u)==rr}function M(u){return zr(u)&&hn(u)==dr}var R=zh(Jo),F=zh(function(u,m){return u<=m});function j(u){if(!u)return[];if(Vr(u))return v(u)?Yi(u):es(u);if(Xo&&u[Xo])return ya(u[Xo]());var m=yi(u),T=m==sn?va:m==Tr?Wo:ks;return T(u)}function G(u){if(!u)return u===0?u:0;if(u=oe(u),u===zt||u===-zt){var m=u<0?-1:1;return m*rt}return u===u?u:0}function Z(u){var m=G(u),T=m%1;return m===m?T?m-T:m:0}function ne(u){return u?xe(Z(u),0,ht):0}function oe(u){if(typeof u=="number")return u;if(x(u))return Et;if(br(u)){var m=typeof u.valueOf=="function"?u.valueOf():u;u=br(m)?m+"":m}if(typeof u!="string")return u===0?u:+u;u=Hl(u);var T=on.test(u);return T||ur.test(u)?ap(u.slice(2),T?2:8):xr.test(u)?Et:+u}function Pe(u){return bs(u,$n(u))}function ge(u){return u?xe(Z(u),-Je,Je):u===0?u:0}function _e(u){return u==null?"":oi(u)}var Le=uu(function(u,m){if(Rh(m)||Vr(m)){bs(m,yn(m),u);return}for(var T in m)jn.call(m,T)&&X(u,T,m[T])}),Ye=uu(function(u,m){bs(m,$n(m),u)}),gt=uu(function(u,m,T,A){bs(m,$n(m),u,A)}),Ft=uu(function(u,m,T,A){bs(m,yn(m),u,A)}),_t=Ba(te);function ft(u,m){var T=vl(u);return m==null?T:le(T,m)}var Pt=_n(function(u,m){u=Hn(u);var T=-1,A=m.length,$=A>2?m[2]:o;for($&&Fr(m[0],m[1],$)&&(A=1);++T<A;)for(var Y=m[T],fe=$n(Y),we=-1,Ae=fe.length;++we<Ae;){var We=fe[we],He=u[We];(He===o||Es(He,fl[We])&&!jn.call(u,We))&&(u[We]=Y[We])}return u}),xt=_n(function(u){return u.push(o,pg),Fi(ai,o,u)});function yt(u,m){return Zl(u,Vt(m,3),$t)}function $e(u,m){return Zl(u,Vt(m,3),un)}function At(u,m){return u==null?u:jt(u,Vt(m,3),$n)}function kt(u,m){return u==null?u:sr(u,Vt(m,3),$n)}function qt(u,m){return u&&$t(u,Vt(m,3))}function tr(u,m){return u&&un(u,Vt(m,3))}function Yn(u){return u==null?[]:Xn(u,yn(u))}function ei(u){return u==null?[]:Xn(u,$n(u))}function Cs(u,m,T){var A=u==null?o:Cr(u,m);return A===o?T:A}function xi(u,m){return u!=null&&Ep(u,m,Ii)}function Nr(u,m){return u!=null&&Ep(u,m,mi)}var Ui=cg(function(u,m,T){m!=null&&typeof m.toString!="function"&&(m=$r.call(m)),u[m]=T},_1(io)),ji=cg(function(u,m,T){m!=null&&typeof m.toString!="function"&&(m=$r.call(m)),jn.call(u,m)?u[m].push(T):u[m]=[T]},Vt),$i=_n(Yo);function yn(u){return Vr(u)?k(u):So(u)}function $n(u){return Vr(u)?k(u,!0):bl(u)}function Pi(u,m){var T={};return m=Vt(m,3),$t(u,function(A,$,Y){me(T,m(A,$,Y),A)}),T}function wi(u,m){var T={};return m=Vt(m,3),$t(u,function(A,$,Y){me(T,$,m(A,$,Y))}),T}var Vi=uu(function(u,m,T){Bs(u,m,T)}),ai=uu(function(u,m,T,A){Bs(u,m,T,A)}),js=Ba(function(u,m){var T={};if(u==null)return T;var A=!1;m=ir(m,function(Y){return Y=Qo(Y,u),A||(A=Y.length>1),Y}),bs(u,bp(u),T),A&&(T=be(T,W|q|Ee,hy));for(var $=m.length;$--;)cc(T,m[$]);return T});function ns(u,m){return nr(u,qh(Vt(m)))}var zn=Ba(function(u,m){return u==null?{}:lc(u,m)});function nr(u,m){if(u==null)return{};var T=ir(bp(u),function(A){return[A]});return m=Vt(m),su(u,T,function(A,$){return m(A,$[0])})}function lr(u,m,T){m=Qo(m,u);var A=-1,$=m.length;for($||($=1,u=o);++A<$;){var Y=u==null?o:u[ea(m[A])];Y===o&&(A=$,Y=T),u=To(Y)?Y.call(u):Y}return u}function Is(u,m,T){return u==null?u:Ns(u,m,T)}function Sr(u,m,T,A){return A=typeof A=="function"?A:o,u==null?u:Ns(u,m,T,A)}var vu=dg(yn),Eo=dg($n);function ra(u,m,T){var A=en(u),$=A||ja(u)||S(u);if(m=Vt(m,4),T==null){var Y=u&&u.constructor;$?T=A?new Y:[]:br(u)?T=To(Y)?vl(gl(u)):{}:T={}}return($?Yr:$t)(u,function(fe,we,Ae){return m(T,fe,we,Ae)}),T}function ro(u,m){return u==null?!0:cc(u,m)}function $s(u,m,T){return u==null?u:$d(u,m,pp(T))}function li(u,m,T,A){return A=typeof A=="function"?A:o,u==null?u:$d(u,m,pp(T),A)}function ks(u){return u==null?[]:Un(u,yn(u))}function Gh(u){return u==null?[]:Un(u,$n(u))}function m_(u,m,T){return T===o&&(T=m,m=o),T!==o&&(T=oe(T),T=T===T?T:0),m!==o&&(m=oe(m),m=m===m?m:0),xe(oe(u),m,T)}function g_(u,m,T){return m=G(m),T===o?(T=m,m=0):T=G(T),u=oe(u),ki(u,m,T)}function rm(u,m,T){if(T&&typeof T!="boolean"&&Fr(u,m,T)&&(m=T=o),T===o&&(typeof m=="boolean"?(T=m,m=o):typeof u=="boolean"&&(T=u,u=o)),u===o&&m===o?(u=0,m=1):(u=G(u),m===o?(m=u,u=0):m=G(m)),u>m){var A=u;u=m,m=A}if(T||u%1||m%1){var $=tc();return ri(u+$*(m-u+Js("1e-"+(($+"").length-1))),m)}return Ud(u,m)}var im=cu(function(u,m,T){return m=m.toLowerCase(),u+(T?ia(m):m)});function ia(u){return g1(_e(u).toLowerCase())}function sm(u){return u=_e(u),u&&u.replace(ni,_a).replace(vd,"")}function __(u,m,T){u=_e(u),m=oi(m);var A=u.length;T=T===o?A:xe(Z(T),0,A);var $=T;return T-=m.length,T>=0&&u.slice(T,$)==m}function s1(u){return u=_e(u),u&&N.test(u)?u.replace(Rs,ll):u}function o1(u){return u=_e(u),u&&Fe.test(u)?u.replace(pe,"\\$&"):u}var a1=cu(function(u,m,T){return u+(T?"-":"")+m.toLowerCase()}),l1=cu(function(u,m,T){return u+(T?" ":"")+m.toLowerCase()}),u1=Xd("toLowerCase");function c1(u,m,T){u=_e(u),m=Z(m);var A=m?xa(u):0;if(!m||A>=m)return u;var $=(m-A)/2;return Kd(Ko($),T)+u+Kd(Ia($),T)}function h1(u,m,T){u=_e(u),m=Z(m);var A=m?xa(u):0;return m&&A<m?u+Kd(m-A,T):u}function d1(u,m,T){u=_e(u),m=Z(m);var A=m?xa(u):0;return m&&A<m?Kd(m-A,T)+u:u}function Co(u,m,T){return T||m==null?m=0:m&&(m=+m),eo(_e(u).replace(Ge,""),m||0)}function pf(u,m,T){return(T?Fr(u,m,T):m===o)?m=1:m=Z(m),dp(_e(u),m)}function y_(){var u=arguments,m=_e(u[0]);return u.length<3?m:m.replace(u[1],u[2])}var f1=cu(function(u,m,T){return u+(T?"_":"")+m.toLowerCase()});function p1(u,m,T){return T&&typeof T!="number"&&Fr(u,m,T)&&(m=T=o),T=T===o?ht:T>>>0,T?(u=_e(u),u&&(typeof m=="string"||m!=null&&!s(m))&&(m=oi(m),!m&&Go(u))?La(Yi(u),0,T):u.split(m,T)):[]}var m1=cu(function(u,m,T){return u+(T?" ":"")+g1(m)});function Ai(u,m,T){return u=_e(u),T=T==null?0:xe(Z(T),0,u.length),m=oi(m),u.slice(T,T+m.length)==m}function Vs(u,m,T){var A=H.templateSettings;T&&Fr(u,m,T)&&(m=o),u=_e(u),m=gt({},m,A,fg);var $=gt({},m.imports,A.imports,fg),Y=yn($),fe=Un($,Y),we,Ae,We=0,He=m.interpolate||Kr,tt="__p += '",bt=Ho((m.escape||Kr).source+"|"+He.source+"|"+(He===re?fn:Kr).source+"|"+(m.evaluate||Kr).source+"|$","g"),Nt="//# sourceURL="+(jn.call(m,"sourceURL")?(m.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++op+"]")+`
`;u.replace(bt,function(nn,Ln,Vn,ko,qs,Po){return Vn||(Vn=ko),tt+=u.slice(We,Po).replace(el,hs),Ln&&(we=!0,tt+=`' +
__e(`+Ln+`) +
'`),qs&&(Ae=!0,tt+=`';
`+qs+`;
__p += '`),Vn&&(tt+=`' +
((__t = (`+Vn+`)) == null ? '' : __t) +
'`),We=Po+nn.length,nn}),tt+=`';
`;var tn=jn.call(m,"variable")&&m.variable;if(!tn)tt=`with (obj) {
`+tt+`
}
`;else if(Jt.test(tn))throw new Wt(c);tt=(Ae?tt.replace(Xt,""):tt).replace(Ys,"$1").replace(co,"$1;"),tt="function("+(tn||"obj")+`) {
`+(tn?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(we?", __e = _.escape":"")+(Ae?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+tt+`return __p
}`;var En=Pw(function(){return Tn(Y,Nt+"return "+tt).apply(o,fe)});if(En.source=tt,hf(En))throw En;return En}function xu(u){return _e(u).toLowerCase()}function Io(u){return _e(u).toUpperCase()}function wu(u,m,T){if(u=_e(u),u&&(T||m===o))return Hl(u);if(!u||!(m=oi(m)))return u;var A=Yi(u),$=Yi(m),Y=ol(A,$),fe=al(A,$)+1;return La(A,Y,fe).join("")}function sa(u,m,T){if(u=_e(u),u&&(T||m===o))return u.slice(0,An(u)+1);if(!u||!(m=oi(m)))return u;var A=Yi(u),$=al(A,Yi(m))+1;return La(A,0,$).join("")}function rS(u,m,T){if(u=_e(u),u&&(T||m===o))return u.replace(Ge,"");if(!u||!(m=oi(m)))return u;var A=Yi(u),$=ol(A,Yi(m));return La(A,$).join("")}function iS(u,m){var T=Te,A=Ue;if(br(m)){var $="separator"in m?m.separator:$;T="length"in m?Z(m.length):T,A="omission"in m?oi(m.omission):A}u=_e(u);var Y=u.length;if(Go(u)){var fe=Yi(u);Y=fe.length}if(T>=Y)return u;var we=T-xa(A);if(we<1)return A;var Ae=fe?La(fe,0,we).join(""):u.slice(0,we);if($===o)return Ae+A;if(fe&&(we+=Ae.length-we),s($)){if(u.slice(we).search($)){var We,He=Ae;for($.global||($=Ho($.source,_e(Ar.exec($))+"g")),$.lastIndex=0;We=$.exec(He);)var tt=We.index;Ae=Ae.slice(0,tt===o?we:tt)}}else if(u.indexOf(oi($),we)!=we){var bt=Ae.lastIndexOf($);bt>-1&&(Ae=Ae.slice(0,bt))}return Ae+A}function sS(u){return u=_e(u),u&&ae.test(u)?u.replace(ho,Yu):u}var oS=cu(function(u,m,T){return u+(T?" ":"")+m.toUpperCase()}),g1=Xd("toUpperCase");function kw(u,m,T){return u=_e(u),m=T?o:m,m===o?fh(u)?dl(u):Pd(u):u.match(m)||[]}var Pw=_n(function(u,m){try{return Fi(u,o,m)}catch(T){return hf(T)?T:new Wt(T)}}),aS=Ba(function(u,m){return Yr(m,function(T){T=ea(T),me(u,T,$h(u[T],u))}),u});function lS(u){var m=u==null?0:u.length,T=Vt();return u=m?ir(u,function(A){if(typeof A[1]!="function")throw new Ci(w);return[T(A[0]),A[1]]}):[],_n(function(A){for(var $=-1;++$<m;){var Y=u[$];if(Fi(Y[0],this,A))return Fi(Y[1],this,A)}})}function uS(u){return Me(be(u,W))}function _1(u){return function(){return u}}function cS(u,m){return u==null||u!==u?m:u}var hS=yp(),dS=yp(!0);function io(u){return u}function y1(u){return gn(typeof u=="function"?u:be(u,W))}function fS(u){return Bd(be(u,W))}function pS(u,m){return Th(u,be(m,W))}var mS=_n(function(u,m){return function(T){return Yo(T,u,m)}}),gS=_n(function(u,m){return function(T){return Yo(u,T,m)}});function v1(u,m,T){var A=yn(m),$=Xn(m,A);T==null&&!(br(m)&&($.length||!A.length))&&(T=m,m=u,u=this,$=Xn(m,yn(m)));var Y=!(br(T)&&"chain"in T)||!!T.chain,fe=To(u);return Yr($,function(we){var Ae=m[we];u[we]=Ae,fe&&(u.prototype[we]=function(){var We=this.__chain__;if(Y||We){var He=u(this.__wrapped__),tt=He.__actions__=es(this.__actions__);return tt.push({func:Ae,args:arguments,thisArg:u}),He.__chain__=We,He}return Ae.apply(u,qo([this.value()],arguments))})}),u}function _S(){return pr._===this&&(pr._=zd),this}function x1(){}function yS(u){return u=Z(u),_n(function(m){return iu(m,u)})}var vS=vp(ir),xS=vp(Cd),wS=vp(Wu);function Aw(u){return Cp(u)?Wl(ea(u)):Tl(u)}function bS(u){return function(m){return u==null?o:Cr(u,m)}}var SS=hg(),TS=hg(!0);function w1(){return[]}function b1(){return!1}function ES(){return{}}function CS(){return""}function IS(){return!0}function kS(u,m){if(u=Z(u),u<1||u>Je)return[];var T=ht,A=ri(u,ht);m=Vt(m),u-=ht;for(var $=ch(A,m);++T<u;)m(T);return $}function PS(u){return en(u)?ir(u,ea):x(u)?[u]:es(bg(_e(u)))}function AS(u){var m=++Yl;return _e(u)+m}var MS=Mh(function(u,m){return u+m},0),zS=Oa("ceil"),DS=Mh(function(u,m){return u/m},1),RS=Oa("floor");function LS(u){return u&&u.length?wt(u,io,pi):o}function OS(u,m){return u&&u.length?wt(u,Vt(m,2),pi):o}function FS(u){return Gl(u,io)}function BS(u,m){return Gl(u,Vt(m,2))}function NS(u){return u&&u.length?wt(u,io,Jo):o}function US(u,m){return u&&u.length?wt(u,Vt(m,2),Jo):o}var jS=Mh(function(u,m){return u*m},1),$S=Oa("round"),VS=Mh(function(u,m){return u-m},0);function qS(u){return u&&u.length?mr(u,io):0}function ZS(u,m){return u&&u.length?mr(u,Vt(m,2)):0}return H.after=Gp,H.ary=xc,H.assign=Le,H.assignIn=Ye,H.assignInWith=gt,H.assignWith=Ft,H.at=_t,H.before=Wp,H.bind=$h,H.bindAll=aS,H.bindKey=Hp,H.castArray=bc,H.chain=tf,H.chunk=Sy,H.compact=Tg,H.concat=zp,H.cond=lS,H.conforms=uS,H.constant=_1,H.countBy=qy,H.create=ft,H.curry=Ts,H.curryRight=wc,H.debounce=Xp,H.defaults=Pt,H.defaultsDeep=xt,H.defer=n_,H.delay=r_,H.difference=Eg,H.differenceBy=Cg,H.differenceWith=Ig,H.drop=Ty,H.dropRight=Qd,H.dropRightWhile=Ey,H.dropWhile=kg,H.fill=Cy,H.filter=jp,H.flatMap=Vp,H.flatMapDeep=vc,H.flatMapDepth=Hg,H.flatten=Dp,H.flattenDeep=Iy,H.flattenDepth=ky,H.flip=i_,H.flow=hS,H.flowRight=dS,H.fromPairs=Oh,H.functions=Yn,H.functionsIn=ei,H.groupBy=Xg,H.initial=zg,H.intersection=Dg,H.intersectionBy=Kn,H.intersectionWith=Rp,H.invert=Ui,H.invertBy=ji,H.invokeMap=Kg,H.iteratee=y1,H.keyBy=Gy,H.keys=yn,H.keysIn=$n,H.map=af,H.mapKeys=Pi,H.mapValues=wi,H.matches=fS,H.matchesProperty=pS,H.memoize=Vh,H.merge=Vi,H.mergeWith=ai,H.method=mS,H.methodOf=gS,H.mixin=v1,H.negate=qh,H.nthArg=yS,H.omit=js,H.omitBy=ns,H.once=Yy,H.orderBy=Yg,H.over=vS,H.overArgs=s_,H.overEvery=xS,H.overSome=wS,H.partial=na,H.partialRight=Kp,H.partition=Wy,H.pick=zn,H.pickBy=nr,H.property=Aw,H.propertyOf=bS,H.pull=Lg,H.pullAll=Og,H.pullAllBy=Py,H.pullAllWith=Ay,H.pullAt=My,H.range=SS,H.rangeRight=TS,H.rearg=o_,H.reject=Ky,H.remove=zy,H.rest=a_,H.reverse=Lp,H.sampleSize=Ml,H.set=Is,H.setWith=Sr,H.shuffle=Jg,H.slice=Dy,H.sortBy=t_,H.sortedUniq=Fp,H.sortedUniqBy=Oy,H.split=p1,H.spread=l_,H.tail=Fy,H.take=By,H.takeRight=Bg,H.takeRightWhile=Ng,H.takeWhile=ts,H.tap=$y,H.throttle=Jy,H.thru=nf,H.toArray=j,H.toPairs=vu,H.toPairsIn=Eo,H.toPath=PS,H.toPlainObject=Pe,H.transform=ra,H.unary=Qy,H.union=Bp,H.unionBy=Ug,H.unionWith=Pl,H.uniq=Fh,H.uniqBy=Bh,H.uniqWith=_c,H.unset=ro,H.unzip=yc,H.unzipWith=Nh,H.update=$s,H.updateWith=li,H.values=ks,H.valuesIn=Gh,H.without=Ny,H.words=kw,H.wrap=u_,H.xor=Uy,H.xorBy=jg,H.xorWith=$g,H.zip=jy,H.zipObject=Vg,H.zipObjectDeep=qg,H.zipWith=Np,H.entries=vu,H.entriesIn=Eo,H.extend=Ye,H.extendWith=gt,v1(H,H),H.add=MS,H.attempt=Pw,H.camelCase=im,H.capitalize=ia,H.ceil=zS,H.clamp=m_,H.clone=c_,H.cloneDeep=h_,H.cloneDeepWith=uf,H.cloneWith=lf,H.conformsTo=cf,H.deburr=sm,H.defaultTo=cS,H.divide=DS,H.endsWith=__,H.eq=Es,H.escape=s1,H.escapeRegExp=o1,H.every=rf,H.find=Zy,H.findIndex=Pg,H.findKey=yt,H.findLast=$p,H.findLastIndex=Ag,H.findLastKey=$e,H.floor=RS,H.forEach=qp,H.forEachRight=sf,H.forIn=At,H.forInRight=kt,H.forOwn=qt,H.forOwnRight=tr,H.get=Cs,H.gt=e1,H.gte=t1,H.has=xi,H.hasIn=Nr,H.head=Br,H.identity=io,H.includes=of,H.indexOf=Mg,H.inRange=g_,H.invoke=$i,H.isArguments=yu,H.isArray=en,H.isArrayBuffer=vi,H.isArrayLike=Vr,H.isArrayLikeObject=Mr,H.isBoolean=d_,H.isBuffer=ja,H.isDate=Yp,H.isElement=n1,H.isEmpty=f_,H.isEqual=p_,H.isEqualWith=r1,H.isError=hf,H.isFinite=Jp,H.isFunction=To,H.isInteger=Qp,H.isLength=zl,H.isMap=df,H.isMatch=ff,H.isMatchWith=Zh,H.isNaN=em,H.isNative=tm,H.isNil=i1,H.isNull=nm,H.isNumber=i,H.isObject=br,H.isObjectLike=zr,H.isPlainObject=n,H.isRegExp=s,H.isSafeInteger=l,H.isSet=p,H.isString=v,H.isSymbol=x,H.isTypedArray=S,H.isUndefined=C,H.isWeakMap=P,H.isWeakSet=M,H.join=Rg,H.kebabCase=a1,H.last=Us,H.lastIndexOf=Ua,H.lowerCase=l1,H.lowerFirst=u1,H.lt=R,H.lte=F,H.max=LS,H.maxBy=OS,H.mean=FS,H.meanBy=BS,H.min=NS,H.minBy=US,H.stubArray=w1,H.stubFalse=b1,H.stubObject=ES,H.stubString=CS,H.stubTrue=IS,H.multiply=jS,H.nth=mc,H.noConflict=_S,H.noop=x1,H.now=jh,H.pad=c1,H.padEnd=h1,H.padStart=d1,H.parseInt=Co,H.random=rm,H.reduce=Hy,H.reduceRight=Xy,H.repeat=pf,H.replace=y_,H.result=lr,H.round=$S,H.runInContext=Ie,H.sample=Zp,H.size=Qg,H.snakeCase=f1,H.some=e_,H.sortedIndex=Ry,H.sortedIndexBy=Ly,H.sortedIndexOf=ef,H.sortedLastIndex=gc,H.sortedLastIndexBy=Fg,H.sortedLastIndexOf=Op,H.startCase=m1,H.startsWith=Ai,H.subtract=VS,H.sum=qS,H.sumBy=ZS,H.template=Vs,H.times=kS,H.toFinite=G,H.toInteger=Z,H.toLength=ne,H.toLower=xu,H.toNumber=oe,H.toSafeInteger=ge,H.toString=_e,H.toUpper=Io,H.trim=wu,H.trimEnd=sa,H.trimStart=rS,H.truncate=iS,H.unescape=sS,H.uniqueId=AS,H.upperCase=oS,H.upperFirst=g1,H.each=qp,H.eachRight=sf,H.first=Br,v1(H,function(){var u={};return $t(H,function(m,T){jn.call(H.prototype,T)||(u[T]=m)}),u}(),{chain:!1}),H.VERSION=h,Yr(["bind","bindKey","curry","curryRight","partial","partialRight"],function(u){H[u].placeholder=H}),Yr(["drop","take"],function(u,m){ln.prototype[u]=function(T){T=T===o?1:_r(Z(T),0);var A=this.__filtered__&&!m?new ln(this):this.clone();return A.__filtered__?A.__takeCount__=ri(T,A.__takeCount__):A.__views__.push({size:ri(T,ht),type:u+(A.__dir__<0?"Right":"")}),A},ln.prototype[u+"Right"]=function(T){return this.reverse()[u](T).reverse()}}),Yr(["filter","map","takeWhile"],function(u,m){var T=m+1,A=T==Kt||T==Qn;ln.prototype[u]=function($){var Y=this.clone();return Y.__iteratees__.push({iteratee:Vt($,3),type:T}),Y.__filtered__=Y.__filtered__||A,Y}}),Yr(["head","last"],function(u,m){var T="take"+(m?"Right":"");ln.prototype[u]=function(){return this[T](1).value()[0]}}),Yr(["initial","tail"],function(u,m){var T="drop"+(m?"":"Right");ln.prototype[u]=function(){return this.__filtered__?new ln(this):this[T](1)}}),ln.prototype.compact=function(){return this.filter(io)},ln.prototype.find=function(u){return this.filter(u).head()},ln.prototype.findLast=function(u){return this.reverse().find(u)},ln.prototype.invokeMap=_n(function(u,m){return typeof u=="function"?new ln(this):this.map(function(T){return Yo(T,u,m)})}),ln.prototype.reject=function(u){return this.filter(qh(Vt(u)))},ln.prototype.slice=function(u,m){u=Z(u);var T=this;return T.__filtered__&&(u>0||m<0)?new ln(T):(u<0?T=T.takeRight(-u):u&&(T=T.drop(u)),m!==o&&(m=Z(m),T=m<0?T.dropRight(-m):T.take(m-u)),T)},ln.prototype.takeRightWhile=function(u){return this.reverse().takeWhile(u).reverse()},ln.prototype.toArray=function(){return this.take(ht)},$t(ln.prototype,function(u,m){var T=/^(?:filter|find|map|reject)|While$/.test(m),A=/^(?:head|last)$/.test(m),$=H[A?"take"+(m=="last"?"Right":""):m],Y=A||/^find/.test(m);$&&(H.prototype[m]=function(){var fe=this.__wrapped__,we=A?[1]:arguments,Ae=fe instanceof ln,We=we[0],He=Ae||en(fe),tt=function(Ln){var Vn=$.apply(H,qo([Ln],we));return A&&bt?Vn[0]:Vn};He&&T&&typeof We=="function"&&We.length!=1&&(Ae=He=!1);var bt=this.__chain__,Nt=!!this.__actions__.length,tn=Y&&!bt,En=Ae&&!Nt;if(!Y&&He){fe=En?fe:new ln(this);var nn=u.apply(fe,we);return nn.__actions__.push({func:nf,args:[tt],thisArg:o}),new ps(nn,bt)}return tn&&En?u.apply(this,we):(nn=this.thru(tt),tn?A?nn.value()[0]:nn.value():nn)})}),Yr(["pop","push","shift","sort","splice","unshift"],function(u){var m=wa[u],T=/^(?:push|sort|unshift)$/.test(u)?"tap":"thru",A=/^(?:pop|shift)$/.test(u);H.prototype[u]=function(){var $=arguments;if(A&&!this.__chain__){var Y=this.value();return m.apply(en(Y)?Y:[],$)}return this[T](function(fe){return m.apply(en(fe)?fe:[],$)})}}),$t(ln.prototype,function(u,m){var T=H[m];if(T){var A=T.name+"";jn.call(ii,A)||(ii[A]=[]),ii[A].push({name:m,func:T})}}),ii[hc(o,se).name]=[{name:"wrapper",func:o}],ln.prototype.clone=Ld,ln.prototype.reverse=wh,ln.prototype.value=Od,H.prototype.at=Zg,H.prototype.chain=Gg,H.prototype.commit=Uh,H.prototype.next=ta,H.prototype.plant=Wg,H.prototype.reverse=Up,H.prototype.toJSON=H.prototype.valueOf=H.prototype.value=Vy,H.prototype.first=H.prototype.head,Xo&&(H.prototype[Xo]=Al),H},_o=Md();Qs?((Qs.exports=_o)._=_o,Mn._=_o):pr._=_o}).call(Kh)})(E0,E0.exports);var tC=E0.exports;const Jf=B0(tC);var U4={exports:{}};/* @license
Papa Parse
v5.5.2
https://github.com/mholt/PapaParse
License: MIT
*/(function(e,r){((o,h)=>{e.exports=h()})(Kh,function o(){var h=typeof self<"u"?self:typeof window<"u"?window:h!==void 0?h:{},_,b=!h.document&&!!h.postMessage,w=h.IS_PAPA_WORKER||!1,c={},D=0,U={};function J(ee){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},(function(de){var Te=Ze(de);Te.chunkSize=parseInt(Te.chunkSize),de.step||de.chunk||(Te.chunkSize=null),this._handle=new Ne(Te),(this._handle.streamer=this)._config=Te}).call(this,ee),this.parseChunk=function(de,Te){var Ue=parseInt(this._config.skipFirstNLines)||0;if(this.isFirstChunk&&0<Ue){let mt=this._config.newline;mt||(Xe=this._config.quoteChar||'"',mt=this._handle.guessLineEndings(de,Xe)),de=[...de.split(mt).slice(Ue)].join(mt)}this.isFirstChunk&&ve(this._config.beforeFirstChunk)&&(Xe=this._config.beforeFirstChunk(de))!==void 0&&(de=Xe),this.isFirstChunk=!1,this._halted=!1;var Ue=this._partialLine+de,Xe=(this._partialLine="",this._handle.parse(Ue,this._baseIndex,!this._finished));if(!this._handle.paused()&&!this._handle.aborted()){if(de=Xe.meta.cursor,Ue=(this._finished||(this._partialLine=Ue.substring(de-this._baseIndex),this._baseIndex=de),Xe&&Xe.data&&(this._rowCount+=Xe.data.length),this._finished||this._config.preview&&this._rowCount>=this._config.preview),w)h.postMessage({results:Xe,workerId:U.WORKER_ID,finished:Ue});else if(ve(this._config.chunk)&&!Te){if(this._config.chunk(Xe,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);this._completeResults=Xe=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(Xe.data),this._completeResults.errors=this._completeResults.errors.concat(Xe.errors),this._completeResults.meta=Xe.meta),this._completed||!Ue||!ve(this._config.complete)||Xe&&Xe.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),Ue||Xe&&Xe.meta.paused||this._nextChunk(),Xe}this._halted=!0},this._sendError=function(de){ve(this._config.error)?this._config.error(de):w&&this._config.error&&h.postMessage({workerId:U.WORKER_ID,error:de,finished:!1})}}function W(ee){var de;(ee=ee||{}).chunkSize||(ee.chunkSize=U.RemoteChunkSize),J.call(this,ee),this._nextChunk=b?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(Te){this._input=Te,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(de=new XMLHttpRequest,this._config.withCredentials&&(de.withCredentials=this._config.withCredentials),b||(de.onload=je(this._chunkLoaded,this),de.onerror=je(this._chunkError,this)),de.open(this._config.downloadRequestBody?"POST":"GET",this._input,!b),this._config.downloadRequestHeaders){var Te,Ue=this._config.downloadRequestHeaders;for(Te in Ue)de.setRequestHeader(Te,Ue[Te])}var Xe;this._config.chunkSize&&(Xe=this._start+this._config.chunkSize-1,de.setRequestHeader("Range","bytes="+this._start+"-"+Xe));try{de.send(this._config.downloadRequestBody)}catch(mt){this._chunkError(mt.message)}b&&de.status===0&&this._chunkError()}},this._chunkLoaded=function(){de.readyState===4&&(de.status<200||400<=de.status?this._chunkError():(this._start+=this._config.chunkSize||de.responseText.length,this._finished=!this._config.chunkSize||this._start>=(Te=>(Te=Te.getResponseHeader("Content-Range"))!==null?parseInt(Te.substring(Te.lastIndexOf("/")+1)):-1)(de),this.parseChunk(de.responseText)))},this._chunkError=function(Te){Te=de.statusText||Te,this._sendError(new Error(Te))}}function q(ee){(ee=ee||{}).chunkSize||(ee.chunkSize=U.LocalChunkSize),J.call(this,ee);var de,Te,Ue=typeof FileReader<"u";this.stream=function(Xe){this._input=Xe,Te=Xe.slice||Xe.webkitSlice||Xe.mozSlice,Ue?((de=new FileReader).onload=je(this._chunkLoaded,this),de.onerror=je(this._chunkError,this)):de=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var Xe=this._input,mt=(this._config.chunkSize&&(mt=Math.min(this._start+this._config.chunkSize,this._input.size),Xe=Te.call(Xe,this._start,mt)),de.readAsText(Xe,this._config.encoding));Ue||this._chunkLoaded({target:{result:mt}})},this._chunkLoaded=function(Xe){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(Xe.target.result)},this._chunkError=function(){this._sendError(de.error)}}function Ee(ee){var de;J.call(this,ee=ee||{}),this.stream=function(Te){return de=Te,this._nextChunk()},this._nextChunk=function(){var Te,Ue;if(!this._finished)return Te=this._config.chunkSize,de=Te?(Ue=de.substring(0,Te),de.substring(Te)):(Ue=de,""),this._finished=!de,this.parseChunk(Ue)}}function ze(ee){J.call(this,ee=ee||{});var de=[],Te=!0,Ue=!1;this.pause=function(){J.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){J.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(Xe){this._input=Xe,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){Ue&&de.length===1&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),de.length?this.parseChunk(de.shift()):Te=!0},this._streamData=je(function(Xe){try{de.push(typeof Xe=="string"?Xe:Xe.toString(this._config.encoding)),Te&&(Te=!1,this._checkIsFinished(),this.parseChunk(de.shift()))}catch(mt){this._streamError(mt)}},this),this._streamError=je(function(Xe){this._streamCleanUp(),this._sendError(Xe)},this),this._streamEnd=je(function(){this._streamCleanUp(),Ue=!0,this._streamData("")},this),this._streamCleanUp=je(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function Ne(ee){var de,Te,Ue,Xe,mt=Math.pow(2,53),Kt=-mt,qn=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,Qn=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,zt=this,Je=0,rt=0,Et=!1,ht=!1,It=[],St={data:[],errors:[],meta:{}};function Sn(Zt){return ee.skipEmptyLines==="greedy"?Zt.join("").trim()==="":Zt.length===1&&Zt[0].length===0}function cn(){if(St&&Ue&&(Nn("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+U.DefaultDelimiter+"'"),Ue=!1),ee.skipEmptyLines&&(St.data=St.data.filter(function(wn){return!Sn(wn)})),Cn()){let wn=function(er,sn){ve(ee.transformHeader)&&(er=ee.transformHeader(er,sn)),It.push(er)};var Qt=wn;if(St)if(Array.isArray(St.data[0])){for(var Zt=0;Cn()&&Zt<St.data.length;Zt++)St.data[Zt].forEach(wn);St.data.splice(0,1)}else St.data.forEach(wn)}function rn(wn,er){for(var sn=ee.header?{}:[],dn=0;dn<wn.length;dn++){var Ce=dn,Fn=wn[dn],Fn=((bn,Ot)=>(Yt=>(ee.dynamicTypingFunction&&ee.dynamicTyping[Yt]===void 0&&(ee.dynamicTyping[Yt]=ee.dynamicTypingFunction(Yt)),(ee.dynamicTyping[Yt]||ee.dynamicTyping)===!0))(bn)?Ot==="true"||Ot==="TRUE"||Ot!=="false"&&Ot!=="FALSE"&&((Yt=>{if(qn.test(Yt)&&(Yt=parseFloat(Yt),Kt<Yt&&Yt<mt))return 1})(Ot)?parseFloat(Ot):Qn.test(Ot)?new Date(Ot):Ot===""?null:Ot):Ot)(Ce=ee.header?dn>=It.length?"__parsed_extra":It[dn]:Ce,Fn=ee.transform?ee.transform(Fn,Ce):Fn);Ce==="__parsed_extra"?(sn[Ce]=sn[Ce]||[],sn[Ce].push(Fn)):sn[Ce]=Fn}return ee.header&&(dn>It.length?Nn("FieldMismatch","TooManyFields","Too many fields: expected "+It.length+" fields but parsed "+dn,rt+er):dn<It.length&&Nn("FieldMismatch","TooFewFields","Too few fields: expected "+It.length+" fields but parsed "+dn,rt+er)),sn}var Zn;St&&(ee.header||ee.dynamicTyping||ee.transform)&&(Zn=1,!St.data.length||Array.isArray(St.data[0])?(St.data=St.data.map(rn),Zn=St.data.length):St.data=rn(St.data,0),ee.header&&St.meta&&(St.meta.fields=It),rt+=Zn)}function Cn(){return ee.header&&It.length===0}function Nn(Zt,rn,Zn,Qt){Zt={type:Zt,code:rn,message:Zn},Qt!==void 0&&(Zt.row=Qt),St.errors.push(Zt)}ve(ee.step)&&(Xe=ee.step,ee.step=function(Zt){St=Zt,Cn()?cn():(cn(),St.data.length!==0&&(Je+=Zt.data.length,ee.preview&&Je>ee.preview?Te.abort():(St.data=St.data[0],Xe(St,zt))))}),this.parse=function(Zt,rn,Zn){var Qt=ee.quoteChar||'"',Qt=(ee.newline||(ee.newline=this.guessLineEndings(Zt,Qt)),Ue=!1,ee.delimiter?ve(ee.delimiter)&&(ee.delimiter=ee.delimiter(Zt),St.meta.delimiter=ee.delimiter):((Qt=((wn,er,sn,dn,Ce)=>{var Fn,bn,Ot,Yt;Ce=Ce||[",","	","|",";",U.RECORD_SEP,U.UNIT_SEP];for(var Tr=0;Tr<Ce.length;Tr++){for(var yr,Hr=Ce[Tr],vr=0,rr=0,dr=0,fr=(Ot=void 0,new se({comments:dn,delimiter:Hr,newline:er,preview:10}).parse(wn)),Ke=0;Ke<fr.data.length;Ke++)sn&&Sn(fr.data[Ke])?dr++:(yr=fr.data[Ke].length,rr+=yr,Ot===void 0?Ot=yr:0<yr&&(vr+=Math.abs(yr-Ot),Ot=yr));0<fr.data.length&&(rr/=fr.data.length-dr),(bn===void 0||vr<=bn)&&(Yt===void 0||Yt<rr)&&1.99<rr&&(bn=vr,Fn=Hr,Yt=rr)}return{successful:!!(ee.delimiter=Fn),bestDelimiter:Fn}})(Zt,ee.newline,ee.skipEmptyLines,ee.comments,ee.delimitersToGuess)).successful?ee.delimiter=Qt.bestDelimiter:(Ue=!0,ee.delimiter=U.DefaultDelimiter),St.meta.delimiter=ee.delimiter),Ze(ee));return ee.preview&&ee.header&&Qt.preview++,de=Zt,Te=new se(Qt),St=Te.parse(de,rn,Zn),cn(),Et?{meta:{paused:!0}}:St||{meta:{paused:!1}}},this.paused=function(){return Et},this.pause=function(){Et=!0,Te.abort(),de=ve(ee.chunk)?"":de.substring(Te.getCharIndex())},this.resume=function(){zt.streamer._halted?(Et=!1,zt.streamer.parseChunk(de,!0)):setTimeout(zt.resume,3)},this.aborted=function(){return ht},this.abort=function(){ht=!0,Te.abort(),St.meta.aborted=!0,ve(ee.complete)&&ee.complete(St),de=""},this.guessLineEndings=function(wn,Qt){wn=wn.substring(0,1048576);var Qt=new RegExp(Be(Qt)+"([^]*?)"+Be(Qt),"gm"),Zn=(wn=wn.replace(Qt,"")).split("\r"),Qt=wn.split(`
`),wn=1<Qt.length&&Qt[0].length<Zn[0].length;if(Zn.length===1||wn)return`
`;for(var er=0,sn=0;sn<Zn.length;sn++)Zn[sn][0]===`
`&&er++;return er>=Zn.length/2?`\r
`:"\r"}}function Be(ee){return ee.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function se(ee){var de=(ee=ee||{}).delimiter,Te=ee.newline,Ue=ee.comments,Xe=ee.step,mt=ee.preview,Kt=ee.fastMode,qn=null,Qn=!1,zt=ee.quoteChar==null?'"':ee.quoteChar,Je=zt;if(ee.escapeChar!==void 0&&(Je=ee.escapeChar),(typeof de!="string"||-1<U.BAD_DELIMITERS.indexOf(de))&&(de=","),Ue===de)throw new Error("Comment character same as delimiter");Ue===!0?Ue="#":(typeof Ue!="string"||-1<U.BAD_DELIMITERS.indexOf(Ue))&&(Ue=!1),Te!==`
`&&Te!=="\r"&&Te!==`\r
`&&(Te=`
`);var rt=0,Et=!1;this.parse=function(ht,It,St){if(typeof ht!="string")throw new Error("Input must be a string");var Sn=ht.length,cn=de.length,Cn=Te.length,Nn=Ue.length,Zt=ve(Xe),rn=[],Zn=[],Qt=[],wn=rt=0;if(!ht)return vr();if(Kt||Kt!==!1&&ht.indexOf(zt)===-1){for(var er=ht.split(Te),sn=0;sn<er.length;sn++){if(Qt=er[sn],rt+=Qt.length,sn!==er.length-1)rt+=Te.length;else if(St)return vr();if(!Ue||Qt.substring(0,Nn)!==Ue){if(Zt){if(rn=[],Yt(Qt.split(de)),rr(),Et)return vr()}else Yt(Qt.split(de));if(mt&&mt<=sn)return rn=rn.slice(0,mt),vr(!0)}}return vr()}for(var dn=ht.indexOf(de,rt),Ce=ht.indexOf(Te,rt),Fn=new RegExp(Be(Je)+Be(zt),"g"),bn=ht.indexOf(zt,rt);;)if(ht[rt]===zt)for(bn=rt,rt++;;){if((bn=ht.indexOf(zt,bn+1))===-1)return St||Zn.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:rn.length,index:rt}),yr();if(bn===Sn-1)return yr(ht.substring(rt,bn).replace(Fn,zt));if(zt===Je&&ht[bn+1]===Je)bn++;else if(zt===Je||bn===0||ht[bn-1]!==Je){dn!==-1&&dn<bn+1&&(dn=ht.indexOf(de,bn+1));var Ot=Tr((Ce=Ce!==-1&&Ce<bn+1?ht.indexOf(Te,bn+1):Ce)===-1?dn:Math.min(dn,Ce));if(ht.substr(bn+1+Ot,cn)===de){Qt.push(ht.substring(rt,bn).replace(Fn,zt)),ht[rt=bn+1+Ot+cn]!==zt&&(bn=ht.indexOf(zt,rt)),dn=ht.indexOf(de,rt),Ce=ht.indexOf(Te,rt);break}if(Ot=Tr(Ce),ht.substring(bn+1+Ot,bn+1+Ot+Cn)===Te){if(Qt.push(ht.substring(rt,bn).replace(Fn,zt)),Hr(bn+1+Ot+Cn),dn=ht.indexOf(de,rt),bn=ht.indexOf(zt,rt),Zt&&(rr(),Et))return vr();if(mt&&rn.length>=mt)return vr(!0);break}Zn.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:rn.length,index:rt}),bn++}}else if(Ue&&Qt.length===0&&ht.substring(rt,rt+Nn)===Ue){if(Ce===-1)return vr();rt=Ce+Cn,Ce=ht.indexOf(Te,rt),dn=ht.indexOf(de,rt)}else if(dn!==-1&&(dn<Ce||Ce===-1))Qt.push(ht.substring(rt,dn)),rt=dn+cn,dn=ht.indexOf(de,rt);else{if(Ce===-1)break;if(Qt.push(ht.substring(rt,Ce)),Hr(Ce+Cn),Zt&&(rr(),Et))return vr();if(mt&&rn.length>=mt)return vr(!0)}return yr();function Yt(dr){rn.push(dr),wn=rt}function Tr(dr){var fr=0;return fr=dr!==-1&&(dr=ht.substring(bn+1,dr))&&dr.trim()===""?dr.length:fr}function yr(dr){return St||(dr===void 0&&(dr=ht.substring(rt)),Qt.push(dr),rt=Sn,Yt(Qt),Zt&&rr()),vr()}function Hr(dr){rt=dr,Yt(Qt),Qt=[],Ce=ht.indexOf(Te,rt)}function vr(dr){if(ee.header&&!It&&rn.length&&!Qn){var fr=rn[0],Ke={},hi=new Set(fr);let Lr=!1;for(let jr=0;jr<fr.length;jr++){let Pr=fr[jr];if(Ke[Pr=ve(ee.transformHeader)?ee.transformHeader(Pr,jr):Pr]){let it,Ht=Ke[Pr];for(;it=Pr+"_"+Ht,Ht++,hi.has(it););hi.add(it),fr[jr]=it,Ke[Pr]++,Lr=!0,(qn=qn===null?{}:qn)[it]=Pr}else Ke[Pr]=1,fr[jr]=Pr;hi.add(Pr)}Lr&&console.warn("Duplicate headers found and renamed."),Qn=!0}return{data:rn,errors:Zn,meta:{delimiter:de,linebreak:Te,aborted:Et,truncated:!!dr,cursor:wn+(It||0),renamedHeaders:qn}}}function rr(){Xe(vr()),rn=[],Zn=[]}},this.abort=function(){Et=!0},this.getCharIndex=function(){return rt}}function ue(ee){var de=ee.data,Te=c[de.workerId],Ue=!1;if(de.error)Te.userError(de.error,de.file);else if(de.results&&de.results.data){var Xe={abort:function(){Ue=!0,he(de.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:De,resume:De};if(ve(Te.userStep)){for(var mt=0;mt<de.results.data.length&&(Te.userStep({data:de.results.data[mt],errors:de.results.errors,meta:de.results.meta},Xe),!Ue);mt++);delete de.results}else ve(Te.userChunk)&&(Te.userChunk(de.results,Xe,de.file),delete de.results)}de.finished&&!Ue&&he(de.workerId,de.results)}function he(ee,de){var Te=c[ee];ve(Te.userComplete)&&Te.userComplete(de),Te.terminate(),delete c[ee]}function De(){throw new Error("Not implemented.")}function Ze(ee){if(typeof ee!="object"||ee===null)return ee;var de,Te=Array.isArray(ee)?[]:{};for(de in ee)Te[de]=Ze(ee[de]);return Te}function je(ee,de){return function(){ee.apply(de,arguments)}}function ve(ee){return typeof ee=="function"}return U.parse=function(ee,de){var Te=(de=de||{}).dynamicTyping||!1;if(ve(Te)&&(de.dynamicTypingFunction=Te,Te={}),de.dynamicTyping=Te,de.transform=!!ve(de.transform)&&de.transform,!de.worker||!U.WORKERS_SUPPORTED)return Te=null,U.NODE_STREAM_INPUT,typeof ee=="string"?(ee=(Ue=>Ue.charCodeAt(0)!==65279?Ue:Ue.slice(1))(ee),Te=new(de.download?W:Ee)(de)):ee.readable===!0&&ve(ee.read)&&ve(ee.on)?Te=new ze(de):(h.File&&ee instanceof File||ee instanceof Object)&&(Te=new q(de)),Te.stream(ee);(Te=(()=>{var Ue;return!!U.WORKERS_SUPPORTED&&(Ue=(()=>{var Xe=h.URL||h.webkitURL||null,mt=o.toString();return U.BLOB_URL||(U.BLOB_URL=Xe.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",mt,")();"],{type:"text/javascript"})))})(),(Ue=new h.Worker(Ue)).onmessage=ue,Ue.id=D++,c[Ue.id]=Ue)})()).userStep=de.step,Te.userChunk=de.chunk,Te.userComplete=de.complete,Te.userError=de.error,de.step=ve(de.step),de.chunk=ve(de.chunk),de.complete=ve(de.complete),de.error=ve(de.error),delete de.worker,Te.postMessage({input:ee,config:de,workerId:Te.id})},U.unparse=function(ee,de){var Te=!1,Ue=!0,Xe=",",mt=`\r
`,Kt='"',qn=Kt+Kt,Qn=!1,zt=null,Je=!1,rt=((()=>{if(typeof de=="object"){if(typeof de.delimiter!="string"||U.BAD_DELIMITERS.filter(function(It){return de.delimiter.indexOf(It)!==-1}).length||(Xe=de.delimiter),typeof de.quotes!="boolean"&&typeof de.quotes!="function"&&!Array.isArray(de.quotes)||(Te=de.quotes),typeof de.skipEmptyLines!="boolean"&&typeof de.skipEmptyLines!="string"||(Qn=de.skipEmptyLines),typeof de.newline=="string"&&(mt=de.newline),typeof de.quoteChar=="string"&&(Kt=de.quoteChar),typeof de.header=="boolean"&&(Ue=de.header),Array.isArray(de.columns)){if(de.columns.length===0)throw new Error("Option columns is empty");zt=de.columns}de.escapeChar!==void 0&&(qn=de.escapeChar+Kt),de.escapeFormulae instanceof RegExp?Je=de.escapeFormulae:typeof de.escapeFormulae=="boolean"&&de.escapeFormulae&&(Je=/^[=+\-@\t\r].*$/)}})(),new RegExp(Be(Kt),"g"));if(typeof ee=="string"&&(ee=JSON.parse(ee)),Array.isArray(ee)){if(!ee.length||Array.isArray(ee[0]))return Et(null,ee,Qn);if(typeof ee[0]=="object")return Et(zt||Object.keys(ee[0]),ee,Qn)}else if(typeof ee=="object")return typeof ee.data=="string"&&(ee.data=JSON.parse(ee.data)),Array.isArray(ee.data)&&(ee.fields||(ee.fields=ee.meta&&ee.meta.fields||zt),ee.fields||(ee.fields=Array.isArray(ee.data[0])?ee.fields:typeof ee.data[0]=="object"?Object.keys(ee.data[0]):[]),Array.isArray(ee.data[0])||typeof ee.data[0]=="object"||(ee.data=[ee.data])),Et(ee.fields||[],ee.data||[],Qn);throw new Error("Unable to serialize unrecognized input");function Et(It,St,Sn){var cn="",Cn=(typeof It=="string"&&(It=JSON.parse(It)),typeof St=="string"&&(St=JSON.parse(St)),Array.isArray(It)&&0<It.length),Nn=!Array.isArray(St[0]);if(Cn&&Ue){for(var Zt=0;Zt<It.length;Zt++)0<Zt&&(cn+=Xe),cn+=ht(It[Zt],Zt);0<St.length&&(cn+=mt)}for(var rn=0;rn<St.length;rn++){var Zn=(Cn?It:St[rn]).length,Qt=!1,wn=Cn?Object.keys(St[rn]).length===0:St[rn].length===0;if(Sn&&!Cn&&(Qt=Sn==="greedy"?St[rn].join("").trim()==="":St[rn].length===1&&St[rn][0].length===0),Sn==="greedy"&&Cn){for(var er=[],sn=0;sn<Zn;sn++){var dn=Nn?It[sn]:sn;er.push(St[rn][dn])}Qt=er.join("").trim()===""}if(!Qt){for(var Ce=0;Ce<Zn;Ce++){0<Ce&&!wn&&(cn+=Xe);var Fn=Cn&&Nn?It[Ce]:Ce;cn+=ht(St[rn][Fn],Ce)}rn<St.length-1&&(!Sn||0<Zn&&!wn)&&(cn+=mt)}}return cn}function ht(It,St){var Sn,cn;return It==null?"":It.constructor===Date?JSON.stringify(It).slice(1,25):(cn=!1,Je&&typeof It=="string"&&Je.test(It)&&(It="'"+It,cn=!0),Sn=It.toString().replace(rt,qn),(cn=cn||Te===!0||typeof Te=="function"&&Te(It,St)||Array.isArray(Te)&&Te[St]||((Cn,Nn)=>{for(var Zt=0;Zt<Nn.length;Zt++)if(-1<Cn.indexOf(Nn[Zt]))return!0;return!1})(Sn,U.BAD_DELIMITERS)||-1<Sn.indexOf(Xe)||Sn.charAt(0)===" "||Sn.charAt(Sn.length-1)===" ")?Kt+Sn+Kt:Sn)}},U.RECORD_SEP="",U.UNIT_SEP="",U.BYTE_ORDER_MARK="\uFEFF",U.BAD_DELIMITERS=["\r",`
`,'"',U.BYTE_ORDER_MARK],U.WORKERS_SUPPORTED=!b&&!!h.Worker,U.NODE_STREAM_INPUT=1,U.LocalChunkSize=10485760,U.RemoteChunkSize=5242880,U.DefaultDelimiter=",",U.Parser=se,U.ParserHandle=Ne,U.NetworkStreamer=W,U.FileStreamer=q,U.StringStreamer=Ee,U.ReadableStreamStreamer=ze,h.jQuery&&((_=h.jQuery).fn.parse=function(ee){var de=ee.config||{},Te=[];return this.each(function(mt){if(!(_(this).prop("tagName").toUpperCase()==="INPUT"&&_(this).attr("type").toLowerCase()==="file"&&h.FileReader)||!this.files||this.files.length===0)return!0;for(var Kt=0;Kt<this.files.length;Kt++)Te.push({file:this.files[Kt],inputElem:this,instanceConfig:_.extend({},de)})}),Ue(),this;function Ue(){if(Te.length===0)ve(ee.complete)&&ee.complete();else{var mt,Kt,qn,Qn,zt=Te[0];if(ve(ee.before)){var Je=ee.before(zt.file,zt.inputElem);if(typeof Je=="object"){if(Je.action==="abort")return mt="AbortError",Kt=zt.file,qn=zt.inputElem,Qn=Je.reason,void(ve(ee.error)&&ee.error({name:mt},Kt,qn,Qn));if(Je.action==="skip")return void Xe();typeof Je.config=="object"&&(zt.instanceConfig=_.extend(zt.instanceConfig,Je.config))}else if(Je==="skip")return void Xe()}var rt=zt.instanceConfig.complete;zt.instanceConfig.complete=function(Et){ve(rt)&&rt(Et,zt.file,zt.inputElem),Xe()},U.parse(zt.file,zt.instanceConfig)}}function Xe(){Te.splice(0,1),Ue()}}),w&&(h.onmessage=function(ee){ee=ee.data,U.WORKER_ID===void 0&&ee&&(U.WORKER_ID=ee.workerId),typeof ee.input=="string"?h.postMessage({workerId:U.WORKER_ID,results:U.parse(ee.input,ee.config),finished:!0}):(h.File&&ee.input instanceof File||ee.input instanceof Object)&&(ee=U.parse(ee.input,ee.config))&&h.postMessage({workerId:U.WORKER_ID,results:ee,finished:!0})}),(W.prototype=Object.create(J.prototype)).constructor=W,(q.prototype=Object.create(J.prototype)).constructor=q,(Ee.prototype=Object.create(Ee.prototype)).constructor=Ee,(ze.prototype=Object.create(J.prototype)).constructor=ze,U})})(U4);var nC=U4.exports;const rC=B0(nC),iC=(async()=>{const e={};return(await dw()).forEach(o=>{e[o.codeIso3]=o}),e})(),sC=(async()=>{const e={};for(const[r,o]of Object.entries(T0)){const h=(await o).default;e[r]={},h.forEach(_=>{e[r][_.stateCode]=_})}return e})(),j4=async e=>(await iC)[e]??null,$4=async(e,r)=>ud(e)?(await sC)[e][r]??null:null,C0=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],Zs={INSTITUTIONAL_INFORMATION:"Institutional Information",DATASET_INFORMATION:"Dataset Information",ACCESSIBILITY:"Accessibility"},fw="Country Code",V4="State Code",Q_="B",oC=C0.indexOf(Q_),ox="C",aC=C0.indexOf(ox),lC=[{name:"Name of Dataset",column:"A"},{name:fw,column:Q_},{name:V4,column:ox,hide:e=>!e},{name:"Country",column:Q_,category:Zs.INSTITUTIONAL_INFORMATION,transform:async e=>{const r=await j4(e);return(r==null?void 0:r.name)??null}},{name:"State",columns:[Q_,ox],category:Zs.INSTITUTIONAL_INFORMATION,transform:async([e,r])=>{const o=await $4(e,r);return(o==null?void 0:o.name)??null},hide:e=>!e},{name:"Source",column:"E",category:Zs.INSTITUTIONAL_INFORMATION},{name:"URL",column:"F",category:Zs.INSTITUTIONAL_INFORMATION,transform:e=>e?Qe.jsx("a",{href:e,target:"_",rel:"noreferrer",children:e}):null},{name:"Number of Participants",column:"G",category:Zs.DATASET_INFORMATION},{name:"Number of Samples",column:"H",category:Zs.DATASET_INFORMATION},{name:"Language",column:"L",category:Zs.DATASET_INFORMATION},{name:"Disease Category",column:"I",category:Zs.DATASET_INFORMATION},{name:"Diagnoses",column:"J",category:Zs.DATASET_INFORMATION},{name:"Speech Task(s)",column:"K",category:Zs.DATASET_INFORMATION},{name:"Speaker Details",column:"M",category:Zs.DATASET_INFORMATION},{name:"Demographics",column:"N",category:Zs.DATASET_INFORMATION},{name:"Accessibility",column:"O",category:Zs.ACCESSIBILITY},{name:"Access Instructions",column:"P",category:Zs.ACCESSIBILITY},{name:"License Types",column:"Q",category:Zs.ACCESSIBILITY}],uC=async(e,r)=>{const h=`row ${r+2} (${e[0]})`,_=e[oC];if(!_)return console.warn(`Skipping ${h} due to missing country code.`),null;if(j4(_)===null)return console.warn(`Skipping ${h} due to unknown country code (${_}).`),null;if(ud(_)){const D=e[aC];if(!D)return console.warn(`Skipping ${h} due to missing state code.`),null;if($4(_,D)===null)return console.warn(`Skipping ${h} due to unknown state code (${D}) for country '${_}'.`),null}const c=[];for(const D of lC){const{name:U,column:J,columns:W,category:q}=D,Ee=D.hide??(()=>!1),ze=D.transform??(se=>se);let Ne;if(J){const se=C0.findIndex(ue=>ue===J);Ne=e[se]}else if(W)Ne=W.map(se=>{const ue=C0.findIndex(he=>he===se);return e[ue]});else throw Error("Neither 'column' nor 'columns' defined.");const Be=await ze(Ne);Ee(Be)||c.push({name:U,value:Be,category:q,hide:Ee})}return c},cC=(async()=>{let e=[],r=[];try{const h=await(await fetch("https://docs.google.com/spreadsheets/d/e/2PACX-1vRhVfbSe0_jQBHdqbssbutK2n77y0KyB5Th2E70C3whkSoxMFnuBfkD7xjnHU1VIA/pub?gid=1792955439&single=true&output=csv")).text(),{data:_}=rC.parse(h);r=_.slice(1)}catch(o){alert("Error loading datasets CSV."),console.error(o)}for(let o=0;o<r.length;o++){const h=r[o],_=await uC(h,o);_!==null&&e.push(_)}return e})(),q4=async()=>await cC,hC=(async()=>{const e=await q4(),r={};for(const o of e){const _=Jf.find(o,{name:fw}).value;r[_]??(r[_]=[]),r[_].push(o)}return r})(),dC=(async()=>{var o;const e=await q4(),r={};for(const h of e){const b=Jf.find(h,{name:fw}).value,w=h.find(D=>D.name===V4);if(!w)continue;const c=w.value;r[b]??(r[b]={}),(o=r[b])[c]??(o[c]=[]),r[b][c].push(h)}return r})(),pw=async()=>await hC,Z4=async()=>{const e=await pw(),r={};for(const o in e){const h=e[o].length;r[o]=h}return r},G4=async e=>(await pw())[e]??[],fC=async e=>(await G4(e)).length,W4=async()=>{const e=await Z4();return Jf(e).values().maxBy()},H4=async e=>(await dC)[e]??{},X4=async e=>{const r=await H4(e),o={};for(const h in r){const _=r[h].length;o[h]=_}return o},K4=async(e,r)=>(await H4(e))[r]??[],pC=async(e,r)=>(await K4(e,r)).length,Y4=async e=>{const r=await X4(e);return Jf(r).values().maxBy()},mC="_container_12zem_1",gC="_title_12zem_6",_C="_description_12zem_10",X1={container:mC,title:gC,description:_C},Bf=({title:e,descriptions:r,children:o,className:h})=>Qe.jsxs("div",{className:`${X1.container} ${h??""}`,children:[e!==void 0&&Qe.jsx("h2",{className:X1.title,children:e}),r!==void 0&&r.map((_,b)=>Qe.jsx("p",{className:X1.description,children:_},b)),o]});var J4={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},Gb=Ol.createContext&&Ol.createContext(J4),yC=["attr","size","title"];function vC(e,r){if(e==null)return{};var o=xC(e,r),h,_;if(Object.getOwnPropertySymbols){var b=Object.getOwnPropertySymbols(e);for(_=0;_<b.length;_++)h=b[_],!(r.indexOf(h)>=0)&&Object.prototype.propertyIsEnumerable.call(e,h)&&(o[h]=e[h])}return o}function xC(e,r){if(e==null)return{};var o={};for(var h in e)if(Object.prototype.hasOwnProperty.call(e,h)){if(r.indexOf(h)>=0)continue;o[h]=e[h]}return o}function I0(){return I0=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var o=arguments[r];for(var h in o)Object.prototype.hasOwnProperty.call(o,h)&&(e[h]=o[h])}return e},I0.apply(this,arguments)}function Wb(e,r){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var h=Object.getOwnPropertySymbols(e);r&&(h=h.filter(function(_){return Object.getOwnPropertyDescriptor(e,_).enumerable})),o.push.apply(o,h)}return o}function k0(e){for(var r=1;r<arguments.length;r++){var o=arguments[r]!=null?arguments[r]:{};r%2?Wb(Object(o),!0).forEach(function(h){wC(e,h,o[h])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):Wb(Object(o)).forEach(function(h){Object.defineProperty(e,h,Object.getOwnPropertyDescriptor(o,h))})}return e}function wC(e,r,o){return r=bC(r),r in e?Object.defineProperty(e,r,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[r]=o,e}function bC(e){var r=SC(e,"string");return typeof r=="symbol"?r:r+""}function SC(e,r){if(typeof e!="object"||!e)return e;var o=e[Symbol.toPrimitive];if(o!==void 0){var h=o.call(e,r||"default");if(typeof h!="object")return h;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}function Q4(e){return e&&e.map((r,o)=>Ol.createElement(r.tag,k0({key:o},r.attr),Q4(r.child)))}function e5(e){return r=>Ol.createElement(TC,I0({attr:k0({},e.attr)},r),Q4(e.child))}function TC(e){var r=o=>{var{attr:h,size:_,title:b}=e,w=vC(e,yC),c=_||o.size||"1em",D;return o.className&&(D=o.className),e.className&&(D=(D?D+" ":"")+e.className),Ol.createElement("svg",I0({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},o.attr,h,w,{className:D,style:k0(k0({color:e.color||o.color},o.style),e.style),height:c,width:c,xmlns:"http://www.w3.org/2000/svg"}),b&&Ol.createElement("title",null,b),e.children)};return Gb!==void 0?Ol.createElement(Gb.Consumer,null,o=>r(o)):r(J4)}function EC(e){return e5({tag:"svg",attr:{viewBox:"0 0 320 512"},child:[{tag:"path",attr:{d:"M34.52 239.03L228.87 44.69c9.37-9.37 24.57-9.37 33.94 0l22.67 22.67c9.36 9.36 9.37 24.52.04 33.9L131.49 256l154.02 154.75c9.34 9.38 9.32 24.54-.04 33.9l-22.67 22.67c-9.37 9.37-24.57 9.37-33.94 0L34.52 272.97c-9.37-9.37-9.37-24.57 0-33.94z"},child:[]}]})(e)}function CC(e){return e5({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M240.971 130.524l194.343 194.343c9.373 9.373 9.373 24.569 0 33.941l-22.667 22.667c-9.357 9.357-24.522 9.375-33.901.04L224 227.495 69.255 381.516c-9.379 9.335-24.544 9.317-33.901-.04l-22.667-22.667c-9.373-9.373-9.373-24.569 0-33.941L207.03 130.525c9.372-9.373 24.568-9.373 33.941-.001z"},child:[]}]})(e)}const IC="_container_ce3n2_1",kC="_back_ce3n2_5",PC="_backText_ce3n2_17",K1={container:IC,back:kC,backText:PC},AC=({onClick:e})=>Qe.jsx(Bf,{className:K1.container,children:Qe.jsxs("div",{className:K1.back,onClick:e,children:[Qe.jsx(EC,{size:12}),Qe.jsx("div",{className:K1.backText,children:"Back"})]})}),MC="_container_1d3e8_1",zC="_header_1d3e8_5",DC="_isExpanded_1d3e8_15",RC="_title_1d3e8_20",LC="_details_1d3e8_35",OC="_categoryTitle_1d3e8_51",FC="_categoryRows_1d3e8_57",BC="_categoryRow_1d3e8_57",NC="_categoryRowKey_1d3e8_73",UC="_categoryRowValue_1d3e8_82",jC="_arrow_1d3e8_87",qa={container:MC,header:zC,isExpanded:DC,title:RC,details:LC,categoryTitle:OC,categoryRows:FC,categoryRow:BC,categoryRowKey:NC,categoryRowValue:UC,arrow:jC},$C=({dataset:e})=>{const[r,o]=Rt.useState(!1),h=Rt.useMemo(()=>{const _=Jf(e).groupBy("category").entries().filter(([b])=>b!=="undefined").value();return Qe.jsx("div",{className:qa.details,children:_.map(([b,w],c)=>Qe.jsxs("div",{children:[Qe.jsx("h3",{className:qa.categoryTitle,children:b}),Qe.jsx("div",{className:qa.categoryRows,children:w.map((D,U)=>Qe.jsxs("div",{className:qa.categoryRow,children:[Qe.jsxs("div",{className:qa.categoryRowKey,children:[D.name,":"]}),Qe.jsx("div",{className:qa.categoryRowValue,children:D.value})]},`row-${U}`))})]},`category-${c}`))})},[e]);return e?Qe.jsxs("div",{className:`${qa.container} ${r?qa.isExpanded:""}`,children:[Qe.jsxs("div",{className:qa.header,onClick:()=>o(!r),children:[Qe.jsx("div",{className:qa.title,children:e[0].value}),Qe.jsx("div",{className:`${qa.arrow}`,children:Qe.jsx(CC,{})})]}),r?h:null]}):null},t5=({title:e,extraDescriptions:r,getDatasets:o,onClickBack:h})=>{const[_,b]=Rt.useState(null);return Rt.useEffect(()=>{(async()=>{const w=await o(),c=w.length;b(Qe.jsxs(Qe.Fragment,{children:[Qe.jsx(AC,{onClick:h}),Qe.jsx(Bf,{title:e,descriptions:[`Number of Datasets: ${c}`,...r]}),Qe.jsx(Bf,{title:`Datasets (${c})`,children:w.map((D,U)=>Qe.jsx($C,{dataset:D},`${U}-${D[0].value}`))})]}))})()},[r,o,h,e]),_};function rs(e){return`Minified Redux error #${e}; visit https://redux.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var VC=typeof Symbol=="function"&&Symbol.observable||"@@observable",Hb=VC,Y1=()=>Math.random().toString(36).substring(7).split("").join("."),qC={INIT:`@@redux/INIT${Y1()}`,REPLACE:`@@redux/REPLACE${Y1()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${Y1()}`},P0=qC;function mw(e){if(typeof e!="object"||e===null)return!1;let r=e;for(;Object.getPrototypeOf(r)!==null;)r=Object.getPrototypeOf(r);return Object.getPrototypeOf(e)===r||Object.getPrototypeOf(e)===null}function n5(e,r,o){if(typeof e!="function")throw new Error(rs(2));if(typeof r=="function"&&typeof o=="function"||typeof o=="function"&&typeof arguments[3]=="function")throw new Error(rs(0));if(typeof r=="function"&&typeof o>"u"&&(o=r,r=void 0),typeof o<"u"){if(typeof o!="function")throw new Error(rs(1));return o(n5)(e,r)}let h=e,_=r,b=new Map,w=b,c=0,D=!1;function U(){w===b&&(w=new Map,b.forEach((Be,se)=>{w.set(se,Be)}))}function J(){if(D)throw new Error(rs(3));return _}function W(Be){if(typeof Be!="function")throw new Error(rs(4));if(D)throw new Error(rs(5));let se=!0;U();const ue=c++;return w.set(ue,Be),function(){if(se){if(D)throw new Error(rs(6));se=!1,U(),w.delete(ue),b=null}}}function q(Be){if(!mw(Be))throw new Error(rs(7));if(typeof Be.type>"u")throw new Error(rs(8));if(typeof Be.type!="string")throw new Error(rs(17));if(D)throw new Error(rs(9));try{D=!0,_=h(_,Be)}finally{D=!1}return(b=w).forEach(ue=>{ue()}),Be}function Ee(Be){if(typeof Be!="function")throw new Error(rs(10));h=Be,q({type:P0.REPLACE})}function ze(){const Be=W;return{subscribe(se){if(typeof se!="object"||se===null)throw new Error(rs(11));function ue(){const De=se;De.next&&De.next(J())}return ue(),{unsubscribe:Be(ue)}},[Hb](){return this}}}return q({type:P0.INIT}),{dispatch:q,subscribe:W,getState:J,replaceReducer:Ee,[Hb]:ze}}function ZC(e){Object.keys(e).forEach(r=>{const o=e[r];if(typeof o(void 0,{type:P0.INIT})>"u")throw new Error(rs(12));if(typeof o(void 0,{type:P0.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(rs(13))})}function GC(e){const r=Object.keys(e),o={};for(let b=0;b<r.length;b++){const w=r[b];typeof e[w]=="function"&&(o[w]=e[w])}const h=Object.keys(o);let _;try{ZC(o)}catch(b){_=b}return function(w={},c){if(_)throw _;let D=!1;const U={};for(let J=0;J<h.length;J++){const W=h[J],q=o[W],Ee=w[W],ze=q(Ee,c);if(typeof ze>"u")throw c&&c.type,new Error(rs(14));U[W]=ze,D=D||ze!==Ee}return D=D||h.length!==Object.keys(w).length,D?U:w}}function A0(...e){return e.length===0?r=>r:e.length===1?e[0]:e.reduce((r,o)=>(...h)=>r(o(...h)))}function WC(...e){return r=>(o,h)=>{const _=r(o,h);let b=()=>{throw new Error(rs(15))};const w={getState:_.getState,dispatch:(D,...U)=>b(D,...U)},c=e.map(D=>D(w));return b=A0(...c)(_.dispatch),{..._,dispatch:b}}}function HC(e){return mw(e)&&"type"in e&&typeof e.type=="string"}var r5=Symbol.for("immer-nothing"),Xb=Symbol.for("immer-draftable"),Lo=Symbol.for("immer-state");function Ha(e,...r){throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var Gf=Object.getPrototypeOf;function cd(e){return!!e&&!!e[Lo]}function Ou(e){var r;return e?i5(e)||Array.isArray(e)||!!e[Xb]||!!((r=e.constructor)!=null&&r[Xb])||ny(e)||ry(e):!1}var XC=Object.prototype.constructor.toString();function i5(e){if(!e||typeof e!="object")return!1;const r=Gf(e);if(r===null)return!0;const o=Object.hasOwnProperty.call(r,"constructor")&&r.constructor;return o===Object?!0:typeof o=="function"&&Function.toString.call(o)===XC}function M0(e,r){ty(e)===0?Reflect.ownKeys(e).forEach(o=>{r(o,e[o],e)}):e.forEach((o,h)=>r(h,o,e))}function ty(e){const r=e[Lo];return r?r.type_:Array.isArray(e)?1:ny(e)?2:ry(e)?3:0}function ax(e,r){return ty(e)===2?e.has(r):Object.prototype.hasOwnProperty.call(e,r)}function s5(e,r,o){const h=ty(e);h===2?e.set(r,o):h===3?e.add(o):e[r]=o}function KC(e,r){return e===r?e!==0||1/e===1/r:e!==e&&r!==r}function ny(e){return e instanceof Map}function ry(e){return e instanceof Set}function Xh(e){return e.copy_||e.base_}function lx(e,r){if(ny(e))return new Map(e);if(ry(e))return new Set(e);if(Array.isArray(e))return Array.prototype.slice.call(e);const o=i5(e);if(r===!0||r==="class_only"&&!o){const h=Object.getOwnPropertyDescriptors(e);delete h[Lo];let _=Reflect.ownKeys(h);for(let b=0;b<_.length;b++){const w=_[b],c=h[w];c.writable===!1&&(c.writable=!0,c.configurable=!0),(c.get||c.set)&&(h[w]={configurable:!0,writable:!0,enumerable:c.enumerable,value:e[w]})}return Object.create(Gf(e),h)}else{const h=Gf(e);if(h!==null&&o)return{...e};const _=Object.create(h);return Object.assign(_,e)}}function gw(e,r=!1){return iy(e)||cd(e)||!Ou(e)||(ty(e)>1&&(e.set=e.add=e.clear=e.delete=YC),Object.freeze(e),r&&Object.entries(e).forEach(([o,h])=>gw(h,!0))),e}function YC(){Ha(2)}function iy(e){return Object.isFrozen(e)}var JC={};function hd(e){const r=JC[e];return r||Ha(0,e),r}var Gm;function o5(){return Gm}function QC(e,r){return{drafts_:[],parent_:e,immer_:r,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function Kb(e,r){r&&(hd("Patches"),e.patches_=[],e.inversePatches_=[],e.patchListener_=r)}function ux(e){cx(e),e.drafts_.forEach(eI),e.drafts_=null}function cx(e){e===Gm&&(Gm=e.parent_)}function Yb(e){return Gm=QC(Gm,e)}function eI(e){const r=e[Lo];r.type_===0||r.type_===1?r.revoke_():r.revoked_=!0}function Jb(e,r){r.unfinalizedDrafts_=r.drafts_.length;const o=r.drafts_[0];return e!==void 0&&e!==o?(o[Lo].modified_&&(ux(r),Ha(4)),Ou(e)&&(e=z0(r,e),r.parent_||D0(r,e)),r.patches_&&hd("Patches").generateReplacementPatches_(o[Lo].base_,e,r.patches_,r.inversePatches_)):e=z0(r,o,[]),ux(r),r.patches_&&r.patchListener_(r.patches_,r.inversePatches_),e!==r5?e:void 0}function z0(e,r,o){if(iy(r))return r;const h=r[Lo];if(!h)return M0(r,(_,b)=>Qb(e,h,r,_,b,o)),r;if(h.scope_!==e)return r;if(!h.modified_)return D0(e,h.base_,!0),h.base_;if(!h.finalized_){h.finalized_=!0,h.scope_.unfinalizedDrafts_--;const _=h.copy_;let b=_,w=!1;h.type_===3&&(b=new Set(_),_.clear(),w=!0),M0(b,(c,D)=>Qb(e,h,_,c,D,o,w)),D0(e,_,!1),o&&e.patches_&&hd("Patches").generatePatches_(h,o,e.patches_,e.inversePatches_)}return h.copy_}function Qb(e,r,o,h,_,b,w){if(cd(_)){const c=b&&r&&r.type_!==3&&!ax(r.assigned_,h)?b.concat(h):void 0,D=z0(e,_,c);if(s5(o,h,D),cd(D))e.canAutoFreeze_=!1;else return}else w&&o.add(_);if(Ou(_)&&!iy(_)){if(!e.immer_.autoFreeze_&&e.unfinalizedDrafts_<1)return;z0(e,_),(!r||!r.scope_.parent_)&&typeof h!="symbol"&&Object.prototype.propertyIsEnumerable.call(o,h)&&D0(e,_)}}function D0(e,r,o=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&gw(r,o)}function tI(e,r){const o=Array.isArray(e),h={type_:o?1:0,scope_:r?r.scope_:o5(),modified_:!1,finalized_:!1,assigned_:{},parent_:r,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1};let _=h,b=_w;o&&(_=[h],b=Wm);const{revoke:w,proxy:c}=Proxy.revocable(_,b);return h.draft_=c,h.revoke_=w,c}var _w={get(e,r){if(r===Lo)return e;const o=Xh(e);if(!ax(o,r))return nI(e,o,r);const h=o[r];return e.finalized_||!Ou(h)?h:h===J1(e.base_,r)?(Q1(e),e.copy_[r]=dx(h,e)):h},has(e,r){return r in Xh(e)},ownKeys(e){return Reflect.ownKeys(Xh(e))},set(e,r,o){const h=a5(Xh(e),r);if(h!=null&&h.set)return h.set.call(e.draft_,o),!0;if(!e.modified_){const _=J1(Xh(e),r),b=_==null?void 0:_[Lo];if(b&&b.base_===o)return e.copy_[r]=o,e.assigned_[r]=!1,!0;if(KC(o,_)&&(o!==void 0||ax(e.base_,r)))return!0;Q1(e),hx(e)}return e.copy_[r]===o&&(o!==void 0||r in e.copy_)||Number.isNaN(o)&&Number.isNaN(e.copy_[r])||(e.copy_[r]=o,e.assigned_[r]=!0),!0},deleteProperty(e,r){return J1(e.base_,r)!==void 0||r in e.base_?(e.assigned_[r]=!1,Q1(e),hx(e)):delete e.assigned_[r],e.copy_&&delete e.copy_[r],!0},getOwnPropertyDescriptor(e,r){const o=Xh(e),h=Reflect.getOwnPropertyDescriptor(o,r);return h&&{writable:!0,configurable:e.type_!==1||r!=="length",enumerable:h.enumerable,value:o[r]}},defineProperty(){Ha(11)},getPrototypeOf(e){return Gf(e.base_)},setPrototypeOf(){Ha(12)}},Wm={};M0(_w,(e,r)=>{Wm[e]=function(){return arguments[0]=arguments[0][0],r.apply(this,arguments)}});Wm.deleteProperty=function(e,r){return Wm.set.call(this,e,r,void 0)};Wm.set=function(e,r,o){return _w.set.call(this,e[0],r,o,e[0])};function J1(e,r){const o=e[Lo];return(o?Xh(o):e)[r]}function nI(e,r,o){var _;const h=a5(r,o);return h?"value"in h?h.value:(_=h.get)==null?void 0:_.call(e.draft_):void 0}function a5(e,r){if(!(r in e))return;let o=Gf(e);for(;o;){const h=Object.getOwnPropertyDescriptor(o,r);if(h)return h;o=Gf(o)}}function hx(e){e.modified_||(e.modified_=!0,e.parent_&&hx(e.parent_))}function Q1(e){e.copy_||(e.copy_=lx(e.base_,e.scope_.immer_.useStrictShallowCopy_))}var rI=class{constructor(e){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(r,o,h)=>{if(typeof r=="function"&&typeof o!="function"){const b=o;o=r;const w=this;return function(D=b,...U){return w.produce(D,J=>o.call(this,J,...U))}}typeof o!="function"&&Ha(6),h!==void 0&&typeof h!="function"&&Ha(7);let _;if(Ou(r)){const b=Yb(this),w=dx(r,void 0);let c=!0;try{_=o(w),c=!1}finally{c?ux(b):cx(b)}return Kb(b,h),Jb(_,b)}else if(!r||typeof r!="object"){if(_=o(r),_===void 0&&(_=r),_===r5&&(_=void 0),this.autoFreeze_&&gw(_,!0),h){const b=[],w=[];hd("Patches").generateReplacementPatches_(r,_,b,w),h(b,w)}return _}else Ha(1,r)},this.produceWithPatches=(r,o)=>{if(typeof r=="function")return(w,...c)=>this.produceWithPatches(w,D=>r(D,...c));let h,_;return[this.produce(r,o,(w,c)=>{h=w,_=c}),h,_]},typeof(e==null?void 0:e.autoFreeze)=="boolean"&&this.setAutoFreeze(e.autoFreeze),typeof(e==null?void 0:e.useStrictShallowCopy)=="boolean"&&this.setUseStrictShallowCopy(e.useStrictShallowCopy)}createDraft(e){Ou(e)||Ha(8),cd(e)&&(e=iI(e));const r=Yb(this),o=dx(e,void 0);return o[Lo].isManual_=!0,cx(r),o}finishDraft(e,r){const o=e&&e[Lo];(!o||!o.isManual_)&&Ha(9);const{scope_:h}=o;return Kb(h,r),Jb(void 0,h)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}applyPatches(e,r){let o;for(o=r.length-1;o>=0;o--){const _=r[o];if(_.path.length===0&&_.op==="replace"){e=_.value;break}}o>-1&&(r=r.slice(o+1));const h=hd("Patches").applyPatches_;return cd(e)?h(e,r):this.produce(e,_=>h(_,r))}};function dx(e,r){const o=ny(e)?hd("MapSet").proxyMap_(e,r):ry(e)?hd("MapSet").proxySet_(e,r):tI(e,r);return(r?r.scope_:o5()).drafts_.push(o),o}function iI(e){return cd(e)||Ha(10,e),l5(e)}function l5(e){if(!Ou(e)||iy(e))return e;const r=e[Lo];let o;if(r){if(!r.modified_)return r.base_;r.finalized_=!0,o=lx(e,r.scope_.immer_.useStrictShallowCopy_)}else o=lx(e,!0);return M0(o,(h,_)=>{s5(o,h,l5(_))}),r&&(r.finalized_=!1),o}var Oo=new rI,u5=Oo.produce;Oo.produceWithPatches.bind(Oo);Oo.setAutoFreeze.bind(Oo);Oo.setUseStrictShallowCopy.bind(Oo);Oo.applyPatches.bind(Oo);Oo.createDraft.bind(Oo);Oo.finishDraft.bind(Oo);function c5(e){return({dispatch:o,getState:h})=>_=>b=>typeof b=="function"?b(o,h,e):_(b)}var sI=c5(),oI=c5,aI=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?A0:A0.apply(null,arguments)};function e2(e,r){function o(...h){if(r){let _=r(...h);if(!_)throw new Error(Nl(0));return{type:e,payload:_.payload,..."meta"in _&&{meta:_.meta},..."error"in _&&{error:_.error}}}return{type:e,payload:h[0]}}return o.toString=()=>`${e}`,o.type=e,o.match=h=>HC(h)&&h.type===e,o}var h5=class vm extends Array{constructor(...r){super(...r),Object.setPrototypeOf(this,vm.prototype)}static get[Symbol.species](){return vm}concat(...r){return super.concat.apply(this,r)}prepend(...r){return r.length===1&&Array.isArray(r[0])?new vm(...r[0].concat(this)):new vm(...r.concat(this))}};function t2(e){return Ou(e)?u5(e,()=>{}):e}function n2(e,r,o){if(e.has(r)){let _=e.get(r);return o.update&&(_=o.update(_,r,e),e.set(r,_)),_}if(!o.insert)throw new Error(Nl(10));const h=o.insert(r,e);return e.set(r,h),h}function lI(e){return typeof e=="boolean"}var uI=()=>function(r){const{thunk:o=!0,immutableCheck:h=!0,serializableCheck:_=!0,actionCreatorCheck:b=!0}=r??{};let w=new h5;return o&&(lI(o)?w.push(sI):w.push(oI(o.extraArgument))),w},cI="RTK_autoBatch",d5=e=>r=>{setTimeout(r,e)},hI=typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame:d5(10),dI=(e={type:"raf"})=>r=>(...o)=>{const h=r(...o);let _=!0,b=!1,w=!1;const c=new Set,D=e.type==="tick"?queueMicrotask:e.type==="raf"?hI:e.type==="callback"?e.queueNotification:d5(e.timeout),U=()=>{w=!1,b&&(b=!1,c.forEach(J=>J()))};return Object.assign({},h,{subscribe(J){const W=()=>_&&J(),q=h.subscribe(W);return c.add(J),()=>{q(),c.delete(J)}},dispatch(J){var W;try{return _=!((W=J==null?void 0:J.meta)!=null&&W[cI]),b=!_,b&&(w||(w=!0,D(U))),h.dispatch(J)}finally{_=!0}}})},fI=e=>function(o){const{autoBatch:h=!0}=o??{};let _=new h5(e);return h&&_.push(dI(typeof h=="object"?h:void 0)),_};function pI(e){const r=uI(),{reducer:o=void 0,middleware:h,devTools:_=!0,preloadedState:b=void 0,enhancers:w=void 0}=e||{};let c;if(typeof o=="function")c=o;else if(mw(o))c=GC(o);else throw new Error(Nl(1));let D;typeof h=="function"?D=h(r):D=r();let U=A0;_&&(U=aI({trace:!1,...typeof _=="object"&&_}));const J=WC(...D),W=fI(J);let q=typeof w=="function"?w(W):W();const Ee=U(...q);return n5(c,b,Ee)}function f5(e){const r={},o=[];let h;const _={addCase(b,w){const c=typeof b=="string"?b:b.type;if(!c)throw new Error(Nl(28));if(c in r)throw new Error(Nl(29));return r[c]=w,_},addMatcher(b,w){return o.push({matcher:b,reducer:w}),_},addDefaultCase(b){return h=b,_}};return e(_),[r,o,h]}function mI(e){return typeof e=="function"}function gI(e,r){let[o,h,_]=f5(r),b;if(mI(e))b=()=>t2(e());else{const c=t2(e);b=()=>c}function w(c=b(),D){let U=[o[D.type],...h.filter(({matcher:J})=>J(D)).map(({reducer:J})=>J)];return U.filter(J=>!!J).length===0&&(U=[_]),U.reduce((J,W)=>{if(W)if(cd(J)){const Ee=W(J,D);return Ee===void 0?J:Ee}else{if(Ou(J))return u5(J,q=>W(q,D));{const q=W(J,D);if(q===void 0){if(J===null)return J;throw Error("A case reducer on a non-draftable value must not return undefined")}return q}}return J},c)}return w.getInitialState=b,w}var _I=Symbol.for("rtk-slice-createasyncthunk");function yI(e,r){return`${e}/${r}`}function vI({creators:e}={}){var o;const r=(o=e==null?void 0:e.asyncThunk)==null?void 0:o[_I];return function(_){const{name:b,reducerPath:w=b}=_;if(!b)throw new Error(Nl(11));typeof process<"u";const c=(typeof _.reducers=="function"?_.reducers(bI()):_.reducers)||{},D=Object.keys(c),U={sliceCaseReducersByName:{},sliceCaseReducersByType:{},actionCreators:{},sliceMatchers:[]},J={addCase(he,De){const Ze=typeof he=="string"?he:he.type;if(!Ze)throw new Error(Nl(12));if(Ze in U.sliceCaseReducersByType)throw new Error(Nl(13));return U.sliceCaseReducersByType[Ze]=De,J},addMatcher(he,De){return U.sliceMatchers.push({matcher:he,reducer:De}),J},exposeAction(he,De){return U.actionCreators[he]=De,J},exposeCaseReducer(he,De){return U.sliceCaseReducersByName[he]=De,J}};D.forEach(he=>{const De=c[he],Ze={reducerName:he,type:yI(b,he),createNotation:typeof _.reducers=="function"};TI(De)?CI(Ze,De,J,r):SI(Ze,De,J)});function W(){const[he={},De=[],Ze=void 0]=typeof _.extraReducers=="function"?f5(_.extraReducers):[_.extraReducers],je={...he,...U.sliceCaseReducersByType};return gI(_.initialState,ve=>{for(let ee in je)ve.addCase(ee,je[ee]);for(let ee of U.sliceMatchers)ve.addMatcher(ee.matcher,ee.reducer);for(let ee of De)ve.addMatcher(ee.matcher,ee.reducer);Ze&&ve.addDefaultCase(Ze)})}const q=he=>he,Ee=new Map;let ze;function Ne(he,De){return ze||(ze=W()),ze(he,De)}function Be(){return ze||(ze=W()),ze.getInitialState()}function se(he,De=!1){function Ze(ve){let ee=ve[he];return typeof ee>"u"&&De&&(ee=Be()),ee}function je(ve=q){const ee=n2(Ee,De,{insert:()=>new WeakMap});return n2(ee,ve,{insert:()=>{const de={};for(const[Te,Ue]of Object.entries(_.selectors??{}))de[Te]=xI(Ue,ve,Be,De);return de}})}return{reducerPath:he,getSelectors:je,get selectors(){return je(Ze)},selectSlice:Ze}}const ue={name:b,reducer:Ne,actions:U.actionCreators,caseReducers:U.sliceCaseReducersByName,getInitialState:Be,...se(w),injectInto(he,{reducerPath:De,...Ze}={}){const je=De??w;return he.inject({reducerPath:je,reducer:Ne},Ze),{...ue,...se(je,!0)}}};return ue}}function xI(e,r,o,h){function _(b,...w){let c=r(b);return typeof c>"u"&&h&&(c=o()),e(c,...w)}return _.unwrapped=e,_}var wI=vI();function bI(){function e(r,o){return{_reducerDefinitionType:"asyncThunk",payloadCreator:r,...o}}return e.withTypes=()=>e,{reducer(r){return Object.assign({[r.name](...o){return r(...o)}}[r.name],{_reducerDefinitionType:"reducer"})},preparedReducer(r,o){return{_reducerDefinitionType:"reducerWithPrepare",prepare:r,reducer:o}},asyncThunk:e}}function SI({type:e,reducerName:r,createNotation:o},h,_){let b,w;if("reducer"in h){if(o&&!EI(h))throw new Error(Nl(17));b=h.reducer,w=h.prepare}else b=h;_.addCase(e,b).exposeCaseReducer(r,b).exposeAction(r,w?e2(e,w):e2(e))}function TI(e){return e._reducerDefinitionType==="asyncThunk"}function EI(e){return e._reducerDefinitionType==="reducerWithPrepare"}function CI({type:e,reducerName:r},o,h,_){if(!_)throw new Error(Nl(18));const{payloadCreator:b,fulfilled:w,pending:c,rejected:D,settled:U,options:J}=o,W=_(e,b,J);h.exposeAction(r,W),w&&h.addCase(W.fulfilled,w),c&&h.addCase(W.pending,c),D&&h.addCase(W.rejected,D),U&&h.addMatcher(W.settled,U),h.exposeCaseReducer(r,{fulfilled:w||O_,pending:c||O_,rejected:D||O_,settled:U||O_})}function O_(){}function Nl(e){return`Minified Redux Toolkit error #${e}; visit https://redux-toolkit.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}const jl=wI({name:"main",initialState:{isMapInitialized:!1,focusedCountry:null,focusedState:null,menuWidthPx:500},reducers:{setIsMapInitialized:(e,r)=>{e.isMapInitialized=r.payload},setFocusedCountry:(e,r)=>{e.focusedCountry=r.payload},setFocusedState:(e,r)=>{e.focusedState=r.payload},setMenuWidthPx:(e,r)=>{e.menuWidthPx=r.payload}}});var p5={exports:{}};/**
 * MapLibre GL JS
 * @license 3-Clause BSD. Full text of license: https://github.com/maplibre/maplibre-gl-js/blob/v4.7.1/LICENSE.txt
 */(function(e,r){(function(o,h){e.exports=h()})(Kh,function(){var o={},h={};function _(w,c,D){if(h[w]=D,w==="index"){var U="var sharedModule = {}; ("+h.shared+")(sharedModule); ("+h.worker+")(sharedModule);",J={};return h.shared(J),h.index(o,J),typeof window<"u"&&o.setWorkerUrl(window.URL.createObjectURL(new Blob([U],{type:"text/javascript"}))),o}}_("shared",["exports"],function(w){function c(i,n,s,l){return new(s||(s=Promise))(function(p,v){function x(P){try{C(l.next(P))}catch(M){v(M)}}function S(P){try{C(l.throw(P))}catch(M){v(M)}}function C(P){var M;P.done?p(P.value):(M=P.value,M instanceof s?M:new s(function(R){R(M)})).then(x,S)}C((l=l.apply(i,n||[])).next())})}function D(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}typeof SuppressedError=="function"&&SuppressedError;var U=J;function J(i,n){this.x=i,this.y=n}J.prototype={clone:function(){return new J(this.x,this.y)},add:function(i){return this.clone()._add(i)},sub:function(i){return this.clone()._sub(i)},multByPoint:function(i){return this.clone()._multByPoint(i)},divByPoint:function(i){return this.clone()._divByPoint(i)},mult:function(i){return this.clone()._mult(i)},div:function(i){return this.clone()._div(i)},rotate:function(i){return this.clone()._rotate(i)},rotateAround:function(i,n){return this.clone()._rotateAround(i,n)},matMult:function(i){return this.clone()._matMult(i)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(i){return this.x===i.x&&this.y===i.y},dist:function(i){return Math.sqrt(this.distSqr(i))},distSqr:function(i){var n=i.x-this.x,s=i.y-this.y;return n*n+s*s},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(i){return Math.atan2(this.y-i.y,this.x-i.x)},angleWith:function(i){return this.angleWithSep(i.x,i.y)},angleWithSep:function(i,n){return Math.atan2(this.x*n-this.y*i,this.x*i+this.y*n)},_matMult:function(i){var n=i[2]*this.x+i[3]*this.y;return this.x=i[0]*this.x+i[1]*this.y,this.y=n,this},_add:function(i){return this.x+=i.x,this.y+=i.y,this},_sub:function(i){return this.x-=i.x,this.y-=i.y,this},_mult:function(i){return this.x*=i,this.y*=i,this},_div:function(i){return this.x/=i,this.y/=i,this},_multByPoint:function(i){return this.x*=i.x,this.y*=i.y,this},_divByPoint:function(i){return this.x/=i.x,this.y/=i.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var i=this.y;return this.y=this.x,this.x=-i,this},_rotate:function(i){var n=Math.cos(i),s=Math.sin(i),l=s*this.x+n*this.y;return this.x=n*this.x-s*this.y,this.y=l,this},_rotateAround:function(i,n){var s=Math.cos(i),l=Math.sin(i),p=n.y+l*(this.x-n.x)+s*(this.y-n.y);return this.x=n.x+s*(this.x-n.x)-l*(this.y-n.y),this.y=p,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},J.convert=function(i){return i instanceof J?i:Array.isArray(i)?new J(i[0],i[1]):i};var W=D(U),q=Ee;function Ee(i,n,s,l){this.cx=3*i,this.bx=3*(s-i)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*n,this.by=3*(l-n)-this.cy,this.ay=1-this.cy-this.by,this.p1x=i,this.p1y=n,this.p2x=s,this.p2y=l}Ee.prototype={sampleCurveX:function(i){return((this.ax*i+this.bx)*i+this.cx)*i},sampleCurveY:function(i){return((this.ay*i+this.by)*i+this.cy)*i},sampleCurveDerivativeX:function(i){return(3*this.ax*i+2*this.bx)*i+this.cx},solveCurveX:function(i,n){if(n===void 0&&(n=1e-6),i<0)return 0;if(i>1)return 1;for(var s=i,l=0;l<8;l++){var p=this.sampleCurveX(s)-i;if(Math.abs(p)<n)return s;var v=this.sampleCurveDerivativeX(s);if(Math.abs(v)<1e-6)break;s-=p/v}var x=0,S=1;for(s=i,l=0;l<20&&(p=this.sampleCurveX(s),!(Math.abs(p-i)<n));l++)i>p?x=s:S=s,s=.5*(S-x)+x;return s},solve:function(i,n){return this.sampleCurveY(this.solveCurveX(i,n))}};var ze=D(q);let Ne,Be;function se(){return Ne==null&&(Ne=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),Ne}function ue(){if(Be==null&&(Be=!1,se())){const n=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(n){for(let l=0;l<5*5;l++){const p=4*l;n.fillStyle=`rgb(${p},${p+1},${p+2})`,n.fillRect(l%5,Math.floor(l/5),1,1)}const s=n.getImageData(0,0,5,5).data;for(let l=0;l<5*5*4;l++)if(l%4!=3&&s[l]!==l){Be=!0;break}}}return Be||!1}function he(i,n,s,l){const p=new ze(i,n,s,l);return v=>p.solve(v)}const De=he(.25,.1,.25,1);function Ze(i,n,s){return Math.min(s,Math.max(n,i))}function je(i,n,s){const l=s-n,p=((i-n)%l+l)%l+n;return p===n?s:p}function ve(i,...n){for(const s of n)for(const l in s)i[l]=s[l];return i}let ee=1;function de(i,n,s){const l={};for(const p in i)l[p]=n.call(this,i[p],p,i);return l}function Te(i,n,s){const l={};for(const p in i)n.call(this,i[p],p,i)&&(l[p]=i[p]);return l}function Ue(i){return Array.isArray(i)?i.map(Ue):typeof i=="object"&&i?de(i,Ue):i}const Xe={};function mt(i){Xe[i]||(typeof console<"u"&&console.warn(i),Xe[i]=!0)}function Kt(i,n,s){return(s.y-i.y)*(n.x-i.x)>(n.y-i.y)*(s.x-i.x)}function qn(i){return typeof WorkerGlobalScope<"u"&&i!==void 0&&i instanceof WorkerGlobalScope}let Qn=null;function zt(i){return typeof ImageBitmap<"u"&&i instanceof ImageBitmap}const Je="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function rt(i,n,s,l,p){return c(this,void 0,void 0,function*(){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");const v=new VideoFrame(i,{timestamp:0});try{const x=v==null?void 0:v.format;if(!x||!x.startsWith("BGR")&&!x.startsWith("RGB"))throw new Error(`Unrecognized format ${x}`);const S=x.startsWith("BGR"),C=new Uint8ClampedArray(l*p*4);if(yield v.copyTo(C,function(P,M,R,F,j){const G=4*Math.max(-M,0),Z=(Math.max(0,R)-R)*F*4+G,ne=4*F,oe=Math.max(0,M),Pe=Math.max(0,R);return{rect:{x:oe,y:Pe,width:Math.min(P.width,M+F)-oe,height:Math.min(P.height,R+j)-Pe},layout:[{offset:Z,stride:ne}]}}(i,n,s,l,p)),S)for(let P=0;P<C.length;P+=4){const M=C[P];C[P]=C[P+2],C[P+2]=M}return C}finally{v.close()}})}let Et,ht;const It="AbortError";function St(){return new Error(It)}const Sn={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};function cn(i){return Sn.REGISTERED_PROTOCOLS[i.substring(0,i.indexOf("://"))]}const Cn="global-dispatcher";class Nn extends Error{constructor(n,s,l,p){super(`AJAXError: ${s} (${n}): ${l}`),this.status=n,this.statusText=s,this.url=l,this.body=p}}const Zt=()=>qn(self)?self.worker&&self.worker.referrer:(window.location.protocol==="blob:"?window.parent:window).location.href,rn=function(i,n){if(/:\/\//.test(i.url)&&!/^https?:|^file:/.test(i.url)){const l=cn(i.url);if(l)return l(i,n);if(qn(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:i,targetMapId:Cn},n)}if(!(/^file:/.test(s=i.url)||/^file:/.test(Zt())&&!/^\w+:/.test(s))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return function(l,p){return c(this,void 0,void 0,function*(){const v=new Request(l.url,{method:l.method||"GET",body:l.body,credentials:l.credentials,headers:l.headers,cache:l.cache,referrer:Zt(),signal:p.signal});l.type!=="json"||v.headers.has("Accept")||v.headers.set("Accept","application/json");const x=yield fetch(v);if(!x.ok){const P=yield x.blob();throw new Nn(x.status,x.statusText,l.url,P)}let S;S=l.type==="arrayBuffer"||l.type==="image"?x.arrayBuffer():l.type==="json"?x.json():x.text();const C=yield S;if(p.signal.aborted)throw St();return{data:C,cacheControl:x.headers.get("Cache-Control"),expires:x.headers.get("Expires")}})}(i,n);if(qn(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:i,mustQueue:!0,targetMapId:Cn},n)}var s;return function(l,p){return new Promise((v,x)=>{var S;const C=new XMLHttpRequest;C.open(l.method||"GET",l.url,!0),l.type!=="arrayBuffer"&&l.type!=="image"||(C.responseType="arraybuffer");for(const P in l.headers)C.setRequestHeader(P,l.headers[P]);l.type==="json"&&(C.responseType="text",!((S=l.headers)===null||S===void 0)&&S.Accept||C.setRequestHeader("Accept","application/json")),C.withCredentials=l.credentials==="include",C.onerror=()=>{x(new Error(C.statusText))},C.onload=()=>{if(!p.signal.aborted)if((C.status>=200&&C.status<300||C.status===0)&&C.response!==null){let P=C.response;if(l.type==="json")try{P=JSON.parse(C.response)}catch(M){return void x(M)}v({data:P,cacheControl:C.getResponseHeader("Cache-Control"),expires:C.getResponseHeader("Expires")})}else{const P=new Blob([C.response],{type:C.getResponseHeader("Content-Type")});x(new Nn(C.status,C.statusText,l.url,P))}},p.signal.addEventListener("abort",()=>{C.abort(),x(St())}),C.send(l.body)})}(i,n)};function Zn(i){if(!i||i.indexOf("://")<=0||i.indexOf("data:image/")===0||i.indexOf("blob:")===0)return!0;const n=new URL(i),s=window.location;return n.protocol===s.protocol&&n.host===s.host}function Qt(i,n,s){s[i]&&s[i].indexOf(n)!==-1||(s[i]=s[i]||[],s[i].push(n))}function wn(i,n,s){if(s&&s[i]){const l=s[i].indexOf(n);l!==-1&&s[i].splice(l,1)}}class er{constructor(n,s={}){ve(this,s),this.type=n}}class sn extends er{constructor(n,s={}){super("error",ve({error:n},s))}}class dn{on(n,s){return this._listeners=this._listeners||{},Qt(n,s,this._listeners),this}off(n,s){return wn(n,s,this._listeners),wn(n,s,this._oneTimeListeners),this}once(n,s){return s?(this._oneTimeListeners=this._oneTimeListeners||{},Qt(n,s,this._oneTimeListeners),this):new Promise(l=>this.once(n,l))}fire(n,s){typeof n=="string"&&(n=new er(n,s||{}));const l=n.type;if(this.listens(l)){n.target=this;const p=this._listeners&&this._listeners[l]?this._listeners[l].slice():[];for(const S of p)S.call(this,n);const v=this._oneTimeListeners&&this._oneTimeListeners[l]?this._oneTimeListeners[l].slice():[];for(const S of v)wn(l,S,this._oneTimeListeners),S.call(this,n);const x=this._eventedParent;x&&(ve(n,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),x.fire(n))}else n instanceof sn&&console.error(n.error);return this}listens(n){return this._listeners&&this._listeners[n]&&this._listeners[n].length>0||this._oneTimeListeners&&this._oneTimeListeners[n]&&this._oneTimeListeners[n].length>0||this._eventedParent&&this._eventedParent.listens(n)}setEventedParent(n,s){return this._eventedParent=n,this._eventedParentData=s,this}}var Ce={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sky:{type:"sky"},projection:{type:"projection"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},sky:{"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-ground-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-fog-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"sky-horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"atmosphere-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},projection:{type:{type:"enum",default:"mercator",values:{mercator:{},globe:{}}}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};const Fn=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function bn(i,n){const s={};for(const l in i)l!=="ref"&&(s[l]=i[l]);return Fn.forEach(l=>{l in n&&(s[l]=n[l])}),s}function Ot(i,n){if(Array.isArray(i)){if(!Array.isArray(n)||i.length!==n.length)return!1;for(let s=0;s<i.length;s++)if(!Ot(i[s],n[s]))return!1;return!0}if(typeof i=="object"&&i!==null&&n!==null){if(typeof n!="object"||Object.keys(i).length!==Object.keys(n).length)return!1;for(const s in i)if(!Ot(i[s],n[s]))return!1;return!0}return i===n}function Yt(i,n){i.push(n)}function Tr(i,n,s){Yt(s,{command:"addSource",args:[i,n[i]]})}function yr(i,n,s){Yt(n,{command:"removeSource",args:[i]}),s[i]=!0}function Hr(i,n,s,l){yr(i,s,l),Tr(i,n,s)}function vr(i,n,s){let l;for(l in i[s])if(Object.prototype.hasOwnProperty.call(i[s],l)&&l!=="data"&&!Ot(i[s][l],n[s][l]))return!1;for(l in n[s])if(Object.prototype.hasOwnProperty.call(n[s],l)&&l!=="data"&&!Ot(i[s][l],n[s][l]))return!1;return!0}function rr(i,n,s,l,p,v){i=i||{},n=n||{};for(const x in i)Object.prototype.hasOwnProperty.call(i,x)&&(Ot(i[x],n[x])||s.push({command:v,args:[l,x,n[x],p]}));for(const x in n)Object.prototype.hasOwnProperty.call(n,x)&&!Object.prototype.hasOwnProperty.call(i,x)&&(Ot(i[x],n[x])||s.push({command:v,args:[l,x,n[x],p]}))}function dr(i){return i.id}function fr(i,n){return i[n.id]=n,i}class Ke{constructor(n,s,l,p){this.message=(n?`${n}: `:"")+l,p&&(this.identifier=p),s!=null&&s.__line__&&(this.line=s.__line__)}}function hi(i,...n){for(const s of n)for(const l in s)i[l]=s[l];return i}class Lr extends Error{constructor(n,s){super(s),this.message=s,this.key=n}}class jr{constructor(n,s=[]){this.parent=n,this.bindings={};for(const[l,p]of s)this.bindings[l]=p}concat(n){return new jr(this,n)}get(n){if(this.bindings[n])return this.bindings[n];if(this.parent)return this.parent.get(n);throw new Error(`${n} not found in scope.`)}has(n){return!!this.bindings[n]||!!this.parent&&this.parent.has(n)}}const Pr={kind:"null"},it={kind:"number"},Ht={kind:"string"},Ut={kind:"boolean"},di={kind:"color"},Gi={kind:"object"},Xt={kind:"value"},Ys={kind:"collator"},co={kind:"formatted"},ho={kind:"padding"},Rs={kind:"resolvedImage"},ae={kind:"variableAnchorOffsetCollection"};function N(i,n){return{kind:"array",itemType:i,N:n}}function B(i){if(i.kind==="array"){const n=B(i.itemType);return typeof i.N=="number"?`array<${n}, ${i.N}>`:i.itemType.kind==="value"?"array":`array<${n}>`}return i.kind}const K=[Pr,it,Ht,Ut,di,co,Gi,N(Xt),ho,Rs,ae];function re(i,n){if(n.kind==="error")return null;if(i.kind==="array"){if(n.kind==="array"&&(n.N===0&&n.itemType.kind==="value"||!re(i.itemType,n.itemType))&&(typeof i.N!="number"||i.N===n.N))return null}else{if(i.kind===n.kind)return null;if(i.kind==="value"){for(const s of K)if(!re(s,n))return null}}return`Expected ${B(i)} but found ${B(n)} instead.`}function ye(i,n){return n.some(s=>s.kind===i.kind)}function Se(i,n){return n.some(s=>s==="null"?i===null:s==="array"?Array.isArray(i):s==="object"?i&&!Array.isArray(i)&&typeof i=="object":s===typeof i)}function ke(i,n){return i.kind==="array"&&n.kind==="array"?i.itemType.kind===n.itemType.kind&&typeof i.N=="number":i.kind===n.kind}const pe=.96422,Fe=.82521,Ge=4/29,Re=6/29,st=3*Re*Re,Mt=Re*Re*Re,Lt=Math.PI/180,In=180/Math.PI;function Jt(i){return(i%=360)<0&&(i+=360),i}function kn([i,n,s,l]){let p,v;const x=Ar((.2225045*(i=fn(i))+.7168786*(n=fn(n))+.0606169*(s=fn(s)))/1);i===n&&n===s?p=v=x:(p=Ar((.4360747*i+.3850649*n+.1430804*s)/pe),v=Ar((.0139322*i+.0971045*n+.7141733*s)/Fe));const S=116*x-16;return[S<0?0:S,500*(p-x),200*(x-v),l]}function fn(i){return i<=.04045?i/12.92:Math.pow((i+.055)/1.055,2.4)}function Ar(i){return i>Mt?Math.pow(i,1/3):i/st+Ge}function xr([i,n,s,l]){let p=(i+16)/116,v=isNaN(n)?p:p+n/500,x=isNaN(s)?p:p-s/200;return p=1*Gn(p),v=pe*Gn(v),x=Fe*Gn(x),[on(3.1338561*v-1.6168667*p-.4906146*x),on(-.9787684*v+1.9161415*p+.033454*x),on(.0719453*v-.2289914*p+1.4052427*x),l]}function on(i){return(i=i<=.00304?12.92*i:1.055*Math.pow(i,1/2.4)-.055)<0?0:i>1?1:i}function Gn(i){return i>Re?i*i*i:st*(i-Ge)}function ur(i){return parseInt(i.padEnd(2,i),16)/255}function Xr(i,n){return ni(n?i/100:i,0,1)}function ni(i,n,s){return Math.min(Math.max(n,i),s)}function Kr(i){return!i.some(Number.isNaN)}const el={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};class Rn{constructor(n,s,l,p=1,v=!0){this.r=n,this.g=s,this.b=l,this.a=p,v||(this.r*=p,this.g*=p,this.b*=p,p||this.overwriteGetter("rgb",[n,s,l,p]))}static parse(n){if(n instanceof Rn)return n;if(typeof n!="string")return;const s=function(l){if((l=l.toLowerCase().trim())==="transparent")return[0,0,0,0];const p=el[l];if(p){const[x,S,C]=p;return[x/255,S/255,C/255,1]}if(l.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(l)){const x=l.length<6?1:2;let S=1;return[ur(l.slice(S,S+=x)),ur(l.slice(S,S+=x)),ur(l.slice(S,S+=x)),ur(l.slice(S,S+x)||"ff")]}if(l.startsWith("rgb")){const x=l.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(x){const[S,C,P,M,R,F,j,G,Z,ne,oe,Pe]=x,ge=[M||" ",j||" ",ne].join("");if(ge==="  "||ge==="  /"||ge===",,"||ge===",,,"){const _e=[P,F,Z].join(""),Le=_e==="%%%"?100:_e===""?255:0;if(Le){const Ye=[ni(+C/Le,0,1),ni(+R/Le,0,1),ni(+G/Le,0,1),oe?Xr(+oe,Pe):1];if(Kr(Ye))return Ye}}return}}const v=l.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(v){const[x,S,C,P,M,R,F,j,G]=v,Z=[C||" ",M||" ",F].join("");if(Z==="  "||Z==="  /"||Z===",,"||Z===",,,"){const ne=[+S,ni(+P,0,100),ni(+R,0,100),j?Xr(+j,G):1];if(Kr(ne))return function([oe,Pe,ge,_e]){function Le(Ye){const gt=(Ye+oe/30)%12,Ft=Pe*Math.min(ge,1-ge);return ge-Ft*Math.max(-1,Math.min(gt-3,9-gt,1))}return oe=Jt(oe),Pe/=100,ge/=100,[Le(0),Le(8),Le(4),_e]}(ne)}}}(n);return s?new Rn(...s,!1):void 0}get rgb(){const{r:n,g:s,b:l,a:p}=this,v=p||1/0;return this.overwriteGetter("rgb",[n/v,s/v,l/v,p])}get hcl(){return this.overwriteGetter("hcl",function(n){const[s,l,p,v]=kn(n),x=Math.sqrt(l*l+p*p);return[Math.round(1e4*x)?Jt(Math.atan2(p,l)*In):NaN,x,s,v]}(this.rgb))}get lab(){return this.overwriteGetter("lab",kn(this.rgb))}overwriteGetter(n,s){return Object.defineProperty(this,n,{value:s}),s}toString(){const[n,s,l,p]=this.rgb;return`rgba(${[n,s,l].map(v=>Math.round(255*v)).join(",")},${p})`}}Rn.black=new Rn(0,0,0,1),Rn.white=new Rn(1,1,1,1),Rn.transparent=new Rn(0,0,0,0),Rn.red=new Rn(1,0,0,1);class Hc{constructor(n,s,l){this.sensitivity=n?s?"variant":"case":s?"accent":"base",this.locale=l,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(n,s){return this.collator.compare(n,s)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class Xc{constructor(n,s,l,p,v){this.text=n,this.image=s,this.scale=l,this.fontStack=p,this.textColor=v}}class Wi{constructor(n){this.sections=n}static fromString(n){return new Wi([new Xc(n,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(n=>n.text.length!==0||n.image&&n.image.name.length!==0)}static factory(n){return n instanceof Wi?n:Wi.fromString(n)}toString(){return this.sections.length===0?"":this.sections.map(n=>n.text).join("")}}class Ri{constructor(n){this.values=n.slice()}static parse(n){if(n instanceof Ri)return n;if(typeof n=="number")return new Ri([n,n,n,n]);if(Array.isArray(n)&&!(n.length<1||n.length>4)){for(const s of n)if(typeof s!="number")return;switch(n.length){case 1:n=[n[0],n[0],n[0],n[0]];break;case 2:n=[n[0],n[1],n[0],n[1]];break;case 3:n=[n[0],n[1],n[2],n[1]]}return new Ri(n)}}toString(){return JSON.stringify(this.values)}}const md=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class Hi{constructor(n){this.values=n.slice()}static parse(n){if(n instanceof Hi)return n;if(Array.isArray(n)&&!(n.length<1)&&n.length%2==0){for(let s=0;s<n.length;s+=2){const l=n[s],p=n[s+1];if(typeof l!="string"||!md.has(l)||!Array.isArray(p)||p.length!==2||typeof p[0]!="number"||typeof p[1]!="number")return}return new Hi(n)}}toString(){return JSON.stringify(this.values)}}class Xi{constructor(n){this.name=n.name,this.available=n.available}toString(){return this.name}static fromString(n){return n?new Xi({name:n,available:!1}):null}}function tl(i,n,s,l){return typeof i=="number"&&i>=0&&i<=255&&typeof n=="number"&&n>=0&&n<=255&&typeof s=="number"&&s>=0&&s<=255?l===void 0||typeof l=="number"&&l>=0&&l<=1?null:`Invalid rgba value [${[i,n,s,l].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof l=="number"?[i,n,s,l]:[i,n,s]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function pa(i){if(i===null||typeof i=="string"||typeof i=="boolean"||typeof i=="number"||i instanceof Rn||i instanceof Hc||i instanceof Wi||i instanceof Ri||i instanceof Hi||i instanceof Xi)return!0;if(Array.isArray(i)){for(const n of i)if(!pa(n))return!1;return!0}if(typeof i=="object"){for(const n in i)if(!pa(i[n]))return!1;return!0}return!1}function Or(i){if(i===null)return Pr;if(typeof i=="string")return Ht;if(typeof i=="boolean")return Ut;if(typeof i=="number")return it;if(i instanceof Rn)return di;if(i instanceof Hc)return Ys;if(i instanceof Wi)return co;if(i instanceof Ri)return ho;if(i instanceof Hi)return ae;if(i instanceof Xi)return Rs;if(Array.isArray(i)){const n=i.length;let s;for(const l of i){const p=Or(l);if(s){if(s===p)continue;s=Xt;break}s=p}return N(s||Xt,n)}return Gi}function nl(i){const n=typeof i;return i===null?"":n==="string"||n==="number"||n==="boolean"?String(i):i instanceof Rn||i instanceof Wi||i instanceof Ri||i instanceof Hi||i instanceof Xi?i.toString():JSON.stringify(i)}class ls{constructor(n,s){this.type=n,this.value=s}static parse(n,s){if(n.length!==2)return s.error(`'literal' expression requires exactly one argument, but found ${n.length-1} instead.`);if(!pa(n[1]))return s.error("invalid value");const l=n[1];let p=Or(l);const v=s.expectedType;return p.kind!=="array"||p.N!==0||!v||v.kind!=="array"||typeof v.N=="number"&&v.N!==0||(p=v),new ls(p,l)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}class Er{constructor(n){this.name="ExpressionEvaluationError",this.message=n}toJSON(){return this.message}}const rl={string:Ht,number:it,boolean:Ut,object:Gi};class Ls{constructor(n,s){this.type=n,this.args=s}static parse(n,s){if(n.length<2)return s.error("Expected at least one argument.");let l,p=1;const v=n[0];if(v==="array"){let S,C;if(n.length>2){const P=n[1];if(typeof P!="string"||!(P in rl)||P==="object")return s.error('The item type argument of "array" must be one of string, number, boolean',1);S=rl[P],p++}else S=Xt;if(n.length>3){if(n[2]!==null&&(typeof n[2]!="number"||n[2]<0||n[2]!==Math.floor(n[2])))return s.error('The length argument to "array" must be a positive integer literal',2);C=n[2],p++}l=N(S,C)}else{if(!rl[v])throw new Error(`Types doesn't contain name = ${v}`);l=rl[v]}const x=[];for(;p<n.length;p++){const S=s.parse(n[p],p,Xt);if(!S)return null;x.push(S)}return new Ls(l,x)}evaluate(n){for(let s=0;s<this.args.length;s++){const l=this.args[s].evaluate(n);if(!re(this.type,Or(l)))return l;if(s===this.args.length-1)throw new Er(`Expected value to be of type ${B(this.type)}, but found ${B(Or(l))} instead.`)}throw new Error}eachChild(n){this.args.forEach(n)}outputDefined(){return this.args.every(n=>n.outputDefined())}}const Bu={"to-boolean":Ut,"to-color":di,"to-number":it,"to-string":Ht};class Li{constructor(n,s){this.type=n,this.args=s}static parse(n,s){if(n.length<2)return s.error("Expected at least one argument.");const l=n[0];if(!Bu[l])throw new Error(`Can't parse ${l} as it is not part of the known types`);if((l==="to-boolean"||l==="to-string")&&n.length!==2)return s.error("Expected one argument.");const p=Bu[l],v=[];for(let x=1;x<n.length;x++){const S=s.parse(n[x],x,Xt);if(!S)return null;v.push(S)}return new Li(p,v)}evaluate(n){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(n);case"color":{let s,l;for(const p of this.args){if(s=p.evaluate(n),l=null,s instanceof Rn)return s;if(typeof s=="string"){const v=n.parseColor(s);if(v)return v}else if(Array.isArray(s)&&(l=s.length<3||s.length>4?`Invalid rbga value ${JSON.stringify(s)}: expected an array containing either three or four numeric values.`:tl(s[0],s[1],s[2],s[3]),!l))return new Rn(s[0]/255,s[1]/255,s[2]/255,s[3])}throw new Er(l||`Could not parse color from value '${typeof s=="string"?s:JSON.stringify(s)}'`)}case"padding":{let s;for(const l of this.args){s=l.evaluate(n);const p=Ri.parse(s);if(p)return p}throw new Er(`Could not parse padding from value '${typeof s=="string"?s:JSON.stringify(s)}'`)}case"variableAnchorOffsetCollection":{let s;for(const l of this.args){s=l.evaluate(n);const p=Hi.parse(s);if(p)return p}throw new Er(`Could not parse variableAnchorOffsetCollection from value '${typeof s=="string"?s:JSON.stringify(s)}'`)}case"number":{let s=null;for(const l of this.args){if(s=l.evaluate(n),s===null)return 0;const p=Number(s);if(!isNaN(p))return p}throw new Er(`Could not convert ${JSON.stringify(s)} to number.`)}case"formatted":return Wi.fromString(nl(this.args[0].evaluate(n)));case"resolvedImage":return Xi.fromString(nl(this.args[0].evaluate(n)));default:return nl(this.args[0].evaluate(n))}}eachChild(n){this.args.forEach(n)}outputDefined(){return this.args.every(n=>n.outputDefined())}}const gd=["Unknown","Point","LineString","Polygon"];class Nu{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?gd[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(n){let s=this._parseColorCache[n];return s||(s=this._parseColorCache[n]=Rn.parse(n)),s}}class No{constructor(n,s,l=[],p,v=new jr,x=[]){this.registry=n,this.path=l,this.key=l.map(S=>`[${S}]`).join(""),this.scope=v,this.errors=x,this.expectedType=p,this._isConstant=s}parse(n,s,l,p,v={}){return s?this.concat(s,l,p)._parse(n,v):this._parse(n,v)}_parse(n,s){function l(p,v,x){return x==="assert"?new Ls(v,[p]):x==="coerce"?new Li(v,[p]):p}if(n!==null&&typeof n!="string"&&typeof n!="boolean"&&typeof n!="number"||(n=["literal",n]),Array.isArray(n)){if(n.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const p=n[0];if(typeof p!="string")return this.error(`Expression name must be a string, but found ${typeof p} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const v=this.registry[p];if(v){let x=v.parse(n,this);if(!x)return null;if(this.expectedType){const S=this.expectedType,C=x.type;if(S.kind!=="string"&&S.kind!=="number"&&S.kind!=="boolean"&&S.kind!=="object"&&S.kind!=="array"||C.kind!=="value")if(S.kind!=="color"&&S.kind!=="formatted"&&S.kind!=="resolvedImage"||C.kind!=="value"&&C.kind!=="string")if(S.kind!=="padding"||C.kind!=="value"&&C.kind!=="number"&&C.kind!=="array")if(S.kind!=="variableAnchorOffsetCollection"||C.kind!=="value"&&C.kind!=="array"){if(this.checkSubtype(S,C))return null}else x=l(x,S,s.typeAnnotation||"coerce");else x=l(x,S,s.typeAnnotation||"coerce");else x=l(x,S,s.typeAnnotation||"coerce");else x=l(x,S,s.typeAnnotation||"assert")}if(!(x instanceof ls)&&x.type.kind!=="resolvedImage"&&this._isConstant(x)){const S=new Nu;try{x=new ls(x.type,x.evaluate(S))}catch(C){return this.error(C.message),null}}return x}return this.error(`Unknown expression "${p}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(n===void 0?"'undefined' value invalid. Use null instead.":typeof n=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof n} instead.`)}concat(n,s,l){const p=typeof n=="number"?this.path.concat(n):this.path,v=l?this.scope.concat(l):this.scope;return new No(this.registry,this._isConstant,p,s||null,v,this.errors)}error(n,...s){const l=`${this.key}${s.map(p=>`[${p}]`).join("")}`;this.errors.push(new Lr(l,n))}checkSubtype(n,s){const l=re(n,s);return l&&this.error(l),l}}class fo{constructor(n,s){this.type=s.type,this.bindings=[].concat(n),this.result=s}evaluate(n){return this.result.evaluate(n)}eachChild(n){for(const s of this.bindings)n(s[1]);n(this.result)}static parse(n,s){if(n.length<4)return s.error(`Expected at least 3 arguments, but found ${n.length-1} instead.`);const l=[];for(let v=1;v<n.length-1;v+=2){const x=n[v];if(typeof x!="string")return s.error(`Expected string, but found ${typeof x} instead.`,v);if(/[^a-zA-Z0-9_]/.test(x))return s.error("Variable names must contain only alphanumeric characters or '_'.",v);const S=s.parse(n[v+1],v+1);if(!S)return null;l.push([x,S])}const p=s.parse(n[n.length-1],n.length-1,s.expectedType,l);return p?new fo(l,p):null}outputDefined(){return this.result.outputDefined()}}class Pn{constructor(n,s){this.type=s.type,this.name=n,this.boundExpression=s}static parse(n,s){if(n.length!==2||typeof n[1]!="string")return s.error("'var' expression requires exactly one string literal argument.");const l=n[1];return s.scope.has(l)?new Pn(l,s.scope.get(l)):s.error(`Unknown variable "${l}". Make sure "${l}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(n){return this.boundExpression.evaluate(n)}eachChild(){}outputDefined(){return!1}}class Kc{constructor(n,s,l){this.type=n,this.index=s,this.input=l}static parse(n,s){if(n.length!==3)return s.error(`Expected 2 arguments, but found ${n.length-1} instead.`);const l=s.parse(n[1],1,it),p=s.parse(n[2],2,N(s.expectedType||Xt));return l&&p?new Kc(p.type.itemType,l,p):null}evaluate(n){const s=this.index.evaluate(n),l=this.input.evaluate(n);if(s<0)throw new Er(`Array index out of bounds: ${s} < 0.`);if(s>=l.length)throw new Er(`Array index out of bounds: ${s} > ${l.length-1}.`);if(s!==Math.floor(s))throw new Er(`Array index must be an integer, but found ${s} instead.`);return l[s]}eachChild(n){n(this.index),n(this.input)}outputDefined(){return!1}}class Uu{constructor(n,s){this.type=Ut,this.needle=n,this.haystack=s}static parse(n,s){if(n.length!==3)return s.error(`Expected 2 arguments, but found ${n.length-1} instead.`);const l=s.parse(n[1],1,Xt),p=s.parse(n[2],2,Xt);return l&&p?ye(l.type,[Ut,Ht,it,Pr,Xt])?new Uu(l,p):s.error(`Expected first argument to be of type boolean, string, number or null, but found ${B(l.type)} instead`):null}evaluate(n){const s=this.needle.evaluate(n),l=this.haystack.evaluate(n);if(!l)return!1;if(!Se(s,["boolean","string","number","null"]))throw new Er(`Expected first argument to be of type boolean, string, number or null, but found ${B(Or(s))} instead.`);if(!Se(l,["string","array"]))throw new Er(`Expected second argument to be of type array or string, but found ${B(Or(l))} instead.`);return l.indexOf(s)>=0}eachChild(n){n(this.needle),n(this.haystack)}outputDefined(){return!0}}class Uo{constructor(n,s,l){this.type=it,this.needle=n,this.haystack=s,this.fromIndex=l}static parse(n,s){if(n.length<=2||n.length>=5)return s.error(`Expected 3 or 4 arguments, but found ${n.length-1} instead.`);const l=s.parse(n[1],1,Xt),p=s.parse(n[2],2,Xt);if(!l||!p)return null;if(!ye(l.type,[Ut,Ht,it,Pr,Xt]))return s.error(`Expected first argument to be of type boolean, string, number or null, but found ${B(l.type)} instead`);if(n.length===4){const v=s.parse(n[3],3,it);return v?new Uo(l,p,v):null}return new Uo(l,p)}evaluate(n){const s=this.needle.evaluate(n),l=this.haystack.evaluate(n);if(!Se(s,["boolean","string","number","null"]))throw new Er(`Expected first argument to be of type boolean, string, number or null, but found ${B(Or(s))} instead.`);let p;if(this.fromIndex&&(p=this.fromIndex.evaluate(n)),Se(l,["string"])){const v=l.indexOf(s,p);return v===-1?-1:[...l.slice(0,v)].length}if(Se(l,["array"]))return l.indexOf(s,p);throw new Er(`Expected second argument to be of type array or string, but found ${B(Or(l))} instead.`)}eachChild(n){n(this.needle),n(this.haystack),this.fromIndex&&n(this.fromIndex)}outputDefined(){return!1}}class $l{constructor(n,s,l,p,v,x){this.inputType=n,this.type=s,this.input=l,this.cases=p,this.outputs=v,this.otherwise=x}static parse(n,s){if(n.length<5)return s.error(`Expected at least 4 arguments, but found only ${n.length-1}.`);if(n.length%2!=1)return s.error("Expected an even number of arguments.");let l,p;s.expectedType&&s.expectedType.kind!=="value"&&(p=s.expectedType);const v={},x=[];for(let P=2;P<n.length-1;P+=2){let M=n[P];const R=n[P+1];Array.isArray(M)||(M=[M]);const F=s.concat(P);if(M.length===0)return F.error("Expected at least one branch label.");for(const G of M){if(typeof G!="number"&&typeof G!="string")return F.error("Branch labels must be numbers or strings.");if(typeof G=="number"&&Math.abs(G)>Number.MAX_SAFE_INTEGER)return F.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof G=="number"&&Math.floor(G)!==G)return F.error("Numeric branch labels must be integer values.");if(l){if(F.checkSubtype(l,Or(G)))return null}else l=Or(G);if(v[String(G)]!==void 0)return F.error("Branch labels must be unique.");v[String(G)]=x.length}const j=s.parse(R,P,p);if(!j)return null;p=p||j.type,x.push(j)}const S=s.parse(n[1],1,Xt);if(!S)return null;const C=s.parse(n[n.length-1],n.length-1,p);return C?S.type.kind!=="value"&&s.concat(1).checkSubtype(l,S.type)?null:new $l(l,p,S,v,x,C):null}evaluate(n){const s=this.input.evaluate(n);return(Or(s)===this.inputType&&this.outputs[this.cases[s]]||this.otherwise).evaluate(n)}eachChild(n){n(this.input),this.outputs.forEach(n),n(this.otherwise)}outputDefined(){return this.outputs.every(n=>n.outputDefined())&&this.otherwise.outputDefined()}}class po{constructor(n,s,l){this.type=n,this.branches=s,this.otherwise=l}static parse(n,s){if(n.length<4)return s.error(`Expected at least 3 arguments, but found only ${n.length-1}.`);if(n.length%2!=0)return s.error("Expected an odd number of arguments.");let l;s.expectedType&&s.expectedType.kind!=="value"&&(l=s.expectedType);const p=[];for(let x=1;x<n.length-1;x+=2){const S=s.parse(n[x],x,Ut);if(!S)return null;const C=s.parse(n[x+1],x+1,l);if(!C)return null;p.push([S,C]),l=l||C.type}const v=s.parse(n[n.length-1],n.length-1,l);if(!v)return null;if(!l)throw new Error("Can't infer output type");return new po(l,p,v)}evaluate(n){for(const[s,l]of this.branches)if(s.evaluate(n))return l.evaluate(n);return this.otherwise.evaluate(n)}eachChild(n){for(const[s,l]of this.branches)n(s),n(l);n(this.otherwise)}outputDefined(){return this.branches.every(([n,s])=>s.outputDefined())&&this.otherwise.outputDefined()}}class il{constructor(n,s,l,p){this.type=n,this.input=s,this.beginIndex=l,this.endIndex=p}static parse(n,s){if(n.length<=2||n.length>=5)return s.error(`Expected 3 or 4 arguments, but found ${n.length-1} instead.`);const l=s.parse(n[1],1,Xt),p=s.parse(n[2],2,it);if(!l||!p)return null;if(!ye(l.type,[N(Xt),Ht,Xt]))return s.error(`Expected first argument to be of type array or string, but found ${B(l.type)} instead`);if(n.length===4){const v=s.parse(n[3],3,it);return v?new il(l.type,l,p,v):null}return new il(l.type,l,p)}evaluate(n){const s=this.input.evaluate(n),l=this.beginIndex.evaluate(n);let p;if(this.endIndex&&(p=this.endIndex.evaluate(n)),Se(s,["string"]))return[...s].slice(l,p).join("");if(Se(s,["array"]))return s.slice(l,p);throw new Er(`Expected first argument to be of type array or string, but found ${B(Or(s))} instead.`)}eachChild(n){n(this.input),n(this.beginIndex),this.endIndex&&n(this.endIndex)}outputDefined(){return!1}}function Vl(i,n){const s=i.length-1;let l,p,v=0,x=s,S=0;for(;v<=x;)if(S=Math.floor((v+x)/2),l=i[S],p=i[S+1],l<=n){if(S===s||n<p)return S;v=S+1}else{if(!(l>n))throw new Er("Input is not a number.");x=S-1}return 0}class sl{constructor(n,s,l){this.type=n,this.input=s,this.labels=[],this.outputs=[];for(const[p,v]of l)this.labels.push(p),this.outputs.push(v)}static parse(n,s){if(n.length-1<4)return s.error(`Expected at least 4 arguments, but found only ${n.length-1}.`);if((n.length-1)%2!=0)return s.error("Expected an even number of arguments.");const l=s.parse(n[1],1,it);if(!l)return null;const p=[];let v=null;s.expectedType&&s.expectedType.kind!=="value"&&(v=s.expectedType);for(let x=1;x<n.length;x+=2){const S=x===1?-1/0:n[x],C=n[x+1],P=x,M=x+1;if(typeof S!="number")return s.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',P);if(p.length&&p[p.length-1][0]>=S)return s.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',P);const R=s.parse(C,M,v);if(!R)return null;v=v||R.type,p.push([S,R])}return new sl(v,l,p)}evaluate(n){const s=this.labels,l=this.outputs;if(s.length===1)return l[0].evaluate(n);const p=this.input.evaluate(n);if(p<=s[0])return l[0].evaluate(n);const v=s.length;return p>=s[v-1]?l[v-1].evaluate(n):l[Vl(s,p)].evaluate(n)}eachChild(n){n(this.input);for(const s of this.outputs)n(s)}outputDefined(){return this.outputs.every(n=>n.outputDefined())}}function Yc(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var _d=Jc;function Jc(i,n,s,l){this.cx=3*i,this.bx=3*(s-i)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*n,this.by=3*(l-n)-this.cy,this.ay=1-this.cy-this.by,this.p1x=i,this.p1y=n,this.p2x=s,this.p2y=l}Jc.prototype={sampleCurveX:function(i){return((this.ax*i+this.bx)*i+this.cx)*i},sampleCurveY:function(i){return((this.ay*i+this.by)*i+this.cy)*i},sampleCurveDerivativeX:function(i){return(3*this.ax*i+2*this.bx)*i+this.cx},solveCurveX:function(i,n){if(n===void 0&&(n=1e-6),i<0)return 0;if(i>1)return 1;for(var s=i,l=0;l<8;l++){var p=this.sampleCurveX(s)-i;if(Math.abs(p)<n)return s;var v=this.sampleCurveDerivativeX(s);if(Math.abs(v)<1e-6)break;s-=p/v}var x=0,S=1;for(s=i,l=0;l<20&&(p=this.sampleCurveX(s),!(Math.abs(p-i)<n));l++)i>p?x=s:S=s,s=.5*(S-x)+x;return s},solve:function(i,n){return this.sampleCurveY(this.solveCurveX(i,n))}};var yd=Yc(_d);function ma(i,n,s){return i+s*(n-i)}function ql(i,n,s){return i.map((l,p)=>ma(l,n[p],s))}const Oi={number:ma,color:function(i,n,s,l="rgb"){switch(l){case"rgb":{const[p,v,x,S]=ql(i.rgb,n.rgb,s);return new Rn(p,v,x,S,!1)}case"hcl":{const[p,v,x,S]=i.hcl,[C,P,M,R]=n.hcl;let F,j;if(isNaN(p)||isNaN(C))isNaN(p)?isNaN(C)?F=NaN:(F=C,x!==1&&x!==0||(j=P)):(F=p,M!==1&&M!==0||(j=v));else{let Pe=C-p;C>p&&Pe>180?Pe-=360:C<p&&p-C>180&&(Pe+=360),F=p+s*Pe}const[G,Z,ne,oe]=function([Pe,ge,_e,Le]){return Pe=isNaN(Pe)?0:Pe*Lt,xr([_e,Math.cos(Pe)*ge,Math.sin(Pe)*ge,Le])}([F,j??ma(v,P,s),ma(x,M,s),ma(S,R,s)]);return new Rn(G,Z,ne,oe,!1)}case"lab":{const[p,v,x,S]=xr(ql(i.lab,n.lab,s));return new Rn(p,v,x,S,!1)}}},array:ql,padding:function(i,n,s){return new Ri(ql(i.values,n.values,s))},variableAnchorOffsetCollection:function(i,n,s){const l=i.values,p=n.values;if(l.length!==p.length)throw new Er(`Cannot interpolate values of different length. from: ${i.toString()}, to: ${n.toString()}`);const v=[];for(let x=0;x<l.length;x+=2){if(l[x]!==p[x])throw new Er(`Cannot interpolate values containing mismatched anchors. from[${x}]: ${l[x]}, to[${x}]: ${p[x]}`);v.push(l[x]);const[S,C]=l[x+1],[P,M]=p[x+1];v.push([ma(S,P,s),ma(C,M,s)])}return new Hi(v)}};class Ei{constructor(n,s,l,p,v){this.type=n,this.operator=s,this.interpolation=l,this.input=p,this.labels=[],this.outputs=[];for(const[x,S]of v)this.labels.push(x),this.outputs.push(S)}static interpolationFactor(n,s,l,p){let v=0;if(n.name==="exponential")v=ju(s,n.base,l,p);else if(n.name==="linear")v=ju(s,1,l,p);else if(n.name==="cubic-bezier"){const x=n.controlPoints;v=new yd(x[0],x[1],x[2],x[3]).solve(ju(s,1,l,p))}return v}static parse(n,s){let[l,p,v,...x]=n;if(!Array.isArray(p)||p.length===0)return s.error("Expected an interpolation type expression.",1);if(p[0]==="linear")p={name:"linear"};else if(p[0]==="exponential"){const P=p[1];if(typeof P!="number")return s.error("Exponential interpolation requires a numeric base.",1,1);p={name:"exponential",base:P}}else{if(p[0]!=="cubic-bezier")return s.error(`Unknown interpolation type ${String(p[0])}`,1,0);{const P=p.slice(1);if(P.length!==4||P.some(M=>typeof M!="number"||M<0||M>1))return s.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);p={name:"cubic-bezier",controlPoints:P}}}if(n.length-1<4)return s.error(`Expected at least 4 arguments, but found only ${n.length-1}.`);if((n.length-1)%2!=0)return s.error("Expected an even number of arguments.");if(v=s.parse(v,2,it),!v)return null;const S=[];let C=null;l==="interpolate-hcl"||l==="interpolate-lab"?C=di:s.expectedType&&s.expectedType.kind!=="value"&&(C=s.expectedType);for(let P=0;P<x.length;P+=2){const M=x[P],R=x[P+1],F=P+3,j=P+4;if(typeof M!="number")return s.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',F);if(S.length&&S[S.length-1][0]>=M)return s.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',F);const G=s.parse(R,j,C);if(!G)return null;C=C||G.type,S.push([M,G])}return ke(C,it)||ke(C,di)||ke(C,ho)||ke(C,ae)||ke(C,N(it))?new Ei(C,l,p,v,S):s.error(`Type ${B(C)} is not interpolatable.`)}evaluate(n){const s=this.labels,l=this.outputs;if(s.length===1)return l[0].evaluate(n);const p=this.input.evaluate(n);if(p<=s[0])return l[0].evaluate(n);const v=s.length;if(p>=s[v-1])return l[v-1].evaluate(n);const x=Vl(s,p),S=Ei.interpolationFactor(this.interpolation,p,s[x],s[x+1]),C=l[x].evaluate(n),P=l[x+1].evaluate(n);switch(this.operator){case"interpolate":return Oi[this.type.kind](C,P,S);case"interpolate-hcl":return Oi.color(C,P,S,"hcl");case"interpolate-lab":return Oi.color(C,P,S,"lab")}}eachChild(n){n(this.input);for(const s of this.outputs)n(s)}outputDefined(){return this.outputs.every(n=>n.outputDefined())}}function ju(i,n,s,l){const p=l-s,v=i-s;return p===0?0:n===1?v/p:(Math.pow(n,v)-1)/(Math.pow(n,p)-1)}class $u{constructor(n,s){this.type=n,this.args=s}static parse(n,s){if(n.length<2)return s.error("Expectected at least one argument.");let l=null;const p=s.expectedType;p&&p.kind!=="value"&&(l=p);const v=[];for(const S of n.slice(1)){const C=s.parse(S,1+v.length,l,void 0,{typeAnnotation:"omit"});if(!C)return null;l=l||C.type,v.push(C)}if(!l)throw new Error("No output type");const x=p&&v.some(S=>re(p,S.type));return new $u(x?Xt:l,v)}evaluate(n){let s,l=null,p=0;for(const v of this.args)if(p++,l=v.evaluate(n),l&&l instanceof Xi&&!l.available&&(s||(s=l.name),l=null,p===this.args.length&&(l=s)),l!==null)break;return l}eachChild(n){this.args.forEach(n)}outputDefined(){return this.args.every(n=>n.outputDefined())}}function Vu(i,n){return i==="=="||i==="!="?n.kind==="boolean"||n.kind==="string"||n.kind==="number"||n.kind==="null"||n.kind==="value":n.kind==="string"||n.kind==="number"||n.kind==="value"}function vd(i,n,s,l){return l.compare(n,s)===0}function jo(i,n,s){const l=i!=="=="&&i!=="!=";return class m5{constructor(v,x,S){this.type=Ut,this.lhs=v,this.rhs=x,this.collator=S,this.hasUntypedArgument=v.type.kind==="value"||x.type.kind==="value"}static parse(v,x){if(v.length!==3&&v.length!==4)return x.error("Expected two or three arguments.");const S=v[0];let C=x.parse(v[1],1,Xt);if(!C)return null;if(!Vu(S,C.type))return x.concat(1).error(`"${S}" comparisons are not supported for type '${B(C.type)}'.`);let P=x.parse(v[2],2,Xt);if(!P)return null;if(!Vu(S,P.type))return x.concat(2).error(`"${S}" comparisons are not supported for type '${B(P.type)}'.`);if(C.type.kind!==P.type.kind&&C.type.kind!=="value"&&P.type.kind!=="value")return x.error(`Cannot compare types '${B(C.type)}' and '${B(P.type)}'.`);l&&(C.type.kind==="value"&&P.type.kind!=="value"?C=new Ls(P.type,[C]):C.type.kind!=="value"&&P.type.kind==="value"&&(P=new Ls(C.type,[P])));let M=null;if(v.length===4){if(C.type.kind!=="string"&&P.type.kind!=="string"&&C.type.kind!=="value"&&P.type.kind!=="value")return x.error("Cannot use collator to compare non-string types.");if(M=x.parse(v[3],3,Ys),!M)return null}return new m5(C,P,M)}evaluate(v){const x=this.lhs.evaluate(v),S=this.rhs.evaluate(v);if(l&&this.hasUntypedArgument){const C=Or(x),P=Or(S);if(C.kind!==P.kind||C.kind!=="string"&&C.kind!=="number")throw new Er(`Expected arguments for "${i}" to be (string, string) or (number, number), but found (${C.kind}, ${P.kind}) instead.`)}if(this.collator&&!l&&this.hasUntypedArgument){const C=Or(x),P=Or(S);if(C.kind!=="string"||P.kind!=="string")return n(v,x,S)}return this.collator?s(v,x,S,this.collator.evaluate(v)):n(v,x,S)}eachChild(v){v(this.lhs),v(this.rhs),this.collator&&v(this.collator)}outputDefined(){return!0}}}const ip=jo("==",function(i,n,s){return n===s},vd),xd=jo("!=",function(i,n,s){return n!==s},function(i,n,s,l){return!vd(0,n,s,l)}),wd=jo("<",function(i,n,s){return n<s},function(i,n,s,l){return l.compare(n,s)<0}),sp=jo(">",function(i,n,s){return n>s},function(i,n,s,l){return l.compare(n,s)>0}),op=jo("<=",function(i,n,s){return n<=s},function(i,n,s,l){return l.compare(n,s)<=0}),or=jo(">=",function(i,n,s){return n>=s},function(i,n,s,l){return l.compare(n,s)>=0});class Wn{constructor(n,s,l){this.type=Ys,this.locale=l,this.caseSensitive=n,this.diacriticSensitive=s}static parse(n,s){if(n.length!==2)return s.error("Expected one argument.");const l=n[1];if(typeof l!="object"||Array.isArray(l))return s.error("Collator options argument must be an object.");const p=s.parse(l["case-sensitive"]!==void 0&&l["case-sensitive"],1,Ut);if(!p)return null;const v=s.parse(l["diacritic-sensitive"]!==void 0&&l["diacritic-sensitive"],1,Ut);if(!v)return null;let x=null;return l.locale&&(x=s.parse(l.locale,1,Ht),!x)?null:new Wn(p,v,x)}evaluate(n){return new Hc(this.caseSensitive.evaluate(n),this.diacriticSensitive.evaluate(n),this.locale?this.locale.evaluate(n):null)}eachChild(n){n(this.caseSensitive),n(this.diacriticSensitive),this.locale&&n(this.locale)}outputDefined(){return!1}}class Qc{constructor(n,s,l,p,v){this.type=Ht,this.number=n,this.locale=s,this.currency=l,this.minFractionDigits=p,this.maxFractionDigits=v}static parse(n,s){if(n.length!==3)return s.error("Expected two arguments.");const l=s.parse(n[1],1,it);if(!l)return null;const p=n[2];if(typeof p!="object"||Array.isArray(p))return s.error("NumberFormat options argument must be an object.");let v=null;if(p.locale&&(v=s.parse(p.locale,1,Ht),!v))return null;let x=null;if(p.currency&&(x=s.parse(p.currency,1,Ht),!x))return null;let S=null;if(p["min-fraction-digits"]&&(S=s.parse(p["min-fraction-digits"],1,it),!S))return null;let C=null;return p["max-fraction-digits"]&&(C=s.parse(p["max-fraction-digits"],1,it),!C)?null:new Qc(l,v,x,S,C)}evaluate(n){return new Intl.NumberFormat(this.locale?this.locale.evaluate(n):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(n):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(n):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(n):void 0}).format(this.number.evaluate(n))}eachChild(n){n(this.number),this.locale&&n(this.locale),this.currency&&n(this.currency),this.minFractionDigits&&n(this.minFractionDigits),this.maxFractionDigits&&n(this.maxFractionDigits)}outputDefined(){return!1}}class qu{constructor(n){this.type=co,this.sections=n}static parse(n,s){if(n.length<2)return s.error("Expected at least one argument.");const l=n[1];if(!Array.isArray(l)&&typeof l=="object")return s.error("First argument must be an image or text section.");const p=[];let v=!1;for(let x=1;x<=n.length-1;++x){const S=n[x];if(v&&typeof S=="object"&&!Array.isArray(S)){v=!1;let C=null;if(S["font-scale"]&&(C=s.parse(S["font-scale"],1,it),!C))return null;let P=null;if(S["text-font"]&&(P=s.parse(S["text-font"],1,N(Ht)),!P))return null;let M=null;if(S["text-color"]&&(M=s.parse(S["text-color"],1,di),!M))return null;const R=p[p.length-1];R.scale=C,R.font=P,R.textColor=M}else{const C=s.parse(n[x],1,Xt);if(!C)return null;const P=C.type.kind;if(P!=="string"&&P!=="value"&&P!=="null"&&P!=="resolvedImage")return s.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");v=!0,p.push({content:C,scale:null,font:null,textColor:null})}}return new qu(p)}evaluate(n){return new Wi(this.sections.map(s=>{const l=s.content.evaluate(n);return Or(l)===Rs?new Xc("",l,null,null,null):new Xc(nl(l),null,s.scale?s.scale.evaluate(n):null,s.font?s.font.evaluate(n).join(","):null,s.textColor?s.textColor.evaluate(n):null)}))}eachChild(n){for(const s of this.sections)n(s.content),s.scale&&n(s.scale),s.font&&n(s.font),s.textColor&&n(s.textColor)}outputDefined(){return!1}}class eh{constructor(n){this.type=Rs,this.input=n}static parse(n,s){if(n.length!==2)return s.error("Expected two arguments.");const l=s.parse(n[1],1,Ht);return l?new eh(l):s.error("No image name provided.")}evaluate(n){const s=this.input.evaluate(n),l=Xi.fromString(s);return l&&n.availableImages&&(l.available=n.availableImages.indexOf(s)>-1),l}eachChild(n){n(this.input)}outputDefined(){return!1}}class th{constructor(n){this.type=it,this.input=n}static parse(n,s){if(n.length!==2)return s.error(`Expected 1 argument, but found ${n.length-1} instead.`);const l=s.parse(n[1],1);return l?l.type.kind!=="array"&&l.type.kind!=="string"&&l.type.kind!=="value"?s.error(`Expected argument of type string or array, but found ${B(l.type)} instead.`):new th(l):null}evaluate(n){const s=this.input.evaluate(n);if(typeof s=="string")return[...s].length;if(Array.isArray(s))return s.length;throw new Er(`Expected value to be of type string or array, but found ${B(Or(s))} instead.`)}eachChild(n){n(this.input)}outputDefined(){return!1}}const Js=8192;function ap(i,n){const s=(180+i[0])/360,l=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+i[1]*Math.PI/360)))/360,p=Math.pow(2,n.z);return[Math.round(s*p*Js),Math.round(l*p*Js)]}function Zu(i,n){const s=Math.pow(2,n.z);return[(p=(i[0]/Js+n.x)/s,360*p-180),(l=(i[1]/Js+n.y)/s,360/Math.PI*Math.atan(Math.exp((180-360*l)*Math.PI/180))-90)];var l,p}function ga(i,n){i[0]=Math.min(i[0],n[0]),i[1]=Math.min(i[1],n[1]),i[2]=Math.max(i[2],n[0]),i[3]=Math.max(i[3],n[1])}function pr(i,n){return!(i[0]<=n[0]||i[2]>=n[2]||i[1]<=n[1]||i[3]>=n[3])}function Mn(i,n,s){const l=i[0]-n[0],p=i[1]-n[1],v=i[0]-s[0],x=i[1]-s[1];return l*x-v*p==0&&l*v<=0&&p*x<=0}function Qs(i,n,s,l){return(p=[l[0]-s[0],l[1]-s[1]])[0]*(v=[n[0]-i[0],n[1]-i[1]])[1]-p[1]*v[0]!=0&&!(!rh(i,n,s,l)||!rh(s,l,i,n));var p,v}function bd(i,n,s){for(const l of s)for(let p=0;p<l.length-1;++p)if(Qs(i,n,l[p],l[p+1]))return!0;return!1}function $o(i,n,s=!1){let l=!1;for(const S of n)for(let C=0;C<S.length-1;C++){if(Mn(i,S[C],S[C+1]))return s;(v=S[C])[1]>(p=i)[1]!=(x=S[C+1])[1]>p[1]&&p[0]<(x[0]-v[0])*(p[1]-v[1])/(x[1]-v[1])+v[0]&&(l=!l)}var p,v,x;return l}function us(i,n){for(const s of n)if($o(i,s))return!0;return!1}function nh(i,n){for(const s of i)if(!$o(s,n))return!1;for(let s=0;s<i.length-1;++s)if(bd(i[s],i[s+1],n))return!1;return!0}function Sd(i,n){for(const s of n)if(nh(i,s))return!0;return!1}function rh(i,n,s,l){const p=l[0]-s[0],v=l[1]-s[1],x=(i[0]-s[0])*v-p*(i[1]-s[1]),S=(n[0]-s[0])*v-p*(n[1]-s[1]);return x>0&&S<0||x<0&&S>0}function Gu(i,n,s){const l=[];for(let p=0;p<i.length;p++){const v=[];for(let x=0;x<i[p].length;x++){const S=ap(i[p][x],s);ga(n,S),v.push(S)}l.push(v)}return l}function ih(i,n,s){const l=[];for(let p=0;p<i.length;p++){const v=Gu(i[p],n,s);l.push(v)}return l}function sh(i,n,s,l){if(i[0]<s[0]||i[0]>s[2]){const p=.5*l;let v=i[0]-s[0]>p?-l:s[0]-i[0]>p?l:0;v===0&&(v=i[0]-s[2]>p?-l:s[2]-i[0]>p?l:0),i[0]+=v}ga(n,i)}function Fi(i,n,s,l){const p=Math.pow(2,l.z)*Js,v=[l.x*Js,l.y*Js],x=[];for(const S of i)for(const C of S){const P=[C.x+v[0],C.y+v[1]];sh(P,n,s,p),x.push(P)}return x}function Td(i,n,s,l){const p=Math.pow(2,l.z)*Js,v=[l.x*Js,l.y*Js],x=[];for(const C of i){const P=[];for(const M of C){const R=[M.x+v[0],M.y+v[1]];ga(n,R),P.push(R)}x.push(P)}if(n[2]-n[0]<=p/2){(S=n)[0]=S[1]=1/0,S[2]=S[3]=-1/0;for(const C of x)for(const P of C)sh(P,n,s,p)}var S;return x}class Yr{constructor(n,s){this.type=Ut,this.geojson=n,this.geometries=s}static parse(n,s){if(n.length!==2)return s.error(`'within' expression requires exactly one argument, but found ${n.length-1} instead.`);if(pa(n[1])){const l=n[1];if(l.type==="FeatureCollection"){const p=[];for(const v of l.features){const{type:x,coordinates:S}=v.geometry;x==="Polygon"&&p.push(S),x==="MultiPolygon"&&p.push(...S)}if(p.length)return new Yr(l,{type:"MultiPolygon",coordinates:p})}else if(l.type==="Feature"){const p=l.geometry.type;if(p==="Polygon"||p==="MultiPolygon")return new Yr(l,l.geometry)}else if(l.type==="Polygon"||l.type==="MultiPolygon")return new Yr(l,l)}return s.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(n){if(n.geometry()!=null&&n.canonicalID()!=null){if(n.geometryType()==="Point")return function(s,l){const p=[1/0,1/0,-1/0,-1/0],v=[1/0,1/0,-1/0,-1/0],x=s.canonicalID();if(l.type==="Polygon"){const S=Gu(l.coordinates,v,x),C=Fi(s.geometry(),p,v,x);if(!pr(p,v))return!1;for(const P of C)if(!$o(P,S))return!1}if(l.type==="MultiPolygon"){const S=ih(l.coordinates,v,x),C=Fi(s.geometry(),p,v,x);if(!pr(p,v))return!1;for(const P of C)if(!us(P,S))return!1}return!0}(n,this.geometries);if(n.geometryType()==="LineString")return function(s,l){const p=[1/0,1/0,-1/0,-1/0],v=[1/0,1/0,-1/0,-1/0],x=s.canonicalID();if(l.type==="Polygon"){const S=Gu(l.coordinates,v,x),C=Td(s.geometry(),p,v,x);if(!pr(p,v))return!1;for(const P of C)if(!nh(P,S))return!1}if(l.type==="MultiPolygon"){const S=ih(l.coordinates,v,x),C=Td(s.geometry(),p,v,x);if(!pr(p,v))return!1;for(const P of C)if(!Sd(P,S))return!1}return!0}(n,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}let Ed=class{constructor(i=[],n=(s,l)=>s<l?-1:s>l?1:0){if(this.data=i,this.length=this.data.length,this.compare=n,this.length>0)for(let s=(this.length>>1)-1;s>=0;s--)this._down(s)}push(i){this.data.push(i),this._up(this.length++)}pop(){if(this.length===0)return;const i=this.data[0],n=this.data.pop();return--this.length>0&&(this.data[0]=n,this._down(0)),i}peek(){return this.data[0]}_up(i){const{data:n,compare:s}=this,l=n[i];for(;i>0;){const p=i-1>>1,v=n[p];if(s(l,v)>=0)break;n[i]=v,i=p}n[i]=l}_down(i){const{data:n,compare:s}=this,l=this.length>>1,p=n[i];for(;i<l;){let v=1+(i<<1);const x=v+1;if(x<this.length&&s(n[x],n[v])<0&&(v=x),s(n[v],p)>=0)break;n[i]=n[v],i=v}n[i]=p}};function Cd(i,n,s,l,p){mo(i,n,s,l||i.length-1,p||oh)}function mo(i,n,s,l,p){for(;l>s;){if(l-s>600){var v=l-s+1,x=n-s+1,S=Math.log(v),C=.5*Math.exp(2*S/3),P=.5*Math.sqrt(S*C*(v-C)/v)*(x-v/2<0?-1:1);mo(i,n,Math.max(s,Math.floor(n-x*C/v+P)),Math.min(l,Math.floor(n+(v-x)*C/v+P)),p)}var M=i[n],R=s,F=l;for(Vo(i,s,n),p(i[l],M)>0&&Vo(i,s,l);R<F;){for(Vo(i,R,F),R++,F--;p(i[R],M)<0;)R++;for(;p(i[F],M)>0;)F--}p(i[s],M)===0?Vo(i,s,F):Vo(i,++F,l),F<=n&&(s=F+1),n<=F&&(l=F-1)}}function Vo(i,n,s){var l=i[n];i[n]=i[s],i[s]=l}function oh(i,n){return i<n?-1:i>n?1:0}function ir(i,n){if(i.length<=1)return[i];const s=[];let l,p;for(const v of i){const x=ah(v);x!==0&&(v.area=Math.abs(x),p===void 0&&(p=x<0),p===x<0?(l&&s.push(l),l=[v]):l.push(v))}if(l&&s.push(l),n>1)for(let v=0;v<s.length;v++)s[v].length<=n||(Cd(s[v],n,1,s[v].length-1,qo),s[v]=s[v].slice(0,n));return s}function qo(i,n){return n.area-i.area}function ah(i){let n=0;for(let s,l,p=0,v=i.length,x=v-1;p<v;x=p++)s=i[p],l=i[x],n+=(l.x-s.x)*(s.y+l.y);return n}const Id=1/298.257223563,Wu=Id*(2-Id),kd=Math.PI/180;class lh{constructor(n){const s=6378.137*kd*1e3,l=Math.cos(n*kd),p=1/(1-Wu*(1-l*l)),v=Math.sqrt(p);this.kx=s*v*l,this.ky=s*v*p*(1-Wu)}distance(n,s){const l=this.wrap(n[0]-s[0])*this.kx,p=(n[1]-s[1])*this.ky;return Math.sqrt(l*l+p*p)}pointOnLine(n,s){let l,p,v,x,S=1/0;for(let C=0;C<n.length-1;C++){let P=n[C][0],M=n[C][1],R=this.wrap(n[C+1][0]-P)*this.kx,F=(n[C+1][1]-M)*this.ky,j=0;R===0&&F===0||(j=(this.wrap(s[0]-P)*this.kx*R+(s[1]-M)*this.ky*F)/(R*R+F*F),j>1?(P=n[C+1][0],M=n[C+1][1]):j>0&&(P+=R/this.kx*j,M+=F/this.ky*j)),R=this.wrap(s[0]-P)*this.kx,F=(s[1]-M)*this.ky;const G=R*R+F*F;G<S&&(S=G,l=P,p=M,v=C,x=j)}return{point:[l,p],index:v,t:Math.max(0,Math.min(1,x))}}wrap(n){for(;n<-180;)n+=360;for(;n>180;)n-=360;return n}}function Pd(i,n){return n[0]-i[0]}function Zl(i){return i[1]-i[0]+1}function cs(i,n){return i[1]>=i[0]&&i[1]<n}function Zo(i,n){if(i[0]>i[1])return[null,null];const s=Zl(i);if(n){if(s===2)return[i,null];const p=Math.floor(s/2);return[[i[0],i[0]+p],[i[0]+p,i[1]]]}if(s===1)return[i,null];const l=Math.floor(s/2)-1;return[[i[0],i[0]+l],[i[0]+l+1,i[1]]]}function uh(i,n){if(!cs(n,i.length))return[1/0,1/0,-1/0,-1/0];const s=[1/0,1/0,-1/0,-1/0];for(let l=n[0];l<=n[1];++l)ga(s,i[l]);return s}function Hu(i){const n=[1/0,1/0,-1/0,-1/0];for(const s of i)for(const l of s)ga(n,l);return n}function Gl(i){return i[0]!==-1/0&&i[1]!==-1/0&&i[2]!==1/0&&i[3]!==1/0}function Wl(i,n,s){if(!Gl(i)||!Gl(n))return NaN;let l=0,p=0;return i[2]<n[0]&&(l=n[0]-i[2]),i[0]>n[2]&&(l=i[0]-n[2]),i[1]>n[3]&&(p=i[1]-n[3]),i[3]<n[1]&&(p=n[1]-i[3]),s.distance([0,0],[l,p])}function go(i,n,s){const l=s.pointOnLine(n,i);return s.distance(i,l.point)}function Xu(i,n,s,l,p){const v=Math.min(go(i,[s,l],p),go(n,[s,l],p)),x=Math.min(go(s,[i,n],p),go(l,[i,n],p));return Math.min(v,x)}function lp(i,n,s,l,p){if(!cs(n,i.length)||!cs(l,s.length))return 1/0;let v=1/0;for(let x=n[0];x<n[1];++x){const S=i[x],C=i[x+1];for(let P=l[0];P<l[1];++P){const M=s[P],R=s[P+1];if(Qs(S,C,M,R))return 0;v=Math.min(v,Xu(S,C,M,R,p))}}return v}function mr(i,n,s,l,p){if(!cs(n,i.length)||!cs(l,s.length))return NaN;let v=1/0;for(let x=n[0];x<=n[1];++x)for(let S=l[0];S<=l[1];++S)if(v=Math.min(v,p.distance(i[x],s[S])),v===0)return v;return v}function ch(i,n,s){if($o(i,n,!0))return 0;let l=1/0;for(const p of n){const v=p[0],x=p[p.length-1];if(v!==x&&(l=Math.min(l,go(i,[x,v],s)),l===0))return l;const S=s.pointOnLine(p,i);if(l=Math.min(l,s.distance(i,S.point)),l===0)return l}return l}function an(i,n,s,l){if(!cs(n,i.length))return NaN;for(let v=n[0];v<=n[1];++v)if($o(i[v],s,!0))return 0;let p=1/0;for(let v=n[0];v<n[1];++v){const x=i[v],S=i[v+1];for(const C of s)for(let P=0,M=C.length,R=M-1;P<M;R=P++){const F=C[R],j=C[P];if(Qs(x,S,F,j))return 0;p=Math.min(p,Xu(x,S,F,j,l))}}return p}function Hl(i,n){for(const s of i)for(const l of s)if($o(l,n,!0))return!0;return!1}function pn(i,n,s,l=1/0){const p=Hu(i),v=Hu(n);if(l!==1/0&&Wl(p,v,s)>=l)return l;if(pr(p,v)){if(Hl(i,n))return 0}else if(Hl(n,i))return 0;let x=1/0;for(const S of i)for(let C=0,P=S.length,M=P-1;C<P;M=C++){const R=S[M],F=S[C];for(const j of n)for(let G=0,Z=j.length,ne=Z-1;G<Z;ne=G++){const oe=j[ne],Pe=j[G];if(Qs(R,F,oe,Pe))return 0;x=Math.min(x,Xu(R,F,oe,Pe,s))}}return x}function Un(i,n,s,l,p,v){if(!v)return;const x=Wl(uh(l,v),p,s);x<n&&i.push([x,v,[0,0]])}function Os(i,n,s,l,p,v,x){if(!v||!x)return;const S=Wl(uh(l,v),uh(p,x),s);S<n&&i.push([S,v,x])}function ol(i,n,s,l,p=1/0){let v=Math.min(l.distance(i[0],s[0][0]),p);if(v===0)return v;const x=new Ed([[0,[0,i.length-1],[0,0]]],Pd),S=Hu(s);for(;x.length>0;){const C=x.pop();if(C[0]>=v)continue;const P=C[1],M=n?50:100;if(Zl(P)<=M){if(!cs(P,i.length))return NaN;if(n){const R=an(i,P,s,l);if(isNaN(R)||R===0)return R;v=Math.min(v,R)}else for(let R=P[0];R<=P[1];++R){const F=ch(i[R],s,l);if(v=Math.min(v,F),v===0)return 0}}else{const R=Zo(P,n);Un(x,v,l,i,S,R[0]),Un(x,v,l,i,S,R[1])}}return v}function al(i,n,s,l,p,v=1/0){let x=Math.min(v,p.distance(i[0],s[0]));if(x===0)return x;const S=new Ed([[0,[0,i.length-1],[0,s.length-1]]],Pd);for(;S.length>0;){const C=S.pop();if(C[0]>=x)continue;const P=C[1],M=C[2],R=n?50:100,F=l?50:100;if(Zl(P)<=R&&Zl(M)<=F){if(!cs(P,i.length)&&cs(M,s.length))return NaN;let j;if(n&&l)j=lp(i,P,s,M,p),x=Math.min(x,j);else if(n&&!l){const G=i.slice(P[0],P[1]+1);for(let Z=M[0];Z<=M[1];++Z)if(j=go(s[Z],G,p),x=Math.min(x,j),x===0)return x}else if(!n&&l){const G=s.slice(M[0],M[1]+1);for(let Z=P[0];Z<=P[1];++Z)if(j=go(i[Z],G,p),x=Math.min(x,j),x===0)return x}else j=mr(i,P,s,M,p),x=Math.min(x,j)}else{const j=Zo(P,n),G=Zo(M,l);Os(S,x,p,i,s,j[0],G[0]),Os(S,x,p,i,s,j[0],G[1]),Os(S,x,p,i,s,j[1],G[0]),Os(S,x,p,i,s,j[1],G[1])}}return x}function hh(i){return i.type==="MultiPolygon"?i.coordinates.map(n=>({type:"Polygon",coordinates:n})):i.type==="MultiLineString"?i.coordinates.map(n=>({type:"LineString",coordinates:n})):i.type==="MultiPoint"?i.coordinates.map(n=>({type:"Point",coordinates:n})):[i]}class _a{constructor(n,s){this.type=it,this.geojson=n,this.geometries=s}static parse(n,s){if(n.length!==2)return s.error(`'distance' expression requires exactly one argument, but found ${n.length-1} instead.`);if(pa(n[1])){const l=n[1];if(l.type==="FeatureCollection")return new _a(l,l.features.map(p=>hh(p.geometry)).flat());if(l.type==="Feature")return new _a(l,hh(l.geometry));if("type"in l&&"coordinates"in l)return new _a(l,hh(l))}return s.error("'distance' expression requires valid geojson object that contains polygon geometry type.")}evaluate(n){if(n.geometry()!=null&&n.canonicalID()!=null){if(n.geometryType()==="Point")return function(s,l){const p=s.geometry(),v=p.flat().map(C=>Zu([C.x,C.y],s.canonical));if(p.length===0)return NaN;const x=new lh(v[0][1]);let S=1/0;for(const C of l){switch(C.type){case"Point":S=Math.min(S,al(v,!1,[C.coordinates],!1,x,S));break;case"LineString":S=Math.min(S,al(v,!1,C.coordinates,!0,x,S));break;case"Polygon":S=Math.min(S,ol(v,!1,C.coordinates,x,S))}if(S===0)return S}return S}(n,this.geometries);if(n.geometryType()==="LineString")return function(s,l){const p=s.geometry(),v=p.flat().map(C=>Zu([C.x,C.y],s.canonical));if(p.length===0)return NaN;const x=new lh(v[0][1]);let S=1/0;for(const C of l){switch(C.type){case"Point":S=Math.min(S,al(v,!0,[C.coordinates],!1,x,S));break;case"LineString":S=Math.min(S,al(v,!0,C.coordinates,!0,x,S));break;case"Polygon":S=Math.min(S,ol(v,!0,C.coordinates,x,S))}if(S===0)return S}return S}(n,this.geometries);if(n.geometryType()==="Polygon")return function(s,l){const p=s.geometry();if(p.length===0||p[0].length===0)return NaN;const v=ir(p,0).map(C=>C.map(P=>P.map(M=>Zu([M.x,M.y],s.canonical)))),x=new lh(v[0][0][0][1]);let S=1/0;for(const C of l)for(const P of v){switch(C.type){case"Point":S=Math.min(S,ol([C.coordinates],!1,P,x,S));break;case"LineString":S=Math.min(S,ol(C.coordinates,!0,P,x,S));break;case"Polygon":S=Math.min(S,pn(P,C.coordinates,x,S))}if(S===0)return S}return S}(n,this.geometries)}return NaN}eachChild(){}outputDefined(){return!0}}const ll={"==":ip,"!=":xd,">":sp,"<":wd,">=":or,"<=":op,array:Ls,at:Kc,boolean:Ls,case:po,coalesce:$u,collator:Wn,format:qu,image:eh,in:Uu,"index-of":Uo,interpolate:Ei,"interpolate-hcl":Ei,"interpolate-lab":Ei,length:th,let:fo,literal:ls,match:$l,number:Ls,"number-format":Qc,object:Ls,slice:il,step:sl,string:Ls,"to-boolean":Li,"to-color":Li,"to-number":Li,"to-string":Li,var:Pn,within:Yr,distance:_a};class hs{constructor(n,s,l,p){this.name=n,this.type=s,this._evaluate=l,this.args=p}evaluate(n){return this._evaluate(n,this.args)}eachChild(n){this.args.forEach(n)}outputDefined(){return!1}static parse(n,s){const l=n[0],p=hs.definitions[l];if(!p)return s.error(`Unknown expression "${l}". If you wanted a literal array, use ["literal", [...]].`,0);const v=Array.isArray(p)?p[0]:p.type,x=Array.isArray(p)?[[p[1],p[2]]]:p.overloads,S=x.filter(([P])=>!Array.isArray(P)||P.length===n.length-1);let C=null;for(const[P,M]of S){C=new No(s.registry,va,s.path,null,s.scope);const R=[];let F=!1;for(let j=1;j<n.length;j++){const G=n[j],Z=Array.isArray(P)?P[j-1]:P.type,ne=C.parse(G,1+R.length,Z);if(!ne){F=!0;break}R.push(ne)}if(!F)if(Array.isArray(P)&&P.length!==R.length)C.error(`Expected ${P.length} arguments, but found ${R.length} instead.`);else{for(let j=0;j<R.length;j++){const G=Array.isArray(P)?P[j]:P.type,Z=R[j];C.concat(j+1).checkSubtype(G,Z.type)}if(C.errors.length===0)return new hs(l,v,M,R)}}if(S.length===1)s.errors.push(...C.errors);else{const P=(S.length?S:x).map(([R])=>{return F=R,Array.isArray(F)?`(${F.map(B).join(", ")})`:`(${B(F.type)}...)`;var F}).join(" | "),M=[];for(let R=1;R<n.length;R++){const F=s.parse(n[R],1+M.length);if(!F)return null;M.push(B(F.type))}s.error(`Expected arguments of type ${P}, but found (${M.join(", ")}) instead.`)}return null}static register(n,s){hs.definitions=s;for(const l in s)n[l]=hs}}function dh(i,[n,s,l,p]){n=n.evaluate(i),s=s.evaluate(i),l=l.evaluate(i);const v=p?p.evaluate(i):1,x=tl(n,s,l,v);if(x)throw new Er(x);return new Rn(n/255,s/255,l/255,v,!1)}function Go(i,n){return i in n}function fh(i,n){const s=n[i];return s===void 0?null:s}function ya(i){return{type:i}}function va(i){if(i instanceof Pn)return va(i.boundExpression);if(i instanceof hs&&i.name==="error"||i instanceof Wn||i instanceof Yr||i instanceof _a)return!1;const n=i instanceof Li||i instanceof Ls;let s=!0;return i.eachChild(l=>{s=n?s&&va(l):s&&l instanceof ls}),!!s&&ul(i)&&Wo(i,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}function ul(i){if(i instanceof hs&&(i.name==="get"&&i.args.length===1||i.name==="feature-state"||i.name==="has"&&i.args.length===1||i.name==="properties"||i.name==="geometry-type"||i.name==="id"||/^filter-/.test(i.name))||i instanceof Yr||i instanceof _a)return!1;let n=!0;return i.eachChild(s=>{n&&!ul(s)&&(n=!1)}),n}function Ki(i){if(i instanceof hs&&i.name==="feature-state")return!1;let n=!0;return i.eachChild(s=>{n&&!Ki(s)&&(n=!1)}),n}function Wo(i,n){if(i instanceof hs&&n.indexOf(i.name)>=0)return!1;let s=!0;return i.eachChild(l=>{s&&!Wo(l,n)&&(s=!1)}),s}function Ku(i){return{result:"success",value:i}}function cl(i){return{result:"error",value:i}}function hl(i){return i["property-type"]==="data-driven"||i["property-type"]==="cross-faded-data-driven"}function xa(i){return!!i.expression&&i.expression.parameters.indexOf("zoom")>-1}function Yi(i){return!!i.expression&&i.expression.interpolated}function An(i){return i instanceof Number?"number":i instanceof String?"string":i instanceof Boolean?"boolean":Array.isArray(i)?"array":i===null?"null":typeof i}function Yu(i){return typeof i=="object"&&i!==null&&!Array.isArray(i)}function up(i){return i}function Ad(i,n){const s=n.type==="color",l=i.stops&&typeof i.stops[0][0]=="object",p=l||!(l||i.property!==void 0),v=i.type||(Yi(n)?"exponential":"interval");if(s||n.type==="padding"){const M=s?Rn.parse:Ri.parse;(i=hi({},i)).stops&&(i.stops=i.stops.map(R=>[R[0],M(R[1])])),i.default=M(i.default?i.default:n.default)}if(i.colorSpace&&(x=i.colorSpace)!=="rgb"&&x!=="hcl"&&x!=="lab")throw new Error(`Unknown color space: "${i.colorSpace}"`);var x;let S,C,P;if(v==="exponential")S=Ie;else if(v==="interval")S=_o;else if(v==="categorical"){S=Md,C=Object.create(null);for(const M of i.stops)C[M[0]]=M[1];P=typeof i.stops[0][0]}else{if(v!=="identity")throw new Error(`Unknown function type "${v}"`);S=Ve}if(l){const M={},R=[];for(let G=0;G<i.stops.length;G++){const Z=i.stops[G],ne=Z[0].zoom;M[ne]===void 0&&(M[ne]={zoom:ne,type:i.type,property:i.property,default:i.default,stops:[]},R.push(ne)),M[ne].stops.push([Z[0].value,Z[1]])}const F=[];for(const G of R)F.push([M[G].zoom,Ad(M[G],n)]);const j={name:"linear"};return{kind:"composite",interpolationType:j,interpolationFactor:Ei.interpolationFactor.bind(void 0,j),zoomStops:F.map(G=>G[0]),evaluate:({zoom:G},Z)=>Ie({stops:F,base:i.base},n,G).evaluate(G,Z)}}if(p){const M=v==="exponential"?{name:"exponential",base:i.base!==void 0?i.base:1}:null;return{kind:"camera",interpolationType:M,interpolationFactor:Ei.interpolationFactor.bind(void 0,M),zoomStops:i.stops.map(R=>R[0]),evaluate:({zoom:R})=>S(i,n,R,C,P)}}return{kind:"source",evaluate(M,R){const F=R&&R.properties?R.properties[i.property]:void 0;return F===void 0?dl(i.default,n.default):S(i,n,F,C,P)}}}function dl(i,n,s){return i!==void 0?i:n!==void 0?n:s!==void 0?s:void 0}function Md(i,n,s,l,p){return dl(typeof s===p?l[s]:void 0,i.default,n.default)}function _o(i,n,s){if(An(s)!=="number")return dl(i.default,n.default);const l=i.stops.length;if(l===1||s<=i.stops[0][0])return i.stops[0][1];if(s>=i.stops[l-1][0])return i.stops[l-1][1];const p=Vl(i.stops.map(v=>v[0]),s);return i.stops[p][1]}function Ie(i,n,s){const l=i.base!==void 0?i.base:1;if(An(s)!=="number")return dl(i.default,n.default);const p=i.stops.length;if(p===1||s<=i.stops[0][0])return i.stops[0][1];if(s>=i.stops[p-1][0])return i.stops[p-1][1];const v=Vl(i.stops.map(M=>M[0]),s),x=function(M,R,F,j){const G=j-F,Z=M-F;return G===0?0:R===1?Z/G:(Math.pow(R,Z)-1)/(Math.pow(R,G)-1)}(s,l,i.stops[v][0],i.stops[v+1][0]),S=i.stops[v][1],C=i.stops[v+1][1],P=Oi[n.type]||up;return typeof S.evaluate=="function"?{evaluate(...M){const R=S.evaluate.apply(void 0,M),F=C.evaluate.apply(void 0,M);if(R!==void 0&&F!==void 0)return P(R,F,x,i.colorSpace)}}:P(S,C,x,i.colorSpace)}function Ve(i,n,s){switch(n.type){case"color":s=Rn.parse(s);break;case"formatted":s=Wi.fromString(s.toString());break;case"resolvedImage":s=Xi.fromString(s.toString());break;case"padding":s=Ri.parse(s);break;default:An(s)===n.type||n.type==="enum"&&n.values[s]||(s=void 0)}return dl(s,i.default,n.default)}hs.register(ll,{error:[{kind:"error"},[Ht],(i,[n])=>{throw new Er(n.evaluate(i))}],typeof:[Ht,[Xt],(i,[n])=>B(Or(n.evaluate(i)))],"to-rgba":[N(it,4),[di],(i,[n])=>{const[s,l,p,v]=n.evaluate(i).rgb;return[255*s,255*l,255*p,v]}],rgb:[di,[it,it,it],dh],rgba:[di,[it,it,it,it],dh],has:{type:Ut,overloads:[[[Ht],(i,[n])=>Go(n.evaluate(i),i.properties())],[[Ht,Gi],(i,[n,s])=>Go(n.evaluate(i),s.evaluate(i))]]},get:{type:Xt,overloads:[[[Ht],(i,[n])=>fh(n.evaluate(i),i.properties())],[[Ht,Gi],(i,[n,s])=>fh(n.evaluate(i),s.evaluate(i))]]},"feature-state":[Xt,[Ht],(i,[n])=>fh(n.evaluate(i),i.featureState||{})],properties:[Gi,[],i=>i.properties()],"geometry-type":[Ht,[],i=>i.geometryType()],id:[Xt,[],i=>i.id()],zoom:[it,[],i=>i.globals.zoom],"heatmap-density":[it,[],i=>i.globals.heatmapDensity||0],"line-progress":[it,[],i=>i.globals.lineProgress||0],accumulated:[Xt,[],i=>i.globals.accumulated===void 0?null:i.globals.accumulated],"+":[it,ya(it),(i,n)=>{let s=0;for(const l of n)s+=l.evaluate(i);return s}],"*":[it,ya(it),(i,n)=>{let s=1;for(const l of n)s*=l.evaluate(i);return s}],"-":{type:it,overloads:[[[it,it],(i,[n,s])=>n.evaluate(i)-s.evaluate(i)],[[it],(i,[n])=>-n.evaluate(i)]]},"/":[it,[it,it],(i,[n,s])=>n.evaluate(i)/s.evaluate(i)],"%":[it,[it,it],(i,[n,s])=>n.evaluate(i)%s.evaluate(i)],ln2:[it,[],()=>Math.LN2],pi:[it,[],()=>Math.PI],e:[it,[],()=>Math.E],"^":[it,[it,it],(i,[n,s])=>Math.pow(n.evaluate(i),s.evaluate(i))],sqrt:[it,[it],(i,[n])=>Math.sqrt(n.evaluate(i))],log10:[it,[it],(i,[n])=>Math.log(n.evaluate(i))/Math.LN10],ln:[it,[it],(i,[n])=>Math.log(n.evaluate(i))],log2:[it,[it],(i,[n])=>Math.log(n.evaluate(i))/Math.LN2],sin:[it,[it],(i,[n])=>Math.sin(n.evaluate(i))],cos:[it,[it],(i,[n])=>Math.cos(n.evaluate(i))],tan:[it,[it],(i,[n])=>Math.tan(n.evaluate(i))],asin:[it,[it],(i,[n])=>Math.asin(n.evaluate(i))],acos:[it,[it],(i,[n])=>Math.acos(n.evaluate(i))],atan:[it,[it],(i,[n])=>Math.atan(n.evaluate(i))],min:[it,ya(it),(i,n)=>Math.min(...n.map(s=>s.evaluate(i)))],max:[it,ya(it),(i,n)=>Math.max(...n.map(s=>s.evaluate(i)))],abs:[it,[it],(i,[n])=>Math.abs(n.evaluate(i))],round:[it,[it],(i,[n])=>{const s=n.evaluate(i);return s<0?-Math.round(-s):Math.round(s)}],floor:[it,[it],(i,[n])=>Math.floor(n.evaluate(i))],ceil:[it,[it],(i,[n])=>Math.ceil(n.evaluate(i))],"filter-==":[Ut,[Ht,Xt],(i,[n,s])=>i.properties()[n.value]===s.value],"filter-id-==":[Ut,[Xt],(i,[n])=>i.id()===n.value],"filter-type-==":[Ut,[Ht],(i,[n])=>i.geometryType()===n.value],"filter-<":[Ut,[Ht,Xt],(i,[n,s])=>{const l=i.properties()[n.value],p=s.value;return typeof l==typeof p&&l<p}],"filter-id-<":[Ut,[Xt],(i,[n])=>{const s=i.id(),l=n.value;return typeof s==typeof l&&s<l}],"filter->":[Ut,[Ht,Xt],(i,[n,s])=>{const l=i.properties()[n.value],p=s.value;return typeof l==typeof p&&l>p}],"filter-id->":[Ut,[Xt],(i,[n])=>{const s=i.id(),l=n.value;return typeof s==typeof l&&s>l}],"filter-<=":[Ut,[Ht,Xt],(i,[n,s])=>{const l=i.properties()[n.value],p=s.value;return typeof l==typeof p&&l<=p}],"filter-id-<=":[Ut,[Xt],(i,[n])=>{const s=i.id(),l=n.value;return typeof s==typeof l&&s<=l}],"filter->=":[Ut,[Ht,Xt],(i,[n,s])=>{const l=i.properties()[n.value],p=s.value;return typeof l==typeof p&&l>=p}],"filter-id->=":[Ut,[Xt],(i,[n])=>{const s=i.id(),l=n.value;return typeof s==typeof l&&s>=l}],"filter-has":[Ut,[Xt],(i,[n])=>n.value in i.properties()],"filter-has-id":[Ut,[],i=>i.id()!==null&&i.id()!==void 0],"filter-type-in":[Ut,[N(Ht)],(i,[n])=>n.value.indexOf(i.geometryType())>=0],"filter-id-in":[Ut,[N(Xt)],(i,[n])=>n.value.indexOf(i.id())>=0],"filter-in-small":[Ut,[Ht,N(Xt)],(i,[n,s])=>s.value.indexOf(i.properties()[n.value])>=0],"filter-in-large":[Ut,[Ht,N(Xt)],(i,[n,s])=>function(l,p,v,x){for(;v<=x;){const S=v+x>>1;if(p[S]===l)return!0;p[S]>l?x=S-1:v=S+1}return!1}(i.properties()[n.value],s.value,0,s.value.length-1)],all:{type:Ut,overloads:[[[Ut,Ut],(i,[n,s])=>n.evaluate(i)&&s.evaluate(i)],[ya(Ut),(i,n)=>{for(const s of n)if(!s.evaluate(i))return!1;return!0}]]},any:{type:Ut,overloads:[[[Ut,Ut],(i,[n,s])=>n.evaluate(i)||s.evaluate(i)],[ya(Ut),(i,n)=>{for(const s of n)if(s.evaluate(i))return!0;return!1}]]},"!":[Ut,[Ut],(i,[n])=>!n.evaluate(i)],"is-supported-script":[Ut,[Ht],(i,[n])=>{const s=i.globals&&i.globals.isSupportedScript;return!s||s(n.evaluate(i))}],upcase:[Ht,[Ht],(i,[n])=>n.evaluate(i).toUpperCase()],downcase:[Ht,[Ht],(i,[n])=>n.evaluate(i).toLowerCase()],concat:[Ht,ya(Xt),(i,n)=>n.map(s=>nl(s.evaluate(i))).join("")],"resolved-locale":[Ht,[Ys],(i,[n])=>n.evaluate(i).resolvedLocale()]});class Oe{constructor(n,s){var l;this.expression=n,this._warningHistory={},this._evaluator=new Nu,this._defaultValue=s?(l=s).type==="color"&&Yu(l.default)?new Rn(0,0,0,0):l.type==="color"?Rn.parse(l.default)||null:l.type==="padding"?Ri.parse(l.default)||null:l.type==="variableAnchorOffsetCollection"?Hi.parse(l.default)||null:l.default===void 0?null:l.default:null,this._enumValues=s&&s.type==="enum"?s.values:null}evaluateWithoutErrorHandling(n,s,l,p,v,x){return this._evaluator.globals=n,this._evaluator.feature=s,this._evaluator.featureState=l,this._evaluator.canonical=p,this._evaluator.availableImages=v||null,this._evaluator.formattedSection=x,this.expression.evaluate(this._evaluator)}evaluate(n,s,l,p,v,x){this._evaluator.globals=n,this._evaluator.feature=s||null,this._evaluator.featureState=l||null,this._evaluator.canonical=p,this._evaluator.availableImages=v||null,this._evaluator.formattedSection=x||null;try{const S=this.expression.evaluate(this._evaluator);if(S==null||typeof S=="number"&&S!=S)return this._defaultValue;if(this._enumValues&&!(S in this._enumValues))throw new Er(`Expected value to be one of ${Object.keys(this._enumValues).map(C=>JSON.stringify(C)).join(", ")}, but found ${JSON.stringify(S)} instead.`);return S}catch(S){return this._warningHistory[S.message]||(this._warningHistory[S.message]=!0,typeof console<"u"&&console.warn(S.message)),this._defaultValue}}}function Tt(i){return Array.isArray(i)&&i.length>0&&typeof i[0]=="string"&&i[0]in ll}function Wt(i,n){const s=new No(ll,va,[],n?function(p){const v={color:di,string:Ht,number:it,enum:Ht,boolean:Ut,formatted:co,padding:ho,resolvedImage:Rs,variableAnchorOffsetCollection:ae};return p.type==="array"?N(v[p.value]||Xt,p.length):v[p.type]}(n):void 0),l=s.parse(i,void 0,void 0,void 0,n&&n.type==="string"?{typeAnnotation:"coerce"}:void 0);return l?Ku(new Oe(l,n)):cl(s.errors)}class Tn{constructor(n,s){this.kind=n,this._styleExpression=s,this.isStateDependent=n!=="constant"&&!Ki(s.expression)}evaluateWithoutErrorHandling(n,s,l,p,v,x){return this._styleExpression.evaluateWithoutErrorHandling(n,s,l,p,v,x)}evaluate(n,s,l,p,v,x){return this._styleExpression.evaluate(n,s,l,p,v,x)}}class gr{constructor(n,s,l,p){this.kind=n,this.zoomStops=l,this._styleExpression=s,this.isStateDependent=n!=="camera"&&!Ki(s.expression),this.interpolationType=p}evaluateWithoutErrorHandling(n,s,l,p,v,x){return this._styleExpression.evaluateWithoutErrorHandling(n,s,l,p,v,x)}evaluate(n,s,l,p,v,x){return this._styleExpression.evaluate(n,s,l,p,v,x)}interpolationFactor(n,s,l){return this.interpolationType?Ei.interpolationFactor(this.interpolationType,n,s,l):0}}function Hn(i,n){const s=Wt(i,n);if(s.result==="error")return s;const l=s.value.expression,p=ul(l);if(!p&&!hl(n))return cl([new Lr("","data expressions not supported")]);const v=Wo(l,["zoom"]);if(!v&&!xa(n))return cl([new Lr("","zoom expressions not supported")]);const x=Xl(l);return x||v?x instanceof Lr?cl([x]):x instanceof Ei&&!Yi(n)?cl([new Lr("",'"interpolate" expressions cannot be used with this property')]):Ku(x?new gr(p?"camera":"composite",s.value,x.labels,x instanceof Ei?x.interpolation:void 0):new Tn(p?"constant":"source",s.value)):cl([new Lr("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class Ho{constructor(n,s){this._parameters=n,this._specification=s,hi(this,Ad(this._parameters,this._specification))}static deserialize(n){return new Ho(n._parameters,n._specification)}static serialize(n){return{_parameters:n._parameters,_specification:n._specification}}}function Xl(i){let n=null;if(i instanceof fo)n=Xl(i.result);else if(i instanceof $u){for(const s of i.args)if(n=Xl(s),n)break}else(i instanceof sl||i instanceof Ei)&&i.input instanceof hs&&i.input.name==="zoom"&&(n=i);return n instanceof Lr||i.eachChild(s=>{const l=Xl(s);l instanceof Lr?n=l:!n&&l?n=new Lr("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):n&&l&&n!==l&&(n=new Lr("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),n}function Ci(i){if(i===!0||i===!1)return!0;if(!Array.isArray(i)||i.length===0)return!1;switch(i[0]){case"has":return i.length>=2&&i[1]!=="$id"&&i[1]!=="$type";case"in":return i.length>=3&&(typeof i[1]!="string"||Array.isArray(i[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return i.length!==3||Array.isArray(i[1])||Array.isArray(i[2]);case"any":case"all":for(const n of i.slice(1))if(!Ci(n)&&typeof n!="boolean")return!1;return!0;default:return!0}}const wa={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function ph(i){if(i==null)return{filter:()=>!0,needGeometry:!1};Ci(i)||(i=ba(i));const n=Wt(i,wa);if(n.result==="error")throw new Error(n.value.map(s=>`${s.key}: ${s.message}`).join(", "));return{filter:(s,l,p)=>n.value.evaluate(s,l,{},p),needGeometry:Kl(i)}}function fl(i,n){return i<n?-1:i>n?1:0}function Kl(i){if(!Array.isArray(i))return!1;if(i[0]==="within"||i[0]==="distance")return!0;for(let n=1;n<i.length;n++)if(Kl(i[n]))return!0;return!1}function ba(i){if(!i)return!0;const n=i[0];return i.length<=1?n!=="any":n==="=="?jn(i[1],i[2],"=="):n==="!="?$r(jn(i[1],i[2],"==")):n==="<"||n===">"||n==="<="||n===">="?jn(i[1],i[2],n):n==="any"?(s=i.slice(1),["any"].concat(s.map(ba))):n==="all"?["all"].concat(i.slice(1).map(ba)):n==="none"?["all"].concat(i.slice(1).map(ba).map($r)):n==="in"?Yl(i[1],i.slice(2)):n==="!in"?$r(Yl(i[1],i.slice(2))):n==="has"?pl(i[1]):n!=="!has"||$r(pl(i[1]));var s}function jn(i,n,s){switch(i){case"$type":return[`filter-type-${s}`,n];case"$id":return[`filter-id-${s}`,n];default:return[`filter-${s}`,i,n]}}function Yl(i,n){if(n.length===0)return!1;switch(i){case"$type":return["filter-type-in",["literal",n]];case"$id":return["filter-id-in",["literal",n]];default:return n.length>200&&!n.some(s=>typeof s!=typeof n[0])?["filter-in-large",i,["literal",n.sort(fl)]]:["filter-in-small",i,["literal",n]]}}function pl(i){switch(i){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",i]}}function $r(i){return["!",i]}function Sa(i){const n=typeof i;if(n==="number"||n==="boolean"||n==="string"||i==null)return JSON.stringify(i);if(Array.isArray(i)){let p="[";for(const v of i)p+=`${Sa(v)},`;return`${p}]`}const s=Object.keys(i).sort();let l="{";for(let p=0;p<s.length;p++)l+=`${JSON.stringify(s[p])}:${Sa(i[s[p]])},`;return`${l}}`}function zd(i){let n="";for(const s of Fn)n+=`/${Sa(i[s])}`;return n}function Dd(i){const n=i.value;return n?[new Ke(i.key,n,"constants have been deprecated as of v8")]:[]}function cr(i){return i instanceof Number||i instanceof String||i instanceof Boolean?i.valueOf():i}function Jr(i){if(Array.isArray(i))return i.map(Jr);if(i instanceof Object&&!(i instanceof Number||i instanceof String||i instanceof Boolean)){const n={};for(const s in i)n[s]=Jr(i[s]);return n}return cr(i)}function fi(i){const n=i.key,s=i.value,l=i.valueSpec||{},p=i.objectElementValidators||{},v=i.style,x=i.styleSpec,S=i.validateSpec;let C=[];const P=An(s);if(P!=="object")return[new Ke(n,s,`object expected, ${P} found`)];for(const M in s){const R=M.split(".")[0],F=l[R]||l["*"];let j;if(p[R])j=p[R];else if(l[R])j=S;else if(p["*"])j=p["*"];else{if(!l["*"]){C.push(new Ke(n,s[M],`unknown property "${M}"`));continue}j=S}C=C.concat(j({key:(n&&`${n}.`)+M,value:s[M],valueSpec:F,style:v,styleSpec:x,object:s,objectKey:M,validateSpec:S},s))}for(const M in l)p[M]||l[M].required&&l[M].default===void 0&&s[M]===void 0&&C.push(new Ke(n,s,`missing required property "${M}"`));return C}function ml(i){const n=i.value,s=i.valueSpec,l=i.style,p=i.styleSpec,v=i.key,x=i.arrayElementValidator||i.validateSpec;if(An(n)!=="array")return[new Ke(v,n,`array expected, ${An(n)} found`)];if(s.length&&n.length!==s.length)return[new Ke(v,n,`array length ${s.length} expected, length ${n.length} found`)];if(s["min-length"]&&n.length<s["min-length"])return[new Ke(v,n,`array length at least ${s["min-length"]} expected, length ${n.length} found`)];let S={type:s.value,values:s.values};p.$version<7&&(S.function=s.function),An(s.value)==="object"&&(S=s.value);let C=[];for(let P=0;P<n.length;P++)C=C.concat(x({array:n,arrayIndex:P,value:n[P],valueSpec:S,validateSpec:i.validateSpec,style:l,styleSpec:p,key:`${v}[${P}]`}));return C}function gl(i){const n=i.key,s=i.value,l=i.valueSpec;let p=An(s);return p==="number"&&s!=s&&(p="NaN"),p!=="number"?[new Ke(n,s,`number expected, ${p} found`)]:"minimum"in l&&s<l.minimum?[new Ke(n,s,`${s} is less than the minimum value ${l.minimum}`)]:"maximum"in l&&s>l.maximum?[new Ke(n,s,`${s} is greater than the maximum value ${l.maximum}`)]:[]}function Jl(i){const n=i.valueSpec,s=cr(i.value.type);let l,p,v,x={};const S=s!=="categorical"&&i.value.property===void 0,C=!S,P=An(i.value.stops)==="array"&&An(i.value.stops[0])==="array"&&An(i.value.stops[0][0])==="object",M=fi({key:i.key,value:i.value,valueSpec:i.styleSpec.function,validateSpec:i.validateSpec,style:i.style,styleSpec:i.styleSpec,objectElementValidators:{stops:function(j){if(s==="identity")return[new Ke(j.key,j.value,'identity function may not have a "stops" property')];let G=[];const Z=j.value;return G=G.concat(ml({key:j.key,value:Z,valueSpec:j.valueSpec,validateSpec:j.validateSpec,style:j.style,styleSpec:j.styleSpec,arrayElementValidator:R})),An(Z)==="array"&&Z.length===0&&G.push(new Ke(j.key,Z,"array must have at least one stop")),G},default:function(j){return j.validateSpec({key:j.key,value:j.value,valueSpec:n,validateSpec:j.validateSpec,style:j.style,styleSpec:j.styleSpec})}}});return s==="identity"&&S&&M.push(new Ke(i.key,i.value,'missing required property "property"')),s==="identity"||i.value.stops||M.push(new Ke(i.key,i.value,'missing required property "stops"')),s==="exponential"&&i.valueSpec.expression&&!Yi(i.valueSpec)&&M.push(new Ke(i.key,i.value,"exponential functions not supported")),i.styleSpec.$version>=8&&(C&&!hl(i.valueSpec)?M.push(new Ke(i.key,i.value,"property functions not supported")):S&&!xa(i.valueSpec)&&M.push(new Ke(i.key,i.value,"zoom functions not supported"))),s!=="categorical"&&!P||i.value.property!==void 0||M.push(new Ke(i.key,i.value,'"property" property is required')),M;function R(j){let G=[];const Z=j.value,ne=j.key;if(An(Z)!=="array")return[new Ke(ne,Z,`array expected, ${An(Z)} found`)];if(Z.length!==2)return[new Ke(ne,Z,`array length 2 expected, length ${Z.length} found`)];if(P){if(An(Z[0])!=="object")return[new Ke(ne,Z,`object expected, ${An(Z[0])} found`)];if(Z[0].zoom===void 0)return[new Ke(ne,Z,"object stop key must have zoom")];if(Z[0].value===void 0)return[new Ke(ne,Z,"object stop key must have value")];if(v&&v>cr(Z[0].zoom))return[new Ke(ne,Z[0].zoom,"stop zoom values must appear in ascending order")];cr(Z[0].zoom)!==v&&(v=cr(Z[0].zoom),p=void 0,x={}),G=G.concat(fi({key:`${ne}[0]`,value:Z[0],valueSpec:{zoom:{}},validateSpec:j.validateSpec,style:j.style,styleSpec:j.styleSpec,objectElementValidators:{zoom:gl,value:F}}))}else G=G.concat(F({key:`${ne}[0]`,value:Z[0],valueSpec:{},validateSpec:j.validateSpec,style:j.style,styleSpec:j.styleSpec},Z));return Tt(Jr(Z[1]))?G.concat([new Ke(`${ne}[1]`,Z[1],"expressions are not allowed in function stops.")]):G.concat(j.validateSpec({key:`${ne}[1]`,value:Z[1],valueSpec:n,validateSpec:j.validateSpec,style:j.style,styleSpec:j.styleSpec}))}function F(j,G){const Z=An(j.value),ne=cr(j.value),oe=j.value!==null?j.value:G;if(l){if(Z!==l)return[new Ke(j.key,oe,`${Z} stop domain type must match previous stop domain type ${l}`)]}else l=Z;if(Z!=="number"&&Z!=="string"&&Z!=="boolean")return[new Ke(j.key,oe,"stop domain value must be a number, string, or boolean")];if(Z!=="number"&&s!=="categorical"){let Pe=`number expected, ${Z} found`;return hl(n)&&s===void 0&&(Pe+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Ke(j.key,oe,Pe)]}return s!=="categorical"||Z!=="number"||isFinite(ne)&&Math.floor(ne)===ne?s!=="categorical"&&Z==="number"&&p!==void 0&&ne<p?[new Ke(j.key,oe,"stop domain values must appear in ascending order")]:(p=ne,s==="categorical"&&ne in x?[new Ke(j.key,oe,"stop domain values must be unique")]:(x[ne]=!0,[])):[new Ke(j.key,oe,`integer expected, found ${ne}`)]}}function Ta(i){const n=(i.expressionContext==="property"?Hn:Wt)(Jr(i.value),i.valueSpec);if(n.result==="error")return n.value.map(l=>new Ke(`${i.key}${l.key}`,i.value,l.message));const s=n.value.expression||n.value._styleExpression.expression;if(i.expressionContext==="property"&&i.propertyKey==="text-font"&&!s.outputDefined())return[new Ke(i.key,i.value,`Invalid data expression for "${i.propertyKey}". Output values must be contained as literals within the expression.`)];if(i.expressionContext==="property"&&i.propertyType==="layout"&&!Ki(s))return[new Ke(i.key,i.value,'"feature-state" data expressions are not supported with layout properties.')];if(i.expressionContext==="filter"&&!Ki(s))return[new Ke(i.key,i.value,'"feature-state" data expressions are not supported with filters.')];if(i.expressionContext&&i.expressionContext.indexOf("cluster")===0){if(!Wo(s,["zoom","feature-state"]))return[new Ke(i.key,i.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(i.expressionContext==="cluster-initial"&&!ul(s))return[new Ke(i.key,i.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function ds(i){const n=i.key,s=i.value,l=i.valueSpec,p=[];return Array.isArray(l.values)?l.values.indexOf(cr(s))===-1&&p.push(new Ke(n,s,`expected one of [${l.values.join(", ")}], ${JSON.stringify(s)} found`)):Object.keys(l.values).indexOf(cr(s))===-1&&p.push(new Ke(n,s,`expected one of [${Object.keys(l.values).join(", ")}], ${JSON.stringify(s)} found`)),p}function Ju(i){return Ci(Jr(i.value))?Ta(hi({},i,{expressionContext:"filter",valueSpec:{value:"boolean"}})):Xo(i)}function Xo(i){const n=i.value,s=i.key;if(An(n)!=="array")return[new Ke(s,n,`array expected, ${An(n)} found`)];const l=i.styleSpec;let p,v=[];if(n.length<1)return[new Ke(s,n,"filter array must have at least 1 element")];switch(v=v.concat(ds({key:`${s}[0]`,value:n[0],valueSpec:l.filter_operator,style:i.style,styleSpec:i.styleSpec})),cr(n[0])){case"<":case"<=":case">":case">=":n.length>=2&&cr(n[1])==="$type"&&v.push(new Ke(s,n,`"$type" cannot be use with operator "${n[0]}"`));case"==":case"!=":n.length!==3&&v.push(new Ke(s,n,`filter array for operator "${n[0]}" must have 3 elements`));case"in":case"!in":n.length>=2&&(p=An(n[1]),p!=="string"&&v.push(new Ke(`${s}[1]`,n[1],`string expected, ${p} found`)));for(let x=2;x<n.length;x++)p=An(n[x]),cr(n[1])==="$type"?v=v.concat(ds({key:`${s}[${x}]`,value:n[x],valueSpec:l.geometry_type,style:i.style,styleSpec:i.styleSpec})):p!=="string"&&p!=="number"&&p!=="boolean"&&v.push(new Ke(`${s}[${x}]`,n[x],`string, number, or boolean expected, ${p} found`));break;case"any":case"all":case"none":for(let x=1;x<n.length;x++)v=v.concat(Xo({key:`${s}[${x}]`,value:n[x],style:i.style,styleSpec:i.styleSpec}));break;case"has":case"!has":p=An(n[1]),n.length!==2?v.push(new Ke(s,n,`filter array for "${n[0]}" operator must have 2 elements`)):p!=="string"&&v.push(new Ke(`${s}[1]`,n[1],`string expected, ${p} found`))}return v}function yo(i,n){const s=i.key,l=i.validateSpec,p=i.style,v=i.styleSpec,x=i.value,S=i.objectKey,C=v[`${n}_${i.layerType}`];if(!C)return[];const P=S.match(/^(.*)-transition$/);if(n==="paint"&&P&&C[P[1]]&&C[P[1]].transition)return l({key:s,value:x,valueSpec:v.transition,style:p,styleSpec:v});const M=i.valueSpec||C[S];if(!M)return[new Ke(s,x,`unknown property "${S}"`)];let R;if(An(x)==="string"&&hl(M)&&!M.tokens&&(R=/^{([^}]+)}$/.exec(x)))return[new Ke(s,x,`"${S}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(R[1])} }\`.`)];const F=[];return i.layerType==="symbol"&&(S==="text-field"&&p&&!p.glyphs&&F.push(new Ke(s,x,'use of "text-field" requires a style "glyphs" property')),S==="text-font"&&Yu(Jr(x))&&cr(x.type)==="identity"&&F.push(new Ke(s,x,'"text-font" does not support identity functions'))),F.concat(l({key:i.key,value:x,valueSpec:M,style:p,styleSpec:v,expressionContext:"property",propertyType:n,propertyKey:S}))}function Ea(i){return yo(i,"paint")}function mh(i){return yo(i,"layout")}function gh(i){let n=[];const s=i.value,l=i.key,p=i.style,v=i.styleSpec;s.type||s.ref||n.push(new Ke(l,s,'either "type" or "ref" is required'));let x=cr(s.type);const S=cr(s.ref);if(s.id){const C=cr(s.id);for(let P=0;P<i.arrayIndex;P++){const M=p.layers[P];cr(M.id)===C&&n.push(new Ke(l,s.id,`duplicate layer id "${s.id}", previously used at line ${M.id.__line__}`))}}if("ref"in s){let C;["type","source","source-layer","filter","layout"].forEach(P=>{P in s&&n.push(new Ke(l,s[P],`"${P}" is prohibited for ref layers`))}),p.layers.forEach(P=>{cr(P.id)===S&&(C=P)}),C?C.ref?n.push(new Ke(l,s.ref,"ref cannot reference another ref layer")):x=cr(C.type):n.push(new Ke(l,s.ref,`ref layer "${S}" not found`))}else if(x!=="background")if(s.source){const C=p.sources&&p.sources[s.source],P=C&&cr(C.type);C?P==="vector"&&x==="raster"?n.push(new Ke(l,s.source,`layer "${s.id}" requires a raster source`)):P!=="raster-dem"&&x==="hillshade"?n.push(new Ke(l,s.source,`layer "${s.id}" requires a raster-dem source`)):P==="raster"&&x!=="raster"?n.push(new Ke(l,s.source,`layer "${s.id}" requires a vector source`)):P!=="vector"||s["source-layer"]?P==="raster-dem"&&x!=="hillshade"?n.push(new Ke(l,s.source,"raster-dem source can only be used with layer type 'hillshade'.")):x!=="line"||!s.paint||!s.paint["line-gradient"]||P==="geojson"&&C.lineMetrics||n.push(new Ke(l,s,`layer "${s.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):n.push(new Ke(l,s,`layer "${s.id}" must specify a "source-layer"`)):n.push(new Ke(l,s.source,`source "${s.source}" not found`))}else n.push(new Ke(l,s,'missing required property "source"'));return n=n.concat(fi({key:l,value:s,valueSpec:v.layer,style:i.style,styleSpec:i.styleSpec,validateSpec:i.validateSpec,objectElementValidators:{"*":()=>[],type:()=>i.validateSpec({key:`${l}.type`,value:s.type,valueSpec:v.layer.type,style:i.style,styleSpec:i.styleSpec,validateSpec:i.validateSpec,object:s,objectKey:"type"}),filter:Ju,layout:C=>fi({layer:s,key:C.key,value:C.value,style:C.style,styleSpec:C.styleSpec,validateSpec:C.validateSpec,objectElementValidators:{"*":P=>mh(hi({layerType:x},P))}}),paint:C=>fi({layer:s,key:C.key,value:C.value,style:C.style,styleSpec:C.styleSpec,validateSpec:C.validateSpec,objectElementValidators:{"*":P=>Ea(hi({layerType:x},P))}})}})),n}function Ca(i){const n=i.value,s=i.key,l=An(n);return l!=="string"?[new Ke(s,n,`string expected, ${l} found`)]:[]}const Ia={promoteId:function({key:i,value:n}){if(An(n)==="string")return Ca({key:i,value:n});{const s=[];for(const l in n)s.push(...Ca({key:`${i}.${l}`,value:n[l]}));return s}}};function Ko(i){const n=i.value,s=i.key,l=i.styleSpec,p=i.style,v=i.validateSpec;if(!n.type)return[new Ke(s,n,'"type" is required')];const x=cr(n.type);let S;switch(x){case"vector":case"raster":return S=fi({key:s,value:n,valueSpec:l[`source_${x.replace("-","_")}`],style:i.style,styleSpec:l,objectElementValidators:Ia,validateSpec:v}),S;case"raster-dem":return S=function(C){var P;const M=(P=C.sourceName)!==null&&P!==void 0?P:"",R=C.value,F=C.styleSpec,j=F.source_raster_dem,G=C.style;let Z=[];const ne=An(R);if(R===void 0)return Z;if(ne!=="object")return Z.push(new Ke("source_raster_dem",R,`object expected, ${ne} found`)),Z;const oe=cr(R.encoding)==="custom",Pe=["redFactor","greenFactor","blueFactor","baseShift"],ge=C.value.encoding?`"${C.value.encoding}"`:"Default";for(const _e in R)!oe&&Pe.includes(_e)?Z.push(new Ke(_e,R[_e],`In "${M}": "${_e}" is only valid when "encoding" is set to "custom". ${ge} encoding found`)):j[_e]?Z=Z.concat(C.validateSpec({key:_e,value:R[_e],valueSpec:j[_e],validateSpec:C.validateSpec,style:G,styleSpec:F})):Z.push(new Ke(_e,R[_e],`unknown property "${_e}"`));return Z}({sourceName:s,value:n,style:i.style,styleSpec:l,validateSpec:v}),S;case"geojson":if(S=fi({key:s,value:n,valueSpec:l.source_geojson,style:p,styleSpec:l,validateSpec:v,objectElementValidators:Ia}),n.cluster)for(const C in n.clusterProperties){const[P,M]=n.clusterProperties[C],R=typeof P=="string"?[P,["accumulated"],["get",C]]:P;S.push(...Ta({key:`${s}.${C}.map`,value:M,validateSpec:v,expressionContext:"cluster-map"})),S.push(...Ta({key:`${s}.${C}.reduce`,value:R,validateSpec:v,expressionContext:"cluster-reduce"}))}return S;case"video":return fi({key:s,value:n,valueSpec:l.source_video,style:p,validateSpec:v,styleSpec:l});case"image":return fi({key:s,value:n,valueSpec:l.source_image,style:p,validateSpec:v,styleSpec:l});case"canvas":return[new Ke(s,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return ds({key:`${s}.type`,value:n.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:p,validateSpec:v,styleSpec:l})}}function Ql(i){const n=i.value,s=i.styleSpec,l=s.light,p=i.style;let v=[];const x=An(n);if(n===void 0)return v;if(x!=="object")return v=v.concat([new Ke("light",n,`object expected, ${x} found`)]),v;for(const S in n){const C=S.match(/^(.*)-transition$/);v=v.concat(C&&l[C[1]]&&l[C[1]].transition?i.validateSpec({key:S,value:n[S],valueSpec:s.transition,validateSpec:i.validateSpec,style:p,styleSpec:s}):l[S]?i.validateSpec({key:S,value:n[S],valueSpec:l[S],validateSpec:i.validateSpec,style:p,styleSpec:s}):[new Ke(S,n[S],`unknown property "${S}"`)])}return v}function _h(i){const n=i.value,s=i.styleSpec,l=s.sky,p=i.style,v=An(n);if(n===void 0)return[];if(v!=="object")return[new Ke("sky",n,`object expected, ${v} found`)];let x=[];for(const S in n)x=x.concat(l[S]?i.validateSpec({key:S,value:n[S],valueSpec:l[S],style:p,styleSpec:s}):[new Ke(S,n[S],`unknown property "${S}"`)]);return x}function Qu(i){const n=i.value,s=i.styleSpec,l=s.terrain,p=i.style;let v=[];const x=An(n);if(n===void 0)return v;if(x!=="object")return v=v.concat([new Ke("terrain",n,`object expected, ${x} found`)]),v;for(const S in n)v=v.concat(l[S]?i.validateSpec({key:S,value:n[S],valueSpec:l[S],validateSpec:i.validateSpec,style:p,styleSpec:s}):[new Ke(S,n[S],`unknown property "${S}"`)]);return v}function yh(i){let n=[];const s=i.value,l=i.key;if(Array.isArray(s)){const p=[],v=[];for(const x in s)s[x].id&&p.includes(s[x].id)&&n.push(new Ke(l,s,`all the sprites' ids must be unique, but ${s[x].id} is duplicated`)),p.push(s[x].id),s[x].url&&v.includes(s[x].url)&&n.push(new Ke(l,s,`all the sprites' URLs must be unique, but ${s[x].url} is duplicated`)),v.push(s[x].url),n=n.concat(fi({key:`${l}[${x}]`,value:s[x],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:i.validateSpec}));return n}return Ca({key:l,value:s})}const ec={"*":()=>[],array:ml,boolean:function(i){const n=i.value,s=i.key,l=An(n);return l!=="boolean"?[new Ke(s,n,`boolean expected, ${l} found`)]:[]},number:gl,color:function(i){const n=i.key,s=i.value,l=An(s);return l!=="string"?[new Ke(n,s,`color expected, ${l} found`)]:Rn.parse(String(s))?[]:[new Ke(n,s,`color expected, "${s}" found`)]},constants:Dd,enum:ds,filter:Ju,function:Jl,layer:gh,object:fi,source:Ko,light:Ql,sky:_h,terrain:Qu,projection:function(i){const n=i.value,s=i.styleSpec,l=s.projection,p=i.style,v=An(n);if(n===void 0)return[];if(v!=="object")return[new Ke("projection",n,`object expected, ${v} found`)];let x=[];for(const S in n)x=x.concat(l[S]?i.validateSpec({key:S,value:n[S],valueSpec:l[S],style:p,styleSpec:s}):[new Ke(S,n[S],`unknown property "${S}"`)]);return x},string:Ca,formatted:function(i){return Ca(i).length===0?[]:Ta(i)},resolvedImage:function(i){return Ca(i).length===0?[]:Ta(i)},padding:function(i){const n=i.key,s=i.value;if(An(s)==="array"){if(s.length<1||s.length>4)return[new Ke(n,s,`padding requires 1 to 4 values; ${s.length} values found`)];const l={type:"number"};let p=[];for(let v=0;v<s.length;v++)p=p.concat(i.validateSpec({key:`${n}[${v}]`,value:s[v],validateSpec:i.validateSpec,valueSpec:l}));return p}return gl({key:n,value:s,valueSpec:{}})},variableAnchorOffsetCollection:function(i){const n=i.key,s=i.value,l=An(s),p=i.styleSpec;if(l!=="array"||s.length<1||s.length%2!=0)return[new Ke(n,s,"variableAnchorOffsetCollection requires a non-empty array of even length")];let v=[];for(let x=0;x<s.length;x+=2)v=v.concat(ds({key:`${n}[${x}]`,value:s[x],valueSpec:p.layout_symbol["text-anchor"]})),v=v.concat(ml({key:`${n}[${x+1}]`,value:s[x+1],valueSpec:{length:2,value:"number"},validateSpec:i.validateSpec,style:i.style,styleSpec:p}));return v},sprite:yh};function _r(i){const n=i.value,s=i.valueSpec,l=i.styleSpec;return i.validateSpec=_r,s.expression&&Yu(cr(n))?Jl(i):s.expression&&Tt(Jr(n))?Ta(i):s.type&&ec[s.type]?ec[s.type](i):fi(hi({},i,{valueSpec:s.type?l[s.type]:s}))}function ri(i){const n=i.value,s=i.key,l=Ca(i);return l.length||(n.indexOf("{fontstack}")===-1&&l.push(new Ke(s,n,'"glyphs" url must include a "{fontstack}" token')),n.indexOf("{range}")===-1&&l.push(new Ke(s,n,'"glyphs" url must include a "{range}" token'))),l}function fs(i,n=Ce){let s=[];return s=s.concat(_r({key:"",value:i,valueSpec:n.$root,styleSpec:n,style:i,validateSpec:_r,objectElementValidators:{glyphs:ri,"*":()=>[]}})),i.constants&&(s=s.concat(Dd({key:"constants",value:i.constants,style:i,styleSpec:n,validateSpec:_r}))),tc(s)}function eo(i){return function(n){return i({...n,validateSpec:_r})}}function tc(i){return[].concat(i).sort((n,s)=>n.line-s.line)}function Fs(i){return function(...n){return tc(i.apply(this,n))}}fs.source=Fs(eo(Ko)),fs.sprite=Fs(eo(yh)),fs.glyphs=Fs(eo(ri)),fs.light=Fs(eo(Ql)),fs.sky=Fs(eo(_h)),fs.terrain=Fs(eo(Qu)),fs.layer=Fs(eo(gh)),fs.filter=Fs(eo(Ju)),fs.paintProperty=Fs(eo(Ea)),fs.layoutProperty=Fs(eo(mh));const vo=fs,eu=vo.light,vh=vo.sky,ka=vo.paintProperty,_l=vo.layoutProperty;function Pa(i,n){let s=!1;if(n&&n.length)for(const l of n)i.fire(new sn(new Error(l.message))),s=!0;return s}class xo{constructor(n,s,l){const p=this.cells=[];if(n instanceof ArrayBuffer){this.arrayBuffer=n;const x=new Int32Array(this.arrayBuffer);n=x[0],this.d=(s=x[1])+2*(l=x[2]);for(let C=0;C<this.d*this.d;C++){const P=x[3+C],M=x[3+C+1];p.push(P===M?null:x.subarray(P,M))}const S=x[3+p.length+1];this.keys=x.subarray(x[3+p.length],S),this.bboxes=x.subarray(S),this.insert=this._insertReadonly}else{this.d=s+2*l;for(let x=0;x<this.d*this.d;x++)p.push([]);this.keys=[],this.bboxes=[]}this.n=s,this.extent=n,this.padding=l,this.scale=s/n,this.uid=0;const v=l/s*n;this.min=-v,this.max=n+v}insert(n,s,l,p,v){this._forEachCell(s,l,p,v,this._insertCell,this.uid++,void 0,void 0),this.keys.push(n),this.bboxes.push(s),this.bboxes.push(l),this.bboxes.push(p),this.bboxes.push(v)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(n,s,l,p,v,x){this.cells[v].push(x)}query(n,s,l,p,v){const x=this.min,S=this.max;if(n<=x&&s<=x&&S<=l&&S<=p&&!v)return Array.prototype.slice.call(this.keys);{const C=[];return this._forEachCell(n,s,l,p,this._queryCell,C,{},v),C}}_queryCell(n,s,l,p,v,x,S,C){const P=this.cells[v];if(P!==null){const M=this.keys,R=this.bboxes;for(let F=0;F<P.length;F++){const j=P[F];if(S[j]===void 0){const G=4*j;(C?C(R[G+0],R[G+1],R[G+2],R[G+3]):n<=R[G+2]&&s<=R[G+3]&&l>=R[G+0]&&p>=R[G+1])?(S[j]=!0,x.push(M[j])):S[j]=!1}}}}_forEachCell(n,s,l,p,v,x,S,C){const P=this._convertToCellCoord(n),M=this._convertToCellCoord(s),R=this._convertToCellCoord(l),F=this._convertToCellCoord(p);for(let j=P;j<=R;j++)for(let G=M;G<=F;G++){const Z=this.d*G+j;if((!C||C(this._convertFromCellCoord(j),this._convertFromCellCoord(G),this._convertFromCellCoord(j+1),this._convertFromCellCoord(G+1)))&&v.call(this,n,s,l,p,Z,x,S,C))return}}_convertFromCellCoord(n){return(n-this.padding)/this.scale}_convertToCellCoord(n){return Math.max(0,Math.min(this.d-1,Math.floor(n*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const n=this.cells,s=3+this.cells.length+1+1;let l=0;for(let x=0;x<this.cells.length;x++)l+=this.cells[x].length;const p=new Int32Array(s+l+this.keys.length+this.bboxes.length);p[0]=this.extent,p[1]=this.n,p[2]=this.padding;let v=s;for(let x=0;x<n.length;x++){const S=n[x];p[3+x]=v,p.set(S,v),v+=S.length}return p[3+n.length]=v,p.set(this.keys,v),v+=this.keys.length,p[3+n.length+1]=v,p.set(this.bboxes,v),v+=this.bboxes.length,p.buffer}static serialize(n,s){const l=n.toArrayBuffer();return s&&s.push(l),{buffer:l}}static deserialize(n){return new xo(n.buffer)}}const ii={};function vt(i,n,s={}){if(ii[i])throw new Error(`${i} is already registered.`);Object.defineProperty(n,"_classRegistryKey",{value:i,writeable:!1}),ii[i]={klass:n,omit:s.omit||[],shallow:s.shallow||[]}}vt("Object",Object),vt("TransferableGridIndex",xo),vt("Color",Rn),vt("Error",Error),vt("AJAXError",Nn),vt("ResolvedImage",Xi),vt("StylePropertyFunction",Ho),vt("StyleExpression",Oe,{omit:["_evaluator"]}),vt("ZoomDependentExpression",gr),vt("ZoomConstantExpression",Tn),vt("CompoundExpression",hs,{omit:["_evaluate"]});for(const i in ll)ll[i]._classRegistryKey||vt(`Expression_${i}`,ll[i]);function nc(i){return i&&typeof ArrayBuffer<"u"&&(i instanceof ArrayBuffer||i.constructor&&i.constructor.name==="ArrayBuffer")}function xh(i){return i.$name||i.constructor._classRegistryKey}function Rd(i){return!function(n){if(n===null||typeof n!="object")return!1;const s=xh(n);return!(!s||s==="Object")}(i)&&(i==null||typeof i=="boolean"||typeof i=="number"||typeof i=="string"||i instanceof Boolean||i instanceof Number||i instanceof String||i instanceof Date||i instanceof RegExp||i instanceof Blob||i instanceof Error||nc(i)||zt(i)||ArrayBuffer.isView(i)||i instanceof ImageData)}function yl(i,n){if(Rd(i))return(nc(i)||zt(i))&&n&&n.push(i),ArrayBuffer.isView(i)&&n&&n.push(i.buffer),i instanceof ImageData&&n&&n.push(i.data.buffer),i;if(Array.isArray(i)){const v=[];for(const x of i)v.push(yl(x,n));return v}if(typeof i!="object")throw new Error("can't serialize object of type "+typeof i);const s=xh(i);if(!s)throw new Error(`can't serialize object of unregistered class ${i.constructor.name}`);if(!ii[s])throw new Error(`${s} is not registered.`);const{klass:l}=ii[s],p=l.serialize?l.serialize(i,n):{};if(l.serialize){if(n&&p===n[n.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const v in i){if(!i.hasOwnProperty(v)||ii[s].omit.indexOf(v)>=0)continue;const x=i[v];p[v]=ii[s].shallow.indexOf(v)>=0?x:yl(x,n)}i instanceof Error&&(p.message=i.message)}if(p.$name)throw new Error("$name property is reserved for worker serialization logic.");return s!=="Object"&&(p.$name=s),p}function wo(i){if(Rd(i))return i;if(Array.isArray(i))return i.map(wo);if(typeof i!="object")throw new Error("can't deserialize object of type "+typeof i);const n=xh(i)||"Object";if(!ii[n])throw new Error(`can't deserialize unregistered class ${n}`);const{klass:s}=ii[n];if(!s)throw new Error(`can't deserialize unregistered class ${n}`);if(s.deserialize)return s.deserialize(i);const l=Object.create(s.prototype);for(const p of Object.keys(i)){if(p==="$name")continue;const v=i[p];l[p]=ii[n].shallow.indexOf(p)>=0?v:wo(v)}return l}class Aa{constructor(){this.first=!0}update(n,s){const l=Math.floor(n);return this.first?(this.first=!1,this.lastIntegerZoom=l,this.lastIntegerZoomTime=0,this.lastZoom=n,this.lastFloorZoom=l,!0):(this.lastFloorZoom>l?(this.lastIntegerZoom=l+1,this.lastIntegerZoomTime=s):this.lastFloorZoom<l&&(this.lastIntegerZoom=l,this.lastIntegerZoomTime=s),n!==this.lastZoom&&(this.lastZoom=n,this.lastFloorZoom=l,!0))}}const mn={"Latin-1 Supplement":i=>i>=128&&i<=255,"Hangul Jamo":i=>i>=4352&&i<=4607,Khmer:i=>i>=6016&&i<=6143,"General Punctuation":i=>i>=8192&&i<=8303,"Letterlike Symbols":i=>i>=8448&&i<=8527,"Number Forms":i=>i>=8528&&i<=8591,"Miscellaneous Technical":i=>i>=8960&&i<=9215,"Control Pictures":i=>i>=9216&&i<=9279,"Optical Character Recognition":i=>i>=9280&&i<=9311,"Enclosed Alphanumerics":i=>i>=9312&&i<=9471,"Geometric Shapes":i=>i>=9632&&i<=9727,"Miscellaneous Symbols":i=>i>=9728&&i<=9983,"Miscellaneous Symbols and Arrows":i=>i>=11008&&i<=11263,"Ideographic Description Characters":i=>i>=12272&&i<=12287,"CJK Symbols and Punctuation":i=>i>=12288&&i<=12351,Katakana:i=>i>=12448&&i<=12543,Kanbun:i=>i>=12688&&i<=12703,"CJK Strokes":i=>i>=12736&&i<=12783,"Enclosed CJK Letters and Months":i=>i>=12800&&i<=13055,"CJK Compatibility":i=>i>=13056&&i<=13311,"Yijing Hexagram Symbols":i=>i>=19904&&i<=19967,"Private Use Area":i=>i>=57344&&i<=63743,"Vertical Forms":i=>i>=65040&&i<=65055,"CJK Compatibility Forms":i=>i>=65072&&i<=65103,"Small Form Variants":i=>i>=65104&&i<=65135,"Halfwidth and Fullwidth Forms":i=>i>=65280&&i<=65519};function H(i){for(const n of i)if(wh(n.charCodeAt(0)))return!0;return!1}function vl(i){for(const n of i)if(!ln(n.charCodeAt(0)))return!1;return!0}function xl(i){const n=i.map(s=>{try{return new RegExp(`\\p{sc=${s}}`,"u").source}catch{return null}}).filter(s=>s);return new RegExp(n.join("|"),"u")}const ps=xl(["Arab","Dupl","Mong","Ougr","Syrc"]);function ln(i){return!ps.test(String.fromCodePoint(i))}const Ld=xl(["Bopo","Hani","Hira","Kana","Kits","Nshu","Tang","Yiii"]);function wh(i){return!(i!==746&&i!==747&&(i<4352||!(mn["CJK Compatibility Forms"](i)&&!(i>=65097&&i<=65103)||mn["CJK Compatibility"](i)||mn["CJK Strokes"](i)||!(!mn["CJK Symbols and Punctuation"](i)||i>=12296&&i<=12305||i>=12308&&i<=12319||i===12336)||mn["Enclosed CJK Letters and Months"](i)||mn["Ideographic Description Characters"](i)||mn.Kanbun(i)||mn.Katakana(i)&&i!==12540||!(!mn["Halfwidth and Fullwidth Forms"](i)||i===65288||i===65289||i===65293||i>=65306&&i<=65310||i===65339||i===65341||i===65343||i>=65371&&i<=65503||i===65507||i>=65512&&i<=65519)||!(!mn["Small Form Variants"](i)||i>=65112&&i<=65118||i>=65123&&i<=65126)||mn["Vertical Forms"](i)||mn["Yijing Hexagram Symbols"](i)||new RegExp("\\p{sc=Cans}","u").test(String.fromCodePoint(i))||new RegExp("\\p{sc=Hang}","u").test(String.fromCodePoint(i))||Ld.test(String.fromCodePoint(i)))))}function Od(i){return!(wh(i)||function(n){return!!(mn["Latin-1 Supplement"](n)&&(n===167||n===169||n===174||n===177||n===188||n===189||n===190||n===215||n===247)||mn["General Punctuation"](n)&&(n===8214||n===8224||n===8225||n===8240||n===8241||n===8251||n===8252||n===8258||n===8263||n===8264||n===8265||n===8273)||mn["Letterlike Symbols"](n)||mn["Number Forms"](n)||mn["Miscellaneous Technical"](n)&&(n>=8960&&n<=8967||n>=8972&&n<=8991||n>=8996&&n<=9e3||n===9003||n>=9085&&n<=9114||n>=9150&&n<=9165||n===9167||n>=9169&&n<=9179||n>=9186&&n<=9215)||mn["Control Pictures"](n)&&n!==9251||mn["Optical Character Recognition"](n)||mn["Enclosed Alphanumerics"](n)||mn["Geometric Shapes"](n)||mn["Miscellaneous Symbols"](n)&&!(n>=9754&&n<=9759)||mn["Miscellaneous Symbols and Arrows"](n)&&(n>=11026&&n<=11055||n>=11088&&n<=11097||n>=11192&&n<=11243)||mn["CJK Symbols and Punctuation"](n)||mn.Katakana(n)||mn["Private Use Area"](n)||mn["CJK Compatibility Forms"](n)||mn["Small Form Variants"](n)||mn["Halfwidth and Fullwidth Forms"](n)||n===8734||n===8756||n===8757||n>=9984&&n<=10087||n>=10102&&n<=10131||n===65532||n===65533)}(i))}const Ma=xl(["Adlm","Arab","Armi","Avst","Chrs","Cprt","Egyp","Elym","Gara","Hatr","Hebr","Hung","Khar","Lydi","Mand","Mani","Mend","Merc","Mero","Narb","Nbat","Nkoo","Orkh","Palm","Phli","Phlp","Phnx","Prti","Rohg","Samr","Sarb","Sogo","Syrc","Thaa","Todr","Yezi"]);function bh(i){return Ma.test(String.fromCodePoint(i))}function cp(i,n){return!(!n&&bh(i)||i>=2304&&i<=3583||i>=3840&&i<=4255||mn.Khmer(i))}function hp(i){for(const n of i)if(bh(n.charCodeAt(0)))return!0;return!1}const Ji=new class{constructor(){this.applyArabicShaping=null,this.processBidirectionalText=null,this.processStyledBidirectionalText=null,this.pluginStatus="unavailable",this.pluginURL=null}setState(i){this.pluginStatus=i.pluginStatus,this.pluginURL=i.pluginURL}getState(){return{pluginStatus:this.pluginStatus,pluginURL:this.pluginURL}}setMethods(i){this.applyArabicShaping=i.applyArabicShaping,this.processBidirectionalText=i.processBidirectionalText,this.processStyledBidirectionalText=i.processStyledBidirectionalText}isParsed(){return this.applyArabicShaping!=null&&this.processBidirectionalText!=null&&this.processStyledBidirectionalText!=null}getPluginURL(){return this.pluginURL}getRTLTextPluginStatus(){return this.pluginStatus}};class ar{constructor(n,s){this.zoom=n,s?(this.now=s.now,this.fadeDuration=s.fadeDuration,this.zoomHistory=s.zoomHistory,this.transition=s.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Aa,this.transition={})}isSupportedScript(n){return function(s,l){for(const p of s)if(!cp(p.charCodeAt(0),l))return!1;return!0}(n,Ji.getRTLTextPluginStatus()==="loaded")}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const n=this.zoom,s=n-Math.floor(n),l=this.crossFadingFactor();return n>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:s+(1-s)*l}:{fromScale:.5,toScale:1,t:1-(1-l)*s}}}class Bi{constructor(n,s){this.property=n,this.value=s,this.expression=function(l,p){if(Yu(l))return new Ho(l,p);if(Tt(l)){const v=Hn(l,p);if(v.result==="error")throw new Error(v.value.map(x=>`${x.key}: ${x.message}`).join(", "));return v.value}{let v=l;return p.type==="color"&&typeof l=="string"?v=Rn.parse(l):p.type!=="padding"||typeof l!="number"&&!Array.isArray(l)?p.type==="variableAnchorOffsetCollection"&&Array.isArray(l)&&(v=Hi.parse(l)):v=Ri.parse(l),{kind:"constant",evaluate:()=>v}}}(s===void 0?n.specification.default:s,n.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(n,s,l){return this.property.possiblyEvaluate(this,n,s,l)}}class rc{constructor(n){this.property=n,this.value=new Bi(n,void 0)}transitioned(n,s){return new Fd(this.property,this.value,s,ve({},n.transition,this.transition),n.now)}untransitioned(){return new Fd(this.property,this.value,null,{},0)}}class ic{constructor(n){this._properties=n,this._values=Object.create(n.defaultTransitionablePropertyValues)}getValue(n){return Ue(this._values[n].value.value)}setValue(n,s){Object.prototype.hasOwnProperty.call(this._values,n)||(this._values[n]=new rc(this._values[n].property)),this._values[n].value=new Bi(this._values[n].property,s===null?void 0:Ue(s))}getTransition(n){return Ue(this._values[n].transition)}setTransition(n,s){Object.prototype.hasOwnProperty.call(this._values,n)||(this._values[n]=new rc(this._values[n].property)),this._values[n].transition=Ue(s)||void 0}serialize(){const n={};for(const s of Object.keys(this._values)){const l=this.getValue(s);l!==void 0&&(n[s]=l);const p=this.getTransition(s);p!==void 0&&(n[`${s}-transition`]=p)}return n}transitioned(n,s){const l=new tu(this._properties);for(const p of Object.keys(this._values))l._values[p]=this._values[p].transitioned(n,s._values[p]);return l}untransitioned(){const n=new tu(this._properties);for(const s of Object.keys(this._values))n._values[s]=this._values[s].untransitioned();return n}}class Fd{constructor(n,s,l,p,v){this.property=n,this.value=s,this.begin=v+p.delay||0,this.end=this.begin+p.duration||0,n.specification.transition&&(p.delay||p.duration)&&(this.prior=l)}possiblyEvaluate(n,s,l){const p=n.now||0,v=this.value.possiblyEvaluate(n,s,l),x=this.prior;if(x){if(p>this.end)return this.prior=null,v;if(this.value.isDataDriven())return this.prior=null,v;if(p<this.begin)return x.possiblyEvaluate(n,s,l);{const S=(p-this.begin)/(this.end-this.begin);return this.property.interpolate(x.possiblyEvaluate(n,s,l),v,function(C){if(C<=0)return 0;if(C>=1)return 1;const P=C*C,M=P*C;return 4*(C<.5?M:3*(C-P)+M-.75)}(S))}}return v}}class tu{constructor(n){this._properties=n,this._values=Object.create(n.defaultTransitioningPropertyValues)}possiblyEvaluate(n,s,l){const p=new ru(this._properties);for(const v of Object.keys(this._values))p._values[v]=this._values[v].possiblyEvaluate(n,s,l);return p}hasTransition(){for(const n of Object.keys(this._values))if(this._values[n].prior)return!0;return!1}}class nu{constructor(n){this._properties=n,this._values=Object.create(n.defaultPropertyValues)}hasValue(n){return this._values[n].value!==void 0}getValue(n){return Ue(this._values[n].value)}setValue(n,s){this._values[n]=new Bi(this._values[n].property,s===null?void 0:Ue(s))}serialize(){const n={};for(const s of Object.keys(this._values)){const l=this.getValue(s);l!==void 0&&(n[s]=l)}return n}possiblyEvaluate(n,s,l){const p=new ru(this._properties);for(const v of Object.keys(this._values))p._values[v]=this._values[v].possiblyEvaluate(n,s,l);return p}}class Qr{constructor(n,s,l){this.property=n,this.value=s,this.parameters=l}isConstant(){return this.value.kind==="constant"}constantOr(n){return this.value.kind==="constant"?this.value.value:n}evaluate(n,s,l,p){return this.property.evaluate(this.value,this.parameters,n,s,l,p)}}class ru{constructor(n){this._properties=n,this._values=Object.create(n.defaultPossiblyEvaluatedValues)}get(n){return this._values[n]}}class Ct{constructor(n){this.specification=n}possiblyEvaluate(n,s){if(n.isDataDriven())throw new Error("Value should not be data driven");return n.expression.evaluate(s)}interpolate(n,s,l){const p=Oi[this.specification.type];return p?p(n,s,l):n}}class Bt{constructor(n,s){this.specification=n,this.overrides=s}possiblyEvaluate(n,s,l,p){return new Qr(this,n.expression.kind==="constant"||n.expression.kind==="camera"?{kind:"constant",value:n.expression.evaluate(s,null,{},l,p)}:n.expression,s)}interpolate(n,s,l){if(n.value.kind!=="constant"||s.value.kind!=="constant")return n;if(n.value.value===void 0||s.value.value===void 0)return new Qr(this,{kind:"constant",value:void 0},n.parameters);const p=Oi[this.specification.type];if(p){const v=p(n.value.value,s.value.value,l);return new Qr(this,{kind:"constant",value:v},n.parameters)}return n}evaluate(n,s,l,p,v,x){return n.kind==="constant"?n.value:n.evaluate(s,l,p,v,x)}}class sc extends Bt{possiblyEvaluate(n,s,l,p){if(n.value===void 0)return new Qr(this,{kind:"constant",value:void 0},s);if(n.expression.kind==="constant"){const v=n.expression.evaluate(s,null,{},l,p),x=n.property.specification.type==="resolvedImage"&&typeof v!="string"?v.name:v,S=this._calculate(x,x,x,s);return new Qr(this,{kind:"constant",value:S},s)}if(n.expression.kind==="camera"){const v=this._calculate(n.expression.evaluate({zoom:s.zoom-1}),n.expression.evaluate({zoom:s.zoom}),n.expression.evaluate({zoom:s.zoom+1}),s);return new Qr(this,{kind:"constant",value:v},s)}return new Qr(this,n.expression,s)}evaluate(n,s,l,p,v,x){if(n.kind==="source"){const S=n.evaluate(s,l,p,v,x);return this._calculate(S,S,S,s)}return n.kind==="composite"?this._calculate(n.evaluate({zoom:Math.floor(s.zoom)-1},l,p),n.evaluate({zoom:Math.floor(s.zoom)},l,p),n.evaluate({zoom:Math.floor(s.zoom)+1},l,p),s):n.value}_calculate(n,s,l,p){return p.zoom>p.zoomHistory.lastIntegerZoom?{from:n,to:s}:{from:l,to:s}}interpolate(n){return n}}class oc{constructor(n){this.specification=n}possiblyEvaluate(n,s,l,p){if(n.value!==void 0){if(n.expression.kind==="constant"){const v=n.expression.evaluate(s,null,{},l,p);return this._calculate(v,v,v,s)}return this._calculate(n.expression.evaluate(new ar(Math.floor(s.zoom-1),s)),n.expression.evaluate(new ar(Math.floor(s.zoom),s)),n.expression.evaluate(new ar(Math.floor(s.zoom+1),s)),s)}}_calculate(n,s,l,p){return p.zoom>p.zoomHistory.lastIntegerZoom?{from:n,to:s}:{from:l,to:s}}interpolate(n){return n}}class bo{constructor(n){this.specification=n}possiblyEvaluate(n,s,l,p){return!!n.expression.evaluate(s,null,{},l,p)}interpolate(){return!1}}class y{constructor(n){this.properties=n,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const s in n){const l=n[s];l.specification.overridable&&this.overridableProperties.push(s);const p=this.defaultPropertyValues[s]=new Bi(l,void 0),v=this.defaultTransitionablePropertyValues[s]=new rc(l);this.defaultTransitioningPropertyValues[s]=v.untransitioned(),this.defaultPossiblyEvaluatedValues[s]=p.possiblyEvaluate({})}}}vt("DataDrivenProperty",Bt),vt("DataConstantProperty",Ct),vt("CrossFadedDataDrivenProperty",sc),vt("CrossFadedProperty",oc),vt("ColorRampProperty",bo);const t="-transition";class a extends dn{constructor(n,s){if(super(),this.id=n.id,this.type=n.type,this._featureFilter={filter:()=>!0,needGeometry:!1},n.type!=="custom"&&(this.metadata=n.metadata,this.minzoom=n.minzoom,this.maxzoom=n.maxzoom,n.type!=="background"&&(this.source=n.source,this.sourceLayer=n["source-layer"],this.filter=n.filter),s.layout&&(this._unevaluatedLayout=new nu(s.layout)),s.paint)){this._transitionablePaint=new ic(s.paint);for(const l in n.paint)this.setPaintProperty(l,n.paint[l],{validate:!1});for(const l in n.layout)this.setLayoutProperty(l,n.layout[l],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new ru(s.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(n){return n==="visibility"?this.visibility:this._unevaluatedLayout.getValue(n)}setLayoutProperty(n,s,l={}){s!=null&&this._validate(_l,`layers.${this.id}.layout.${n}`,n,s,l)||(n!=="visibility"?this._unevaluatedLayout.setValue(n,s):this.visibility=s)}getPaintProperty(n){return n.endsWith(t)?this._transitionablePaint.getTransition(n.slice(0,-11)):this._transitionablePaint.getValue(n)}setPaintProperty(n,s,l={}){if(s!=null&&this._validate(ka,`layers.${this.id}.paint.${n}`,n,s,l))return!1;if(n.endsWith(t))return this._transitionablePaint.setTransition(n.slice(0,-11),s||void 0),!1;{const p=this._transitionablePaint._values[n],v=p.property.specification["property-type"]==="cross-faded-data-driven",x=p.value.isDataDriven(),S=p.value;this._transitionablePaint.setValue(n,s),this._handleSpecialPaintPropertyUpdate(n);const C=this._transitionablePaint._values[n].value;return C.isDataDriven()||x||v||this._handleOverridablePaintPropertyUpdate(n,S,C)}}_handleSpecialPaintPropertyUpdate(n){}_handleOverridablePaintPropertyUpdate(n,s,l){return!1}isHidden(n){return!!(this.minzoom&&n<this.minzoom)||!!(this.maxzoom&&n>=this.maxzoom)||this.visibility==="none"}updateTransitions(n){this._transitioningPaint=this._transitionablePaint.transitioned(n,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(n,s){n.getCrossfadeParameters&&(this._crossfadeParameters=n.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(n,void 0,s)),this.paint=this._transitioningPaint.possiblyEvaluate(n,void 0,s)}serialize(){const n={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(n.layout=n.layout||{},n.layout.visibility=this.visibility),Te(n,(s,l)=>!(s===void 0||l==="layout"&&!Object.keys(s).length||l==="paint"&&!Object.keys(s).length))}_validate(n,s,l,p,v={}){return(!v||v.validate!==!1)&&Pa(this,n.call(vo,{key:s,layerType:this.type,objectKey:l,value:p,styleSpec:Ce,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const n in this.paint._values){const s=this.paint.get(n);if(s instanceof Qr&&hl(s.property.specification)&&(s.value.kind==="source"||s.value.kind==="composite")&&s.value.isStateDependent)return!0}return!1}}const d={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class f{constructor(n,s){this._structArray=n,this._pos1=s*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class g{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(n,s){return n._trim(),s&&(n.isTransferred=!0,s.push(n.arrayBuffer)),{length:n.length,arrayBuffer:n.arrayBuffer}}static deserialize(n){const s=Object.create(this.prototype);return s.arrayBuffer=n.arrayBuffer,s.length=n.length,s.capacity=n.arrayBuffer.byteLength/s.bytesPerElement,s._refreshViews(),s}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(n){this.reserve(n),this.length=n}reserve(n){if(n>this.capacity){this.capacity=Math.max(n,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const s=this.uint8;this._refreshViews(),s&&this.uint8.set(s)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function E(i,n=1){let s=0,l=0;return{members:i.map(p=>{const v=d[p.type].BYTES_PER_ELEMENT,x=s=I(s,Math.max(n,v)),S=p.components||1;return l=Math.max(l,v),s+=v*S,{name:p.name,type:p.type,components:S,offset:x}}),size:I(s,Math.max(l,n)),alignment:n}}function I(i,n){return Math.ceil(i/n)*n}class k extends g{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,s){const l=this.length;return this.resize(l+1),this.emplace(l,n,s)}emplace(n,s,l){const p=2*n;return this.int16[p+0]=s,this.int16[p+1]=l,n}}k.prototype.bytesPerElement=4,vt("StructArrayLayout2i4",k);class z extends g{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,s,l){const p=this.length;return this.resize(p+1),this.emplace(p,n,s,l)}emplace(n,s,l,p){const v=3*n;return this.int16[v+0]=s,this.int16[v+1]=l,this.int16[v+2]=p,n}}z.prototype.bytesPerElement=6,vt("StructArrayLayout3i6",z);class L extends g{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,s,l,p){const v=this.length;return this.resize(v+1),this.emplace(v,n,s,l,p)}emplace(n,s,l,p,v){const x=4*n;return this.int16[x+0]=s,this.int16[x+1]=l,this.int16[x+2]=p,this.int16[x+3]=v,n}}L.prototype.bytesPerElement=8,vt("StructArrayLayout4i8",L);class O extends g{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,s,l,p,v,x){const S=this.length;return this.resize(S+1),this.emplace(S,n,s,l,p,v,x)}emplace(n,s,l,p,v,x,S){const C=6*n;return this.int16[C+0]=s,this.int16[C+1]=l,this.int16[C+2]=p,this.int16[C+3]=v,this.int16[C+4]=x,this.int16[C+5]=S,n}}O.prototype.bytesPerElement=12,vt("StructArrayLayout2i4i12",O);class V extends g{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,s,l,p,v,x){const S=this.length;return this.resize(S+1),this.emplace(S,n,s,l,p,v,x)}emplace(n,s,l,p,v,x,S){const C=4*n,P=8*n;return this.int16[C+0]=s,this.int16[C+1]=l,this.uint8[P+4]=p,this.uint8[P+5]=v,this.uint8[P+6]=x,this.uint8[P+7]=S,n}}V.prototype.bytesPerElement=8,vt("StructArrayLayout2i4ub8",V);class X extends g{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,s){const l=this.length;return this.resize(l+1),this.emplace(l,n,s)}emplace(n,s,l){const p=2*n;return this.float32[p+0]=s,this.float32[p+1]=l,n}}X.prototype.bytesPerElement=8,vt("StructArrayLayout2f8",X);class Q extends g{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,s,l,p,v,x,S,C,P,M){const R=this.length;return this.resize(R+1),this.emplace(R,n,s,l,p,v,x,S,C,P,M)}emplace(n,s,l,p,v,x,S,C,P,M,R){const F=10*n;return this.uint16[F+0]=s,this.uint16[F+1]=l,this.uint16[F+2]=p,this.uint16[F+3]=v,this.uint16[F+4]=x,this.uint16[F+5]=S,this.uint16[F+6]=C,this.uint16[F+7]=P,this.uint16[F+8]=M,this.uint16[F+9]=R,n}}Q.prototype.bytesPerElement=20,vt("StructArrayLayout10ui20",Q);class ie extends g{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,s,l,p,v,x,S,C,P,M,R,F){const j=this.length;return this.resize(j+1),this.emplace(j,n,s,l,p,v,x,S,C,P,M,R,F)}emplace(n,s,l,p,v,x,S,C,P,M,R,F,j){const G=12*n;return this.int16[G+0]=s,this.int16[G+1]=l,this.int16[G+2]=p,this.int16[G+3]=v,this.uint16[G+4]=x,this.uint16[G+5]=S,this.uint16[G+6]=C,this.uint16[G+7]=P,this.int16[G+8]=M,this.int16[G+9]=R,this.int16[G+10]=F,this.int16[G+11]=j,n}}ie.prototype.bytesPerElement=24,vt("StructArrayLayout4i4ui4i24",ie);class le extends g{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,s,l){const p=this.length;return this.resize(p+1),this.emplace(p,n,s,l)}emplace(n,s,l,p){const v=3*n;return this.float32[v+0]=s,this.float32[v+1]=l,this.float32[v+2]=p,n}}le.prototype.bytesPerElement=12,vt("StructArrayLayout3f12",le);class ce extends g{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(n){const s=this.length;return this.resize(s+1),this.emplace(s,n)}emplace(n,s){return this.uint32[1*n+0]=s,n}}ce.prototype.bytesPerElement=4,vt("StructArrayLayout1ul4",ce);class me extends g{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,s,l,p,v,x,S,C,P){const M=this.length;return this.resize(M+1),this.emplace(M,n,s,l,p,v,x,S,C,P)}emplace(n,s,l,p,v,x,S,C,P,M){const R=10*n,F=5*n;return this.int16[R+0]=s,this.int16[R+1]=l,this.int16[R+2]=p,this.int16[R+3]=v,this.int16[R+4]=x,this.int16[R+5]=S,this.uint32[F+3]=C,this.uint16[R+8]=P,this.uint16[R+9]=M,n}}me.prototype.bytesPerElement=20,vt("StructArrayLayout6i1ul2ui20",me);class te extends g{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,s,l,p,v,x){const S=this.length;return this.resize(S+1),this.emplace(S,n,s,l,p,v,x)}emplace(n,s,l,p,v,x,S){const C=6*n;return this.int16[C+0]=s,this.int16[C+1]=l,this.int16[C+2]=p,this.int16[C+3]=v,this.int16[C+4]=x,this.int16[C+5]=S,n}}te.prototype.bytesPerElement=12,vt("StructArrayLayout2i2i2i12",te);class xe extends g{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,s,l,p,v){const x=this.length;return this.resize(x+1),this.emplace(x,n,s,l,p,v)}emplace(n,s,l,p,v,x){const S=4*n,C=8*n;return this.float32[S+0]=s,this.float32[S+1]=l,this.float32[S+2]=p,this.int16[C+6]=v,this.int16[C+7]=x,n}}xe.prototype.bytesPerElement=16,vt("StructArrayLayout2f1f2i16",xe);class be extends g{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,s,l,p,v,x){const S=this.length;return this.resize(S+1),this.emplace(S,n,s,l,p,v,x)}emplace(n,s,l,p,v,x,S){const C=16*n,P=4*n,M=8*n;return this.uint8[C+0]=s,this.uint8[C+1]=l,this.float32[P+1]=p,this.float32[P+2]=v,this.int16[M+6]=x,this.int16[M+7]=S,n}}be.prototype.bytesPerElement=16,vt("StructArrayLayout2ub2f2i16",be);class Me extends g{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,s,l){const p=this.length;return this.resize(p+1),this.emplace(p,n,s,l)}emplace(n,s,l,p){const v=3*n;return this.uint16[v+0]=s,this.uint16[v+1]=l,this.uint16[v+2]=p,n}}Me.prototype.bytesPerElement=6,vt("StructArrayLayout3ui6",Me);class qe extends g{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,s,l,p,v,x,S,C,P,M,R,F,j,G,Z,ne,oe){const Pe=this.length;return this.resize(Pe+1),this.emplace(Pe,n,s,l,p,v,x,S,C,P,M,R,F,j,G,Z,ne,oe)}emplace(n,s,l,p,v,x,S,C,P,M,R,F,j,G,Z,ne,oe,Pe){const ge=24*n,_e=12*n,Le=48*n;return this.int16[ge+0]=s,this.int16[ge+1]=l,this.uint16[ge+2]=p,this.uint16[ge+3]=v,this.uint32[_e+2]=x,this.uint32[_e+3]=S,this.uint32[_e+4]=C,this.uint16[ge+10]=P,this.uint16[ge+11]=M,this.uint16[ge+12]=R,this.float32[_e+7]=F,this.float32[_e+8]=j,this.uint8[Le+36]=G,this.uint8[Le+37]=Z,this.uint8[Le+38]=ne,this.uint32[_e+10]=oe,this.int16[ge+22]=Pe,n}}qe.prototype.bytesPerElement=48,vt("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",qe);class et extends g{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,s,l,p,v,x,S,C,P,M,R,F,j,G,Z,ne,oe,Pe,ge,_e,Le,Ye,gt,Ft,_t,ft,Pt,xt){const yt=this.length;return this.resize(yt+1),this.emplace(yt,n,s,l,p,v,x,S,C,P,M,R,F,j,G,Z,ne,oe,Pe,ge,_e,Le,Ye,gt,Ft,_t,ft,Pt,xt)}emplace(n,s,l,p,v,x,S,C,P,M,R,F,j,G,Z,ne,oe,Pe,ge,_e,Le,Ye,gt,Ft,_t,ft,Pt,xt,yt){const $e=32*n,At=16*n;return this.int16[$e+0]=s,this.int16[$e+1]=l,this.int16[$e+2]=p,this.int16[$e+3]=v,this.int16[$e+4]=x,this.int16[$e+5]=S,this.int16[$e+6]=C,this.int16[$e+7]=P,this.uint16[$e+8]=M,this.uint16[$e+9]=R,this.uint16[$e+10]=F,this.uint16[$e+11]=j,this.uint16[$e+12]=G,this.uint16[$e+13]=Z,this.uint16[$e+14]=ne,this.uint16[$e+15]=oe,this.uint16[$e+16]=Pe,this.uint16[$e+17]=ge,this.uint16[$e+18]=_e,this.uint16[$e+19]=Le,this.uint16[$e+20]=Ye,this.uint16[$e+21]=gt,this.uint16[$e+22]=Ft,this.uint32[At+12]=_t,this.float32[At+13]=ft,this.float32[At+14]=Pt,this.uint16[$e+30]=xt,this.uint16[$e+31]=yt,n}}et.prototype.bytesPerElement=64,vt("StructArrayLayout8i15ui1ul2f2ui64",et);class lt extends g{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n){const s=this.length;return this.resize(s+1),this.emplace(s,n)}emplace(n,s){return this.float32[1*n+0]=s,n}}lt.prototype.bytesPerElement=4,vt("StructArrayLayout1f4",lt);class pt extends g{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,s,l){const p=this.length;return this.resize(p+1),this.emplace(p,n,s,l)}emplace(n,s,l,p){const v=3*n;return this.uint16[6*n+0]=s,this.float32[v+1]=l,this.float32[v+2]=p,n}}pt.prototype.bytesPerElement=12,vt("StructArrayLayout1ui2f12",pt);class ot extends g{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,s,l){const p=this.length;return this.resize(p+1),this.emplace(p,n,s,l)}emplace(n,s,l,p){const v=4*n;return this.uint32[2*n+0]=s,this.uint16[v+2]=l,this.uint16[v+3]=p,n}}ot.prototype.bytesPerElement=8,vt("StructArrayLayout1ul2ui8",ot);class at extends g{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,s){const l=this.length;return this.resize(l+1),this.emplace(l,n,s)}emplace(n,s,l){const p=2*n;return this.uint16[p+0]=s,this.uint16[p+1]=l,n}}at.prototype.bytesPerElement=4,vt("StructArrayLayout2ui4",at);class wt extends g{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n){const s=this.length;return this.resize(s+1),this.emplace(s,n)}emplace(n,s){return this.uint16[1*n+0]=s,n}}wt.prototype.bytesPerElement=2,vt("StructArrayLayout1ui2",wt);class Gt extends g{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,s,l,p){const v=this.length;return this.resize(v+1),this.emplace(v,n,s,l,p)}emplace(n,s,l,p,v){const x=4*n;return this.float32[x+0]=s,this.float32[x+1]=l,this.float32[x+2]=p,this.float32[x+3]=v,n}}Gt.prototype.bytesPerElement=16,vt("StructArrayLayout4f16",Gt);class dt extends f{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new W(this.anchorPointX,this.anchorPointY)}}dt.prototype.size=20;class nt extends me{get(n){return new dt(this,n)}}vt("CollisionBoxArray",nt);class jt extends f{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(n){this._structArray.uint8[this._pos1+37]=n}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(n){this._structArray.uint8[this._pos1+38]=n}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(n){this._structArray.uint32[this._pos4+10]=n}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}jt.prototype.size=48;class sr extends qe{get(n){return new jt(this,n)}}vt("PlacedSymbolArray",sr);class $t extends f{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(n){this._structArray.uint32[this._pos4+12]=n}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}$t.prototype.size=64;class un extends et{get(n){return new $t(this,n)}}vt("SymbolInstanceArray",un);class Xn extends lt{getoffsetX(n){return this.float32[1*n+0]}}vt("GlyphOffsetArray",Xn);class Cr extends z{getx(n){return this.int16[3*n+0]}gety(n){return this.int16[3*n+1]}gettileUnitDistanceFromAnchor(n){return this.int16[3*n+2]}}vt("SymbolLineVertexArray",Cr);class ms extends f{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}ms.prototype.size=12;class hn extends pt{get(n){return new ms(this,n)}}vt("TextAnchorOffsetArray",hn);class pi extends f{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}pi.prototype.size=8;class Ii extends ot{get(n){return new pi(this,n)}}vt("FeatureIndexArray",Ii);class mi extends k{}class ki extends k{}class gs extends k{}class wl extends O{}class Yo extends V{}class za extends X{}class _s extends Q{}class ac extends ie{}class Da extends le{}class ys extends ce{}class vs extends te{}class to extends be{}class xs extends Me{}class si extends at{}const gi=E([{name:"a_pos",components:2,type:"Int16"}],4),{members:Qi}=gi;class gn{constructor(n=[]){this.segments=n}prepareSegment(n,s,l,p){let v=this.segments[this.segments.length-1];return n>gn.MAX_VERTEX_ARRAY_LENGTH&&mt(`Max vertices per segment is ${gn.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${n}`),(!v||v.vertexLength+n>gn.MAX_VERTEX_ARRAY_LENGTH||v.sortKey!==p)&&(v={vertexOffset:s.length,primitiveOffset:l.length,vertexLength:0,primitiveLength:0},p!==void 0&&(v.sortKey=p),this.segments.push(v)),v}get(){return this.segments}destroy(){for(const n of this.segments)for(const s in n.vaos)n.vaos[s].destroy()}static simpleSegment(n,s,l,p){return new gn([{vertexOffset:n,primitiveOffset:s,vertexLength:l,primitiveLength:p,vaos:{},sortKey:0}])}}function So(i,n){return 256*(i=Ze(Math.floor(i),0,255))+Ze(Math.floor(n),0,255)}gn.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,vt("SegmentVector",gn);const bl=E([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var Jo={exports:{}},Sh={exports:{}};Sh.exports=function(i,n){var s,l,p,v,x,S,C,P;for(l=i.length-(s=3&i.length),p=n,x=3432918353,S=461845907,P=0;P<l;)C=255&i.charCodeAt(P)|(255&i.charCodeAt(++P))<<8|(255&i.charCodeAt(++P))<<16|(255&i.charCodeAt(++P))<<24,++P,p=27492+(65535&(v=5*(65535&(p=(p^=C=(65535&(C=(C=(65535&C)*x+(((C>>>16)*x&65535)<<16)&4294967295)<<15|C>>>17))*S+(((C>>>16)*S&65535)<<16)&4294967295)<<13|p>>>19))+((5*(p>>>16)&65535)<<16)&4294967295))+((58964+(v>>>16)&65535)<<16);switch(C=0,s){case 3:C^=(255&i.charCodeAt(P+2))<<16;case 2:C^=(255&i.charCodeAt(P+1))<<8;case 1:p^=C=(65535&(C=(C=(65535&(C^=255&i.charCodeAt(P)))*x+(((C>>>16)*x&65535)<<16)&4294967295)<<15|C>>>17))*S+(((C>>>16)*S&65535)<<16)&4294967295}return p^=i.length,p=2246822507*(65535&(p^=p>>>16))+((2246822507*(p>>>16)&65535)<<16)&4294967295,p=3266489909*(65535&(p^=p>>>13))+((3266489909*(p>>>16)&65535)<<16)&4294967295,(p^=p>>>16)>>>0};var Bd=Sh.exports,Th={exports:{}};Th.exports=function(i,n){for(var s,l=i.length,p=n^l,v=0;l>=4;)s=1540483477*(65535&(s=255&i.charCodeAt(v)|(255&i.charCodeAt(++v))<<8|(255&i.charCodeAt(++v))<<16|(255&i.charCodeAt(++v))<<24))+((1540483477*(s>>>16)&65535)<<16),p=1540483477*(65535&p)+((1540483477*(p>>>16)&65535)<<16)^(s=1540483477*(65535&(s^=s>>>24))+((1540483477*(s>>>16)&65535)<<16)),l-=4,++v;switch(l){case 3:p^=(255&i.charCodeAt(v+2))<<16;case 2:p^=(255&i.charCodeAt(v+1))<<8;case 1:p=1540483477*(65535&(p^=255&i.charCodeAt(v)))+((1540483477*(p>>>16)&65535)<<16)}return p=1540483477*(65535&(p^=p>>>13))+((1540483477*(p>>>16)&65535)<<16),(p^=p>>>15)>>>0};var Bs=Bd,Nd=Th.exports;Jo.exports=Bs,Jo.exports.murmur3=Bs,Jo.exports.murmur2=Nd;var iu=D(Jo.exports);class Sl{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(n,s,l,p){this.ids.push(lc(n)),this.positions.push(s,l,p)}getPositions(n){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const s=lc(n);let l=0,p=this.ids.length-1;for(;l<p;){const x=l+p>>1;this.ids[x]>=s?p=x:l=x+1}const v=[];for(;this.ids[l]===s;)v.push({index:this.positions[3*l],start:this.positions[3*l+1],end:this.positions[3*l+2]}),l++;return v}static serialize(n,s){const l=new Float64Array(n.ids),p=new Uint32Array(n.positions);return su(l,p,0,l.length-1),s&&s.push(l.buffer,p.buffer),{ids:l,positions:p}}static deserialize(n){const s=new Sl;return s.ids=n.ids,s.positions=n.positions,s.indexed=!0,s}}function lc(i){const n=+i;return!isNaN(n)&&n<=Number.MAX_SAFE_INTEGER?n:iu(String(i))}function su(i,n,s,l){for(;s<l;){const p=i[s+l>>1];let v=s-1,x=l+1;for(;;){do v++;while(i[v]<p);do x--;while(i[x]>p);if(v>=x)break;Tl(i,v,x),Tl(n,3*v,3*x),Tl(n,3*v+1,3*x+1),Tl(n,3*v+2,3*x+2)}x-s<l-x?(su(i,n,s,x),s=x+1):(su(i,n,x+1,l),l=x)}}function Tl(i,n,s){const l=i[n];i[n]=i[s],i[s]=l}vt("FeaturePositionMap",Sl);class Ra{constructor(n,s){this.gl=n.gl,this.location=s}}class Eh extends Ra{constructor(n,s){super(n,s),this.current=0}set(n){this.current!==n&&(this.current=n,this.gl.uniform1f(this.location,n))}}class Ud extends Ra{constructor(n,s){super(n,s),this.current=[0,0,0,0]}set(n){n[0]===this.current[0]&&n[1]===this.current[1]&&n[2]===this.current[2]&&n[3]===this.current[3]||(this.current=n,this.gl.uniform4f(this.location,n[0],n[1],n[2],n[3]))}}class ng extends Ra{constructor(n,s){super(n,s),this.current=Rn.transparent}set(n){n.r===this.current.r&&n.g===this.current.g&&n.b===this.current.b&&n.a===this.current.a||(this.current=n,this.gl.uniform4f(this.location,n.r,n.g,n.b,n.a))}}const dp=new Float32Array(16);function _n(i){return[So(255*i.r,255*i.g),So(255*i.b,255*i.a)]}class Ch{constructor(n,s,l){this.value=n,this.uniformNames=s.map(p=>`u_${p}`),this.type=l}setUniform(n,s,l){n.set(l.constantOr(this.value))}getBinding(n,s,l){return this.type==="color"?new ng(n,s):new Eh(n,s)}}class uc{constructor(n,s){this.uniformNames=s.map(l=>`u_${l}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(n,s){this.pixelRatioFrom=s.pixelRatio,this.pixelRatioTo=n.pixelRatio,this.patternFrom=s.tlbr,this.patternTo=n.tlbr}setUniform(n,s,l,p){const v=p==="u_pattern_to"?this.patternTo:p==="u_pattern_from"?this.patternFrom:p==="u_pixel_ratio_to"?this.pixelRatioTo:p==="u_pixel_ratio_from"?this.pixelRatioFrom:null;v&&n.set(v)}getBinding(n,s,l){return l.substr(0,9)==="u_pattern"?new Ud(n,s):new Eh(n,s)}}class Ns{constructor(n,s,l,p){this.expression=n,this.type=l,this.maxValue=0,this.paintVertexAttributes=s.map(v=>({name:`a_${v}`,type:"Float32",components:l==="color"?2:1,offset:0})),this.paintVertexArray=new p}populatePaintArray(n,s,l,p,v){const x=this.paintVertexArray.length,S=this.expression.evaluate(new ar(0),s,{},p,[],v);this.paintVertexArray.resize(n),this._setPaintValue(x,n,S)}updatePaintArray(n,s,l,p){const v=this.expression.evaluate({zoom:0},l,p);this._setPaintValue(n,s,v)}_setPaintValue(n,s,l){if(this.type==="color"){const p=_n(l);for(let v=n;v<s;v++)this.paintVertexArray.emplace(v,p[0],p[1])}else{for(let p=n;p<s;p++)this.paintVertexArray.emplace(p,l);this.maxValue=Math.max(this.maxValue,Math.abs(l))}}upload(n){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=n.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class no{constructor(n,s,l,p,v,x){this.expression=n,this.uniformNames=s.map(S=>`u_${S}_t`),this.type=l,this.useIntegerZoom=p,this.zoom=v,this.maxValue=0,this.paintVertexAttributes=s.map(S=>({name:`a_${S}`,type:"Float32",components:l==="color"?4:2,offset:0})),this.paintVertexArray=new x}populatePaintArray(n,s,l,p,v){const x=this.expression.evaluate(new ar(this.zoom),s,{},p,[],v),S=this.expression.evaluate(new ar(this.zoom+1),s,{},p,[],v),C=this.paintVertexArray.length;this.paintVertexArray.resize(n),this._setPaintValue(C,n,x,S)}updatePaintArray(n,s,l,p){const v=this.expression.evaluate({zoom:this.zoom},l,p),x=this.expression.evaluate({zoom:this.zoom+1},l,p);this._setPaintValue(n,s,v,x)}_setPaintValue(n,s,l,p){if(this.type==="color"){const v=_n(l),x=_n(p);for(let S=n;S<s;S++)this.paintVertexArray.emplace(S,v[0],v[1],x[0],x[1])}else{for(let v=n;v<s;v++)this.paintVertexArray.emplace(v,l,p);this.maxValue=Math.max(this.maxValue,Math.abs(l),Math.abs(p))}}upload(n){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=n.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(n,s){const l=this.useIntegerZoom?Math.floor(s.zoom):s.zoom,p=Ze(this.expression.interpolationFactor(l,this.zoom,this.zoom+1),0,1);n.set(p)}getBinding(n,s,l){return new Eh(n,s)}}class El{constructor(n,s,l,p,v,x){this.expression=n,this.type=s,this.useIntegerZoom=l,this.zoom=p,this.layerId=x,this.zoomInPaintVertexArray=new v,this.zoomOutPaintVertexArray=new v}populatePaintArray(n,s,l){const p=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(n),this.zoomOutPaintVertexArray.resize(n),this._setPaintValues(p,n,s.patterns&&s.patterns[this.layerId],l)}updatePaintArray(n,s,l,p,v){this._setPaintValues(n,s,l.patterns&&l.patterns[this.layerId],v)}_setPaintValues(n,s,l,p){if(!p||!l)return;const{min:v,mid:x,max:S}=l,C=p[v],P=p[x],M=p[S];if(C&&P&&M)for(let R=n;R<s;R++)this.zoomInPaintVertexArray.emplace(R,P.tl[0],P.tl[1],P.br[0],P.br[1],C.tl[0],C.tl[1],C.br[0],C.br[1],P.pixelRatio,C.pixelRatio),this.zoomOutPaintVertexArray.emplace(R,P.tl[0],P.tl[1],P.br[0],P.br[1],M.tl[0],M.tl[1],M.br[0],M.br[1],P.pixelRatio,M.pixelRatio)}upload(n){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=n.createVertexBuffer(this.zoomInPaintVertexArray,bl.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=n.createVertexBuffer(this.zoomOutPaintVertexArray,bl.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class rg{constructor(n,s,l){this.binders={},this._buffers=[];const p=[];for(const v in n.paint._values){if(!l(v))continue;const x=n.paint.get(v);if(!(x instanceof Qr&&hl(x.property.specification)))continue;const S=ay(v,n.type),C=x.value,P=x.property.specification.type,M=x.property.useIntegerZoom,R=x.property.specification["property-type"],F=R==="cross-faded"||R==="cross-faded-data-driven";if(C.kind==="constant")this.binders[v]=F?new uc(C.value,S):new Ch(C.value,S,P),p.push(`/u_${v}`);else if(C.kind==="source"||F){const j=Ih(v,P,"source");this.binders[v]=F?new El(C,P,M,s,j,n.id):new Ns(C,S,P,j),p.push(`/a_${v}`)}else{const j=Ih(v,P,"composite");this.binders[v]=new no(C,S,P,M,s,j),p.push(`/z_${v}`)}}this.cacheKey=p.sort().join("")}getMaxValue(n){const s=this.binders[n];return s instanceof Ns||s instanceof no?s.maxValue:0}populatePaintArrays(n,s,l,p,v){for(const x in this.binders){const S=this.binders[x];(S instanceof Ns||S instanceof no||S instanceof El)&&S.populatePaintArray(n,s,l,p,v)}}setConstantPatternPositions(n,s){for(const l in this.binders){const p=this.binders[l];p instanceof uc&&p.setConstantPatternPositions(n,s)}}updatePaintArrays(n,s,l,p,v){let x=!1;for(const S in n){const C=s.getPositions(S);for(const P of C){const M=l.feature(P.index);for(const R in this.binders){const F=this.binders[R];if((F instanceof Ns||F instanceof no||F instanceof El)&&F.expression.isStateDependent===!0){const j=p.paint.get(R);F.expression=j.value,F.updatePaintArray(P.start,P.end,M,n[S],v),x=!0}}}}return x}defines(){const n=[];for(const s in this.binders){const l=this.binders[s];(l instanceof Ch||l instanceof uc)&&n.push(...l.uniformNames.map(p=>`#define HAS_UNIFORM_${p}`))}return n}getBinderAttributes(){const n=[];for(const s in this.binders){const l=this.binders[s];if(l instanceof Ns||l instanceof no)for(let p=0;p<l.paintVertexAttributes.length;p++)n.push(l.paintVertexAttributes[p].name);else if(l instanceof El)for(let p=0;p<bl.members.length;p++)n.push(bl.members[p].name)}return n}getBinderUniforms(){const n=[];for(const s in this.binders){const l=this.binders[s];if(l instanceof Ch||l instanceof uc||l instanceof no)for(const p of l.uniformNames)n.push(p)}return n}getPaintVertexBuffers(){return this._buffers}getUniforms(n,s){const l=[];for(const p in this.binders){const v=this.binders[p];if(v instanceof Ch||v instanceof uc||v instanceof no){for(const x of v.uniformNames)if(s[x]){const S=v.getBinding(n,s[x],x);l.push({name:x,property:p,binding:S})}}}return l}setUniforms(n,s,l,p){for(const{name:v,property:x,binding:S}of s)this.binders[x].setUniform(S,p,l.get(x),v)}updatePaintBuffers(n){this._buffers=[];for(const s in this.binders){const l=this.binders[s];if(n&&l instanceof El){const p=n.fromScale===2?l.zoomInPaintVertexBuffer:l.zoomOutPaintVertexBuffer;p&&this._buffers.push(p)}else(l instanceof Ns||l instanceof no)&&l.paintVertexBuffer&&this._buffers.push(l.paintVertexBuffer)}}upload(n){for(const s in this.binders){const l=this.binders[s];(l instanceof Ns||l instanceof no||l instanceof El)&&l.upload(n)}this.updatePaintBuffers()}destroy(){for(const n in this.binders){const s=this.binders[n];(s instanceof Ns||s instanceof no||s instanceof El)&&s.destroy()}}}class _i{constructor(n,s,l=()=>!0){this.programConfigurations={};for(const p of n)this.programConfigurations[p.id]=new rg(p,s,l);this.needsUpload=!1,this._featureMap=new Sl,this._bufferOffset=0}populatePaintArrays(n,s,l,p,v,x){for(const S in this.programConfigurations)this.programConfigurations[S].populatePaintArrays(n,s,p,v,x);s.id!==void 0&&this._featureMap.add(s.id,l,this._bufferOffset,n),this._bufferOffset=n,this.needsUpload=!0}updatePaintArrays(n,s,l,p){for(const v of l)this.needsUpload=this.programConfigurations[v.id].updatePaintArrays(n,this._featureMap,s,v,p)||this.needsUpload}get(n){return this.programConfigurations[n]}upload(n){if(this.needsUpload){for(const s in this.programConfigurations)this.programConfigurations[s].upload(n);this.needsUpload=!1}}destroy(){for(const n in this.programConfigurations)this.programConfigurations[n].destroy()}}function ay(i,n){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[i]||[i.replace(`${n}-`,"").replace(/-/g,"_")]}function Ih(i,n,s){const l={color:{source:X,composite:Gt},number:{source:lt,composite:X}},p=function(v){return{"line-pattern":{source:_s,composite:_s},"fill-pattern":{source:_s,composite:_s},"fill-extrusion-pattern":{source:_s,composite:_s}}[v]}(i);return p&&p[s]||l[n][s]}vt("ConstantBinder",Ch),vt("CrossFadedConstantBinder",uc),vt("SourceExpressionBinder",Ns),vt("CrossFadedCompositeBinder",El),vt("CompositeExpressionBinder",no),vt("ProgramConfiguration",rg,{omit:["_buffers"]}),vt("ProgramConfigurationSet",_i);const Ir=8192,jd=Math.pow(2,14)-1,fp=-jd-1;function oi(i){const n=Ir/i.extent,s=i.loadGeometry();for(let l=0;l<s.length;l++){const p=s[l];for(let v=0;v<p.length;v++){const x=p[v],S=Math.round(x.x*n),C=Math.round(x.y*n);x.x=Ze(S,fp,jd),x.y=Ze(C,fp,jd),(S<x.x||S>x.x+1||C<x.y||C>x.y+1)&&mt("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return s}function ws(i,n){return{type:i.type,id:i.id,properties:i.properties,geometry:n?oi(i):[]}}function cc(i,n,s,l,p){i.emplaceBack(2*n+(l+1)/2,2*s+(p+1)/2)}class $d{constructor(n){this.zoom=n.zoom,this.overscaling=n.overscaling,this.layers=n.layers,this.layerIds=this.layers.map(s=>s.id),this.index=n.index,this.hasPattern=!1,this.layoutVertexArray=new ki,this.indexArray=new xs,this.segments=new gn,this.programConfigurations=new _i(n.layers,n.zoom),this.stateDependentLayerIds=this.layers.filter(s=>s.isStateDependent()).map(s=>s.id)}populate(n,s,l){const p=this.layers[0],v=[];let x=null,S=!1;p.type==="circle"&&(x=p.layout.get("circle-sort-key"),S=!x.isConstant());for(const{feature:C,id:P,index:M,sourceLayerIndex:R}of n){const F=this.layers[0]._featureFilter.needGeometry,j=ws(C,F);if(!this.layers[0]._featureFilter.filter(new ar(this.zoom),j,l))continue;const G=S?x.evaluate(j,{},l):void 0,Z={id:P,properties:C.properties,type:C.type,sourceLayerIndex:R,index:M,geometry:F?j.geometry:oi(C),patterns:{},sortKey:G};v.push(Z)}S&&v.sort((C,P)=>C.sortKey-P.sortKey);for(const C of v){const{geometry:P,index:M,sourceLayerIndex:R}=C,F=n[M].feature;this.addFeature(C,P,M,l),s.featureIndex.insert(F,P,M,R,this.index)}}update(n,s,l){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(n,s,this.stateDependentLayers,l)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(n){this.uploaded||(this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,Qi),this.indexBuffer=n.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(n),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(n,s,l,p){for(const v of s)for(const x of v){const S=x.x,C=x.y;if(S<0||S>=Ir||C<0||C>=Ir)continue;const P=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,n.sortKey),M=P.vertexLength;cc(this.layoutVertexArray,S,C,-1,-1),cc(this.layoutVertexArray,S,C,1,-1),cc(this.layoutVertexArray,S,C,1,1),cc(this.layoutVertexArray,S,C,-1,1),this.indexArray.emplaceBack(M,M+1,M+2),this.indexArray.emplaceBack(M,M+3,M+2),P.vertexLength+=4,P.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,n,l,{},p)}}function kh(i,n){for(let s=0;s<i.length;s++)if(ou(n,i[s]))return!0;for(let s=0;s<n.length;s++)if(ou(i,n[s]))return!0;return!!Ph(i,n)}function ig(i,n,s){return!!ou(i,n)||!!Qo(n,i,s)}function Vd(i,n){if(i.length===1)return La(n,i[0]);for(let s=0;s<n.length;s++){const l=n[s];for(let p=0;p<l.length;p++)if(ou(i,l[p]))return!0}for(let s=0;s<i.length;s++)if(La(n,i[s]))return!0;for(let s=0;s<n.length;s++)if(Ph(i,n[s]))return!0;return!1}function sg(i,n,s){if(i.length>1){if(Ph(i,n))return!0;for(let l=0;l<n.length;l++)if(Qo(n[l],i,s))return!0}for(let l=0;l<i.length;l++)if(Qo(i[l],n,s))return!0;return!1}function Ph(i,n){if(i.length===0||n.length===0)return!1;for(let s=0;s<i.length-1;s++){const l=i[s],p=i[s+1];for(let v=0;v<n.length-1;v++)if(pp(l,p,n[v],n[v+1]))return!0}return!1}function pp(i,n,s,l){return Kt(i,s,l)!==Kt(n,s,l)&&Kt(i,n,s)!==Kt(i,n,l)}function Qo(i,n,s){const l=s*s;if(n.length===1)return i.distSqr(n[0])<l;for(let p=1;p<n.length;p++)if(og(i,n[p-1],n[p])<l)return!0;return!1}function og(i,n,s){const l=n.distSqr(s);if(l===0)return i.distSqr(n);const p=((i.x-n.x)*(s.x-n.x)+(i.y-n.y)*(s.y-n.y))/l;return i.distSqr(p<0?n:p>1?s:s.sub(n)._mult(p)._add(n))}function La(i,n){let s,l,p,v=!1;for(let x=0;x<i.length;x++){s=i[x];for(let S=0,C=s.length-1;S<s.length;C=S++)l=s[S],p=s[C],l.y>n.y!=p.y>n.y&&n.x<(p.x-l.x)*(n.y-l.y)/(p.y-l.y)+l.x&&(v=!v)}return v}function ou(i,n){let s=!1;for(let l=0,p=i.length-1;l<i.length;p=l++){const v=i[l],x=i[p];v.y>n.y!=x.y>n.y&&n.x<(x.x-v.x)*(n.y-v.y)/(x.y-v.y)+v.x&&(s=!s)}return s}function ag(i,n,s){const l=s[0],p=s[2];if(i.x<l.x&&n.x<l.x||i.x>p.x&&n.x>p.x||i.y<l.y&&n.y<l.y||i.y>p.y&&n.y>p.y)return!1;const v=Kt(i,n,s[0]);return v!==Kt(i,n,s[1])||v!==Kt(i,n,s[2])||v!==Kt(i,n,s[3])}function au(i,n,s){const l=n.paint.get(i).value;return l.kind==="constant"?l.value:s.programConfigurations.get(n.id).getMaxValue(i)}function qd(i){return Math.sqrt(i[0]*i[0]+i[1]*i[1])}function Zd(i,n,s,l,p){if(!n[0]&&!n[1])return i;const v=W.convert(n)._mult(p);s==="viewport"&&v._rotate(-l);const x=[];for(let S=0;S<i.length;S++)x.push(i[S].sub(v));return x}let lg,mp;vt("CircleBucket",$d,{omit:["layers"]});var ug={get paint(){return mp=mp||new y({"circle-radius":new Bt(Ce.paint_circle["circle-radius"]),"circle-color":new Bt(Ce.paint_circle["circle-color"]),"circle-blur":new Bt(Ce.paint_circle["circle-blur"]),"circle-opacity":new Bt(Ce.paint_circle["circle-opacity"]),"circle-translate":new Ct(Ce.paint_circle["circle-translate"]),"circle-translate-anchor":new Ct(Ce.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Ct(Ce.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Ct(Ce.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Bt(Ce.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Bt(Ce.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Bt(Ce.paint_circle["circle-stroke-opacity"])})},get layout(){return lg=lg||new y({"circle-sort-key":new Bt(Ce.layout_circle["circle-sort-key"])})}},Ni=1e-6,lu=typeof Float32Array<"u"?Float32Array:Array;function Gd(i){return i[0]=1,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=1,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=1,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i}function es(i,n,s){var l=n[0],p=n[1],v=n[2],x=n[3],S=n[4],C=n[5],P=n[6],M=n[7],R=n[8],F=n[9],j=n[10],G=n[11],Z=n[12],ne=n[13],oe=n[14],Pe=n[15],ge=s[0],_e=s[1],Le=s[2],Ye=s[3];return i[0]=ge*l+_e*S+Le*R+Ye*Z,i[1]=ge*p+_e*C+Le*F+Ye*ne,i[2]=ge*v+_e*P+Le*j+Ye*oe,i[3]=ge*x+_e*M+Le*G+Ye*Pe,i[4]=(ge=s[4])*l+(_e=s[5])*S+(Le=s[6])*R+(Ye=s[7])*Z,i[5]=ge*p+_e*C+Le*F+Ye*ne,i[6]=ge*v+_e*P+Le*j+Ye*oe,i[7]=ge*x+_e*M+Le*G+Ye*Pe,i[8]=(ge=s[8])*l+(_e=s[9])*S+(Le=s[10])*R+(Ye=s[11])*Z,i[9]=ge*p+_e*C+Le*F+Ye*ne,i[10]=ge*v+_e*P+Le*j+Ye*oe,i[11]=ge*x+_e*M+Le*G+Ye*Pe,i[12]=(ge=s[12])*l+(_e=s[13])*S+(Le=s[14])*R+(Ye=s[15])*Z,i[13]=ge*p+_e*C+Le*F+Ye*ne,i[14]=ge*v+_e*P+Le*j+Ye*oe,i[15]=ge*x+_e*M+Le*G+Ye*Pe,i}Math.hypot||(Math.hypot=function(){for(var i=0,n=arguments.length;n--;)i+=arguments[n]*arguments[n];return Math.sqrt(i)});var bs,ly=es;function Wd(i,n,s){var l=n[0],p=n[1],v=n[2],x=n[3];return i[0]=s[0]*l+s[4]*p+s[8]*v+s[12]*x,i[1]=s[1]*l+s[5]*p+s[9]*v+s[13]*x,i[2]=s[2]*l+s[6]*p+s[10]*v+s[14]*x,i[3]=s[3]*l+s[7]*p+s[11]*v+s[15]*x,i}bs=new lu(4),lu!=Float32Array&&(bs[0]=0,bs[1]=0,bs[2]=0,bs[3]=0);class Hd extends a{constructor(n){super(n,ug)}createBucket(n){return new $d(n)}queryRadius(n){const s=n;return au("circle-radius",this,s)+au("circle-stroke-width",this,s)+qd(this.paint.get("circle-translate"))}queryIntersectsFeature(n,s,l,p,v,x,S,C){const P=Zd(n,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),x.angle,S),M=this.paint.get("circle-radius").evaluate(s,l)+this.paint.get("circle-stroke-width").evaluate(s,l),R=this.paint.get("circle-pitch-alignment")==="map",F=R?P:function(G,Z){return G.map(ne=>uu(ne,Z))}(P,C),j=R?M*S:M;for(const G of p)for(const Z of G){const ne=R?Z:uu(Z,C);let oe=j;const Pe=Wd([],[Z.x,Z.y,0,1],C);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?oe*=Pe[3]/x.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(oe*=x.cameraToCenterDistance/Pe[3]),ig(F,ne,oe))return!0}return!1}}function uu(i,n){const s=Wd([],[i.x,i.y,0,1],n);return new W(s[0]/s[3],s[1]/s[3])}class gp extends $d{}let _p;vt("HeatmapBucket",gp,{omit:["layers"]});var uy={get paint(){return _p=_p||new y({"heatmap-radius":new Bt(Ce.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Bt(Ce.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Ct(Ce.paint_heatmap["heatmap-intensity"]),"heatmap-color":new bo(Ce.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Ct(Ce.paint_heatmap["heatmap-opacity"])})}};function Xd(i,{width:n,height:s},l,p){if(p){if(p instanceof Uint8ClampedArray)p=new Uint8Array(p.buffer);else if(p.length!==n*s*l)throw new RangeError(`mismatched image size. expected: ${p.length} but got: ${n*s*l}`)}else p=new Uint8Array(n*s*l);return i.width=n,i.height=s,i.data=p,i}function cu(i,{width:n,height:s},l){if(n===i.width&&s===i.height)return;const p=Xd({},{width:n,height:s},l);hu(i,p,{x:0,y:0},{x:0,y:0},{width:Math.min(i.width,n),height:Math.min(i.height,s)},l),i.width=n,i.height=s,i.data=p.data}function hu(i,n,s,l,p,v){if(p.width===0||p.height===0)return n;if(p.width>i.width||p.height>i.height||s.x>i.width-p.width||s.y>i.height-p.height)throw new RangeError("out of range source coordinates for image copy");if(p.width>n.width||p.height>n.height||l.x>n.width-p.width||l.y>n.height-p.height)throw new RangeError("out of range destination coordinates for image copy");const x=i.data,S=n.data;if(x===S)throw new Error("srcData equals dstData, so image is already copied");for(let C=0;C<p.height;C++){const P=((s.y+C)*i.width+s.x)*v,M=((l.y+C)*n.width+l.x)*v;for(let R=0;R<p.width*v;R++)S[M+R]=x[P+R]}return n}class Ah{constructor(n,s){Xd(this,n,1,s)}resize(n){cu(this,n,1)}clone(){return new Ah({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(n,s,l,p,v){hu(n,s,l,p,v,1)}}class Ss{constructor(n,s){Xd(this,n,4,s)}resize(n){cu(this,n,4)}replace(n,s){s?this.data.set(n):this.data=n instanceof Uint8ClampedArray?new Uint8Array(n.buffer):n}clone(){return new Ss({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(n,s,l,p,v){hu(n,s,l,p,v,4)}}function yp(i){const n={},s=i.resolution||256,l=i.clips?i.clips.length:1,p=i.image||new Ss({width:s,height:l});if(Math.log(s)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${s}`);const v=(x,S,C)=>{n[i.evaluationKey]=C;const P=i.expression.evaluate(n);p.data[x+S+0]=Math.floor(255*P.r/P.a),p.data[x+S+1]=Math.floor(255*P.g/P.a),p.data[x+S+2]=Math.floor(255*P.b/P.a),p.data[x+S+3]=Math.floor(255*P.a)};if(i.clips)for(let x=0,S=0;x<l;++x,S+=4*s)for(let C=0,P=0;C<s;C++,P+=4){const M=C/(s-1),{start:R,end:F}=i.clips[x];v(S,P,R*(1-M)+F*M)}else for(let x=0,S=0;x<s;x++,S+=4)v(0,S,x/(s-1));return p}vt("AlphaImage",Ah),vt("RGBAImage",Ss);const hc="big-fb";class cg extends a{createBucket(n){return new gp(n)}constructor(n){super(n,uy),this.heatmapFbos=new Map,this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(n){n==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=yp({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbos.has(hc)&&this.heatmapFbos.delete(hc)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}}let Mh;var vp={get paint(){return Mh=Mh||new y({"hillshade-illumination-direction":new Ct(Ce.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Ct(Ce.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Ct(Ce.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Ct(Ce.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Ct(Ce.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Ct(Ce.paint_hillshade["hillshade-accent-color"])})}};class Kd extends a{constructor(n){super(n,vp)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}}const cy=E([{name:"a_pos",components:2,type:"Int16"}],4),{members:hg}=cy;function zh(i,n,s=2){const l=n&&n.length,p=l?n[0]*s:i.length;let v=xp(i,0,p,s,!0);const x=[];if(!v||v.next===v.prev)return x;let S,C,P;if(l&&(v=function(M,R,F,j){const G=[];for(let Z=0,ne=R.length;Z<ne;Z++){const oe=xp(M,R[Z]*j,Z<ne-1?R[Z+1]*j:M.length,j,!1);oe===oe.next&&(oe.steiner=!0),G.push(Ba(oe))}G.sort(hy);for(let Z=0;Z<G.length;Z++)F=mg(G[Z],F);return F}(i,n,v,s)),i.length>80*s){S=1/0,C=1/0;let M=-1/0,R=-1/0;for(let F=s;F<p;F+=s){const j=i[F],G=i[F+1];j<S&&(S=j),G<C&&(C=G),j>M&&(M=j),G>R&&(R=G)}P=Math.max(M-S,R-C),P=P!==0?32767/P:0}return Dh(v,x,s,S,C,P,0),x}function xp(i,n,s,l,p){let v;if(p===function(x,S,C,P){let M=0;for(let R=S,F=C-P;R<C;R+=P)M+=(x[F]-x[R])*(x[R+1]+x[F+1]),F=R;return M}(i,n,s,l)>0)for(let x=n;x<s;x+=l)v=gg(x/l|0,i[x],i[x+1],v);else for(let x=s-l;x>=n;x-=l)v=gg(x/l|0,i[x],i[x+1],v);return v&&du(v,v.next)&&(gu(v),v=v.next),v}function Oa(i,n){if(!i)return i;n||(n=i);let s,l=i;do if(s=!1,l.steiner||!du(l,l.next)&&wr(l.prev,l,l.next)!==0)l=l.next;else{if(gu(l),l=n=l.prev,l===l.next)break;s=!0}while(s||l!==n);return n}function Dh(i,n,s,l,p,v,x){if(!i)return;!x&&v&&function(C,P,M,R){let F=C;do F.z===0&&(F.z=wp(F.x,F.y,P,M,R)),F.prevZ=F.prev,F.nextZ=F.next,F=F.next;while(F!==C);F.prevZ.nextZ=null,F.prevZ=null,function(j){let G,Z=1;do{let ne,oe=j;j=null;let Pe=null;for(G=0;oe;){G++;let ge=oe,_e=0;for(let Ye=0;Ye<Z&&(_e++,ge=ge.nextZ,ge);Ye++);let Le=Z;for(;_e>0||Le>0&&ge;)_e!==0&&(Le===0||!ge||oe.z<=ge.z)?(ne=oe,oe=oe.nextZ,_e--):(ne=ge,ge=ge.nextZ,Le--),Pe?Pe.nextZ=ne:j=ne,ne.prevZ=Pe,Pe=ne;oe=ge}Pe.nextZ=null,Z*=2}while(G>1)}(F)}(i,l,p,v);let S=i;for(;i.prev!==i.next;){const C=i.prev,P=i.next;if(v?Fa(i,l,p,v):dg(i))n.push(C.i,i.i,P.i),gu(i),i=P.next,S=P.next;else if((i=P)===S){x?x===1?Dh(i=fg(Oa(i),n),n,s,l,p,v,2):x===2&&pg(i,n,s,l,p,v):Dh(Oa(i),n,s,l,p,v,1);break}}}function dg(i){const n=i.prev,s=i,l=i.next;if(wr(n,s,l)>=0)return!1;const p=n.x,v=s.x,x=l.x,S=n.y,C=s.y,P=l.y,M=p<v?p<x?p:x:v<x?v:x,R=S<C?S<P?S:P:C<P?C:P,F=p>v?p>x?p:x:v>x?v:x,j=S>C?S>P?S:P:C>P?C:P;let G=l.next;for(;G!==n;){if(G.x>=M&&G.x<=F&&G.y>=R&&G.y<=j&&Cl(p,S,v,C,x,P,G.x,G.y)&&wr(G.prev,G,G.next)>=0)return!1;G=G.next}return!0}function Fa(i,n,s,l){const p=i.prev,v=i,x=i.next;if(wr(p,v,x)>=0)return!1;const S=p.x,C=v.x,P=x.x,M=p.y,R=v.y,F=x.y,j=S<C?S<P?S:P:C<P?C:P,G=M<R?M<F?M:F:R<F?R:F,Z=S>C?S>P?S:P:C>P?C:P,ne=M>R?M>F?M:F:R>F?R:F,oe=wp(j,G,n,s,l),Pe=wp(Z,ne,n,s,l);let ge=i.prevZ,_e=i.nextZ;for(;ge&&ge.z>=oe&&_e&&_e.z<=Pe;){if(ge.x>=j&&ge.x<=Z&&ge.y>=G&&ge.y<=ne&&ge!==p&&ge!==x&&Cl(S,M,C,R,P,F,ge.x,ge.y)&&wr(ge.prev,ge,ge.next)>=0||(ge=ge.prevZ,_e.x>=j&&_e.x<=Z&&_e.y>=G&&_e.y<=ne&&_e!==p&&_e!==x&&Cl(S,M,C,R,P,F,_e.x,_e.y)&&wr(_e.prev,_e,_e.next)>=0))return!1;_e=_e.nextZ}for(;ge&&ge.z>=oe;){if(ge.x>=j&&ge.x<=Z&&ge.y>=G&&ge.y<=ne&&ge!==p&&ge!==x&&Cl(S,M,C,R,P,F,ge.x,ge.y)&&wr(ge.prev,ge,ge.next)>=0)return!1;ge=ge.prevZ}for(;_e&&_e.z<=Pe;){if(_e.x>=j&&_e.x<=Z&&_e.y>=G&&_e.y<=ne&&_e!==p&&_e!==x&&Cl(S,M,C,R,P,F,_e.x,_e.y)&&wr(_e.prev,_e,_e.next)>=0)return!1;_e=_e.nextZ}return!0}function fg(i,n){let s=i;do{const l=s.prev,p=s.next.next;!du(l,p)&&fu(l,s,s.next,p)&&mu(l,p)&&mu(p,l)&&(n.push(l.i,s.i,p.i),gu(s),gu(s.next),s=i=p),s=s.next}while(s!==i);return Oa(s)}function pg(i,n,s,l,p,v){let x=i;do{let S=x.next.next;for(;S!==x.prev;){if(x.i!==S.i&&bp(x,S)){let C=Il(x,S);return x=Oa(x,x.next),C=Oa(C,C.next),Dh(x,n,s,l,p,v,0),void Dh(C,n,s,l,p,v,0)}S=S.next}x=x.next}while(x!==i)}function hy(i,n){return i.x-n.x}function mg(i,n){const s=function(p,v){let x=v;const S=p.x,C=p.y;let P,M=-1/0;do{if(C<=x.y&&C>=x.next.y&&x.next.y!==x.y){const Z=x.x+(C-x.y)*(x.next.x-x.x)/(x.next.y-x.y);if(Z<=S&&Z>M&&(M=Z,P=x.x<x.next.x?x:x.next,Z===S))return P}x=x.next}while(x!==v);if(!P)return null;const R=P,F=P.x,j=P.y;let G=1/0;x=P;do{if(S>=x.x&&x.x>=F&&S!==x.x&&Cl(C<j?S:M,C,F,j,C<j?M:S,C,x.x,x.y)){const Z=Math.abs(C-x.y)/(S-x.x);mu(x,p)&&(Z<G||Z===G&&(x.x>P.x||x.x===P.x&&dy(P,x)))&&(P=x,G=Z)}x=x.next}while(x!==R);return P}(i,n);if(!s)return n;const l=Il(s,i);return Oa(l,l.next),Oa(s,s.next)}function dy(i,n){return wr(i.prev,i,n.prev)<0&&wr(n.next,i,i.next)<0}function wp(i,n,s,l,p){return(i=1431655765&((i=858993459&((i=252645135&((i=16711935&((i=(i-s)*p|0)|i<<8))|i<<4))|i<<2))|i<<1))|(n=1431655765&((n=858993459&((n=252645135&((n=16711935&((n=(n-l)*p|0)|n<<8))|n<<4))|n<<2))|n<<1))<<1}function Ba(i){let n=i,s=i;do(n.x<s.x||n.x===s.x&&n.y<s.y)&&(s=n),n=n.next;while(n!==i);return s}function Cl(i,n,s,l,p,v,x,S){return(p-x)*(n-S)>=(i-x)*(v-S)&&(i-x)*(l-S)>=(s-x)*(n-S)&&(s-x)*(v-S)>=(p-x)*(l-S)}function bp(i,n){return i.next.i!==n.i&&i.prev.i!==n.i&&!function(s,l){let p=s;do{if(p.i!==s.i&&p.next.i!==s.i&&p.i!==l.i&&p.next.i!==l.i&&fu(p,p.next,s,l))return!0;p=p.next}while(p!==s);return!1}(i,n)&&(mu(i,n)&&mu(n,i)&&function(s,l){let p=s,v=!1;const x=(s.x+l.x)/2,S=(s.y+l.y)/2;do p.y>S!=p.next.y>S&&p.next.y!==p.y&&x<(p.next.x-p.x)*(S-p.y)/(p.next.y-p.y)+p.x&&(v=!v),p=p.next;while(p!==s);return v}(i,n)&&(wr(i.prev,i,n.prev)||wr(i,n.prev,n))||du(i,n)&&wr(i.prev,i,i.next)>0&&wr(n.prev,n,n.next)>0)}function wr(i,n,s){return(n.y-i.y)*(s.x-n.x)-(n.x-i.x)*(s.y-n.y)}function du(i,n){return i.x===n.x&&i.y===n.y}function fu(i,n,s,l){const p=pu(wr(i,n,s)),v=pu(wr(i,n,l)),x=pu(wr(s,l,i)),S=pu(wr(s,l,n));return p!==v&&x!==S||!(p!==0||!Vt(i,s,n))||!(v!==0||!Vt(i,l,n))||!(x!==0||!Vt(s,i,l))||!(S!==0||!Vt(s,n,l))}function Vt(i,n,s){return n.x<=Math.max(i.x,s.x)&&n.x>=Math.min(i.x,s.x)&&n.y<=Math.max(i.y,s.y)&&n.y>=Math.min(i.y,s.y)}function pu(i){return i>0?1:i<0?-1:0}function mu(i,n){return wr(i.prev,i,i.next)<0?wr(i,n,i.next)>=0&&wr(i,i.prev,n)>=0:wr(i,n,i.prev)<0||wr(i,i.next,n)<0}function Il(i,n){const s=Yd(i.i,i.x,i.y),l=Yd(n.i,n.x,n.y),p=i.next,v=n.prev;return i.next=n,n.prev=i,s.next=p,p.prev=s,l.next=s,s.prev=l,v.next=l,l.prev=v,l}function gg(i,n,s,l){const p=Yd(i,n,s);return l?(p.next=l.next,p.prev=l,l.next.prev=p,l.next=p):(p.prev=p,p.next=p),p}function gu(i){i.next.prev=i.prev,i.prev.next=i.next,i.prevZ&&(i.prevZ.nextZ=i.nextZ),i.nextZ&&(i.nextZ.prevZ=i.prevZ)}function Yd(i,n,s){return{i,x:n,y:s,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function yi(i,n,s){const l=s.patternDependencies;let p=!1;for(const v of n){const x=v.paint.get(`${i}-pattern`);x.isConstant()||(p=!0);const S=x.constantOr(null);S&&(p=!0,l[S.to]=!0,l[S.from]=!0)}return p}function Sp(i,n,s,l,p){const v=p.patternDependencies;for(const x of n){const S=x.paint.get(`${i}-pattern`).value;if(S.kind!=="constant"){let C=S.evaluate({zoom:l-1},s,{},p.availableImages),P=S.evaluate({zoom:l},s,{},p.availableImages),M=S.evaluate({zoom:l+1},s,{},p.availableImages);C=C&&C.name?C.name:C,P=P&&P.name?P.name:P,M=M&&M.name?M.name:M,v[C]=!0,v[P]=!0,v[M]=!0,s.patterns[x.id]={min:C,mid:P,max:M}}}return s}class Tp{constructor(n){this.zoom=n.zoom,this.overscaling=n.overscaling,this.layers=n.layers,this.layerIds=this.layers.map(s=>s.id),this.index=n.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new gs,this.indexArray=new xs,this.indexArray2=new si,this.programConfigurations=new _i(n.layers,n.zoom),this.segments=new gn,this.segments2=new gn,this.stateDependentLayerIds=this.layers.filter(s=>s.isStateDependent()).map(s=>s.id)}populate(n,s,l){this.hasPattern=yi("fill",this.layers,s);const p=this.layers[0].layout.get("fill-sort-key"),v=!p.isConstant(),x=[];for(const{feature:S,id:C,index:P,sourceLayerIndex:M}of n){const R=this.layers[0]._featureFilter.needGeometry,F=ws(S,R);if(!this.layers[0]._featureFilter.filter(new ar(this.zoom),F,l))continue;const j=v?p.evaluate(F,{},l,s.availableImages):void 0,G={id:C,properties:S.properties,type:S.type,sourceLayerIndex:M,index:P,geometry:R?F.geometry:oi(S),patterns:{},sortKey:j};x.push(G)}v&&x.sort((S,C)=>S.sortKey-C.sortKey);for(const S of x){const{geometry:C,index:P,sourceLayerIndex:M}=S;if(this.hasPattern){const R=Sp("fill",this.layers,S,this.zoom,s);this.patternFeatures.push(R)}else this.addFeature(S,C,P,l,{});s.featureIndex.insert(n[P].feature,C,P,M,this.index)}}update(n,s,l){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(n,s,this.stateDependentLayers,l)}addFeatures(n,s,l){for(const p of this.patternFeatures)this.addFeature(p,p.geometry,p.index,s,l)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(n){this.uploaded||(this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,hg),this.indexBuffer=n.createIndexBuffer(this.indexArray),this.indexBuffer2=n.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(n),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(n,s,l,p,v){for(const x of ir(s,500)){let S=0;for(const j of x)S+=j.length;const C=this.segments.prepareSegment(S,this.layoutVertexArray,this.indexArray),P=C.vertexLength,M=[],R=[];for(const j of x){if(j.length===0)continue;j!==x[0]&&R.push(M.length/2);const G=this.segments2.prepareSegment(j.length,this.layoutVertexArray,this.indexArray2),Z=G.vertexLength;this.layoutVertexArray.emplaceBack(j[0].x,j[0].y),this.indexArray2.emplaceBack(Z+j.length-1,Z),M.push(j[0].x),M.push(j[0].y);for(let ne=1;ne<j.length;ne++)this.layoutVertexArray.emplaceBack(j[ne].x,j[ne].y),this.indexArray2.emplaceBack(Z+ne-1,Z+ne),M.push(j[ne].x),M.push(j[ne].y);G.vertexLength+=j.length,G.primitiveLength+=j.length}const F=zh(M,R);for(let j=0;j<F.length;j+=3)this.indexArray.emplaceBack(P+F[j],P+F[j+1],P+F[j+2]);C.vertexLength+=S,C.primitiveLength+=F.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,n,l,v,p)}}let Ep,_g;vt("FillBucket",Tp,{omit:["layers","patternFeatures"]});var yg={get paint(){return _g=_g||new y({"fill-antialias":new Ct(Ce.paint_fill["fill-antialias"]),"fill-opacity":new Bt(Ce.paint_fill["fill-opacity"]),"fill-color":new Bt(Ce.paint_fill["fill-color"]),"fill-outline-color":new Bt(Ce.paint_fill["fill-outline-color"]),"fill-translate":new Ct(Ce.paint_fill["fill-translate"]),"fill-translate-anchor":new Ct(Ce.paint_fill["fill-translate-anchor"]),"fill-pattern":new sc(Ce.paint_fill["fill-pattern"])})},get layout(){return Ep=Ep||new y({"fill-sort-key":new Bt(Ce.layout_fill["fill-sort-key"])})}};class fy extends a{constructor(n){super(n,yg)}recalculate(n,s){super.recalculate(n,s);const l=this.paint._values["fill-outline-color"];l.value.kind==="constant"&&l.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(n){return new Tp(n)}queryRadius(){return qd(this.paint.get("fill-translate"))}queryIntersectsFeature(n,s,l,p,v,x,S){return Vd(Zd(n,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),x.angle,S),p)}isTileClipped(){return!0}}const py=E([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),my=E([{name:"a_centroid",components:2,type:"Int16"}],4),{members:Na}=py;var Fr={},Cp=U,vg=kl;function kl(i,n,s,l,p){this.properties={},this.extent=s,this.type=0,this._pbf=i,this._geometry=-1,this._keys=l,this._values=p,i.readFields(gy,this,n)}function gy(i,n,s){i==1?n.id=s.readVarint():i==2?function(l,p){for(var v=l.readVarint()+l.pos;l.pos<v;){var x=p._keys[l.readVarint()],S=p._values[l.readVarint()];p.properties[x]=S}}(s,n):i==3?n.type=s.readVarint():i==4&&(n._geometry=s.pos)}function _y(i){for(var n,s,l=0,p=0,v=i.length,x=v-1;p<v;x=p++)l+=((s=i[x]).x-(n=i[p]).x)*(n.y+s.y);return l}kl.types=["Unknown","Point","LineString","Polygon"],kl.prototype.loadGeometry=function(){var i=this._pbf;i.pos=this._geometry;for(var n,s=i.readVarint()+i.pos,l=1,p=0,v=0,x=0,S=[];i.pos<s;){if(p<=0){var C=i.readVarint();l=7&C,p=C>>3}if(p--,l===1||l===2)v+=i.readSVarint(),x+=i.readSVarint(),l===1&&(n&&S.push(n),n=[]),n.push(new Cp(v,x));else{if(l!==7)throw new Error("unknown command "+l);n&&n.push(n[0].clone())}}return n&&S.push(n),S},kl.prototype.bbox=function(){var i=this._pbf;i.pos=this._geometry;for(var n=i.readVarint()+i.pos,s=1,l=0,p=0,v=0,x=1/0,S=-1/0,C=1/0,P=-1/0;i.pos<n;){if(l<=0){var M=i.readVarint();s=7&M,l=M>>3}if(l--,s===1||s===2)(p+=i.readSVarint())<x&&(x=p),p>S&&(S=p),(v+=i.readSVarint())<C&&(C=v),v>P&&(P=v);else if(s!==7)throw new Error("unknown command "+s)}return[x,C,S,P]},kl.prototype.toGeoJSON=function(i,n,s){var l,p,v=this.extent*Math.pow(2,s),x=this.extent*i,S=this.extent*n,C=this.loadGeometry(),P=kl.types[this.type];function M(j){for(var G=0;G<j.length;G++){var Z=j[G];j[G]=[360*(Z.x+x)/v-180,360/Math.PI*Math.atan(Math.exp((180-360*(Z.y+S)/v)*Math.PI/180))-90]}}switch(this.type){case 1:var R=[];for(l=0;l<C.length;l++)R[l]=C[l][0];M(C=R);break;case 2:for(l=0;l<C.length;l++)M(C[l]);break;case 3:for(C=function(j){var G=j.length;if(G<=1)return[j];for(var Z,ne,oe=[],Pe=0;Pe<G;Pe++){var ge=_y(j[Pe]);ge!==0&&(ne===void 0&&(ne=ge<0),ne===ge<0?(Z&&oe.push(Z),Z=[j[Pe]]):Z.push(j[Pe]))}return Z&&oe.push(Z),oe}(C),l=0;l<C.length;l++)for(p=0;p<C[l].length;p++)M(C[l][p])}C.length===1?C=C[0]:P="Multi"+P;var F={type:"Feature",geometry:{type:P,coordinates:C},properties:this.properties};return"id"in this&&(F.id=this.id),F};var Rh=vg,Ip=kp;function kp(i,n){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=i,this._keys=[],this._values=[],this._features=[],i.readFields(yy,this,n),this.length=this._features.length}function yy(i,n,s){i===15?n.version=s.readVarint():i===1?n.name=s.readString():i===5?n.extent=s.readVarint():i===2?n._features.push(s.pos):i===3?n._keys.push(s.readString()):i===4&&n._values.push(function(l){for(var p=null,v=l.readVarint()+l.pos;l.pos<v;){var x=l.readVarint()>>3;p=x===1?l.readString():x===2?l.readFloat():x===3?l.readDouble():x===4?l.readVarint64():x===5?l.readVarint():x===6?l.readSVarint():x===7?l.readBoolean():null}return p}(s))}kp.prototype.feature=function(i){if(i<0||i>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[i];var n=this._pbf.readVarint()+this._pbf.pos;return new Rh(this._pbf,n,this.extent,this._keys,this._values)};var vy=Ip;function xy(i,n,s){if(i===3){var l=new vy(s,s.readVarint()+s.pos);l.length&&(n[l.name]=l)}}Fr.VectorTile=function(i,n){this.layers=i.readFields(xy,{},n)},Fr.VectorTileFeature=vg,Fr.VectorTileLayer=Ip;const wy=Fr.VectorTileFeature.types,Jd=Math.pow(2,13);function dc(i,n,s,l,p,v,x,S){i.emplaceBack(n,s,2*Math.floor(l*Jd)+x,p*Jd*2,v*Jd*2,Math.round(S))}class Pp{constructor(n){this.zoom=n.zoom,this.overscaling=n.overscaling,this.layers=n.layers,this.layerIds=this.layers.map(s=>s.id),this.index=n.index,this.hasPattern=!1,this.layoutVertexArray=new wl,this.centroidVertexArray=new mi,this.indexArray=new xs,this.programConfigurations=new _i(n.layers,n.zoom),this.segments=new gn,this.stateDependentLayerIds=this.layers.filter(s=>s.isStateDependent()).map(s=>s.id)}populate(n,s,l){this.features=[],this.hasPattern=yi("fill-extrusion",this.layers,s);for(const{feature:p,id:v,index:x,sourceLayerIndex:S}of n){const C=this.layers[0]._featureFilter.needGeometry,P=ws(p,C);if(!this.layers[0]._featureFilter.filter(new ar(this.zoom),P,l))continue;const M={id:v,sourceLayerIndex:S,index:x,geometry:C?P.geometry:oi(p),properties:p.properties,type:p.type,patterns:{}};this.hasPattern?this.features.push(Sp("fill-extrusion",this.layers,M,this.zoom,s)):this.addFeature(M,M.geometry,x,l,{}),s.featureIndex.insert(p,M.geometry,x,S,this.index,!0)}}addFeatures(n,s,l){for(const p of this.features){const{geometry:v}=p;this.addFeature(p,v,p.index,s,l)}}update(n,s,l){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(n,s,this.stateDependentLayers,l)}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(n){this.uploaded||(this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,Na),this.centroidVertexBuffer=n.createVertexBuffer(this.centroidVertexArray,my.members,!0),this.indexBuffer=n.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(n),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(n,s,l,p,v){for(const x of ir(s,500)){const S={x:0,y:0,vertexCount:0};let C=0;for(const G of x)C+=G.length;let P=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray);for(const G of x){if(G.length===0||xg(G))continue;let Z=0;for(let ne=0;ne<G.length;ne++){const oe=G[ne];if(ne>=1){const Pe=G[ne-1];if(!Ap(oe,Pe)){P.vertexLength+4>gn.MAX_VERTEX_ARRAY_LENGTH&&(P=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const ge=oe.sub(Pe)._perp()._unit(),_e=Pe.dist(oe);Z+_e>32768&&(Z=0),dc(this.layoutVertexArray,oe.x,oe.y,ge.x,ge.y,0,0,Z),dc(this.layoutVertexArray,oe.x,oe.y,ge.x,ge.y,0,1,Z),S.x+=2*oe.x,S.y+=2*oe.y,S.vertexCount+=2,Z+=_e,dc(this.layoutVertexArray,Pe.x,Pe.y,ge.x,ge.y,0,0,Z),dc(this.layoutVertexArray,Pe.x,Pe.y,ge.x,ge.y,0,1,Z),S.x+=2*Pe.x,S.y+=2*Pe.y,S.vertexCount+=2;const Le=P.vertexLength;this.indexArray.emplaceBack(Le,Le+2,Le+1),this.indexArray.emplaceBack(Le+1,Le+2,Le+3),P.vertexLength+=4,P.primitiveLength+=2}}}}if(P.vertexLength+C>gn.MAX_VERTEX_ARRAY_LENGTH&&(P=this.segments.prepareSegment(C,this.layoutVertexArray,this.indexArray)),wy[n.type]!=="Polygon")continue;const M=[],R=[],F=P.vertexLength;for(const G of x)if(G.length!==0){G!==x[0]&&R.push(M.length/2);for(let Z=0;Z<G.length;Z++){const ne=G[Z];dc(this.layoutVertexArray,ne.x,ne.y,0,0,1,1,0),S.x+=ne.x,S.y+=ne.y,S.vertexCount+=1,M.push(ne.x),M.push(ne.y)}}const j=zh(M,R);for(let G=0;G<j.length;G+=3)this.indexArray.emplaceBack(F+j[G],F+j[G+2],F+j[G+1]);P.primitiveLength+=j.length/3,P.vertexLength+=C;for(let G=0;G<S.vertexCount;G++){const Z=Math.floor(S.x/S.vertexCount),ne=Math.floor(S.y/S.vertexCount);this.centroidVertexArray.emplaceBack(Z,ne)}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,n,l,v,p)}}function Ap(i,n){return i.x===n.x&&(i.x<0||i.x>Ir)||i.y===n.y&&(i.y<0||i.y>Ir)}function xg(i){return i.every(n=>n.x<0)||i.every(n=>n.x>Ir)||i.every(n=>n.y<0)||i.every(n=>n.y>Ir)}let fc;vt("FillExtrusionBucket",Pp,{omit:["layers","features"]});var Mp={get paint(){return fc=fc||new y({"fill-extrusion-opacity":new Ct(Ce["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Bt(Ce["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Ct(Ce["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Ct(Ce["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new sc(Ce["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Bt(Ce["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Bt(Ce["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Ct(Ce["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class wg extends a{constructor(n){super(n,Mp)}createBucket(n){return new Pp(n)}queryRadius(){return qd(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature(n,s,l,p,v,x,S,C){const P=Zd(n,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),x.angle,S),M=this.paint.get("fill-extrusion-height").evaluate(s,l),R=this.paint.get("fill-extrusion-base").evaluate(s,l),F=function(G,Z,ne,oe){const Pe=[];for(const ge of G){const _e=[ge.x,ge.y,0,1];Wd(_e,_e,Z),Pe.push(new W(_e[0]/_e[3],_e[1]/_e[3]))}return Pe}(P,C),j=function(G,Z,ne,oe){const Pe=[],ge=[],_e=oe[8]*Z,Le=oe[9]*Z,Ye=oe[10]*Z,gt=oe[11]*Z,Ft=oe[8]*ne,_t=oe[9]*ne,ft=oe[10]*ne,Pt=oe[11]*ne;for(const xt of G){const yt=[],$e=[];for(const At of xt){const kt=At.x,qt=At.y,tr=oe[0]*kt+oe[4]*qt+oe[12],Yn=oe[1]*kt+oe[5]*qt+oe[13],ei=oe[2]*kt+oe[6]*qt+oe[14],Cs=oe[3]*kt+oe[7]*qt+oe[15],xi=ei+Ye,Nr=Cs+gt,Ui=tr+Ft,ji=Yn+_t,$i=ei+ft,yn=Cs+Pt,$n=new W((tr+_e)/Nr,(Yn+Le)/Nr);$n.z=xi/Nr,yt.push($n);const Pi=new W(Ui/yn,ji/yn);Pi.z=$i/yn,$e.push(Pi)}Pe.push(yt),ge.push($e)}return[Pe,ge]}(p,R,M,C);return function(G,Z,ne){let oe=1/0;Vd(ne,Z)&&(oe=Lh(ne,Z[0]));for(let Pe=0;Pe<Z.length;Pe++){const ge=Z[Pe],_e=G[Pe];for(let Le=0;Le<ge.length-1;Le++){const Ye=ge[Le],gt=[Ye,ge[Le+1],_e[Le+1],_e[Le],Ye];kh(ne,gt)&&(oe=Math.min(oe,Lh(ne,gt)))}}return oe!==1/0&&oe}(j[0],j[1],F)}}function pc(i,n){return i.x*n.x+i.y*n.y}function Lh(i,n){if(i.length===1){let s=0;const l=n[s++];let p;for(;!p||l.equals(p);)if(p=n[s++],!p)return 1/0;for(;s<n.length;s++){const v=n[s],x=i[0],S=p.sub(l),C=v.sub(l),P=x.sub(l),M=pc(S,S),R=pc(S,C),F=pc(C,C),j=pc(P,S),G=pc(P,C),Z=M*F-R*R,ne=(F*j-R*G)/Z,oe=(M*G-R*j)/Z,Pe=l.z*(1-ne-oe)+p.z*ne+v.z*oe;if(isFinite(Pe))return Pe}return 1/0}{let s=1/0;for(const l of n)s=Math.min(s,l.z);return s}}const bg=E([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:ea}=bg,_u=E([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:by}=_u,Sg=Fr.VectorTileFeature.types,Sy=Math.cos(Math.PI/180*37.5),Tg=Math.pow(2,14)/.5;class zp{constructor(n){this.zoom=n.zoom,this.overscaling=n.overscaling,this.layers=n.layers,this.layerIds=this.layers.map(s=>s.id),this.index=n.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(s=>{this.gradients[s.id]={}}),this.layoutVertexArray=new Yo,this.layoutVertexArray2=new za,this.indexArray=new xs,this.programConfigurations=new _i(n.layers,n.zoom),this.segments=new gn,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(s=>s.isStateDependent()).map(s=>s.id)}populate(n,s,l){this.hasPattern=yi("line",this.layers,s);const p=this.layers[0].layout.get("line-sort-key"),v=!p.isConstant(),x=[];for(const{feature:S,id:C,index:P,sourceLayerIndex:M}of n){const R=this.layers[0]._featureFilter.needGeometry,F=ws(S,R);if(!this.layers[0]._featureFilter.filter(new ar(this.zoom),F,l))continue;const j=v?p.evaluate(F,{},l):void 0,G={id:C,properties:S.properties,type:S.type,sourceLayerIndex:M,index:P,geometry:R?F.geometry:oi(S),patterns:{},sortKey:j};x.push(G)}v&&x.sort((S,C)=>S.sortKey-C.sortKey);for(const S of x){const{geometry:C,index:P,sourceLayerIndex:M}=S;if(this.hasPattern){const R=Sp("line",this.layers,S,this.zoom,s);this.patternFeatures.push(R)}else this.addFeature(S,C,P,l,{});s.featureIndex.insert(n[P].feature,C,P,M,this.index)}}update(n,s,l){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(n,s,this.stateDependentLayers,l)}addFeatures(n,s,l){for(const p of this.patternFeatures)this.addFeature(p,p.geometry,p.index,s,l)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(n){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=n.createVertexBuffer(this.layoutVertexArray2,by)),this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,ea),this.indexBuffer=n.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(n),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(n){if(n.properties&&Object.prototype.hasOwnProperty.call(n.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(n.properties,"mapbox_clip_end"))return{start:+n.properties.mapbox_clip_start,end:+n.properties.mapbox_clip_end}}addFeature(n,s,l,p,v){const x=this.layers[0].layout,S=x.get("line-join").evaluate(n,{}),C=x.get("line-cap"),P=x.get("line-miter-limit"),M=x.get("line-round-limit");this.lineClips=this.lineFeatureClips(n);for(const R of s)this.addLine(R,n,S,C,P,M);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,n,l,v,p)}addLine(n,s,l,p,v,x){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let oe=0;oe<n.length-1;oe++)this.totalDistance+=n[oe].dist(n[oe+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const S=Sg[s.type]==="Polygon";let C=n.length;for(;C>=2&&n[C-1].equals(n[C-2]);)C--;let P=0;for(;P<C-1&&n[P].equals(n[P+1]);)P++;if(C<(S?3:2))return;l==="bevel"&&(v=1.05);const M=this.overscaling<=16?15*Ir/(512*this.overscaling):0,R=this.segments.prepareSegment(10*C,this.layoutVertexArray,this.indexArray);let F,j,G,Z,ne;this.e1=this.e2=-1,S&&(F=n[C-2],ne=n[P].sub(F)._unit()._perp());for(let oe=P;oe<C;oe++){if(G=oe===C-1?S?n[P+1]:void 0:n[oe+1],G&&n[oe].equals(G))continue;ne&&(Z=ne),F&&(j=F),F=n[oe],ne=G?G.sub(F)._unit()._perp():Z,Z=Z||ne;let Pe=Z.add(ne);Pe.x===0&&Pe.y===0||Pe._unit();const ge=Z.x*ne.x+Z.y*ne.y,_e=Pe.x*ne.x+Pe.y*ne.y,Le=_e!==0?1/_e:1/0,Ye=2*Math.sqrt(2-2*_e),gt=_e<Sy&&j&&G,Ft=Z.x*ne.y-Z.y*ne.x>0;if(gt&&oe>P){const Pt=F.dist(j);if(Pt>2*M){const xt=F.sub(F.sub(j)._mult(M/Pt)._round());this.updateDistance(j,xt),this.addCurrentVertex(xt,Z,0,0,R),j=xt}}const _t=j&&G;let ft=_t?l:S?"butt":p;if(_t&&ft==="round"&&(Le<x?ft="miter":Le<=2&&(ft="fakeround")),ft==="miter"&&Le>v&&(ft="bevel"),ft==="bevel"&&(Le>2&&(ft="flipbevel"),Le<v&&(ft="miter")),j&&this.updateDistance(j,F),ft==="miter")Pe._mult(Le),this.addCurrentVertex(F,Pe,0,0,R);else if(ft==="flipbevel"){if(Le>100)Pe=ne.mult(-1);else{const Pt=Le*Z.add(ne).mag()/Z.sub(ne).mag();Pe._perp()._mult(Pt*(Ft?-1:1))}this.addCurrentVertex(F,Pe,0,0,R),this.addCurrentVertex(F,Pe.mult(-1),0,0,R)}else if(ft==="bevel"||ft==="fakeround"){const Pt=-Math.sqrt(Le*Le-1),xt=Ft?Pt:0,yt=Ft?0:Pt;if(j&&this.addCurrentVertex(F,Z,xt,yt,R),ft==="fakeround"){const $e=Math.round(180*Ye/Math.PI/20);for(let At=1;At<$e;At++){let kt=At/$e;if(kt!==.5){const tr=kt-.5;kt+=kt*tr*(kt-1)*((1.0904+ge*(ge*(3.55645-1.43519*ge)-3.2452))*tr*tr+(.848013+ge*(.215638*ge-1.06021)))}const qt=ne.sub(Z)._mult(kt)._add(Z)._unit()._mult(Ft?-1:1);this.addHalfVertex(F,qt.x,qt.y,!1,Ft,0,R)}}G&&this.addCurrentVertex(F,ne,-xt,-yt,R)}else if(ft==="butt")this.addCurrentVertex(F,Pe,0,0,R);else if(ft==="square"){const Pt=j?1:-1;this.addCurrentVertex(F,Pe,Pt,Pt,R)}else ft==="round"&&(j&&(this.addCurrentVertex(F,Z,0,0,R),this.addCurrentVertex(F,Z,1,1,R,!0)),G&&(this.addCurrentVertex(F,ne,-1,-1,R,!0),this.addCurrentVertex(F,ne,0,0,R)));if(gt&&oe<C-1){const Pt=F.dist(G);if(Pt>2*M){const xt=F.add(G.sub(F)._mult(M/Pt)._round());this.updateDistance(F,xt),this.addCurrentVertex(xt,ne,0,0,R),F=xt}}}}addCurrentVertex(n,s,l,p,v,x=!1){const S=s.y*p-s.x,C=-s.y-s.x*p;this.addHalfVertex(n,s.x+s.y*l,s.y-s.x*l,x,!1,l,v),this.addHalfVertex(n,S,C,x,!0,-p,v),this.distance>Tg/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(n,s,l,p,v,x))}addHalfVertex({x:n,y:s},l,p,v,x,S,C){const P=.5*(this.lineClips?this.scaledDistance*(Tg-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((n<<1)+(v?1:0),(s<<1)+(x?1:0),Math.round(63*l)+128,Math.round(63*p)+128,1+(S===0?0:S<0?-1:1)|(63&P)<<2,P>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const M=C.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,M),C.primitiveLength++),x?this.e2=M:this.e1=M}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(n,s){this.distance+=n.dist(s),this.updateScaledDistance()}}let Eg,Cg;vt("LineBucket",zp,{omit:["layers","patternFeatures"]});var Ig={get paint(){return Cg=Cg||new y({"line-opacity":new Bt(Ce.paint_line["line-opacity"]),"line-color":new Bt(Ce.paint_line["line-color"]),"line-translate":new Ct(Ce.paint_line["line-translate"]),"line-translate-anchor":new Ct(Ce.paint_line["line-translate-anchor"]),"line-width":new Bt(Ce.paint_line["line-width"]),"line-gap-width":new Bt(Ce.paint_line["line-gap-width"]),"line-offset":new Bt(Ce.paint_line["line-offset"]),"line-blur":new Bt(Ce.paint_line["line-blur"]),"line-dasharray":new oc(Ce.paint_line["line-dasharray"]),"line-pattern":new sc(Ce.paint_line["line-pattern"]),"line-gradient":new bo(Ce.paint_line["line-gradient"])})},get layout(){return Eg=Eg||new y({"line-cap":new Ct(Ce.layout_line["line-cap"]),"line-join":new Bt(Ce.layout_line["line-join"]),"line-miter-limit":new Ct(Ce.layout_line["line-miter-limit"]),"line-round-limit":new Ct(Ce.layout_line["line-round-limit"]),"line-sort-key":new Bt(Ce.layout_line["line-sort-key"])})}};class Ty extends Bt{possiblyEvaluate(n,s){return s=new ar(Math.floor(s.zoom),{now:s.now,fadeDuration:s.fadeDuration,zoomHistory:s.zoomHistory,transition:s.transition}),super.possiblyEvaluate(n,s)}evaluate(n,s,l,p){return s=ve({},s,{zoom:Math.floor(s.zoom)}),super.evaluate(n,s,l,p)}}let Qd;class Ey extends a{constructor(n){super(n,Ig),this.gradientVersion=0,Qd||(Qd=new Ty(Ig.paint.properties["line-width"].specification),Qd.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(n){if(n==="line-gradient"){const s=this.gradientExpression();this.stepInterpolant=!!function(l){return l._styleExpression!==void 0}(s)&&s._styleExpression.expression instanceof sl,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(n,s){super.recalculate(n,s),this.paint._values["line-floorwidth"]=Qd.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,n)}createBucket(n){return new zp(n)}queryRadius(n){const s=n,l=kg(au("line-width",this,s),au("line-gap-width",this,s)),p=au("line-offset",this,s);return l/2+Math.abs(p)+qd(this.paint.get("line-translate"))}queryIntersectsFeature(n,s,l,p,v,x,S){const C=Zd(n,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),x.angle,S),P=S/2*kg(this.paint.get("line-width").evaluate(s,l),this.paint.get("line-gap-width").evaluate(s,l)),M=this.paint.get("line-offset").evaluate(s,l);return M&&(p=function(R,F){const j=[];for(let G=0;G<R.length;G++){const Z=R[G],ne=[];for(let oe=0;oe<Z.length;oe++){const Pe=Z[oe-1],ge=Z[oe],_e=Z[oe+1],Le=oe===0?new W(0,0):ge.sub(Pe)._unit()._perp(),Ye=oe===Z.length-1?new W(0,0):_e.sub(ge)._unit()._perp(),gt=Le._add(Ye)._unit(),Ft=gt.x*Ye.x+gt.y*Ye.y;Ft!==0&&gt._mult(1/Ft),ne.push(gt._mult(F)._add(ge))}j.push(ne)}return j}(p,M*S)),function(R,F,j){for(let G=0;G<F.length;G++){const Z=F[G];if(R.length>=3){for(let ne=0;ne<Z.length;ne++)if(ou(R,Z[ne]))return!0}if(sg(R,Z,j))return!0}return!1}(C,p,P)}isTileClipped(){return!0}}function kg(i,n){return n>0?n+2*i:i}const Cy=E([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),Pg=E([{name:"a_projected_pos",components:3,type:"Float32"}],4);E([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const Ag=E([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_box_real",components:2,type:"Int16"}]);E([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const Dp=E([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),Iy=E([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function ky(i,n,s){return i.sections.forEach(l=>{l.text=function(p,v,x){const S=v.layout.get("text-transform").evaluate(x,{});return S==="uppercase"?p=p.toLocaleUpperCase():S==="lowercase"&&(p=p.toLocaleLowerCase()),Ji.applyArabicShaping&&(p=Ji.applyArabicShaping(p)),p}(l.text,n,s)}),i}E([{name:"triangle",components:3,type:"Uint16"}]),E([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),E([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),E([{type:"Float32",name:"offsetX"}]),E([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),E([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);const Oh={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""};var Br=24,Mg=Kn,zg=function(i,n,s,l,p){var v,x,S=8*p-l-1,C=(1<<S)-1,P=C>>1,M=-7,R=p-1,F=-1,j=i[n+R];for(R+=F,v=j&(1<<-M)-1,j>>=-M,M+=S;M>0;v=256*v+i[n+R],R+=F,M-=8);for(x=v&(1<<-M)-1,v>>=-M,M+=l;M>0;x=256*x+i[n+R],R+=F,M-=8);if(v===0)v=1-P;else{if(v===C)return x?NaN:1/0*(j?-1:1);x+=Math.pow(2,l),v-=P}return(j?-1:1)*x*Math.pow(2,v-l)},Dg=function(i,n,s,l,p,v){var x,S,C,P=8*v-p-1,M=(1<<P)-1,R=M>>1,F=p===23?Math.pow(2,-24)-Math.pow(2,-77):0,j=0,G=1,Z=n<0||n===0&&1/n<0?1:0;for(n=Math.abs(n),isNaN(n)||n===1/0?(S=isNaN(n)?1:0,x=M):(x=Math.floor(Math.log(n)/Math.LN2),n*(C=Math.pow(2,-x))<1&&(x--,C*=2),(n+=x+R>=1?F/C:F*Math.pow(2,1-R))*C>=2&&(x++,C/=2),x+R>=M?(S=0,x=M):x+R>=1?(S=(n*C-1)*Math.pow(2,p),x+=R):(S=n*Math.pow(2,R-1)*Math.pow(2,p),x=0));p>=8;i[s+j]=255&S,j+=G,S/=256,p-=8);for(x=x<<p|S,P+=p;P>0;i[s+j]=255&x,j+=G,x/=256,P-=8);i[s+j-G]|=128*Z};function Kn(i){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(i)?i:new Uint8Array(i||0),this.pos=0,this.type=0,this.length=this.buf.length}Kn.Varint=0,Kn.Fixed64=1,Kn.Bytes=2,Kn.Fixed32=5;var Rp=4294967296,Rg=1/Rp,Us=typeof TextDecoder>"u"?null:new TextDecoder("utf-8");function Ua(i){return i.type===Kn.Bytes?i.readVarint()+i.pos:i.pos+1}function mc(i,n,s){return s?4294967296*n+(i>>>0):4294967296*(n>>>0)+(i>>>0)}function Lg(i,n,s){var l=n<=16383?1:n<=2097151?2:n<=268435455?3:Math.floor(Math.log(n)/(7*Math.LN2));s.realloc(l);for(var p=s.pos-1;p>=i;p--)s.buf[p+l]=s.buf[p]}function Og(i,n){for(var s=0;s<i.length;s++)n.writeVarint(i[s])}function Py(i,n){for(var s=0;s<i.length;s++)n.writeSVarint(i[s])}function Ay(i,n){for(var s=0;s<i.length;s++)n.writeFloat(i[s])}function My(i,n){for(var s=0;s<i.length;s++)n.writeDouble(i[s])}function zy(i,n){for(var s=0;s<i.length;s++)n.writeBoolean(i[s])}function Lp(i,n){for(var s=0;s<i.length;s++)n.writeFixed32(i[s])}function Dy(i,n){for(var s=0;s<i.length;s++)n.writeSFixed32(i[s])}function Ry(i,n){for(var s=0;s<i.length;s++)n.writeFixed64(i[s])}function Ly(i,n){for(var s=0;s<i.length;s++)n.writeSFixed64(i[s])}function ef(i,n){return(i[n]|i[n+1]<<8|i[n+2]<<16)+16777216*i[n+3]}function gc(i,n,s){i[s]=n,i[s+1]=n>>>8,i[s+2]=n>>>16,i[s+3]=n>>>24}function Fg(i,n){return(i[n]|i[n+1]<<8|i[n+2]<<16)+(i[n+3]<<24)}Kn.prototype={destroy:function(){this.buf=null},readFields:function(i,n,s){for(s=s||this.length;this.pos<s;){var l=this.readVarint(),p=l>>3,v=this.pos;this.type=7&l,i(p,n,this),this.pos===v&&this.skip(l)}return n},readMessage:function(i,n){return this.readFields(i,n,this.readVarint()+this.pos)},readFixed32:function(){var i=ef(this.buf,this.pos);return this.pos+=4,i},readSFixed32:function(){var i=Fg(this.buf,this.pos);return this.pos+=4,i},readFixed64:function(){var i=ef(this.buf,this.pos)+ef(this.buf,this.pos+4)*Rp;return this.pos+=8,i},readSFixed64:function(){var i=ef(this.buf,this.pos)+Fg(this.buf,this.pos+4)*Rp;return this.pos+=8,i},readFloat:function(){var i=zg(this.buf,this.pos,!0,23,4);return this.pos+=4,i},readDouble:function(){var i=zg(this.buf,this.pos,!0,52,8);return this.pos+=8,i},readVarint:function(i){var n,s,l=this.buf;return n=127&(s=l[this.pos++]),s<128?n:(n|=(127&(s=l[this.pos++]))<<7,s<128?n:(n|=(127&(s=l[this.pos++]))<<14,s<128?n:(n|=(127&(s=l[this.pos++]))<<21,s<128?n:function(p,v,x){var S,C,P=x.buf;if(S=(112&(C=P[x.pos++]))>>4,C<128||(S|=(127&(C=P[x.pos++]))<<3,C<128)||(S|=(127&(C=P[x.pos++]))<<10,C<128)||(S|=(127&(C=P[x.pos++]))<<17,C<128)||(S|=(127&(C=P[x.pos++]))<<24,C<128)||(S|=(1&(C=P[x.pos++]))<<31,C<128))return mc(p,S,v);throw new Error("Expected varint not more than 10 bytes")}(n|=(15&(s=l[this.pos]))<<28,i,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var i=this.readVarint();return i%2==1?(i+1)/-2:i/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var i=this.readVarint()+this.pos,n=this.pos;return this.pos=i,i-n>=12&&Us?function(s,l,p){return Us.decode(s.subarray(l,p))}(this.buf,n,i):function(s,l,p){for(var v="",x=l;x<p;){var S,C,P,M=s[x],R=null,F=M>239?4:M>223?3:M>191?2:1;if(x+F>p)break;F===1?M<128&&(R=M):F===2?(192&(S=s[x+1]))==128&&(R=(31&M)<<6|63&S)<=127&&(R=null):F===3?(C=s[x+2],(192&(S=s[x+1]))==128&&(192&C)==128&&((R=(15&M)<<12|(63&S)<<6|63&C)<=2047||R>=55296&&R<=57343)&&(R=null)):F===4&&(C=s[x+2],P=s[x+3],(192&(S=s[x+1]))==128&&(192&C)==128&&(192&P)==128&&((R=(15&M)<<18|(63&S)<<12|(63&C)<<6|63&P)<=65535||R>=1114112)&&(R=null)),R===null?(R=65533,F=1):R>65535&&(R-=65536,v+=String.fromCharCode(R>>>10&1023|55296),R=56320|1023&R),v+=String.fromCharCode(R),x+=F}return v}(this.buf,n,i)},readBytes:function(){var i=this.readVarint()+this.pos,n=this.buf.subarray(this.pos,i);return this.pos=i,n},readPackedVarint:function(i,n){if(this.type!==Kn.Bytes)return i.push(this.readVarint(n));var s=Ua(this);for(i=i||[];this.pos<s;)i.push(this.readVarint(n));return i},readPackedSVarint:function(i){if(this.type!==Kn.Bytes)return i.push(this.readSVarint());var n=Ua(this);for(i=i||[];this.pos<n;)i.push(this.readSVarint());return i},readPackedBoolean:function(i){if(this.type!==Kn.Bytes)return i.push(this.readBoolean());var n=Ua(this);for(i=i||[];this.pos<n;)i.push(this.readBoolean());return i},readPackedFloat:function(i){if(this.type!==Kn.Bytes)return i.push(this.readFloat());var n=Ua(this);for(i=i||[];this.pos<n;)i.push(this.readFloat());return i},readPackedDouble:function(i){if(this.type!==Kn.Bytes)return i.push(this.readDouble());var n=Ua(this);for(i=i||[];this.pos<n;)i.push(this.readDouble());return i},readPackedFixed32:function(i){if(this.type!==Kn.Bytes)return i.push(this.readFixed32());var n=Ua(this);for(i=i||[];this.pos<n;)i.push(this.readFixed32());return i},readPackedSFixed32:function(i){if(this.type!==Kn.Bytes)return i.push(this.readSFixed32());var n=Ua(this);for(i=i||[];this.pos<n;)i.push(this.readSFixed32());return i},readPackedFixed64:function(i){if(this.type!==Kn.Bytes)return i.push(this.readFixed64());var n=Ua(this);for(i=i||[];this.pos<n;)i.push(this.readFixed64());return i},readPackedSFixed64:function(i){if(this.type!==Kn.Bytes)return i.push(this.readSFixed64());var n=Ua(this);for(i=i||[];this.pos<n;)i.push(this.readSFixed64());return i},skip:function(i){var n=7&i;if(n===Kn.Varint)for(;this.buf[this.pos++]>127;);else if(n===Kn.Bytes)this.pos=this.readVarint()+this.pos;else if(n===Kn.Fixed32)this.pos+=4;else{if(n!==Kn.Fixed64)throw new Error("Unimplemented type: "+n);this.pos+=8}},writeTag:function(i,n){this.writeVarint(i<<3|n)},realloc:function(i){for(var n=this.length||16;n<this.pos+i;)n*=2;if(n!==this.length){var s=new Uint8Array(n);s.set(this.buf),this.buf=s,this.length=n}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(i){this.realloc(4),gc(this.buf,i,this.pos),this.pos+=4},writeSFixed32:function(i){this.realloc(4),gc(this.buf,i,this.pos),this.pos+=4},writeFixed64:function(i){this.realloc(8),gc(this.buf,-1&i,this.pos),gc(this.buf,Math.floor(i*Rg),this.pos+4),this.pos+=8},writeSFixed64:function(i){this.realloc(8),gc(this.buf,-1&i,this.pos),gc(this.buf,Math.floor(i*Rg),this.pos+4),this.pos+=8},writeVarint:function(i){(i=+i||0)>268435455||i<0?function(n,s){var l,p;if(n>=0?(l=n%4294967296|0,p=n/4294967296|0):(p=~(-n/4294967296),4294967295^(l=~(-n%4294967296))?l=l+1|0:(l=0,p=p+1|0)),n>=18446744073709552e3||n<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");s.realloc(10),function(v,x,S){S.buf[S.pos++]=127&v|128,v>>>=7,S.buf[S.pos++]=127&v|128,v>>>=7,S.buf[S.pos++]=127&v|128,v>>>=7,S.buf[S.pos++]=127&v|128,S.buf[S.pos]=127&(v>>>=7)}(l,0,s),function(v,x){var S=(7&v)<<4;x.buf[x.pos++]|=S|((v>>>=3)?128:0),v&&(x.buf[x.pos++]=127&v|((v>>>=7)?128:0),v&&(x.buf[x.pos++]=127&v|((v>>>=7)?128:0),v&&(x.buf[x.pos++]=127&v|((v>>>=7)?128:0),v&&(x.buf[x.pos++]=127&v|((v>>>=7)?128:0),v&&(x.buf[x.pos++]=127&v)))))}(p,s)}(i,this):(this.realloc(4),this.buf[this.pos++]=127&i|(i>127?128:0),i<=127||(this.buf[this.pos++]=127&(i>>>=7)|(i>127?128:0),i<=127||(this.buf[this.pos++]=127&(i>>>=7)|(i>127?128:0),i<=127||(this.buf[this.pos++]=i>>>7&127))))},writeSVarint:function(i){this.writeVarint(i<0?2*-i-1:2*i)},writeBoolean:function(i){this.writeVarint(!!i)},writeString:function(i){i=String(i),this.realloc(4*i.length),this.pos++;var n=this.pos;this.pos=function(l,p,v){for(var x,S,C=0;C<p.length;C++){if((x=p.charCodeAt(C))>55295&&x<57344){if(!S){x>56319||C+1===p.length?(l[v++]=239,l[v++]=191,l[v++]=189):S=x;continue}if(x<56320){l[v++]=239,l[v++]=191,l[v++]=189,S=x;continue}x=S-55296<<10|x-56320|65536,S=null}else S&&(l[v++]=239,l[v++]=191,l[v++]=189,S=null);x<128?l[v++]=x:(x<2048?l[v++]=x>>6|192:(x<65536?l[v++]=x>>12|224:(l[v++]=x>>18|240,l[v++]=x>>12&63|128),l[v++]=x>>6&63|128),l[v++]=63&x|128)}return v}(this.buf,i,this.pos);var s=this.pos-n;s>=128&&Lg(n,s,this),this.pos=n-1,this.writeVarint(s),this.pos+=s},writeFloat:function(i){this.realloc(4),Dg(this.buf,i,this.pos,!0,23,4),this.pos+=4},writeDouble:function(i){this.realloc(8),Dg(this.buf,i,this.pos,!0,52,8),this.pos+=8},writeBytes:function(i){var n=i.length;this.writeVarint(n),this.realloc(n);for(var s=0;s<n;s++)this.buf[this.pos++]=i[s]},writeRawMessage:function(i,n){this.pos++;var s=this.pos;i(n,this);var l=this.pos-s;l>=128&&Lg(s,l,this),this.pos=s-1,this.writeVarint(l),this.pos+=l},writeMessage:function(i,n,s){this.writeTag(i,Kn.Bytes),this.writeRawMessage(n,s)},writePackedVarint:function(i,n){n.length&&this.writeMessage(i,Og,n)},writePackedSVarint:function(i,n){n.length&&this.writeMessage(i,Py,n)},writePackedBoolean:function(i,n){n.length&&this.writeMessage(i,zy,n)},writePackedFloat:function(i,n){n.length&&this.writeMessage(i,Ay,n)},writePackedDouble:function(i,n){n.length&&this.writeMessage(i,My,n)},writePackedFixed32:function(i,n){n.length&&this.writeMessage(i,Lp,n)},writePackedSFixed32:function(i,n){n.length&&this.writeMessage(i,Dy,n)},writePackedFixed64:function(i,n){n.length&&this.writeMessage(i,Ry,n)},writePackedSFixed64:function(i,n){n.length&&this.writeMessage(i,Ly,n)},writeBytesField:function(i,n){this.writeTag(i,Kn.Bytes),this.writeBytes(n)},writeFixed32Field:function(i,n){this.writeTag(i,Kn.Fixed32),this.writeFixed32(n)},writeSFixed32Field:function(i,n){this.writeTag(i,Kn.Fixed32),this.writeSFixed32(n)},writeFixed64Field:function(i,n){this.writeTag(i,Kn.Fixed64),this.writeFixed64(n)},writeSFixed64Field:function(i,n){this.writeTag(i,Kn.Fixed64),this.writeSFixed64(n)},writeVarintField:function(i,n){this.writeTag(i,Kn.Varint),this.writeVarint(n)},writeSVarintField:function(i,n){this.writeTag(i,Kn.Varint),this.writeSVarint(n)},writeStringField:function(i,n){this.writeTag(i,Kn.Bytes),this.writeString(n)},writeFloatField:function(i,n){this.writeTag(i,Kn.Fixed32),this.writeFloat(n)},writeDoubleField:function(i,n){this.writeTag(i,Kn.Fixed64),this.writeDouble(n)},writeBooleanField:function(i,n){this.writeVarintField(i,!!n)}};var Op=D(Mg);const Fp=3;function Oy(i,n,s){i===1&&s.readMessage(Fy,n)}function Fy(i,n,s){if(i===3){const{id:l,bitmap:p,width:v,height:x,left:S,top:C,advance:P}=s.readMessage(By,{});n.push({id:l,bitmap:new Ah({width:v+2*Fp,height:x+2*Fp},p),metrics:{width:v,height:x,left:S,top:C,advance:P}})}}function By(i,n,s){i===1?n.id=s.readVarint():i===2?n.bitmap=s.readBytes():i===3?n.width=s.readVarint():i===4?n.height=s.readVarint():i===5?n.left=s.readSVarint():i===6?n.top=s.readSVarint():i===7&&(n.advance=s.readVarint())}const Bg=Fp;function Ng(i){let n=0,s=0;for(const x of i)n+=x.w*x.h,s=Math.max(s,x.w);i.sort((x,S)=>S.h-x.h);const l=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(n/.95)),s),h:1/0}];let p=0,v=0;for(const x of i)for(let S=l.length-1;S>=0;S--){const C=l[S];if(!(x.w>C.w||x.h>C.h)){if(x.x=C.x,x.y=C.y,v=Math.max(v,x.y+x.h),p=Math.max(p,x.x+x.w),x.w===C.w&&x.h===C.h){const P=l.pop();S<l.length&&(l[S]=P)}else x.h===C.h?(C.x+=x.w,C.w-=x.w):x.w===C.w?(C.y+=x.h,C.h-=x.h):(l.push({x:C.x+x.w,y:C.y,w:C.w-x.w,h:x.h}),C.y+=x.h,C.h-=x.h);break}}return{w:p,h:v,fill:n/(p*v)||0}}const ts=1;class Bp{constructor(n,{pixelRatio:s,version:l,stretchX:p,stretchY:v,content:x,textFitWidth:S,textFitHeight:C}){this.paddedRect=n,this.pixelRatio=s,this.stretchX=p,this.stretchY=v,this.content=x,this.version=l,this.textFitWidth=S,this.textFitHeight=C}get tl(){return[this.paddedRect.x+ts,this.paddedRect.y+ts]}get br(){return[this.paddedRect.x+this.paddedRect.w-ts,this.paddedRect.y+this.paddedRect.h-ts]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2*ts)/this.pixelRatio,(this.paddedRect.h-2*ts)/this.pixelRatio]}}class Ug{constructor(n,s){const l={},p={};this.haveRenderCallbacks=[];const v=[];this.addImages(n,l,v),this.addImages(s,p,v);const{w:x,h:S}=Ng(v),C=new Ss({width:x||1,height:S||1});for(const P in n){const M=n[P],R=l[P].paddedRect;Ss.copy(M.data,C,{x:0,y:0},{x:R.x+ts,y:R.y+ts},M.data)}for(const P in s){const M=s[P],R=p[P].paddedRect,F=R.x+ts,j=R.y+ts,G=M.data.width,Z=M.data.height;Ss.copy(M.data,C,{x:0,y:0},{x:F,y:j},M.data),Ss.copy(M.data,C,{x:0,y:Z-1},{x:F,y:j-1},{width:G,height:1}),Ss.copy(M.data,C,{x:0,y:0},{x:F,y:j+Z},{width:G,height:1}),Ss.copy(M.data,C,{x:G-1,y:0},{x:F-1,y:j},{width:1,height:Z}),Ss.copy(M.data,C,{x:0,y:0},{x:F+G,y:j},{width:1,height:Z})}this.image=C,this.iconPositions=l,this.patternPositions=p}addImages(n,s,l){for(const p in n){const v=n[p],x={x:0,y:0,w:v.data.width+2*ts,h:v.data.height+2*ts};l.push(x),s[p]=new Bp(x,v),v.hasRenderCallback&&this.haveRenderCallbacks.push(p)}}patchUpdatedImages(n,s){n.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const l in n.updatedImages)this.patchUpdatedImage(this.iconPositions[l],n.getImage(l),s),this.patchUpdatedImage(this.patternPositions[l],n.getImage(l),s)}patchUpdatedImage(n,s,l){if(!n||!s||n.version===s.version)return;n.version=s.version;const[p,v]=n.tl;l.update(s.data,void 0,{x:p,y:v})}}var Pl;vt("ImagePosition",Bp),vt("ImageAtlas",Ug),w.ah=void 0,(Pl=w.ah||(w.ah={}))[Pl.none=0]="none",Pl[Pl.horizontal=1]="horizontal",Pl[Pl.vertical=2]="vertical",Pl[Pl.horizontalOnly=3]="horizontalOnly";const Fh=-17;class Bh{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(n,s){const l=new Bh;return l.scale=n||1,l.fontStack=s,l}static forImage(n){const s=new Bh;return s.imageName=n,s}}class _c{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(n,s){const l=new _c;for(let p=0;p<n.sections.length;p++){const v=n.sections[p];v.image?l.addImageSection(v):l.addTextSection(v,s)}return l}length(){return this.text.length}getSection(n){return this.sections[this.sectionIndex[n]]}getSectionIndex(n){return this.sectionIndex[n]}getCharCode(n){return this.text.charCodeAt(n)}verticalizePunctuation(){this.text=function(n){let s="";for(let l=0;l<n.length;l++){const p=n.charCodeAt(l+1)||null,v=n.charCodeAt(l-1)||null;s+=p&&Od(p)&&!Oh[n[l+1]]||v&&Od(v)&&!Oh[n[l-1]]||!Oh[n[l]]?n[l]:Oh[n[l]]}return s}(this.text)}trim(){let n=0;for(let l=0;l<this.text.length&&Nh[this.text.charCodeAt(l)];l++)n++;let s=this.text.length;for(let l=this.text.length-1;l>=0&&l>=n&&Nh[this.text.charCodeAt(l)];l--)s--;this.text=this.text.substring(n,s),this.sectionIndex=this.sectionIndex.slice(n,s)}substring(n,s){const l=new _c;return l.text=this.text.substring(n,s),l.sectionIndex=this.sectionIndex.slice(n,s),l.sections=this.sections,l}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((n,s)=>Math.max(n,this.sections[s].scale),0)}addTextSection(n,s){this.text+=n.text,this.sections.push(Bh.forText(n.scale,n.fontStack||s));const l=this.sections.length-1;for(let p=0;p<n.text.length;++p)this.sectionIndex.push(l)}addImageSection(n){const s=n.image?n.image.name:"";if(s.length===0)return void mt("Can't add FormattedSection with an empty image.");const l=this.getNextImageSectionCharCode();l?(this.text+=String.fromCharCode(l),this.sections.push(Bh.forImage(s)),this.sectionIndex.push(this.sections.length-1)):mt("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function yc(i,n,s,l,p,v,x,S,C,P,M,R,F,j,G){const Z=_c.fromFeature(i,p);let ne;R===w.ah.vertical&&Z.verticalizePunctuation();const{processBidirectionalText:oe,processStyledBidirectionalText:Pe}=Ji;if(oe&&Z.sections.length===1){ne=[];const Le=oe(Z.toString(),Np(Z,P,v,n,l,j));for(const Ye of Le){const gt=new _c;gt.text=Ye,gt.sections=Z.sections;for(let Ft=0;Ft<Ye.length;Ft++)gt.sectionIndex.push(0);ne.push(gt)}}else if(Pe){ne=[];const Le=Pe(Z.text,Z.sectionIndex,Np(Z,P,v,n,l,j));for(const Ye of Le){const gt=new _c;gt.text=Ye[0],gt.sectionIndex=Ye[1],gt.sections=Z.sections,ne.push(gt)}}else ne=function(Le,Ye){const gt=[],Ft=Le.text;let _t=0;for(const ft of Ye)gt.push(Le.substring(_t,ft)),_t=ft;return _t<Ft.length&&gt.push(Le.substring(_t,Ft.length)),gt}(Z,Np(Z,P,v,n,l,j));const ge=[],_e={positionedLines:ge,text:Z.toString(),top:M[1],bottom:M[1],left:M[0],right:M[0],writingMode:R,iconsInText:!1,verticalizable:!1};return function(Le,Ye,gt,Ft,_t,ft,Pt,xt,yt,$e,At,kt){let qt=0,tr=Fh,Yn=0,ei=0;const Cs=xt==="right"?1:xt==="left"?0:.5;let xi=0;for(const yn of _t){yn.trim();const $n=yn.getMaxScale(),Pi=($n-1)*Br,wi={positionedGlyphs:[],lineOffset:0};Le.positionedLines[xi]=wi;const Vi=wi.positionedGlyphs;let ai=0;if(!yn.length()){tr+=ft,++xi;continue}for(let ns=0;ns<yn.length();ns++){const zn=yn.getSection(ns),nr=yn.getSectionIndex(ns),lr=yn.getCharCode(ns);let Is=0,Sr=null,vu=null,Eo=null,ra=Br;const ro=!(yt===w.ah.horizontal||!At&&!wh(lr)||At&&(Nh[lr]||(Nr=lr,new RegExp("\\p{sc=Arab}","u").test(String.fromCodePoint(Nr)))));if(zn.imageName){const $s=Ft[zn.imageName];if(!$s)continue;Eo=zn.imageName,Le.iconsInText=Le.iconsInText||!0,vu=$s.paddedRect;const li=$s.displaySize;zn.scale=zn.scale*Br/kt,Sr={width:li[0],height:li[1],left:ts,top:-Bg,advance:ro?li[1]:li[0]},Is=Pi+(Br-li[1]*zn.scale),ra=Sr.advance;const ks=ro?li[0]*zn.scale-Br*$n:li[1]*zn.scale-Br*$n;ks>0&&ks>ai&&(ai=ks)}else{const $s=gt[zn.fontStack],li=$s&&$s[lr];if(li&&li.rect)vu=li.rect,Sr=li.metrics;else{const ks=Ye[zn.fontStack],Gh=ks&&ks[lr];if(!Gh)continue;Sr=Gh.metrics}Is=($n-zn.scale)*Br}ro?(Le.verticalizable=!0,Vi.push({glyph:lr,imageName:Eo,x:qt,y:tr+Is,vertical:ro,scale:zn.scale,fontStack:zn.fontStack,sectionIndex:nr,metrics:Sr,rect:vu}),qt+=ra*zn.scale+$e):(Vi.push({glyph:lr,imageName:Eo,x:qt,y:tr+Is,vertical:ro,scale:zn.scale,fontStack:zn.fontStack,sectionIndex:nr,metrics:Sr,rect:vu}),qt+=Sr.advance*zn.scale+$e)}Vi.length!==0&&(Yn=Math.max(qt-$e,Yn),$y(Vi,0,Vi.length-1,Cs,ai)),qt=0;const js=ft*$n+ai;wi.lineOffset=Math.max(ai,Pi),tr+=js,ei=Math.max(js,ei),++xi}var Nr;const Ui=tr-Fh,{horizontalAlign:ji,verticalAlign:$i}=tf(Pt);(function(yn,$n,Pi,wi,Vi,ai,js,ns,zn){const nr=($n-Pi)*Vi;let lr=0;lr=ai!==js?-ns*wi-Fh:(-wi*zn+.5)*js;for(const Is of yn)for(const Sr of Is.positionedGlyphs)Sr.x+=nr,Sr.y+=lr})(Le.positionedLines,Cs,ji,$i,Yn,ei,ft,Ui,_t.length),Le.top+=-$i*Ui,Le.bottom=Le.top+Ui,Le.left+=-ji*Yn,Le.right=Le.left+Yn}(_e,n,s,l,ne,x,S,C,R,P,F,G),!function(Le){for(const Ye of Le)if(Ye.positionedGlyphs.length!==0)return!1;return!0}(ge)&&_e}const Nh={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},Ny={10:!0,32:!0,38:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0},Uy={40:!0};function jg(i,n,s,l,p,v){if(n.imageName){const x=l[n.imageName];return x?x.displaySize[0]*n.scale*Br/v+p:0}{const x=s[n.fontStack],S=x&&x[i];return S?S.metrics.advance*n.scale+p:0}}function $g(i,n,s,l){const p=Math.pow(i-n,2);return l?i<n?p/2:2*p:p+Math.abs(s)*s}function jy(i,n,s){let l=0;return i===10&&(l-=1e4),s&&(l+=150),i!==40&&i!==65288||(l+=50),n!==41&&n!==65289||(l+=50),l}function Vg(i,n,s,l,p,v){let x=null,S=$g(n,s,p,v);for(const C of l){const P=$g(n-C.x,s,p,v)+C.badness;P<=S&&(x=C,S=P)}return{index:i,x:n,priorBreak:x,badness:S}}function qg(i){return i?qg(i.priorBreak).concat(i.index):[]}function Np(i,n,s,l,p,v){if(!i)return[];const x=[],S=function(R,F,j,G,Z,ne){let oe=0;for(let Pe=0;Pe<R.length();Pe++){const ge=R.getSection(Pe);oe+=jg(R.getCharCode(Pe),ge,G,Z,F,ne)}return oe/Math.max(1,Math.ceil(oe/j))}(i,n,s,l,p,v),C=i.text.indexOf("")>=0;let P=0;for(let R=0;R<i.length();R++){const F=i.getSection(R),j=i.getCharCode(R);if(Nh[j]||(P+=jg(j,F,l,p,n,v)),R<i.length()-1){const G=!((M=j)<11904)&&(!!mn["CJK Compatibility Forms"](M)||!!mn["CJK Compatibility"](M)||!!mn["CJK Strokes"](M)||!!mn["CJK Symbols and Punctuation"](M)||!!mn["Enclosed CJK Letters and Months"](M)||!!mn["Halfwidth and Fullwidth Forms"](M)||!!mn["Ideographic Description Characters"](M)||!!mn["Vertical Forms"](M)||Ld.test(String.fromCodePoint(M)));(Ny[j]||G||F.imageName||R!==i.length()-2&&Uy[i.getCharCode(R+1)])&&x.push(Vg(R+1,P,S,x,jy(j,i.getCharCode(R+1),G&&C),!1))}}var M;return qg(Vg(i.length(),P,S,x,0,!0))}function tf(i){let n=.5,s=.5;switch(i){case"right":case"top-right":case"bottom-right":n=1;break;case"left":case"top-left":case"bottom-left":n=0}switch(i){case"bottom":case"bottom-right":case"bottom-left":s=1;break;case"top":case"top-right":case"top-left":s=0}return{horizontalAlign:n,verticalAlign:s}}function $y(i,n,s,l,p){if(!l&&!p)return;const v=i[s],x=(i[s].x+v.metrics.advance*v.scale)*l;for(let S=n;S<=s;S++)i[S].x-=x,i[S].y+=p}function nf(i,n,s){const{horizontalAlign:l,verticalAlign:p}=tf(s),v=n[0]-i.displaySize[0]*l,x=n[1]-i.displaySize[1]*p;return{image:i,top:x,bottom:x+i.displaySize[1],left:v,right:v+i.displaySize[0]}}function Zg(i){var n,s;let l=i.left,p=i.top,v=i.right-l,x=i.bottom-p;const S=(n=i.image.textFitWidth)!==null&&n!==void 0?n:"stretchOrShrink",C=(s=i.image.textFitHeight)!==null&&s!==void 0?s:"stretchOrShrink",P=(i.image.content[2]-i.image.content[0])/(i.image.content[3]-i.image.content[1]);if(C==="proportional"){if(S==="stretchOnly"&&v/x<P||S==="proportional"){const M=Math.ceil(x*P);l*=M/v,v=M}}else if(S==="proportional"&&C==="stretchOnly"&&P!==0&&v/x>P){const M=Math.ceil(v/P);p*=M/x,x=M}return{x1:l,y1:p,x2:l+v,y2:p+x}}function Gg(i,n,s,l,p,v){const x=i.image;let S;if(x.content){const ne=x.content,oe=x.pixelRatio||1;S=[ne[0]/oe,ne[1]/oe,x.displaySize[0]-ne[2]/oe,x.displaySize[1]-ne[3]/oe]}const C=n.left*v,P=n.right*v;let M,R,F,j;s==="width"||s==="both"?(j=p[0]+C-l[3],R=p[0]+P+l[1]):(j=p[0]+(C+P-x.displaySize[0])/2,R=j+x.displaySize[0]);const G=n.top*v,Z=n.bottom*v;return s==="height"||s==="both"?(M=p[1]+G-l[0],F=p[1]+Z+l[2]):(M=p[1]+(G+Z-x.displaySize[1])/2,F=M+x.displaySize[1]),{image:x,top:M,right:R,bottom:F,left:j,collisionPadding:S}}const Uh=255,ta=128,Al=Uh*ta;function Wg(i,n){const{expression:s}=n;if(s.kind==="constant")return{kind:"constant",layoutSize:s.evaluate(new ar(i+1))};if(s.kind==="source")return{kind:"source"};{const{zoomStops:l,interpolationType:p}=s;let v=0;for(;v<l.length&&l[v]<=i;)v++;v=Math.max(0,v-1);let x=v;for(;x<l.length&&l[x]<i+1;)x++;x=Math.min(l.length-1,x);const S=l[v],C=l[x];return s.kind==="composite"?{kind:"composite",minZoom:S,maxZoom:C,interpolationType:p}:{kind:"camera",minZoom:S,maxZoom:C,minSize:s.evaluate(new ar(S)),maxSize:s.evaluate(new ar(C)),interpolationType:p}}}function Up(i,n,s){let l="never";const p=i.get(n);return p?l=p:i.get(s)&&(l="always"),l}const Vy=Fr.VectorTileFeature.types,qy=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function rf(i,n,s,l,p,v,x,S,C,P,M,R,F){const j=S?Math.min(Al,Math.round(S[0])):0,G=S?Math.min(Al,Math.round(S[1])):0;i.emplaceBack(n,s,Math.round(32*l),Math.round(32*p),v,x,(j<<1)+(C?1:0),G,16*P,16*M,256*R,256*F)}function jp(i,n,s){i.emplaceBack(n.x,n.y,s),i.emplaceBack(n.x,n.y,s),i.emplaceBack(n.x,n.y,s),i.emplaceBack(n.x,n.y,s)}function Zy(i){for(const n of i.sections)if(hp(n.text))return!0;return!1}class $p{constructor(n){this.layoutVertexArray=new ac,this.indexArray=new xs,this.programConfigurations=n,this.segments=new gn,this.dynamicLayoutVertexArray=new Da,this.opacityVertexArray=new ys,this.hasVisibleVertices=!1,this.placedSymbolArray=new sr}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(n,s,l,p){this.isEmpty()||(l&&(this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,Cy.members),this.indexBuffer=n.createIndexBuffer(this.indexArray,s),this.dynamicLayoutVertexBuffer=n.createVertexBuffer(this.dynamicLayoutVertexArray,Pg.members,!0),this.opacityVertexBuffer=n.createVertexBuffer(this.opacityVertexArray,qy,!0),this.opacityVertexBuffer.itemSize=1),(l||p)&&this.programConfigurations.upload(n))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}vt("SymbolBuffers",$p);class Vp{constructor(n,s,l){this.layoutVertexArray=new n,this.layoutAttributes=s,this.indexArray=new l,this.segments=new gn,this.collisionVertexArray=new to}upload(n){this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=n.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=n.createVertexBuffer(this.collisionVertexArray,Ag.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}vt("CollisionBuffers",Vp);class vc{constructor(n){this.collisionBoxArray=n.collisionBoxArray,this.zoom=n.zoom,this.overscaling=n.overscaling,this.layers=n.layers,this.layerIds=this.layers.map(x=>x.id),this.index=n.index,this.pixelRatio=n.pixelRatio,this.sourceLayerIndex=n.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Gd([]),this.placementViewportMatrix=Gd([]);const s=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Wg(this.zoom,s["text-size"]),this.iconSizeData=Wg(this.zoom,s["icon-size"]);const l=this.layers[0].layout,p=l.get("symbol-sort-key"),v=l.get("symbol-z-order");this.canOverlap=Up(l,"text-overlap","text-allow-overlap")!=="never"||Up(l,"icon-overlap","icon-allow-overlap")!=="never"||l.get("text-ignore-placement")||l.get("icon-ignore-placement"),this.sortFeaturesByKey=v!=="viewport-y"&&!p.isConstant(),this.sortFeaturesByY=(v==="viewport-y"||v==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,l.get("symbol-placement")==="point"&&(this.writingModes=l.get("text-writing-mode").map(x=>w.ah[x])),this.stateDependentLayerIds=this.layers.filter(x=>x.isStateDependent()).map(x=>x.id),this.sourceID=n.sourceID}createArrays(){this.text=new $p(new _i(this.layers,this.zoom,n=>/^text/.test(n))),this.icon=new $p(new _i(this.layers,this.zoom,n=>/^icon/.test(n))),this.glyphOffsetArray=new Xn,this.lineVertexArray=new Cr,this.symbolInstances=new un,this.textAnchorOffsets=new hn}calculateGlyphDependencies(n,s,l,p,v){for(let x=0;x<n.length;x++)if(s[n.charCodeAt(x)]=!0,(l||p)&&v){const S=Oh[n.charAt(x)];S&&(s[S.charCodeAt(0)]=!0)}}populate(n,s,l){const p=this.layers[0],v=p.layout,x=v.get("text-font"),S=v.get("text-field"),C=v.get("icon-image"),P=(S.value.kind!=="constant"||S.value.value instanceof Wi&&!S.value.value.isEmpty()||S.value.value.toString().length>0)&&(x.value.kind!=="constant"||x.value.value.length>0),M=C.value.kind!=="constant"||!!C.value.value||Object.keys(C.parameters).length>0,R=v.get("symbol-sort-key");if(this.features=[],!P&&!M)return;const F=s.iconDependencies,j=s.glyphDependencies,G=s.availableImages,Z=new ar(this.zoom);for(const{feature:ne,id:oe,index:Pe,sourceLayerIndex:ge}of n){const _e=p._featureFilter.needGeometry,Le=ws(ne,_e);if(!p._featureFilter.filter(Z,Le,l))continue;let Ye,gt;if(_e||(Le.geometry=oi(ne)),P){const _t=p.getValueAndResolveTokens("text-field",Le,l,G),ft=Wi.factory(_t),Pt=this.hasRTLText=this.hasRTLText||Zy(ft);(!Pt||Ji.getRTLTextPluginStatus()==="unavailable"||Pt&&Ji.isParsed())&&(Ye=ky(ft,p,Le))}if(M){const _t=p.getValueAndResolveTokens("icon-image",Le,l,G);gt=_t instanceof Xi?_t:Xi.fromString(_t)}if(!Ye&&!gt)continue;const Ft=this.sortFeaturesByKey?R.evaluate(Le,{},l):void 0;if(this.features.push({id:oe,text:Ye,icon:gt,index:Pe,sourceLayerIndex:ge,geometry:Le.geometry,properties:ne.properties,type:Vy[ne.type],sortKey:Ft}),gt&&(F[gt.name]=!0),Ye){const _t=x.evaluate(Le,{},l).join(","),ft=v.get("text-rotation-alignment")!=="viewport"&&v.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(w.ah.vertical)>=0;for(const Pt of Ye.sections)if(Pt.image)F[Pt.image.name]=!0;else{const xt=H(Ye.toString()),yt=Pt.fontStack||_t,$e=j[yt]=j[yt]||{};this.calculateGlyphDependencies(Pt.text,$e,ft,this.allowVerticalPlacement,xt)}}}v.get("symbol-placement")==="line"&&(this.features=function(ne){const oe={},Pe={},ge=[];let _e=0;function Le(_t){ge.push(ne[_t]),_e++}function Ye(_t,ft,Pt){const xt=Pe[_t];return delete Pe[_t],Pe[ft]=xt,ge[xt].geometry[0].pop(),ge[xt].geometry[0]=ge[xt].geometry[0].concat(Pt[0]),xt}function gt(_t,ft,Pt){const xt=oe[ft];return delete oe[ft],oe[_t]=xt,ge[xt].geometry[0].shift(),ge[xt].geometry[0]=Pt[0].concat(ge[xt].geometry[0]),xt}function Ft(_t,ft,Pt){const xt=Pt?ft[0][ft[0].length-1]:ft[0][0];return`${_t}:${xt.x}:${xt.y}`}for(let _t=0;_t<ne.length;_t++){const ft=ne[_t],Pt=ft.geometry,xt=ft.text?ft.text.toString():null;if(!xt){Le(_t);continue}const yt=Ft(xt,Pt),$e=Ft(xt,Pt,!0);if(yt in Pe&&$e in oe&&Pe[yt]!==oe[$e]){const At=gt(yt,$e,Pt),kt=Ye(yt,$e,ge[At].geometry);delete oe[yt],delete Pe[$e],Pe[Ft(xt,ge[kt].geometry,!0)]=kt,ge[At].geometry=null}else yt in Pe?Ye(yt,$e,Pt):$e in oe?gt(yt,$e,Pt):(Le(_t),oe[yt]=_e-1,Pe[$e]=_e-1)}return ge.filter(_t=>_t.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((ne,oe)=>ne.sortKey-oe.sortKey)}update(n,s,l){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(n,s,this.layers,l),this.icon.programConfigurations.updatePaintArrays(n,s,this.layers,l))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(n){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(n),this.iconCollisionBox.upload(n)),this.text.upload(n,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(n,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(n,s){const l=this.lineVertexArray.length;if(n.segment!==void 0){let p=n.dist(s[n.segment+1]),v=n.dist(s[n.segment]);const x={};for(let S=n.segment+1;S<s.length;S++)x[S]={x:s[S].x,y:s[S].y,tileUnitDistanceFromAnchor:p},S<s.length-1&&(p+=s[S+1].dist(s[S]));for(let S=n.segment||0;S>=0;S--)x[S]={x:s[S].x,y:s[S].y,tileUnitDistanceFromAnchor:v},S>0&&(v+=s[S-1].dist(s[S]));for(let S=0;S<s.length;S++){const C=x[S];this.lineVertexArray.emplaceBack(C.x,C.y,C.tileUnitDistanceFromAnchor)}}return{lineStartIndex:l,lineLength:this.lineVertexArray.length-l}}addSymbols(n,s,l,p,v,x,S,C,P,M,R,F){const j=n.indexArray,G=n.layoutVertexArray,Z=n.segments.prepareSegment(4*s.length,G,j,this.canOverlap?x.sortKey:void 0),ne=this.glyphOffsetArray.length,oe=Z.vertexLength,Pe=this.allowVerticalPlacement&&S===w.ah.vertical?Math.PI/2:0,ge=x.text&&x.text.sections;for(let _e=0;_e<s.length;_e++){const{tl:Le,tr:Ye,bl:gt,br:Ft,tex:_t,pixelOffsetTL:ft,pixelOffsetBR:Pt,minFontScaleX:xt,minFontScaleY:yt,glyphOffset:$e,isSDF:At,sectionIndex:kt}=s[_e],qt=Z.vertexLength,tr=$e[1];rf(G,C.x,C.y,Le.x,tr+Le.y,_t.x,_t.y,l,At,ft.x,ft.y,xt,yt),rf(G,C.x,C.y,Ye.x,tr+Ye.y,_t.x+_t.w,_t.y,l,At,Pt.x,ft.y,xt,yt),rf(G,C.x,C.y,gt.x,tr+gt.y,_t.x,_t.y+_t.h,l,At,ft.x,Pt.y,xt,yt),rf(G,C.x,C.y,Ft.x,tr+Ft.y,_t.x+_t.w,_t.y+_t.h,l,At,Pt.x,Pt.y,xt,yt),jp(n.dynamicLayoutVertexArray,C,Pe),j.emplaceBack(qt,qt+1,qt+2),j.emplaceBack(qt+1,qt+2,qt+3),Z.vertexLength+=4,Z.primitiveLength+=2,this.glyphOffsetArray.emplaceBack($e[0]),_e!==s.length-1&&kt===s[_e+1].sectionIndex||n.programConfigurations.populatePaintArrays(G.length,x,x.index,{},F,ge&&ge[kt])}n.placedSymbolArray.emplaceBack(C.x,C.y,ne,this.glyphOffsetArray.length-ne,oe,P,M,C.segment,l?l[0]:0,l?l[1]:0,p[0],p[1],S,0,!1,0,R)}_addCollisionDebugVertex(n,s,l,p,v,x){return s.emplaceBack(0,0),n.emplaceBack(l.x,l.y,p,v,Math.round(x.x),Math.round(x.y))}addCollisionDebugVertices(n,s,l,p,v,x,S){const C=v.segments.prepareSegment(4,v.layoutVertexArray,v.indexArray),P=C.vertexLength,M=v.layoutVertexArray,R=v.collisionVertexArray,F=S.anchorX,j=S.anchorY;this._addCollisionDebugVertex(M,R,x,F,j,new W(n,s)),this._addCollisionDebugVertex(M,R,x,F,j,new W(l,s)),this._addCollisionDebugVertex(M,R,x,F,j,new W(l,p)),this._addCollisionDebugVertex(M,R,x,F,j,new W(n,p)),C.vertexLength+=4;const G=v.indexArray;G.emplaceBack(P,P+1),G.emplaceBack(P+1,P+2),G.emplaceBack(P+2,P+3),G.emplaceBack(P+3,P),C.primitiveLength+=4}addDebugCollisionBoxes(n,s,l,p){for(let v=n;v<s;v++){const x=this.collisionBoxArray.get(v);this.addCollisionDebugVertices(x.x1,x.y1,x.x2,x.y2,p?this.textCollisionBox:this.iconCollisionBox,x.anchorPoint,l)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new Vp(vs,Dp.members,si),this.iconCollisionBox=new Vp(vs,Dp.members,si);for(let n=0;n<this.symbolInstances.length;n++){const s=this.symbolInstances.get(n);this.addDebugCollisionBoxes(s.textBoxStartIndex,s.textBoxEndIndex,s,!0),this.addDebugCollisionBoxes(s.verticalTextBoxStartIndex,s.verticalTextBoxEndIndex,s,!0),this.addDebugCollisionBoxes(s.iconBoxStartIndex,s.iconBoxEndIndex,s,!1),this.addDebugCollisionBoxes(s.verticalIconBoxStartIndex,s.verticalIconBoxEndIndex,s,!1)}}_deserializeCollisionBoxesForSymbol(n,s,l,p,v,x,S,C,P){const M={};for(let R=s;R<l;R++){const F=n.get(R);M.textBox={x1:F.x1,y1:F.y1,x2:F.x2,y2:F.y2,anchorPointX:F.anchorPointX,anchorPointY:F.anchorPointY},M.textFeatureIndex=F.featureIndex;break}for(let R=p;R<v;R++){const F=n.get(R);M.verticalTextBox={x1:F.x1,y1:F.y1,x2:F.x2,y2:F.y2,anchorPointX:F.anchorPointX,anchorPointY:F.anchorPointY},M.verticalTextFeatureIndex=F.featureIndex;break}for(let R=x;R<S;R++){const F=n.get(R);M.iconBox={x1:F.x1,y1:F.y1,x2:F.x2,y2:F.y2,anchorPointX:F.anchorPointX,anchorPointY:F.anchorPointY},M.iconFeatureIndex=F.featureIndex;break}for(let R=C;R<P;R++){const F=n.get(R);M.verticalIconBox={x1:F.x1,y1:F.y1,x2:F.x2,y2:F.y2,anchorPointX:F.anchorPointX,anchorPointY:F.anchorPointY},M.verticalIconFeatureIndex=F.featureIndex;break}return M}deserializeCollisionBoxes(n){this.collisionArrays=[];for(let s=0;s<this.symbolInstances.length;s++){const l=this.symbolInstances.get(s);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(n,l.textBoxStartIndex,l.textBoxEndIndex,l.verticalTextBoxStartIndex,l.verticalTextBoxEndIndex,l.iconBoxStartIndex,l.iconBoxEndIndex,l.verticalIconBoxStartIndex,l.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(n,s){const l=n.placedSymbolArray.get(s),p=l.vertexStartIndex+4*l.numGlyphs;for(let v=l.vertexStartIndex;v<p;v+=4)n.indexArray.emplaceBack(v,v+1,v+2),n.indexArray.emplaceBack(v+1,v+2,v+3)}getSortedSymbolIndexes(n){if(this.sortedAngle===n&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const s=Math.sin(n),l=Math.cos(n),p=[],v=[],x=[];for(let S=0;S<this.symbolInstances.length;++S){x.push(S);const C=this.symbolInstances.get(S);p.push(0|Math.round(s*C.anchorX+l*C.anchorY)),v.push(C.featureIndex)}return x.sort((S,C)=>p[S]-p[C]||v[C]-v[S]),x}addToSortKeyRanges(n,s){const l=this.sortKeyRanges[this.sortKeyRanges.length-1];l&&l.sortKey===s?l.symbolInstanceEnd=n+1:this.sortKeyRanges.push({sortKey:s,symbolInstanceStart:n,symbolInstanceEnd:n+1})}sortFeatures(n){if(this.sortFeaturesByY&&this.sortedAngle!==n&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(n),this.sortedAngle=n,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const s of this.symbolInstanceIndexes){const l=this.symbolInstances.get(s);this.featureSortOrder.push(l.featureIndex),[l.rightJustifiedTextSymbolIndex,l.centerJustifiedTextSymbolIndex,l.leftJustifiedTextSymbolIndex].forEach((p,v,x)=>{p>=0&&x.indexOf(p)===v&&this.addIndicesForPlacedSymbol(this.text,p)}),l.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,l.verticalPlacedTextSymbolIndex),l.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,l.placedIconSymbolIndex),l.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,l.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let Hg,qp;vt("SymbolBucket",vc,{omit:["layers","collisionBoxArray","features","compareText"]}),vc.MAX_GLYPHS=65535,vc.addDynamicAttributes=jp;var sf={get paint(){return qp=qp||new y({"icon-opacity":new Bt(Ce.paint_symbol["icon-opacity"]),"icon-color":new Bt(Ce.paint_symbol["icon-color"]),"icon-halo-color":new Bt(Ce.paint_symbol["icon-halo-color"]),"icon-halo-width":new Bt(Ce.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Bt(Ce.paint_symbol["icon-halo-blur"]),"icon-translate":new Ct(Ce.paint_symbol["icon-translate"]),"icon-translate-anchor":new Ct(Ce.paint_symbol["icon-translate-anchor"]),"text-opacity":new Bt(Ce.paint_symbol["text-opacity"]),"text-color":new Bt(Ce.paint_symbol["text-color"],{runtimeType:di,getOverride:i=>i.textColor,hasOverride:i=>!!i.textColor}),"text-halo-color":new Bt(Ce.paint_symbol["text-halo-color"]),"text-halo-width":new Bt(Ce.paint_symbol["text-halo-width"]),"text-halo-blur":new Bt(Ce.paint_symbol["text-halo-blur"]),"text-translate":new Ct(Ce.paint_symbol["text-translate"]),"text-translate-anchor":new Ct(Ce.paint_symbol["text-translate-anchor"])})},get layout(){return Hg=Hg||new y({"symbol-placement":new Ct(Ce.layout_symbol["symbol-placement"]),"symbol-spacing":new Ct(Ce.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Ct(Ce.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Bt(Ce.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Ct(Ce.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Ct(Ce.layout_symbol["icon-allow-overlap"]),"icon-overlap":new Ct(Ce.layout_symbol["icon-overlap"]),"icon-ignore-placement":new Ct(Ce.layout_symbol["icon-ignore-placement"]),"icon-optional":new Ct(Ce.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Ct(Ce.layout_symbol["icon-rotation-alignment"]),"icon-size":new Bt(Ce.layout_symbol["icon-size"]),"icon-text-fit":new Ct(Ce.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Ct(Ce.layout_symbol["icon-text-fit-padding"]),"icon-image":new Bt(Ce.layout_symbol["icon-image"]),"icon-rotate":new Bt(Ce.layout_symbol["icon-rotate"]),"icon-padding":new Bt(Ce.layout_symbol["icon-padding"]),"icon-keep-upright":new Ct(Ce.layout_symbol["icon-keep-upright"]),"icon-offset":new Bt(Ce.layout_symbol["icon-offset"]),"icon-anchor":new Bt(Ce.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Ct(Ce.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Ct(Ce.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Ct(Ce.layout_symbol["text-rotation-alignment"]),"text-field":new Bt(Ce.layout_symbol["text-field"]),"text-font":new Bt(Ce.layout_symbol["text-font"]),"text-size":new Bt(Ce.layout_symbol["text-size"]),"text-max-width":new Bt(Ce.layout_symbol["text-max-width"]),"text-line-height":new Ct(Ce.layout_symbol["text-line-height"]),"text-letter-spacing":new Bt(Ce.layout_symbol["text-letter-spacing"]),"text-justify":new Bt(Ce.layout_symbol["text-justify"]),"text-radial-offset":new Bt(Ce.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Ct(Ce.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new Bt(Ce.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new Bt(Ce.layout_symbol["text-anchor"]),"text-max-angle":new Ct(Ce.layout_symbol["text-max-angle"]),"text-writing-mode":new Ct(Ce.layout_symbol["text-writing-mode"]),"text-rotate":new Bt(Ce.layout_symbol["text-rotate"]),"text-padding":new Ct(Ce.layout_symbol["text-padding"]),"text-keep-upright":new Ct(Ce.layout_symbol["text-keep-upright"]),"text-transform":new Bt(Ce.layout_symbol["text-transform"]),"text-offset":new Bt(Ce.layout_symbol["text-offset"]),"text-allow-overlap":new Ct(Ce.layout_symbol["text-allow-overlap"]),"text-overlap":new Ct(Ce.layout_symbol["text-overlap"]),"text-ignore-placement":new Ct(Ce.layout_symbol["text-ignore-placement"]),"text-optional":new Ct(Ce.layout_symbol["text-optional"])})}};class Xg{constructor(n){if(n.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=n.property.overrides?n.property.overrides.runtimeType:Pr,this.defaultValue=n}evaluate(n){if(n.formattedSection){const s=this.defaultValue.property.overrides;if(s&&s.hasOverride(n.formattedSection))return s.getOverride(n.formattedSection)}return n.feature&&n.featureState?this.defaultValue.evaluate(n.feature,n.featureState):this.defaultValue.property.specification.default}eachChild(n){this.defaultValue.isConstant()||n(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}vt("FormatSectionOverride",Xg,{omit:["defaultValue"]});class of extends a{constructor(n){super(n,sf)}recalculate(n,s){if(super.recalculate(n,s),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const l=this.layout.get("text-writing-mode");if(l){const p=[];for(const v of l)p.indexOf(v)<0&&p.push(v);this.layout._values["text-writing-mode"]=p}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(n,s,l,p){const v=this.layout.get(n).evaluate(s,{},l,p),x=this._unevaluatedLayout._values[n];return x.isDataDriven()||Tt(x.value)||!v?v:function(S,C){return C.replace(/{([^{}]+)}/g,(P,M)=>S&&M in S?String(S[M]):"")}(s.properties,v)}createBucket(n){return new vc(n)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const n of sf.paint.overridableProperties){if(!of.hasPaintOverride(this.layout,n))continue;const s=this.paint.get(n),l=new Xg(s),p=new Oe(l,s.property.specification);let v=null;v=s.value.kind==="constant"||s.value.kind==="source"?new Tn("source",p):new gr("composite",p,s.value.zoomStops),this.paint._values[n]=new Qr(s.property,v,s.parameters)}}_handleOverridablePaintPropertyUpdate(n,s,l){return!(!this.layout||s.isDataDriven()||l.isDataDriven())&&of.hasPaintOverride(this.layout,n)}static hasPaintOverride(n,s){const l=n.get("text-field"),p=sf.paint.properties[s];let v=!1;const x=S=>{for(const C of S)if(p.overrides&&p.overrides.hasOverride(C))return void(v=!0)};if(l.value.kind==="constant"&&l.value.value instanceof Wi)x(l.value.value.sections);else if(l.value.kind==="source"){const S=P=>{v||(P instanceof ls&&Or(P.value)===co?x(P.value.sections):P instanceof qu?x(P.sections):P.eachChild(S))},C=l.value;C._styleExpression&&S(C._styleExpression.expression)}return v}}let Kg;var Gy={get paint(){return Kg=Kg||new y({"background-color":new Ct(Ce.paint_background["background-color"]),"background-pattern":new oc(Ce.paint_background["background-pattern"]),"background-opacity":new Ct(Ce.paint_background["background-opacity"])})}};class af extends a{constructor(n){super(n,Gy)}}let Yg;var Wy={get paint(){return Yg=Yg||new y({"raster-opacity":new Ct(Ce.paint_raster["raster-opacity"]),"raster-hue-rotate":new Ct(Ce.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Ct(Ce.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Ct(Ce.paint_raster["raster-brightness-max"]),"raster-saturation":new Ct(Ce.paint_raster["raster-saturation"]),"raster-contrast":new Ct(Ce.paint_raster["raster-contrast"]),"raster-resampling":new Ct(Ce.paint_raster["raster-resampling"]),"raster-fade-duration":new Ct(Ce.paint_raster["raster-fade-duration"])})}};class Hy extends a{constructor(n){super(n,Wy)}}class Xy extends a{constructor(n){super(n,{}),this.onAdd=s=>{this.implementation.onAdd&&this.implementation.onAdd(s,s.painter.context.gl)},this.onRemove=s=>{this.implementation.onRemove&&this.implementation.onRemove(s,s.painter.context.gl)},this.implementation=n}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class Ky{constructor(n){this._methodToThrottle=n,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._methodToThrottle()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._methodToThrottle()},0))}remove(){delete this._channel,this._methodToThrottle=()=>{}}}const Zp=63710088e-1;class Ml{constructor(n,s){if(isNaN(n)||isNaN(s))throw new Error(`Invalid LngLat object: (${n}, ${s})`);if(this.lng=+n,this.lat=+s,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new Ml(je(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(n){const s=Math.PI/180,l=this.lat*s,p=n.lat*s,v=Math.sin(l)*Math.sin(p)+Math.cos(l)*Math.cos(p)*Math.cos((n.lng-this.lng)*s);return Zp*Math.acos(Math.min(v,1))}static convert(n){if(n instanceof Ml)return n;if(Array.isArray(n)&&(n.length===2||n.length===3))return new Ml(Number(n[0]),Number(n[1]));if(!Array.isArray(n)&&typeof n=="object"&&n!==null)return new Ml(Number("lng"in n?n.lng:n.lon),Number(n.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const Jg=2*Math.PI*Zp;function Qg(i){return Jg*Math.cos(i*Math.PI/180)}function e_(i){return(180+i)/360}function t_(i){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+i*Math.PI/360)))/360}function jh(i,n){return i/Qg(n)}function Gp(i){return 360/Math.PI*Math.atan(Math.exp((180-360*i)*Math.PI/180))-90}class xc{constructor(n,s,l=0){this.x=+n,this.y=+s,this.z=+l}static fromLngLat(n,s=0){const l=Ml.convert(n);return new xc(e_(l.lng),t_(l.lat),jh(s,l.lat))}toLngLat(){return new Ml(360*this.x-180,Gp(this.y))}toAltitude(){return this.z*Qg(Gp(this.y))}meterInMercatorCoordinateUnits(){return 1/Jg*(n=Gp(this.y),1/Math.cos(n*Math.PI/180));var n}}function Wp(i,n,s){var l=2*Math.PI*6378137/256/Math.pow(2,s);return[i*l-2*Math.PI*6378137/2,n*l-2*Math.PI*6378137/2]}class $h{constructor(n,s,l){if(!function(p,v,x){return!(p<0||p>25||x<0||x>=Math.pow(2,p)||v<0||v>=Math.pow(2,p))}(n,s,l))throw new Error(`x=${s}, y=${l}, z=${n} outside of bounds. 0<=x<${Math.pow(2,n)}, 0<=y<${Math.pow(2,n)} 0<=z<=25 `);this.z=n,this.x=s,this.y=l,this.key=wc(0,n,n,s,l)}equals(n){return this.z===n.z&&this.x===n.x&&this.y===n.y}url(n,s,l){const p=(x=this.y,S=this.z,C=Wp(256*(v=this.x),256*(x=Math.pow(2,S)-x-1),S),P=Wp(256*(v+1),256*(x+1),S),C[0]+","+C[1]+","+P[0]+","+P[1]);var v,x,S,C,P;const M=function(R,F,j){let G,Z="";for(let ne=R;ne>0;ne--)G=1<<ne-1,Z+=(F&G?1:0)+(j&G?2:0);return Z}(this.z,this.x,this.y);return n[(this.x+this.y)%n.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(l==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,s>1?"@2x":"").replace(/{quadkey}/g,M).replace(/{bbox-epsg-3857}/g,p)}isChildOf(n){const s=this.z-n.z;return s>0&&n.x===this.x>>s&&n.y===this.y>>s}getTilePoint(n){const s=Math.pow(2,this.z);return new W((n.x*s-this.x)*Ir,(n.y*s-this.y)*Ir)}toString(){return`${this.z}/${this.x}/${this.y}`}}class Hp{constructor(n,s){this.wrap=n,this.canonical=s,this.key=wc(n,s.z,s.z,s.x,s.y)}}class Ts{constructor(n,s,l,p,v){if(n<l)throw new Error(`overscaledZ should be >= z; overscaledZ = ${n}; z = ${l}`);this.overscaledZ=n,this.wrap=s,this.canonical=new $h(l,+p,+v),this.key=wc(s,n,l,p,v)}clone(){return new Ts(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(n){return this.overscaledZ===n.overscaledZ&&this.wrap===n.wrap&&this.canonical.equals(n.canonical)}scaledTo(n){if(n>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${n}; overscaledZ = ${this.overscaledZ}`);const s=this.canonical.z-n;return n>this.canonical.z?new Ts(n,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Ts(n,this.wrap,n,this.canonical.x>>s,this.canonical.y>>s)}calculateScaledKey(n,s){if(n>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${n}; overscaledZ = ${this.overscaledZ}`);const l=this.canonical.z-n;return n>this.canonical.z?wc(this.wrap*+s,n,this.canonical.z,this.canonical.x,this.canonical.y):wc(this.wrap*+s,n,n,this.canonical.x>>l,this.canonical.y>>l)}isChildOf(n){if(n.wrap!==this.wrap)return!1;const s=this.canonical.z-n.canonical.z;return n.overscaledZ===0||n.overscaledZ<this.overscaledZ&&n.canonical.x===this.canonical.x>>s&&n.canonical.y===this.canonical.y>>s}children(n){if(this.overscaledZ>=n)return[new Ts(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const s=this.canonical.z+1,l=2*this.canonical.x,p=2*this.canonical.y;return[new Ts(s,this.wrap,s,l,p),new Ts(s,this.wrap,s,l+1,p),new Ts(s,this.wrap,s,l,p+1),new Ts(s,this.wrap,s,l+1,p+1)]}isLessThan(n){return this.wrap<n.wrap||!(this.wrap>n.wrap)&&(this.overscaledZ<n.overscaledZ||!(this.overscaledZ>n.overscaledZ)&&(this.canonical.x<n.canonical.x||!(this.canonical.x>n.canonical.x)&&this.canonical.y<n.canonical.y))}wrapped(){return new Ts(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(n){return new Ts(this.overscaledZ,n,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new Hp(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(n){return this.canonical.getTilePoint(new xc(n.x-this.wrap,n.y))}}function wc(i,n,s,l,p){(i*=2)<0&&(i=-1*i-1);const v=1<<s;return(v*v*i+v*p+l).toString(36)+s.toString(36)+n.toString(36)}vt("CanonicalTileID",$h),vt("OverscaledTileID",Ts,{omit:["posMatrix"]});class Xp{constructor(n,s,l,p=1,v=1,x=1,S=0){if(this.uid=n,s.height!==s.width)throw new RangeError("DEM tiles must be square");if(l&&!["mapbox","terrarium","custom"].includes(l))return void mt(`"${l}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);this.stride=s.height;const C=this.dim=s.height-2;switch(this.data=new Uint32Array(s.data.buffer),l){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=p,this.greenFactor=v,this.blueFactor=x,this.baseShift=S;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let P=0;P<C;P++)this.data[this._idx(-1,P)]=this.data[this._idx(0,P)],this.data[this._idx(C,P)]=this.data[this._idx(C-1,P)],this.data[this._idx(P,-1)]=this.data[this._idx(P,0)],this.data[this._idx(P,C)]=this.data[this._idx(P,C-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(C,-1)]=this.data[this._idx(C-1,0)],this.data[this._idx(-1,C)]=this.data[this._idx(0,C-1)],this.data[this._idx(C,C)]=this.data[this._idx(C-1,C-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let P=0;P<C;P++)for(let M=0;M<C;M++){const R=this.get(P,M);R>this.max&&(this.max=R),R<this.min&&(this.min=R)}}get(n,s){const l=new Uint8Array(this.data.buffer),p=4*this._idx(n,s);return this.unpack(l[p],l[p+1],l[p+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(n,s){if(n<-1||n>=this.dim+1||s<-1||s>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(s+1)*this.stride+(n+1)}unpack(n,s,l){return n*this.redFactor+s*this.greenFactor+l*this.blueFactor-this.baseShift}getPixels(){return new Ss({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(n,s,l){if(this.dim!==n.dim)throw new Error("dem dimension mismatch");let p=s*this.dim,v=s*this.dim+this.dim,x=l*this.dim,S=l*this.dim+this.dim;switch(s){case-1:p=v-1;break;case 1:v=p+1}switch(l){case-1:x=S-1;break;case 1:S=x+1}const C=-s*this.dim,P=-l*this.dim;for(let M=x;M<S;M++)for(let R=p;R<v;R++)this.data[this._idx(R,M)]=n.data[this._idx(R+C,M+P)]}}vt("DEMData",Xp);class n_{constructor(n){this._stringToNumber={},this._numberToString=[];for(let s=0;s<n.length;s++){const l=n[s];this._stringToNumber[l]=s,this._numberToString[s]=l}}encode(n){return this._stringToNumber[n]}decode(n){if(n>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${n} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[n]}}class r_{constructor(n,s,l,p,v){this.type="Feature",this._vectorTileFeature=n,n._z=s,n._x=l,n._y=p,this.properties=n.properties,this.id=v}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(n){this._geometry=n}toJSON(){const n={geometry:this.geometry};for(const s in this)s!=="_geometry"&&s!=="_vectorTileFeature"&&(n[s]=this[s]);return n}}class i_{constructor(n,s){this.tileID=n,this.x=n.canonical.x,this.y=n.canonical.y,this.z=n.canonical.z,this.grid=new xo(Ir,16,0),this.grid3D=new xo(Ir,16,0),this.featureIndexArray=new Ii,this.promoteId=s}insert(n,s,l,p,v,x){const S=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(l,p,v);const C=x?this.grid3D:this.grid;for(let P=0;P<s.length;P++){const M=s[P],R=[1/0,1/0,-1/0,-1/0];for(let F=0;F<M.length;F++){const j=M[F];R[0]=Math.min(R[0],j.x),R[1]=Math.min(R[1],j.y),R[2]=Math.max(R[2],j.x),R[3]=Math.max(R[3],j.y)}R[0]<Ir&&R[1]<Ir&&R[2]>=0&&R[3]>=0&&C.insert(S,R[0],R[1],R[2],R[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new Fr.VectorTile(new Op(this.rawTileData)).layers,this.sourceLayerCoder=new n_(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(n,s,l,p){this.loadVTLayers();const v=n.params||{},x=Ir/n.tileSize/n.scale,S=ph(v.filter),C=n.queryGeometry,P=n.queryPadding*x,M=qh(C),R=this.grid.query(M.minX-P,M.minY-P,M.maxX+P,M.maxY+P),F=qh(n.cameraQueryGeometry),j=this.grid3D.query(F.minX-P,F.minY-P,F.maxX+P,F.maxY+P,(ne,oe,Pe,ge)=>function(_e,Le,Ye,gt,Ft){for(const ft of _e)if(Le<=ft.x&&Ye<=ft.y&&gt>=ft.x&&Ft>=ft.y)return!0;const _t=[new W(Le,Ye),new W(Le,Ft),new W(gt,Ft),new W(gt,Ye)];if(_e.length>2){for(const ft of _t)if(ou(_e,ft))return!0}for(let ft=0;ft<_e.length-1;ft++)if(ag(_e[ft],_e[ft+1],_t))return!0;return!1}(n.cameraQueryGeometry,ne-P,oe-P,Pe+P,ge+P));for(const ne of j)R.push(ne);R.sort(Yy);const G={};let Z;for(let ne=0;ne<R.length;ne++){const oe=R[ne];if(oe===Z)continue;Z=oe;const Pe=this.featureIndexArray.get(oe);let ge=null;this.loadMatchingFeature(G,Pe.bucketIndex,Pe.sourceLayerIndex,Pe.featureIndex,S,v.layers,v.availableImages,s,l,p,(_e,Le,Ye)=>(ge||(ge=oi(_e)),Le.queryIntersectsFeature(C,_e,Ye,ge,this.z,n.transform,x,n.pixelPosMatrix)))}return G}loadMatchingFeature(n,s,l,p,v,x,S,C,P,M,R){const F=this.bucketLayerIDs[s];if(x&&!function(ne,oe){for(let Pe=0;Pe<ne.length;Pe++)if(oe.indexOf(ne[Pe])>=0)return!0;return!1}(x,F))return;const j=this.sourceLayerCoder.decode(l),G=this.vtLayers[j].feature(p);if(v.needGeometry){const ne=ws(G,!0);if(!v.filter(new ar(this.tileID.overscaledZ),ne,this.tileID.canonical))return}else if(!v.filter(new ar(this.tileID.overscaledZ),G))return;const Z=this.getId(G,j);for(let ne=0;ne<F.length;ne++){const oe=F[ne];if(x&&x.indexOf(oe)<0)continue;const Pe=C[oe];if(!Pe)continue;let ge={};Z&&M&&(ge=M.getState(Pe.sourceLayer||"_geojsonTileLayer",Z));const _e=ve({},P[oe]);_e.paint=Vh(_e.paint,Pe.paint,G,ge,S),_e.layout=Vh(_e.layout,Pe.layout,G,ge,S);const Le=!R||R(G,Pe,ge);if(!Le)continue;const Ye=new r_(G,this.z,this.x,this.y,Z);Ye.layer=_e;let gt=n[oe];gt===void 0&&(gt=n[oe]=[]),gt.push({featureIndex:p,feature:Ye,intersectionZ:Le})}}lookupSymbolFeatures(n,s,l,p,v,x,S,C){const P={};this.loadVTLayers();const M=ph(v);for(const R of n)this.loadMatchingFeature(P,l,p,R,M,x,S,C,s);return P}hasLayer(n){for(const s of this.bucketLayerIDs)for(const l of s)if(n===l)return!0;return!1}getId(n,s){let l=n.id;return this.promoteId&&(l=n.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[s]],typeof l=="boolean"&&(l=Number(l))),l}}function Vh(i,n,s,l,p){return de(i,(v,x)=>{const S=n instanceof ru?n.get(x):null;return S&&S.evaluate?S.evaluate(s,l,p):S})}function qh(i){let n=1/0,s=1/0,l=-1/0,p=-1/0;for(const v of i)n=Math.min(n,v.x),s=Math.min(s,v.y),l=Math.max(l,v.x),p=Math.max(p,v.y);return{minX:n,minY:s,maxX:l,maxY:p}}function Yy(i,n){return n-i}function s_(i,n,s,l,p){const v=[];for(let x=0;x<i.length;x++){const S=i[x];let C;for(let P=0;P<S.length-1;P++){let M=S[P],R=S[P+1];M.x<n&&R.x<n||(M.x<n?M=new W(n,M.y+(n-M.x)/(R.x-M.x)*(R.y-M.y))._round():R.x<n&&(R=new W(n,M.y+(n-M.x)/(R.x-M.x)*(R.y-M.y))._round()),M.y<s&&R.y<s||(M.y<s?M=new W(M.x+(s-M.y)/(R.y-M.y)*(R.x-M.x),s)._round():R.y<s&&(R=new W(M.x+(s-M.y)/(R.y-M.y)*(R.x-M.x),s)._round()),M.x>=l&&R.x>=l||(M.x>=l?M=new W(l,M.y+(l-M.x)/(R.x-M.x)*(R.y-M.y))._round():R.x>=l&&(R=new W(l,M.y+(l-M.x)/(R.x-M.x)*(R.y-M.y))._round()),M.y>=p&&R.y>=p||(M.y>=p?M=new W(M.x+(p-M.y)/(R.y-M.y)*(R.x-M.x),p)._round():R.y>=p&&(R=new W(M.x+(p-M.y)/(R.y-M.y)*(R.x-M.x),p)._round()),C&&M.equals(C[C.length-1])||(C=[M],v.push(C)),C.push(R)))))}}return v}vt("FeatureIndex",i_,{omit:["rawTileData","sourceLayerCoder"]});class na extends W{constructor(n,s,l,p){super(n,s),this.angle=l,p!==void 0&&(this.segment=p)}clone(){return new na(this.x,this.y,this.angle,this.segment)}}function Kp(i,n,s,l,p){if(n.segment===void 0||s===0)return!0;let v=n,x=n.segment+1,S=0;for(;S>-s/2;){if(x--,x<0)return!1;S-=i[x].dist(v),v=i[x]}S+=i[x].dist(i[x+1]),x++;const C=[];let P=0;for(;S<s/2;){const M=i[x],R=i[x+1];if(!R)return!1;let F=i[x-1].angleTo(M)-M.angleTo(R);for(F=Math.abs((F+3*Math.PI)%(2*Math.PI)-Math.PI),C.push({distance:S,angleDelta:F}),P+=F;S-C[0].distance>l;)P-=C.shift().angleDelta;if(P>p)return!1;x++,S+=M.dist(R)}return!0}function o_(i){let n=0;for(let s=0;s<i.length-1;s++)n+=i[s].dist(i[s+1]);return n}function a_(i,n,s){return i?.6*n*s:0}function l_(i,n){return Math.max(i?i.right-i.left:0,n?n.right-n.left:0)}function Jy(i,n,s,l,p,v){const x=a_(s,p,v),S=l_(s,l)*v;let C=0;const P=o_(i)/2;for(let M=0;M<i.length-1;M++){const R=i[M],F=i[M+1],j=R.dist(F);if(C+j>P){const G=(P-C)/j,Z=Oi.number(R.x,F.x,G),ne=Oi.number(R.y,F.y,G),oe=new na(Z,ne,F.angleTo(R),M);return oe._round(),!x||Kp(i,oe,S,x,n)?oe:void 0}C+=j}}function Qy(i,n,s,l,p,v,x,S,C){const P=a_(l,v,x),M=l_(l,p),R=M*x,F=i[0].x===0||i[0].x===C||i[0].y===0||i[0].y===C;return n-R<n/4&&(n=R+n/4),u_(i,F?n/2*S%n:(M/2+2*v)*x*S%n,n,P,s,R,F,!1,C)}function u_(i,n,s,l,p,v,x,S,C){const P=v/2,M=o_(i);let R=0,F=n-s,j=[];for(let G=0;G<i.length-1;G++){const Z=i[G],ne=i[G+1],oe=Z.dist(ne),Pe=ne.angleTo(Z);for(;F+s<R+oe;){F+=s;const ge=(F-R)/oe,_e=Oi.number(Z.x,ne.x,ge),Le=Oi.number(Z.y,ne.y,ge);if(_e>=0&&_e<C&&Le>=0&&Le<C&&F-P>=0&&F+P<=M){const Ye=new na(_e,Le,Pe,G);Ye._round(),l&&!Kp(i,Ye,v,l,p)||j.push(Ye)}}R+=oe}return S||j.length||x||(j=u_(i,R/2,s,l,p,v,x,!0,C)),j}vt("Anchor",na);const bc=ts;function c_(i,n,s,l){const p=[],v=i.image,x=v.pixelRatio,S=v.paddedRect.w-2*bc,C=v.paddedRect.h-2*bc;let P={x1:i.left,y1:i.top,x2:i.right,y2:i.bottom};const M=v.stretchX||[[0,S]],R=v.stretchY||[[0,C]],F=($e,At)=>$e+At[1]-At[0],j=M.reduce(F,0),G=R.reduce(F,0),Z=S-j,ne=C-G;let oe=0,Pe=j,ge=0,_e=G,Le=0,Ye=Z,gt=0,Ft=ne;if(v.content&&l){const $e=v.content,At=$e[2]-$e[0],kt=$e[3]-$e[1];(v.textFitWidth||v.textFitHeight)&&(P=Zg(i)),oe=lf(M,0,$e[0]),ge=lf(R,0,$e[1]),Pe=lf(M,$e[0],$e[2]),_e=lf(R,$e[1],$e[3]),Le=$e[0]-oe,gt=$e[1]-ge,Ye=At-Pe,Ft=kt-_e}const _t=P.x1,ft=P.y1,Pt=P.x2-_t,xt=P.y2-ft,yt=($e,At,kt,qt)=>{const tr=uf($e.stretch-oe,Pe,Pt,_t),Yn=cf($e.fixed-Le,Ye,$e.stretch,j),ei=uf(At.stretch-ge,_e,xt,ft),Cs=cf(At.fixed-gt,Ft,At.stretch,G),xi=uf(kt.stretch-oe,Pe,Pt,_t),Nr=cf(kt.fixed-Le,Ye,kt.stretch,j),Ui=uf(qt.stretch-ge,_e,xt,ft),ji=cf(qt.fixed-gt,Ft,qt.stretch,G),$i=new W(tr,ei),yn=new W(xi,ei),$n=new W(xi,Ui),Pi=new W(tr,Ui),wi=new W(Yn/x,Cs/x),Vi=new W(Nr/x,ji/x),ai=n*Math.PI/180;if(ai){const zn=Math.sin(ai),nr=Math.cos(ai),lr=[nr,-zn,zn,nr];$i._matMult(lr),yn._matMult(lr),Pi._matMult(lr),$n._matMult(lr)}const js=$e.stretch+$e.fixed,ns=At.stretch+At.fixed;return{tl:$i,tr:yn,bl:Pi,br:$n,tex:{x:v.paddedRect.x+bc+js,y:v.paddedRect.y+bc+ns,w:kt.stretch+kt.fixed-js,h:qt.stretch+qt.fixed-ns},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:wi,pixelOffsetBR:Vi,minFontScaleX:Ye/x/Pt,minFontScaleY:Ft/x/xt,isSDF:s}};if(l&&(v.stretchX||v.stretchY)){const $e=h_(M,Z,j),At=h_(R,ne,G);for(let kt=0;kt<$e.length-1;kt++){const qt=$e[kt],tr=$e[kt+1];for(let Yn=0;Yn<At.length-1;Yn++)p.push(yt(qt,At[Yn],tr,At[Yn+1]))}}else p.push(yt({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:S+1},{fixed:0,stretch:C+1}));return p}function lf(i,n,s){let l=0;for(const p of i)l+=Math.max(n,Math.min(s,p[1]))-Math.max(n,Math.min(s,p[0]));return l}function h_(i,n,s){const l=[{fixed:-bc,stretch:0}];for(const[p,v]of i){const x=l[l.length-1];l.push({fixed:p-x.stretch,stretch:x.stretch}),l.push({fixed:p-x.stretch,stretch:x.stretch+(v-p)})}return l.push({fixed:n+bc,stretch:s}),l}function uf(i,n,s,l){return i/n*s+l}function cf(i,n,s,l){return i-n*s/l}class Es{constructor(n,s,l,p,v,x,S,C,P,M){var R;if(this.boxStartIndex=n.length,P){let F=x.top,j=x.bottom;const G=x.collisionPadding;G&&(F-=G[1],j+=G[3]);let Z=j-F;Z>0&&(Z=Math.max(10,Z),this.circleDiameter=Z)}else{const F=!((R=x.image)===null||R===void 0)&&R.content&&(x.image.textFitWidth||x.image.textFitHeight)?Zg(x):{x1:x.left,y1:x.top,x2:x.right,y2:x.bottom};F.y1=F.y1*S-C[0],F.y2=F.y2*S+C[2],F.x1=F.x1*S-C[3],F.x2=F.x2*S+C[1];const j=x.collisionPadding;if(j&&(F.x1-=j[0]*S,F.y1-=j[1]*S,F.x2+=j[2]*S,F.y2+=j[3]*S),M){const G=new W(F.x1,F.y1),Z=new W(F.x2,F.y1),ne=new W(F.x1,F.y2),oe=new W(F.x2,F.y2),Pe=M*Math.PI/180;G._rotate(Pe),Z._rotate(Pe),ne._rotate(Pe),oe._rotate(Pe),F.x1=Math.min(G.x,Z.x,ne.x,oe.x),F.x2=Math.max(G.x,Z.x,ne.x,oe.x),F.y1=Math.min(G.y,Z.y,ne.y,oe.y),F.y2=Math.max(G.y,Z.y,ne.y,oe.y)}n.emplaceBack(s.x,s.y,F.x1,F.y1,F.x2,F.y2,l,p,v)}this.boxEndIndex=n.length}}class e1{constructor(n=[],s=(l,p)=>l<p?-1:l>p?1:0){if(this.data=n,this.length=this.data.length,this.compare=s,this.length>0)for(let l=(this.length>>1)-1;l>=0;l--)this._down(l)}push(n){this.data.push(n),this._up(this.length++)}pop(){if(this.length===0)return;const n=this.data[0],s=this.data.pop();return--this.length>0&&(this.data[0]=s,this._down(0)),n}peek(){return this.data[0]}_up(n){const{data:s,compare:l}=this,p=s[n];for(;n>0;){const v=n-1>>1,x=s[v];if(l(p,x)>=0)break;s[n]=x,n=v}s[n]=p}_down(n){const{data:s,compare:l}=this,p=this.length>>1,v=s[n];for(;n<p;){let x=1+(n<<1);const S=x+1;if(S<this.length&&l(s[S],s[x])<0&&(x=S),l(s[x],v)>=0)break;s[n]=s[x],n=x}s[n]=v}}function t1(i,n=1,s=!1){let l=1/0,p=1/0,v=-1/0,x=-1/0;const S=i[0];for(let j=0;j<S.length;j++){const G=S[j];(!j||G.x<l)&&(l=G.x),(!j||G.y<p)&&(p=G.y),(!j||G.x>v)&&(v=G.x),(!j||G.y>x)&&(x=G.y)}const C=Math.min(v-l,x-p);let P=C/2;const M=new e1([],yu);if(C===0)return new W(l,p);for(let j=l;j<v;j+=C)for(let G=p;G<x;G+=C)M.push(new en(j+P,G+P,P,i));let R=function(j){let G=0,Z=0,ne=0;const oe=j[0];for(let Pe=0,ge=oe.length,_e=ge-1;Pe<ge;_e=Pe++){const Le=oe[Pe],Ye=oe[_e],gt=Le.x*Ye.y-Ye.x*Le.y;Z+=(Le.x+Ye.x)*gt,ne+=(Le.y+Ye.y)*gt,G+=3*gt}return new en(Z/G,ne/G,0,j)}(i),F=M.length;for(;M.length;){const j=M.pop();(j.d>R.d||!R.d)&&(R=j,s&&console.log("found best %d after %d probes",Math.round(1e4*j.d)/1e4,F)),j.max-R.d<=n||(P=j.h/2,M.push(new en(j.p.x-P,j.p.y-P,P,i)),M.push(new en(j.p.x+P,j.p.y-P,P,i)),M.push(new en(j.p.x-P,j.p.y+P,P,i)),M.push(new en(j.p.x+P,j.p.y+P,P,i)),F+=4)}return s&&(console.log(`num probes: ${F}`),console.log(`best distance: ${R.d}`)),R.p}function yu(i,n){return n.max-i.max}function en(i,n,s,l){this.p=new W(i,n),this.h=s,this.d=function(p,v){let x=!1,S=1/0;for(let C=0;C<v.length;C++){const P=v[C];for(let M=0,R=P.length,F=R-1;M<R;F=M++){const j=P[M],G=P[F];j.y>p.y!=G.y>p.y&&p.x<(G.x-j.x)*(p.y-j.y)/(G.y-j.y)+j.x&&(x=!x),S=Math.min(S,og(p,j,G))}}return(x?1:-1)*Math.sqrt(S)}(this.p,l),this.max=this.d+this.h*Math.SQRT2}var vi;w.aq=void 0,(vi=w.aq||(w.aq={}))[vi.center=1]="center",vi[vi.left=2]="left",vi[vi.right=3]="right",vi[vi.top=4]="top",vi[vi.bottom=5]="bottom",vi[vi["top-left"]=6]="top-left",vi[vi["top-right"]=7]="top-right",vi[vi["bottom-left"]=8]="bottom-left",vi[vi["bottom-right"]=9]="bottom-right";const Vr=7,Mr=Number.POSITIVE_INFINITY;function d_(i,n){return n[1]!==Mr?function(s,l,p){let v=0,x=0;switch(l=Math.abs(l),p=Math.abs(p),s){case"top-right":case"top-left":case"top":x=p-Vr;break;case"bottom-right":case"bottom-left":case"bottom":x=-p+Vr}switch(s){case"top-right":case"bottom-right":case"right":v=-l;break;case"top-left":case"bottom-left":case"left":v=l}return[v,x]}(i,n[0],n[1]):function(s,l){let p=0,v=0;l<0&&(l=0);const x=l/Math.SQRT2;switch(s){case"top-right":case"top-left":v=x-Vr;break;case"bottom-right":case"bottom-left":v=-x+Vr;break;case"bottom":v=-l+Vr;break;case"top":v=l-Vr}switch(s){case"top-right":case"bottom-right":p=-x;break;case"top-left":case"bottom-left":p=x;break;case"left":p=l;break;case"right":p=-l}return[p,v]}(i,n[0])}function ja(i,n,s){var l;const p=i.layout,v=(l=p.get("text-variable-anchor-offset"))===null||l===void 0?void 0:l.evaluate(n,{},s);if(v){const S=v.values,C=[];for(let P=0;P<S.length;P+=2){const M=C[P]=S[P],R=S[P+1].map(F=>F*Br);M.startsWith("top")?R[1]-=Vr:M.startsWith("bottom")&&(R[1]+=Vr),C[P+1]=R}return new Hi(C)}const x=p.get("text-variable-anchor");if(x){let S;S=i._unevaluatedLayout.getValue("text-radial-offset")!==void 0?[p.get("text-radial-offset").evaluate(n,{},s)*Br,Mr]:p.get("text-offset").evaluate(n,{},s).map(P=>P*Br);const C=[];for(const P of x)C.push(P,d_(P,S));return new Hi(C)}return null}function Yp(i){switch(i){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function n1(i,n,s,l,p,v,x,S,C,P,M){let R=v.textMaxSize.evaluate(n,{});R===void 0&&(R=x);const F=i.layers[0].layout,j=F.get("icon-offset").evaluate(n,{},M),G=p_(s.horizontal),Z=x/24,ne=i.tilePixelRatio*Z,oe=i.tilePixelRatio*R/24,Pe=i.tilePixelRatio*S,ge=i.tilePixelRatio*F.get("symbol-spacing"),_e=F.get("text-padding")*i.tilePixelRatio,Le=function($e,At,kt,qt=1){const tr=$e.get("icon-padding").evaluate(At,{},kt),Yn=tr&&tr.values;return[Yn[0]*qt,Yn[1]*qt,Yn[2]*qt,Yn[3]*qt]}(F,n,M,i.tilePixelRatio),Ye=F.get("text-max-angle")/180*Math.PI,gt=F.get("text-rotation-alignment")!=="viewport"&&F.get("symbol-placement")!=="point",Ft=F.get("icon-rotation-alignment")==="map"&&F.get("symbol-placement")!=="point",_t=F.get("symbol-placement"),ft=ge/2,Pt=F.get("icon-text-fit");let xt;l&&Pt!=="none"&&(i.allowVerticalPlacement&&s.vertical&&(xt=Gg(l,s.vertical,Pt,F.get("icon-text-fit-padding"),j,Z)),G&&(l=Gg(l,G,Pt,F.get("icon-text-fit-padding"),j,Z)));const yt=($e,At)=>{At.x<0||At.x>=Ir||At.y<0||At.y>=Ir||function(kt,qt,tr,Yn,ei,Cs,xi,Nr,Ui,ji,$i,yn,$n,Pi,wi,Vi,ai,js,ns,zn,nr,lr,Is,Sr,vu){const Eo=kt.addToLineVertexArray(qt,tr);let ra,ro,$s,li,ks=0,Gh=0,m_=0,g_=0,rm=-1,im=-1;const ia={};let sm=iu("");if(kt.allowVerticalPlacement&&Yn.vertical){const Ai=Nr.layout.get("text-rotate").evaluate(nr,{},Sr)+90;$s=new Es(Ui,qt,ji,$i,yn,Yn.vertical,$n,Pi,wi,Ai),xi&&(li=new Es(Ui,qt,ji,$i,yn,xi,ai,js,wi,Ai))}if(ei){const Ai=Nr.layout.get("icon-rotate").evaluate(nr,{}),Vs=Nr.layout.get("icon-text-fit")!=="none",xu=c_(ei,Ai,Is,Vs),Io=xi?c_(xi,Ai,Is,Vs):void 0;ro=new Es(Ui,qt,ji,$i,yn,ei,ai,js,!1,Ai),ks=4*xu.length;const wu=kt.iconSizeData;let sa=null;wu.kind==="source"?(sa=[ta*Nr.layout.get("icon-size").evaluate(nr,{})],sa[0]>Al&&mt(`${kt.layerIds[0]}: Value for "icon-size" is >= ${Uh}. Reduce your "icon-size".`)):wu.kind==="composite"&&(sa=[ta*lr.compositeIconSizes[0].evaluate(nr,{},Sr),ta*lr.compositeIconSizes[1].evaluate(nr,{},Sr)],(sa[0]>Al||sa[1]>Al)&&mt(`${kt.layerIds[0]}: Value for "icon-size" is >= ${Uh}. Reduce your "icon-size".`)),kt.addSymbols(kt.icon,xu,sa,zn,ns,nr,w.ah.none,qt,Eo.lineStartIndex,Eo.lineLength,-1,Sr),rm=kt.icon.placedSymbolArray.length-1,Io&&(Gh=4*Io.length,kt.addSymbols(kt.icon,Io,sa,zn,ns,nr,w.ah.vertical,qt,Eo.lineStartIndex,Eo.lineLength,-1,Sr),im=kt.icon.placedSymbolArray.length-1)}const __=Object.keys(Yn.horizontal);for(const Ai of __){const Vs=Yn.horizontal[Ai];if(!ra){sm=iu(Vs.text);const Io=Nr.layout.get("text-rotate").evaluate(nr,{},Sr);ra=new Es(Ui,qt,ji,$i,yn,Vs,$n,Pi,wi,Io)}const xu=Vs.positionedLines.length===1;if(m_+=f_(kt,qt,Vs,Cs,Nr,wi,nr,Vi,Eo,Yn.vertical?w.ah.horizontal:w.ah.horizontalOnly,xu?__:[Ai],ia,rm,lr,Sr),xu)break}Yn.vertical&&(g_+=f_(kt,qt,Yn.vertical,Cs,Nr,wi,nr,Vi,Eo,w.ah.vertical,["vertical"],ia,im,lr,Sr));const s1=ra?ra.boxStartIndex:kt.collisionBoxArray.length,o1=ra?ra.boxEndIndex:kt.collisionBoxArray.length,a1=$s?$s.boxStartIndex:kt.collisionBoxArray.length,l1=$s?$s.boxEndIndex:kt.collisionBoxArray.length,u1=ro?ro.boxStartIndex:kt.collisionBoxArray.length,c1=ro?ro.boxEndIndex:kt.collisionBoxArray.length,h1=li?li.boxStartIndex:kt.collisionBoxArray.length,d1=li?li.boxEndIndex:kt.collisionBoxArray.length;let Co=-1;const pf=(Ai,Vs)=>Ai&&Ai.circleDiameter?Math.max(Ai.circleDiameter,Vs):Vs;Co=pf(ra,Co),Co=pf($s,Co),Co=pf(ro,Co),Co=pf(li,Co);const y_=Co>-1?1:0;y_&&(Co*=vu/Br),kt.glyphOffsetArray.length>=vc.MAX_GLYPHS&&mt("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),nr.sortKey!==void 0&&kt.addToSortKeyRanges(kt.symbolInstances.length,nr.sortKey);const f1=ja(Nr,nr,Sr),[p1,m1]=function(Ai,Vs){const xu=Ai.length,Io=Vs==null?void 0:Vs.values;if((Io==null?void 0:Io.length)>0)for(let wu=0;wu<Io.length;wu+=2){const sa=Io[wu+1];Ai.emplaceBack(w.aq[Io[wu]],sa[0],sa[1])}return[xu,Ai.length]}(kt.textAnchorOffsets,f1);kt.symbolInstances.emplaceBack(qt.x,qt.y,ia.right>=0?ia.right:-1,ia.center>=0?ia.center:-1,ia.left>=0?ia.left:-1,ia.vertical||-1,rm,im,sm,s1,o1,a1,l1,u1,c1,h1,d1,ji,m_,g_,ks,Gh,y_,0,$n,Co,p1,m1)}(i,At,$e,s,l,p,xt,i.layers[0],i.collisionBoxArray,n.index,n.sourceLayerIndex,i.index,ne,[_e,_e,_e,_e],gt,C,Pe,Le,Ft,j,n,v,P,M,x)};if(_t==="line")for(const $e of s_(n.geometry,0,0,Ir,Ir)){const At=Qy($e,ge,Ye,s.vertical||G,l,24,oe,i.overscaling,Ir);for(const kt of At)G&&r1(i,G.text,ft,kt)||yt($e,kt)}else if(_t==="line-center"){for(const $e of n.geometry)if($e.length>1){const At=Jy($e,Ye,s.vertical||G,l,24,oe);At&&yt($e,At)}}else if(n.type==="Polygon")for(const $e of ir(n.geometry,0)){const At=t1($e,16);yt($e[0],new na(At.x,At.y,0))}else if(n.type==="LineString")for(const $e of n.geometry)yt($e,new na($e[0].x,$e[0].y,0));else if(n.type==="Point")for(const $e of n.geometry)for(const At of $e)yt([At],new na(At.x,At.y,0))}function f_(i,n,s,l,p,v,x,S,C,P,M,R,F,j,G){const Z=function(Pe,ge,_e,Le,Ye,gt,Ft,_t){const ft=Le.layout.get("text-rotate").evaluate(gt,{})*Math.PI/180,Pt=[];for(const xt of ge.positionedLines)for(const yt of xt.positionedGlyphs){if(!yt.rect)continue;const $e=yt.rect||{};let At=Bg+1,kt=!0,qt=1,tr=0;const Yn=(Ye||_t)&&yt.vertical,ei=yt.metrics.advance*yt.scale/2;if(_t&&ge.verticalizable&&(tr=xt.lineOffset/2-(yt.imageName?-(Br-yt.metrics.width*yt.scale)/2:(yt.scale-1)*Br)),yt.imageName){const zn=Ft[yt.imageName];kt=zn.sdf,qt=zn.pixelRatio,At=ts/qt}const Cs=Ye?[yt.x+ei,yt.y]:[0,0];let xi=Ye?[0,0]:[yt.x+ei+_e[0],yt.y+_e[1]-tr],Nr=[0,0];Yn&&(Nr=xi,xi=[0,0]);const Ui=yt.metrics.isDoubleResolution?2:1,ji=(yt.metrics.left-At)*yt.scale-ei+xi[0],$i=(-yt.metrics.top-At)*yt.scale+xi[1],yn=ji+$e.w/Ui*yt.scale/qt,$n=$i+$e.h/Ui*yt.scale/qt,Pi=new W(ji,$i),wi=new W(yn,$i),Vi=new W(ji,$n),ai=new W(yn,$n);if(Yn){const zn=new W(-ei,ei-Fh),nr=-Math.PI/2,lr=Br/2-ei,Is=new W(5-Fh-lr,-(yt.imageName?lr:0)),Sr=new W(...Nr);Pi._rotateAround(nr,zn)._add(Is)._add(Sr),wi._rotateAround(nr,zn)._add(Is)._add(Sr),Vi._rotateAround(nr,zn)._add(Is)._add(Sr),ai._rotateAround(nr,zn)._add(Is)._add(Sr)}if(ft){const zn=Math.sin(ft),nr=Math.cos(ft),lr=[nr,-zn,zn,nr];Pi._matMult(lr),wi._matMult(lr),Vi._matMult(lr),ai._matMult(lr)}const js=new W(0,0),ns=new W(0,0);Pt.push({tl:Pi,tr:wi,bl:Vi,br:ai,tex:$e,writingMode:ge.writingMode,glyphOffset:Cs,sectionIndex:yt.sectionIndex,isSDF:kt,pixelOffsetTL:js,pixelOffsetBR:ns,minFontScaleX:0,minFontScaleY:0})}return Pt}(0,s,S,p,v,x,l,i.allowVerticalPlacement),ne=i.textSizeData;let oe=null;ne.kind==="source"?(oe=[ta*p.layout.get("text-size").evaluate(x,{})],oe[0]>Al&&mt(`${i.layerIds[0]}: Value for "text-size" is >= ${Uh}. Reduce your "text-size".`)):ne.kind==="composite"&&(oe=[ta*j.compositeTextSizes[0].evaluate(x,{},G),ta*j.compositeTextSizes[1].evaluate(x,{},G)],(oe[0]>Al||oe[1]>Al)&&mt(`${i.layerIds[0]}: Value for "text-size" is >= ${Uh}. Reduce your "text-size".`)),i.addSymbols(i.text,Z,oe,S,v,x,P,n,C.lineStartIndex,C.lineLength,F,G);for(const Pe of M)R[Pe]=i.text.placedSymbolArray.length-1;return 4*Z.length}function p_(i){for(const n in i)return i[n];return null}function r1(i,n,s,l){const p=i.compareText;if(n in p){const v=p[n];for(let x=v.length-1;x>=0;x--)if(l.dist(v[x])<s)return!0}else p[n]=[];return p[n].push(l),!1}const hf=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class Jp{static from(n){if(!(n instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[s,l]=new Uint8Array(n,0,2);if(s!==219)throw new Error("Data does not appear to be in a KDBush format.");const p=l>>4;if(p!==1)throw new Error(`Got v${p} data when expected v1.`);const v=hf[15&l];if(!v)throw new Error("Unrecognized array type.");const[x]=new Uint16Array(n,2,1),[S]=new Uint32Array(n,4,1);return new Jp(S,x,v,n)}constructor(n,s=64,l=Float64Array,p){if(isNaN(n)||n<0)throw new Error(`Unpexpected numItems value: ${n}.`);this.numItems=+n,this.nodeSize=Math.min(Math.max(+s,2),65535),this.ArrayType=l,this.IndexArrayType=n<65536?Uint16Array:Uint32Array;const v=hf.indexOf(this.ArrayType),x=2*n*this.ArrayType.BYTES_PER_ELEMENT,S=n*this.IndexArrayType.BYTES_PER_ELEMENT,C=(8-S%8)%8;if(v<0)throw new Error(`Unexpected typed array class: ${l}.`);p&&p instanceof ArrayBuffer?(this.data=p,this.ids=new this.IndexArrayType(this.data,8,n),this.coords=new this.ArrayType(this.data,8+S+C,2*n),this._pos=2*n,this._finished=!0):(this.data=new ArrayBuffer(8+x+S+C),this.ids=new this.IndexArrayType(this.data,8,n),this.coords=new this.ArrayType(this.data,8+S+C,2*n),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+v]),new Uint16Array(this.data,2,1)[0]=s,new Uint32Array(this.data,4,1)[0]=n)}add(n,s){const l=this._pos>>1;return this.ids[l]=l,this.coords[this._pos++]=n,this.coords[this._pos++]=s,l}finish(){const n=this._pos>>1;if(n!==this.numItems)throw new Error(`Added ${n} items when expected ${this.numItems}.`);return To(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(n,s,l,p){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:v,coords:x,nodeSize:S}=this,C=[0,v.length-1,0],P=[];for(;C.length;){const M=C.pop()||0,R=C.pop()||0,F=C.pop()||0;if(R-F<=S){for(let ne=F;ne<=R;ne++){const oe=x[2*ne],Pe=x[2*ne+1];oe>=n&&oe<=l&&Pe>=s&&Pe<=p&&P.push(v[ne])}continue}const j=F+R>>1,G=x[2*j],Z=x[2*j+1];G>=n&&G<=l&&Z>=s&&Z<=p&&P.push(v[j]),(M===0?n<=G:s<=Z)&&(C.push(F),C.push(j-1),C.push(1-M)),(M===0?l>=G:p>=Z)&&(C.push(j+1),C.push(R),C.push(1-M))}return P}within(n,s,l){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:p,coords:v,nodeSize:x}=this,S=[0,p.length-1,0],C=[],P=l*l;for(;S.length;){const M=S.pop()||0,R=S.pop()||0,F=S.pop()||0;if(R-F<=x){for(let ne=F;ne<=R;ne++)zr(v[2*ne],v[2*ne+1],n,s)<=P&&C.push(p[ne]);continue}const j=F+R>>1,G=v[2*j],Z=v[2*j+1];zr(G,Z,n,s)<=P&&C.push(p[j]),(M===0?n-l<=G:s-l<=Z)&&(S.push(F),S.push(j-1),S.push(1-M)),(M===0?n+l>=G:s+l>=Z)&&(S.push(j+1),S.push(R),S.push(1-M))}return C}}function To(i,n,s,l,p,v){if(p-l<=s)return;const x=l+p>>1;Qp(i,n,x,l,p,v),To(i,n,s,l,x-1,1-v),To(i,n,s,x+1,p,1-v)}function Qp(i,n,s,l,p,v){for(;p>l;){if(p-l>600){const P=p-l+1,M=s-l+1,R=Math.log(P),F=.5*Math.exp(2*R/3),j=.5*Math.sqrt(R*F*(P-F)/P)*(M-P/2<0?-1:1);Qp(i,n,s,Math.max(l,Math.floor(s-M*F/P+j)),Math.min(p,Math.floor(s+(P-M)*F/P+j)),v)}const x=n[2*s+v];let S=l,C=p;for(zl(i,n,l,s),n[2*p+v]>x&&zl(i,n,l,p);S<C;){for(zl(i,n,S,C),S++,C--;n[2*S+v]<x;)S++;for(;n[2*C+v]>x;)C--}n[2*l+v]===x?zl(i,n,l,C):(C++,zl(i,n,C,p)),C<=s&&(l=C+1),s<=C&&(p=C-1)}}function zl(i,n,s,l){br(i,s,l),br(n,2*s,2*l),br(n,2*s+1,2*l+1)}function br(i,n,s){const l=i[n];i[n]=i[s],i[s]=l}function zr(i,n,s,l){const p=i-s,v=n-l;return p*p+v*v}var df;w.bg=void 0,(df=w.bg||(w.bg={})).create="create",df.load="load",df.fullLoad="fullLoad";let ff=null,Zh=[];const em=1e3/60,tm="loadTime",nm="fullLoadTime",i1={mark(i){performance.mark(i)},frame(i){const n=i;ff!=null&&Zh.push(n-ff),ff=n},clearMetrics(){ff=null,Zh=[],performance.clearMeasures(tm),performance.clearMeasures(nm);for(const i in w.bg)performance.clearMarks(w.bg[i])},getPerformanceMetrics(){performance.measure(tm,w.bg.create,w.bg.load),performance.measure(nm,w.bg.create,w.bg.fullLoad);const i=performance.getEntriesByName(tm)[0].duration,n=performance.getEntriesByName(nm)[0].duration,s=Zh.length,l=1/(Zh.reduce((v,x)=>v+x,0)/s/1e3),p=Zh.filter(v=>v>em).reduce((v,x)=>v+(x-em)/em,0);return{loadTime:i,fullLoadTime:n,fps:l,percentDroppedFrames:p/(s+p)*100,totalFrames:s}}};w.$=class extends L{},w.A=lu,w.B=vh,w.C=function(i){if(Qn==null){const n=i.navigator?i.navigator.userAgent:null;Qn=!!i.safari||!(!n||!(/\b(iPad|iPhone|iPod)\b/.test(n)||n.match("Safari")&&!n.match("Chrome")))}return Qn},w.D=Ct,w.E=dn,w.F=class{constructor(i,n){this.target=i,this.mapId=n,this.resolveRejects={},this.tasks={},this.taskQueue=[],this.abortControllers={},this.messageHandlers={},this.invoker=new Ky(()=>this.process()),this.subscription=function(s,l,p,v){return s.addEventListener(l,p,!1),{unsubscribe:()=>{s.removeEventListener(l,p,!1)}}}(this.target,"message",s=>this.receive(s)),this.globalScope=qn(self)?i:window}registerMessageHandler(i,n){this.messageHandlers[i]=n}sendAsync(i,n){return new Promise((s,l)=>{const p=Math.round(1e18*Math.random()).toString(36).substring(0,10);this.resolveRejects[p]={resolve:s,reject:l},n&&n.signal.addEventListener("abort",()=>{delete this.resolveRejects[p];const S={id:p,type:"<cancel>",origin:location.origin,targetMapId:i.targetMapId,sourceMapId:this.mapId};this.target.postMessage(S)},{once:!0});const v=[],x=Object.assign(Object.assign({},i),{id:p,sourceMapId:this.mapId,origin:location.origin,data:yl(i.data,v)});this.target.postMessage(x,{transfer:v})})}receive(i){const n=i.data,s=n.id;if(!(n.origin!=="file://"&&location.origin!=="file://"&&n.origin!=="resource://android"&&location.origin!=="resource://android"&&n.origin!==location.origin||n.targetMapId&&this.mapId!==n.targetMapId)){if(n.type==="<cancel>"){delete this.tasks[s];const l=this.abortControllers[s];return delete this.abortControllers[s],void(l&&l.abort())}if(qn(self)||n.mustQueue)return this.tasks[s]=n,this.taskQueue.push(s),void this.invoker.trigger();this.processTask(s,n)}}process(){if(this.taskQueue.length===0)return;const i=this.taskQueue.shift(),n=this.tasks[i];delete this.tasks[i],this.taskQueue.length>0&&this.invoker.trigger(),n&&this.processTask(i,n)}processTask(i,n){return c(this,void 0,void 0,function*(){if(n.type==="<response>"){const p=this.resolveRejects[i];return delete this.resolveRejects[i],p?void(n.error?p.reject(wo(n.error)):p.resolve(wo(n.data))):void 0}if(!this.messageHandlers[n.type])return void this.completeTask(i,new Error(`Could not find a registered handler for ${n.type}, map ID: ${this.mapId}, available handlers: ${Object.keys(this.messageHandlers).join(", ")}`));const s=wo(n.data),l=new AbortController;this.abortControllers[i]=l;try{const p=yield this.messageHandlers[n.type](n.sourceMapId,s,l);this.completeTask(i,null,p)}catch(p){this.completeTask(i,p)}})}completeTask(i,n,s){const l=[];delete this.abortControllers[i];const p={id:i,type:"<response>",sourceMapId:this.mapId,origin:location.origin,error:n?yl(n):null,data:yl(s,l)};this.target.postMessage(p,{transfer:l})}remove(){this.invoker.remove(),this.subscription.unsubscribe()}},w.G=Cn,w.H=function(){var i=new lu(16);return lu!=Float32Array&&(i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[11]=0,i[12]=0,i[13]=0,i[14]=0),i[0]=1,i[5]=1,i[10]=1,i[15]=1,i},w.I=Bp,w.J=function(i,n,s){var l,p,v,x,S,C,P,M,R,F,j,G,Z=s[0],ne=s[1],oe=s[2];return n===i?(i[12]=n[0]*Z+n[4]*ne+n[8]*oe+n[12],i[13]=n[1]*Z+n[5]*ne+n[9]*oe+n[13],i[14]=n[2]*Z+n[6]*ne+n[10]*oe+n[14],i[15]=n[3]*Z+n[7]*ne+n[11]*oe+n[15]):(p=n[1],v=n[2],x=n[3],S=n[4],C=n[5],P=n[6],M=n[7],R=n[8],F=n[9],j=n[10],G=n[11],i[0]=l=n[0],i[1]=p,i[2]=v,i[3]=x,i[4]=S,i[5]=C,i[6]=P,i[7]=M,i[8]=R,i[9]=F,i[10]=j,i[11]=G,i[12]=l*Z+S*ne+R*oe+n[12],i[13]=p*Z+C*ne+F*oe+n[13],i[14]=v*Z+P*ne+j*oe+n[14],i[15]=x*Z+M*ne+G*oe+n[15]),i},w.K=function(i,n,s){var l=s[0],p=s[1],v=s[2];return i[0]=n[0]*l,i[1]=n[1]*l,i[2]=n[2]*l,i[3]=n[3]*l,i[4]=n[4]*p,i[5]=n[5]*p,i[6]=n[6]*p,i[7]=n[7]*p,i[8]=n[8]*v,i[9]=n[9]*v,i[10]=n[10]*v,i[11]=n[11]*v,i[12]=n[12],i[13]=n[13],i[14]=n[14],i[15]=n[15],i},w.L=es,w.M=function(i,n){const s={};for(let l=0;l<n.length;l++){const p=n[l];p in i&&(s[p]=i[p])}return s},w.N=Ml,w.O=e_,w.P=W,w.Q=t_,w.R=Ss,w.S=Ts,w.T=ic,w.U=se,w.V=ue,w.W=rt,w.X=Ir,w.Y=E,w.Z=xc,w._=c,w.a=Sn,w.a$=function(i,n){var s=i[0],l=i[1],p=i[2],v=i[3],x=i[4],S=i[5],C=i[6],P=i[7],M=i[8],R=i[9],F=i[10],j=i[11],G=i[12],Z=i[13],ne=i[14],oe=i[15],Pe=n[0],ge=n[1],_e=n[2],Le=n[3],Ye=n[4],gt=n[5],Ft=n[6],_t=n[7],ft=n[8],Pt=n[9],xt=n[10],yt=n[11],$e=n[12],At=n[13],kt=n[14],qt=n[15];return Math.abs(s-Pe)<=Ni*Math.max(1,Math.abs(s),Math.abs(Pe))&&Math.abs(l-ge)<=Ni*Math.max(1,Math.abs(l),Math.abs(ge))&&Math.abs(p-_e)<=Ni*Math.max(1,Math.abs(p),Math.abs(_e))&&Math.abs(v-Le)<=Ni*Math.max(1,Math.abs(v),Math.abs(Le))&&Math.abs(x-Ye)<=Ni*Math.max(1,Math.abs(x),Math.abs(Ye))&&Math.abs(S-gt)<=Ni*Math.max(1,Math.abs(S),Math.abs(gt))&&Math.abs(C-Ft)<=Ni*Math.max(1,Math.abs(C),Math.abs(Ft))&&Math.abs(P-_t)<=Ni*Math.max(1,Math.abs(P),Math.abs(_t))&&Math.abs(M-ft)<=Ni*Math.max(1,Math.abs(M),Math.abs(ft))&&Math.abs(R-Pt)<=Ni*Math.max(1,Math.abs(R),Math.abs(Pt))&&Math.abs(F-xt)<=Ni*Math.max(1,Math.abs(F),Math.abs(xt))&&Math.abs(j-yt)<=Ni*Math.max(1,Math.abs(j),Math.abs(yt))&&Math.abs(G-$e)<=Ni*Math.max(1,Math.abs(G),Math.abs($e))&&Math.abs(Z-At)<=Ni*Math.max(1,Math.abs(Z),Math.abs(At))&&Math.abs(ne-kt)<=Ni*Math.max(1,Math.abs(ne),Math.abs(kt))&&Math.abs(oe-qt)<=Ni*Math.max(1,Math.abs(oe),Math.abs(qt))},w.a0=gn,w.a1=$h,w.a2=Ke,w.a3=i=>{const n=window.document.createElement("video");return n.muted=!0,new Promise(s=>{n.onloadstart=()=>{s(n)};for(const l of i){const p=window.document.createElement("source");Zn(l)||(n.crossOrigin="Anonymous"),p.src=l,n.appendChild(p)}})},w.a4=function(){return ee++},w.a5=nt,w.a6=vc,w.a7=ph,w.a8=ws,w.a9=r_,w.aA=function(i){if(i.type==="custom")return new Xy(i);switch(i.type){case"background":return new af(i);case"circle":return new Hd(i);case"fill":return new fy(i);case"fill-extrusion":return new wg(i);case"heatmap":return new cg(i);case"hillshade":return new Kd(i);case"line":return new Ey(i);case"raster":return new Hy(i);case"symbol":return new of(i)}},w.aB=Ue,w.aC=function(i,n){if(!i)return[{command:"setStyle",args:[n]}];let s=[];try{if(!Ot(i.version,n.version))return[{command:"setStyle",args:[n]}];Ot(i.center,n.center)||s.push({command:"setCenter",args:[n.center]}),Ot(i.zoom,n.zoom)||s.push({command:"setZoom",args:[n.zoom]}),Ot(i.bearing,n.bearing)||s.push({command:"setBearing",args:[n.bearing]}),Ot(i.pitch,n.pitch)||s.push({command:"setPitch",args:[n.pitch]}),Ot(i.sprite,n.sprite)||s.push({command:"setSprite",args:[n.sprite]}),Ot(i.glyphs,n.glyphs)||s.push({command:"setGlyphs",args:[n.glyphs]}),Ot(i.transition,n.transition)||s.push({command:"setTransition",args:[n.transition]}),Ot(i.light,n.light)||s.push({command:"setLight",args:[n.light]}),Ot(i.terrain,n.terrain)||s.push({command:"setTerrain",args:[n.terrain]}),Ot(i.sky,n.sky)||s.push({command:"setSky",args:[n.sky]}),Ot(i.projection,n.projection)||s.push({command:"setProjection",args:[n.projection]});const l={},p=[];(function(x,S,C,P){let M;for(M in S=S||{},x=x||{})Object.prototype.hasOwnProperty.call(x,M)&&(Object.prototype.hasOwnProperty.call(S,M)||yr(M,C,P));for(M in S)Object.prototype.hasOwnProperty.call(S,M)&&(Object.prototype.hasOwnProperty.call(x,M)?Ot(x[M],S[M])||(x[M].type==="geojson"&&S[M].type==="geojson"&&vr(x,S,M)?Yt(C,{command:"setGeoJSONSourceData",args:[M,S[M].data]}):Hr(M,S,C,P)):Tr(M,S,C))})(i.sources,n.sources,p,l);const v=[];i.layers&&i.layers.forEach(x=>{"source"in x&&l[x.source]?s.push({command:"removeLayer",args:[x.id]}):v.push(x)}),s=s.concat(p),function(x,S,C){S=S||[];const P=(x=x||[]).map(dr),M=S.map(dr),R=x.reduce(fr,{}),F=S.reduce(fr,{}),j=P.slice(),G=Object.create(null);let Z,ne,oe,Pe,ge;for(let _e=0,Le=0;_e<P.length;_e++)Z=P[_e],Object.prototype.hasOwnProperty.call(F,Z)?Le++:(Yt(C,{command:"removeLayer",args:[Z]}),j.splice(j.indexOf(Z,Le),1));for(let _e=0,Le=0;_e<M.length;_e++)Z=M[M.length-1-_e],j[j.length-1-_e]!==Z&&(Object.prototype.hasOwnProperty.call(R,Z)?(Yt(C,{command:"removeLayer",args:[Z]}),j.splice(j.lastIndexOf(Z,j.length-Le),1)):Le++,Pe=j[j.length-_e],Yt(C,{command:"addLayer",args:[F[Z],Pe]}),j.splice(j.length-_e,0,Z),G[Z]=!0);for(let _e=0;_e<M.length;_e++)if(Z=M[_e],ne=R[Z],oe=F[Z],!G[Z]&&!Ot(ne,oe))if(Ot(ne.source,oe.source)&&Ot(ne["source-layer"],oe["source-layer"])&&Ot(ne.type,oe.type)){for(ge in rr(ne.layout,oe.layout,C,Z,null,"setLayoutProperty"),rr(ne.paint,oe.paint,C,Z,null,"setPaintProperty"),Ot(ne.filter,oe.filter)||Yt(C,{command:"setFilter",args:[Z,oe.filter]}),Ot(ne.minzoom,oe.minzoom)&&Ot(ne.maxzoom,oe.maxzoom)||Yt(C,{command:"setLayerZoomRange",args:[Z,oe.minzoom,oe.maxzoom]}),ne)Object.prototype.hasOwnProperty.call(ne,ge)&&ge!=="layout"&&ge!=="paint"&&ge!=="filter"&&ge!=="metadata"&&ge!=="minzoom"&&ge!=="maxzoom"&&(ge.indexOf("paint.")===0?rr(ne[ge],oe[ge],C,Z,ge.slice(6),"setPaintProperty"):Ot(ne[ge],oe[ge])||Yt(C,{command:"setLayerProperty",args:[Z,ge,oe[ge]]}));for(ge in oe)Object.prototype.hasOwnProperty.call(oe,ge)&&!Object.prototype.hasOwnProperty.call(ne,ge)&&ge!=="layout"&&ge!=="paint"&&ge!=="filter"&&ge!=="metadata"&&ge!=="minzoom"&&ge!=="maxzoom"&&(ge.indexOf("paint.")===0?rr(ne[ge],oe[ge],C,Z,ge.slice(6),"setPaintProperty"):Ot(ne[ge],oe[ge])||Yt(C,{command:"setLayerProperty",args:[Z,ge,oe[ge]]}))}else Yt(C,{command:"removeLayer",args:[Z]}),Pe=j[j.lastIndexOf(Z)+1],Yt(C,{command:"addLayer",args:[oe,Pe]})}(v,n.layers,s)}catch(l){console.warn("Unable to compute style diff:",l),s=[{command:"setStyle",args:[n]}]}return s},w.aD=function(i){const n=[],s=i.id;return s===void 0&&n.push({message:`layers.${s}: missing required property "id"`}),i.render===void 0&&n.push({message:`layers.${s}: missing required method "render"`}),i.renderingMode&&i.renderingMode!=="2d"&&i.renderingMode!=="3d"&&n.push({message:`layers.${s}: property "renderingMode" must be either "2d" or "3d"`}),n},w.aE=function i(n,s){if(Array.isArray(n)){if(!Array.isArray(s)||n.length!==s.length)return!1;for(let l=0;l<n.length;l++)if(!i(n[l],s[l]))return!1;return!0}if(typeof n=="object"&&n!==null&&s!==null){if(typeof s!="object"||Object.keys(n).length!==Object.keys(s).length)return!1;for(const l in n)if(!i(n[l],s[l]))return!1;return!0}return n===s},w.aF=de,w.aG=Te,w.aH=class extends Ra{constructor(i,n){super(i,n),this.current=0}set(i){this.current!==i&&(this.current=i,this.gl.uniform1i(this.location,i))}},w.aI=Eh,w.aJ=class extends Ra{constructor(i,n){super(i,n),this.current=dp}set(i){if(i[12]!==this.current[12]||i[0]!==this.current[0])return this.current=i,void this.gl.uniformMatrix4fv(this.location,!1,i);for(let n=1;n<16;n++)if(i[n]!==this.current[n]){this.current=i,this.gl.uniformMatrix4fv(this.location,!1,i);break}}},w.aK=Ud,w.aL=ng,w.aM=Rn,w.aN=class extends Ra{constructor(i,n){super(i,n),this.current=[0,0,0]}set(i){i[0]===this.current[0]&&i[1]===this.current[1]&&i[2]===this.current[2]||(this.current=i,this.gl.uniform3f(this.location,i[0],i[1],i[2]))}},w.aO=class extends Ra{constructor(i,n){super(i,n),this.current=[0,0]}set(i){i[0]===this.current[0]&&i[1]===this.current[1]||(this.current=i,this.gl.uniform2f(this.location,i[0],i[1]))}},w.aP=function(i,n,s,l,p,v,x){var S=1/(n-s),C=1/(l-p),P=1/(v-x);return i[0]=-2*S,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=-2*C,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=2*P,i[11]=0,i[12]=(n+s)*S,i[13]=(p+l)*C,i[14]=(x+v)*P,i[15]=1,i},w.aQ=ly,w.aR=class extends xe{},w.aS=Iy,w.aT=class extends Me{},w.aU=hc,w.aV=function(i){return i<=1?1:Math.pow(2,Math.ceil(Math.log(i)/Math.LN2))},w.aW=yp,w.aX=mi,w.aY=xs,w.aZ=class extends wt{},w.a_=function(i,n){return i[0]===n[0]&&i[1]===n[1]&&i[2]===n[2]&&i[3]===n[3]&&i[4]===n[4]&&i[5]===n[5]&&i[6]===n[6]&&i[7]===n[7]&&i[8]===n[8]&&i[9]===n[9]&&i[10]===n[10]&&i[11]===n[11]&&i[12]===n[12]&&i[13]===n[13]&&i[14]===n[14]&&i[15]===n[15]},w.aa=function(i){const n={};if(i.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(s,l,p,v)=>{const x=p||v;return n[l]=!x||x.toLowerCase(),""}),n["max-age"]){const s=parseInt(n["max-age"],10);isNaN(s)?delete n["max-age"]:n["max-age"]=s}return n},w.ab=function(i,n){const s=[];for(const l in i)l in n||s.push(l);return s},w.ac=Ze,w.ad=function(i,n,s){var l=Math.sin(s),p=Math.cos(s),v=n[0],x=n[1],S=n[2],C=n[3],P=n[4],M=n[5],R=n[6],F=n[7];return n!==i&&(i[8]=n[8],i[9]=n[9],i[10]=n[10],i[11]=n[11],i[12]=n[12],i[13]=n[13],i[14]=n[14],i[15]=n[15]),i[0]=v*p+P*l,i[1]=x*p+M*l,i[2]=S*p+R*l,i[3]=C*p+F*l,i[4]=P*p-v*l,i[5]=M*p-x*l,i[6]=R*p-S*l,i[7]=F*p-C*l,i},w.ae=function(i){var n=new lu(16);return n[0]=i[0],n[1]=i[1],n[2]=i[2],n[3]=i[3],n[4]=i[4],n[5]=i[5],n[6]=i[6],n[7]=i[7],n[8]=i[8],n[9]=i[9],n[10]=i[10],n[11]=i[11],n[12]=i[12],n[13]=i[13],n[14]=i[14],n[15]=i[15],n},w.af=Wd,w.ag=function(i,n){let s=0,l=0;if(i.kind==="constant")l=i.layoutSize;else if(i.kind!=="source"){const{interpolationType:p,minZoom:v,maxZoom:x}=i,S=p?Ze(Ei.interpolationFactor(p,n,v,x),0,1):0;i.kind==="camera"?l=Oi.number(i.minSize,i.maxSize,S):s=S}return{uSizeT:s,uSize:l}},w.ai=function(i,{uSize:n,uSizeT:s},{lowerSize:l,upperSize:p}){return i.kind==="source"?l/ta:i.kind==="composite"?Oi.number(l/ta,p/ta,s):n},w.aj=jp,w.ak=function(i,n,s,l){const p=n.y-i.y,v=n.x-i.x,x=l.y-s.y,S=l.x-s.x,C=x*v-S*p;if(C===0)return null;const P=(S*(i.y-s.y)-x*(i.x-s.x))/C;return new W(i.x+P*v,i.y+P*p)},w.al=s_,w.am=kh,w.an=Gd,w.ao=function(i){let n=1/0,s=1/0,l=-1/0,p=-1/0;for(const v of i)n=Math.min(n,v.x),s=Math.min(s,v.y),l=Math.max(l,v.x),p=Math.max(p,v.y);return[n,s,l,p]},w.ap=Br,w.ar=Up,w.as=function(i,n){var s=n[0],l=n[1],p=n[2],v=n[3],x=n[4],S=n[5],C=n[6],P=n[7],M=n[8],R=n[9],F=n[10],j=n[11],G=n[12],Z=n[13],ne=n[14],oe=n[15],Pe=s*S-l*x,ge=s*C-p*x,_e=s*P-v*x,Le=l*C-p*S,Ye=l*P-v*S,gt=p*P-v*C,Ft=M*Z-R*G,_t=M*ne-F*G,ft=M*oe-j*G,Pt=R*ne-F*Z,xt=R*oe-j*Z,yt=F*oe-j*ne,$e=Pe*yt-ge*xt+_e*Pt+Le*ft-Ye*_t+gt*Ft;return $e?(i[0]=(S*yt-C*xt+P*Pt)*($e=1/$e),i[1]=(p*xt-l*yt-v*Pt)*$e,i[2]=(Z*gt-ne*Ye+oe*Le)*$e,i[3]=(F*Ye-R*gt-j*Le)*$e,i[4]=(C*ft-x*yt-P*_t)*$e,i[5]=(s*yt-p*ft+v*_t)*$e,i[6]=(ne*_e-G*gt-oe*ge)*$e,i[7]=(M*gt-F*_e+j*ge)*$e,i[8]=(x*xt-S*ft+P*Ft)*$e,i[9]=(l*ft-s*xt-v*Ft)*$e,i[10]=(G*Ye-Z*_e+oe*Pe)*$e,i[11]=(R*_e-M*Ye-j*Pe)*$e,i[12]=(S*_t-x*Pt-C*Ft)*$e,i[13]=(s*Pt-l*_t+p*Ft)*$e,i[14]=(Z*ge-G*Le-ne*Pe)*$e,i[15]=(M*Le-R*ge+F*Pe)*$e,i):null},w.at=Yp,w.au=tf,w.av=Jp,w.aw=function(){const i={},n=Ce.$version;for(const s in Ce.$root){const l=Ce.$root[s];if(l.required){let p=null;p=s==="version"?n:l.type==="array"?[]:{},p!=null&&(i[s]=p)}}return i},w.ax=Aa,w.ay=Zt,w.az=function(i){i=i.slice();const n=Object.create(null);for(let s=0;s<i.length;s++)n[i[s].id]=i[s];for(let s=0;s<i.length;s++)"ref"in i[s]&&(i[s]=bn(i[s],n[i[s].ref]));return i},w.b=zt,w.b0=function(i,n){return i[0]=n[0],i[1]=n[1],i[2]=n[2],i[3]=n[3],i[4]=n[4],i[5]=n[5],i[6]=n[6],i[7]=n[7],i[8]=n[8],i[9]=n[9],i[10]=n[10],i[11]=n[11],i[12]=n[12],i[13]=n[13],i[14]=n[14],i[15]=n[15],i},w.b1=function(i,n,s){return i[0]=n[0]*s[0],i[1]=n[1]*s[1],i[2]=n[2]*s[2],i[3]=n[3]*s[3],i},w.b2=function(i,n){return i[0]*n[0]+i[1]*n[1]+i[2]*n[2]+i[3]*n[3]},w.b3=je,w.b4=Hp,w.b5=jh,w.b6=function(i,n,s,l,p){var v,x=1/Math.tan(n/2);return i[0]=x/s,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=x,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[11]=-1,i[12]=0,i[13]=0,i[15]=0,p!=null&&p!==1/0?(i[10]=(p+l)*(v=1/(l-p)),i[14]=2*p*l*v):(i[10]=-1,i[14]=-2*l),i},w.b7=function(i,n,s){var l=Math.sin(s),p=Math.cos(s),v=n[4],x=n[5],S=n[6],C=n[7],P=n[8],M=n[9],R=n[10],F=n[11];return n!==i&&(i[0]=n[0],i[1]=n[1],i[2]=n[2],i[3]=n[3],i[12]=n[12],i[13]=n[13],i[14]=n[14],i[15]=n[15]),i[4]=v*p+P*l,i[5]=x*p+M*l,i[6]=S*p+R*l,i[7]=C*p+F*l,i[8]=P*p-v*l,i[9]=M*p-x*l,i[10]=R*p-S*l,i[11]=F*p-C*l,i},w.b8=he,w.b9=De,w.bA=Mg,w.bB=function(i){return i.message===It},w.bC=Wt,w.bD=Ji,w.ba=function(i){return i*Math.PI/180},w.bb=function(i,n){const{x:s,y:l}=xc.fromLngLat(n);return!(i<0||i>25||l<0||l>=1||s<0||s>=1)},w.bc=function(i,n){return i[0]=n[0],i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=n[1],i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=n[2],i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i},w.bd=class extends z{},w.be=Zp,w.bf=i1,w.bh=Nn,w.bi=function(i,n){Sn.REGISTERED_PROTOCOLS[i]=n},w.bj=function(i){delete Sn.REGISTERED_PROTOCOLS[i]},w.bk=function(i,n){const s={};for(let p=0;p<i.length;p++){const v=n&&n[i[p].id]||zd(i[p]);n&&(n[i[p].id]=v);let x=s[v];x||(x=s[v]=[]),x.push(i[p])}const l=[];for(const p in s)l.push(s[p]);return l},w.bl=vt,w.bm=n_,w.bn=i_,w.bo=Ug,w.bp=function(i){i.bucket.createArrays(),i.bucket.tilePixelRatio=Ir/(512*i.bucket.overscaling),i.bucket.compareText={},i.bucket.iconsNeedLinear=!1;const n=i.bucket.layers[0],s=n.layout,l=n._unevaluatedLayout._values,p={layoutIconSize:l["icon-size"].possiblyEvaluate(new ar(i.bucket.zoom+1),i.canonical),layoutTextSize:l["text-size"].possiblyEvaluate(new ar(i.bucket.zoom+1),i.canonical),textMaxSize:l["text-size"].possiblyEvaluate(new ar(18))};if(i.bucket.textSizeData.kind==="composite"){const{minZoom:P,maxZoom:M}=i.bucket.textSizeData;p.compositeTextSizes=[l["text-size"].possiblyEvaluate(new ar(P),i.canonical),l["text-size"].possiblyEvaluate(new ar(M),i.canonical)]}if(i.bucket.iconSizeData.kind==="composite"){const{minZoom:P,maxZoom:M}=i.bucket.iconSizeData;p.compositeIconSizes=[l["icon-size"].possiblyEvaluate(new ar(P),i.canonical),l["icon-size"].possiblyEvaluate(new ar(M),i.canonical)]}const v=s.get("text-line-height")*Br,x=s.get("text-rotation-alignment")!=="viewport"&&s.get("symbol-placement")!=="point",S=s.get("text-keep-upright"),C=s.get("text-size");for(const P of i.bucket.features){const M=s.get("text-font").evaluate(P,{},i.canonical).join(","),R=C.evaluate(P,{},i.canonical),F=p.layoutTextSize.evaluate(P,{},i.canonical),j=p.layoutIconSize.evaluate(P,{},i.canonical),G={horizontal:{},vertical:void 0},Z=P.text;let ne,oe=[0,0];if(Z){const _e=Z.toString(),Le=s.get("text-letter-spacing").evaluate(P,{},i.canonical)*Br,Ye=vl(_e)?Le:0,gt=s.get("text-anchor").evaluate(P,{},i.canonical),Ft=ja(n,P,i.canonical);if(!Ft){const xt=s.get("text-radial-offset").evaluate(P,{},i.canonical);oe=xt?d_(gt,[xt*Br,Mr]):s.get("text-offset").evaluate(P,{},i.canonical).map(yt=>yt*Br)}let _t=x?"center":s.get("text-justify").evaluate(P,{},i.canonical);const ft=s.get("symbol-placement")==="point"?s.get("text-max-width").evaluate(P,{},i.canonical)*Br:1/0,Pt=()=>{i.bucket.allowVerticalPlacement&&H(_e)&&(G.vertical=yc(Z,i.glyphMap,i.glyphPositions,i.imagePositions,M,ft,v,gt,"left",Ye,oe,w.ah.vertical,!0,F,R))};if(!x&&Ft){const xt=new Set;if(_t==="auto")for(let $e=0;$e<Ft.values.length;$e+=2)xt.add(Yp(Ft.values[$e]));else xt.add(_t);let yt=!1;for(const $e of xt)if(!G.horizontal[$e])if(yt)G.horizontal[$e]=G.horizontal[0];else{const At=yc(Z,i.glyphMap,i.glyphPositions,i.imagePositions,M,ft,v,"center",$e,Ye,oe,w.ah.horizontal,!1,F,R);At&&(G.horizontal[$e]=At,yt=At.positionedLines.length===1)}Pt()}else{_t==="auto"&&(_t=Yp(gt));const xt=yc(Z,i.glyphMap,i.glyphPositions,i.imagePositions,M,ft,v,gt,_t,Ye,oe,w.ah.horizontal,!1,F,R);xt&&(G.horizontal[_t]=xt),Pt(),H(_e)&&x&&S&&(G.vertical=yc(Z,i.glyphMap,i.glyphPositions,i.imagePositions,M,ft,v,gt,_t,Ye,oe,w.ah.vertical,!1,F,R))}}let Pe=!1;if(P.icon&&P.icon.name){const _e=i.imageMap[P.icon.name];_e&&(ne=nf(i.imagePositions[P.icon.name],s.get("icon-offset").evaluate(P,{},i.canonical),s.get("icon-anchor").evaluate(P,{},i.canonical)),Pe=!!_e.sdf,i.bucket.sdfIcons===void 0?i.bucket.sdfIcons=Pe:i.bucket.sdfIcons!==Pe&&mt("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(_e.pixelRatio!==i.bucket.pixelRatio||s.get("icon-rotate").constantOr(1)!==0)&&(i.bucket.iconsNeedLinear=!0))}const ge=p_(G.horizontal)||G.vertical;i.bucket.iconsInText=!!ge&&ge.iconsInText,(ge||ne)&&n1(i.bucket,P,G,ne,i.imageMap,p,F,j,oe,Pe,i.canonical)}i.showCollisionBoxes&&i.bucket.generateCollisionDebugBuffers()},w.bq=zp,w.br=Tp,w.bs=Pp,w.bt=Fr,w.bu=Op,w.bv=class{constructor(i){this._marks={start:[i.url,"start"].join("#"),end:[i.url,"end"].join("#"),measure:i.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let i=performance.getEntriesByName(this._marks.measure);return i.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),i=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),i}},w.bw=function(i,n,s,l,p){return c(this,void 0,void 0,function*(){if(ue())try{return yield rt(i,n,s,l,p)}catch{}return function(v,x,S,C,P){const M=v.width,R=v.height;Et&&ht||(Et=new OffscreenCanvas(M,R),ht=Et.getContext("2d",{willReadFrequently:!0})),Et.width=M,Et.height=R,ht.drawImage(v,0,0,M,R);const F=ht.getImageData(x,S,C,P);return ht.clearRect(0,0,M,R),F.data}(i,n,s,l,p)})},w.bx=Xp,w.by=D,w.bz=U,w.c=St,w.d=i=>c(void 0,void 0,void 0,function*(){if(i.byteLength===0)return createImageBitmap(new ImageData(1,1));const n=new Blob([new Uint8Array(i)],{type:"image/png"});try{return createImageBitmap(n)}catch(s){throw new Error(`Could not load image because of ${s.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`)}}),w.e=ve,w.f=i=>new Promise((n,s)=>{const l=new Image;l.onload=()=>{n(l),URL.revokeObjectURL(l.src),l.onload=null,window.requestAnimationFrame(()=>{l.src=Je})},l.onerror=()=>s(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const p=new Blob([new Uint8Array(i)],{type:"image/png"});l.src=i.byteLength?URL.createObjectURL(p):Je}),w.g=cn,w.h=(i,n)=>rn(ve(i,{type:"json"}),n),w.i=qn,w.j=sn,w.k=er,w.l=(i,n)=>rn(ve(i,{type:"arrayBuffer"}),n),w.m=rn,w.n=function(i){return new Op(i).readFields(Oy,[])},w.o=Ah,w.p=Ng,w.q=y,w.r=eu,w.s=Zn,w.t=Pa,w.u=vo,w.v=Ce,w.w=mt,w.x=function([i,n,s]){return n+=90,n*=Math.PI/180,s*=Math.PI/180,{x:i*Math.cos(n)*Math.sin(s),y:i*Math.sin(n)*Math.sin(s),z:i*Math.cos(s)}},w.y=Oi,w.z=ar}),_("worker",["./shared"],function(w){class c{constructor(N){this.keyCache={},N&&this.replace(N)}replace(N){this._layerConfigs={},this._layers={},this.update(N,[])}update(N,B){for(const re of N){this._layerConfigs[re.id]=re;const ye=this._layers[re.id]=w.aA(re);ye._featureFilter=w.a7(ye.filter),this.keyCache[re.id]&&delete this.keyCache[re.id]}for(const re of B)delete this.keyCache[re],delete this._layerConfigs[re],delete this._layers[re];this.familiesBySource={};const K=w.bk(Object.values(this._layerConfigs),this.keyCache);for(const re of K){const ye=re.map(Re=>this._layers[Re.id]),Se=ye[0];if(Se.visibility==="none")continue;const ke=Se.source||"";let pe=this.familiesBySource[ke];pe||(pe=this.familiesBySource[ke]={});const Fe=Se.sourceLayer||"_geojsonTileLayer";let Ge=pe[Fe];Ge||(Ge=pe[Fe]=[]),Ge.push(ye)}}}class D{constructor(N){const B={},K=[];for(const ke in N){const pe=N[ke],Fe=B[ke]={};for(const Ge in pe){const Re=pe[+Ge];if(!Re||Re.bitmap.width===0||Re.bitmap.height===0)continue;const st={x:0,y:0,w:Re.bitmap.width+2,h:Re.bitmap.height+2};K.push(st),Fe[Ge]={rect:st,metrics:Re.metrics}}}const{w:re,h:ye}=w.p(K),Se=new w.o({width:re||1,height:ye||1});for(const ke in N){const pe=N[ke];for(const Fe in pe){const Ge=pe[+Fe];if(!Ge||Ge.bitmap.width===0||Ge.bitmap.height===0)continue;const Re=B[ke][Fe].rect;w.o.copy(Ge.bitmap,Se,{x:0,y:0},{x:Re.x+1,y:Re.y+1},Ge.bitmap)}}this.image=Se,this.positions=B}}w.bl("GlyphAtlas",D);class U{constructor(N){this.tileID=new w.S(N.tileID.overscaledZ,N.tileID.wrap,N.tileID.canonical.z,N.tileID.canonical.x,N.tileID.canonical.y),this.uid=N.uid,this.zoom=N.zoom,this.pixelRatio=N.pixelRatio,this.tileSize=N.tileSize,this.source=N.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=N.showCollisionBoxes,this.collectResourceTiming=!!N.collectResourceTiming,this.returnDependencies=!!N.returnDependencies,this.promoteId=N.promoteId,this.inFlightDependencies=[]}parse(N,B,K,re){return w._(this,void 0,void 0,function*(){this.status="parsing",this.data=N,this.collisionBoxArray=new w.a5;const ye=new w.bm(Object.keys(N.layers).sort()),Se=new w.bn(this.tileID,this.promoteId);Se.bucketLayerIDs=[];const ke={},pe={featureIndex:Se,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:K},Fe=B.familiesBySource[this.source];for(const on in Fe){const Gn=N.layers[on];if(!Gn)continue;Gn.version===1&&w.w(`Vector tile source "${this.source}" layer "${on}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const ur=ye.encode(on),Xr=[];for(let ni=0;ni<Gn.length;ni++){const Kr=Gn.feature(ni),el=Se.getId(Kr,on);Xr.push({feature:Kr,id:el,index:ni,sourceLayerIndex:ur})}for(const ni of Fe[on]){const Kr=ni[0];Kr.source!==this.source&&w.w(`layer.source = ${Kr.source} does not equal this.source = ${this.source}`),Kr.minzoom&&this.zoom<Math.floor(Kr.minzoom)||Kr.maxzoom&&this.zoom>=Kr.maxzoom||Kr.visibility!=="none"&&(J(ni,this.zoom,K),(ke[Kr.id]=Kr.createBucket({index:Se.bucketLayerIDs.length,layers:ni,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:ur,sourceID:this.source})).populate(Xr,pe,this.tileID.canonical),Se.bucketLayerIDs.push(ni.map(el=>el.id)))}}const Ge=w.aF(pe.glyphDependencies,on=>Object.keys(on).map(Number));this.inFlightDependencies.forEach(on=>on==null?void 0:on.abort()),this.inFlightDependencies=[];let Re=Promise.resolve({});if(Object.keys(Ge).length){const on=new AbortController;this.inFlightDependencies.push(on),Re=re.sendAsync({type:"GG",data:{stacks:Ge,source:this.source,tileID:this.tileID,type:"glyphs"}},on)}const st=Object.keys(pe.iconDependencies);let Mt=Promise.resolve({});if(st.length){const on=new AbortController;this.inFlightDependencies.push(on),Mt=re.sendAsync({type:"GI",data:{icons:st,source:this.source,tileID:this.tileID,type:"icons"}},on)}const Lt=Object.keys(pe.patternDependencies);let In=Promise.resolve({});if(Lt.length){const on=new AbortController;this.inFlightDependencies.push(on),In=re.sendAsync({type:"GI",data:{icons:Lt,source:this.source,tileID:this.tileID,type:"patterns"}},on)}const[Jt,kn,fn]=yield Promise.all([Re,Mt,In]),Ar=new D(Jt),xr=new w.bo(kn,fn);for(const on in ke){const Gn=ke[on];Gn instanceof w.a6?(J(Gn.layers,this.zoom,K),w.bp({bucket:Gn,glyphMap:Jt,glyphPositions:Ar.positions,imageMap:kn,imagePositions:xr.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical})):Gn.hasPattern&&(Gn instanceof w.bq||Gn instanceof w.br||Gn instanceof w.bs)&&(J(Gn.layers,this.zoom,K),Gn.addFeatures(pe,this.tileID.canonical,xr.patternPositions))}return this.status="done",{buckets:Object.values(ke).filter(on=>!on.isEmpty()),featureIndex:Se,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Ar.image,imageAtlas:xr,glyphMap:this.returnDependencies?Jt:null,iconMap:this.returnDependencies?kn:null,glyphPositions:this.returnDependencies?Ar.positions:null}})}}function J(ae,N,B){const K=new w.z(N);for(const re of ae)re.recalculate(K,B)}class W{constructor(N,B,K){this.actor=N,this.layerIndex=B,this.availableImages=K,this.fetching={},this.loading={},this.loaded={}}loadVectorTile(N,B){return w._(this,void 0,void 0,function*(){const K=yield w.l(N.request,B);try{return{vectorTile:new w.bt.VectorTile(new w.bu(K.data)),rawData:K.data,cacheControl:K.cacheControl,expires:K.expires}}catch(re){const ye=new Uint8Array(K.data);let Se=`Unable to parse the tile at ${N.request.url}, `;throw Se+=ye[0]===31&&ye[1]===139?"please make sure the data is not gzipped and that you have configured the relevant header in the server":`got error: ${re.message}`,new Error(Se)}})}loadTile(N){return w._(this,void 0,void 0,function*(){const B=N.uid,K=!!(N&&N.request&&N.request.collectResourceTiming)&&new w.bv(N.request),re=new U(N);this.loading[B]=re;const ye=new AbortController;re.abort=ye;try{const Se=yield this.loadVectorTile(N,ye);if(delete this.loading[B],!Se)return null;const ke=Se.rawData,pe={};Se.expires&&(pe.expires=Se.expires),Se.cacheControl&&(pe.cacheControl=Se.cacheControl);const Fe={};if(K){const Re=K.finish();Re&&(Fe.resourceTiming=JSON.parse(JSON.stringify(Re)))}re.vectorTile=Se.vectorTile;const Ge=re.parse(Se.vectorTile,this.layerIndex,this.availableImages,this.actor);this.loaded[B]=re,this.fetching[B]={rawTileData:ke,cacheControl:pe,resourceTiming:Fe};try{const Re=yield Ge;return w.e({rawTileData:ke.slice(0)},Re,pe,Fe)}finally{delete this.fetching[B]}}catch(Se){throw delete this.loading[B],re.status="done",this.loaded[B]=re,Se}})}reloadTile(N){return w._(this,void 0,void 0,function*(){const B=N.uid;if(!this.loaded||!this.loaded[B])throw new Error("Should not be trying to reload a tile that was never loaded or has been removed");const K=this.loaded[B];if(K.showCollisionBoxes=N.showCollisionBoxes,K.status==="parsing"){const re=yield K.parse(K.vectorTile,this.layerIndex,this.availableImages,this.actor);let ye;if(this.fetching[B]){const{rawTileData:Se,cacheControl:ke,resourceTiming:pe}=this.fetching[B];delete this.fetching[B],ye=w.e({rawTileData:Se.slice(0)},re,ke,pe)}else ye=re;return ye}if(K.status==="done"&&K.vectorTile)return K.parse(K.vectorTile,this.layerIndex,this.availableImages,this.actor)})}abortTile(N){return w._(this,void 0,void 0,function*(){const B=this.loading,K=N.uid;B&&B[K]&&B[K].abort&&(B[K].abort.abort(),delete B[K])})}removeTile(N){return w._(this,void 0,void 0,function*(){this.loaded&&this.loaded[N.uid]&&delete this.loaded[N.uid]})}}class q{constructor(){this.loaded={}}loadTile(N){return w._(this,void 0,void 0,function*(){const{uid:B,encoding:K,rawImageData:re,redFactor:ye,greenFactor:Se,blueFactor:ke,baseShift:pe}=N,Fe=re.width+2,Ge=re.height+2,Re=w.b(re)?new w.R({width:Fe,height:Ge},yield w.bw(re,-1,-1,Fe,Ge)):re,st=new w.bx(B,Re,K,ye,Se,ke,pe);return this.loaded=this.loaded||{},this.loaded[B]=st,st})}removeTile(N){const B=this.loaded,K=N.uid;B&&B[K]&&delete B[K]}}function Ee(ae,N){if(ae.length!==0){ze(ae[0],N);for(var B=1;B<ae.length;B++)ze(ae[B],!N)}}function ze(ae,N){for(var B=0,K=0,re=0,ye=ae.length,Se=ye-1;re<ye;Se=re++){var ke=(ae[re][0]-ae[Se][0])*(ae[Se][1]+ae[re][1]),pe=B+ke;K+=Math.abs(B)>=Math.abs(ke)?B-pe+ke:ke-pe+B,B=pe}B+K>=0!=!!N&&ae.reverse()}var Ne=w.by(function ae(N,B){var K,re=N&&N.type;if(re==="FeatureCollection")for(K=0;K<N.features.length;K++)ae(N.features[K],B);else if(re==="GeometryCollection")for(K=0;K<N.geometries.length;K++)ae(N.geometries[K],B);else if(re==="Feature")ae(N.geometry,B);else if(re==="Polygon")Ee(N.coordinates,B);else if(re==="MultiPolygon")for(K=0;K<N.coordinates.length;K++)Ee(N.coordinates[K],B);return N});const Be=w.bt.VectorTileFeature.prototype.toGeoJSON;var se={exports:{}},ue=w.bz,he=w.bt.VectorTileFeature,De=Ze;function Ze(ae,N){this.options=N||{},this.features=ae,this.length=ae.length}function je(ae,N){this.id=typeof ae.id=="number"?ae.id:void 0,this.type=ae.type,this.rawGeometry=ae.type===1?[ae.geometry]:ae.geometry,this.properties=ae.tags,this.extent=N||4096}Ze.prototype.feature=function(ae){return new je(this.features[ae],this.options.extent)},je.prototype.loadGeometry=function(){var ae=this.rawGeometry;this.geometry=[];for(var N=0;N<ae.length;N++){for(var B=ae[N],K=[],re=0;re<B.length;re++)K.push(new ue(B[re][0],B[re][1]));this.geometry.push(K)}return this.geometry},je.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var ae=this.geometry,N=1/0,B=-1/0,K=1/0,re=-1/0,ye=0;ye<ae.length;ye++)for(var Se=ae[ye],ke=0;ke<Se.length;ke++){var pe=Se[ke];N=Math.min(N,pe.x),B=Math.max(B,pe.x),K=Math.min(K,pe.y),re=Math.max(re,pe.y)}return[N,K,B,re]},je.prototype.toGeoJSON=he.prototype.toGeoJSON;var ve=w.bA,ee=De;function de(ae){var N=new ve;return function(B,K){for(var re in B.layers)K.writeMessage(3,Te,B.layers[re])}(ae,N),N.finish()}function Te(ae,N){var B;N.writeVarintField(15,ae.version||1),N.writeStringField(1,ae.name||""),N.writeVarintField(5,ae.extent||4096);var K={keys:[],values:[],keycache:{},valuecache:{}};for(B=0;B<ae.length;B++)K.feature=ae.feature(B),N.writeMessage(2,Ue,K);var re=K.keys;for(B=0;B<re.length;B++)N.writeStringField(3,re[B]);var ye=K.values;for(B=0;B<ye.length;B++)N.writeMessage(4,Qn,ye[B])}function Ue(ae,N){var B=ae.feature;B.id!==void 0&&N.writeVarintField(1,B.id),N.writeMessage(2,Xe,ae),N.writeVarintField(3,B.type),N.writeMessage(4,qn,B)}function Xe(ae,N){var B=ae.feature,K=ae.keys,re=ae.values,ye=ae.keycache,Se=ae.valuecache;for(var ke in B.properties){var pe=B.properties[ke],Fe=ye[ke];if(pe!==null){Fe===void 0&&(K.push(ke),ye[ke]=Fe=K.length-1),N.writeVarint(Fe);var Ge=typeof pe;Ge!=="string"&&Ge!=="boolean"&&Ge!=="number"&&(pe=JSON.stringify(pe));var Re=Ge+":"+pe,st=Se[Re];st===void 0&&(re.push(pe),Se[Re]=st=re.length-1),N.writeVarint(st)}}}function mt(ae,N){return(N<<3)+(7&ae)}function Kt(ae){return ae<<1^ae>>31}function qn(ae,N){for(var B=ae.loadGeometry(),K=ae.type,re=0,ye=0,Se=B.length,ke=0;ke<Se;ke++){var pe=B[ke],Fe=1;K===1&&(Fe=pe.length),N.writeVarint(mt(1,Fe));for(var Ge=K===3?pe.length-1:pe.length,Re=0;Re<Ge;Re++){Re===1&&K!==1&&N.writeVarint(mt(2,Ge-1));var st=pe[Re].x-re,Mt=pe[Re].y-ye;N.writeVarint(Kt(st)),N.writeVarint(Kt(Mt)),re+=st,ye+=Mt}K===3&&N.writeVarint(mt(7,1))}}function Qn(ae,N){var B=typeof ae;B==="string"?N.writeStringField(1,ae):B==="boolean"?N.writeBooleanField(7,ae):B==="number"&&(ae%1!=0?N.writeDoubleField(3,ae):ae<0?N.writeSVarintField(6,ae):N.writeVarintField(5,ae))}se.exports=de,se.exports.fromVectorTileJs=de,se.exports.fromGeojsonVt=function(ae,N){N=N||{};var B={};for(var K in ae)B[K]=new ee(ae[K].features,N),B[K].name=K,B[K].version=N.version,B[K].extent=N.extent;return de({layers:B})},se.exports.GeoJSONWrapper=ee;var zt=w.by(se.exports);const Je={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:ae=>ae},rt=Math.fround||(Et=new Float32Array(1),ae=>(Et[0]=+ae,Et[0]));var Et;const ht=3,It=5,St=6;class Sn{constructor(N){this.options=Object.assign(Object.create(Je),N),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(N){const{log:B,minZoom:K,maxZoom:re}=this.options;B&&console.time("total time");const ye=`prepare ${N.length} points`;B&&console.time(ye),this.points=N;const Se=[];for(let pe=0;pe<N.length;pe++){const Fe=N[pe];if(!Fe.geometry)continue;const[Ge,Re]=Fe.geometry.coordinates,st=rt(Nn(Ge)),Mt=rt(Zt(Re));Se.push(st,Mt,1/0,pe,-1,1),this.options.reduce&&Se.push(0)}let ke=this.trees[re+1]=this._createTree(Se);B&&console.timeEnd(ye);for(let pe=re;pe>=K;pe--){const Fe=+Date.now();ke=this.trees[pe]=this._createTree(this._cluster(ke,pe)),B&&console.log("z%d: %d clusters in %dms",pe,ke.numItems,+Date.now()-Fe)}return B&&console.timeEnd("total time"),this}getClusters(N,B){let K=((N[0]+180)%360+360)%360-180;const re=Math.max(-90,Math.min(90,N[1]));let ye=N[2]===180?180:((N[2]+180)%360+360)%360-180;const Se=Math.max(-90,Math.min(90,N[3]));if(N[2]-N[0]>=360)K=-180,ye=180;else if(K>ye){const Re=this.getClusters([K,re,180,Se],B),st=this.getClusters([-180,re,ye,Se],B);return Re.concat(st)}const ke=this.trees[this._limitZoom(B)],pe=ke.range(Nn(K),Zt(Se),Nn(ye),Zt(re)),Fe=ke.data,Ge=[];for(const Re of pe){const st=this.stride*Re;Ge.push(Fe[st+It]>1?cn(Fe,st,this.clusterProps):this.points[Fe[st+ht]])}return Ge}getChildren(N){const B=this._getOriginId(N),K=this._getOriginZoom(N),re="No cluster with the specified id.",ye=this.trees[K];if(!ye)throw new Error(re);const Se=ye.data;if(B*this.stride>=Se.length)throw new Error(re);const ke=this.options.radius/(this.options.extent*Math.pow(2,K-1)),pe=ye.within(Se[B*this.stride],Se[B*this.stride+1],ke),Fe=[];for(const Ge of pe){const Re=Ge*this.stride;Se[Re+4]===N&&Fe.push(Se[Re+It]>1?cn(Se,Re,this.clusterProps):this.points[Se[Re+ht]])}if(Fe.length===0)throw new Error(re);return Fe}getLeaves(N,B,K){const re=[];return this._appendLeaves(re,N,B=B||10,K=K||0,0),re}getTile(N,B,K){const re=this.trees[this._limitZoom(N)],ye=Math.pow(2,N),{extent:Se,radius:ke}=this.options,pe=ke/Se,Fe=(K-pe)/ye,Ge=(K+1+pe)/ye,Re={features:[]};return this._addTileFeatures(re.range((B-pe)/ye,Fe,(B+1+pe)/ye,Ge),re.data,B,K,ye,Re),B===0&&this._addTileFeatures(re.range(1-pe/ye,Fe,1,Ge),re.data,ye,K,ye,Re),B===ye-1&&this._addTileFeatures(re.range(0,Fe,pe/ye,Ge),re.data,-1,K,ye,Re),Re.features.length?Re:null}getClusterExpansionZoom(N){let B=this._getOriginZoom(N)-1;for(;B<=this.options.maxZoom;){const K=this.getChildren(N);if(B++,K.length!==1)break;N=K[0].properties.cluster_id}return B}_appendLeaves(N,B,K,re,ye){const Se=this.getChildren(B);for(const ke of Se){const pe=ke.properties;if(pe&&pe.cluster?ye+pe.point_count<=re?ye+=pe.point_count:ye=this._appendLeaves(N,pe.cluster_id,K,re,ye):ye<re?ye++:N.push(ke),N.length===K)break}return ye}_createTree(N){const B=new w.av(N.length/this.stride|0,this.options.nodeSize,Float32Array);for(let K=0;K<N.length;K+=this.stride)B.add(N[K],N[K+1]);return B.finish(),B.data=N,B}_addTileFeatures(N,B,K,re,ye,Se){for(const ke of N){const pe=ke*this.stride,Fe=B[pe+It]>1;let Ge,Re,st;if(Fe)Ge=Cn(B,pe,this.clusterProps),Re=B[pe],st=B[pe+1];else{const In=this.points[B[pe+ht]];Ge=In.properties;const[Jt,kn]=In.geometry.coordinates;Re=Nn(Jt),st=Zt(kn)}const Mt={type:1,geometry:[[Math.round(this.options.extent*(Re*ye-K)),Math.round(this.options.extent*(st*ye-re))]],tags:Ge};let Lt;Lt=Fe||this.options.generateId?B[pe+ht]:this.points[B[pe+ht]].id,Lt!==void 0&&(Mt.id=Lt),Se.features.push(Mt)}}_limitZoom(N){return Math.max(this.options.minZoom,Math.min(Math.floor(+N),this.options.maxZoom+1))}_cluster(N,B){const{radius:K,extent:re,reduce:ye,minPoints:Se}=this.options,ke=K/(re*Math.pow(2,B)),pe=N.data,Fe=[],Ge=this.stride;for(let Re=0;Re<pe.length;Re+=Ge){if(pe[Re+2]<=B)continue;pe[Re+2]=B;const st=pe[Re],Mt=pe[Re+1],Lt=N.within(pe[Re],pe[Re+1],ke),In=pe[Re+It];let Jt=In;for(const kn of Lt){const fn=kn*Ge;pe[fn+2]>B&&(Jt+=pe[fn+It])}if(Jt>In&&Jt>=Se){let kn,fn=st*In,Ar=Mt*In,xr=-1;const on=((Re/Ge|0)<<5)+(B+1)+this.points.length;for(const Gn of Lt){const ur=Gn*Ge;if(pe[ur+2]<=B)continue;pe[ur+2]=B;const Xr=pe[ur+It];fn+=pe[ur]*Xr,Ar+=pe[ur+1]*Xr,pe[ur+4]=on,ye&&(kn||(kn=this._map(pe,Re,!0),xr=this.clusterProps.length,this.clusterProps.push(kn)),ye(kn,this._map(pe,ur)))}pe[Re+4]=on,Fe.push(fn/Jt,Ar/Jt,1/0,on,-1,Jt),ye&&Fe.push(xr)}else{for(let kn=0;kn<Ge;kn++)Fe.push(pe[Re+kn]);if(Jt>1)for(const kn of Lt){const fn=kn*Ge;if(!(pe[fn+2]<=B)){pe[fn+2]=B;for(let Ar=0;Ar<Ge;Ar++)Fe.push(pe[fn+Ar])}}}}return Fe}_getOriginId(N){return N-this.points.length>>5}_getOriginZoom(N){return(N-this.points.length)%32}_map(N,B,K){if(N[B+It]>1){const Se=this.clusterProps[N[B+St]];return K?Object.assign({},Se):Se}const re=this.points[N[B+ht]].properties,ye=this.options.map(re);return K&&ye===re?Object.assign({},ye):ye}}function cn(ae,N,B){return{type:"Feature",id:ae[N+ht],properties:Cn(ae,N,B),geometry:{type:"Point",coordinates:[(K=ae[N],360*(K-.5)),rn(ae[N+1])]}};var K}function Cn(ae,N,B){const K=ae[N+It],re=K>=1e4?`${Math.round(K/1e3)}k`:K>=1e3?Math.round(K/100)/10+"k":K,ye=ae[N+St],Se=ye===-1?{}:Object.assign({},B[ye]);return Object.assign(Se,{cluster:!0,cluster_id:ae[N+ht],point_count:K,point_count_abbreviated:re})}function Nn(ae){return ae/360+.5}function Zt(ae){const N=Math.sin(ae*Math.PI/180),B=.5-.25*Math.log((1+N)/(1-N))/Math.PI;return B<0?0:B>1?1:B}function rn(ae){const N=(180-360*ae)*Math.PI/180;return 360*Math.atan(Math.exp(N))/Math.PI-90}function Zn(ae,N,B,K){let re=K;const ye=N+(B-N>>1);let Se,ke=B-N;const pe=ae[N],Fe=ae[N+1],Ge=ae[B],Re=ae[B+1];for(let st=N+3;st<B;st+=3){const Mt=Qt(ae[st],ae[st+1],pe,Fe,Ge,Re);if(Mt>re)Se=st,re=Mt;else if(Mt===re){const Lt=Math.abs(st-ye);Lt<ke&&(Se=st,ke=Lt)}}re>K&&(Se-N>3&&Zn(ae,N,Se,K),ae[Se+2]=re,B-Se>3&&Zn(ae,Se,B,K))}function Qt(ae,N,B,K,re,ye){let Se=re-B,ke=ye-K;if(Se!==0||ke!==0){const pe=((ae-B)*Se+(N-K)*ke)/(Se*Se+ke*ke);pe>1?(B=re,K=ye):pe>0&&(B+=Se*pe,K+=ke*pe)}return Se=ae-B,ke=N-K,Se*Se+ke*ke}function wn(ae,N,B,K){const re={id:ae??null,type:N,geometry:B,tags:K,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if(N==="Point"||N==="MultiPoint"||N==="LineString")er(re,B);else if(N==="Polygon")er(re,B[0]);else if(N==="MultiLineString")for(const ye of B)er(re,ye);else if(N==="MultiPolygon")for(const ye of B)er(re,ye[0]);return re}function er(ae,N){for(let B=0;B<N.length;B+=3)ae.minX=Math.min(ae.minX,N[B]),ae.minY=Math.min(ae.minY,N[B+1]),ae.maxX=Math.max(ae.maxX,N[B]),ae.maxY=Math.max(ae.maxY,N[B+1])}function sn(ae,N,B,K){if(!N.geometry)return;const re=N.geometry.coordinates;if(re&&re.length===0)return;const ye=N.geometry.type,Se=Math.pow(B.tolerance/((1<<B.maxZoom)*B.extent),2);let ke=[],pe=N.id;if(B.promoteId?pe=N.properties[B.promoteId]:B.generateId&&(pe=K||0),ye==="Point")dn(re,ke);else if(ye==="MultiPoint")for(const Fe of re)dn(Fe,ke);else if(ye==="LineString")Ce(re,ke,Se,!1);else if(ye==="MultiLineString"){if(B.lineMetrics){for(const Fe of re)ke=[],Ce(Fe,ke,Se,!1),ae.push(wn(pe,"LineString",ke,N.properties));return}Fn(re,ke,Se,!1)}else if(ye==="Polygon")Fn(re,ke,Se,!0);else{if(ye!=="MultiPolygon"){if(ye==="GeometryCollection"){for(const Fe of N.geometry.geometries)sn(ae,{id:pe,geometry:Fe,properties:N.properties},B,K);return}throw new Error("Input data is not a valid GeoJSON object.")}for(const Fe of re){const Ge=[];Fn(Fe,Ge,Se,!0),ke.push(Ge)}}ae.push(wn(pe,ye,ke,N.properties))}function dn(ae,N){N.push(bn(ae[0]),Ot(ae[1]),0)}function Ce(ae,N,B,K){let re,ye,Se=0;for(let pe=0;pe<ae.length;pe++){const Fe=bn(ae[pe][0]),Ge=Ot(ae[pe][1]);N.push(Fe,Ge,0),pe>0&&(Se+=K?(re*Ge-Fe*ye)/2:Math.sqrt(Math.pow(Fe-re,2)+Math.pow(Ge-ye,2))),re=Fe,ye=Ge}const ke=N.length-3;N[2]=1,Zn(N,0,ke,B),N[ke+2]=1,N.size=Math.abs(Se),N.start=0,N.end=N.size}function Fn(ae,N,B,K){for(let re=0;re<ae.length;re++){const ye=[];Ce(ae[re],ye,B,K),N.push(ye)}}function bn(ae){return ae/360+.5}function Ot(ae){const N=Math.sin(ae*Math.PI/180),B=.5-.25*Math.log((1+N)/(1-N))/Math.PI;return B<0?0:B>1?1:B}function Yt(ae,N,B,K,re,ye,Se,ke){if(K/=N,ye>=(B/=N)&&Se<K)return ae;if(Se<B||ye>=K)return null;const pe=[];for(const Fe of ae){const Ge=Fe.geometry;let Re=Fe.type;const st=re===0?Fe.minX:Fe.minY,Mt=re===0?Fe.maxX:Fe.maxY;if(st>=B&&Mt<K){pe.push(Fe);continue}if(Mt<B||st>=K)continue;let Lt=[];if(Re==="Point"||Re==="MultiPoint")Tr(Ge,Lt,B,K,re);else if(Re==="LineString")yr(Ge,Lt,B,K,re,!1,ke.lineMetrics);else if(Re==="MultiLineString")vr(Ge,Lt,B,K,re,!1);else if(Re==="Polygon")vr(Ge,Lt,B,K,re,!0);else if(Re==="MultiPolygon")for(const In of Ge){const Jt=[];vr(In,Jt,B,K,re,!0),Jt.length&&Lt.push(Jt)}if(Lt.length){if(ke.lineMetrics&&Re==="LineString"){for(const In of Lt)pe.push(wn(Fe.id,Re,In,Fe.tags));continue}Re!=="LineString"&&Re!=="MultiLineString"||(Lt.length===1?(Re="LineString",Lt=Lt[0]):Re="MultiLineString"),Re!=="Point"&&Re!=="MultiPoint"||(Re=Lt.length===3?"Point":"MultiPoint"),pe.push(wn(Fe.id,Re,Lt,Fe.tags))}}return pe.length?pe:null}function Tr(ae,N,B,K,re){for(let ye=0;ye<ae.length;ye+=3){const Se=ae[ye+re];Se>=B&&Se<=K&&rr(N,ae[ye],ae[ye+1],ae[ye+2])}}function yr(ae,N,B,K,re,ye,Se){let ke=Hr(ae);const pe=re===0?dr:fr;let Fe,Ge,Re=ae.start;for(let Jt=0;Jt<ae.length-3;Jt+=3){const kn=ae[Jt],fn=ae[Jt+1],Ar=ae[Jt+2],xr=ae[Jt+3],on=ae[Jt+4],Gn=re===0?kn:fn,ur=re===0?xr:on;let Xr=!1;Se&&(Fe=Math.sqrt(Math.pow(kn-xr,2)+Math.pow(fn-on,2))),Gn<B?ur>B&&(Ge=pe(ke,kn,fn,xr,on,B),Se&&(ke.start=Re+Fe*Ge)):Gn>K?ur<K&&(Ge=pe(ke,kn,fn,xr,on,K),Se&&(ke.start=Re+Fe*Ge)):rr(ke,kn,fn,Ar),ur<B&&Gn>=B&&(Ge=pe(ke,kn,fn,xr,on,B),Xr=!0),ur>K&&Gn<=K&&(Ge=pe(ke,kn,fn,xr,on,K),Xr=!0),!ye&&Xr&&(Se&&(ke.end=Re+Fe*Ge),N.push(ke),ke=Hr(ae)),Se&&(Re+=Fe)}let st=ae.length-3;const Mt=ae[st],Lt=ae[st+1],In=re===0?Mt:Lt;In>=B&&In<=K&&rr(ke,Mt,Lt,ae[st+2]),st=ke.length-3,ye&&st>=3&&(ke[st]!==ke[0]||ke[st+1]!==ke[1])&&rr(ke,ke[0],ke[1],ke[2]),ke.length&&N.push(ke)}function Hr(ae){const N=[];return N.size=ae.size,N.start=ae.start,N.end=ae.end,N}function vr(ae,N,B,K,re,ye){for(const Se of ae)yr(Se,N,B,K,re,ye,!1)}function rr(ae,N,B,K){ae.push(N,B,K)}function dr(ae,N,B,K,re,ye){const Se=(ye-N)/(K-N);return rr(ae,ye,B+(re-B)*Se,1),Se}function fr(ae,N,B,K,re,ye){const Se=(ye-B)/(re-B);return rr(ae,N+(K-N)*Se,ye,1),Se}function Ke(ae,N){const B=[];for(let K=0;K<ae.length;K++){const re=ae[K],ye=re.type;let Se;if(ye==="Point"||ye==="MultiPoint"||ye==="LineString")Se=hi(re.geometry,N);else if(ye==="MultiLineString"||ye==="Polygon"){Se=[];for(const ke of re.geometry)Se.push(hi(ke,N))}else if(ye==="MultiPolygon"){Se=[];for(const ke of re.geometry){const pe=[];for(const Fe of ke)pe.push(hi(Fe,N));Se.push(pe)}}B.push(wn(re.id,ye,Se,re.tags))}return B}function hi(ae,N){const B=[];B.size=ae.size,ae.start!==void 0&&(B.start=ae.start,B.end=ae.end);for(let K=0;K<ae.length;K+=3)B.push(ae[K]+N,ae[K+1],ae[K+2]);return B}function Lr(ae,N){if(ae.transformed)return ae;const B=1<<ae.z,K=ae.x,re=ae.y;for(const ye of ae.features){const Se=ye.geometry,ke=ye.type;if(ye.geometry=[],ke===1)for(let pe=0;pe<Se.length;pe+=2)ye.geometry.push(jr(Se[pe],Se[pe+1],N,B,K,re));else for(let pe=0;pe<Se.length;pe++){const Fe=[];for(let Ge=0;Ge<Se[pe].length;Ge+=2)Fe.push(jr(Se[pe][Ge],Se[pe][Ge+1],N,B,K,re));ye.geometry.push(Fe)}}return ae.transformed=!0,ae}function jr(ae,N,B,K,re,ye){return[Math.round(B*(ae*K-re)),Math.round(B*(N*K-ye))]}function Pr(ae,N,B,K,re){const ye=N===re.maxZoom?0:re.tolerance/((1<<N)*re.extent),Se={features:[],numPoints:0,numSimplified:0,numFeatures:ae.length,source:null,x:B,y:K,z:N,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const ke of ae)it(Se,ke,ye,re);return Se}function it(ae,N,B,K){const re=N.geometry,ye=N.type,Se=[];if(ae.minX=Math.min(ae.minX,N.minX),ae.minY=Math.min(ae.minY,N.minY),ae.maxX=Math.max(ae.maxX,N.maxX),ae.maxY=Math.max(ae.maxY,N.maxY),ye==="Point"||ye==="MultiPoint")for(let ke=0;ke<re.length;ke+=3)Se.push(re[ke],re[ke+1]),ae.numPoints++,ae.numSimplified++;else if(ye==="LineString")Ht(Se,re,ae,B,!1,!1);else if(ye==="MultiLineString"||ye==="Polygon")for(let ke=0;ke<re.length;ke++)Ht(Se,re[ke],ae,B,ye==="Polygon",ke===0);else if(ye==="MultiPolygon")for(let ke=0;ke<re.length;ke++){const pe=re[ke];for(let Fe=0;Fe<pe.length;Fe++)Ht(Se,pe[Fe],ae,B,!0,Fe===0)}if(Se.length){let ke=N.tags||null;if(ye==="LineString"&&K.lineMetrics){ke={};for(const Fe in N.tags)ke[Fe]=N.tags[Fe];ke.mapbox_clip_start=re.start/re.size,ke.mapbox_clip_end=re.end/re.size}const pe={geometry:Se,type:ye==="Polygon"||ye==="MultiPolygon"?3:ye==="LineString"||ye==="MultiLineString"?2:1,tags:ke};N.id!==null&&(pe.id=N.id),ae.features.push(pe)}}function Ht(ae,N,B,K,re,ye){const Se=K*K;if(K>0&&N.size<(re?Se:K))return void(B.numPoints+=N.length/3);const ke=[];for(let pe=0;pe<N.length;pe+=3)(K===0||N[pe+2]>Se)&&(B.numSimplified++,ke.push(N[pe],N[pe+1])),B.numPoints++;re&&function(pe,Fe){let Ge=0;for(let Re=0,st=pe.length,Mt=st-2;Re<st;Mt=Re,Re+=2)Ge+=(pe[Re]-pe[Mt])*(pe[Re+1]+pe[Mt+1]);if(Ge>0===Fe)for(let Re=0,st=pe.length;Re<st/2;Re+=2){const Mt=pe[Re],Lt=pe[Re+1];pe[Re]=pe[st-2-Re],pe[Re+1]=pe[st-1-Re],pe[st-2-Re]=Mt,pe[st-1-Re]=Lt}}(ke,ye),ae.push(ke)}const Ut={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class di{constructor(N,B){const K=(B=this.options=function(ye,Se){for(const ke in Se)ye[ke]=Se[ke];return ye}(Object.create(Ut),B)).debug;if(K&&console.time("preprocess data"),B.maxZoom<0||B.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(B.promoteId&&B.generateId)throw new Error("promoteId and generateId cannot be used together.");let re=function(ye,Se){const ke=[];if(ye.type==="FeatureCollection")for(let pe=0;pe<ye.features.length;pe++)sn(ke,ye.features[pe],Se,pe);else sn(ke,ye.type==="Feature"?ye:{geometry:ye},Se);return ke}(N,B);this.tiles={},this.tileCoords=[],K&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",B.indexMaxZoom,B.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),re=function(ye,Se){const ke=Se.buffer/Se.extent;let pe=ye;const Fe=Yt(ye,1,-1-ke,ke,0,-1,2,Se),Ge=Yt(ye,1,1-ke,2+ke,0,-1,2,Se);return(Fe||Ge)&&(pe=Yt(ye,1,-ke,1+ke,0,-1,2,Se)||[],Fe&&(pe=Ke(Fe,1).concat(pe)),Ge&&(pe=pe.concat(Ke(Ge,-1)))),pe}(re,B),re.length&&this.splitTile(re,0,0,0),K&&(re.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(N,B,K,re,ye,Se,ke){const pe=[N,B,K,re],Fe=this.options,Ge=Fe.debug;for(;pe.length;){re=pe.pop(),K=pe.pop(),B=pe.pop(),N=pe.pop();const Re=1<<B,st=Gi(B,K,re);let Mt=this.tiles[st];if(!Mt&&(Ge>1&&console.time("creation"),Mt=this.tiles[st]=Pr(N,B,K,re,Fe),this.tileCoords.push({z:B,x:K,y:re}),Ge)){Ge>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",B,K,re,Mt.numFeatures,Mt.numPoints,Mt.numSimplified),console.timeEnd("creation"));const Xr=`z${B}`;this.stats[Xr]=(this.stats[Xr]||0)+1,this.total++}if(Mt.source=N,ye==null){if(B===Fe.indexMaxZoom||Mt.numPoints<=Fe.indexMaxPoints)continue}else{if(B===Fe.maxZoom||B===ye)continue;if(ye!=null){const Xr=ye-B;if(K!==Se>>Xr||re!==ke>>Xr)continue}}if(Mt.source=null,N.length===0)continue;Ge>1&&console.time("clipping");const Lt=.5*Fe.buffer/Fe.extent,In=.5-Lt,Jt=.5+Lt,kn=1+Lt;let fn=null,Ar=null,xr=null,on=null,Gn=Yt(N,Re,K-Lt,K+Jt,0,Mt.minX,Mt.maxX,Fe),ur=Yt(N,Re,K+In,K+kn,0,Mt.minX,Mt.maxX,Fe);N=null,Gn&&(fn=Yt(Gn,Re,re-Lt,re+Jt,1,Mt.minY,Mt.maxY,Fe),Ar=Yt(Gn,Re,re+In,re+kn,1,Mt.minY,Mt.maxY,Fe),Gn=null),ur&&(xr=Yt(ur,Re,re-Lt,re+Jt,1,Mt.minY,Mt.maxY,Fe),on=Yt(ur,Re,re+In,re+kn,1,Mt.minY,Mt.maxY,Fe),ur=null),Ge>1&&console.timeEnd("clipping"),pe.push(fn||[],B+1,2*K,2*re),pe.push(Ar||[],B+1,2*K,2*re+1),pe.push(xr||[],B+1,2*K+1,2*re),pe.push(on||[],B+1,2*K+1,2*re+1)}}getTile(N,B,K){N=+N,B=+B,K=+K;const re=this.options,{extent:ye,debug:Se}=re;if(N<0||N>24)return null;const ke=1<<N,pe=Gi(N,B=B+ke&ke-1,K);if(this.tiles[pe])return Lr(this.tiles[pe],ye);Se>1&&console.log("drilling down to z%d-%d-%d",N,B,K);let Fe,Ge=N,Re=B,st=K;for(;!Fe&&Ge>0;)Ge--,Re>>=1,st>>=1,Fe=this.tiles[Gi(Ge,Re,st)];return Fe&&Fe.source?(Se>1&&(console.log("found parent tile z%d-%d-%d",Ge,Re,st),console.time("drilling down")),this.splitTile(Fe.source,Ge,Re,st,N,B,K),Se>1&&console.timeEnd("drilling down"),this.tiles[pe]?Lr(this.tiles[pe],ye):null):null}}function Gi(ae,N,B){return 32*((1<<ae)*B+N)+ae}function Xt(ae,N){return N?ae.properties[N]:ae.id}function Ys(ae,N){if(ae==null)return!0;if(ae.type==="Feature")return Xt(ae,N)!=null;if(ae.type==="FeatureCollection"){const B=new Set;for(const K of ae.features){const re=Xt(K,N);if(re==null||B.has(re))return!1;B.add(re)}return!0}return!1}function co(ae,N){const B=new Map;if(ae!=null)if(ae.type==="Feature")B.set(Xt(ae,N),ae);else for(const K of ae.features)B.set(Xt(K,N),K);return B}class ho extends W{constructor(){super(...arguments),this._dataUpdateable=new Map}loadVectorTile(N,B){return w._(this,void 0,void 0,function*(){const K=N.tileID.canonical;if(!this._geoJSONIndex)throw new Error("Unable to parse the data into a cluster or geojson");const re=this._geoJSONIndex.getTile(K.z,K.x,K.y);if(!re)return null;const ye=new class{constructor(ke){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=w.X,this.length=ke.length,this._features=ke}feature(ke){return new class{constructor(pe){this._feature=pe,this.extent=w.X,this.type=pe.type,this.properties=pe.tags,"id"in pe&&!isNaN(pe.id)&&(this.id=parseInt(pe.id,10))}loadGeometry(){if(this._feature.type===1){const pe=[];for(const Fe of this._feature.geometry)pe.push([new w.P(Fe[0],Fe[1])]);return pe}{const pe=[];for(const Fe of this._feature.geometry){const Ge=[];for(const Re of Fe)Ge.push(new w.P(Re[0],Re[1]));pe.push(Ge)}return pe}}toGeoJSON(pe,Fe,Ge){return Be.call(this,pe,Fe,Ge)}}(this._features[ke])}}(re.features);let Se=zt(ye);return Se.byteOffset===0&&Se.byteLength===Se.buffer.byteLength||(Se=new Uint8Array(Se)),{vectorTile:ye,rawData:Se.buffer}})}loadData(N){return w._(this,void 0,void 0,function*(){var B;(B=this._pendingRequest)===null||B===void 0||B.abort();const K=!!(N&&N.request&&N.request.collectResourceTiming)&&new w.bv(N.request);this._pendingRequest=new AbortController;try{this._pendingData=this.loadAndProcessGeoJSON(N,this._pendingRequest),this._geoJSONIndex=N.cluster?new Sn(function({superclusterOptions:Se,clusterProperties:ke}){if(!ke||!Se)return Se;const pe={},Fe={},Ge={accumulated:null,zoom:0},Re={properties:null},st=Object.keys(ke);for(const Mt of st){const[Lt,In]=ke[Mt],Jt=w.bC(In),kn=w.bC(typeof Lt=="string"?[Lt,["accumulated"],["get",Mt]]:Lt);pe[Mt]=Jt.value,Fe[Mt]=kn.value}return Se.map=Mt=>{Re.properties=Mt;const Lt={};for(const In of st)Lt[In]=pe[In].evaluate(Ge,Re);return Lt},Se.reduce=(Mt,Lt)=>{Re.properties=Lt;for(const In of st)Ge.accumulated=Mt[In],Mt[In]=Fe[In].evaluate(Ge,Re)},Se}(N)).load((yield this._pendingData).features):(re=yield this._pendingData,new di(re,N.geojsonVtOptions)),this.loaded={};const ye={};if(K){const Se=K.finish();Se&&(ye.resourceTiming={},ye.resourceTiming[N.source]=JSON.parse(JSON.stringify(Se)))}return ye}catch(ye){if(delete this._pendingRequest,w.bB(ye))return{abandoned:!0};throw ye}var re})}getData(){return w._(this,void 0,void 0,function*(){return this._pendingData})}reloadTile(N){const B=this.loaded;return B&&B[N.uid]?super.reloadTile(N):this.loadTile(N)}loadAndProcessGeoJSON(N,B){return w._(this,void 0,void 0,function*(){let K=yield this.loadGeoJSON(N,B);if(delete this._pendingRequest,typeof K!="object")throw new Error(`Input data given to '${N.source}' is not a valid GeoJSON object.`);if(Ne(K,!0),N.filter){const re=w.bC(N.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(re.result==="error")throw new Error(re.value.map(Se=>`${Se.key}: ${Se.message}`).join(", "));K={type:"FeatureCollection",features:K.features.filter(Se=>re.value.evaluate({zoom:0},Se))}}return K})}loadGeoJSON(N,B){return w._(this,void 0,void 0,function*(){const{promoteId:K}=N;if(N.request){const re=yield w.h(N.request,B);return this._dataUpdateable=Ys(re.data,K)?co(re.data,K):void 0,re.data}if(typeof N.data=="string")try{const re=JSON.parse(N.data);return this._dataUpdateable=Ys(re,K)?co(re,K):void 0,re}catch{throw new Error(`Input data given to '${N.source}' is not a valid GeoJSON object.`)}if(!N.dataDiff)throw new Error(`Input data given to '${N.source}' is not a valid GeoJSON object.`);if(!this._dataUpdateable)throw new Error(`Cannot update existing geojson data in ${N.source}`);return function(re,ye,Se){var ke,pe,Fe,Ge;if(ye.removeAll&&re.clear(),ye.remove)for(const Re of ye.remove)re.delete(Re);if(ye.add)for(const Re of ye.add){const st=Xt(Re,Se);st!=null&&re.set(st,Re)}if(ye.update)for(const Re of ye.update){let st=re.get(Re.id);if(st==null)continue;const Mt=!Re.removeAllProperties&&(((ke=Re.removeProperties)===null||ke===void 0?void 0:ke.length)>0||((pe=Re.addOrUpdateProperties)===null||pe===void 0?void 0:pe.length)>0);if((Re.newGeometry||Re.removeAllProperties||Mt)&&(st=Object.assign({},st),re.set(Re.id,st),Mt&&(st.properties=Object.assign({},st.properties))),Re.newGeometry&&(st.geometry=Re.newGeometry),Re.removeAllProperties)st.properties={};else if(((Fe=Re.removeProperties)===null||Fe===void 0?void 0:Fe.length)>0)for(const Lt of Re.removeProperties)Object.prototype.hasOwnProperty.call(st.properties,Lt)&&delete st.properties[Lt];if(((Ge=Re.addOrUpdateProperties)===null||Ge===void 0?void 0:Ge.length)>0)for(const{key:Lt,value:In}of Re.addOrUpdateProperties)st.properties[Lt]=In}}(this._dataUpdateable,N.dataDiff,K),{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())}})}removeSource(N){return w._(this,void 0,void 0,function*(){this._pendingRequest&&this._pendingRequest.abort()})}getClusterExpansionZoom(N){return this._geoJSONIndex.getClusterExpansionZoom(N.clusterId)}getClusterChildren(N){return this._geoJSONIndex.getChildren(N.clusterId)}getClusterLeaves(N){return this._geoJSONIndex.getLeaves(N.clusterId,N.limit,N.offset)}}class Rs{constructor(N){this.self=N,this.actor=new w.F(N),this.layerIndexes={},this.availableImages={},this.workerSources={},this.demWorkerSources={},this.externalWorkerSourceTypes={},this.self.registerWorkerSource=(B,K)=>{if(this.externalWorkerSourceTypes[B])throw new Error(`Worker source with name "${B}" already registered.`);this.externalWorkerSourceTypes[B]=K},this.self.addProtocol=w.bi,this.self.removeProtocol=w.bj,this.self.registerRTLTextPlugin=B=>{if(w.bD.isParsed())throw new Error("RTL text plugin already registered.");w.bD.setMethods(B)},this.actor.registerMessageHandler("LDT",(B,K)=>this._getDEMWorkerSource(B,K.source).loadTile(K)),this.actor.registerMessageHandler("RDT",(B,K)=>w._(this,void 0,void 0,function*(){this._getDEMWorkerSource(B,K.source).removeTile(K)})),this.actor.registerMessageHandler("GCEZ",(B,K)=>w._(this,void 0,void 0,function*(){return this._getWorkerSource(B,K.type,K.source).getClusterExpansionZoom(K)})),this.actor.registerMessageHandler("GCC",(B,K)=>w._(this,void 0,void 0,function*(){return this._getWorkerSource(B,K.type,K.source).getClusterChildren(K)})),this.actor.registerMessageHandler("GCL",(B,K)=>w._(this,void 0,void 0,function*(){return this._getWorkerSource(B,K.type,K.source).getClusterLeaves(K)})),this.actor.registerMessageHandler("LD",(B,K)=>this._getWorkerSource(B,K.type,K.source).loadData(K)),this.actor.registerMessageHandler("GD",(B,K)=>this._getWorkerSource(B,K.type,K.source).getData()),this.actor.registerMessageHandler("LT",(B,K)=>this._getWorkerSource(B,K.type,K.source).loadTile(K)),this.actor.registerMessageHandler("RT",(B,K)=>this._getWorkerSource(B,K.type,K.source).reloadTile(K)),this.actor.registerMessageHandler("AT",(B,K)=>this._getWorkerSource(B,K.type,K.source).abortTile(K)),this.actor.registerMessageHandler("RMT",(B,K)=>this._getWorkerSource(B,K.type,K.source).removeTile(K)),this.actor.registerMessageHandler("RS",(B,K)=>w._(this,void 0,void 0,function*(){if(!this.workerSources[B]||!this.workerSources[B][K.type]||!this.workerSources[B][K.type][K.source])return;const re=this.workerSources[B][K.type][K.source];delete this.workerSources[B][K.type][K.source],re.removeSource!==void 0&&re.removeSource(K)})),this.actor.registerMessageHandler("RM",B=>w._(this,void 0,void 0,function*(){delete this.layerIndexes[B],delete this.availableImages[B],delete this.workerSources[B],delete this.demWorkerSources[B]})),this.actor.registerMessageHandler("SR",(B,K)=>w._(this,void 0,void 0,function*(){this.referrer=K})),this.actor.registerMessageHandler("SRPS",(B,K)=>this._syncRTLPluginState(B,K)),this.actor.registerMessageHandler("IS",(B,K)=>w._(this,void 0,void 0,function*(){this.self.importScripts(K)})),this.actor.registerMessageHandler("SI",(B,K)=>this._setImages(B,K)),this.actor.registerMessageHandler("UL",(B,K)=>w._(this,void 0,void 0,function*(){this._getLayerIndex(B).update(K.layers,K.removedIds)})),this.actor.registerMessageHandler("SL",(B,K)=>w._(this,void 0,void 0,function*(){this._getLayerIndex(B).replace(K)}))}_setImages(N,B){return w._(this,void 0,void 0,function*(){this.availableImages[N]=B;for(const K in this.workerSources[N]){const re=this.workerSources[N][K];for(const ye in re)re[ye].availableImages=B}})}_syncRTLPluginState(N,B){return w._(this,void 0,void 0,function*(){if(w.bD.isParsed())return w.bD.getState();if(B.pluginStatus!=="loading")return w.bD.setState(B),B;const K=B.pluginURL;if(this.self.importScripts(K),w.bD.isParsed()){const re={pluginStatus:"loaded",pluginURL:K};return w.bD.setState(re),re}throw w.bD.setState({pluginStatus:"error",pluginURL:""}),new Error(`RTL Text Plugin failed to import scripts from ${K}`)})}_getAvailableImages(N){let B=this.availableImages[N];return B||(B=[]),B}_getLayerIndex(N){let B=this.layerIndexes[N];return B||(B=this.layerIndexes[N]=new c),B}_getWorkerSource(N,B,K){if(this.workerSources[N]||(this.workerSources[N]={}),this.workerSources[N][B]||(this.workerSources[N][B]={}),!this.workerSources[N][B][K]){const re={sendAsync:(ye,Se)=>(ye.targetMapId=N,this.actor.sendAsync(ye,Se))};switch(B){case"vector":this.workerSources[N][B][K]=new W(re,this._getLayerIndex(N),this._getAvailableImages(N));break;case"geojson":this.workerSources[N][B][K]=new ho(re,this._getLayerIndex(N),this._getAvailableImages(N));break;default:this.workerSources[N][B][K]=new this.externalWorkerSourceTypes[B](re,this._getLayerIndex(N),this._getAvailableImages(N))}}return this.workerSources[N][B][K]}_getDEMWorkerSource(N,B){return this.demWorkerSources[N]||(this.demWorkerSources[N]={}),this.demWorkerSources[N][B]||(this.demWorkerSources[N][B]=new q),this.demWorkerSources[N][B]}}return w.i(self)&&(self.worker=new Rs(self)),Rs}),_("index",["exports","./shared"],function(w,c){var D="4.7.1";let U,J;const W={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frameAsync:y=>new Promise((t,a)=>{const d=requestAnimationFrame(t);y.signal.addEventListener("abort",()=>{cancelAnimationFrame(d),a(c.c())})}),getImageData(y,t=0){return this.getImageCanvasContext(y).getImageData(-t,-t,y.width+2*t,y.height+2*t)},getImageCanvasContext(y){const t=window.document.createElement("canvas"),a=t.getContext("2d",{willReadFrequently:!0});if(!a)throw new Error("failed to create canvas 2d context");return t.width=y.width,t.height=y.height,a.drawImage(y,0,0,y.width,y.height),a},resolveURL:y=>(U||(U=document.createElement("a")),U.href=y,U.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(J==null&&(J=matchMedia("(prefers-reduced-motion: reduce)")),J.matches)}};class q{static testProp(t){if(!q.docStyle)return t[0];for(let a=0;a<t.length;a++)if(t[a]in q.docStyle)return t[a];return t[0]}static create(t,a,d){const f=window.document.createElement(t);return a!==void 0&&(f.className=a),d&&d.appendChild(f),f}static createNS(t,a){return window.document.createElementNS(t,a)}static disableDrag(){q.docStyle&&q.selectProp&&(q.userSelect=q.docStyle[q.selectProp],q.docStyle[q.selectProp]="none")}static enableDrag(){q.docStyle&&q.selectProp&&(q.docStyle[q.selectProp]=q.userSelect)}static setTransform(t,a){t.style[q.transformProp]=a}static addEventListener(t,a,d,f={}){t.addEventListener(a,d,"passive"in f?f:f.capture)}static removeEventListener(t,a,d,f={}){t.removeEventListener(a,d,"passive"in f?f:f.capture)}static suppressClickInternal(t){t.preventDefault(),t.stopPropagation(),window.removeEventListener("click",q.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",q.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",q.suppressClickInternal,!0)},0)}static getScale(t){const a=t.getBoundingClientRect();return{x:a.width/t.offsetWidth||1,y:a.height/t.offsetHeight||1,boundingClientRect:a}}static getPoint(t,a,d){const f=a.boundingClientRect;return new c.P((d.clientX-f.left)/a.x-t.clientLeft,(d.clientY-f.top)/a.y-t.clientTop)}static mousePos(t,a){const d=q.getScale(t);return q.getPoint(t,d,a)}static touchPos(t,a){const d=[],f=q.getScale(t);for(let g=0;g<a.length;g++)d.push(q.getPoint(t,f,a[g]));return d}static mouseButton(t){return t.button}static remove(t){t.parentNode&&t.parentNode.removeChild(t)}}q.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,q.selectProp=q.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),q.transformProp=q.testProp(["transform","WebkitTransform"]);const Ee={supported:!1,testSupport:function(y){!Be&&Ne&&(se?ue(y):ze=y)}};let ze,Ne,Be=!1,se=!1;function ue(y){const t=y.createTexture();y.bindTexture(y.TEXTURE_2D,t);try{if(y.texImage2D(y.TEXTURE_2D,0,y.RGBA,y.RGBA,y.UNSIGNED_BYTE,Ne),y.isContextLost())return;Ee.supported=!0}catch{}y.deleteTexture(t),Be=!0}var he;typeof document<"u"&&(Ne=document.createElement("img"),Ne.onload=()=>{ze&&ue(ze),ze=null,se=!0},Ne.onerror=()=>{Be=!0,ze=null},Ne.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),function(y){let t,a,d,f;y.resetRequestQueue=()=>{t=[],a=0,d=0,f={}},y.addThrottleControl=k=>{const z=d++;return f[z]=k,z},y.removeThrottleControl=k=>{delete f[k],E()},y.getImage=(k,z,L=!0)=>new Promise((O,V)=>{Ee.supported&&(k.headers||(k.headers={}),k.headers.accept="image/webp,*/*"),c.e(k,{type:"image"}),t.push({abortController:z,requestParameters:k,supportImageRefresh:L,state:"queued",onError:X=>{V(X)},onSuccess:X=>{O(X)}}),E()});const g=k=>c._(this,void 0,void 0,function*(){k.state="running";const{requestParameters:z,supportImageRefresh:L,onError:O,onSuccess:V,abortController:X}=k,Q=L===!1&&!c.i(self)&&!c.g(z.url)&&(!z.headers||Object.keys(z.headers).reduce((ce,me)=>ce&&me==="accept",!0));a++;const ie=Q?I(z,X):c.m(z,X);try{const ce=yield ie;delete k.abortController,k.state="completed",ce.data instanceof HTMLImageElement||c.b(ce.data)?V(ce):ce.data&&V({data:yield(le=ce.data,typeof createImageBitmap=="function"?c.d(le):c.f(le)),cacheControl:ce.cacheControl,expires:ce.expires})}catch(ce){delete k.abortController,O(ce)}finally{a--,E()}var le}),E=()=>{const k=(()=>{for(const z of Object.keys(f))if(f[z]())return!0;return!1})()?c.a.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:c.a.MAX_PARALLEL_IMAGE_REQUESTS;for(let z=a;z<k&&t.length>0;z++){const L=t.shift();L.abortController.signal.aborted?z--:g(L)}},I=(k,z)=>new Promise((L,O)=>{const V=new Image,X=k.url,Q=k.credentials;Q&&Q==="include"?V.crossOrigin="use-credentials":(Q&&Q==="same-origin"||!c.s(X))&&(V.crossOrigin="anonymous"),z.signal.addEventListener("abort",()=>{V.src="",O(c.c())}),V.fetchPriority="high",V.onload=()=>{V.onerror=V.onload=null,L({data:V})},V.onerror=()=>{V.onerror=V.onload=null,z.signal.aborted||O(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))},V.src=X})}(he||(he={})),he.resetRequestQueue();class De{constructor(t){this._transformRequestFn=t}transformRequest(t,a){return this._transformRequestFn&&this._transformRequestFn(t,a)||{url:t}}setTransformRequest(t){this._transformRequestFn=t}}function Ze(y){var t=new c.A(3);return t[0]=y[0],t[1]=y[1],t[2]=y[2],t}var je,ve=function(y,t,a){return y[0]=t[0]-a[0],y[1]=t[1]-a[1],y[2]=t[2]-a[2],y};je=new c.A(3),c.A!=Float32Array&&(je[0]=0,je[1]=0,je[2]=0);var ee=function(y){var t=y[0],a=y[1];return t*t+a*a};function de(y){const t=[];if(typeof y=="string")t.push({id:"default",url:y});else if(y&&y.length>0){const a=[];for(const{id:d,url:f}of y){const g=`${d}${f}`;a.indexOf(g)===-1&&(a.push(g),t.push({id:d,url:f}))}}return t}function Te(y,t,a){const d=y.split("?");return d[0]+=`${t}${a}`,d.join("?")}(function(){var y=new c.A(2);c.A!=Float32Array&&(y[0]=0,y[1]=0)})();class Ue{constructor(t,a,d,f){this.context=t,this.format=d,this.texture=t.gl.createTexture(),this.update(a,f)}update(t,a,d){const{width:f,height:g}=t,E=!(this.size&&this.size[0]===f&&this.size[1]===g||d),{context:I}=this,{gl:k}=I;if(this.useMipmap=!!(a&&a.useMipmap),k.bindTexture(k.TEXTURE_2D,this.texture),I.pixelStoreUnpackFlipY.set(!1),I.pixelStoreUnpack.set(1),I.pixelStoreUnpackPremultiplyAlpha.set(this.format===k.RGBA&&(!a||a.premultiply!==!1)),E)this.size=[f,g],t instanceof HTMLImageElement||t instanceof HTMLCanvasElement||t instanceof HTMLVideoElement||t instanceof ImageData||c.b(t)?k.texImage2D(k.TEXTURE_2D,0,this.format,this.format,k.UNSIGNED_BYTE,t):k.texImage2D(k.TEXTURE_2D,0,this.format,f,g,0,this.format,k.UNSIGNED_BYTE,t.data);else{const{x:z,y:L}=d||{x:0,y:0};t instanceof HTMLImageElement||t instanceof HTMLCanvasElement||t instanceof HTMLVideoElement||t instanceof ImageData||c.b(t)?k.texSubImage2D(k.TEXTURE_2D,0,z,L,k.RGBA,k.UNSIGNED_BYTE,t):k.texSubImage2D(k.TEXTURE_2D,0,z,L,f,g,k.RGBA,k.UNSIGNED_BYTE,t.data)}this.useMipmap&&this.isSizePowerOfTwo()&&k.generateMipmap(k.TEXTURE_2D)}bind(t,a,d){const{context:f}=this,{gl:g}=f;g.bindTexture(g.TEXTURE_2D,this.texture),d!==g.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(d=g.LINEAR),t!==this.filter&&(g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MAG_FILTER,t),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MIN_FILTER,d||t),this.filter=t),a!==this.wrap&&(g.texParameteri(g.TEXTURE_2D,g.TEXTURE_WRAP_S,a),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_WRAP_T,a),this.wrap=a)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:t}=this.context;t.deleteTexture(this.texture),this.texture=null}}function Xe(y){const{userImage:t}=y;return!!(t&&t.render&&t.render())&&(y.data.replace(new Uint8Array(t.data.buffer)),!0)}class mt extends c.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new c.R({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(t){if(this.loaded!==t&&(this.loaded=t,t)){for(const{ids:a,promiseResolve:d}of this.requestors)d(this._getImagesForIds(a));this.requestors=[]}}getImage(t){const a=this.images[t];if(a&&!a.data&&a.spriteData){const d=a.spriteData;a.data=new c.R({width:d.width,height:d.height},d.context.getImageData(d.x,d.y,d.width,d.height).data),a.spriteData=null}return a}addImage(t,a){if(this.images[t])throw new Error(`Image id ${t} already exist, use updateImage instead`);this._validate(t,a)&&(this.images[t]=a)}_validate(t,a){let d=!0;const f=a.data||a.spriteData;return this._validateStretch(a.stretchX,f&&f.width)||(this.fire(new c.j(new Error(`Image "${t}" has invalid "stretchX" value`))),d=!1),this._validateStretch(a.stretchY,f&&f.height)||(this.fire(new c.j(new Error(`Image "${t}" has invalid "stretchY" value`))),d=!1),this._validateContent(a.content,a)||(this.fire(new c.j(new Error(`Image "${t}" has invalid "content" value`))),d=!1),d}_validateStretch(t,a){if(!t)return!0;let d=0;for(const f of t){if(f[0]<d||f[1]<f[0]||a<f[1])return!1;d=f[1]}return!0}_validateContent(t,a){if(!t)return!0;if(t.length!==4)return!1;const d=a.spriteData,f=d&&d.width||a.data.width,g=d&&d.height||a.data.height;return!(t[0]<0||f<t[0]||t[1]<0||g<t[1]||t[2]<0||f<t[2]||t[3]<0||g<t[3]||t[2]<t[0]||t[3]<t[1])}updateImage(t,a,d=!0){const f=this.getImage(t);if(d&&(f.data.width!==a.data.width||f.data.height!==a.data.height))throw new Error(`size mismatch between old image (${f.data.width}x${f.data.height}) and new image (${a.data.width}x${a.data.height}).`);a.version=f.version+1,this.images[t]=a,this.updatedImages[t]=!0}removeImage(t){const a=this.images[t];delete this.images[t],delete this.patterns[t],a.userImage&&a.userImage.onRemove&&a.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(t){return new Promise((a,d)=>{let f=!0;if(!this.isLoaded())for(const g of t)this.images[g]||(f=!1);this.isLoaded()||f?a(this._getImagesForIds(t)):this.requestors.push({ids:t,promiseResolve:a})})}_getImagesForIds(t){const a={};for(const d of t){let f=this.getImage(d);f||(this.fire(new c.k("styleimagemissing",{id:d})),f=this.getImage(d)),f?a[d]={data:f.data.clone(),pixelRatio:f.pixelRatio,sdf:f.sdf,version:f.version,stretchX:f.stretchX,stretchY:f.stretchY,content:f.content,textFitWidth:f.textFitWidth,textFitHeight:f.textFitHeight,hasRenderCallback:!!(f.userImage&&f.userImage.render)}:c.w(`Image "${d}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}return a}getPixelSize(){const{width:t,height:a}=this.atlasImage;return{width:t,height:a}}getPattern(t){const a=this.patterns[t],d=this.getImage(t);if(!d)return null;if(a&&a.position.version===d.version)return a.position;if(a)a.position.version=d.version;else{const f={w:d.data.width+2,h:d.data.height+2,x:0,y:0},g=new c.I(f,d);this.patterns[t]={bin:f,position:g}}return this._updatePatternAtlas(),this.patterns[t].position}bind(t){const a=t.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new Ue(t,this.atlasImage,a.RGBA),this.atlasTexture.bind(a.LINEAR,a.CLAMP_TO_EDGE)}_updatePatternAtlas(){const t=[];for(const g in this.patterns)t.push(this.patterns[g].bin);const{w:a,h:d}=c.p(t),f=this.atlasImage;f.resize({width:a||1,height:d||1});for(const g in this.patterns){const{bin:E}=this.patterns[g],I=E.x+1,k=E.y+1,z=this.getImage(g).data,L=z.width,O=z.height;c.R.copy(z,f,{x:0,y:0},{x:I,y:k},{width:L,height:O}),c.R.copy(z,f,{x:0,y:O-1},{x:I,y:k-1},{width:L,height:1}),c.R.copy(z,f,{x:0,y:0},{x:I,y:k+O},{width:L,height:1}),c.R.copy(z,f,{x:L-1,y:0},{x:I-1,y:k},{width:1,height:O}),c.R.copy(z,f,{x:0,y:0},{x:I+L,y:k},{width:1,height:O})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(t){for(const a of t){if(this.callbackDispatchedThisFrame[a])continue;this.callbackDispatchedThisFrame[a]=!0;const d=this.getImage(a);d||c.w(`Image with ID: "${a}" was not found`),Xe(d)&&this.updateImage(a,d)}}}const Kt=1e20;function qn(y,t,a,d,f,g,E,I,k){for(let z=t;z<t+d;z++)Qn(y,a*g+z,g,f,E,I,k);for(let z=a;z<a+f;z++)Qn(y,z*g+t,1,d,E,I,k)}function Qn(y,t,a,d,f,g,E){g[0]=0,E[0]=-Kt,E[1]=Kt,f[0]=y[t];for(let I=1,k=0,z=0;I<d;I++){f[I]=y[t+I*a];const L=I*I;do{const O=g[k];z=(f[I]-f[O]+L-O*O)/(I-O)/2}while(z<=E[k]&&--k>-1);k++,g[k]=I,E[k]=z,E[k+1]=Kt}for(let I=0,k=0;I<d;I++){for(;E[k+1]<I;)k++;const z=g[k],L=I-z;y[t+I*a]=f[z]+L*L}}class zt{constructor(t,a){this.requestManager=t,this.localIdeographFontFamily=a,this.entries={}}setURL(t){this.url=t}getGlyphs(t){return c._(this,void 0,void 0,function*(){const a=[];for(const g in t)for(const E of t[g])a.push(this._getAndCacheGlyphsPromise(g,E));const d=yield Promise.all(a),f={};for(const{stack:g,id:E,glyph:I}of d)f[g]||(f[g]={}),f[g][E]=I&&{id:I.id,bitmap:I.bitmap.clone(),metrics:I.metrics};return f})}_getAndCacheGlyphsPromise(t,a){return c._(this,void 0,void 0,function*(){let d=this.entries[t];d||(d=this.entries[t]={glyphs:{},requests:{},ranges:{}});let f=d.glyphs[a];if(f!==void 0)return{stack:t,id:a,glyph:f};if(f=this._tinySDF(d,t,a),f)return d.glyphs[a]=f,{stack:t,id:a,glyph:f};const g=Math.floor(a/256);if(256*g>65535)throw new Error("glyphs > 65535 not supported");if(d.ranges[g])return{stack:t,id:a,glyph:f};if(!this.url)throw new Error("glyphsUrl is not set");if(!d.requests[g]){const I=zt.loadGlyphRange(t,g,this.url,this.requestManager);d.requests[g]=I}const E=yield d.requests[g];for(const I in E)this._doesCharSupportLocalGlyph(+I)||(d.glyphs[+I]=E[+I]);return d.ranges[g]=!0,{stack:t,id:a,glyph:E[a]||null}})}_doesCharSupportLocalGlyph(t){return!!this.localIdeographFontFamily&&new RegExp("\\p{Ideo}|\\p{sc=Hang}|\\p{sc=Hira}|\\p{sc=Kana}","u").test(String.fromCodePoint(t))}_tinySDF(t,a,d){const f=this.localIdeographFontFamily;if(!f||!this._doesCharSupportLocalGlyph(d))return;let g=t.tinySDF;if(!g){let I="400";/bold/i.test(a)?I="900":/medium/i.test(a)?I="500":/light/i.test(a)&&(I="200"),g=t.tinySDF=new zt.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,fontFamily:f,fontWeight:I})}const E=g.draw(String.fromCharCode(d));return{id:d,bitmap:new c.o({width:E.width||60,height:E.height||60},E.data),metrics:{width:E.glyphWidth/2||24,height:E.glyphHeight/2||24,left:E.glyphLeft/2+.5||0,top:E.glyphTop/2-27.5||-8,advance:E.glyphAdvance/2||24,isDoubleResolution:!0}}}}zt.loadGlyphRange=function(y,t,a,d){return c._(this,void 0,void 0,function*(){const f=256*t,g=f+255,E=d.transformRequest(a.replace("{fontstack}",y).replace("{range}",`${f}-${g}`),"Glyphs"),I=yield c.l(E,new AbortController);if(!I||!I.data)throw new Error(`Could not load glyph range. range: ${t}, ${f}-${g}`);const k={};for(const z of c.n(I.data))k[z.id]=z;return k})},zt.TinySDF=class{constructor({fontSize:y=24,buffer:t=3,radius:a=8,cutoff:d=.25,fontFamily:f="sans-serif",fontWeight:g="normal",fontStyle:E="normal"}={}){this.buffer=t,this.cutoff=d,this.radius=a;const I=this.size=y+4*t,k=this._createCanvas(I),z=this.ctx=k.getContext("2d",{willReadFrequently:!0});z.font=`${E} ${g} ${y}px ${f}`,z.textBaseline="alphabetic",z.textAlign="left",z.fillStyle="black",this.gridOuter=new Float64Array(I*I),this.gridInner=new Float64Array(I*I),this.f=new Float64Array(I),this.z=new Float64Array(I+1),this.v=new Uint16Array(I)}_createCanvas(y){const t=document.createElement("canvas");return t.width=t.height=y,t}draw(y){const{width:t,actualBoundingBoxAscent:a,actualBoundingBoxDescent:d,actualBoundingBoxLeft:f,actualBoundingBoxRight:g}=this.ctx.measureText(y),E=Math.ceil(a),I=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(g-f))),k=Math.min(this.size-this.buffer,E+Math.ceil(d)),z=I+2*this.buffer,L=k+2*this.buffer,O=Math.max(z*L,0),V=new Uint8ClampedArray(O),X={data:V,width:z,height:L,glyphWidth:I,glyphHeight:k,glyphTop:E,glyphLeft:0,glyphAdvance:t};if(I===0||k===0)return X;const{ctx:Q,buffer:ie,gridInner:le,gridOuter:ce}=this;Q.clearRect(ie,ie,I,k),Q.fillText(y,ie,ie+E);const me=Q.getImageData(ie,ie,I,k);ce.fill(Kt,0,O),le.fill(0,0,O);for(let te=0;te<k;te++)for(let xe=0;xe<I;xe++){const be=me.data[4*(te*I+xe)+3]/255;if(be===0)continue;const Me=(te+ie)*z+xe+ie;if(be===1)ce[Me]=0,le[Me]=Kt;else{const qe=.5-be;ce[Me]=qe>0?qe*qe:0,le[Me]=qe<0?qe*qe:0}}qn(ce,0,0,z,L,z,this.f,this.v,this.z),qn(le,ie,ie,I,k,z,this.f,this.v,this.z);for(let te=0;te<O;te++){const xe=Math.sqrt(ce[te])-Math.sqrt(le[te]);V[te]=Math.round(255-255*(xe/this.radius+this.cutoff))}return X}};class Je{constructor(){this.specification=c.v.light.position}possiblyEvaluate(t,a){return c.x(t.expression.evaluate(a))}interpolate(t,a,d){return{x:c.y.number(t.x,a.x,d),y:c.y.number(t.y,a.y,d),z:c.y.number(t.z,a.z,d)}}}let rt;class Et extends c.E{constructor(t){super(),rt=rt||new c.q({anchor:new c.D(c.v.light.anchor),position:new Je,color:new c.D(c.v.light.color),intensity:new c.D(c.v.light.intensity)}),this._transitionable=new c.T(rt),this.setLight(t),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(t,a={}){if(!this._validate(c.r,t,a))for(const d in t){const f=t[d];d.endsWith("-transition")?this._transitionable.setTransition(d.slice(0,-11),f):this._transitionable.setValue(d,f)}}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t)}_validate(t,a,d){return(!d||d.validate!==!1)&&c.t(this,t.call(c.u,{value:a,style:{glyphs:!0,sprite:!0},styleSpec:c.v}))}}const ht=new c.q({"sky-color":new c.D(c.v.sky["sky-color"]),"horizon-color":new c.D(c.v.sky["horizon-color"]),"fog-color":new c.D(c.v.sky["fog-color"]),"fog-ground-blend":new c.D(c.v.sky["fog-ground-blend"]),"horizon-fog-blend":new c.D(c.v.sky["horizon-fog-blend"]),"sky-horizon-blend":new c.D(c.v.sky["sky-horizon-blend"]),"atmosphere-blend":new c.D(c.v.sky["atmosphere-blend"])});class It extends c.E{constructor(t){super(),this._transitionable=new c.T(ht),this.setSky(t),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new c.z(0))}setSky(t,a={}){if(!this._validate(c.B,t,a)){t||(t={"sky-color":"transparent","horizon-color":"transparent","fog-color":"transparent","fog-ground-blend":1,"atmosphere-blend":0});for(const d in t){const f=t[d];d.endsWith("-transition")?this._transitionable.setTransition(d.slice(0,-11),f):this._transitionable.setValue(d,f)}}}getSky(){return this._transitionable.serialize()}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t)}_validate(t,a,d={}){return(d==null?void 0:d.validate)!==!1&&c.t(this,t.call(c.u,c.e({value:a,style:{glyphs:!0,sprite:!0},styleSpec:c.v})))}calculateFogBlendOpacity(t){return t<60?0:t<70?(t-60)/10:1}}class St{constructor(t,a){this.width=t,this.height=a,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(t,a){const d=t.join(",")+String(a);return this.dashEntry[d]||(this.dashEntry[d]=this.addDash(t,a)),this.dashEntry[d]}getDashRanges(t,a,d){const f=[];let g=t.length%2==1?-t[t.length-1]*d:0,E=t[0]*d,I=!0;f.push({left:g,right:E,isDash:I,zeroLength:t[0]===0});let k=t[0];for(let z=1;z<t.length;z++){I=!I;const L=t[z];g=k*d,k+=L,E=k*d,f.push({left:g,right:E,isDash:I,zeroLength:L===0})}return f}addRoundDash(t,a,d){const f=a/2;for(let g=-d;g<=d;g++){const E=this.width*(this.nextRow+d+g);let I=0,k=t[I];for(let z=0;z<this.width;z++){z/k.right>1&&(k=t[++I]);const L=Math.abs(z-k.left),O=Math.abs(z-k.right),V=Math.min(L,O);let X;const Q=g/d*(f+1);if(k.isDash){const ie=f-Math.abs(Q);X=Math.sqrt(V*V+ie*ie)}else X=f-Math.sqrt(V*V+Q*Q);this.data[E+z]=Math.max(0,Math.min(255,X+128))}}}addRegularDash(t){for(let I=t.length-1;I>=0;--I){const k=t[I],z=t[I+1];k.zeroLength?t.splice(I,1):z&&z.isDash===k.isDash&&(z.left=k.left,t.splice(I,1))}const a=t[0],d=t[t.length-1];a.isDash===d.isDash&&(a.left=d.left-this.width,d.right=a.right+this.width);const f=this.width*this.nextRow;let g=0,E=t[g];for(let I=0;I<this.width;I++){I/E.right>1&&(E=t[++g]);const k=Math.abs(I-E.left),z=Math.abs(I-E.right),L=Math.min(k,z);this.data[f+I]=Math.max(0,Math.min(255,(E.isDash?L:-L)+128))}}addDash(t,a){const d=a?7:0,f=2*d+1;if(this.nextRow+f>this.height)return c.w("LineAtlas out of space"),null;let g=0;for(let I=0;I<t.length;I++)g+=t[I];if(g!==0){const I=this.width/g,k=this.getDashRanges(t,this.width,I);a?this.addRoundDash(k,I,d):this.addRegularDash(k)}const E={y:(this.nextRow+d+.5)/this.height,height:2*d/this.height,width:g};return this.nextRow+=f,this.dirty=!0,E}bind(t){const a=t.gl;this.texture?(a.bindTexture(a.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,a.texSubImage2D(a.TEXTURE_2D,0,0,0,this.width,this.height,a.ALPHA,a.UNSIGNED_BYTE,this.data))):(this.texture=a.createTexture(),a.bindTexture(a.TEXTURE_2D,this.texture),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.REPEAT),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.REPEAT),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.LINEAR),a.texImage2D(a.TEXTURE_2D,0,a.ALPHA,this.width,this.height,0,a.ALPHA,a.UNSIGNED_BYTE,this.data))}}const Sn="maplibre_preloaded_worker_pool";class cn{constructor(){this.active={}}acquire(t){if(!this.workers)for(this.workers=[];this.workers.length<cn.workerCount;)this.workers.push(new Worker(c.a.WORKER_URL));return this.active[t]=!0,this.workers.slice()}release(t){delete this.active[t],this.numActive()===0&&(this.workers.forEach(a=>{a.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[Sn]}numActive(){return Object.keys(this.active).length}}const Cn=Math.floor(W.hardwareConcurrency/2);let Nn,Zt;function rn(){return Nn||(Nn=new cn),Nn}cn.workerCount=c.C(globalThis)?Math.max(Math.min(Cn,3),1):1;class Zn{constructor(t,a){this.workerPool=t,this.actors=[],this.currentActor=0,this.id=a;const d=this.workerPool.acquire(a);for(let f=0;f<d.length;f++){const g=new c.F(d[f],a);g.name=`Worker ${f}`,this.actors.push(g)}if(!this.actors.length)throw new Error("No actors found")}broadcast(t,a){const d=[];for(const f of this.actors)d.push(f.sendAsync({type:t,data:a}));return Promise.all(d)}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(t=!0){this.actors.forEach(a=>{a.remove()}),this.actors=[],t&&this.workerPool.release(this.id)}registerMessageHandler(t,a){for(const d of this.actors)d.registerMessageHandler(t,a)}}function Qt(){return Zt||(Zt=new Zn(rn(),c.G),Zt.registerMessageHandler("GR",(y,t,a)=>c.m(t,a))),Zt}function wn(y,t){const a=c.H();return c.J(a,a,[1,1,0]),c.K(a,a,[.5*y.width,.5*y.height,1]),c.L(a,a,y.calculatePosMatrix(t.toUnwrapped()))}function er(y,t,a,d,f,g){const E=function(O,V,X){if(O)for(const Q of O){const ie=V[Q];if(ie&&ie.source===X&&ie.type==="fill-extrusion")return!0}else for(const Q in V){const ie=V[Q];if(ie.source===X&&ie.type==="fill-extrusion")return!0}return!1}(f&&f.layers,t,y.id),I=g.maxPitchScaleFactor(),k=y.tilesIn(d,I,E);k.sort(sn);const z=[];for(const O of k)z.push({wrappedTileID:O.tileID.wrapped().key,queryResults:O.tile.queryRenderedFeatures(t,a,y._state,O.queryGeometry,O.cameraQueryGeometry,O.scale,f,g,I,wn(y.transform,O.tileID))});const L=function(O){const V={},X={};for(const Q of O){const ie=Q.queryResults,le=Q.wrappedTileID,ce=X[le]=X[le]||{};for(const me in ie){const te=ie[me],xe=ce[me]=ce[me]||{},be=V[me]=V[me]||[];for(const Me of te)xe[Me.featureIndex]||(xe[Me.featureIndex]=!0,be.push(Me))}}return V}(z);for(const O in L)L[O].forEach(V=>{const X=V.feature,Q=y.getFeatureState(X.layer["source-layer"],X.id);X.source=X.layer.source,X.layer["source-layer"]&&(X.sourceLayer=X.layer["source-layer"]),X.state=Q});return L}function sn(y,t){const a=y.tileID,d=t.tileID;return a.overscaledZ-d.overscaledZ||a.canonical.y-d.canonical.y||a.wrap-d.wrap||a.canonical.x-d.canonical.x}function dn(y,t,a){return c._(this,void 0,void 0,function*(){let d=y;if(y.url?d=(yield c.h(t.transformRequest(y.url,"Source"),a)).data:yield W.frameAsync(a),!d)return null;const f=c.M(c.e(d,y),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);return"vector_layers"in d&&d.vector_layers&&(f.vectorLayerIds=d.vector_layers.map(g=>g.id)),f})}class Ce{constructor(t,a){t&&(a?this.setSouthWest(t).setNorthEast(a):Array.isArray(t)&&(t.length===4?this.setSouthWest([t[0],t[1]]).setNorthEast([t[2],t[3]]):this.setSouthWest(t[0]).setNorthEast(t[1])))}setNorthEast(t){return this._ne=t instanceof c.N?new c.N(t.lng,t.lat):c.N.convert(t),this}setSouthWest(t){return this._sw=t instanceof c.N?new c.N(t.lng,t.lat):c.N.convert(t),this}extend(t){const a=this._sw,d=this._ne;let f,g;if(t instanceof c.N)f=t,g=t;else{if(!(t instanceof Ce))return Array.isArray(t)?t.length===4||t.every(Array.isArray)?this.extend(Ce.convert(t)):this.extend(c.N.convert(t)):t&&("lng"in t||"lon"in t)&&"lat"in t?this.extend(c.N.convert(t)):this;if(f=t._sw,g=t._ne,!f||!g)return this}return a||d?(a.lng=Math.min(f.lng,a.lng),a.lat=Math.min(f.lat,a.lat),d.lng=Math.max(g.lng,d.lng),d.lat=Math.max(g.lat,d.lat)):(this._sw=new c.N(f.lng,f.lat),this._ne=new c.N(g.lng,g.lat)),this}getCenter(){return new c.N((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new c.N(this.getWest(),this.getNorth())}getSouthEast(){return new c.N(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(t){const{lng:a,lat:d}=c.N.convert(t);let f=this._sw.lng<=a&&a<=this._ne.lng;return this._sw.lng>this._ne.lng&&(f=this._sw.lng>=a&&a>=this._ne.lng),this._sw.lat<=d&&d<=this._ne.lat&&f}static convert(t){return t instanceof Ce?t:t&&new Ce(t)}static fromLngLat(t,a=0){const d=360*a/40075017,f=d/Math.cos(Math.PI/180*t.lat);return new Ce(new c.N(t.lng-f,t.lat-d),new c.N(t.lng+f,t.lat+d))}adjustAntiMeridian(){const t=new c.N(this._sw.lng,this._sw.lat),a=new c.N(this._ne.lng,this._ne.lat);return new Ce(t,t.lng>a.lng?new c.N(a.lng+360,a.lat):a)}}class Fn{constructor(t,a,d){this.bounds=Ce.convert(this.validateBounds(t)),this.minzoom=a||0,this.maxzoom=d||24}validateBounds(t){return Array.isArray(t)&&t.length===4?[Math.max(-180,t[0]),Math.max(-90,t[1]),Math.min(180,t[2]),Math.min(90,t[3])]:[-180,-90,180,90]}contains(t){const a=Math.pow(2,t.z),d=Math.floor(c.O(this.bounds.getWest())*a),f=Math.floor(c.Q(this.bounds.getNorth())*a),g=Math.ceil(c.O(this.bounds.getEast())*a),E=Math.ceil(c.Q(this.bounds.getSouth())*a);return t.x>=d&&t.x<g&&t.y>=f&&t.y<E}}class bn extends c.E{constructor(t,a,d,f){if(super(),this.id=t,this.dispatcher=d,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,c.e(this,c.M(a,["url","scheme","tileSize","promoteId"])),this._options=c.e({type:"vector"},a),this._collectResourceTiming=a.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(f)}load(){return c._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new c.k("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const t=yield dn(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),t&&(c.e(this,t),t.bounds&&(this.tileBounds=new Fn(t.bounds,this.minzoom,this.maxzoom)),this.fire(new c.k("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new c.k("data",{dataType:"source",sourceDataType:"content"})))}catch(t){this._tileJSONRequest=null,this.fire(new c.j(t))}})}loaded(){return this._loaded}hasTile(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)}onAdd(t){this.map=t,this.load()}setSourceProperty(t){this._tileJSONRequest&&this._tileJSONRequest.abort(),t(),this.load()}setTiles(t){return this.setSourceProperty(()=>{this._options.tiles=t}),this}setUrl(t){return this.setSourceProperty(()=>{this.url=t,this._options.url=t}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}serialize(){return c.e({},this._options)}loadTile(t){return c._(this,void 0,void 0,function*(){const a=t.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),d={request:this.map._requestManager.transformRequest(a,"Tile"),uid:t.uid,tileID:t.tileID,zoom:t.tileID.overscaledZ,tileSize:this.tileSize*t.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};d.request.collectResourceTiming=this._collectResourceTiming;let f="RT";if(t.actor&&t.state!=="expired"){if(t.state==="loading")return new Promise((g,E)=>{t.reloadPromise={resolve:g,reject:E}})}else t.actor=this.dispatcher.getActor(),f="LT";t.abortController=new AbortController;try{const g=yield t.actor.sendAsync({type:f,data:d},t.abortController);if(delete t.abortController,t.aborted)return;this._afterTileLoadWorkerResponse(t,g)}catch(g){if(delete t.abortController,t.aborted)return;if(g&&g.status!==404)throw g;this._afterTileLoadWorkerResponse(t,null)}})}_afterTileLoadWorkerResponse(t,a){if(a&&a.resourceTiming&&(t.resourceTiming=a.resourceTiming),a&&this.map._refreshExpiredTiles&&t.setExpiryData(a),t.loadVectorData(a,this.map.painter),t.reloadPromise){const d=t.reloadPromise;t.reloadPromise=null,this.loadTile(t).then(d.resolve).catch(d.reject)}}abortTile(t){return c._(this,void 0,void 0,function*(){t.abortController&&(t.abortController.abort(),delete t.abortController),t.actor&&(yield t.actor.sendAsync({type:"AT",data:{uid:t.uid,type:this.type,source:this.id}}))})}unloadTile(t){return c._(this,void 0,void 0,function*(){t.unloadVectorData(),t.actor&&(yield t.actor.sendAsync({type:"RMT",data:{uid:t.uid,type:this.type,source:this.id}}))})}hasTransition(){return!1}}class Ot extends c.E{constructor(t,a,d,f){super(),this.id=t,this.dispatcher=d,this.setEventedParent(f),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=c.e({type:"raster"},a),c.e(this,c.M(a,["url","scheme","tileSize"]))}load(){return c._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new c.k("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const t=yield dn(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,t&&(c.e(this,t),t.bounds&&(this.tileBounds=new Fn(t.bounds,this.minzoom,this.maxzoom)),this.fire(new c.k("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new c.k("data",{dataType:"source",sourceDataType:"content"})))}catch(t){this._tileJSONRequest=null,this.fire(new c.j(t))}})}loaded(){return this._loaded}onAdd(t){this.map=t,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}setSourceProperty(t){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null),t(),this.load()}setTiles(t){return this.setSourceProperty(()=>{this._options.tiles=t}),this}setUrl(t){return this.setSourceProperty(()=>{this.url=t,this._options.url=t}),this}serialize(){return c.e({},this._options)}hasTile(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)}loadTile(t){return c._(this,void 0,void 0,function*(){const a=t.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);t.abortController=new AbortController;try{const d=yield he.getImage(this.map._requestManager.transformRequest(a,"Tile"),t.abortController,this.map._refreshExpiredTiles);if(delete t.abortController,t.aborted)return void(t.state="unloaded");if(d&&d.data){this.map._refreshExpiredTiles&&d.cacheControl&&d.expires&&t.setExpiryData({cacheControl:d.cacheControl,expires:d.expires});const f=this.map.painter.context,g=f.gl,E=d.data;t.texture=this.map.painter.getTileTexture(E.width),t.texture?t.texture.update(E,{useMipmap:!0}):(t.texture=new Ue(f,E,g.RGBA,{useMipmap:!0}),t.texture.bind(g.LINEAR,g.CLAMP_TO_EDGE,g.LINEAR_MIPMAP_NEAREST)),t.state="loaded"}}catch(d){if(delete t.abortController,t.aborted)t.state="unloaded";else if(d)throw t.state="errored",d}})}abortTile(t){return c._(this,void 0,void 0,function*(){t.abortController&&(t.abortController.abort(),delete t.abortController)})}unloadTile(t){return c._(this,void 0,void 0,function*(){t.texture&&this.map.painter.saveTileTexture(t.texture)})}hasTransition(){return!1}}class Yt extends Ot{constructor(t,a,d,f){super(t,a,d,f),this.type="raster-dem",this.maxzoom=22,this._options=c.e({type:"raster-dem"},a),this.encoding=a.encoding||"mapbox",this.redFactor=a.redFactor,this.greenFactor=a.greenFactor,this.blueFactor=a.blueFactor,this.baseShift=a.baseShift}loadTile(t){return c._(this,void 0,void 0,function*(){const a=t.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),d=this.map._requestManager.transformRequest(a,"Tile");t.neighboringTiles=this._getNeighboringTiles(t.tileID),t.abortController=new AbortController;try{const f=yield he.getImage(d,t.abortController,this.map._refreshExpiredTiles);if(delete t.abortController,t.aborted)return void(t.state="unloaded");if(f&&f.data){const g=f.data;this.map._refreshExpiredTiles&&f.cacheControl&&f.expires&&t.setExpiryData({cacheControl:f.cacheControl,expires:f.expires});const E=c.b(g)&&c.U()?g:yield this.readImageNow(g),I={type:this.type,uid:t.uid,source:this.id,rawImageData:E,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};if(!t.actor||t.state==="expired"){t.actor=this.dispatcher.getActor();const k=yield t.actor.sendAsync({type:"LDT",data:I});t.dem=k,t.needsHillshadePrepare=!0,t.needsTerrainPrepare=!0,t.state="loaded"}}}catch(f){if(delete t.abortController,t.aborted)t.state="unloaded";else if(f)throw t.state="errored",f}})}readImageNow(t){return c._(this,void 0,void 0,function*(){if(typeof VideoFrame<"u"&&c.V()){const a=t.width+2,d=t.height+2;try{return new c.R({width:a,height:d},yield c.W(t,-1,-1,a,d))}catch{}}return W.getImageData(t,1)})}_getNeighboringTiles(t){const a=t.canonical,d=Math.pow(2,a.z),f=(a.x-1+d)%d,g=a.x===0?t.wrap-1:t.wrap,E=(a.x+1+d)%d,I=a.x+1===d?t.wrap+1:t.wrap,k={};return k[new c.S(t.overscaledZ,g,a.z,f,a.y).key]={backfilled:!1},k[new c.S(t.overscaledZ,I,a.z,E,a.y).key]={backfilled:!1},a.y>0&&(k[new c.S(t.overscaledZ,g,a.z,f,a.y-1).key]={backfilled:!1},k[new c.S(t.overscaledZ,t.wrap,a.z,a.x,a.y-1).key]={backfilled:!1},k[new c.S(t.overscaledZ,I,a.z,E,a.y-1).key]={backfilled:!1}),a.y+1<d&&(k[new c.S(t.overscaledZ,g,a.z,f,a.y+1).key]={backfilled:!1},k[new c.S(t.overscaledZ,t.wrap,a.z,a.x,a.y+1).key]={backfilled:!1},k[new c.S(t.overscaledZ,I,a.z,E,a.y+1).key]={backfilled:!1}),k}unloadTile(t){return c._(this,void 0,void 0,function*(){t.demTexture&&this.map.painter.saveTileTexture(t.demTexture),t.fbo&&(t.fbo.destroy(),delete t.fbo),t.dem&&delete t.dem,delete t.neighboringTiles,t.state="unloaded",t.actor&&(yield t.actor.sendAsync({type:"RDT",data:{type:this.type,uid:t.uid,source:this.id}}))})}}class Tr extends c.E{constructor(t,a,d,f){super(),this.id=t,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=d.getActor(),this.setEventedParent(f),this._data=a.data,this._options=c.e({},a),this._collectResourceTiming=a.collectResourceTiming,a.maxzoom!==void 0&&(this.maxzoom=a.maxzoom),a.type&&(this.type=a.type),a.attribution&&(this.attribution=a.attribution),this.promoteId=a.promoteId;const g=c.X/this.tileSize;a.clusterMaxZoom!==void 0&&this.maxzoom<=a.clusterMaxZoom&&c.w(`The maxzoom value "${this.maxzoom}" is expected to be greater than the clusterMaxZoom value "${a.clusterMaxZoom}".`),this.workerOptions=c.e({source:this.id,cluster:a.cluster||!1,geojsonVtOptions:{buffer:(a.buffer!==void 0?a.buffer:128)*g,tolerance:(a.tolerance!==void 0?a.tolerance:.375)*g,extent:c.X,maxZoom:this.maxzoom,lineMetrics:a.lineMetrics||!1,generateId:a.generateId||!1},superclusterOptions:{maxZoom:a.clusterMaxZoom!==void 0?a.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,a.clusterMinPoints||2),extent:c.X,radius:(a.clusterRadius||50)*g,log:!1,generateId:a.generateId||!1},clusterProperties:a.clusterProperties,filter:a.filter},a.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}load(){return c._(this,void 0,void 0,function*(){yield this._updateWorkerData()})}onAdd(t){this.map=t,this.load()}setData(t){return this._data=t,this._updateWorkerData(),this}updateData(t){return this._updateWorkerData(t),this}getData(){return c._(this,void 0,void 0,function*(){const t=c.e({type:this.type},this.workerOptions);return this.actor.sendAsync({type:"GD",data:t})})}setClusterOptions(t){return this.workerOptions.cluster=t.cluster,t&&(t.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=t.clusterRadius),t.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=t.clusterMaxZoom)),this._updateWorkerData(),this}getClusterExpansionZoom(t){return this.actor.sendAsync({type:"GCEZ",data:{type:this.type,clusterId:t,source:this.id}})}getClusterChildren(t){return this.actor.sendAsync({type:"GCC",data:{type:this.type,clusterId:t,source:this.id}})}getClusterLeaves(t,a,d){return this.actor.sendAsync({type:"GCL",data:{type:this.type,source:this.id,clusterId:t,limit:a,offset:d}})}_updateWorkerData(t){return c._(this,void 0,void 0,function*(){const a=c.e({type:this.type},this.workerOptions);t?a.dataDiff=t:typeof this._data=="string"?(a.request=this.map._requestManager.transformRequest(W.resolveURL(this._data),"Source"),a.request.collectResourceTiming=this._collectResourceTiming):a.data=JSON.stringify(this._data),this._pendingLoads++,this.fire(new c.k("dataloading",{dataType:"source"}));try{const d=yield this.actor.sendAsync({type:"LD",data:a});if(this._pendingLoads--,this._removed||d.abandoned)return void this.fire(new c.k("dataabort",{dataType:"source"}));let f=null;d.resourceTiming&&d.resourceTiming[this.id]&&(f=d.resourceTiming[this.id].slice(0));const g={dataType:"source"};this._collectResourceTiming&&f&&f.length>0&&c.e(g,{resourceTiming:f}),this.fire(new c.k("data",Object.assign(Object.assign({},g),{sourceDataType:"metadata"}))),this.fire(new c.k("data",Object.assign(Object.assign({},g),{sourceDataType:"content"})))}catch(d){if(this._pendingLoads--,this._removed)return void this.fire(new c.k("dataabort",{dataType:"source"}));this.fire(new c.j(d))}})}loaded(){return this._pendingLoads===0}loadTile(t){return c._(this,void 0,void 0,function*(){const a=t.actor?"RT":"LT";t.actor=this.actor;const d={type:this.type,uid:t.uid,tileID:t.tileID,zoom:t.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};t.abortController=new AbortController;const f=yield this.actor.sendAsync({type:a,data:d},t.abortController);delete t.abortController,t.unloadVectorData(),t.aborted||t.loadVectorData(f,this.map.painter,a==="RT")})}abortTile(t){return c._(this,void 0,void 0,function*(){t.abortController&&(t.abortController.abort(),delete t.abortController),t.aborted=!0})}unloadTile(t){return c._(this,void 0,void 0,function*(){t.unloadVectorData(),yield this.actor.sendAsync({type:"RMT",data:{uid:t.uid,type:this.type,source:this.id}})})}onRemove(){this._removed=!0,this.actor.sendAsync({type:"RS",data:{type:this.type,source:this.id}})}serialize(){return c.e({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}}var yr=c.Y([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class Hr extends c.E{constructor(t,a,d,f){super(),this.id=t,this.dispatcher=d,this.coordinates=a.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(f),this.options=a}load(t){return c._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new c.k("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=new AbortController;try{const a=yield he.getImage(this.map._requestManager.transformRequest(this.url,"Image"),this._request);this._request=null,this._loaded=!0,a&&a.data&&(this.image=a.data,t&&(this.coordinates=t),this._finishLoading())}catch(a){this._request=null,this._loaded=!0,this.fire(new c.j(a))}})}loaded(){return this._loaded}updateImage(t){return t.url?(this._request&&(this._request.abort(),this._request=null),this.options.url=t.url,this.load(t.coordinates).finally(()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new c.k("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(t){this.map=t,this.load()}onRemove(){this._request&&(this._request.abort(),this._request=null)}setCoordinates(t){this.coordinates=t;const a=t.map(c.Z.fromLngLat);this.tileID=function(f){let g=1/0,E=1/0,I=-1/0,k=-1/0;for(const V of f)g=Math.min(g,V.x),E=Math.min(E,V.y),I=Math.max(I,V.x),k=Math.max(k,V.y);const z=Math.max(I-g,k-E),L=Math.max(0,Math.floor(-Math.log(z)/Math.LN2)),O=Math.pow(2,L);return new c.a1(L,Math.floor((g+I)/2*O),Math.floor((E+k)/2*O))}(a),this.minzoom=this.maxzoom=this.tileID.z;const d=a.map(f=>this.tileID.getTilePoint(f)._round());return this._boundsArray=new c.$,this._boundsArray.emplaceBack(d[0].x,d[0].y,0,0),this._boundsArray.emplaceBack(d[1].x,d[1].y,c.X,0),this._boundsArray.emplaceBack(d[3].x,d[3].y,0,c.X),this._boundsArray.emplaceBack(d[2].x,d[2].y,c.X,c.X),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new c.k("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const t=this.map.painter.context,a=t.gl;this.boundsBuffer||(this.boundsBuffer=t.createVertexBuffer(this._boundsArray,yr.members)),this.boundsSegments||(this.boundsSegments=c.a0.simpleSegment(0,0,4,2)),this.texture||(this.texture=new Ue(t,this.image,a.RGBA),this.texture.bind(a.LINEAR,a.CLAMP_TO_EDGE));let d=!1;for(const f in this.tiles){const g=this.tiles[f];g.state!=="loaded"&&(g.state="loaded",g.texture=this.texture,d=!0)}d&&this.fire(new c.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}loadTile(t){return c._(this,void 0,void 0,function*(){this.tileID&&this.tileID.equals(t.tileID.canonical)?(this.tiles[String(t.tileID.wrap)]=t,t.buckets={}):t.state="errored"})}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}class vr extends Hr{constructor(t,a,d,f){super(t,a,d,f),this.roundZoom=!0,this.type="video",this.options=a}load(){return c._(this,void 0,void 0,function*(){this._loaded=!1;const t=this.options;this.urls=[];for(const a of t.urls)this.urls.push(this.map._requestManager.transformRequest(a,"Source").url);try{const a=yield c.a3(this.urls);if(this._loaded=!0,!a)return;this.video=a,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading()}catch(a){this.fire(new c.j(a))}})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(t){if(this.video){const a=this.video.seekable;t<a.start(0)||t>a.end(0)?this.fire(new c.j(new c.a2(`sources.${this.id}`,null,`Playback for this video can be set only between the ${a.start(0)} and ${a.end(0)}-second mark.`))):this.video.currentTime=t}}getVideo(){return this.video}onAdd(t){this.map||(this.map=t,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const t=this.map.painter.context,a=t.gl;this.boundsBuffer||(this.boundsBuffer=t.createVertexBuffer(this._boundsArray,yr.members)),this.boundsSegments||(this.boundsSegments=c.a0.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(a.LINEAR,a.CLAMP_TO_EDGE),a.texSubImage2D(a.TEXTURE_2D,0,0,0,a.RGBA,a.UNSIGNED_BYTE,this.video)):(this.texture=new Ue(t,this.video,a.RGBA),this.texture.bind(a.LINEAR,a.CLAMP_TO_EDGE));let d=!1;for(const f in this.tiles){const g=this.tiles[f];g.state!=="loaded"&&(g.state="loaded",g.texture=this.texture,d=!0)}d&&this.fire(new c.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class rr extends Hr{constructor(t,a,d,f){super(t,a,d,f),a.coordinates?Array.isArray(a.coordinates)&&a.coordinates.length===4&&!a.coordinates.some(g=>!Array.isArray(g)||g.length!==2||g.some(E=>typeof E!="number"))||this.fire(new c.j(new c.a2(`sources.${t}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new c.j(new c.a2(`sources.${t}`,null,'missing required property "coordinates"'))),a.animate&&typeof a.animate!="boolean"&&this.fire(new c.j(new c.a2(`sources.${t}`,null,'optional "animate" property must be a boolean value'))),a.canvas?typeof a.canvas=="string"||a.canvas instanceof HTMLCanvasElement||this.fire(new c.j(new c.a2(`sources.${t}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new c.j(new c.a2(`sources.${t}`,null,'missing required property "canvas"'))),this.options=a,this.animate=a.animate===void 0||a.animate}load(){return c._(this,void 0,void 0,function*(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new c.j(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())})}getCanvas(){return this.canvas}onAdd(t){this.map=t,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let t=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,t=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,t=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const a=this.map.painter.context,d=a.gl;this.boundsBuffer||(this.boundsBuffer=a.createVertexBuffer(this._boundsArray,yr.members)),this.boundsSegments||(this.boundsSegments=c.a0.simpleSegment(0,0,4,2)),this.texture?(t||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new Ue(a,this.canvas,d.RGBA,{premultiply:!0});let f=!1;for(const g in this.tiles){const E=this.tiles[g];E.state!=="loaded"&&(E.state="loaded",E.texture=this.texture,f=!0)}f&&this.fire(new c.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const t of[this.canvas.width,this.canvas.height])if(isNaN(t)||t<=0)return!0;return!1}}const dr={},fr=y=>{switch(y){case"geojson":return Tr;case"image":return Hr;case"raster":return Ot;case"raster-dem":return Yt;case"vector":return bn;case"video":return vr;case"canvas":return rr}return dr[y]},Ke="RTLPluginLoaded";class hi extends c.E{constructor(){super(...arguments),this.status="unavailable",this.url=null,this.dispatcher=Qt()}_syncState(t){return this.status=t,this.dispatcher.broadcast("SRPS",{pluginStatus:t,pluginURL:this.url}).catch(a=>{throw this.status="error",a})}getRTLTextPluginStatus(){return this.status}clearRTLTextPlugin(){this.status="unavailable",this.url=null}setRTLTextPlugin(t){return c._(this,arguments,void 0,function*(a,d=!1){if(this.url)throw new Error("setRTLTextPlugin cannot be called multiple times.");if(this.url=W.resolveURL(a),!this.url)throw new Error(`requested url ${a} is invalid`);if(this.status==="unavailable"){if(!d)return this._requestImport();this.status="deferred",this._syncState(this.status)}else if(this.status==="requested")return this._requestImport()})}_requestImport(){return c._(this,void 0,void 0,function*(){yield this._syncState("loading"),this.status="loaded",this.fire(new c.k(Ke))})}lazyLoad(){this.status==="unavailable"?this.status="requested":this.status==="deferred"&&this._requestImport()}}let Lr=null;function jr(){return Lr||(Lr=new hi),Lr}class Pr{constructor(t,a){this.timeAdded=0,this.fadeEndTime=0,this.tileID=t,this.uid=c.a4(),this.uses=0,this.tileSize=a,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(t){const a=t+this.timeAdded;a<this.fadeEndTime||(this.fadeEndTime=a)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(t){this.demTexture&&t.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(t,a,d){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",t){t.featureIndex&&(this.latestFeatureIndex=t.featureIndex,t.rawTileData?(this.latestRawTileData=t.rawTileData,this.latestFeatureIndex.rawTileData=t.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=t.collisionBoxArray,this.buckets=function(f,g){const E={};if(!g)return E;for(const I of f){const k=I.layerIds.map(z=>g.getLayer(z)).filter(Boolean);if(k.length!==0){I.layers=k,I.stateDependentLayerIds&&(I.stateDependentLayers=I.stateDependentLayerIds.map(z=>k.filter(L=>L.id===z)[0]));for(const z of k)E[z.id]=I}}return E}(t.buckets,a.style),this.hasSymbolBuckets=!1;for(const f in this.buckets){const g=this.buckets[f];if(g instanceof c.a6){if(this.hasSymbolBuckets=!0,!d)break;g.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const f in this.buckets){const g=this.buckets[f];if(g instanceof c.a6&&g.hasRTLText){this.hasRTLText=!0,jr().lazyLoad();break}}this.queryPadding=0;for(const f in this.buckets){const g=this.buckets[f];this.queryPadding=Math.max(this.queryPadding,a.style.getLayer(f).queryRadius(g))}t.imageAtlas&&(this.imageAtlas=t.imageAtlas),t.glyphAtlasImage&&(this.glyphAtlasImage=t.glyphAtlasImage)}else this.collisionBoxArray=new c.a5}unloadVectorData(){for(const t in this.buckets)this.buckets[t].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(t){return this.buckets[t.id]}upload(t){for(const d in this.buckets){const f=this.buckets[d];f.uploadPending()&&f.upload(t)}const a=t.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new Ue(t,this.imageAtlas.image,a.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new Ue(t,this.glyphAtlasImage,a.ALPHA),this.glyphAtlasImage=null)}prepare(t){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(t,this.imageAtlasTexture)}queryRenderedFeatures(t,a,d,f,g,E,I,k,z,L){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:f,cameraQueryGeometry:g,scale:E,tileSize:this.tileSize,pixelPosMatrix:L,transform:k,params:I,queryPadding:this.queryPadding*z},t,a,d):{}}querySourceFeatures(t,a){const d=this.latestFeatureIndex;if(!d||!d.rawTileData)return;const f=d.loadVTLayers(),g=a&&a.sourceLayer?a.sourceLayer:"",E=f._geojsonTileLayer||f[g];if(!E)return;const I=c.a7(a&&a.filter),{z:k,x:z,y:L}=this.tileID.canonical,O={z:k,x:z,y:L};for(let V=0;V<E.length;V++){const X=E.feature(V);if(I.needGeometry){const le=c.a8(X,!0);if(!I.filter(new c.z(this.tileID.overscaledZ),le,this.tileID.canonical))continue}else if(!I.filter(new c.z(this.tileID.overscaledZ),X))continue;const Q=d.getId(X,g),ie=new c.a9(X,k,z,L,Q);ie.tile=O,t.push(ie)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(t){const a=this.expirationTime;if(t.cacheControl){const d=c.aa(t.cacheControl);d["max-age"]&&(this.expirationTime=Date.now()+1e3*d["max-age"])}else t.expires&&(this.expirationTime=new Date(t.expires).getTime());if(this.expirationTime){const d=Date.now();let f=!1;if(this.expirationTime>d)f=!1;else if(a)if(this.expirationTime<a)f=!0;else{const g=this.expirationTime-a;g?this.expirationTime=d+Math.max(g,3e4):f=!0}else f=!0;f?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(t,a){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(t).length===0)return;const d=this.latestFeatureIndex.loadVTLayers();for(const f in this.buckets){if(!a.style.hasLayer(f))continue;const g=this.buckets[f],E=g.layers[0].sourceLayer||"_geojsonTileLayer",I=d[E],k=t[E];if(!I||!k||Object.keys(k).length===0)continue;g.update(k,I,this.imageAtlas&&this.imageAtlas.patternPositions||{});const z=a&&a.style&&a.style.getLayer(f);z&&(this.queryPadding=Math.max(this.queryPadding,z.queryRadius(g)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<W.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(t){this.symbolFadeHoldUntil=W.now()+t}setDependencies(t,a){const d={};for(const f of a)d[f]=!0;this.dependencies[t]=d}hasDependency(t,a){for(const d of t){const f=this.dependencies[d];if(f){for(const g of a)if(f[g])return!0}}return!1}}class it{constructor(t,a){this.max=t,this.onRemove=a,this.reset()}reset(){for(const t in this.data)for(const a of this.data[t])a.timeout&&clearTimeout(a.timeout),this.onRemove(a.value);return this.data={},this.order=[],this}add(t,a,d){const f=t.wrapped().key;this.data[f]===void 0&&(this.data[f]=[]);const g={value:a,timeout:void 0};if(d!==void 0&&(g.timeout=setTimeout(()=>{this.remove(t,g)},d)),this.data[f].push(g),this.order.push(f),this.order.length>this.max){const E=this._getAndRemoveByKey(this.order[0]);E&&this.onRemove(E)}return this}has(t){return t.wrapped().key in this.data}getAndRemove(t){return this.has(t)?this._getAndRemoveByKey(t.wrapped().key):null}_getAndRemoveByKey(t){const a=this.data[t].shift();return a.timeout&&clearTimeout(a.timeout),this.data[t].length===0&&delete this.data[t],this.order.splice(this.order.indexOf(t),1),a.value}getByKey(t){const a=this.data[t];return a?a[0].value:null}get(t){return this.has(t)?this.data[t.wrapped().key][0].value:null}remove(t,a){if(!this.has(t))return this;const d=t.wrapped().key,f=a===void 0?0:this.data[d].indexOf(a),g=this.data[d][f];return this.data[d].splice(f,1),g.timeout&&clearTimeout(g.timeout),this.data[d].length===0&&delete this.data[d],this.onRemove(g.value),this.order.splice(this.order.indexOf(d),1),this}setMaxSize(t){for(this.max=t;this.order.length>this.max;){const a=this._getAndRemoveByKey(this.order[0]);a&&this.onRemove(a)}return this}filter(t){const a=[];for(const d in this.data)for(const f of this.data[d])t(f.value)||a.push(f);for(const d of a)this.remove(d.value.tileID,d)}}class Ht{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(t,a,d){const f=String(a);if(this.stateChanges[t]=this.stateChanges[t]||{},this.stateChanges[t][f]=this.stateChanges[t][f]||{},c.e(this.stateChanges[t][f],d),this.deletedStates[t]===null){this.deletedStates[t]={};for(const g in this.state[t])g!==f&&(this.deletedStates[t][g]=null)}else if(this.deletedStates[t]&&this.deletedStates[t][f]===null){this.deletedStates[t][f]={};for(const g in this.state[t][f])d[g]||(this.deletedStates[t][f][g]=null)}else for(const g in d)this.deletedStates[t]&&this.deletedStates[t][f]&&this.deletedStates[t][f][g]===null&&delete this.deletedStates[t][f][g]}removeFeatureState(t,a,d){if(this.deletedStates[t]===null)return;const f=String(a);if(this.deletedStates[t]=this.deletedStates[t]||{},d&&a!==void 0)this.deletedStates[t][f]!==null&&(this.deletedStates[t][f]=this.deletedStates[t][f]||{},this.deletedStates[t][f][d]=null);else if(a!==void 0)if(this.stateChanges[t]&&this.stateChanges[t][f])for(d in this.deletedStates[t][f]={},this.stateChanges[t][f])this.deletedStates[t][f][d]=null;else this.deletedStates[t][f]=null;else this.deletedStates[t]=null}getState(t,a){const d=String(a),f=c.e({},(this.state[t]||{})[d],(this.stateChanges[t]||{})[d]);if(this.deletedStates[t]===null)return{};if(this.deletedStates[t]){const g=this.deletedStates[t][a];if(g===null)return{};for(const E in g)delete f[E]}return f}initializeTileState(t,a){t.setFeatureState(this.state,a)}coalesceChanges(t,a){const d={};for(const f in this.stateChanges){this.state[f]=this.state[f]||{};const g={};for(const E in this.stateChanges[f])this.state[f][E]||(this.state[f][E]={}),c.e(this.state[f][E],this.stateChanges[f][E]),g[E]=this.state[f][E];d[f]=g}for(const f in this.deletedStates){this.state[f]=this.state[f]||{};const g={};if(this.deletedStates[f]===null)for(const E in this.state[f])g[E]={},this.state[f][E]={};else for(const E in this.deletedStates[f]){if(this.deletedStates[f][E]===null)this.state[f][E]={};else for(const I of Object.keys(this.deletedStates[f][E]))delete this.state[f][E][I];g[E]=this.state[f][E]}d[f]=d[f]||{},c.e(d[f],g)}if(this.stateChanges={},this.deletedStates={},Object.keys(d).length!==0)for(const f in t)t[f].setFeatureState(d,a)}}class Ut extends c.E{constructor(t,a,d){super(),this.id=t,this.dispatcher=d,this.on("data",f=>this._dataHandler(f)),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=((f,g,E,I)=>{const k=new(fr(g.type))(f,g,E,I);if(k.id!==f)throw new Error(`Expected Source id to be ${f} instead of ${k.id}`);return k})(t,a,d,this),this._tiles={},this._cache=new it(0,f=>this._unloadTile(f)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new Ht,this._didEmitContent=!1,this._updated=!1}onAdd(t){this.map=t,this._maxTileCacheSize=t?t._maxTileCacheSize:null,this._maxTileCacheZoomLevels=t?t._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(t)}onRemove(t){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(t)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(this.used===void 0&&this.usedForTerrain===void 0||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const t in this._tiles){const a=this._tiles[t];if(a.state!=="loaded"&&a.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const t=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,t&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(t,a,d){return c._(this,void 0,void 0,function*(){try{yield this._source.loadTile(t),this._tileLoaded(t,a,d)}catch(f){t.state="errored",f.status!==404?this._source.fire(new c.j(f,{tile:t})):this.update(this.transform,this.terrain)}})}_unloadTile(t){this._source.unloadTile&&this._source.unloadTile(t)}_abortTile(t){this._source.abortTile&&this._source.abortTile(t),this._source.fire(new c.k("dataabort",{tile:t,coord:t.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(t){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const a in this._tiles){const d=this._tiles[a];d.upload(t),d.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(t=>t.tileID).sort(di).map(t=>t.key)}getRenderableIds(t){const a=[];for(const d in this._tiles)this._isIdRenderable(d,t)&&a.push(this._tiles[d]);return t?a.sort((d,f)=>{const g=d.tileID,E=f.tileID,I=new c.P(g.canonical.x,g.canonical.y)._rotate(this.transform.angle),k=new c.P(E.canonical.x,E.canonical.y)._rotate(this.transform.angle);return g.overscaledZ-E.overscaledZ||k.y-I.y||k.x-I.x}).map(d=>d.tileID.key):a.map(d=>d.tileID).sort(di).map(d=>d.key)}hasRenderableParent(t){const a=this.findLoadedParent(t,0);return!!a&&this._isIdRenderable(a.tileID.key)}_isIdRenderable(t,a){return this._tiles[t]&&this._tiles[t].hasData()&&!this._coveredTiles[t]&&(a||!this._tiles[t].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const t in this._tiles)this._tiles[t].state!=="errored"&&this._reloadTile(t,"reloading")}}_reloadTile(t,a){return c._(this,void 0,void 0,function*(){const d=this._tiles[t];d&&(d.state!=="loading"&&(d.state=a),yield this._loadTile(d,t,a))})}_tileLoaded(t,a,d){t.timeAdded=W.now(),d==="expired"&&(t.refreshedUponExpiration=!0),this._setTileReloadTimer(a,t),this.getSource().type==="raster-dem"&&t.dem&&this._backfillDEM(t),this._state.initializeTileState(t,this.map?this.map.painter:null),t.aborted||this._source.fire(new c.k("data",{dataType:"source",tile:t,coord:t.tileID}))}_backfillDEM(t){const a=this.getRenderableIds();for(let f=0;f<a.length;f++){const g=a[f];if(t.neighboringTiles&&t.neighboringTiles[g]){const E=this.getTileByID(g);d(t,E),d(E,t)}}function d(f,g){f.needsHillshadePrepare=!0,f.needsTerrainPrepare=!0;let E=g.tileID.canonical.x-f.tileID.canonical.x;const I=g.tileID.canonical.y-f.tileID.canonical.y,k=Math.pow(2,f.tileID.canonical.z),z=g.tileID.key;E===0&&I===0||Math.abs(I)>1||(Math.abs(E)>1&&(Math.abs(E+k)===1?E+=k:Math.abs(E-k)===1&&(E-=k)),g.dem&&f.dem&&(f.dem.backfillBorder(g.dem,E,I),f.neighboringTiles&&f.neighboringTiles[z]&&(f.neighboringTiles[z].backfilled=!0)))}}getTile(t){return this.getTileByID(t.key)}getTileByID(t){return this._tiles[t]}_retainLoadedChildren(t,a,d,f){for(const g in this._tiles){let E=this._tiles[g];if(f[g]||!E.hasData()||E.tileID.overscaledZ<=a||E.tileID.overscaledZ>d)continue;let I=E.tileID;for(;E&&E.tileID.overscaledZ>a+1;){const z=E.tileID.scaledTo(E.tileID.overscaledZ-1);E=this._tiles[z.key],E&&E.hasData()&&(I=z)}let k=I;for(;k.overscaledZ>a;)if(k=k.scaledTo(k.overscaledZ-1),t[k.key]){f[I.key]=I;break}}}findLoadedParent(t,a){if(t.key in this._loadedParentTiles){const d=this._loadedParentTiles[t.key];return d&&d.tileID.overscaledZ>=a?d:null}for(let d=t.overscaledZ-1;d>=a;d--){const f=t.scaledTo(d),g=this._getLoadedTile(f);if(g)return g}}findLoadedSibling(t){return this._getLoadedTile(t)}_getLoadedTile(t){const a=this._tiles[t.key];return a&&a.hasData()?a:this._cache.getByKey(t.wrapped().key)}updateCacheSize(t){const a=Math.ceil(t.width/this._source.tileSize)+1,d=Math.ceil(t.height/this._source.tileSize)+1,f=Math.floor(a*d*(this._maxTileCacheZoomLevels===null?c.a.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),g=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,f):f;this._cache.setMaxSize(g)}handleWrapJump(t){const a=Math.round((t-(this._prevLng===void 0?t:this._prevLng))/360);if(this._prevLng=t,a){const d={};for(const f in this._tiles){const g=this._tiles[f];g.tileID=g.tileID.unwrapTo(g.tileID.wrap+a),d[g.tileID.key]=g}this._tiles=d;for(const f in this._timers)clearTimeout(this._timers[f]),delete this._timers[f];for(const f in this._tiles)this._setTileReloadTimer(f,this._tiles[f])}}_updateCoveredAndRetainedTiles(t,a,d,f,g,E){const I={},k={},z=Object.keys(t),L=W.now();for(const O of z){const V=t[O],X=this._tiles[O];if(!X||X.fadeEndTime!==0&&X.fadeEndTime<=L)continue;const Q=this.findLoadedParent(V,a),ie=this.findLoadedSibling(V),le=Q||ie||null;le&&(this._addTile(le.tileID),I[le.tileID.key]=le.tileID),k[O]=V}this._retainLoadedChildren(k,f,d,t);for(const O in I)t[O]||(this._coveredTiles[O]=!0,t[O]=I[O]);if(E){const O={},V={};for(const X of g)this._tiles[X.key].hasData()?O[X.key]=X:V[X.key]=X;for(const X in V){const Q=V[X].children(this._source.maxzoom);this._tiles[Q[0].key]&&this._tiles[Q[1].key]&&this._tiles[Q[2].key]&&this._tiles[Q[3].key]&&(O[Q[0].key]=t[Q[0].key]=Q[0],O[Q[1].key]=t[Q[1].key]=Q[1],O[Q[2].key]=t[Q[2].key]=Q[2],O[Q[3].key]=t[Q[3].key]=Q[3],delete V[X])}for(const X in V){const Q=V[X],ie=this.findLoadedParent(Q,this._source.minzoom),le=this.findLoadedSibling(Q),ce=ie||le||null;if(ce){O[ce.tileID.key]=t[ce.tileID.key]=ce.tileID;for(const me in O)O[me].isChildOf(ce.tileID)&&delete O[me]}}for(const X in this._tiles)O[X]||(this._coveredTiles[X]=!0)}}update(t,a){if(!this._sourceLoaded||this._paused)return;let d;this.transform=t,this.terrain=a,this.updateCacheSize(t),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?d=t.getVisibleUnwrappedCoordinates(this._source.tileID).map(L=>new c.S(L.canonical.z,L.wrap,L.canonical.z,L.canonical.x,L.canonical.y)):(d=t.coveringTiles({tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:a}),this._source.hasTile&&(d=d.filter(L=>this._source.hasTile(L)))):d=[];const f=t.coveringZoomLevel(this._source),g=Math.max(f-Ut.maxOverzooming,this._source.minzoom),E=Math.max(f+Ut.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){const L={};for(const O of d)if(O.canonical.z>this._source.minzoom){const V=O.scaledTo(O.canonical.z-1);L[V.key]=V;const X=O.scaledTo(Math.max(this._source.minzoom,Math.min(O.canonical.z,5)));L[X.key]=X}d=d.concat(Object.values(L))}const I=d.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,I&&this.fire(new c.k("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const k=this._updateRetainedTiles(d,f);Gi(this._source.type)&&this._updateCoveredAndRetainedTiles(k,g,E,f,d,a);for(const L in k)this._tiles[L].clearFadeHold();const z=c.ab(this._tiles,k);for(const L of z){const O=this._tiles[L];O.hasSymbolBuckets&&!O.holdingForFade()?O.setHoldDuration(this.map._fadeDuration):O.hasSymbolBuckets&&!O.symbolFadeFinished()||this._removeTile(L)}this._updateLoadedParentTileCache(),this._updateLoadedSiblingTileCache()}releaseSymbolFadeTiles(){for(const t in this._tiles)this._tiles[t].holdingForFade()&&this._removeTile(t)}_updateRetainedTiles(t,a){var d;const f={},g={},E=Math.max(a-Ut.maxOverzooming,this._source.minzoom),I=Math.max(a+Ut.maxUnderzooming,this._source.minzoom),k={};for(const z of t){const L=this._addTile(z);f[z.key]=z,L.hasData()||a<this._source.maxzoom&&(k[z.key]=z)}this._retainLoadedChildren(k,a,I,f);for(const z of t){let L=this._tiles[z.key];if(L.hasData())continue;if(a+1>this._source.maxzoom){const V=z.children(this._source.maxzoom)[0],X=this.getTile(V);if(X&&X.hasData()){f[V.key]=V;continue}}else{const V=z.children(this._source.maxzoom);if(f[V[0].key]&&f[V[1].key]&&f[V[2].key]&&f[V[3].key])continue}let O=L.wasRequested();for(let V=z.overscaledZ-1;V>=E;--V){const X=z.scaledTo(V);if(g[X.key])break;if(g[X.key]=!0,L=this.getTile(X),!L&&O&&(L=this._addTile(X)),L){const Q=L.hasData();if((Q||!(!((d=this.map)===null||d===void 0)&&d.cancelPendingTileRequestsWhileZooming)||O)&&(f[X.key]=X),O=L.wasRequested(),Q)break}}}return f}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const t in this._tiles){const a=[];let d,f=this._tiles[t].tileID;for(;f.overscaledZ>0;){if(f.key in this._loadedParentTiles){d=this._loadedParentTiles[f.key];break}a.push(f.key);const g=f.scaledTo(f.overscaledZ-1);if(d=this._getLoadedTile(g),d)break;f=g}for(const g of a)this._loadedParentTiles[g]=d}}_updateLoadedSiblingTileCache(){this._loadedSiblingTiles={};for(const t in this._tiles){const a=this._tiles[t].tileID,d=this._getLoadedTile(a);this._loadedSiblingTiles[a.key]=d}}_addTile(t){let a=this._tiles[t.key];if(a)return a;a=this._cache.getAndRemove(t),a&&(this._setTileReloadTimer(t.key,a),a.tileID=t,this._state.initializeTileState(a,this.map?this.map.painter:null),this._cacheTimers[t.key]&&(clearTimeout(this._cacheTimers[t.key]),delete this._cacheTimers[t.key],this._setTileReloadTimer(t.key,a)));const d=a;return a||(a=new Pr(t,this._source.tileSize*t.overscaleFactor()),this._loadTile(a,t.key,a.state)),a.uses++,this._tiles[t.key]=a,d||this._source.fire(new c.k("dataloading",{tile:a,coord:a.tileID,dataType:"source"})),a}_setTileReloadTimer(t,a){t in this._timers&&(clearTimeout(this._timers[t]),delete this._timers[t]);const d=a.getExpiryTimeout();d&&(this._timers[t]=setTimeout(()=>{this._reloadTile(t,"expired"),delete this._timers[t]},d))}_removeTile(t){const a=this._tiles[t];a&&(a.uses--,delete this._tiles[t],this._timers[t]&&(clearTimeout(this._timers[t]),delete this._timers[t]),a.uses>0||(a.hasData()&&a.state!=="reloading"?this._cache.add(a.tileID,a,a.getExpiryTimeout()):(a.aborted=!0,this._abortTile(a),this._unloadTile(a))))}_dataHandler(t){const a=t.sourceDataType;t.dataType==="source"&&a==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&t.dataType==="source"&&a==="content"&&(this.reload(),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0)}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const t in this._tiles)this._removeTile(t);this._cache.reset()}tilesIn(t,a,d){const f=[],g=this.transform;if(!g)return f;const E=d?g.getCameraQueryGeometry(t):t,I=t.map(Q=>g.pointCoordinate(Q,this.terrain)),k=E.map(Q=>g.pointCoordinate(Q,this.terrain)),z=this.getIds();let L=1/0,O=1/0,V=-1/0,X=-1/0;for(const Q of k)L=Math.min(L,Q.x),O=Math.min(O,Q.y),V=Math.max(V,Q.x),X=Math.max(X,Q.y);for(let Q=0;Q<z.length;Q++){const ie=this._tiles[z[Q]];if(ie.holdingForFade())continue;const le=ie.tileID,ce=Math.pow(2,g.zoom-ie.tileID.overscaledZ),me=a*ie.queryPadding*c.X/ie.tileSize/ce,te=[le.getTilePoint(new c.Z(L,O)),le.getTilePoint(new c.Z(V,X))];if(te[0].x-me<c.X&&te[0].y-me<c.X&&te[1].x+me>=0&&te[1].y+me>=0){const xe=I.map(Me=>le.getTilePoint(Me)),be=k.map(Me=>le.getTilePoint(Me));f.push({tile:ie,tileID:le,queryGeometry:xe,cameraQueryGeometry:be,scale:ce})}}return f}getVisibleCoordinates(t){const a=this.getRenderableIds(t).map(d=>this._tiles[d].tileID);for(const d of a)d.posMatrix=this.transform.calculatePosMatrix(d.toUnwrapped());return a}hasTransition(){if(this._source.hasTransition())return!0;if(Gi(this._source.type)){const t=W.now();for(const a in this._tiles)if(this._tiles[a].fadeEndTime>=t)return!0}return!1}setFeatureState(t,a,d){this._state.updateState(t=t||"_geojsonTileLayer",a,d)}removeFeatureState(t,a,d){this._state.removeFeatureState(t=t||"_geojsonTileLayer",a,d)}getFeatureState(t,a){return this._state.getState(t=t||"_geojsonTileLayer",a)}setDependencies(t,a,d){const f=this._tiles[t];f&&f.setDependencies(a,d)}reloadTilesForDependencies(t,a){for(const d in this._tiles)this._tiles[d].hasDependency(t,a)&&this._reloadTile(d,"reloading");this._cache.filter(d=>!d.hasDependency(t,a))}}function di(y,t){const a=Math.abs(2*y.wrap)-+(y.wrap<0),d=Math.abs(2*t.wrap)-+(t.wrap<0);return y.overscaledZ-t.overscaledZ||d-a||t.canonical.y-y.canonical.y||t.canonical.x-y.canonical.x}function Gi(y){return y==="raster"||y==="image"||y==="video"}Ut.maxOverzooming=10,Ut.maxUnderzooming=3;class Xt{constructor(t,a){this.reset(t,a)}reset(t,a){this.points=t||[],this._distances=[0];for(let d=1;d<this.points.length;d++)this._distances[d]=this._distances[d-1]+this.points[d].dist(this.points[d-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(a||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(t){if(this.points.length===1)return this.points[0];t=c.ac(t,0,1);let a=1,d=this._distances[a];const f=t*this.paddedLength+this.padding;for(;d<f&&a<this._distances.length;)d=this._distances[++a];const g=a-1,E=this._distances[g],I=d-E,k=I>0?(f-E)/I:0;return this.points[g].mult(1-k).add(this.points[a].mult(k))}}function Ys(y,t){let a=!0;return y==="always"||y!=="never"&&t!=="never"||(a=!1),a}class co{constructor(t,a,d){const f=this.boxCells=[],g=this.circleCells=[];this.xCellCount=Math.ceil(t/d),this.yCellCount=Math.ceil(a/d);for(let E=0;E<this.xCellCount*this.yCellCount;E++)f.push([]),g.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=t,this.height=a,this.xScale=this.xCellCount/t,this.yScale=this.yCellCount/a,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(t,a,d,f,g){this._forEachCell(a,d,f,g,this._insertBoxCell,this.boxUid++),this.boxKeys.push(t),this.bboxes.push(a),this.bboxes.push(d),this.bboxes.push(f),this.bboxes.push(g)}insertCircle(t,a,d,f){this._forEachCell(a-f,d-f,a+f,d+f,this._insertCircleCell,this.circleUid++),this.circleKeys.push(t),this.circles.push(a),this.circles.push(d),this.circles.push(f)}_insertBoxCell(t,a,d,f,g,E){this.boxCells[g].push(E)}_insertCircleCell(t,a,d,f,g,E){this.circleCells[g].push(E)}_query(t,a,d,f,g,E,I){if(d<0||t>this.width||f<0||a>this.height)return[];const k=[];if(t<=0&&a<=0&&this.width<=d&&this.height<=f){if(g)return[{key:null,x1:t,y1:a,x2:d,y2:f}];for(let z=0;z<this.boxKeys.length;z++)k.push({key:this.boxKeys[z],x1:this.bboxes[4*z],y1:this.bboxes[4*z+1],x2:this.bboxes[4*z+2],y2:this.bboxes[4*z+3]});for(let z=0;z<this.circleKeys.length;z++){const L=this.circles[3*z],O=this.circles[3*z+1],V=this.circles[3*z+2];k.push({key:this.circleKeys[z],x1:L-V,y1:O-V,x2:L+V,y2:O+V})}}else this._forEachCell(t,a,d,f,this._queryCell,k,{hitTest:g,overlapMode:E,seenUids:{box:{},circle:{}}},I);return k}query(t,a,d,f){return this._query(t,a,d,f,!1,null)}hitTest(t,a,d,f,g,E){return this._query(t,a,d,f,!0,g,E).length>0}hitTestCircle(t,a,d,f,g){const E=t-d,I=t+d,k=a-d,z=a+d;if(I<0||E>this.width||z<0||k>this.height)return!1;const L=[];return this._forEachCell(E,k,I,z,this._queryCellCircle,L,{hitTest:!0,overlapMode:f,circle:{x:t,y:a,radius:d},seenUids:{box:{},circle:{}}},g),L.length>0}_queryCell(t,a,d,f,g,E,I,k){const{seenUids:z,hitTest:L,overlapMode:O}=I,V=this.boxCells[g];if(V!==null){const Q=this.bboxes;for(const ie of V)if(!z.box[ie]){z.box[ie]=!0;const le=4*ie,ce=this.boxKeys[ie];if(t<=Q[le+2]&&a<=Q[le+3]&&d>=Q[le+0]&&f>=Q[le+1]&&(!k||k(ce))&&(!L||!Ys(O,ce.overlapMode))&&(E.push({key:ce,x1:Q[le],y1:Q[le+1],x2:Q[le+2],y2:Q[le+3]}),L))return!0}}const X=this.circleCells[g];if(X!==null){const Q=this.circles;for(const ie of X)if(!z.circle[ie]){z.circle[ie]=!0;const le=3*ie,ce=this.circleKeys[ie];if(this._circleAndRectCollide(Q[le],Q[le+1],Q[le+2],t,a,d,f)&&(!k||k(ce))&&(!L||!Ys(O,ce.overlapMode))){const me=Q[le],te=Q[le+1],xe=Q[le+2];if(E.push({key:ce,x1:me-xe,y1:te-xe,x2:me+xe,y2:te+xe}),L)return!0}}}return!1}_queryCellCircle(t,a,d,f,g,E,I,k){const{circle:z,seenUids:L,overlapMode:O}=I,V=this.boxCells[g];if(V!==null){const Q=this.bboxes;for(const ie of V)if(!L.box[ie]){L.box[ie]=!0;const le=4*ie,ce=this.boxKeys[ie];if(this._circleAndRectCollide(z.x,z.y,z.radius,Q[le+0],Q[le+1],Q[le+2],Q[le+3])&&(!k||k(ce))&&!Ys(O,ce.overlapMode))return E.push(!0),!0}}const X=this.circleCells[g];if(X!==null){const Q=this.circles;for(const ie of X)if(!L.circle[ie]){L.circle[ie]=!0;const le=3*ie,ce=this.circleKeys[ie];if(this._circlesCollide(Q[le],Q[le+1],Q[le+2],z.x,z.y,z.radius)&&(!k||k(ce))&&!Ys(O,ce.overlapMode))return E.push(!0),!0}}}_forEachCell(t,a,d,f,g,E,I,k){const z=this._convertToXCellCoord(t),L=this._convertToYCellCoord(a),O=this._convertToXCellCoord(d),V=this._convertToYCellCoord(f);for(let X=z;X<=O;X++)for(let Q=L;Q<=V;Q++)if(g.call(this,t,a,d,f,this.xCellCount*Q+X,E,I,k))return}_convertToXCellCoord(t){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(t*this.xScale)))}_convertToYCellCoord(t){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(t*this.yScale)))}_circlesCollide(t,a,d,f,g,E){const I=f-t,k=g-a,z=d+E;return z*z>I*I+k*k}_circleAndRectCollide(t,a,d,f,g,E,I){const k=(E-f)/2,z=Math.abs(t-(f+k));if(z>k+d)return!1;const L=(I-g)/2,O=Math.abs(a-(g+L));if(O>L+d)return!1;if(z<=k||O<=L)return!0;const V=z-k,X=O-L;return V*V+X*X<=d*d}}function ho(y,t,a,d,f){const g=c.H();return t?(c.K(g,g,[1/f,1/f,1]),a||c.ad(g,g,d.angle)):c.L(g,d.labelPlaneMatrix,y),g}function Rs(y,t,a,d,f){if(t){const g=c.ae(y);return c.K(g,g,[f,f,1]),a||c.ad(g,g,-d.angle),g}return d.glCoordMatrix}function ae(y,t,a,d){let f;d?(f=[y,t,d(y,t),1],c.af(f,f,a)):(f=[y,t,0,1],In(f,f,a));const g=f[3];return{point:new c.P(f[0]/g,f[1]/g),signedDistanceFromCamera:g,isOccluded:!1}}function N(y,t){return .5+y/t*.5}function B(y,t){return y.x>=-t[0]&&y.x<=t[0]&&y.y>=-t[1]&&y.y<=t[1]}function K(y,t,a,d,f,g,E,I,k,z,L,O,V,X,Q){const ie=d?y.textSizeData:y.iconSizeData,le=c.ag(ie,a.transform.zoom),ce=[256/a.width*2+1,256/a.height*2+1],me=d?y.text.dynamicLayoutVertexArray:y.icon.dynamicLayoutVertexArray;me.clear();const te=y.lineVertexArray,xe=d?y.text.placedSymbolArray:y.icon.placedSymbolArray,be=a.transform.width/a.transform.height;let Me=!1;for(let qe=0;qe<xe.length;qe++){const et=xe.get(qe);if(et.hidden||et.writingMode===c.ah.vertical&&!Me){Lt(et.numGlyphs,me);continue}Me=!1;const lt=ae(et.anchorX,et.anchorY,t,Q);if(!B(lt.point,ce)){Lt(et.numGlyphs,me);continue}const pt=N(a.transform.cameraToCenterDistance,lt.signedDistanceFromCamera),ot=c.ai(ie,le,et),at=E?ot/pt:ot*pt,wt={getElevation:Q,labelPlaneMatrix:f,lineVertexArray:te,pitchWithMap:E,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},projection:z,tileAnchorPoint:new c.P(et.anchorX,et.anchorY),unwrappedTileID:L,width:O,height:V,translation:X},Gt=Se(wt,et,at,!1,I,t,g,y.glyphOffsetArray,me,be,k);Me=Gt.useVertical,(Gt.notEnoughRoom||Me||Gt.needsFlipping&&Se(wt,et,at,!0,I,t,g,y.glyphOffsetArray,me,be,k).notEnoughRoom)&&Lt(et.numGlyphs,me)}d?y.text.dynamicLayoutVertexBuffer.updateData(me):y.icon.dynamicLayoutVertexBuffer.updateData(me)}function re(y,t,a,d,f,g,E,I){const k=g.glyphStartIndex+g.numGlyphs,z=g.lineStartIndex,L=g.lineStartIndex+g.lineLength,O=t.getoffsetX(g.glyphStartIndex),V=t.getoffsetX(k-1),X=st(y*O,a,d,f,g.segment,z,L,I,E);if(!X)return null;const Q=st(y*V,a,d,f,g.segment,z,L,I,E);return Q?I.projectionCache.anyProjectionOccluded?null:{first:X,last:Q}:null}function ye(y,t,a,d){return y===c.ah.horizontal&&Math.abs(a.y-t.y)>Math.abs(a.x-t.x)*d?{useVertical:!0}:(y===c.ah.vertical?t.y<a.y:t.x>a.x)?{needsFlipping:!0}:null}function Se(y,t,a,d,f,g,E,I,k,z,L){const O=a/24,V=t.lineOffsetX*O,X=t.lineOffsetY*O;let Q;if(t.numGlyphs>1){const ie=t.glyphStartIndex+t.numGlyphs,le=t.lineStartIndex,ce=t.lineStartIndex+t.lineLength,me=re(O,I,V,X,d,t,L,y);if(!me)return{notEnoughRoom:!0};const te=ae(me.first.point.x,me.first.point.y,E,y.getElevation).point,xe=ae(me.last.point.x,me.last.point.y,E,y.getElevation).point;if(f&&!d){const be=ye(t.writingMode,te,xe,z);if(be)return be}Q=[me.first];for(let be=t.glyphStartIndex+1;be<ie-1;be++)Q.push(st(O*I.getoffsetX(be),V,X,d,t.segment,le,ce,y,L));Q.push(me.last)}else{if(f&&!d){const le=ae(y.tileAnchorPoint.x,y.tileAnchorPoint.y,g,y.getElevation).point,ce=t.lineStartIndex+t.segment+1,me=new c.P(y.lineVertexArray.getx(ce),y.lineVertexArray.gety(ce)),te=ae(me.x,me.y,g,y.getElevation),xe=te.signedDistanceFromCamera>0?te.point:function(Me,qe,et,lt,pt,ot){return ke(Me,qe,et,1,pt,ot)}(y.tileAnchorPoint,me,le,0,g,y),be=ye(t.writingMode,le,xe,z);if(be)return be}const ie=st(O*I.getoffsetX(t.glyphStartIndex),V,X,d,t.segment,t.lineStartIndex,t.lineStartIndex+t.lineLength,y,L);if(!ie||y.projectionCache.anyProjectionOccluded)return{notEnoughRoom:!0};Q=[ie]}for(const ie of Q)c.aj(k,ie.point,ie.angle);return{}}function ke(y,t,a,d,f,g){const E=y.add(y.sub(t)._unit()),I=f!==void 0?ae(E.x,E.y,f,g.getElevation).point:Fe(E.x,E.y,g).point,k=a.sub(I);return a.add(k._mult(d/k.mag()))}function pe(y,t,a){const d=t.projectionCache;if(d.projections[y])return d.projections[y];const f=new c.P(t.lineVertexArray.getx(y),t.lineVertexArray.gety(y)),g=Fe(f.x,f.y,t);if(g.signedDistanceFromCamera>0)return d.projections[y]=g.point,d.anyProjectionOccluded=d.anyProjectionOccluded||g.isOccluded,g.point;const E=y-a.direction;return function(I,k,z,L,O){return ke(I,k,z,L,void 0,O)}(a.distanceFromAnchor===0?t.tileAnchorPoint:new c.P(t.lineVertexArray.getx(E),t.lineVertexArray.gety(E)),f,a.previousVertex,a.absOffsetX-a.distanceFromAnchor+1,t)}function Fe(y,t,a){const d=y+a.translation[0],f=t+a.translation[1];let g;return!a.pitchWithMap&&a.projection.useSpecialProjectionForSymbols?(g=a.projection.projectTileCoordinates(d,f,a.unwrappedTileID,a.getElevation),g.point.x=(.5*g.point.x+.5)*a.width,g.point.y=(.5*-g.point.y+.5)*a.height):(g=ae(d,f,a.labelPlaneMatrix,a.getElevation),g.isOccluded=!1),g}function Ge(y,t,a){return y._unit()._perp()._mult(t*a)}function Re(y,t,a,d,f,g,E,I,k){if(I.projectionCache.offsets[y])return I.projectionCache.offsets[y];const z=a.add(t);if(y+k.direction<d||y+k.direction>=f)return I.projectionCache.offsets[y]=z,z;const L=pe(y+k.direction,I,k),O=Ge(L.sub(a),E,k.direction),V=a.add(O),X=L.add(O);return I.projectionCache.offsets[y]=c.ak(g,z,V,X)||z,I.projectionCache.offsets[y]}function st(y,t,a,d,f,g,E,I,k){const z=d?y-t:y+t;let L=z>0?1:-1,O=0;d&&(L*=-1,O=Math.PI),L<0&&(O+=Math.PI);let V,X=L>0?g+f:g+f+1;I.projectionCache.cachedAnchorPoint?V=I.projectionCache.cachedAnchorPoint:(V=Fe(I.tileAnchorPoint.x,I.tileAnchorPoint.y,I).point,I.projectionCache.cachedAnchorPoint=V);let Q,ie,le=V,ce=V,me=0,te=0;const xe=Math.abs(z),be=[];let Me;for(;me+te<=xe;){if(X+=L,X<g||X>=E)return null;me+=te,ce=le,ie=Q;const lt={absOffsetX:xe,direction:L,distanceFromAnchor:me,previousVertex:ce};if(le=pe(X,I,lt),a===0)be.push(ce),Me=le.sub(ce);else{let pt;const ot=le.sub(ce);pt=ot.mag()===0?Ge(pe(X+L,I,lt).sub(le),a,L):Ge(ot,a,L),ie||(ie=ce.add(pt)),Q=Re(X,pt,le,g,E,ie,a,I,lt),be.push(ie),Me=Q.sub(ie)}te=Me.mag()}const qe=Me._mult((xe-me)/te)._add(ie||ce),et=O+Math.atan2(le.y-ce.y,le.x-ce.x);return be.push(qe),{point:qe,angle:k?et:0,path:be}}const Mt=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function Lt(y,t){for(let a=0;a<y;a++){const d=t.length;t.resize(d+4),t.float32.set(Mt,3*d)}}function In(y,t,a){const d=t[0],f=t[1];return y[0]=a[0]*d+a[4]*f+a[12],y[1]=a[1]*d+a[5]*f+a[13],y[3]=a[3]*d+a[7]*f+a[15],y}const Jt=100;class kn{constructor(t,a,d=new co(t.width+200,t.height+200,25),f=new co(t.width+200,t.height+200,25)){this.transform=t,this.mapProjection=a,this.grid=d,this.ignoredGrid=f,this.pitchFactor=Math.cos(t._pitch)*t.cameraToCenterDistance,this.screenRightBoundary=t.width+Jt,this.screenBottomBoundary=t.height+Jt,this.gridRightBoundary=t.width+200,this.gridBottomBoundary=t.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(t,a,d,f,g,E,I,k,z,L,O){const V=t.anchorPointX+k[0],X=t.anchorPointY+k[1],Q=this.projectAndGetPerspectiveRatio(f,V,X,g,L),ie=d*Q.perspectiveRatio;let le;if(E||I)le=this._projectCollisionBox(t,ie,f,g,E,I,k,Q,L,O);else{const be=Q.point.x+(O?O.x*ie:0),Me=Q.point.y+(O?O.y*ie:0);le={allPointsOccluded:!1,box:[be+t.x1*ie,Me+t.y1*ie,be+t.x2*ie,Me+t.y2*ie]}}const[ce,me,te,xe]=le.box;return this.mapProjection.useSpecialProjectionForSymbols&&(E?le.allPointsOccluded:this.mapProjection.isOccluded(V,X,g))||Q.perspectiveRatio<this.perspectiveRatioCutoff||!this.isInsideGrid(ce,me,te,xe)||a!=="always"&&this.grid.hitTest(ce,me,te,xe,a,z)?{box:[ce,me,te,xe],placeable:!1,offscreen:!1}:{box:[ce,me,te,xe],placeable:!0,offscreen:this.isOffscreen(ce,me,te,xe)}}placeCollisionCircles(t,a,d,f,g,E,I,k,z,L,O,V,X,Q,ie,le){const ce=[],me=new c.P(a.anchorX,a.anchorY),te=this.getPerspectiveRatio(E,me.x,me.y,I,le),xe=(O?g/te:g*te)/c.ap,be={getElevation:le,labelPlaneMatrix:k,lineVertexArray:d,pitchWithMap:O,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},projection:this.mapProjection,tileAnchorPoint:me,unwrappedTileID:I,width:this.transform.width,height:this.transform.height,translation:ie},Me=re(xe,f,a.lineOffsetX*xe,a.lineOffsetY*xe,!1,a,!1,be);let qe=!1,et=!1,lt=!0;if(Me){const pt=.5*X*te+Q,ot=new c.P(-100,-100),at=new c.P(this.screenRightBoundary,this.screenBottomBoundary),wt=new Xt,Gt=Me.first,dt=Me.last;let nt=[];for(let $t=Gt.path.length-1;$t>=1;$t--)nt.push(Gt.path[$t]);for(let $t=1;$t<dt.path.length;$t++)nt.push(dt.path[$t]);const jt=2.5*pt;if(z){const $t=this.projectPathToScreenSpace(nt,be,z);nt=$t.some(un=>un.signedDistanceFromCamera<=0)?[]:$t.map(un=>un.point)}let sr=[];if(nt.length>0){const $t=nt[0].clone(),un=nt[0].clone();for(let Xn=1;Xn<nt.length;Xn++)$t.x=Math.min($t.x,nt[Xn].x),$t.y=Math.min($t.y,nt[Xn].y),un.x=Math.max(un.x,nt[Xn].x),un.y=Math.max(un.y,nt[Xn].y);sr=$t.x>=ot.x&&un.x<=at.x&&$t.y>=ot.y&&un.y<=at.y?[nt]:un.x<ot.x||$t.x>at.x||un.y<ot.y||$t.y>at.y?[]:c.al([nt],ot.x,ot.y,at.x,at.y)}for(const $t of sr){wt.reset($t,.25*pt);let un=0;un=wt.length<=.5*pt?1:Math.ceil(wt.paddedLength/jt)+1;for(let Xn=0;Xn<un;Xn++){const Cr=Xn/Math.max(un-1,1),ms=wt.lerp(Cr),hn=ms.x+Jt,pi=ms.y+Jt;ce.push(hn,pi,pt,0);const Ii=hn-pt,mi=pi-pt,ki=hn+pt,gs=pi+pt;if(lt=lt&&this.isOffscreen(Ii,mi,ki,gs),et=et||this.isInsideGrid(Ii,mi,ki,gs),t!=="always"&&this.grid.hitTestCircle(hn,pi,pt,t,V)&&(qe=!0,!L))return{circles:[],offscreen:!1,collisionDetected:qe}}}}return{circles:!L&&qe||!et||te<this.perspectiveRatioCutoff?[]:ce,offscreen:lt,collisionDetected:qe}}projectPathToScreenSpace(t,a,d){return t.map(f=>ae(f.x,f.y,d,a.getElevation))}queryRenderedSymbols(t){if(t.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const a=[];let d=1/0,f=1/0,g=-1/0,E=-1/0;for(const L of t){const O=new c.P(L.x+Jt,L.y+Jt);d=Math.min(d,O.x),f=Math.min(f,O.y),g=Math.max(g,O.x),E=Math.max(E,O.y),a.push(O)}const I=this.grid.query(d,f,g,E).concat(this.ignoredGrid.query(d,f,g,E)),k={},z={};for(const L of I){const O=L.key;if(k[O.bucketInstanceId]===void 0&&(k[O.bucketInstanceId]={}),k[O.bucketInstanceId][O.featureIndex])continue;const V=[new c.P(L.x1,L.y1),new c.P(L.x2,L.y1),new c.P(L.x2,L.y2),new c.P(L.x1,L.y2)];c.am(a,V)&&(k[O.bucketInstanceId][O.featureIndex]=!0,z[O.bucketInstanceId]===void 0&&(z[O.bucketInstanceId]=[]),z[O.bucketInstanceId].push(O.featureIndex))}return z}insertCollisionBox(t,a,d,f,g,E){(d?this.ignoredGrid:this.grid).insert({bucketInstanceId:f,featureIndex:g,collisionGroupID:E,overlapMode:a},t[0],t[1],t[2],t[3])}insertCollisionCircles(t,a,d,f,g,E){const I=d?this.ignoredGrid:this.grid,k={bucketInstanceId:f,featureIndex:g,collisionGroupID:E,overlapMode:a};for(let z=0;z<t.length;z+=4)I.insertCircle(k,t[z],t[z+1],t[z+2])}projectAndGetPerspectiveRatio(t,a,d,f,g){let E;g?(E=[a,d,g(a,d),1],c.af(E,E,t)):(E=[a,d,0,1],In(E,E,t));const I=E[3];return{point:new c.P((E[0]/I+1)/2*this.transform.width+Jt,(-E[1]/I+1)/2*this.transform.height+Jt),perspectiveRatio:.5+this.transform.cameraToCenterDistance/I*.5,isOccluded:!1,signedDistanceFromCamera:I}}getPerspectiveRatio(t,a,d,f,g){const E=this.mapProjection.useSpecialProjectionForSymbols?this.mapProjection.projectTileCoordinates(a,d,f,g):ae(a,d,t,g);return .5+this.transform.cameraToCenterDistance/E.signedDistanceFromCamera*.5}isOffscreen(t,a,d,f){return d<Jt||t>=this.screenRightBoundary||f<Jt||a>this.screenBottomBoundary}isInsideGrid(t,a,d,f){return d>=0&&t<this.gridRightBoundary&&f>=0&&a<this.gridBottomBoundary}getViewportMatrix(){const t=c.an([]);return c.J(t,t,[-100,-100,0]),t}_projectCollisionBox(t,a,d,f,g,E,I,k,z,L){let O=new c.P(1,0),V=new c.P(0,1);const X=new c.P(t.anchorPointX+I[0],t.anchorPointY+I[1]);if(E&&!g){const lt=this.projectAndGetPerspectiveRatio(d,X.x+1,X.y,f,z).point.sub(k.point).unit(),pt=Math.atan(lt.y/lt.x)+(lt.x<0?Math.PI:0),ot=Math.sin(pt),at=Math.cos(pt);O=new c.P(at,ot),V=new c.P(-ot,at)}else if(!E&&g){const lt=-this.transform.angle,pt=Math.sin(lt),ot=Math.cos(lt);O=new c.P(ot,pt),V=new c.P(-pt,ot)}let Q=k.point,ie=a;if(g){Q=X;const lt=this.transform.zoom-Math.floor(this.transform.zoom);ie=Math.pow(2,-lt),ie*=this.mapProjection.getPitchedTextCorrection(this.transform,X,f),L||(ie*=c.ac(.5+k.signedDistanceFromCamera/this.transform.cameraToCenterDistance*.5,0,4))}L&&(Q=Q.add(O.mult(L.x*ie)).add(V.mult(L.y*ie)));const le=t.x1*ie,ce=t.x2*ie,me=(le+ce)/2,te=t.y1*ie,xe=t.y2*ie,be=(te+xe)/2,Me=[{offsetX:le,offsetY:te},{offsetX:me,offsetY:te},{offsetX:ce,offsetY:te},{offsetX:ce,offsetY:be},{offsetX:ce,offsetY:xe},{offsetX:me,offsetY:xe},{offsetX:le,offsetY:xe},{offsetX:le,offsetY:be}];let qe=[];for(const{offsetX:lt,offsetY:pt}of Me)qe.push(new c.P(Q.x+O.x*lt+V.x*pt,Q.y+O.y*lt+V.y*pt));let et=!1;if(g){const lt=qe.map(pt=>this.projectAndGetPerspectiveRatio(d,pt.x,pt.y,f,z));et=lt.some(pt=>!pt.isOccluded),qe=lt.map(pt=>pt.point)}else et=!0;return{box:c.ao(qe),allPointsOccluded:!et}}}function fn(y,t,a){return t*(c.X/(y.tileSize*Math.pow(2,a-y.tileID.overscaledZ)))}class Ar{constructor(t,a,d,f){this.opacity=t?Math.max(0,Math.min(1,t.opacity+(t.placed?a:-a))):f&&d?1:0,this.placed=d}isHidden(){return this.opacity===0&&!this.placed}}class xr{constructor(t,a,d,f,g){this.text=new Ar(t?t.text:null,a,d,g),this.icon=new Ar(t?t.icon:null,a,f,g)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class on{constructor(t,a,d){this.text=t,this.icon=a,this.skipFade=d}}class Gn{constructor(){this.invProjMatrix=c.H(),this.viewportMatrix=c.H(),this.circles=[]}}class ur{constructor(t,a,d,f,g){this.bucketInstanceId=t,this.featureIndex=a,this.sourceLayerIndex=d,this.bucketIndex=f,this.tileID=g}}class Xr{constructor(t){this.crossSourceCollisions=t,this.maxGroupID=0,this.collisionGroups={}}get(t){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[t]){const a=++this.maxGroupID;this.collisionGroups[t]={ID:a,predicate:d=>d.collisionGroupID===a}}return this.collisionGroups[t]}}function ni(y,t,a,d,f){const{horizontalAlign:g,verticalAlign:E}=c.au(y);return new c.P(-(g-.5)*t+d[0]*f,-(E-.5)*a+d[1]*f)}class Kr{constructor(t,a,d,f,g,E){this.transform=t.clone(),this.terrain=d,this.collisionIndex=new kn(this.transform,a),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=f,this.retainedQueryData={},this.collisionGroups=new Xr(g),this.collisionCircleArrays={},this.collisionBoxArrays=new Map,this.prevPlacement=E,E&&(E.prevPlacement=void 0),this.placedOrientations={}}_getTerrainElevationFunc(t){const a=this.terrain;return a?(d,f)=>a.getElevation(t,d,f):null}getBucketParts(t,a,d,f){const g=d.getBucket(a),E=d.latestFeatureIndex;if(!g||!E||a.id!==g.layerIds[0])return;const I=d.collisionBoxArray,k=g.layers[0].layout,z=g.layers[0].paint,L=Math.pow(2,this.transform.zoom-d.tileID.overscaledZ),O=d.tileSize/c.X,V=d.tileID.toUnwrapped(),X=this.transform.calculatePosMatrix(V),Q=k.get("text-pitch-alignment")==="map",ie=k.get("text-rotation-alignment")==="map",le=fn(d,1,this.transform.zoom),ce=this.collisionIndex.mapProjection.translatePosition(this.transform,d,z.get("text-translate"),z.get("text-translate-anchor")),me=this.collisionIndex.mapProjection.translatePosition(this.transform,d,z.get("icon-translate"),z.get("icon-translate-anchor")),te=ho(X,Q,ie,this.transform,le);let xe=null;if(Q){const Me=Rs(X,Q,ie,this.transform,le);xe=c.L([],this.transform.labelPlaneMatrix,Me)}this.retainedQueryData[g.bucketInstanceId]=new ur(g.bucketInstanceId,E,g.sourceLayerIndex,g.index,d.tileID);const be={bucket:g,layout:k,translationText:ce,translationIcon:me,posMatrix:X,unwrappedTileID:V,textLabelPlaneMatrix:te,labelToScreenMatrix:xe,scale:L,textPixelRatio:O,holdingForFade:d.holdingForFade(),collisionBoxArray:I,partiallyEvaluatedTextSize:c.ag(g.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(g.sourceID)};if(f)for(const Me of g.sortKeyRanges){const{sortKey:qe,symbolInstanceStart:et,symbolInstanceEnd:lt}=Me;t.push({sortKey:qe,symbolInstanceStart:et,symbolInstanceEnd:lt,parameters:be})}else t.push({symbolInstanceStart:0,symbolInstanceEnd:g.symbolInstances.length,parameters:be})}attemptAnchorPlacement(t,a,d,f,g,E,I,k,z,L,O,V,X,Q,ie,le,ce,me,te){const xe=c.aq[t.textAnchor],be=[t.textOffset0,t.textOffset1],Me=ni(xe,d,f,be,g),qe=this.collisionIndex.placeCollisionBox(a,V,k,z,L,I,E,le,O.predicate,te,Me);if((!me||this.collisionIndex.placeCollisionBox(me,V,k,z,L,I,E,ce,O.predicate,te,Me).placeable)&&qe.placeable){let et;if(this.prevPlacement&&this.prevPlacement.variableOffsets[X.crossTileID]&&this.prevPlacement.placements[X.crossTileID]&&this.prevPlacement.placements[X.crossTileID].text&&(et=this.prevPlacement.variableOffsets[X.crossTileID].anchor),X.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[X.crossTileID]={textOffset:be,width:d,height:f,anchor:xe,textBoxScale:g,prevAnchor:et},this.markUsedJustification(Q,xe,X,ie),Q.allowVerticalPlacement&&(this.markUsedOrientation(Q,ie,X),this.placedOrientations[X.crossTileID]=ie),{shift:Me,placedGlyphBoxes:qe}}}placeLayerBucketPart(t,a,d){const{bucket:f,layout:g,translationText:E,translationIcon:I,posMatrix:k,unwrappedTileID:z,textLabelPlaneMatrix:L,labelToScreenMatrix:O,textPixelRatio:V,holdingForFade:X,collisionBoxArray:Q,partiallyEvaluatedTextSize:ie,collisionGroup:le}=t.parameters,ce=g.get("text-optional"),me=g.get("icon-optional"),te=c.ar(g,"text-overlap","text-allow-overlap"),xe=te==="always",be=c.ar(g,"icon-overlap","icon-allow-overlap"),Me=be==="always",qe=g.get("text-rotation-alignment")==="map",et=g.get("text-pitch-alignment")==="map",lt=g.get("icon-text-fit")!=="none",pt=g.get("symbol-z-order")==="viewport-y",ot=xe&&(Me||!f.hasIconData()||me),at=Me&&(xe||!f.hasTextData()||ce);!f.collisionArrays&&Q&&f.deserializeCollisionBoxes(Q);const wt=this._getTerrainElevationFunc(this.retainedQueryData[f.bucketInstanceId].tileID),Gt=(dt,nt,jt)=>{var sr,$t;if(a[dt.crossTileID])return;if(X)return void(this.placements[dt.crossTileID]=new on(!1,!1,!1));let un=!1,Xn=!1,Cr=!0,ms=null,hn={box:null,placeable:!1,offscreen:null},pi={box:null,placeable:!1,offscreen:null},Ii=null,mi=null,ki=null,gs=0,wl=0,Yo=0;nt.textFeatureIndex?gs=nt.textFeatureIndex:dt.useRuntimeCollisionCircles&&(gs=dt.featureIndex),nt.verticalTextFeatureIndex&&(wl=nt.verticalTextFeatureIndex);const za=nt.textBox;if(za){const ys=si=>{let gi=c.ah.horizontal;if(f.allowVerticalPlacement&&!si&&this.prevPlacement){const Qi=this.prevPlacement.placedOrientations[dt.crossTileID];Qi&&(this.placedOrientations[dt.crossTileID]=Qi,gi=Qi,this.markUsedOrientation(f,gi,dt))}return gi},vs=(si,gi)=>{if(f.allowVerticalPlacement&&dt.numVerticalGlyphVertices>0&&nt.verticalTextBox){for(const Qi of f.writingModes)if(Qi===c.ah.vertical?(hn=gi(),pi=hn):hn=si(),hn&&hn.placeable)break}else hn=si()},to=dt.textAnchorOffsetStartIndex,xs=dt.textAnchorOffsetEndIndex;if(xs===to){const si=(gi,Qi)=>{const gn=this.collisionIndex.placeCollisionBox(gi,te,V,k,z,et,qe,E,le.predicate,wt);return gn&&gn.placeable&&(this.markUsedOrientation(f,Qi,dt),this.placedOrientations[dt.crossTileID]=Qi),gn};vs(()=>si(za,c.ah.horizontal),()=>{const gi=nt.verticalTextBox;return f.allowVerticalPlacement&&dt.numVerticalGlyphVertices>0&&gi?si(gi,c.ah.vertical):{box:null,offscreen:null}}),ys(hn&&hn.placeable)}else{let si=c.aq[($t=(sr=this.prevPlacement)===null||sr===void 0?void 0:sr.variableOffsets[dt.crossTileID])===null||$t===void 0?void 0:$t.anchor];const gi=(gn,So,bl)=>{const Jo=gn.x2-gn.x1,Sh=gn.y2-gn.y1,Bd=dt.textBoxScale,Th=lt&&be==="never"?So:null;let Bs=null,Nd=te==="never"?1:2,iu="never";si&&Nd++;for(let Sl=0;Sl<Nd;Sl++){for(let lc=to;lc<xs;lc++){const su=f.textAnchorOffsets.get(lc);if(si&&su.textAnchor!==si)continue;const Tl=this.attemptAnchorPlacement(su,gn,Jo,Sh,Bd,qe,et,V,k,z,le,iu,dt,f,bl,E,I,Th,wt);if(Tl&&(Bs=Tl.placedGlyphBoxes,Bs&&Bs.placeable))return un=!0,ms=Tl.shift,Bs}si?si=null:iu=te}return d&&!Bs&&(Bs={box:this.collisionIndex.placeCollisionBox(za,"always",V,k,z,et,qe,E,le.predicate,wt,new c.P(0,0)).box,offscreen:!1,placeable:!1}),Bs};vs(()=>gi(za,nt.iconBox,c.ah.horizontal),()=>{const gn=nt.verticalTextBox;return f.allowVerticalPlacement&&(!hn||!hn.placeable)&&dt.numVerticalGlyphVertices>0&&gn?gi(gn,nt.verticalIconBox,c.ah.vertical):{box:null,occluded:!0,offscreen:null}}),hn&&(un=hn.placeable,Cr=hn.offscreen);const Qi=ys(hn&&hn.placeable);if(!un&&this.prevPlacement){const gn=this.prevPlacement.variableOffsets[dt.crossTileID];gn&&(this.variableOffsets[dt.crossTileID]=gn,this.markUsedJustification(f,gn.anchor,dt,Qi))}}}if(Ii=hn,un=Ii&&Ii.placeable,Cr=Ii&&Ii.offscreen,dt.useRuntimeCollisionCircles){const ys=f.text.placedSymbolArray.get(dt.centerJustifiedTextSymbolIndex),vs=c.ai(f.textSizeData,ie,ys),to=g.get("text-padding");mi=this.collisionIndex.placeCollisionCircles(te,ys,f.lineVertexArray,f.glyphOffsetArray,vs,k,z,L,O,d,et,le.predicate,dt.collisionCircleDiameter,to,E,wt),mi.circles.length&&mi.collisionDetected&&!d&&c.w("Collisions detected, but collision boxes are not shown"),un=xe||mi.circles.length>0&&!mi.collisionDetected,Cr=Cr&&mi.offscreen}if(nt.iconFeatureIndex&&(Yo=nt.iconFeatureIndex),nt.iconBox){const ys=vs=>this.collisionIndex.placeCollisionBox(vs,be,V,k,z,et,qe,I,le.predicate,wt,lt&&ms?ms:void 0);pi&&pi.placeable&&nt.verticalIconBox?(ki=ys(nt.verticalIconBox),Xn=ki.placeable):(ki=ys(nt.iconBox),Xn=ki.placeable),Cr=Cr&&ki.offscreen}const _s=ce||dt.numHorizontalGlyphVertices===0&&dt.numVerticalGlyphVertices===0,ac=me||dt.numIconVertices===0;_s||ac?ac?_s||(Xn=Xn&&un):un=Xn&&un:Xn=un=Xn&&un;const Da=Xn&&ki.placeable;if(un&&Ii.placeable&&this.collisionIndex.insertCollisionBox(Ii.box,te,g.get("text-ignore-placement"),f.bucketInstanceId,pi&&pi.placeable&&wl?wl:gs,le.ID),Da&&this.collisionIndex.insertCollisionBox(ki.box,be,g.get("icon-ignore-placement"),f.bucketInstanceId,Yo,le.ID),mi&&un&&this.collisionIndex.insertCollisionCircles(mi.circles,te,g.get("text-ignore-placement"),f.bucketInstanceId,gs,le.ID),d&&this.storeCollisionData(f.bucketInstanceId,jt,nt,Ii,ki,mi),dt.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(f.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[dt.crossTileID]=new on(un||ot,Xn||at,Cr||f.justReloaded),a[dt.crossTileID]=!0};if(pt){if(t.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const dt=f.getSortedSymbolIndexes(this.transform.angle);for(let nt=dt.length-1;nt>=0;--nt){const jt=dt[nt];Gt(f.symbolInstances.get(jt),f.collisionArrays[jt],jt)}}else for(let dt=t.symbolInstanceStart;dt<t.symbolInstanceEnd;dt++)Gt(f.symbolInstances.get(dt),f.collisionArrays[dt],dt);if(d&&f.bucketInstanceId in this.collisionCircleArrays){const dt=this.collisionCircleArrays[f.bucketInstanceId];c.as(dt.invProjMatrix,k),dt.viewportMatrix=this.collisionIndex.getViewportMatrix()}f.justReloaded=!1}storeCollisionData(t,a,d,f,g,E){if(d.textBox||d.iconBox){let I,k;this.collisionBoxArrays.has(t)?I=this.collisionBoxArrays.get(t):(I=new Map,this.collisionBoxArrays.set(t,I)),I.has(a)?k=I.get(a):(k={text:null,icon:null},I.set(a,k)),d.textBox&&(k.text=f.box),d.iconBox&&(k.icon=g.box)}if(E){let I=this.collisionCircleArrays[t];I===void 0&&(I=this.collisionCircleArrays[t]=new Gn);for(let k=0;k<E.circles.length;k+=4)I.circles.push(E.circles[k+0]),I.circles.push(E.circles[k+1]),I.circles.push(E.circles[k+2]),I.circles.push(E.collisionDetected?1:0)}}markUsedJustification(t,a,d,f){let g;g=f===c.ah.vertical?d.verticalPlacedTextSymbolIndex:{left:d.leftJustifiedTextSymbolIndex,center:d.centerJustifiedTextSymbolIndex,right:d.rightJustifiedTextSymbolIndex}[c.at(a)];const E=[d.leftJustifiedTextSymbolIndex,d.centerJustifiedTextSymbolIndex,d.rightJustifiedTextSymbolIndex,d.verticalPlacedTextSymbolIndex];for(const I of E)I>=0&&(t.text.placedSymbolArray.get(I).crossTileID=g>=0&&I!==g?0:d.crossTileID)}markUsedOrientation(t,a,d){const f=a===c.ah.horizontal||a===c.ah.horizontalOnly?a:0,g=a===c.ah.vertical?a:0,E=[d.leftJustifiedTextSymbolIndex,d.centerJustifiedTextSymbolIndex,d.rightJustifiedTextSymbolIndex];for(const I of E)t.text.placedSymbolArray.get(I).placedOrientation=f;d.verticalPlacedTextSymbolIndex&&(t.text.placedSymbolArray.get(d.verticalPlacedTextSymbolIndex).placedOrientation=g)}commit(t){this.commitTime=t,this.zoomAtLastRecencyCheck=this.transform.zoom;const a=this.prevPlacement;let d=!1;this.prevZoomAdjustment=a?a.zoomAdjustment(this.transform.zoom):0;const f=a?a.symbolFadeChange(t):1,g=a?a.opacities:{},E=a?a.variableOffsets:{},I=a?a.placedOrientations:{};for(const k in this.placements){const z=this.placements[k],L=g[k];L?(this.opacities[k]=new xr(L,f,z.text,z.icon),d=d||z.text!==L.text.placed||z.icon!==L.icon.placed):(this.opacities[k]=new xr(null,f,z.text,z.icon,z.skipFade),d=d||z.text||z.icon)}for(const k in g){const z=g[k];if(!this.opacities[k]){const L=new xr(z,f,!1,!1);L.isHidden()||(this.opacities[k]=L,d=d||z.text.placed||z.icon.placed)}}for(const k in E)this.variableOffsets[k]||!this.opacities[k]||this.opacities[k].isHidden()||(this.variableOffsets[k]=E[k]);for(const k in I)this.placedOrientations[k]||!this.opacities[k]||this.opacities[k].isHidden()||(this.placedOrientations[k]=I[k]);if(a&&a.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");d?this.lastPlacementChangeTime=t:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=a?a.lastPlacementChangeTime:t)}updateLayerOpacities(t,a){const d={};for(const f of a){const g=f.getBucket(t);g&&f.latestFeatureIndex&&t.id===g.layerIds[0]&&this.updateBucketOpacities(g,f.tileID,d,f.collisionBoxArray)}}updateBucketOpacities(t,a,d,f){t.hasTextData()&&(t.text.opacityVertexArray.clear(),t.text.hasVisibleVertices=!1),t.hasIconData()&&(t.icon.opacityVertexArray.clear(),t.icon.hasVisibleVertices=!1),t.hasIconCollisionBoxData()&&t.iconCollisionBox.collisionVertexArray.clear(),t.hasTextCollisionBoxData()&&t.textCollisionBox.collisionVertexArray.clear();const g=t.layers[0],E=g.layout,I=new xr(null,0,!1,!1,!0),k=E.get("text-allow-overlap"),z=E.get("icon-allow-overlap"),L=g._unevaluatedLayout.hasValue("text-variable-anchor")||g._unevaluatedLayout.hasValue("text-variable-anchor-offset"),O=E.get("text-rotation-alignment")==="map",V=E.get("text-pitch-alignment")==="map",X=E.get("icon-text-fit")!=="none",Q=new xr(null,0,k&&(z||!t.hasIconData()||E.get("icon-optional")),z&&(k||!t.hasTextData()||E.get("text-optional")),!0);!t.collisionArrays&&f&&(t.hasIconCollisionBoxData()||t.hasTextCollisionBoxData())&&t.deserializeCollisionBoxes(f);const ie=(ce,me,te)=>{for(let xe=0;xe<me/4;xe++)ce.opacityVertexArray.emplaceBack(te);ce.hasVisibleVertices=ce.hasVisibleVertices||te!==tl},le=this.collisionBoxArrays.get(t.bucketInstanceId);for(let ce=0;ce<t.symbolInstances.length;ce++){const me=t.symbolInstances.get(ce),{numHorizontalGlyphVertices:te,numVerticalGlyphVertices:xe,crossTileID:be}=me;let Me=this.opacities[be];d[be]?Me=I:Me||(Me=Q,this.opacities[be]=Me),d[be]=!0;const qe=me.numIconVertices>0,et=this.placedOrientations[me.crossTileID],lt=et===c.ah.vertical,pt=et===c.ah.horizontal||et===c.ah.horizontalOnly;if(te>0||xe>0){const at=Xi(Me.text);ie(t.text,te,lt?tl:at),ie(t.text,xe,pt?tl:at);const wt=Me.text.isHidden();[me.rightJustifiedTextSymbolIndex,me.centerJustifiedTextSymbolIndex,me.leftJustifiedTextSymbolIndex].forEach(nt=>{nt>=0&&(t.text.placedSymbolArray.get(nt).hidden=wt||lt?1:0)}),me.verticalPlacedTextSymbolIndex>=0&&(t.text.placedSymbolArray.get(me.verticalPlacedTextSymbolIndex).hidden=wt||pt?1:0);const Gt=this.variableOffsets[me.crossTileID];Gt&&this.markUsedJustification(t,Gt.anchor,me,et);const dt=this.placedOrientations[me.crossTileID];dt&&(this.markUsedJustification(t,"left",me,dt),this.markUsedOrientation(t,dt,me))}if(qe){const at=Xi(Me.icon),wt=!(X&&me.verticalPlacedIconSymbolIndex&&lt);me.placedIconSymbolIndex>=0&&(ie(t.icon,me.numIconVertices,wt?at:tl),t.icon.placedSymbolArray.get(me.placedIconSymbolIndex).hidden=Me.icon.isHidden()),me.verticalPlacedIconSymbolIndex>=0&&(ie(t.icon,me.numVerticalIconVertices,wt?tl:at),t.icon.placedSymbolArray.get(me.verticalPlacedIconSymbolIndex).hidden=Me.icon.isHidden())}const ot=le&&le.has(ce)?le.get(ce):{text:null,icon:null};if(t.hasIconCollisionBoxData()||t.hasTextCollisionBoxData()){const at=t.collisionArrays[ce];if(at){let wt=new c.P(0,0);if(at.textBox||at.verticalTextBox){let Gt=!0;if(L){const dt=this.variableOffsets[be];dt?(wt=ni(dt.anchor,dt.width,dt.height,dt.textOffset,dt.textBoxScale),O&&wt._rotate(V?this.transform.angle:-this.transform.angle)):Gt=!1}if(at.textBox||at.verticalTextBox){let dt;at.textBox&&(dt=lt),at.verticalTextBox&&(dt=pt),el(t.textCollisionBox.collisionVertexArray,Me.text.placed,!Gt||dt,ot.text,wt.x,wt.y)}}if(at.iconBox||at.verticalIconBox){const Gt=!!(!pt&&at.verticalIconBox);let dt;at.iconBox&&(dt=Gt),at.verticalIconBox&&(dt=!Gt),el(t.iconCollisionBox.collisionVertexArray,Me.icon.placed,dt,ot.icon,X?wt.x:0,X?wt.y:0)}}}}if(t.sortFeatures(this.transform.angle),this.retainedQueryData[t.bucketInstanceId]&&(this.retainedQueryData[t.bucketInstanceId].featureSortOrder=t.featureSortOrder),t.hasTextData()&&t.text.opacityVertexBuffer&&t.text.opacityVertexBuffer.updateData(t.text.opacityVertexArray),t.hasIconData()&&t.icon.opacityVertexBuffer&&t.icon.opacityVertexBuffer.updateData(t.icon.opacityVertexArray),t.hasIconCollisionBoxData()&&t.iconCollisionBox.collisionVertexBuffer&&t.iconCollisionBox.collisionVertexBuffer.updateData(t.iconCollisionBox.collisionVertexArray),t.hasTextCollisionBoxData()&&t.textCollisionBox.collisionVertexBuffer&&t.textCollisionBox.collisionVertexBuffer.updateData(t.textCollisionBox.collisionVertexArray),t.text.opacityVertexArray.length!==t.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${t.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${t.text.layoutVertexArray.length}) / 4`);if(t.icon.opacityVertexArray.length!==t.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${t.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${t.icon.layoutVertexArray.length}) / 4`);if(t.bucketInstanceId in this.collisionCircleArrays){const ce=this.collisionCircleArrays[t.bucketInstanceId];t.placementInvProjMatrix=ce.invProjMatrix,t.placementViewportMatrix=ce.viewportMatrix,t.collisionCircleArray=ce.circles,delete this.collisionCircleArrays[t.bucketInstanceId]}}symbolFadeChange(t){return this.fadeDuration===0?1:(t-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(t){return Math.max(0,(this.transform.zoom-t)/1.5)}hasTransitions(t){return this.stale||t-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(t,a){const d=this.zoomAtLastRecencyCheck===a?1-this.zoomAdjustment(a):1;return this.zoomAtLastRecencyCheck=a,this.commitTime+this.fadeDuration*d>t}setStale(){this.stale=!0}}function el(y,t,a,d,f,g){d&&d.length!==0||(d=[0,0,0,0]);const E=d[0]-Jt,I=d[1]-Jt,k=d[2]-Jt,z=d[3]-Jt;y.emplaceBack(t?1:0,a?1:0,f||0,g||0,E,I),y.emplaceBack(t?1:0,a?1:0,f||0,g||0,k,I),y.emplaceBack(t?1:0,a?1:0,f||0,g||0,k,z),y.emplaceBack(t?1:0,a?1:0,f||0,g||0,E,z)}const Rn=Math.pow(2,25),Hc=Math.pow(2,24),Xc=Math.pow(2,17),Wi=Math.pow(2,16),Ri=Math.pow(2,9),md=Math.pow(2,8),Hi=Math.pow(2,1);function Xi(y){if(y.opacity===0&&!y.placed)return 0;if(y.opacity===1&&y.placed)return 4294967295;const t=y.placed?1:0,a=Math.floor(127*y.opacity);return a*Rn+t*Hc+a*Xc+t*Wi+a*Ri+t*md+a*Hi+t}const tl=0;function pa(){return{isOccluded:(y,t,a)=>!1,getPitchedTextCorrection:(y,t,a)=>1,get useSpecialProjectionForSymbols(){return!1},projectTileCoordinates(y,t,a,d){throw new Error("Not implemented.")},translatePosition:(y,t,a,d)=>function(f,g,E,I,k=!1){if(!E[0]&&!E[1])return[0,0];const z=k?I==="map"?f.angle:0:I==="viewport"?-f.angle:0;if(z){const L=Math.sin(z),O=Math.cos(z);E=[E[0]*O-E[1]*L,E[0]*L+E[1]*O]}return[k?E[0]:fn(g,E[0],f.zoom),k?E[1]:fn(g,E[1],f.zoom)]}(y,t,a,d),getCircleRadiusCorrection:y=>1}}class Or{constructor(t){this._sortAcrossTiles=t.layout.get("symbol-z-order")!=="viewport-y"&&!t.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(t,a,d,f,g){const E=this._bucketParts;for(;this._currentTileIndex<t.length;)if(a.getBucketParts(E,f,t[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,g())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,E.sort((I,k)=>I.sortKey-k.sortKey));this._currentPartIndex<E.length;)if(a.placeLayerBucketPart(E[this._currentPartIndex],this._seenCrossTileIDs,d),this._currentPartIndex++,g())return!0;return!1}}class nl{constructor(t,a,d,f,g,E,I,k){this.placement=new Kr(t,pa(),a,E,I,k),this._currentPlacementIndex=d.length-1,this._forceFullPlacement=f,this._showCollisionBoxes=g,this._done=!1}isDone(){return this._done}continuePlacement(t,a,d){const f=W.now(),g=()=>!this._forceFullPlacement&&W.now()-f>2;for(;this._currentPlacementIndex>=0;){const E=a[t[this._currentPlacementIndex]],I=this.placement.collisionIndex.transform.zoom;if(E.type==="symbol"&&(!E.minzoom||E.minzoom<=I)&&(!E.maxzoom||E.maxzoom>I)){if(this._inProgressLayer||(this._inProgressLayer=new Or(E)),this._inProgressLayer.continuePlacement(d[E.source],this.placement,this._showCollisionBoxes,E,g))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(t){return this.placement.commit(t),this.placement}}const ls=512/c.X/2;class Er{constructor(t,a,d){this.tileID=t,this.bucketInstanceId=d,this._symbolsByKey={};const f=new Map;for(let g=0;g<a.length;g++){const E=a.get(g),I=E.key,k=f.get(I);k?k.push(E):f.set(I,[E])}for(const[g,E]of f){const I={positions:E.map(k=>({x:Math.floor(k.anchorX*ls),y:Math.floor(k.anchorY*ls)})),crossTileIDs:E.map(k=>k.crossTileID)};if(I.positions.length>128){const k=new c.av(I.positions.length,16,Uint16Array);for(const{x:z,y:L}of I.positions)k.add(z,L);k.finish(),delete I.positions,I.index=k}this._symbolsByKey[g]=I}}getScaledCoordinates(t,a){const{x:d,y:f,z:g}=this.tileID.canonical,{x:E,y:I,z:k}=a.canonical,z=ls/Math.pow(2,k-g),L=(I*c.X+t.anchorY)*z,O=f*c.X*ls;return{x:Math.floor((E*c.X+t.anchorX)*z-d*c.X*ls),y:Math.floor(L-O)}}findMatches(t,a,d){const f=this.tileID.canonical.z<a.canonical.z?1:Math.pow(2,this.tileID.canonical.z-a.canonical.z);for(let g=0;g<t.length;g++){const E=t.get(g);if(E.crossTileID)continue;const I=this._symbolsByKey[E.key];if(!I)continue;const k=this.getScaledCoordinates(E,a);if(I.index){const z=I.index.range(k.x-f,k.y-f,k.x+f,k.y+f).sort();for(const L of z){const O=I.crossTileIDs[L];if(!d[O]){d[O]=!0,E.crossTileID=O;break}}}else if(I.positions)for(let z=0;z<I.positions.length;z++){const L=I.positions[z],O=I.crossTileIDs[z];if(Math.abs(L.x-k.x)<=f&&Math.abs(L.y-k.y)<=f&&!d[O]){d[O]=!0,E.crossTileID=O;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map(({crossTileIDs:t})=>t)}}class rl{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Ls{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(t){const a=Math.round((t-this.lng)/360);if(a!==0)for(const d in this.indexes){const f=this.indexes[d],g={};for(const E in f){const I=f[E];I.tileID=I.tileID.unwrapTo(I.tileID.wrap+a),g[I.tileID.key]=I}this.indexes[d]=g}this.lng=t}addBucket(t,a,d){if(this.indexes[t.overscaledZ]&&this.indexes[t.overscaledZ][t.key]){if(this.indexes[t.overscaledZ][t.key].bucketInstanceId===a.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(t.overscaledZ,this.indexes[t.overscaledZ][t.key])}for(let g=0;g<a.symbolInstances.length;g++)a.symbolInstances.get(g).crossTileID=0;this.usedCrossTileIDs[t.overscaledZ]||(this.usedCrossTileIDs[t.overscaledZ]={});const f=this.usedCrossTileIDs[t.overscaledZ];for(const g in this.indexes){const E=this.indexes[g];if(Number(g)>t.overscaledZ)for(const I in E){const k=E[I];k.tileID.isChildOf(t)&&k.findMatches(a.symbolInstances,t,f)}else{const I=E[t.scaledTo(Number(g)).key];I&&I.findMatches(a.symbolInstances,t,f)}}for(let g=0;g<a.symbolInstances.length;g++){const E=a.symbolInstances.get(g);E.crossTileID||(E.crossTileID=d.generate(),f[E.crossTileID]=!0)}return this.indexes[t.overscaledZ]===void 0&&(this.indexes[t.overscaledZ]={}),this.indexes[t.overscaledZ][t.key]=new Er(t,a.symbolInstances,a.bucketInstanceId),!0}removeBucketCrossTileIDs(t,a){for(const d of a.getCrossTileIDsLists())for(const f of d)delete this.usedCrossTileIDs[t][f]}removeStaleBuckets(t){let a=!1;for(const d in this.indexes){const f=this.indexes[d];for(const g in f)t[f[g].bucketInstanceId]||(this.removeBucketCrossTileIDs(d,f[g]),delete f[g],a=!0)}return a}}class Bu{constructor(){this.layerIndexes={},this.crossTileIDs=new rl,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(t,a,d){let f=this.layerIndexes[t.id];f===void 0&&(f=this.layerIndexes[t.id]=new Ls);let g=!1;const E={};f.handleWrapJump(d);for(const I of a){const k=I.getBucket(t);k&&t.id===k.layerIds[0]&&(k.bucketInstanceId||(k.bucketInstanceId=++this.maxBucketInstanceId),f.addBucket(I.tileID,k,this.crossTileIDs)&&(g=!0),E[k.bucketInstanceId]=!0)}return f.removeStaleBuckets(E)&&(g=!0),g}pruneUnusedLayers(t){const a={};t.forEach(d=>{a[d]=!0});for(const d in this.layerIndexes)a[d]||delete this.layerIndexes[d]}}const Li=(y,t)=>c.t(y,t&&t.filter(a=>a.identifier!=="source.canvas")),gd=c.aw();class Nu extends c.E{constructor(t,a={}){super(),this._rtlPluginLoaded=()=>{for(const d in this.sourceCaches){const f=this.sourceCaches[d].getSource().type;f!=="vector"&&f!=="geojson"||this.sourceCaches[d].reload()}},this.map=t,this.dispatcher=new Zn(rn(),t._getMapId()),this.dispatcher.registerMessageHandler("GG",(d,f)=>this.getGlyphs(d,f)),this.dispatcher.registerMessageHandler("GI",(d,f)=>this.getImages(d,f)),this.imageManager=new mt,this.imageManager.setEventedParent(this),this.glyphManager=new zt(t._requestManager,a.localIdeographFontFamily),this.lineAtlas=new St(256,512),this.crossTileSymbolIndex=new Bu,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new c.ax,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("SR",c.ay()),jr().on(Ke,this._rtlPluginLoaded),this.on("data",d=>{if(d.dataType!=="source"||d.sourceDataType!=="metadata")return;const f=this.sourceCaches[d.sourceId];if(!f)return;const g=f.getSource();if(g&&g.vectorLayerIds)for(const E in this._layers){const I=this._layers[E];I.source===g.id&&this._validateLayer(I)}})}loadURL(t,a={},d){this.fire(new c.k("dataloading",{dataType:"style"})),a.validate=typeof a.validate!="boolean"||a.validate;const f=this.map._requestManager.transformRequest(t,"Style");this._loadStyleRequest=new AbortController;const g=this._loadStyleRequest;c.h(f,this._loadStyleRequest).then(E=>{this._loadStyleRequest=null,this._load(E.data,a,d)}).catch(E=>{this._loadStyleRequest=null,E&&!g.signal.aborted&&this.fire(new c.j(E))})}loadJSON(t,a={},d){this.fire(new c.k("dataloading",{dataType:"style"})),this._frameRequest=new AbortController,W.frameAsync(this._frameRequest).then(()=>{this._frameRequest=null,a.validate=a.validate!==!1,this._load(t,a,d)}).catch(()=>{})}loadEmpty(){this.fire(new c.k("dataloading",{dataType:"style"})),this._load(gd,{validate:!1})}_load(t,a,d){var f;const g=a.transformStyle?a.transformStyle(d,t):t;if(!a.validate||!Li(this,c.u(g))){this._loaded=!0,this.stylesheet=g;for(const E in g.sources)this.addSource(E,g.sources[E],{validate:!1});g.sprite?this._loadSprite(g.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(g.glyphs),this._createLayers(),this.light=new Et(this.stylesheet.light),this.sky=new It(this.stylesheet.sky),this.map.setTerrain((f=this.stylesheet.terrain)!==null&&f!==void 0?f:null),this.fire(new c.k("data",{dataType:"style"})),this.fire(new c.k("style.load"))}}_createLayers(){const t=c.az(this.stylesheet.layers);this.dispatcher.broadcast("SL",t),this._order=t.map(a=>a.id),this._layers={},this._serializedLayers=null;for(const a of t){const d=c.aA(a);d.setEventedParent(this,{layer:{id:a.id}}),this._layers[a.id]=d}}_loadSprite(t,a=!1,d=void 0){let f;this.imageManager.setLoaded(!1),this._spriteRequest=new AbortController,function(g,E,I,k){return c._(this,void 0,void 0,function*(){const z=de(g),L=I>1?"@2x":"",O={},V={};for(const{id:X,url:Q}of z){const ie=E.transformRequest(Te(Q,L,".json"),"SpriteJSON");O[X]=c.h(ie,k);const le=E.transformRequest(Te(Q,L,".png"),"SpriteImage");V[X]=he.getImage(le,k)}return yield Promise.all([...Object.values(O),...Object.values(V)]),function(X,Q){return c._(this,void 0,void 0,function*(){const ie={};for(const le in X){ie[le]={};const ce=W.getImageCanvasContext((yield Q[le]).data),me=(yield X[le]).data;for(const te in me){const{width:xe,height:be,x:Me,y:qe,sdf:et,pixelRatio:lt,stretchX:pt,stretchY:ot,content:at,textFitWidth:wt,textFitHeight:Gt}=me[te];ie[le][te]={data:null,pixelRatio:lt,sdf:et,stretchX:pt,stretchY:ot,content:at,textFitWidth:wt,textFitHeight:Gt,spriteData:{width:xe,height:be,x:Me,y:qe,context:ce}}}}return ie})}(O,V)})}(t,this.map._requestManager,this.map.getPixelRatio(),this._spriteRequest).then(g=>{if(this._spriteRequest=null,g)for(const E in g){this._spritesImagesIds[E]=[];const I=this._spritesImagesIds[E]?this._spritesImagesIds[E].filter(k=>!(k in g)):[];for(const k of I)this.imageManager.removeImage(k),this._changedImages[k]=!0;for(const k in g[E]){const z=E==="default"?k:`${E}:${k}`;this._spritesImagesIds[E].push(z),z in this.imageManager.images?this.imageManager.updateImage(z,g[E][k],!1):this.imageManager.addImage(z,g[E][k]),a&&(this._changedImages[z]=!0)}}}).catch(g=>{this._spriteRequest=null,f=g,this.fire(new c.j(f))}).finally(()=>{this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),a&&(this._changed=!0),this.dispatcher.broadcast("SI",this._availableImages),this.fire(new c.k("data",{dataType:"style"})),d&&d(f)})}_unloadSprite(){for(const t of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(t),this._changedImages[t]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new c.k("data",{dataType:"style"}))}_validateLayer(t){const a=this.sourceCaches[t.source];if(!a)return;const d=t.sourceLayer;if(!d)return;const f=a.getSource();(f.type==="geojson"||f.vectorLayerIds&&f.vectorLayerIds.indexOf(d)===-1)&&this.fire(new c.j(new Error(`Source layer "${d}" does not exist on source "${f.id}" as specified by style layer "${t.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const t in this.sourceCaches)if(!this.sourceCaches[t].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(t,a=!1){const d=this._serializedAllLayers();if(!t||t.length===0)return Object.values(a?c.aB(d):d);const f=[];for(const g of t)if(d[g]){const E=a?c.aB(d[g]):d[g];f.push(E)}return f}_serializedAllLayers(){let t=this._serializedLayers;if(t)return t;t=this._serializedLayers={};const a=Object.keys(this._layers);for(const d of a){const f=this._layers[d];f.type!=="custom"&&(t[d]=f.serialize())}return t}hasTransitions(){if(this.light&&this.light.hasTransition()||this.sky&&this.sky.hasTransition())return!0;for(const t in this.sourceCaches)if(this.sourceCaches[t].hasTransition())return!0;for(const t in this._layers)if(this._layers[t].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(t){if(!this._loaded)return;const a=this._changed;if(a){const f=Object.keys(this._updatedLayers),g=Object.keys(this._removedLayers);(f.length||g.length)&&this._updateWorkerLayers(f,g);for(const E in this._updatedSources){const I=this._updatedSources[E];if(I==="reload")this._reloadSource(E);else{if(I!=="clear")throw new Error(`Invalid action ${I}`);this._clearSource(E)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const E in this._updatedPaintProps)this._layers[E].updateTransitions(t);this.light.updateTransitions(t),this.sky.updateTransitions(t),this._resetUpdates()}const d={};for(const f in this.sourceCaches){const g=this.sourceCaches[f];d[f]=g.used,g.used=!1}for(const f of this._order){const g=this._layers[f];g.recalculate(t,this._availableImages),!g.isHidden(t.zoom)&&g.source&&(this.sourceCaches[g.source].used=!0)}for(const f in d){const g=this.sourceCaches[f];!!d[f]!=!!g.used&&g.fire(new c.k("data",{sourceDataType:"visibility",dataType:"source",sourceId:f}))}this.light.recalculate(t),this.sky.recalculate(t),this.z=t.zoom,a&&this.fire(new c.k("data",{dataType:"style"}))}_updateTilesForChangedImages(){const t=Object.keys(this._changedImages);if(t.length){for(const a in this.sourceCaches)this.sourceCaches[a].reloadTilesForDependencies(["icons","patterns"],t);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const t in this.sourceCaches)this.sourceCaches[t].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(t,a){this.dispatcher.broadcast("UL",{layers:this._serializeByIds(t,!1),removedIds:a})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(t,a={}){var d;this._checkLoaded();const f=this.serialize();if(t=a.transformStyle?a.transformStyle(f,t):t,((d=a.validate)===null||d===void 0||d)&&Li(this,c.u(t)))return!1;(t=c.aB(t)).layers=c.az(t.layers);const g=c.aC(f,t),E=this._getOperationsToPerform(g);if(E.unimplemented.length>0)throw new Error(`Unimplemented: ${E.unimplemented.join(", ")}.`);if(E.operations.length===0)return!1;for(const I of E.operations)I();return this.stylesheet=t,this._serializedLayers=null,!0}_getOperationsToPerform(t){const a=[],d=[];for(const f of t)switch(f.command){case"setCenter":case"setZoom":case"setBearing":case"setPitch":continue;case"addLayer":a.push(()=>this.addLayer.apply(this,f.args));break;case"removeLayer":a.push(()=>this.removeLayer.apply(this,f.args));break;case"setPaintProperty":a.push(()=>this.setPaintProperty.apply(this,f.args));break;case"setLayoutProperty":a.push(()=>this.setLayoutProperty.apply(this,f.args));break;case"setFilter":a.push(()=>this.setFilter.apply(this,f.args));break;case"addSource":a.push(()=>this.addSource.apply(this,f.args));break;case"removeSource":a.push(()=>this.removeSource.apply(this,f.args));break;case"setLayerZoomRange":a.push(()=>this.setLayerZoomRange.apply(this,f.args));break;case"setLight":a.push(()=>this.setLight.apply(this,f.args));break;case"setGeoJSONSourceData":a.push(()=>this.setGeoJSONSourceData.apply(this,f.args));break;case"setGlyphs":a.push(()=>this.setGlyphs.apply(this,f.args));break;case"setSprite":a.push(()=>this.setSprite.apply(this,f.args));break;case"setSky":a.push(()=>this.setSky.apply(this,f.args));break;case"setTerrain":a.push(()=>this.map.setTerrain.apply(this,f.args));break;case"setTransition":a.push(()=>{});break;default:d.push(f.command)}return{operations:a,unimplemented:d}}addImage(t,a){if(this.getImage(t))return this.fire(new c.j(new Error(`An image named "${t}" already exists.`)));this.imageManager.addImage(t,a),this._afterImageUpdated(t)}updateImage(t,a){this.imageManager.updateImage(t,a)}getImage(t){return this.imageManager.getImage(t)}removeImage(t){if(!this.getImage(t))return this.fire(new c.j(new Error(`An image named "${t}" does not exist.`)));this.imageManager.removeImage(t),this._afterImageUpdated(t)}_afterImageUpdated(t){this._availableImages=this.imageManager.listImages(),this._changedImages[t]=!0,this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new c.k("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(t,a,d={}){if(this._checkLoaded(),this.sourceCaches[t]!==void 0)throw new Error(`Source "${t}" already exists.`);if(!a.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(a).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(a.type)>=0&&this._validate(c.u.source,`sources.${t}`,a,null,d))return;this.map&&this.map._collectResourceTiming&&(a.collectResourceTiming=!0);const f=this.sourceCaches[t]=new Ut(t,a,this.dispatcher);f.style=this,f.setEventedParent(this,()=>({isSourceLoaded:f.loaded(),source:f.serialize(),sourceId:t})),f.onAdd(this.map),this._changed=!0}removeSource(t){if(this._checkLoaded(),this.sourceCaches[t]===void 0)throw new Error("There is no source with this ID");for(const d in this._layers)if(this._layers[d].source===t)return this.fire(new c.j(new Error(`Source "${t}" cannot be removed while layer "${d}" is using it.`)));const a=this.sourceCaches[t];delete this.sourceCaches[t],delete this._updatedSources[t],a.fire(new c.k("data",{sourceDataType:"metadata",dataType:"source",sourceId:t})),a.setEventedParent(null),a.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(t,a){if(this._checkLoaded(),this.sourceCaches[t]===void 0)throw new Error(`There is no source with this ID=${t}`);const d=this.sourceCaches[t].getSource();if(d.type!=="geojson")throw new Error(`geojsonSource.type is ${d.type}, which is !== 'geojson`);d.setData(a),this._changed=!0}getSource(t){return this.sourceCaches[t]&&this.sourceCaches[t].getSource()}addLayer(t,a,d={}){this._checkLoaded();const f=t.id;if(this.getLayer(f))return void this.fire(new c.j(new Error(`Layer "${f}" already exists on this map.`)));let g;if(t.type==="custom"){if(Li(this,c.aD(t)))return;g=c.aA(t)}else{if("source"in t&&typeof t.source=="object"&&(this.addSource(f,t.source),t=c.aB(t),t=c.e(t,{source:f})),this._validate(c.u.layer,`layers.${f}`,t,{arrayIndex:-1},d))return;g=c.aA(t),this._validateLayer(g),g.setEventedParent(this,{layer:{id:f}})}const E=a?this._order.indexOf(a):this._order.length;if(a&&E===-1)this.fire(new c.j(new Error(`Cannot add layer "${f}" before non-existing layer "${a}".`)));else{if(this._order.splice(E,0,f),this._layerOrderChanged=!0,this._layers[f]=g,this._removedLayers[f]&&g.source&&g.type!=="custom"){const I=this._removedLayers[f];delete this._removedLayers[f],I.type!==g.type?this._updatedSources[g.source]="clear":(this._updatedSources[g.source]="reload",this.sourceCaches[g.source].pause())}this._updateLayer(g),g.onAdd&&g.onAdd(this.map)}}moveLayer(t,a){if(this._checkLoaded(),this._changed=!0,!this._layers[t])return void this.fire(new c.j(new Error(`The layer '${t}' does not exist in the map's style and cannot be moved.`)));if(t===a)return;const d=this._order.indexOf(t);this._order.splice(d,1);const f=a?this._order.indexOf(a):this._order.length;a&&f===-1?this.fire(new c.j(new Error(`Cannot move layer "${t}" before non-existing layer "${a}".`))):(this._order.splice(f,0,t),this._layerOrderChanged=!0)}removeLayer(t){this._checkLoaded();const a=this._layers[t];if(!a)return void this.fire(new c.j(new Error(`Cannot remove non-existing layer "${t}".`)));a.setEventedParent(null);const d=this._order.indexOf(t);this._order.splice(d,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[t]=a,delete this._layers[t],this._serializedLayers&&delete this._serializedLayers[t],delete this._updatedLayers[t],delete this._updatedPaintProps[t],a.onRemove&&a.onRemove(this.map)}getLayer(t){return this._layers[t]}getLayersOrder(){return[...this._order]}hasLayer(t){return t in this._layers}setLayerZoomRange(t,a,d){this._checkLoaded();const f=this.getLayer(t);f?f.minzoom===a&&f.maxzoom===d||(a!=null&&(f.minzoom=a),d!=null&&(f.maxzoom=d),this._updateLayer(f)):this.fire(new c.j(new Error(`Cannot set the zoom range of non-existing layer "${t}".`)))}setFilter(t,a,d={}){this._checkLoaded();const f=this.getLayer(t);if(f){if(!c.aE(f.filter,a))return a==null?(f.filter=void 0,void this._updateLayer(f)):void(this._validate(c.u.filter,`layers.${f.id}.filter`,a,null,d)||(f.filter=c.aB(a),this._updateLayer(f)))}else this.fire(new c.j(new Error(`Cannot filter non-existing layer "${t}".`)))}getFilter(t){return c.aB(this.getLayer(t).filter)}setLayoutProperty(t,a,d,f={}){this._checkLoaded();const g=this.getLayer(t);g?c.aE(g.getLayoutProperty(a),d)||(g.setLayoutProperty(a,d,f),this._updateLayer(g)):this.fire(new c.j(new Error(`Cannot style non-existing layer "${t}".`)))}getLayoutProperty(t,a){const d=this.getLayer(t);if(d)return d.getLayoutProperty(a);this.fire(new c.j(new Error(`Cannot get style of non-existing layer "${t}".`)))}setPaintProperty(t,a,d,f={}){this._checkLoaded();const g=this.getLayer(t);g?c.aE(g.getPaintProperty(a),d)||(g.setPaintProperty(a,d,f)&&this._updateLayer(g),this._changed=!0,this._updatedPaintProps[t]=!0,this._serializedLayers=null):this.fire(new c.j(new Error(`Cannot style non-existing layer "${t}".`)))}getPaintProperty(t,a){return this.getLayer(t).getPaintProperty(a)}setFeatureState(t,a){this._checkLoaded();const d=t.source,f=t.sourceLayer,g=this.sourceCaches[d];if(g===void 0)return void this.fire(new c.j(new Error(`The source '${d}' does not exist in the map's style.`)));const E=g.getSource().type;E==="geojson"&&f?this.fire(new c.j(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):E!=="vector"||f?(t.id===void 0&&this.fire(new c.j(new Error("The feature id parameter must be provided."))),g.setFeatureState(f,t.id,a)):this.fire(new c.j(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(t,a){this._checkLoaded();const d=t.source,f=this.sourceCaches[d];if(f===void 0)return void this.fire(new c.j(new Error(`The source '${d}' does not exist in the map's style.`)));const g=f.getSource().type,E=g==="vector"?t.sourceLayer:void 0;g!=="vector"||E?a&&typeof t.id!="string"&&typeof t.id!="number"?this.fire(new c.j(new Error("A feature id is required to remove its specific state property."))):f.removeFeatureState(E,t.id,a):this.fire(new c.j(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(t){this._checkLoaded();const a=t.source,d=t.sourceLayer,f=this.sourceCaches[a];if(f!==void 0)return f.getSource().type!=="vector"||d?(t.id===void 0&&this.fire(new c.j(new Error("The feature id parameter must be provided."))),f.getFeatureState(d,t.id)):void this.fire(new c.j(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new c.j(new Error(`The source '${a}' does not exist in the map's style.`)))}getTransition(){return c.e({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;const t=c.aF(this.sourceCaches,g=>g.serialize()),a=this._serializeByIds(this._order,!0),d=this.map.getTerrain()||void 0,f=this.stylesheet;return c.aG({version:f.version,name:f.name,metadata:f.metadata,light:f.light,sky:f.sky,center:f.center,zoom:f.zoom,bearing:f.bearing,pitch:f.pitch,sprite:f.sprite,glyphs:f.glyphs,transition:f.transition,sources:t,layers:a,terrain:d},g=>g!==void 0)}_updateLayer(t){this._updatedLayers[t.id]=!0,t.source&&!this._updatedSources[t.source]&&this.sourceCaches[t.source].getSource().type!=="raster"&&(this._updatedSources[t.source]="reload",this.sourceCaches[t.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(t){const a=E=>this._layers[E].type==="fill-extrusion",d={},f=[];for(let E=this._order.length-1;E>=0;E--){const I=this._order[E];if(a(I)){d[I]=E;for(const k of t){const z=k[I];if(z)for(const L of z)f.push(L)}}}f.sort((E,I)=>I.intersectionZ-E.intersectionZ);const g=[];for(let E=this._order.length-1;E>=0;E--){const I=this._order[E];if(a(I))for(let k=f.length-1;k>=0;k--){const z=f[k].feature;if(d[z.layer.id]<E)break;g.push(z),f.pop()}else for(const k of t){const z=k[I];if(z)for(const L of z)g.push(L.feature)}}return g}queryRenderedFeatures(t,a,d){a&&a.filter&&this._validate(c.u.filter,"queryRenderedFeatures.filter",a.filter,null,a);const f={};if(a&&a.layers){if(!Array.isArray(a.layers))return this.fire(new c.j(new Error("parameters.layers must be an Array."))),[];for(const I of a.layers){const k=this._layers[I];if(!k)return this.fire(new c.j(new Error(`The layer '${I}' does not exist in the map's style and cannot be queried for features.`))),[];f[k.source]=!0}}const g=[];a.availableImages=this._availableImages;const E=this._serializedAllLayers();for(const I in this.sourceCaches)a.layers&&!f[I]||g.push(er(this.sourceCaches[I],this._layers,E,t,a,d));return this.placement&&g.push(function(I,k,z,L,O,V,X){const Q={},ie=V.queryRenderedSymbols(L),le=[];for(const ce of Object.keys(ie).map(Number))le.push(X[ce]);le.sort(sn);for(const ce of le){const me=ce.featureIndex.lookupSymbolFeatures(ie[ce.bucketInstanceId],k,ce.bucketIndex,ce.sourceLayerIndex,O.filter,O.layers,O.availableImages,I);for(const te in me){const xe=Q[te]=Q[te]||[],be=me[te];be.sort((Me,qe)=>{const et=ce.featureSortOrder;if(et){const lt=et.indexOf(Me.featureIndex);return et.indexOf(qe.featureIndex)-lt}return qe.featureIndex-Me.featureIndex});for(const Me of be)xe.push(Me)}}for(const ce in Q)Q[ce].forEach(me=>{const te=me.feature,xe=z[I[ce].source].getFeatureState(te.layer["source-layer"],te.id);te.source=te.layer.source,te.layer["source-layer"]&&(te.sourceLayer=te.layer["source-layer"]),te.state=xe});return Q}(this._layers,E,this.sourceCaches,t,a,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(g)}querySourceFeatures(t,a){a&&a.filter&&this._validate(c.u.filter,"querySourceFeatures.filter",a.filter,null,a);const d=this.sourceCaches[t];return d?function(f,g){const E=f.getRenderableIds().map(z=>f.getTileByID(z)),I=[],k={};for(let z=0;z<E.length;z++){const L=E[z],O=L.tileID.canonical.key;k[O]||(k[O]=!0,L.querySourceFeatures(I,g))}return I}(d,a):[]}getLight(){return this.light.getLight()}setLight(t,a={}){this._checkLoaded();const d=this.light.getLight();let f=!1;for(const E in t)if(!c.aE(t[E],d[E])){f=!0;break}if(!f)return;const g={now:W.now(),transition:c.e({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(t,a),this.light.updateTransitions(g)}getSky(){var t;return(t=this.stylesheet)===null||t===void 0?void 0:t.sky}setSky(t,a={}){const d=this.getSky();let f=!1;if(!t&&!d)return;if(t&&!d)f=!0;else if(!t&&d)f=!0;else for(const E in t)if(!c.aE(t[E],d[E])){f=!0;break}if(!f)return;const g={now:W.now(),transition:c.e({duration:300,delay:0},this.stylesheet.transition)};this.stylesheet.sky=t,this.sky.setSky(t,a),this.sky.updateTransitions(g)}_validate(t,a,d,f,g={}){return(!g||g.validate!==!1)&&Li(this,t.call(c.u,c.e({key:a,style:this.serialize(),value:d,styleSpec:c.v},f)))}_remove(t=!0){this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null),jr().off(Ke,this._rtlPluginLoaded);for(const a in this._layers)this._layers[a].setEventedParent(null);for(const a in this.sourceCaches){const d=this.sourceCaches[a];d.setEventedParent(null),d.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),t&&this.dispatcher.broadcast("RM",void 0),this.dispatcher.remove(t)}_clearSource(t){this.sourceCaches[t].clearTiles()}_reloadSource(t){this.sourceCaches[t].resume(),this.sourceCaches[t].reload()}_updateSources(t){for(const a in this.sourceCaches)this.sourceCaches[a].update(t,this.map.terrain)}_generateCollisionBoxes(){for(const t in this.sourceCaches)this._reloadSource(t)}_updatePlacement(t,a,d,f,g=!1){let E=!1,I=!1;const k={};for(const z of this._order){const L=this._layers[z];if(L.type!=="symbol")continue;if(!k[L.source]){const V=this.sourceCaches[L.source];k[L.source]=V.getRenderableIds(!0).map(X=>V.getTileByID(X)).sort((X,Q)=>Q.tileID.overscaledZ-X.tileID.overscaledZ||(X.tileID.isLessThan(Q.tileID)?-1:1))}const O=this.crossTileSymbolIndex.addLayer(L,k[L.source],t.center.lng);E=E||O}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((g=g||this._layerOrderChanged||d===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(W.now(),t.zoom))&&(this.pauseablePlacement=new nl(t,this.map.terrain,this._order,g,a,d,f,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,k),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(W.now()),I=!0),E&&this.pauseablePlacement.placement.setStale()),I||E)for(const z of this._order){const L=this._layers[z];L.type==="symbol"&&this.placement.updateLayerOpacities(L,k[L.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(W.now())}_releaseSymbolFadeTiles(){for(const t in this.sourceCaches)this.sourceCaches[t].releaseSymbolFadeTiles()}getImages(t,a){return c._(this,void 0,void 0,function*(){const d=yield this.imageManager.getImages(a.icons);this._updateTilesForChangedImages();const f=this.sourceCaches[a.source];return f&&f.setDependencies(a.tileID.key,a.type,a.icons),d})}getGlyphs(t,a){return c._(this,void 0,void 0,function*(){const d=yield this.glyphManager.getGlyphs(a.stacks),f=this.sourceCaches[a.source];return f&&f.setDependencies(a.tileID.key,a.type,[""]),d})}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(t,a={}){this._checkLoaded(),t&&this._validate(c.u.glyphs,"glyphs",t,null,a)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=t,this.glyphManager.entries={},this.glyphManager.setURL(t))}addSprite(t,a,d={},f){this._checkLoaded();const g=[{id:t,url:a}],E=[...de(this.stylesheet.sprite),...g];this._validate(c.u.sprite,"sprite",E,null,d)||(this.stylesheet.sprite=E,this._loadSprite(g,!0,f))}removeSprite(t){this._checkLoaded();const a=de(this.stylesheet.sprite);if(a.find(d=>d.id===t)){if(this._spritesImagesIds[t])for(const d of this._spritesImagesIds[t])this.imageManager.removeImage(d),this._changedImages[d]=!0;a.splice(a.findIndex(d=>d.id===t),1),this.stylesheet.sprite=a.length>0?a:void 0,delete this._spritesImagesIds[t],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new c.k("data",{dataType:"style"}))}else this.fire(new c.j(new Error(`Sprite "${t}" doesn't exists on this map.`)))}getSprite(){return de(this.stylesheet.sprite)}setSprite(t,a={},d){this._checkLoaded(),t&&this._validate(c.u.sprite,"sprite",t,null,a)||(this.stylesheet.sprite=t,t?this._loadSprite(t,!0,d):(this._unloadSprite(),d&&d(null)))}}var No=c.Y([{name:"a_pos",type:"Int16",components:2}]);const fo={prelude:Pn(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture2D(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture2D(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}`),background:Pn(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),backgroundPattern:Pn(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:Pn(`varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);float antialiased_blur=v_data.z;float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);float ele=get_elevation(circle_center);v_visibility=calculate_visibility(u_matrix*vec4(circle_center,ele,1.0));if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,ele,1);} else {gl_Position=u_matrix*vec4(circle_center,ele,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}float antialiasblur=-max(1.0/u_device_pixel_ratio/(radius+stroke_width),blur);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:Pn("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:Pn(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,get_elevation(floor(a_pos*0.5)),1);gl_Position=u_matrix*pos;}`),heatmapTexture:Pn(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:Pn("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_anchor_pos;attribute vec2 a_placed;attribute vec2 a_box_real;uniform mat4 u_matrix;uniform vec2 u_pixel_extrude_scale;varying float v_placed;varying float v_notUsed;vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_matrix*vec4(posInTile,elevation,1.0);}void main() {gl_Position=projectTileWithElevation(a_anchor_pos,get_elevation(a_anchor_pos));gl_Position.xy=((a_box_real+0.5)*u_pixel_extrude_scale*2.0-1.0)*vec2(1.0,-1.0)*gl_Position.w;if (gl_Position.z/gl_Position.w < 1.1) {gl_Position.z=0.5;}v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:Pn("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:Pn("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,get_elevation(a_pos),1);}"),fill:Pn(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),fillOutline:Pn(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillOutlinePattern:Pn(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillPattern:Pn(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:Pn(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:Pn(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:Pn(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Pn(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),line:Pn(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:Pn(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:Pn(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:Pn(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),raster:Pn(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),symbolIcon:Pn(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;varying vec2 v_tex;varying float v_fade_opacity;vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_matrix*vec4(posInTile,elevation,1.0);}
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}gl_Position=finalPos;v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:Pn(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_translation;uniform float u_pitched_scale;varying vec2 v_data0;varying vec3 v_data1;vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_matrix*vec4(posInTile,elevation,1.0);}
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:Pn(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;varying vec4 v_data0;varying vec4 v_data1;vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_matrix*vec4(posInTile,elevation,1.0);}
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:Pn("uniform sampler2D u_texture;uniform vec4 u_fog_color;uniform vec4 u_horizon_color;uniform float u_fog_ground_blend;uniform float u_fog_ground_blend_opacity;uniform float u_horizon_fog_blend;varying vec2 v_texture_pos;varying float v_fog_depth;const float gamma=2.2;vec4 gammaToLinear(vec4 color) {return pow(color,vec4(gamma));}vec4 linearToGamma(vec4 color) {return pow(color,vec4(1.0/gamma));}void main() {vec4 surface_color=texture2D(u_texture,v_texture_pos);if (v_fog_depth > u_fog_ground_blend) {vec4 surface_color_linear=gammaToLinear(surface_color);float blend_color=smoothstep(0.0,1.0,max((v_fog_depth-u_horizon_fog_blend)/(1.0-u_horizon_fog_blend),0.0));vec4 fog_horizon_color_linear=mix(gammaToLinear(u_fog_color),gammaToLinear(u_horizon_color),blend_color);float factor_fog=max(v_fog_depth-u_fog_ground_blend,0.0)/(1.0-u_fog_ground_blend);gl_FragColor=linearToGamma(mix(surface_color_linear,fog_horizon_color_linear,pow(factor_fog,2.0)*u_fog_ground_blend_opacity));} else {gl_FragColor=surface_color;}}","attribute vec3 a_pos3d;uniform mat4 u_matrix;uniform mat4 u_fog_matrix;uniform float u_ele_delta;varying vec2 v_texture_pos;varying float v_fog_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=u_matrix*vec4(a_pos3d.xy,ele-ele_delta,1.0);vec4 pos=u_fog_matrix*vec4(a_pos3d.xy,ele,1.0);v_fog_depth=pos.z/pos.w*0.5+0.5;}"),terrainDepth:Pn("varying float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {gl_FragColor=pack(v_depth);}","attribute vec3 a_pos3d;uniform mat4 u_matrix;uniform float u_ele_delta;varying float v_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;gl_Position=u_matrix*vec4(a_pos3d.xy,ele-ele_delta,1.0);v_depth=gl_Position.z/gl_Position.w;}"),terrainCoords:Pn("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;varying vec2 v_texture_pos;void main() {vec4 rgba=texture2D(u_texture,v_texture_pos);gl_FragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}","attribute vec3 a_pos3d;uniform mat4 u_matrix;uniform float u_ele_delta;varying vec2 v_texture_pos;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=u_matrix*vec4(a_pos3d.xy,ele-ele_delta,1.0);}"),sky:Pn("uniform vec4 u_sky_color;uniform vec4 u_horizon_color;uniform float u_horizon;uniform float u_sky_horizon_blend;void main() {float y=gl_FragCoord.y;if (y > u_horizon) {float blend=y-u_horizon;if (blend < u_sky_horizon_blend) {gl_FragColor=mix(u_sky_color,u_horizon_color,pow(1.0-blend/u_sky_horizon_blend,2.0));} else {gl_FragColor=u_sky_color;}}}","attribute vec2 a_pos;void main() {gl_Position=vec4(a_pos,1.0,1.0);}")};function Pn(y,t){const a=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,d=t.match(/attribute ([\w]+) ([\w]+)/g),f=y.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),g=t.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),E=g?g.concat(f):f,I={};return{fragmentSource:y=y.replace(a,(k,z,L,O,V)=>(I[V]=!0,z==="define"?`
#ifndef HAS_UNIFORM_u_${V}
varying ${L} ${O} ${V};
#else
uniform ${L} ${O} u_${V};
#endif
`:`
#ifdef HAS_UNIFORM_u_${V}
    ${L} ${O} ${V} = u_${V};
#endif
`)),vertexSource:t=t.replace(a,(k,z,L,O,V)=>{const X=O==="float"?"vec2":"vec4",Q=V.match(/color/)?"color":X;return I[V]?z==="define"?`
#ifndef HAS_UNIFORM_u_${V}
uniform lowp float u_${V}_t;
attribute ${L} ${X} a_${V};
varying ${L} ${O} ${V};
#else
uniform ${L} ${O} u_${V};
#endif
`:Q==="vec4"?`
#ifndef HAS_UNIFORM_u_${V}
    ${V} = a_${V};
#else
    ${L} ${O} ${V} = u_${V};
#endif
`:`
#ifndef HAS_UNIFORM_u_${V}
    ${V} = unpack_mix_${Q}(a_${V}, u_${V}_t);
#else
    ${L} ${O} ${V} = u_${V};
#endif
`:z==="define"?`
#ifndef HAS_UNIFORM_u_${V}
uniform lowp float u_${V}_t;
attribute ${L} ${X} a_${V};
#else
uniform ${L} ${O} u_${V};
#endif
`:Q==="vec4"?`
#ifndef HAS_UNIFORM_u_${V}
    ${L} ${O} ${V} = a_${V};
#else
    ${L} ${O} ${V} = u_${V};
#endif
`:`
#ifndef HAS_UNIFORM_u_${V}
    ${L} ${O} ${V} = unpack_mix_${Q}(a_${V}, u_${V}_t);
#else
    ${L} ${O} ${V} = u_${V};
#endif
`}),staticAttributes:d,staticUniforms:E}}class Kc{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(t,a,d,f,g,E,I,k,z){this.context=t;let L=this.boundPaintVertexBuffers.length!==f.length;for(let O=0;!L&&O<f.length;O++)this.boundPaintVertexBuffers[O]!==f[O]&&(L=!0);!this.vao||this.boundProgram!==a||this.boundLayoutVertexBuffer!==d||L||this.boundIndexBuffer!==g||this.boundVertexOffset!==E||this.boundDynamicVertexBuffer!==I||this.boundDynamicVertexBuffer2!==k||this.boundDynamicVertexBuffer3!==z?this.freshBind(a,d,f,g,E,I,k,z):(t.bindVertexArray.set(this.vao),I&&I.bind(),g&&g.dynamicDraw&&g.bind(),k&&k.bind(),z&&z.bind())}freshBind(t,a,d,f,g,E,I,k){const z=t.numAttributes,L=this.context,O=L.gl;this.vao&&this.destroy(),this.vao=L.createVertexArray(),L.bindVertexArray.set(this.vao),this.boundProgram=t,this.boundLayoutVertexBuffer=a,this.boundPaintVertexBuffers=d,this.boundIndexBuffer=f,this.boundVertexOffset=g,this.boundDynamicVertexBuffer=E,this.boundDynamicVertexBuffer2=I,this.boundDynamicVertexBuffer3=k,a.enableAttributes(O,t);for(const V of d)V.enableAttributes(O,t);E&&E.enableAttributes(O,t),I&&I.enableAttributes(O,t),k&&k.enableAttributes(O,t),a.bind(),a.setVertexAttribPointers(O,t,g);for(const V of d)V.bind(),V.setVertexAttribPointers(O,t,g);E&&(E.bind(),E.setVertexAttribPointers(O,t,g)),f&&f.bind(),I&&(I.bind(),I.setVertexAttribPointers(O,t,g)),k&&(k.bind(),k.setVertexAttribPointers(O,t,g)),L.currentNumAttributes=z}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}const Uu=(y,t,a,d,f)=>({u_matrix:y,u_texture:0,u_ele_delta:t,u_fog_matrix:a,u_fog_color:d?d.properties.get("fog-color"):c.aM.white,u_fog_ground_blend:d?d.properties.get("fog-ground-blend"):1,u_fog_ground_blend_opacity:d?d.calculateFogBlendOpacity(f):0,u_horizon_color:d?d.properties.get("horizon-color"):c.aM.white,u_horizon_fog_blend:d?d.properties.get("horizon-fog-blend"):1});function Uo(y){const t=[];for(let a=0;a<y.length;a++){if(y[a]===null)continue;const d=y[a].split(" ");t.push(d.pop())}return t}class $l{constructor(t,a,d,f,g,E){const I=t.gl;this.program=I.createProgram();const k=Uo(a.staticAttributes),z=d?d.getBinderAttributes():[],L=k.concat(z),O=fo.prelude.staticUniforms?Uo(fo.prelude.staticUniforms):[],V=a.staticUniforms?Uo(a.staticUniforms):[],X=d?d.getBinderUniforms():[],Q=O.concat(V).concat(X),ie=[];for(const Me of Q)ie.indexOf(Me)<0&&ie.push(Me);const le=d?d.defines():[];g&&le.push("#define OVERDRAW_INSPECTOR;"),E&&le.push("#define TERRAIN3D;");const ce=le.concat(fo.prelude.fragmentSource,a.fragmentSource).join(`
`),me=le.concat(fo.prelude.vertexSource,a.vertexSource).join(`
`),te=I.createShader(I.FRAGMENT_SHADER);if(I.isContextLost())return void(this.failedToCreate=!0);if(I.shaderSource(te,ce),I.compileShader(te),!I.getShaderParameter(te,I.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${I.getShaderInfoLog(te)}`);I.attachShader(this.program,te);const xe=I.createShader(I.VERTEX_SHADER);if(I.isContextLost())return void(this.failedToCreate=!0);if(I.shaderSource(xe,me),I.compileShader(xe),!I.getShaderParameter(xe,I.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${I.getShaderInfoLog(xe)}`);I.attachShader(this.program,xe),this.attributes={};const be={};this.numAttributes=L.length;for(let Me=0;Me<this.numAttributes;Me++)L[Me]&&(I.bindAttribLocation(this.program,Me,L[Me]),this.attributes[L[Me]]=Me);if(I.linkProgram(this.program),!I.getProgramParameter(this.program,I.LINK_STATUS))throw new Error(`Program failed to link: ${I.getProgramInfoLog(this.program)}`);I.deleteShader(xe),I.deleteShader(te);for(let Me=0;Me<ie.length;Me++){const qe=ie[Me];if(qe&&!be[qe]){const et=I.getUniformLocation(this.program,qe);et&&(be[qe]=et)}}this.fixedUniforms=f(t,be),this.terrainUniforms=((Me,qe)=>({u_depth:new c.aH(Me,qe.u_depth),u_terrain:new c.aH(Me,qe.u_terrain),u_terrain_dim:new c.aI(Me,qe.u_terrain_dim),u_terrain_matrix:new c.aJ(Me,qe.u_terrain_matrix),u_terrain_unpack:new c.aK(Me,qe.u_terrain_unpack),u_terrain_exaggeration:new c.aI(Me,qe.u_terrain_exaggeration)}))(t,be),this.binderUniforms=d?d.getUniforms(t,be):[]}draw(t,a,d,f,g,E,I,k,z,L,O,V,X,Q,ie,le,ce,me){const te=t.gl;if(this.failedToCreate)return;if(t.program.set(this.program),t.setDepthMode(d),t.setStencilMode(f),t.setColorMode(g),t.setCullFace(E),k){t.activeTexture.set(te.TEXTURE2),te.bindTexture(te.TEXTURE_2D,k.depthTexture),t.activeTexture.set(te.TEXTURE3),te.bindTexture(te.TEXTURE_2D,k.texture);for(const be in this.terrainUniforms)this.terrainUniforms[be].set(k[be])}for(const be in this.fixedUniforms)this.fixedUniforms[be].set(I[be]);ie&&ie.setUniforms(t,this.binderUniforms,X,{zoom:Q});let xe=0;switch(a){case te.LINES:xe=2;break;case te.TRIANGLES:xe=3;break;case te.LINE_STRIP:xe=1}for(const be of V.get()){const Me=be.vaos||(be.vaos={});(Me[z]||(Me[z]=new Kc)).bind(t,this,L,ie?ie.getPaintVertexBuffers():[],O,be.vertexOffset,le,ce,me),te.drawElements(a,be.primitiveLength*xe,te.UNSIGNED_SHORT,be.primitiveOffset*xe*2)}}}function po(y,t,a){const d=1/fn(a,1,t.transform.tileZoom),f=Math.pow(2,a.tileID.overscaledZ),g=a.tileSize*Math.pow(2,t.transform.tileZoom)/f,E=g*(a.tileID.canonical.x+a.tileID.wrap*f),I=g*a.tileID.canonical.y;return{u_image:0,u_texsize:a.imageAtlasTexture.size,u_scale:[d,y.fromScale,y.toScale],u_fade:y.t,u_pixel_coord_upper:[E>>16,I>>16],u_pixel_coord_lower:[65535&E,65535&I]}}const il=(y,t,a,d)=>{const f=t.style.light,g=f.properties.get("position"),E=[g.x,g.y,g.z],I=function(){var z=new c.A(9);return c.A!=Float32Array&&(z[1]=0,z[2]=0,z[3]=0,z[5]=0,z[6]=0,z[7]=0),z[0]=1,z[4]=1,z[8]=1,z}();f.properties.get("anchor")==="viewport"&&function(z,L){var O=Math.sin(L),V=Math.cos(L);z[0]=V,z[1]=O,z[2]=0,z[3]=-O,z[4]=V,z[5]=0,z[6]=0,z[7]=0,z[8]=1}(I,-t.transform.angle),function(z,L,O){var V=L[0],X=L[1],Q=L[2];z[0]=V*O[0]+X*O[3]+Q*O[6],z[1]=V*O[1]+X*O[4]+Q*O[7],z[2]=V*O[2]+X*O[5]+Q*O[8]}(E,E,I);const k=f.properties.get("color");return{u_matrix:y,u_lightpos:E,u_lightintensity:f.properties.get("intensity"),u_lightcolor:[k.r,k.g,k.b],u_vertical_gradient:+a,u_opacity:d}},Vl=(y,t,a,d,f,g,E)=>c.e(il(y,t,a,d),po(g,t,E),{u_height_factor:-Math.pow(2,f.overscaledZ)/E.tileSize/8}),sl=y=>({u_matrix:y}),Yc=(y,t,a,d)=>c.e(sl(y),po(a,t,d)),_d=(y,t)=>({u_matrix:y,u_world:t}),Jc=(y,t,a,d,f)=>c.e(Yc(y,t,a,d),{u_world:f}),yd=(y,t,a,d)=>{const f=y.transform;let g,E;if(d.paint.get("circle-pitch-alignment")==="map"){const I=fn(a,1,f.zoom);g=!0,E=[I,I]}else g=!1,E=f.pixelsToGLUnits;return{u_camera_to_center_distance:f.cameraToCenterDistance,u_scale_with_map:+(d.paint.get("circle-pitch-scale")==="map"),u_matrix:y.translatePosMatrix(t.posMatrix,a,d.paint.get("circle-translate"),d.paint.get("circle-translate-anchor")),u_pitch_with_map:+g,u_device_pixel_ratio:y.pixelRatio,u_extrude_scale:E}},ma=(y,t,a)=>({u_matrix:y,u_inv_matrix:t,u_camera_to_center_distance:a.cameraToCenterDistance,u_viewport_size:[a.width,a.height]}),ql=(y,t,a=1)=>({u_matrix:y,u_color:t,u_overlay:0,u_overlay_scale:a}),Oi=y=>({u_matrix:y}),Ei=(y,t,a,d)=>({u_matrix:y,u_extrude_scale:fn(t,1,a),u_intensity:d}),ju=(y,t,a,d)=>{const f=c.H();c.aP(f,0,y.width,y.height,0,0,1);const g=y.context.gl;return{u_matrix:f,u_world:[g.drawingBufferWidth,g.drawingBufferHeight],u_image:a,u_color_ramp:d,u_opacity:t.paint.get("heatmap-opacity")}};function $u(y,t){const a=Math.pow(2,t.canonical.z),d=t.canonical.y;return[new c.Z(0,d/a).toLngLat().lat,new c.Z(0,(d+1)/a).toLngLat().lat]}const Vu=(y,t,a,d)=>{const f=y.transform;return{u_matrix:wd(y,t,a,d),u_ratio:1/fn(t,1,f.zoom),u_device_pixel_ratio:y.pixelRatio,u_units_to_pixels:[1/f.pixelsToGLUnits[0],1/f.pixelsToGLUnits[1]]}},vd=(y,t,a,d,f)=>c.e(Vu(y,t,a,f),{u_image:0,u_image_height:d}),jo=(y,t,a,d,f)=>{const g=y.transform,E=xd(t,g);return{u_matrix:wd(y,t,a,f),u_texsize:t.imageAtlasTexture.size,u_ratio:1/fn(t,1,g.zoom),u_device_pixel_ratio:y.pixelRatio,u_image:0,u_scale:[E,d.fromScale,d.toScale],u_fade:d.t,u_units_to_pixels:[1/g.pixelsToGLUnits[0],1/g.pixelsToGLUnits[1]]}},ip=(y,t,a,d,f,g)=>{const E=y.lineAtlas,I=xd(t,y.transform),k=a.layout.get("line-cap")==="round",z=E.getDash(d.from,k),L=E.getDash(d.to,k),O=z.width*f.fromScale,V=L.width*f.toScale;return c.e(Vu(y,t,a,g),{u_patternscale_a:[I/O,-z.height/2],u_patternscale_b:[I/V,-L.height/2],u_sdfgamma:E.width/(256*Math.min(O,V)*y.pixelRatio)/2,u_image:0,u_tex_y_a:z.y,u_tex_y_b:L.y,u_mix:f.t})};function xd(y,t){return 1/fn(y,1,t.tileZoom)}function wd(y,t,a,d){return y.translatePosMatrix(d?d.posMatrix:t.tileID.posMatrix,t,a.paint.get("line-translate"),a.paint.get("line-translate-anchor"))}const sp=(y,t,a,d,f)=>{return{u_matrix:y,u_tl_parent:t,u_scale_parent:a,u_buffer_scale:1,u_fade_t:d.mix,u_opacity:d.opacity*f.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:f.paint.get("raster-brightness-min"),u_brightness_high:f.paint.get("raster-brightness-max"),u_saturation_factor:(E=f.paint.get("raster-saturation"),E>0?1-1/(1.001-E):-E),u_contrast_factor:(g=f.paint.get("raster-contrast"),g>0?1/(1-g):1+g),u_spin_weights:op(f.paint.get("raster-hue-rotate"))};var g,E};function op(y){y*=Math.PI/180;const t=Math.sin(y),a=Math.cos(y);return[(2*a+1)/3,(-Math.sqrt(3)*t-a+1)/3,(Math.sqrt(3)*t-a+1)/3]}const or=(y,t,a,d,f,g,E,I,k,z,L,O,V,X)=>{const Q=E.transform;return{u_is_size_zoom_constant:+(y==="constant"||y==="source"),u_is_size_feature_constant:+(y==="constant"||y==="camera"),u_size_t:t?t.uSizeT:0,u_size:t?t.uSize:0,u_camera_to_center_distance:Q.cameraToCenterDistance,u_pitch:Q.pitch/360*2*Math.PI,u_rotate_symbol:+a,u_aspect_ratio:Q.width/Q.height,u_fade_change:E.options.fadeDuration?E.symbolFadeChange:1,u_matrix:I,u_label_plane_matrix:k,u_coord_matrix:z,u_is_text:+O,u_pitch_with_map:+d,u_is_along_line:f,u_is_variable_anchor:g,u_texsize:V,u_texture:0,u_translation:L,u_pitched_scale:X}},Wn=(y,t,a,d,f,g,E,I,k,z,L,O,V,X,Q)=>{const ie=E.transform;return c.e(or(y,t,a,d,f,g,E,I,k,z,L,O,V,Q),{u_gamma_scale:d?Math.cos(ie._pitch)*ie.cameraToCenterDistance:1,u_device_pixel_ratio:E.pixelRatio,u_is_halo:+X})},Qc=(y,t,a,d,f,g,E,I,k,z,L,O,V,X)=>c.e(Wn(y,t,a,d,f,g,E,I,k,z,L,!0,O,!0,X),{u_texsize_icon:V,u_texture_icon:1}),qu=(y,t,a)=>({u_matrix:y,u_opacity:t,u_color:a}),eh=(y,t,a,d,f,g)=>c.e(function(E,I,k,z){const L=k.imageManager.getPattern(E.from.toString()),O=k.imageManager.getPattern(E.to.toString()),{width:V,height:X}=k.imageManager.getPixelSize(),Q=Math.pow(2,z.tileID.overscaledZ),ie=z.tileSize*Math.pow(2,k.transform.tileZoom)/Q,le=ie*(z.tileID.canonical.x+z.tileID.wrap*Q),ce=ie*z.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:L.tl,u_pattern_br_a:L.br,u_pattern_tl_b:O.tl,u_pattern_br_b:O.br,u_texsize:[V,X],u_mix:I.t,u_pattern_size_a:L.displaySize,u_pattern_size_b:O.displaySize,u_scale_a:I.fromScale,u_scale_b:I.toScale,u_tile_units_to_pixels:1/fn(z,1,k.transform.tileZoom),u_pixel_coord_upper:[le>>16,ce>>16],u_pixel_coord_lower:[65535&le,65535&ce]}}(d,g,a,f),{u_matrix:y,u_opacity:t}),th={fillExtrusion:(y,t)=>({u_matrix:new c.aJ(y,t.u_matrix),u_lightpos:new c.aN(y,t.u_lightpos),u_lightintensity:new c.aI(y,t.u_lightintensity),u_lightcolor:new c.aN(y,t.u_lightcolor),u_vertical_gradient:new c.aI(y,t.u_vertical_gradient),u_opacity:new c.aI(y,t.u_opacity)}),fillExtrusionPattern:(y,t)=>({u_matrix:new c.aJ(y,t.u_matrix),u_lightpos:new c.aN(y,t.u_lightpos),u_lightintensity:new c.aI(y,t.u_lightintensity),u_lightcolor:new c.aN(y,t.u_lightcolor),u_vertical_gradient:new c.aI(y,t.u_vertical_gradient),u_height_factor:new c.aI(y,t.u_height_factor),u_image:new c.aH(y,t.u_image),u_texsize:new c.aO(y,t.u_texsize),u_pixel_coord_upper:new c.aO(y,t.u_pixel_coord_upper),u_pixel_coord_lower:new c.aO(y,t.u_pixel_coord_lower),u_scale:new c.aN(y,t.u_scale),u_fade:new c.aI(y,t.u_fade),u_opacity:new c.aI(y,t.u_opacity)}),fill:(y,t)=>({u_matrix:new c.aJ(y,t.u_matrix)}),fillPattern:(y,t)=>({u_matrix:new c.aJ(y,t.u_matrix),u_image:new c.aH(y,t.u_image),u_texsize:new c.aO(y,t.u_texsize),u_pixel_coord_upper:new c.aO(y,t.u_pixel_coord_upper),u_pixel_coord_lower:new c.aO(y,t.u_pixel_coord_lower),u_scale:new c.aN(y,t.u_scale),u_fade:new c.aI(y,t.u_fade)}),fillOutline:(y,t)=>({u_matrix:new c.aJ(y,t.u_matrix),u_world:new c.aO(y,t.u_world)}),fillOutlinePattern:(y,t)=>({u_matrix:new c.aJ(y,t.u_matrix),u_world:new c.aO(y,t.u_world),u_image:new c.aH(y,t.u_image),u_texsize:new c.aO(y,t.u_texsize),u_pixel_coord_upper:new c.aO(y,t.u_pixel_coord_upper),u_pixel_coord_lower:new c.aO(y,t.u_pixel_coord_lower),u_scale:new c.aN(y,t.u_scale),u_fade:new c.aI(y,t.u_fade)}),circle:(y,t)=>({u_camera_to_center_distance:new c.aI(y,t.u_camera_to_center_distance),u_scale_with_map:new c.aH(y,t.u_scale_with_map),u_pitch_with_map:new c.aH(y,t.u_pitch_with_map),u_extrude_scale:new c.aO(y,t.u_extrude_scale),u_device_pixel_ratio:new c.aI(y,t.u_device_pixel_ratio),u_matrix:new c.aJ(y,t.u_matrix)}),collisionBox:(y,t)=>({u_matrix:new c.aJ(y,t.u_matrix),u_pixel_extrude_scale:new c.aO(y,t.u_pixel_extrude_scale)}),collisionCircle:(y,t)=>({u_matrix:new c.aJ(y,t.u_matrix),u_inv_matrix:new c.aJ(y,t.u_inv_matrix),u_camera_to_center_distance:new c.aI(y,t.u_camera_to_center_distance),u_viewport_size:new c.aO(y,t.u_viewport_size)}),debug:(y,t)=>({u_color:new c.aL(y,t.u_color),u_matrix:new c.aJ(y,t.u_matrix),u_overlay:new c.aH(y,t.u_overlay),u_overlay_scale:new c.aI(y,t.u_overlay_scale)}),clippingMask:(y,t)=>({u_matrix:new c.aJ(y,t.u_matrix)}),heatmap:(y,t)=>({u_extrude_scale:new c.aI(y,t.u_extrude_scale),u_intensity:new c.aI(y,t.u_intensity),u_matrix:new c.aJ(y,t.u_matrix)}),heatmapTexture:(y,t)=>({u_matrix:new c.aJ(y,t.u_matrix),u_world:new c.aO(y,t.u_world),u_image:new c.aH(y,t.u_image),u_color_ramp:new c.aH(y,t.u_color_ramp),u_opacity:new c.aI(y,t.u_opacity)}),hillshade:(y,t)=>({u_matrix:new c.aJ(y,t.u_matrix),u_image:new c.aH(y,t.u_image),u_latrange:new c.aO(y,t.u_latrange),u_light:new c.aO(y,t.u_light),u_shadow:new c.aL(y,t.u_shadow),u_highlight:new c.aL(y,t.u_highlight),u_accent:new c.aL(y,t.u_accent)}),hillshadePrepare:(y,t)=>({u_matrix:new c.aJ(y,t.u_matrix),u_image:new c.aH(y,t.u_image),u_dimension:new c.aO(y,t.u_dimension),u_zoom:new c.aI(y,t.u_zoom),u_unpack:new c.aK(y,t.u_unpack)}),line:(y,t)=>({u_matrix:new c.aJ(y,t.u_matrix),u_ratio:new c.aI(y,t.u_ratio),u_device_pixel_ratio:new c.aI(y,t.u_device_pixel_ratio),u_units_to_pixels:new c.aO(y,t.u_units_to_pixels)}),lineGradient:(y,t)=>({u_matrix:new c.aJ(y,t.u_matrix),u_ratio:new c.aI(y,t.u_ratio),u_device_pixel_ratio:new c.aI(y,t.u_device_pixel_ratio),u_units_to_pixels:new c.aO(y,t.u_units_to_pixels),u_image:new c.aH(y,t.u_image),u_image_height:new c.aI(y,t.u_image_height)}),linePattern:(y,t)=>({u_matrix:new c.aJ(y,t.u_matrix),u_texsize:new c.aO(y,t.u_texsize),u_ratio:new c.aI(y,t.u_ratio),u_device_pixel_ratio:new c.aI(y,t.u_device_pixel_ratio),u_image:new c.aH(y,t.u_image),u_units_to_pixels:new c.aO(y,t.u_units_to_pixels),u_scale:new c.aN(y,t.u_scale),u_fade:new c.aI(y,t.u_fade)}),lineSDF:(y,t)=>({u_matrix:new c.aJ(y,t.u_matrix),u_ratio:new c.aI(y,t.u_ratio),u_device_pixel_ratio:new c.aI(y,t.u_device_pixel_ratio),u_units_to_pixels:new c.aO(y,t.u_units_to_pixels),u_patternscale_a:new c.aO(y,t.u_patternscale_a),u_patternscale_b:new c.aO(y,t.u_patternscale_b),u_sdfgamma:new c.aI(y,t.u_sdfgamma),u_image:new c.aH(y,t.u_image),u_tex_y_a:new c.aI(y,t.u_tex_y_a),u_tex_y_b:new c.aI(y,t.u_tex_y_b),u_mix:new c.aI(y,t.u_mix)}),raster:(y,t)=>({u_matrix:new c.aJ(y,t.u_matrix),u_tl_parent:new c.aO(y,t.u_tl_parent),u_scale_parent:new c.aI(y,t.u_scale_parent),u_buffer_scale:new c.aI(y,t.u_buffer_scale),u_fade_t:new c.aI(y,t.u_fade_t),u_opacity:new c.aI(y,t.u_opacity),u_image0:new c.aH(y,t.u_image0),u_image1:new c.aH(y,t.u_image1),u_brightness_low:new c.aI(y,t.u_brightness_low),u_brightness_high:new c.aI(y,t.u_brightness_high),u_saturation_factor:new c.aI(y,t.u_saturation_factor),u_contrast_factor:new c.aI(y,t.u_contrast_factor),u_spin_weights:new c.aN(y,t.u_spin_weights)}),symbolIcon:(y,t)=>({u_is_size_zoom_constant:new c.aH(y,t.u_is_size_zoom_constant),u_is_size_feature_constant:new c.aH(y,t.u_is_size_feature_constant),u_size_t:new c.aI(y,t.u_size_t),u_size:new c.aI(y,t.u_size),u_camera_to_center_distance:new c.aI(y,t.u_camera_to_center_distance),u_pitch:new c.aI(y,t.u_pitch),u_rotate_symbol:new c.aH(y,t.u_rotate_symbol),u_aspect_ratio:new c.aI(y,t.u_aspect_ratio),u_fade_change:new c.aI(y,t.u_fade_change),u_matrix:new c.aJ(y,t.u_matrix),u_label_plane_matrix:new c.aJ(y,t.u_label_plane_matrix),u_coord_matrix:new c.aJ(y,t.u_coord_matrix),u_is_text:new c.aH(y,t.u_is_text),u_pitch_with_map:new c.aH(y,t.u_pitch_with_map),u_is_along_line:new c.aH(y,t.u_is_along_line),u_is_variable_anchor:new c.aH(y,t.u_is_variable_anchor),u_texsize:new c.aO(y,t.u_texsize),u_texture:new c.aH(y,t.u_texture),u_translation:new c.aO(y,t.u_translation),u_pitched_scale:new c.aI(y,t.u_pitched_scale)}),symbolSDF:(y,t)=>({u_is_size_zoom_constant:new c.aH(y,t.u_is_size_zoom_constant),u_is_size_feature_constant:new c.aH(y,t.u_is_size_feature_constant),u_size_t:new c.aI(y,t.u_size_t),u_size:new c.aI(y,t.u_size),u_camera_to_center_distance:new c.aI(y,t.u_camera_to_center_distance),u_pitch:new c.aI(y,t.u_pitch),u_rotate_symbol:new c.aH(y,t.u_rotate_symbol),u_aspect_ratio:new c.aI(y,t.u_aspect_ratio),u_fade_change:new c.aI(y,t.u_fade_change),u_matrix:new c.aJ(y,t.u_matrix),u_label_plane_matrix:new c.aJ(y,t.u_label_plane_matrix),u_coord_matrix:new c.aJ(y,t.u_coord_matrix),u_is_text:new c.aH(y,t.u_is_text),u_pitch_with_map:new c.aH(y,t.u_pitch_with_map),u_is_along_line:new c.aH(y,t.u_is_along_line),u_is_variable_anchor:new c.aH(y,t.u_is_variable_anchor),u_texsize:new c.aO(y,t.u_texsize),u_texture:new c.aH(y,t.u_texture),u_gamma_scale:new c.aI(y,t.u_gamma_scale),u_device_pixel_ratio:new c.aI(y,t.u_device_pixel_ratio),u_is_halo:new c.aH(y,t.u_is_halo),u_translation:new c.aO(y,t.u_translation),u_pitched_scale:new c.aI(y,t.u_pitched_scale)}),symbolTextAndIcon:(y,t)=>({u_is_size_zoom_constant:new c.aH(y,t.u_is_size_zoom_constant),u_is_size_feature_constant:new c.aH(y,t.u_is_size_feature_constant),u_size_t:new c.aI(y,t.u_size_t),u_size:new c.aI(y,t.u_size),u_camera_to_center_distance:new c.aI(y,t.u_camera_to_center_distance),u_pitch:new c.aI(y,t.u_pitch),u_rotate_symbol:new c.aH(y,t.u_rotate_symbol),u_aspect_ratio:new c.aI(y,t.u_aspect_ratio),u_fade_change:new c.aI(y,t.u_fade_change),u_matrix:new c.aJ(y,t.u_matrix),u_label_plane_matrix:new c.aJ(y,t.u_label_plane_matrix),u_coord_matrix:new c.aJ(y,t.u_coord_matrix),u_is_text:new c.aH(y,t.u_is_text),u_pitch_with_map:new c.aH(y,t.u_pitch_with_map),u_is_along_line:new c.aH(y,t.u_is_along_line),u_is_variable_anchor:new c.aH(y,t.u_is_variable_anchor),u_texsize:new c.aO(y,t.u_texsize),u_texsize_icon:new c.aO(y,t.u_texsize_icon),u_texture:new c.aH(y,t.u_texture),u_texture_icon:new c.aH(y,t.u_texture_icon),u_gamma_scale:new c.aI(y,t.u_gamma_scale),u_device_pixel_ratio:new c.aI(y,t.u_device_pixel_ratio),u_is_halo:new c.aH(y,t.u_is_halo),u_translation:new c.aO(y,t.u_translation),u_pitched_scale:new c.aI(y,t.u_pitched_scale)}),background:(y,t)=>({u_matrix:new c.aJ(y,t.u_matrix),u_opacity:new c.aI(y,t.u_opacity),u_color:new c.aL(y,t.u_color)}),backgroundPattern:(y,t)=>({u_matrix:new c.aJ(y,t.u_matrix),u_opacity:new c.aI(y,t.u_opacity),u_image:new c.aH(y,t.u_image),u_pattern_tl_a:new c.aO(y,t.u_pattern_tl_a),u_pattern_br_a:new c.aO(y,t.u_pattern_br_a),u_pattern_tl_b:new c.aO(y,t.u_pattern_tl_b),u_pattern_br_b:new c.aO(y,t.u_pattern_br_b),u_texsize:new c.aO(y,t.u_texsize),u_mix:new c.aI(y,t.u_mix),u_pattern_size_a:new c.aO(y,t.u_pattern_size_a),u_pattern_size_b:new c.aO(y,t.u_pattern_size_b),u_scale_a:new c.aI(y,t.u_scale_a),u_scale_b:new c.aI(y,t.u_scale_b),u_pixel_coord_upper:new c.aO(y,t.u_pixel_coord_upper),u_pixel_coord_lower:new c.aO(y,t.u_pixel_coord_lower),u_tile_units_to_pixels:new c.aI(y,t.u_tile_units_to_pixels)}),terrain:(y,t)=>({u_matrix:new c.aJ(y,t.u_matrix),u_texture:new c.aH(y,t.u_texture),u_ele_delta:new c.aI(y,t.u_ele_delta),u_fog_matrix:new c.aJ(y,t.u_fog_matrix),u_fog_color:new c.aL(y,t.u_fog_color),u_fog_ground_blend:new c.aI(y,t.u_fog_ground_blend),u_fog_ground_blend_opacity:new c.aI(y,t.u_fog_ground_blend_opacity),u_horizon_color:new c.aL(y,t.u_horizon_color),u_horizon_fog_blend:new c.aI(y,t.u_horizon_fog_blend)}),terrainDepth:(y,t)=>({u_matrix:new c.aJ(y,t.u_matrix),u_ele_delta:new c.aI(y,t.u_ele_delta)}),terrainCoords:(y,t)=>({u_matrix:new c.aJ(y,t.u_matrix),u_texture:new c.aH(y,t.u_texture),u_terrain_coords_id:new c.aI(y,t.u_terrain_coords_id),u_ele_delta:new c.aI(y,t.u_ele_delta)}),sky:(y,t)=>({u_sky_color:new c.aL(y,t.u_sky_color),u_horizon_color:new c.aL(y,t.u_horizon_color),u_horizon:new c.aI(y,t.u_horizon),u_sky_horizon_blend:new c.aI(y,t.u_sky_horizon_blend)})};class Js{constructor(t,a,d){this.context=t;const f=t.gl;this.buffer=f.createBuffer(),this.dynamicDraw=!!d,this.context.unbindVAO(),t.bindElementBuffer.set(this.buffer),f.bufferData(f.ELEMENT_ARRAY_BUFFER,a.arrayBuffer,this.dynamicDraw?f.DYNAMIC_DRAW:f.STATIC_DRAW),this.dynamicDraw||delete a.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(t){const a=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),a.bufferSubData(a.ELEMENT_ARRAY_BUFFER,0,t.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const ap={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Zu{constructor(t,a,d,f){this.length=a.length,this.attributes=d,this.itemSize=a.bytesPerElement,this.dynamicDraw=f,this.context=t;const g=t.gl;this.buffer=g.createBuffer(),t.bindVertexBuffer.set(this.buffer),g.bufferData(g.ARRAY_BUFFER,a.arrayBuffer,this.dynamicDraw?g.DYNAMIC_DRAW:g.STATIC_DRAW),this.dynamicDraw||delete a.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(t){if(t.length!==this.length)throw new Error(`Length of new data is ${t.length}, which doesn't match current length of ${this.length}`);const a=this.context.gl;this.bind(),a.bufferSubData(a.ARRAY_BUFFER,0,t.arrayBuffer)}enableAttributes(t,a){for(let d=0;d<this.attributes.length;d++){const f=a.attributes[this.attributes[d].name];f!==void 0&&t.enableVertexAttribArray(f)}}setVertexAttribPointers(t,a,d){for(let f=0;f<this.attributes.length;f++){const g=this.attributes[f],E=a.attributes[g.name];E!==void 0&&t.vertexAttribPointer(E,g.components,t[ap[g.type]],!1,this.itemSize,g.offset+this.itemSize*(d||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const ga=new WeakMap;function pr(y){var t;if(ga.has(y))return ga.get(y);{const a=(t=y.getParameter(y.VERSION))===null||t===void 0?void 0:t.startsWith("WebGL 2.0");return ga.set(y,a),a}}class Mn{constructor(t){this.gl=t.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(t){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class Qs extends Mn{getDefault(){return c.aM.transparent}set(t){const a=this.current;(t.r!==a.r||t.g!==a.g||t.b!==a.b||t.a!==a.a||this.dirty)&&(this.gl.clearColor(t.r,t.g,t.b,t.a),this.current=t,this.dirty=!1)}}class bd extends Mn{getDefault(){return 1}set(t){(t!==this.current||this.dirty)&&(this.gl.clearDepth(t),this.current=t,this.dirty=!1)}}class $o extends Mn{getDefault(){return 0}set(t){(t!==this.current||this.dirty)&&(this.gl.clearStencil(t),this.current=t,this.dirty=!1)}}class us extends Mn{getDefault(){return[!0,!0,!0,!0]}set(t){const a=this.current;(t[0]!==a[0]||t[1]!==a[1]||t[2]!==a[2]||t[3]!==a[3]||this.dirty)&&(this.gl.colorMask(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)}}class nh extends Mn{getDefault(){return!0}set(t){(t!==this.current||this.dirty)&&(this.gl.depthMask(t),this.current=t,this.dirty=!1)}}class Sd extends Mn{getDefault(){return 255}set(t){(t!==this.current||this.dirty)&&(this.gl.stencilMask(t),this.current=t,this.dirty=!1)}}class rh extends Mn{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(t){const a=this.current;(t.func!==a.func||t.ref!==a.ref||t.mask!==a.mask||this.dirty)&&(this.gl.stencilFunc(t.func,t.ref,t.mask),this.current=t,this.dirty=!1)}}class Gu extends Mn{getDefault(){const t=this.gl;return[t.KEEP,t.KEEP,t.KEEP]}set(t){const a=this.current;(t[0]!==a[0]||t[1]!==a[1]||t[2]!==a[2]||this.dirty)&&(this.gl.stencilOp(t[0],t[1],t[2]),this.current=t,this.dirty=!1)}}class ih extends Mn{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const a=this.gl;t?a.enable(a.STENCIL_TEST):a.disable(a.STENCIL_TEST),this.current=t,this.dirty=!1}}class sh extends Mn{getDefault(){return[0,1]}set(t){const a=this.current;(t[0]!==a[0]||t[1]!==a[1]||this.dirty)&&(this.gl.depthRange(t[0],t[1]),this.current=t,this.dirty=!1)}}class Fi extends Mn{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const a=this.gl;t?a.enable(a.DEPTH_TEST):a.disable(a.DEPTH_TEST),this.current=t,this.dirty=!1}}class Td extends Mn{getDefault(){return this.gl.LESS}set(t){(t!==this.current||this.dirty)&&(this.gl.depthFunc(t),this.current=t,this.dirty=!1)}}class Yr extends Mn{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const a=this.gl;t?a.enable(a.BLEND):a.disable(a.BLEND),this.current=t,this.dirty=!1}}class Ed extends Mn{getDefault(){const t=this.gl;return[t.ONE,t.ZERO]}set(t){const a=this.current;(t[0]!==a[0]||t[1]!==a[1]||this.dirty)&&(this.gl.blendFunc(t[0],t[1]),this.current=t,this.dirty=!1)}}class Cd extends Mn{getDefault(){return c.aM.transparent}set(t){const a=this.current;(t.r!==a.r||t.g!==a.g||t.b!==a.b||t.a!==a.a||this.dirty)&&(this.gl.blendColor(t.r,t.g,t.b,t.a),this.current=t,this.dirty=!1)}}class mo extends Mn{getDefault(){return this.gl.FUNC_ADD}set(t){(t!==this.current||this.dirty)&&(this.gl.blendEquation(t),this.current=t,this.dirty=!1)}}class Vo extends Mn{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const a=this.gl;t?a.enable(a.CULL_FACE):a.disable(a.CULL_FACE),this.current=t,this.dirty=!1}}class oh extends Mn{getDefault(){return this.gl.BACK}set(t){(t!==this.current||this.dirty)&&(this.gl.cullFace(t),this.current=t,this.dirty=!1)}}class ir extends Mn{getDefault(){return this.gl.CCW}set(t){(t!==this.current||this.dirty)&&(this.gl.frontFace(t),this.current=t,this.dirty=!1)}}class qo extends Mn{getDefault(){return null}set(t){(t!==this.current||this.dirty)&&(this.gl.useProgram(t),this.current=t,this.dirty=!1)}}class ah extends Mn{getDefault(){return this.gl.TEXTURE0}set(t){(t!==this.current||this.dirty)&&(this.gl.activeTexture(t),this.current=t,this.dirty=!1)}}class Id extends Mn{getDefault(){const t=this.gl;return[0,0,t.drawingBufferWidth,t.drawingBufferHeight]}set(t){const a=this.current;(t[0]!==a[0]||t[1]!==a[1]||t[2]!==a[2]||t[3]!==a[3]||this.dirty)&&(this.gl.viewport(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)}}class Wu extends Mn{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const a=this.gl;a.bindFramebuffer(a.FRAMEBUFFER,t),this.current=t,this.dirty=!1}}class kd extends Mn{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const a=this.gl;a.bindRenderbuffer(a.RENDERBUFFER,t),this.current=t,this.dirty=!1}}class lh extends Mn{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const a=this.gl;a.bindTexture(a.TEXTURE_2D,t),this.current=t,this.dirty=!1}}class Pd extends Mn{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const a=this.gl;a.bindBuffer(a.ARRAY_BUFFER,t),this.current=t,this.dirty=!1}}class Zl extends Mn{getDefault(){return null}set(t){const a=this.gl;a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,t),this.current=t,this.dirty=!1}}class cs extends Mn{getDefault(){return null}set(t){var a;if(t===this.current&&!this.dirty)return;const d=this.gl;pr(d)?d.bindVertexArray(t):(a=d.getExtension("OES_vertex_array_object"))===null||a===void 0||a.bindVertexArrayOES(t),this.current=t,this.dirty=!1}}class Zo extends Mn{getDefault(){return 4}set(t){if(t===this.current&&!this.dirty)return;const a=this.gl;a.pixelStorei(a.UNPACK_ALIGNMENT,t),this.current=t,this.dirty=!1}}class uh extends Mn{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const a=this.gl;a.pixelStorei(a.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t),this.current=t,this.dirty=!1}}class Hu extends Mn{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const a=this.gl;a.pixelStorei(a.UNPACK_FLIP_Y_WEBGL,t),this.current=t,this.dirty=!1}}class Gl extends Mn{constructor(t,a){super(t),this.context=t,this.parent=a}getDefault(){return null}}class Wl extends Gl{setDirty(){this.dirty=!0}set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const a=this.gl;a.framebufferTexture2D(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.TEXTURE_2D,t,0),this.current=t,this.dirty=!1}}class go extends Gl{set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const a=this.gl;a.framebufferRenderbuffer(a.FRAMEBUFFER,a.DEPTH_ATTACHMENT,a.RENDERBUFFER,t),this.current=t,this.dirty=!1}}class Xu extends Gl{set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const a=this.gl;a.framebufferRenderbuffer(a.FRAMEBUFFER,a.DEPTH_STENCIL_ATTACHMENT,a.RENDERBUFFER,t),this.current=t,this.dirty=!1}}class lp{constructor(t,a,d,f,g){this.context=t,this.width=a,this.height=d;const E=t.gl,I=this.framebuffer=E.createFramebuffer();if(this.colorAttachment=new Wl(t,I),f)this.depthAttachment=g?new Xu(t,I):new go(t,I);else if(g)throw new Error("Stencil cannot be set without depth");if(E.checkFramebufferStatus(E.FRAMEBUFFER)!==E.FRAMEBUFFER_COMPLETE)throw new Error("Framebuffer is not complete")}destroy(){const t=this.context.gl,a=this.colorAttachment.get();if(a&&t.deleteTexture(a),this.depthAttachment){const d=this.depthAttachment.get();d&&t.deleteRenderbuffer(d)}t.deleteFramebuffer(this.framebuffer)}}class mr{constructor(t,a,d){this.blendFunction=t,this.blendColor=a,this.mask=d}}mr.Replace=[1,0],mr.disabled=new mr(mr.Replace,c.aM.transparent,[!1,!1,!1,!1]),mr.unblended=new mr(mr.Replace,c.aM.transparent,[!0,!0,!0,!0]),mr.alphaBlended=new mr([1,771],c.aM.transparent,[!0,!0,!0,!0]);class ch{constructor(t){var a,d;if(this.gl=t,this.clearColor=new Qs(this),this.clearDepth=new bd(this),this.clearStencil=new $o(this),this.colorMask=new us(this),this.depthMask=new nh(this),this.stencilMask=new Sd(this),this.stencilFunc=new rh(this),this.stencilOp=new Gu(this),this.stencilTest=new ih(this),this.depthRange=new sh(this),this.depthTest=new Fi(this),this.depthFunc=new Td(this),this.blend=new Yr(this),this.blendFunc=new Ed(this),this.blendColor=new Cd(this),this.blendEquation=new mo(this),this.cullFace=new Vo(this),this.cullFaceSide=new oh(this),this.frontFace=new ir(this),this.program=new qo(this),this.activeTexture=new ah(this),this.viewport=new Id(this),this.bindFramebuffer=new Wu(this),this.bindRenderbuffer=new kd(this),this.bindTexture=new lh(this),this.bindVertexBuffer=new Pd(this),this.bindElementBuffer=new Zl(this),this.bindVertexArray=new cs(this),this.pixelStoreUnpack=new Zo(this),this.pixelStoreUnpackPremultiplyAlpha=new uh(this),this.pixelStoreUnpackFlipY=new Hu(this),this.extTextureFilterAnisotropic=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=t.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=t.getParameter(t.MAX_TEXTURE_SIZE),pr(t)){this.HALF_FLOAT=t.HALF_FLOAT;const f=t.getExtension("EXT_color_buffer_half_float");this.RGBA16F=(a=t.RGBA16F)!==null&&a!==void 0?a:f==null?void 0:f.RGBA16F_EXT,this.RGB16F=(d=t.RGB16F)!==null&&d!==void 0?d:f==null?void 0:f.RGB16F_EXT,t.getExtension("EXT_color_buffer_float")}else{t.getExtension("EXT_color_buffer_half_float"),t.getExtension("OES_texture_half_float_linear");const f=t.getExtension("OES_texture_half_float");this.HALF_FLOAT=f==null?void 0:f.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(t,a){return new Js(this,t,a)}createVertexBuffer(t,a,d){return new Zu(this,t,a,d)}createRenderbuffer(t,a,d){const f=this.gl,g=f.createRenderbuffer();return this.bindRenderbuffer.set(g),f.renderbufferStorage(f.RENDERBUFFER,t,a,d),this.bindRenderbuffer.set(null),g}createFramebuffer(t,a,d,f){return new lp(this,t,a,d,f)}clear({color:t,depth:a,stencil:d}){const f=this.gl;let g=0;t&&(g|=f.COLOR_BUFFER_BIT,this.clearColor.set(t),this.colorMask.set([!0,!0,!0,!0])),a!==void 0&&(g|=f.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(a),this.depthMask.set(!0)),d!==void 0&&(g|=f.STENCIL_BUFFER_BIT,this.clearStencil.set(d),this.stencilMask.set(255)),f.clear(g)}setCullFace(t){t.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(t.mode),this.frontFace.set(t.frontFace))}setDepthMode(t){t.func!==this.gl.ALWAYS||t.mask?(this.depthTest.set(!0),this.depthFunc.set(t.func),this.depthMask.set(t.mask),this.depthRange.set(t.range)):this.depthTest.set(!1)}setStencilMode(t){t.test.func!==this.gl.ALWAYS||t.mask?(this.stencilTest.set(!0),this.stencilMask.set(t.mask),this.stencilOp.set([t.fail,t.depthFail,t.pass]),this.stencilFunc.set({func:t.test.func,ref:t.ref,mask:t.test.mask})):this.stencilTest.set(!1)}setColorMode(t){c.aE(t.blendFunction,mr.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(t.blendFunction),this.blendColor.set(t.blendColor)),this.colorMask.set(t.mask)}createVertexArray(){var t;return pr(this.gl)?this.gl.createVertexArray():(t=this.gl.getExtension("OES_vertex_array_object"))===null||t===void 0?void 0:t.createVertexArrayOES()}deleteVertexArray(t){var a;return pr(this.gl)?this.gl.deleteVertexArray(t):(a=this.gl.getExtension("OES_vertex_array_object"))===null||a===void 0?void 0:a.deleteVertexArrayOES(t)}unbindVAO(){this.bindVertexArray.set(null)}}class an{constructor(t,a,d){this.func=t,this.mask=a,this.range=d}}an.ReadOnly=!1,an.ReadWrite=!0,an.disabled=new an(519,an.ReadOnly,[0,1]);const Hl=7680;class pn{constructor(t,a,d,f,g,E){this.test=t,this.ref=a,this.mask=d,this.fail=f,this.depthFail=g,this.pass=E}}pn.disabled=new pn({func:519,mask:0},0,0,Hl,Hl,Hl);class Un{constructor(t,a,d){this.enable=t,this.mode=a,this.frontFace=d}}let Os;function ol(y,t,a,d,f){const g=y.context,E=g.gl,I=y.useProgram("collisionBox"),k=[];let z=0,L=0;for(let ce=0;ce<d.length;ce++){const me=d[ce],te=t.getTile(me).getBucket(a);if(!te)continue;const xe=f?te.textCollisionBox:te.iconCollisionBox,be=te.collisionCircleArray;if(be.length>0){const Me=c.H();c.aQ(Me,te.placementInvProjMatrix,y.transform.glCoordMatrix),c.aQ(Me,Me,te.placementViewportMatrix),k.push({circleArray:be,circleOffset:L,transform:me.posMatrix,invTransform:Me,coord:me}),z+=be.length/4,L=z}xe&&I.draw(g,E.LINES,an.disabled,pn.disabled,y.colorModeForRenderPass(),Un.disabled,{u_matrix:me.posMatrix,u_pixel_extrude_scale:[1/(O=y.transform).width,1/O.height]},y.style.map.terrain&&y.style.map.terrain.getTerrainData(me),a.id,xe.layoutVertexBuffer,xe.indexBuffer,xe.segments,null,y.transform.zoom,null,null,xe.collisionVertexBuffer)}var O;if(!f||!k.length)return;const V=y.useProgram("collisionCircle"),X=new c.aR;X.resize(4*z),X._trim();let Q=0;for(const ce of k)for(let me=0;me<ce.circleArray.length/4;me++){const te=4*me,xe=ce.circleArray[te+0],be=ce.circleArray[te+1],Me=ce.circleArray[te+2],qe=ce.circleArray[te+3];X.emplace(Q++,xe,be,Me,qe,0),X.emplace(Q++,xe,be,Me,qe,1),X.emplace(Q++,xe,be,Me,qe,2),X.emplace(Q++,xe,be,Me,qe,3)}(!Os||Os.length<2*z)&&(Os=function(ce){const me=2*ce,te=new c.aT;te.resize(me),te._trim();for(let xe=0;xe<me;xe++){const be=6*xe;te.uint16[be+0]=4*xe+0,te.uint16[be+1]=4*xe+1,te.uint16[be+2]=4*xe+2,te.uint16[be+3]=4*xe+2,te.uint16[be+4]=4*xe+3,te.uint16[be+5]=4*xe+0}return te}(z));const ie=g.createIndexBuffer(Os,!0),le=g.createVertexBuffer(X,c.aS.members,!0);for(const ce of k){const me=ma(ce.transform,ce.invTransform,y.transform);V.draw(g,E.TRIANGLES,an.disabled,pn.disabled,y.colorModeForRenderPass(),Un.disabled,me,y.style.map.terrain&&y.style.map.terrain.getTerrainData(ce.coord),a.id,le,ie,c.a0.simpleSegment(0,2*ce.circleOffset,ce.circleArray.length,ce.circleArray.length/2),null,y.transform.zoom,null,null,null)}le.destroy(),ie.destroy()}Un.disabled=new Un(!1,1029,2305),Un.backCCW=new Un(!0,1029,2305);const al=c.an(new Float32Array(16));function hh(y,t,a,d,f,g){const{horizontalAlign:E,verticalAlign:I}=c.au(y);return new c.P((-(E-.5)*t/f+d[0])*g,(-(I-.5)*a/f+d[1])*g)}function _a(y,t,a,d,f,g){const E=t.tileAnchorPoint.add(new c.P(t.translation[0],t.translation[1]));if(t.pitchWithMap){let I=d.mult(g);a||(I=I.rotate(-f));const k=E.add(I);return ae(k.x,k.y,t.labelPlaneMatrix,t.getElevation).point}if(a){const I=Fe(t.tileAnchorPoint.x+1,t.tileAnchorPoint.y,t).point.sub(y),k=Math.atan(I.y/I.x)+(I.x<0?Math.PI:0);return y.add(d.rotate(k))}return y.add(d)}function ll(y,t,a,d,f,g,E,I,k,z,L,O,V,X){const Q=y.text.placedSymbolArray,ie=y.text.dynamicLayoutVertexArray,le=y.icon.dynamicLayoutVertexArray,ce={};ie.clear();for(let me=0;me<Q.length;me++){const te=Q.get(me),xe=te.hidden||!te.crossTileID||y.allowVerticalPlacement&&!te.placedOrientation?null:d[te.crossTileID];if(xe){const be=new c.P(te.anchorX,te.anchorY),Me={getElevation:X,width:f.width,height:f.height,labelPlaneMatrix:g,lineVertexArray:null,pitchWithMap:a,projection:L,projectionCache:null,tileAnchorPoint:be,translation:O,unwrappedTileID:V},qe=a?ae(be.x,be.y,E,X):Fe(be.x,be.y,Me),et=N(f.cameraToCenterDistance,qe.signedDistanceFromCamera);let lt=c.ai(y.textSizeData,k,te)*et/c.ap;a&&(lt*=y.tilePixelRatio/I);const{width:pt,height:ot,anchor:at,textOffset:wt,textBoxScale:Gt}=xe,dt=hh(at,pt,ot,wt,Gt,lt),nt=L.getPitchedTextCorrection(f,be.add(new c.P(O[0],O[1])),V),jt=_a(qe.point,Me,t,dt,f.angle,nt),sr=y.allowVerticalPlacement&&te.placedOrientation===c.ah.vertical?Math.PI/2:0;for(let $t=0;$t<te.numGlyphs;$t++)c.aj(ie,jt,sr);z&&te.associatedIconIndex>=0&&(ce[te.associatedIconIndex]={shiftedAnchor:jt,angle:sr})}else Lt(te.numGlyphs,ie)}if(z){le.clear();const me=y.icon.placedSymbolArray;for(let te=0;te<me.length;te++){const xe=me.get(te);if(xe.hidden)Lt(xe.numGlyphs,le);else{const be=ce[te];if(be)for(let Me=0;Me<xe.numGlyphs;Me++)c.aj(le,be.shiftedAnchor,be.angle);else Lt(xe.numGlyphs,le)}}y.icon.dynamicLayoutVertexBuffer.updateData(le)}y.text.dynamicLayoutVertexBuffer.updateData(ie)}function hs(y,t,a){return a.iconsInText&&t?"symbolTextAndIcon":y?"symbolSDF":"symbolIcon"}function dh(y,t,a,d,f,g,E,I,k,z,L,O){const V=y.context,X=V.gl,Q=y.transform,ie=pa(),le=I==="map",ce=k==="map",me=I!=="viewport"&&a.layout.get("symbol-placement")!=="point",te=le&&!ce&&!me,xe=!ce&&me,be=!a.layout.get("symbol-sort-key").isConstant();let Me=!1;const qe=y.depthModeForSublayer(0,an.ReadOnly),et=a._unevaluatedLayout.hasValue("text-variable-anchor")||a._unevaluatedLayout.hasValue("text-variable-anchor-offset"),lt=[],pt=ie.getCircleRadiusCorrection(Q);for(const ot of d){const at=t.getTile(ot),wt=at.getBucket(a);if(!wt)continue;const Gt=f?wt.text:wt.icon;if(!Gt||!Gt.segments.get().length||!Gt.hasVisibleVertices)continue;const dt=Gt.programConfigurations.get(a.id),nt=f||wt.sdfIcons,jt=f?wt.textSizeData:wt.iconSizeData,sr=ce||Q.pitch!==0,$t=y.useProgram(hs(nt,f,wt),dt),un=c.ag(jt,Q.zoom),Xn=y.style.map.terrain&&y.style.map.terrain.getTerrainData(ot);let Cr,ms,hn,pi,Ii=[0,0],mi=null;if(f)ms=at.glyphAtlasTexture,hn=X.LINEAR,Cr=at.glyphAtlasTexture.size,wt.iconsInText&&(Ii=at.imageAtlasTexture.size,mi=at.imageAtlasTexture,pi=sr||y.options.rotating||y.options.zooming||jt.kind==="composite"||jt.kind==="camera"?X.LINEAR:X.NEAREST);else{const gn=a.layout.get("icon-size").constantOr(0)!==1||wt.iconsNeedLinear;ms=at.imageAtlasTexture,hn=nt||y.options.rotating||y.options.zooming||gn||sr?X.LINEAR:X.NEAREST,Cr=at.imageAtlasTexture.size}const ki=fn(at,1,y.transform.zoom),gs=xe?ot.posMatrix:al,wl=ho(gs,ce,le,y.transform,ki),Yo=Rs(gs,ce,le,y.transform,ki),za=Rs(ot.posMatrix,ce,le,y.transform,ki),_s=ie.translatePosition(y.transform,at,g,E),ac=et&&wt.hasTextData(),Da=a.layout.get("icon-text-fit")!=="none"&&ac&&wt.hasIconData();if(me){const gn=y.style.map.terrain?(bl,Jo)=>y.style.map.terrain.getElevation(ot,bl,Jo):null,So=a.layout.get("text-rotation-alignment")==="map";K(wt,ot.posMatrix,y,f,wl,za,ce,z,So,ie,ot.toUnwrapped(),Q.width,Q.height,_s,gn)}const ys=ot.posMatrix,vs=f&&et||Da,to=me||vs?al:wl,xs=Yo,si=nt&&a.paint.get(f?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let gi;gi=nt?wt.iconsInText?Qc(jt.kind,un,te,ce,me,vs,y,ys,to,xs,_s,Cr,Ii,pt):Wn(jt.kind,un,te,ce,me,vs,y,ys,to,xs,_s,f,Cr,!0,pt):or(jt.kind,un,te,ce,me,vs,y,ys,to,xs,_s,f,Cr,pt);const Qi={program:$t,buffers:Gt,uniformValues:gi,atlasTexture:ms,atlasTextureIcon:mi,atlasInterpolation:hn,atlasInterpolationIcon:pi,isSDF:nt,hasHalo:si};if(be&&wt.canOverlap){Me=!0;const gn=Gt.segments.get();for(const So of gn)lt.push({segments:new c.a0([So]),sortKey:So.sortKey,state:Qi,terrainData:Xn})}else lt.push({segments:Gt.segments,sortKey:0,state:Qi,terrainData:Xn})}Me&&lt.sort((ot,at)=>ot.sortKey-at.sortKey);for(const ot of lt){const at=ot.state;if(V.activeTexture.set(X.TEXTURE0),at.atlasTexture.bind(at.atlasInterpolation,X.CLAMP_TO_EDGE),at.atlasTextureIcon&&(V.activeTexture.set(X.TEXTURE1),at.atlasTextureIcon&&at.atlasTextureIcon.bind(at.atlasInterpolationIcon,X.CLAMP_TO_EDGE)),at.isSDF){const wt=at.uniformValues;at.hasHalo&&(wt.u_is_halo=1,Go(at.buffers,ot.segments,a,y,at.program,qe,L,O,wt,ot.terrainData)),wt.u_is_halo=0}Go(at.buffers,ot.segments,a,y,at.program,qe,L,O,at.uniformValues,ot.terrainData)}}function Go(y,t,a,d,f,g,E,I,k,z){const L=d.context;f.draw(L,L.gl.TRIANGLES,g,E,I,Un.disabled,k,z,a.id,y.layoutVertexBuffer,y.indexBuffer,t,a.paint,d.transform.zoom,y.programConfigurations.get(a.id),y.dynamicLayoutVertexBuffer,y.opacityVertexBuffer)}function fh(y,t,a,d){const f=y.context,g=f.gl,E=pn.disabled,I=new mr([g.ONE,g.ONE],c.aM.transparent,[!0,!0,!0,!0]),k=t.getBucket(a);if(!k)return;const z=d.key;let L=a.heatmapFbos.get(z);L||(L=va(f,t.tileSize,t.tileSize),a.heatmapFbos.set(z,L)),f.bindFramebuffer.set(L.framebuffer),f.viewport.set([0,0,t.tileSize,t.tileSize]),f.clear({color:c.aM.transparent});const O=k.programConfigurations.get(a.id),V=y.useProgram("heatmap",O),X=y.style.map.terrain.getTerrainData(d);V.draw(f,g.TRIANGLES,an.disabled,E,I,Un.disabled,Ei(d.posMatrix,t,y.transform.zoom,a.paint.get("heatmap-intensity")),X,a.id,k.layoutVertexBuffer,k.indexBuffer,k.segments,a.paint,y.transform.zoom,O)}function ya(y,t,a){const d=y.context,f=d.gl;d.setColorMode(y.colorModeForRenderPass());const g=ul(d,t),E=a.key,I=t.heatmapFbos.get(E);I&&(d.activeTexture.set(f.TEXTURE0),f.bindTexture(f.TEXTURE_2D,I.colorAttachment.get()),d.activeTexture.set(f.TEXTURE1),g.bind(f.LINEAR,f.CLAMP_TO_EDGE),y.useProgram("heatmapTexture").draw(d,f.TRIANGLES,an.disabled,pn.disabled,y.colorModeForRenderPass(),Un.disabled,ju(y,t,0,1),null,t.id,y.rasterBoundsBuffer,y.quadTriangleIndexBuffer,y.rasterBoundsSegments,t.paint,y.transform.zoom),I.destroy(),t.heatmapFbos.delete(E))}function va(y,t,a){var d,f;const g=y.gl,E=g.createTexture();g.bindTexture(g.TEXTURE_2D,E),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_WRAP_S,g.CLAMP_TO_EDGE),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_WRAP_T,g.CLAMP_TO_EDGE),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MIN_FILTER,g.LINEAR),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MAG_FILTER,g.LINEAR);const I=(d=y.HALF_FLOAT)!==null&&d!==void 0?d:g.UNSIGNED_BYTE,k=(f=y.RGBA16F)!==null&&f!==void 0?f:g.RGBA;g.texImage2D(g.TEXTURE_2D,0,k,t,a,0,g.RGBA,I,null);const z=y.createFramebuffer(t,a,!1,!1);return z.colorAttachment.set(E),z}function ul(y,t){return t.colorRampTexture||(t.colorRampTexture=new Ue(y,t.colorRamp,y.gl.RGBA)),t.colorRampTexture}function Ki(y,t,a,d,f){if(!a||!d||!d.imageAtlas)return;const g=d.imageAtlas.patternPositions;let E=g[a.to.toString()],I=g[a.from.toString()];if(!E&&I&&(E=I),!I&&E&&(I=E),!E||!I){const k=f.getPaintProperty(t);E=g[k],I=g[k]}E&&I&&y.setConstantPatternPositions(E,I)}function Wo(y,t,a,d,f,g,E){const I=y.context.gl,k="fill-pattern",z=a.paint.get(k),L=z&&z.constantOr(1),O=a.getCrossfadeParameters();let V,X,Q,ie,le;E?(X=L&&!a.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",V=I.LINES):(X=L?"fillPattern":"fill",V=I.TRIANGLES);const ce=z.constantOr(null);for(const me of d){const te=t.getTile(me);if(L&&!te.patternsLoaded())continue;const xe=te.getBucket(a);if(!xe)continue;const be=xe.programConfigurations.get(a.id),Me=y.useProgram(X,be),qe=y.style.map.terrain&&y.style.map.terrain.getTerrainData(me);L&&(y.context.activeTexture.set(I.TEXTURE0),te.imageAtlasTexture.bind(I.LINEAR,I.CLAMP_TO_EDGE),be.updatePaintBuffers(O)),Ki(be,k,ce,te,a);const et=qe?me:null,lt=y.translatePosMatrix(et?et.posMatrix:me.posMatrix,te,a.paint.get("fill-translate"),a.paint.get("fill-translate-anchor"));if(E){ie=xe.indexBuffer2,le=xe.segments2;const pt=[I.drawingBufferWidth,I.drawingBufferHeight];Q=X==="fillOutlinePattern"&&L?Jc(lt,y,O,te,pt):_d(lt,pt)}else ie=xe.indexBuffer,le=xe.segments,Q=L?Yc(lt,y,O,te):sl(lt);Me.draw(y.context,V,f,y.stencilModeForClipping(me),g,Un.disabled,Q,qe,a.id,xe.layoutVertexBuffer,ie,le,a.paint,y.transform.zoom,be)}}function Ku(y,t,a,d,f,g,E){const I=y.context,k=I.gl,z="fill-extrusion-pattern",L=a.paint.get(z),O=L.constantOr(1),V=a.getCrossfadeParameters(),X=a.paint.get("fill-extrusion-opacity"),Q=L.constantOr(null);for(const ie of d){const le=t.getTile(ie),ce=le.getBucket(a);if(!ce)continue;const me=y.style.map.terrain&&y.style.map.terrain.getTerrainData(ie),te=ce.programConfigurations.get(a.id),xe=y.useProgram(O?"fillExtrusionPattern":"fillExtrusion",te);O&&(y.context.activeTexture.set(k.TEXTURE0),le.imageAtlasTexture.bind(k.LINEAR,k.CLAMP_TO_EDGE),te.updatePaintBuffers(V)),Ki(te,z,Q,le,a);const be=y.translatePosMatrix(ie.posMatrix,le,a.paint.get("fill-extrusion-translate"),a.paint.get("fill-extrusion-translate-anchor")),Me=a.paint.get("fill-extrusion-vertical-gradient"),qe=O?Vl(be,y,Me,X,ie,V,le):il(be,y,Me,X);xe.draw(I,I.gl.TRIANGLES,f,g,E,Un.backCCW,qe,me,a.id,ce.layoutVertexBuffer,ce.indexBuffer,ce.segments,a.paint,y.transform.zoom,te,y.style.map.terrain&&ce.centroidVertexBuffer)}}function cl(y,t,a,d,f,g,E){const I=y.context,k=I.gl,z=a.fbo;if(!z)return;const L=y.useProgram("hillshade"),O=y.style.map.terrain&&y.style.map.terrain.getTerrainData(t);I.activeTexture.set(k.TEXTURE0),k.bindTexture(k.TEXTURE_2D,z.colorAttachment.get()),L.draw(I,k.TRIANGLES,f,g,E,Un.disabled,((V,X,Q,ie)=>{const le=Q.paint.get("hillshade-shadow-color"),ce=Q.paint.get("hillshade-highlight-color"),me=Q.paint.get("hillshade-accent-color");let te=Q.paint.get("hillshade-illumination-direction")*(Math.PI/180);Q.paint.get("hillshade-illumination-anchor")==="viewport"&&(te-=V.transform.angle);const xe=!V.options.moving;return{u_matrix:ie?ie.posMatrix:V.transform.calculatePosMatrix(X.tileID.toUnwrapped(),xe),u_image:0,u_latrange:$u(0,X.tileID),u_light:[Q.paint.get("hillshade-exaggeration"),te],u_shadow:le,u_highlight:ce,u_accent:me}})(y,a,d,O?t:null),O,d.id,y.rasterBoundsBuffer,y.quadTriangleIndexBuffer,y.rasterBoundsSegments)}function hl(y,t,a,d,f,g){const E=y.context,I=E.gl,k=t.dem;if(k&&k.data){const z=k.dim,L=k.stride,O=k.getPixels();if(E.activeTexture.set(I.TEXTURE1),E.pixelStoreUnpackPremultiplyAlpha.set(!1),t.demTexture=t.demTexture||y.getTileTexture(L),t.demTexture){const X=t.demTexture;X.update(O,{premultiply:!1}),X.bind(I.NEAREST,I.CLAMP_TO_EDGE)}else t.demTexture=new Ue(E,O,I.RGBA,{premultiply:!1}),t.demTexture.bind(I.NEAREST,I.CLAMP_TO_EDGE);E.activeTexture.set(I.TEXTURE0);let V=t.fbo;if(!V){const X=new Ue(E,{width:z,height:z,data:null},I.RGBA);X.bind(I.LINEAR,I.CLAMP_TO_EDGE),V=t.fbo=E.createFramebuffer(z,z,!0,!1),V.colorAttachment.set(X.texture)}E.bindFramebuffer.set(V.framebuffer),E.viewport.set([0,0,z,z]),y.useProgram("hillshadePrepare").draw(E,I.TRIANGLES,d,f,g,Un.disabled,((X,Q)=>{const ie=Q.stride,le=c.H();return c.aP(le,0,c.X,-c.X,0,0,1),c.J(le,le,[0,-c.X,0]),{u_matrix:le,u_image:1,u_dimension:[ie,ie],u_zoom:X.overscaledZ,u_unpack:Q.getUnpackVector()}})(t.tileID,k),null,a.id,y.rasterBoundsBuffer,y.quadTriangleIndexBuffer,y.rasterBoundsSegments),t.needsHillshadePrepare=!1}}function xa(y,t,a,d,f,g){const E=d.paint.get("raster-fade-duration");if(!g&&E>0){const I=W.now(),k=(I-y.timeAdded)/E,z=t?(I-t.timeAdded)/E:-1,L=a.getSource(),O=f.coveringZoomLevel({tileSize:L.tileSize,roundZoom:L.roundZoom}),V=!t||Math.abs(t.tileID.overscaledZ-O)>Math.abs(y.tileID.overscaledZ-O),X=V&&y.refreshedUponExpiration?1:c.ac(V?k:1-z,0,1);return y.refreshedUponExpiration&&k>=1&&(y.refreshedUponExpiration=!1),t?{opacity:1,mix:1-X}:{opacity:X,mix:0}}return{opacity:1,mix:0}}const Yi=new c.aM(1,0,0,1),An=new c.aM(0,1,0,1),Yu=new c.aM(0,0,1,1),up=new c.aM(1,0,1,1),Ad=new c.aM(0,1,1,1);function dl(y,t,a,d){_o(y,0,t+a/2,y.transform.width,a,d)}function Md(y,t,a,d){_o(y,t-a/2,0,a,y.transform.height,d)}function _o(y,t,a,d,f,g){const E=y.context,I=E.gl;I.enable(I.SCISSOR_TEST),I.scissor(t*y.pixelRatio,a*y.pixelRatio,d*y.pixelRatio,f*y.pixelRatio),E.clear({color:g}),I.disable(I.SCISSOR_TEST)}function Ie(y,t,a){const d=y.context,f=d.gl,g=a.posMatrix,E=y.useProgram("debug"),I=an.disabled,k=pn.disabled,z=y.colorModeForRenderPass(),L="$debug",O=y.style.map.terrain&&y.style.map.terrain.getTerrainData(a);d.activeTexture.set(f.TEXTURE0);const V=t.getTileByID(a.key).latestRawTileData,X=Math.floor((V&&V.byteLength||0)/1024),Q=t.getTile(a).tileSize,ie=512/Math.min(Q,512)*(a.overscaledZ/y.transform.zoom)*.5;let le=a.canonical.toString();a.overscaledZ!==a.canonical.z&&(le+=` => ${a.overscaledZ}`),function(ce,me){ce.initDebugOverlayCanvas();const te=ce.debugOverlayCanvas,xe=ce.context.gl,be=ce.debugOverlayCanvas.getContext("2d");be.clearRect(0,0,te.width,te.height),be.shadowColor="white",be.shadowBlur=2,be.lineWidth=1.5,be.strokeStyle="white",be.textBaseline="top",be.font="bold 36px Open Sans, sans-serif",be.fillText(me,5,5),be.strokeText(me,5,5),ce.debugOverlayTexture.update(te),ce.debugOverlayTexture.bind(xe.LINEAR,xe.CLAMP_TO_EDGE)}(y,`${le} ${X}kB`),E.draw(d,f.TRIANGLES,I,k,mr.alphaBlended,Un.disabled,ql(g,c.aM.transparent,ie),null,L,y.debugBuffer,y.quadTriangleIndexBuffer,y.debugSegments),E.draw(d,f.LINE_STRIP,I,k,z,Un.disabled,ql(g,c.aM.red),O,L,y.debugBuffer,y.tileBorderIndexBuffer,y.debugSegments)}function Ve(y,t,a){const d=y.context,f=d.gl,g=y.colorModeForRenderPass(),E=new an(f.LEQUAL,an.ReadWrite,y.depthRangeFor3D),I=y.useProgram("terrain"),k=t.getTerrainMesh();d.bindFramebuffer.set(null),d.viewport.set([0,0,y.width,y.height]);for(const z of a){const L=y.renderToTexture.getTexture(z),O=t.getTerrainData(z.tileID);d.activeTexture.set(f.TEXTURE0),f.bindTexture(f.TEXTURE_2D,L.texture);const V=y.transform.calculatePosMatrix(z.tileID.toUnwrapped()),X=t.getMeshFrameDelta(y.transform.zoom),Q=y.transform.calculateFogMatrix(z.tileID.toUnwrapped()),ie=Uu(V,X,Q,y.style.sky,y.transform.pitch);I.draw(d,f.TRIANGLES,E,pn.disabled,g,Un.backCCW,ie,O,"terrain",k.vertexBuffer,k.indexBuffer,k.segments)}}class Oe{constructor(t,a,d){this.vertexBuffer=t,this.indexBuffer=a,this.segments=d}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.vertexBuffer=null,this.indexBuffer=null,this.segments=null}}class Tt{constructor(t,a){this.context=new ch(t),this.transform=a,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:c.an(new Float64Array(16)),renderTime:0},this.setup(),this.numSublayers=Ut.maxUnderzooming+Ut.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Bu}resize(t,a,d){if(this.width=Math.floor(t*d),this.height=Math.floor(a*d),this.pixelRatio=d,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const f of this.style._order)this.style._layers[f].resize()}setup(){const t=this.context,a=new c.aX;a.emplaceBack(0,0),a.emplaceBack(c.X,0),a.emplaceBack(0,c.X),a.emplaceBack(c.X,c.X),this.tileExtentBuffer=t.createVertexBuffer(a,No.members),this.tileExtentSegments=c.a0.simpleSegment(0,0,4,2);const d=new c.aX;d.emplaceBack(0,0),d.emplaceBack(c.X,0),d.emplaceBack(0,c.X),d.emplaceBack(c.X,c.X),this.debugBuffer=t.createVertexBuffer(d,No.members),this.debugSegments=c.a0.simpleSegment(0,0,4,5);const f=new c.$;f.emplaceBack(0,0,0,0),f.emplaceBack(c.X,0,c.X,0),f.emplaceBack(0,c.X,0,c.X),f.emplaceBack(c.X,c.X,c.X,c.X),this.rasterBoundsBuffer=t.createVertexBuffer(f,yr.members),this.rasterBoundsSegments=c.a0.simpleSegment(0,0,4,2);const g=new c.aX;g.emplaceBack(0,0),g.emplaceBack(1,0),g.emplaceBack(0,1),g.emplaceBack(1,1),this.viewportBuffer=t.createVertexBuffer(g,No.members),this.viewportSegments=c.a0.simpleSegment(0,0,4,2);const E=new c.aZ;E.emplaceBack(0),E.emplaceBack(1),E.emplaceBack(3),E.emplaceBack(2),E.emplaceBack(0),this.tileBorderIndexBuffer=t.createIndexBuffer(E);const I=new c.aY;I.emplaceBack(0,1,2),I.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=t.createIndexBuffer(I);const k=this.context.gl;this.stencilClearMode=new pn({func:k.ALWAYS,mask:0},0,255,k.ZERO,k.ZERO,k.ZERO)}clearStencil(){const t=this.context,a=t.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const d=c.H();c.aP(d,0,this.width,this.height,0,0,1),c.K(d,d,[a.drawingBufferWidth,a.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(t,a.TRIANGLES,an.disabled,this.stencilClearMode,mr.disabled,Un.disabled,Oi(d),null,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(t,a){if(this.currentStencilSource===t.source||!t.isTileClipped()||!a||!a.length)return;this.currentStencilSource=t.source;const d=this.context,f=d.gl;this.nextStencilID+a.length>256&&this.clearStencil(),d.setColorMode(mr.disabled),d.setDepthMode(an.disabled);const g=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const E of a){const I=this._tileClippingMaskIDs[E.key]=this.nextStencilID++,k=this.style.map.terrain&&this.style.map.terrain.getTerrainData(E);g.draw(d,f.TRIANGLES,an.disabled,new pn({func:f.ALWAYS,mask:0},I,255,f.KEEP,f.KEEP,f.REPLACE),mr.disabled,Un.disabled,Oi(E.posMatrix),k,"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const t=this.nextStencilID++,a=this.context.gl;return new pn({func:a.NOTEQUAL,mask:255},t,255,a.KEEP,a.KEEP,a.REPLACE)}stencilModeForClipping(t){const a=this.context.gl;return new pn({func:a.EQUAL,mask:255},this._tileClippingMaskIDs[t.key],0,a.KEEP,a.KEEP,a.REPLACE)}stencilConfigForOverlap(t){const a=this.context.gl,d=t.sort((E,I)=>I.overscaledZ-E.overscaledZ),f=d[d.length-1].overscaledZ,g=d[0].overscaledZ-f+1;if(g>1){this.currentStencilSource=void 0,this.nextStencilID+g>256&&this.clearStencil();const E={};for(let I=0;I<g;I++)E[I+f]=new pn({func:a.GEQUAL,mask:255},I+this.nextStencilID,255,a.KEEP,a.KEEP,a.REPLACE);return this.nextStencilID+=g,[E,d]}return[{[f]:pn.disabled},d]}colorModeForRenderPass(){const t=this.context.gl;return this._showOverdrawInspector?new mr([t.CONSTANT_COLOR,t.ONE],new c.aM(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?mr.unblended:mr.alphaBlended}depthModeForSublayer(t,a,d){if(!this.opaquePassEnabledForLayer())return an.disabled;const f=1-((1+this.currentLayer)*this.numSublayers+t)*this.depthEpsilon;return new an(d||this.context.gl.LEQUAL,a,[f,f])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(t,a){this.style=t,this.options=a,this.lineAtlas=t.lineAtlas,this.imageManager=t.imageManager,this.glyphManager=t.glyphManager,this.symbolFadeChange=t.placement.symbolFadeChange(W.now()),this.imageManager.beginFrame();const d=this.style._order,f=this.style.sourceCaches,g={},E={},I={};for(const k in f){const z=f[k];z.used&&z.prepare(this.context),g[k]=z.getVisibleCoordinates(),E[k]=g[k].slice().reverse(),I[k]=z.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let k=0;k<d.length;k++)if(this.style._layers[d[k]].is3D()){this.opaquePassCutoff=k;break}this.maybeDrawDepthAndCoords(!1),this.renderToTexture&&(this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0),this.renderPass="offscreen";for(const k of d){const z=this.style._layers[k];if(!z.hasOffscreenPass()||z.isHidden(this.transform.zoom))continue;const L=E[z.source];(z.type==="custom"||L.length)&&this.renderLayer(this,f[z.source],z,L)}if(this.context.bindFramebuffer.set(null),this.context.clear({color:a.showOverdrawInspector?c.aM.black:c.aM.transparent,depth:1}),this.clearStencil(),this.style.sky&&function(k,z){const L=k.context,O=L.gl,V=((ce,me,te)=>({u_sky_color:ce.properties.get("sky-color"),u_horizon_color:ce.properties.get("horizon-color"),u_horizon:(me.height/2+me.getHorizon())*te,u_sky_horizon_blend:ce.properties.get("sky-horizon-blend")*me.height/2*te}))(z,k.style.map.transform,k.pixelRatio),X=new an(O.LEQUAL,an.ReadWrite,[0,1]),Q=pn.disabled,ie=k.colorModeForRenderPass(),le=k.useProgram("sky");if(!z.mesh){const ce=new c.aX;ce.emplaceBack(-1,-1),ce.emplaceBack(1,-1),ce.emplaceBack(1,1),ce.emplaceBack(-1,1);const me=new c.aY;me.emplaceBack(0,1,2),me.emplaceBack(0,2,3),z.mesh=new Oe(L.createVertexBuffer(ce,No.members),L.createIndexBuffer(me),c.a0.simpleSegment(0,0,ce.length,me.length))}le.draw(L,O.TRIANGLES,X,Q,ie,Un.disabled,V,void 0,"sky",z.mesh.vertexBuffer,z.mesh.indexBuffer,z.mesh.segments)}(this,this.style.sky),this._showOverdrawInspector=a.showOverdrawInspector,this.depthRangeFor3D=[0,1-(t._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=d.length-1;this.currentLayer>=0;this.currentLayer--){const k=this.style._layers[d[this.currentLayer]],z=f[k.source],L=g[k.source];this._renderTileClippingMasks(k,L),this.renderLayer(this,z,k,L)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<d.length;this.currentLayer++){const k=this.style._layers[d[this.currentLayer]],z=f[k.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(k))continue;const L=(k.type==="symbol"?I:E)[k.source];this._renderTileClippingMasks(k,g[k.source]),this.renderLayer(this,z,k,L)}if(this.options.showTileBoundaries){const k=function(z,L){let O=null;const V=Object.values(z._layers).flatMap(le=>le.source&&!le.isHidden(L)?[z.sourceCaches[le.source]]:[]),X=V.filter(le=>le.getSource().type==="vector"),Q=V.filter(le=>le.getSource().type!=="vector"),ie=le=>{(!O||O.getSource().maxzoom<le.getSource().maxzoom)&&(O=le)};return X.forEach(le=>ie(le)),O||Q.forEach(le=>ie(le)),O}(this.style,this.transform.zoom);k&&function(z,L,O){for(let V=0;V<O.length;V++)Ie(z,L,O[V])}(this,k,k.getVisibleCoordinates())}this.options.showPadding&&function(k){const z=k.transform.padding;dl(k,k.transform.height-(z.top||0),3,Yi),dl(k,z.bottom||0,3,An),Md(k,z.left||0,3,Yu),Md(k,k.transform.width-(z.right||0),3,up);const L=k.transform.centerPoint;(function(O,V,X,Q){_o(O,V-1,X-10,2,20,Q),_o(O,V-10,X-1,20,2,Q)})(k,L.x,k.transform.height-L.y,Ad)}(this),this.context.setDefault()}maybeDrawDepthAndCoords(t){if(!this.style||!this.style.map||!this.style.map.terrain)return;const a=this.terrainFacilitator.matrix,d=this.transform.modelViewProjectionMatrix;let f=this.terrainFacilitator.dirty;f||(f=t?!c.a_(a,d):!c.a$(a,d)),f||(f=this.style.map.terrain.sourceCache.tilesAfterTime(this.terrainFacilitator.renderTime).length>0),f&&(c.b0(a,d),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(g,E){const I=g.context,k=I.gl,z=mr.unblended,L=new an(k.LEQUAL,an.ReadWrite,[0,1]),O=E.getTerrainMesh(),V=E.sourceCache.getRenderableTiles(),X=g.useProgram("terrainDepth");I.bindFramebuffer.set(E.getFramebuffer("depth").framebuffer),I.viewport.set([0,0,g.width/devicePixelRatio,g.height/devicePixelRatio]),I.clear({color:c.aM.transparent,depth:1});for(const Q of V){const ie=E.getTerrainData(Q.tileID),le={u_matrix:g.transform.calculatePosMatrix(Q.tileID.toUnwrapped()),u_ele_delta:E.getMeshFrameDelta(g.transform.zoom)};X.draw(I,k.TRIANGLES,L,pn.disabled,z,Un.backCCW,le,ie,"terrain",O.vertexBuffer,O.indexBuffer,O.segments)}I.bindFramebuffer.set(null),I.viewport.set([0,0,g.width,g.height])}(this,this.style.map.terrain),function(g,E){const I=g.context,k=I.gl,z=mr.unblended,L=new an(k.LEQUAL,an.ReadWrite,[0,1]),O=E.getTerrainMesh(),V=E.getCoordsTexture(),X=E.sourceCache.getRenderableTiles(),Q=g.useProgram("terrainCoords");I.bindFramebuffer.set(E.getFramebuffer("coords").framebuffer),I.viewport.set([0,0,g.width/devicePixelRatio,g.height/devicePixelRatio]),I.clear({color:c.aM.transparent,depth:1}),E.coordsIndex=[];for(const ie of X){const le=E.getTerrainData(ie.tileID);I.activeTexture.set(k.TEXTURE0),k.bindTexture(k.TEXTURE_2D,V.texture);const ce={u_matrix:g.transform.calculatePosMatrix(ie.tileID.toUnwrapped()),u_terrain_coords_id:(255-E.coordsIndex.length)/255,u_texture:0,u_ele_delta:E.getMeshFrameDelta(g.transform.zoom)};Q.draw(I,k.TRIANGLES,L,pn.disabled,z,Un.backCCW,ce,le,"terrain",O.vertexBuffer,O.indexBuffer,O.segments),E.coordsIndex.push(ie.tileID.key)}I.bindFramebuffer.set(null),I.viewport.set([0,0,g.width,g.height])}(this,this.style.map.terrain))}renderLayer(t,a,d,f){if(!d.isHidden(this.transform.zoom)&&(d.type==="background"||d.type==="custom"||(f||[]).length))switch(this.id=d.id,d.type){case"symbol":(function(g,E,I,k,z){if(g.renderPass!=="translucent")return;const L=pn.disabled,O=g.colorModeForRenderPass();(I._unevaluatedLayout.hasValue("text-variable-anchor")||I._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&function(V,X,Q,ie,le,ce,me,te,xe){const be=X.transform,Me=pa(),qe=le==="map",et=ce==="map";for(const lt of V){const pt=ie.getTile(lt),ot=pt.getBucket(Q);if(!ot||!ot.text||!ot.text.segments.get().length)continue;const at=c.ag(ot.textSizeData,be.zoom),wt=fn(pt,1,X.transform.zoom),Gt=ho(lt.posMatrix,et,qe,X.transform,wt),dt=Q.layout.get("icon-text-fit")!=="none"&&ot.hasIconData();if(at){const nt=Math.pow(2,be.zoom-pt.tileID.overscaledZ),jt=X.style.map.terrain?($t,un)=>X.style.map.terrain.getElevation(lt,$t,un):null,sr=Me.translatePosition(be,pt,me,te);ll(ot,qe,et,xe,be,Gt,lt.posMatrix,nt,at,dt,Me,sr,lt.toUnwrapped(),jt)}}}(k,g,I,E,I.layout.get("text-rotation-alignment"),I.layout.get("text-pitch-alignment"),I.paint.get("text-translate"),I.paint.get("text-translate-anchor"),z),I.paint.get("icon-opacity").constantOr(1)!==0&&dh(g,E,I,k,!1,I.paint.get("icon-translate"),I.paint.get("icon-translate-anchor"),I.layout.get("icon-rotation-alignment"),I.layout.get("icon-pitch-alignment"),I.layout.get("icon-keep-upright"),L,O),I.paint.get("text-opacity").constantOr(1)!==0&&dh(g,E,I,k,!0,I.paint.get("text-translate"),I.paint.get("text-translate-anchor"),I.layout.get("text-rotation-alignment"),I.layout.get("text-pitch-alignment"),I.layout.get("text-keep-upright"),L,O),E.map.showCollisionBoxes&&(ol(g,E,I,k,!0),ol(g,E,I,k,!1))})(t,a,d,f,this.style.placement.variableOffsets);break;case"circle":(function(g,E,I,k){if(g.renderPass!=="translucent")return;const z=I.paint.get("circle-opacity"),L=I.paint.get("circle-stroke-width"),O=I.paint.get("circle-stroke-opacity"),V=!I.layout.get("circle-sort-key").isConstant();if(z.constantOr(1)===0&&(L.constantOr(1)===0||O.constantOr(1)===0))return;const X=g.context,Q=X.gl,ie=g.depthModeForSublayer(0,an.ReadOnly),le=pn.disabled,ce=g.colorModeForRenderPass(),me=[];for(let te=0;te<k.length;te++){const xe=k[te],be=E.getTile(xe),Me=be.getBucket(I);if(!Me)continue;const qe=Me.programConfigurations.get(I.id),et=g.useProgram("circle",qe),lt=Me.layoutVertexBuffer,pt=Me.indexBuffer,ot=g.style.map.terrain&&g.style.map.terrain.getTerrainData(xe),at={programConfiguration:qe,program:et,layoutVertexBuffer:lt,indexBuffer:pt,uniformValues:yd(g,xe,be,I),terrainData:ot};if(V){const wt=Me.segments.get();for(const Gt of wt)me.push({segments:new c.a0([Gt]),sortKey:Gt.sortKey,state:at})}else me.push({segments:Me.segments,sortKey:0,state:at})}V&&me.sort((te,xe)=>te.sortKey-xe.sortKey);for(const te of me){const{programConfiguration:xe,program:be,layoutVertexBuffer:Me,indexBuffer:qe,uniformValues:et,terrainData:lt}=te.state;be.draw(X,Q.TRIANGLES,ie,le,ce,Un.disabled,et,lt,I.id,Me,qe,te.segments,I.paint,g.transform.zoom,xe)}})(t,a,d,f);break;case"heatmap":(function(g,E,I,k){if(I.paint.get("heatmap-opacity")===0)return;const z=g.context;if(g.style.map.terrain){for(const L of k){const O=E.getTile(L);E.hasRenderableParent(L)||(g.renderPass==="offscreen"?fh(g,O,I,L):g.renderPass==="translucent"&&ya(g,I,L))}z.viewport.set([0,0,g.width,g.height])}else g.renderPass==="offscreen"?function(L,O,V,X){const Q=L.context,ie=Q.gl,le=pn.disabled,ce=new mr([ie.ONE,ie.ONE],c.aM.transparent,[!0,!0,!0,!0]);(function(me,te,xe){const be=me.gl;me.activeTexture.set(be.TEXTURE1),me.viewport.set([0,0,te.width/4,te.height/4]);let Me=xe.heatmapFbos.get(c.aU);Me?(be.bindTexture(be.TEXTURE_2D,Me.colorAttachment.get()),me.bindFramebuffer.set(Me.framebuffer)):(Me=va(me,te.width/4,te.height/4),xe.heatmapFbos.set(c.aU,Me))})(Q,L,V),Q.clear({color:c.aM.transparent});for(let me=0;me<X.length;me++){const te=X[me];if(O.hasRenderableParent(te))continue;const xe=O.getTile(te),be=xe.getBucket(V);if(!be)continue;const Me=be.programConfigurations.get(V.id),qe=L.useProgram("heatmap",Me),{zoom:et}=L.transform;qe.draw(Q,ie.TRIANGLES,an.disabled,le,ce,Un.disabled,Ei(te.posMatrix,xe,et,V.paint.get("heatmap-intensity")),null,V.id,be.layoutVertexBuffer,be.indexBuffer,be.segments,V.paint,L.transform.zoom,Me)}Q.viewport.set([0,0,L.width,L.height])}(g,E,I,k):g.renderPass==="translucent"&&function(L,O){const V=L.context,X=V.gl;V.setColorMode(L.colorModeForRenderPass());const Q=O.heatmapFbos.get(c.aU);Q&&(V.activeTexture.set(X.TEXTURE0),X.bindTexture(X.TEXTURE_2D,Q.colorAttachment.get()),V.activeTexture.set(X.TEXTURE1),ul(V,O).bind(X.LINEAR,X.CLAMP_TO_EDGE),L.useProgram("heatmapTexture").draw(V,X.TRIANGLES,an.disabled,pn.disabled,L.colorModeForRenderPass(),Un.disabled,ju(L,O,0,1),null,O.id,L.viewportBuffer,L.quadTriangleIndexBuffer,L.viewportSegments,O.paint,L.transform.zoom))}(g,I)})(t,a,d,f);break;case"line":(function(g,E,I,k){if(g.renderPass!=="translucent")return;const z=I.paint.get("line-opacity"),L=I.paint.get("line-width");if(z.constantOr(1)===0||L.constantOr(1)===0)return;const O=g.depthModeForSublayer(0,an.ReadOnly),V=g.colorModeForRenderPass(),X=I.paint.get("line-dasharray"),Q=I.paint.get("line-pattern"),ie=Q.constantOr(1),le=I.paint.get("line-gradient"),ce=I.getCrossfadeParameters(),me=ie?"linePattern":X?"lineSDF":le?"lineGradient":"line",te=g.context,xe=te.gl;let be=!0;for(const Me of k){const qe=E.getTile(Me);if(ie&&!qe.patternsLoaded())continue;const et=qe.getBucket(I);if(!et)continue;const lt=et.programConfigurations.get(I.id),pt=g.context.program.get(),ot=g.useProgram(me,lt),at=be||ot.program!==pt,wt=g.style.map.terrain&&g.style.map.terrain.getTerrainData(Me),Gt=Q.constantOr(null);if(Gt&&qe.imageAtlas){const jt=qe.imageAtlas,sr=jt.patternPositions[Gt.to.toString()],$t=jt.patternPositions[Gt.from.toString()];sr&&$t&&lt.setConstantPatternPositions(sr,$t)}const dt=wt?Me:null,nt=ie?jo(g,qe,I,ce,dt):X?ip(g,qe,I,X,ce,dt):le?vd(g,qe,I,et.lineClipsArray.length,dt):Vu(g,qe,I,dt);if(ie)te.activeTexture.set(xe.TEXTURE0),qe.imageAtlasTexture.bind(xe.LINEAR,xe.CLAMP_TO_EDGE),lt.updatePaintBuffers(ce);else if(X&&(at||g.lineAtlas.dirty))te.activeTexture.set(xe.TEXTURE0),g.lineAtlas.bind(te);else if(le){const jt=et.gradients[I.id];let sr=jt.texture;if(I.gradientVersion!==jt.version){let $t=256;if(I.stepInterpolant){const un=E.getSource().maxzoom,Xn=Me.canonical.z===un?Math.ceil(1<<g.transform.maxZoom-Me.canonical.z):1;$t=c.ac(c.aV(et.maxLineLength/c.X*1024*Xn),256,te.maxTextureSize)}jt.gradient=c.aW({expression:I.gradientExpression(),evaluationKey:"lineProgress",resolution:$t,image:jt.gradient||void 0,clips:et.lineClipsArray}),jt.texture?jt.texture.update(jt.gradient):jt.texture=new Ue(te,jt.gradient,xe.RGBA),jt.version=I.gradientVersion,sr=jt.texture}te.activeTexture.set(xe.TEXTURE0),sr.bind(I.stepInterpolant?xe.NEAREST:xe.LINEAR,xe.CLAMP_TO_EDGE)}ot.draw(te,xe.TRIANGLES,O,g.stencilModeForClipping(Me),V,Un.disabled,nt,wt,I.id,et.layoutVertexBuffer,et.indexBuffer,et.segments,I.paint,g.transform.zoom,lt,et.layoutVertexBuffer2),be=!1}})(t,a,d,f);break;case"fill":(function(g,E,I,k){const z=I.paint.get("fill-color"),L=I.paint.get("fill-opacity");if(L.constantOr(1)===0)return;const O=g.colorModeForRenderPass(),V=I.paint.get("fill-pattern"),X=g.opaquePassEnabledForLayer()&&!V.constantOr(1)&&z.constantOr(c.aM.transparent).a===1&&L.constantOr(0)===1?"opaque":"translucent";if(g.renderPass===X){const Q=g.depthModeForSublayer(1,g.renderPass==="opaque"?an.ReadWrite:an.ReadOnly);Wo(g,E,I,k,Q,O,!1)}if(g.renderPass==="translucent"&&I.paint.get("fill-antialias")){const Q=g.depthModeForSublayer(I.getPaintProperty("fill-outline-color")?2:0,an.ReadOnly);Wo(g,E,I,k,Q,O,!0)}})(t,a,d,f);break;case"fill-extrusion":(function(g,E,I,k){const z=I.paint.get("fill-extrusion-opacity");if(z!==0&&g.renderPass==="translucent"){const L=new an(g.context.gl.LEQUAL,an.ReadWrite,g.depthRangeFor3D);if(z!==1||I.paint.get("fill-extrusion-pattern").constantOr(1))Ku(g,E,I,k,L,pn.disabled,mr.disabled),Ku(g,E,I,k,L,g.stencilModeFor3D(),g.colorModeForRenderPass());else{const O=g.colorModeForRenderPass();Ku(g,E,I,k,L,pn.disabled,O)}}})(t,a,d,f);break;case"hillshade":(function(g,E,I,k){if(g.renderPass!=="offscreen"&&g.renderPass!=="translucent")return;const z=g.context,L=g.depthModeForSublayer(0,an.ReadOnly),O=g.colorModeForRenderPass(),[V,X]=g.renderPass==="translucent"?g.stencilConfigForOverlap(k):[{},k];for(const Q of X){const ie=E.getTile(Q);ie.needsHillshadePrepare!==void 0&&ie.needsHillshadePrepare&&g.renderPass==="offscreen"?hl(g,ie,I,L,pn.disabled,O):g.renderPass==="translucent"&&cl(g,Q,ie,I,L,V[Q.overscaledZ],O)}z.viewport.set([0,0,g.width,g.height])})(t,a,d,f);break;case"raster":(function(g,E,I,k){if(g.renderPass!=="translucent"||I.paint.get("raster-opacity")===0||!k.length)return;const z=g.context,L=z.gl,O=E.getSource(),V=g.useProgram("raster"),X=g.colorModeForRenderPass(),[Q,ie]=O instanceof Hr?[{},k]:g.stencilConfigForOverlap(k),le=ie[ie.length-1].overscaledZ,ce=!g.options.moving;for(const me of ie){const te=g.depthModeForSublayer(me.overscaledZ-le,I.paint.get("raster-opacity")===1?an.ReadWrite:an.ReadOnly,L.LESS),xe=E.getTile(me);xe.registerFadeDuration(I.paint.get("raster-fade-duration"));const be=E.findLoadedParent(me,0),Me=E.findLoadedSibling(me),qe=xa(xe,be||Me||null,E,I,g.transform,g.style.map.terrain);let et,lt;const pt=I.paint.get("raster-resampling")==="nearest"?L.NEAREST:L.LINEAR;z.activeTexture.set(L.TEXTURE0),xe.texture.bind(pt,L.CLAMP_TO_EDGE,L.LINEAR_MIPMAP_NEAREST),z.activeTexture.set(L.TEXTURE1),be?(be.texture.bind(pt,L.CLAMP_TO_EDGE,L.LINEAR_MIPMAP_NEAREST),et=Math.pow(2,be.tileID.overscaledZ-xe.tileID.overscaledZ),lt=[xe.tileID.canonical.x*et%1,xe.tileID.canonical.y*et%1]):xe.texture.bind(pt,L.CLAMP_TO_EDGE,L.LINEAR_MIPMAP_NEAREST),xe.texture.useMipmap&&z.extTextureFilterAnisotropic&&g.transform.pitch>20&&L.texParameterf(L.TEXTURE_2D,z.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,z.extTextureFilterAnisotropicMax);const ot=g.style.map.terrain&&g.style.map.terrain.getTerrainData(me),at=ot?me:null,wt=at?at.posMatrix:g.transform.calculatePosMatrix(me.toUnwrapped(),ce),Gt=sp(wt,lt||[0,0],et||1,qe,I);O instanceof Hr?V.draw(z,L.TRIANGLES,te,pn.disabled,X,Un.disabled,Gt,ot,I.id,O.boundsBuffer,g.quadTriangleIndexBuffer,O.boundsSegments):V.draw(z,L.TRIANGLES,te,Q[me.overscaledZ],X,Un.disabled,Gt,ot,I.id,g.rasterBoundsBuffer,g.quadTriangleIndexBuffer,g.rasterBoundsSegments)}})(t,a,d,f);break;case"background":(function(g,E,I,k){const z=I.paint.get("background-color"),L=I.paint.get("background-opacity");if(L===0)return;const O=g.context,V=O.gl,X=g.transform,Q=X.tileSize,ie=I.paint.get("background-pattern");if(g.isPatternMissing(ie))return;const le=!ie&&z.a===1&&L===1&&g.opaquePassEnabledForLayer()?"opaque":"translucent";if(g.renderPass!==le)return;const ce=pn.disabled,me=g.depthModeForSublayer(0,le==="opaque"?an.ReadWrite:an.ReadOnly),te=g.colorModeForRenderPass(),xe=g.useProgram(ie?"backgroundPattern":"background"),be=k||X.coveringTiles({tileSize:Q,terrain:g.style.map.terrain});ie&&(O.activeTexture.set(V.TEXTURE0),g.imageManager.bind(g.context));const Me=I.getCrossfadeParameters();for(const qe of be){const et=k?qe.posMatrix:g.transform.calculatePosMatrix(qe.toUnwrapped()),lt=ie?eh(et,L,g,ie,{tileID:qe,tileSize:Q},Me):qu(et,L,z),pt=g.style.map.terrain&&g.style.map.terrain.getTerrainData(qe);xe.draw(O,V.TRIANGLES,me,ce,te,Un.disabled,lt,pt,I.id,g.tileExtentBuffer,g.quadTriangleIndexBuffer,g.tileExtentSegments)}})(t,0,d,f);break;case"custom":(function(g,E,I){const k=g.context,z=I.implementation;if(g.renderPass==="offscreen"){const L=z.prerender;L&&(g.setCustomLayerDefaults(),k.setColorMode(g.colorModeForRenderPass()),L.call(z,k.gl,g.transform.customLayerMatrix()),k.setDirty(),g.setBaseState())}else if(g.renderPass==="translucent"){g.setCustomLayerDefaults(),k.setColorMode(g.colorModeForRenderPass()),k.setStencilMode(pn.disabled);const L=z.renderingMode==="3d"?new an(g.context.gl.LEQUAL,an.ReadWrite,g.depthRangeFor3D):g.depthModeForSublayer(0,an.ReadOnly);k.setDepthMode(L),z.render(k.gl,g.transform.customLayerMatrix(),{farZ:g.transform.farZ,nearZ:g.transform.nearZ,fov:g.transform._fov,modelViewProjectionMatrix:g.transform.modelViewProjectionMatrix,projectionMatrix:g.transform.projectionMatrix}),k.setDirty(),g.setBaseState(),k.bindFramebuffer.set(null)}})(t,0,d)}}translatePosMatrix(t,a,d,f,g){if(!d[0]&&!d[1])return t;const E=g?f==="map"?this.transform.angle:0:f==="viewport"?-this.transform.angle:0;if(E){const z=Math.sin(E),L=Math.cos(E);d=[d[0]*L-d[1]*z,d[0]*z+d[1]*L]}const I=[g?d[0]:fn(a,d[0],this.transform.zoom),g?d[1]:fn(a,d[1],this.transform.zoom),0],k=new Float32Array(16);return c.J(k,t,I),k}saveTileTexture(t){const a=this._tileTextures[t.size[0]];a?a.push(t):this._tileTextures[t.size[0]]=[t]}getTileTexture(t){const a=this._tileTextures[t];return a&&a.length>0?a.pop():null}isPatternMissing(t){if(!t)return!1;if(!t.from||!t.to)return!0;const a=this.imageManager.getPattern(t.from.toString()),d=this.imageManager.getPattern(t.to.toString());return!a||!d}useProgram(t,a){this.cache=this.cache||{};const d=t+(a?a.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"")+(this.style.map.terrain?"/terrain":"");return this.cache[d]||(this.cache[d]=new $l(this.context,fo[t],a,th[t],this._showOverdrawInspector,this.style.map.terrain)),this.cache[d]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const t=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(t.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new Ue(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}overLimit(){const{drawingBufferWidth:t,drawingBufferHeight:a}=this.context.gl;return this.width!==t||this.height!==a}}class Wt{constructor(t,a){this.points=t,this.planes=a}static fromInvProjectionMatrix(t,a,d){const f=Math.pow(2,d),g=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(I=>{const k=1/(I=c.af([],I,t))[3]/a*f;return c.b1(I,I,[k,k,1/I[3],k])}),E=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(I=>{const k=function(V,X){var Q=X[0],ie=X[1],le=X[2],ce=Q*Q+ie*ie+le*le;return ce>0&&(ce=1/Math.sqrt(ce)),V[0]=X[0]*ce,V[1]=X[1]*ce,V[2]=X[2]*ce,V}([],function(V,X,Q){var ie=X[0],le=X[1],ce=X[2],me=Q[0],te=Q[1],xe=Q[2];return V[0]=le*xe-ce*te,V[1]=ce*me-ie*xe,V[2]=ie*te-le*me,V}([],ve([],g[I[0]],g[I[1]]),ve([],g[I[2]],g[I[1]]))),z=-((L=k)[0]*(O=g[I[1]])[0]+L[1]*O[1]+L[2]*O[2]);var L,O;return k.concat(z)});return new Wt(g,E)}}class Tn{constructor(t,a){this.min=t,this.max=a,this.center=function(d,f,g){return d[0]=.5*f[0],d[1]=.5*f[1],d[2]=.5*f[2],d}([],function(d,f,g){return d[0]=f[0]+g[0],d[1]=f[1]+g[1],d[2]=f[2]+g[2],d}([],this.min,this.max))}quadrant(t){const a=[t%2==0,t<2],d=Ze(this.min),f=Ze(this.max);for(let g=0;g<a.length;g++)d[g]=a[g]?this.min[g]:this.center[g],f[g]=a[g]?this.center[g]:this.max[g];return f[2]=this.max[2],new Tn(d,f)}distanceX(t){return Math.max(Math.min(this.max[0],t[0]),this.min[0])-t[0]}distanceY(t){return Math.max(Math.min(this.max[1],t[1]),this.min[1])-t[1]}intersects(t){const a=[[this.min[0],this.min[1],this.min[2],1],[this.max[0],this.min[1],this.min[2],1],[this.max[0],this.max[1],this.min[2],1],[this.min[0],this.max[1],this.min[2],1],[this.min[0],this.min[1],this.max[2],1],[this.max[0],this.min[1],this.max[2],1],[this.max[0],this.max[1],this.max[2],1],[this.min[0],this.max[1],this.max[2],1]];let d=!0;for(let f=0;f<t.planes.length;f++){const g=t.planes[f];let E=0;for(let I=0;I<a.length;I++)c.b2(g,a[I])>=0&&E++;if(E===0)return 0;E!==a.length&&(d=!1)}if(d)return 2;for(let f=0;f<3;f++){let g=Number.MAX_VALUE,E=-Number.MAX_VALUE;for(let I=0;I<t.points.length;I++){const k=t.points[I][f]-this.min[f];g=Math.min(g,k),E=Math.max(E,k)}if(E<0||g>this.max[f]-this.min[f])return 0}return 1}}class gr{constructor(t=0,a=0,d=0,f=0){if(isNaN(t)||t<0||isNaN(a)||a<0||isNaN(d)||d<0||isNaN(f)||f<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=t,this.bottom=a,this.left=d,this.right=f}interpolate(t,a,d){return a.top!=null&&t.top!=null&&(this.top=c.y.number(t.top,a.top,d)),a.bottom!=null&&t.bottom!=null&&(this.bottom=c.y.number(t.bottom,a.bottom,d)),a.left!=null&&t.left!=null&&(this.left=c.y.number(t.left,a.left,d)),a.right!=null&&t.right!=null&&(this.right=c.y.number(t.right,a.right,d)),this}getCenter(t,a){const d=c.ac((this.left+t-this.right)/2,0,t),f=c.ac((this.top+a-this.bottom)/2,0,a);return new c.P(d,f)}equals(t){return this.top===t.top&&this.bottom===t.bottom&&this.left===t.left&&this.right===t.right}clone(){return new gr(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}const Hn=85.051129;class Ho{constructor(t,a,d,f,g){this.tileSize=512,this._renderWorldCopies=g===void 0||!!g,this._minZoom=t||0,this._maxZoom=a||22,this._minPitch=d??0,this._maxPitch=f??60,this.setMaxBounds(),this.width=0,this.height=0,this._center=new c.N(0,0),this._elevation=0,this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new gr,this._posMatrixCache={},this._alignedPosMatrixCache={},this._fogMatrixCache={},this.minElevationForCurrentTile=0}clone(){const t=new Ho(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return t.apply(this),t}apply(t){this.tileSize=t.tileSize,this.latRange=t.latRange,this.lngRange=t.lngRange,this.width=t.width,this.height=t.height,this._center=t._center,this._elevation=t._elevation,this.minElevationForCurrentTile=t.minElevationForCurrentTile,this.zoom=t.zoom,this.angle=t.angle,this._fov=t._fov,this._pitch=t._pitch,this._unmodified=t._unmodified,this._edgeInsets=t._edgeInsets.clone(),this._calcMatrices()}get minZoom(){return this._minZoom}set minZoom(t){this._minZoom!==t&&(this._minZoom=t,this.zoom=Math.max(this.zoom,t))}get maxZoom(){return this._maxZoom}set maxZoom(t){this._maxZoom!==t&&(this._maxZoom=t,this.zoom=Math.min(this.zoom,t))}get minPitch(){return this._minPitch}set minPitch(t){this._minPitch!==t&&(this._minPitch=t,this.pitch=Math.max(this.pitch,t))}get maxPitch(){return this._maxPitch}set maxPitch(t){this._maxPitch!==t&&(this._maxPitch=t,this.pitch=Math.min(this.pitch,t))}get renderWorldCopies(){return this._renderWorldCopies}set renderWorldCopies(t){t===void 0?t=!0:t===null&&(t=!1),this._renderWorldCopies=t}get worldSize(){return this.tileSize*this.scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new c.P(this.width,this.height)}get bearing(){return-this.angle/Math.PI*180}set bearing(t){const a=-c.b3(t,-180,180)*Math.PI/180;this.angle!==a&&(this._unmodified=!1,this.angle=a,this._calcMatrices(),this.rotationMatrix=function(){var d=new c.A(4);return c.A!=Float32Array&&(d[1]=0,d[2]=0),d[0]=1,d[3]=1,d}(),function(d,f,g){var E=f[0],I=f[1],k=f[2],z=f[3],L=Math.sin(g),O=Math.cos(g);d[0]=E*O+k*L,d[1]=I*O+z*L,d[2]=E*-L+k*O,d[3]=I*-L+z*O}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(t){const a=c.ac(t,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==a&&(this._unmodified=!1,this._pitch=a,this._calcMatrices())}get fov(){return this._fov/Math.PI*180}set fov(t){t=Math.max(.01,Math.min(60,t)),this._fov!==t&&(this._unmodified=!1,this._fov=t/180*Math.PI,this._calcMatrices())}get zoom(){return this._zoom}set zoom(t){const a=Math.min(Math.max(t,this.minZoom),this.maxZoom);this._zoom!==a&&(this._unmodified=!1,this._zoom=a,this.tileZoom=Math.max(0,Math.floor(a)),this.scale=this.zoomScale(a),this._constrain(),this._calcMatrices())}get center(){return this._center}set center(t){t.lat===this._center.lat&&t.lng===this._center.lng||(this._unmodified=!1,this._center=t,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}set elevation(t){t!==this._elevation&&(this._elevation=t,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}set padding(t){this._edgeInsets.equals(t)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,t,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}isPaddingEqual(t){return this._edgeInsets.equals(t)}interpolatePadding(t,a,d){this._unmodified=!1,this._edgeInsets.interpolate(t,a,d),this._constrain(),this._calcMatrices()}coveringZoomLevel(t){const a=(t.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/t.tileSize));return Math.max(0,a)}getVisibleUnwrappedCoordinates(t){const a=[new c.b4(0,t)];if(this._renderWorldCopies){const d=this.pointCoordinate(new c.P(0,0)),f=this.pointCoordinate(new c.P(this.width,0)),g=this.pointCoordinate(new c.P(this.width,this.height)),E=this.pointCoordinate(new c.P(0,this.height)),I=Math.floor(Math.min(d.x,f.x,g.x,E.x)),k=Math.floor(Math.max(d.x,f.x,g.x,E.x)),z=1;for(let L=I-z;L<=k+z;L++)L!==0&&a.push(new c.b4(L,t))}return a}coveringTiles(t){var a,d;let f=this.coveringZoomLevel(t);const g=f;if(t.minzoom!==void 0&&f<t.minzoom)return[];t.maxzoom!==void 0&&f>t.maxzoom&&(f=t.maxzoom);const E=this.pointCoordinate(this.getCameraPoint()),I=c.Z.fromLngLat(this.center),k=Math.pow(2,f),z=[k*E.x,k*E.y,0],L=[k*I.x,k*I.y,0],O=Wt.fromInvProjectionMatrix(this.invModelViewProjectionMatrix,this.worldSize,f);let V=t.minzoom||0;!t.terrain&&this.pitch<=60&&this._edgeInsets.top<.1&&(V=f);const X=t.terrain?2/Math.min(this.tileSize,t.tileSize)*this.tileSize:3,Q=te=>({aabb:new Tn([te*k,0,0],[(te+1)*k,k,0]),zoom:0,x:0,y:0,wrap:te,fullyVisible:!1}),ie=[],le=[],ce=f,me=t.reparseOverscaled?g:f;if(this._renderWorldCopies)for(let te=1;te<=3;te++)ie.push(Q(-te)),ie.push(Q(te));for(ie.push(Q(0));ie.length>0;){const te=ie.pop(),xe=te.x,be=te.y;let Me=te.fullyVisible;if(!Me){const ot=te.aabb.intersects(O);if(ot===0)continue;Me=ot===2}const qe=t.terrain?z:L,et=te.aabb.distanceX(qe),lt=te.aabb.distanceY(qe),pt=Math.max(Math.abs(et),Math.abs(lt));if(te.zoom===ce||pt>X+(1<<ce-te.zoom)-2&&te.zoom>=V){const ot=ce-te.zoom,at=z[0]-.5-(xe<<ot),wt=z[1]-.5-(be<<ot);le.push({tileID:new c.S(te.zoom===ce?me:te.zoom,te.wrap,te.zoom,xe,be),distanceSq:ee([L[0]-.5-xe,L[1]-.5-be]),tileDistanceToCamera:Math.sqrt(at*at+wt*wt)})}else for(let ot=0;ot<4;ot++){const at=(xe<<1)+ot%2,wt=(be<<1)+(ot>>1),Gt=te.zoom+1;let dt=te.aabb.quadrant(ot);if(t.terrain){const nt=new c.S(Gt,te.wrap,Gt,at,wt),jt=t.terrain.getMinMaxElevation(nt),sr=(a=jt.minElevation)!==null&&a!==void 0?a:this.elevation,$t=(d=jt.maxElevation)!==null&&d!==void 0?d:this.elevation;dt=new Tn([dt.min[0],dt.min[1],sr],[dt.max[0],dt.max[1],$t])}ie.push({aabb:dt,zoom:Gt,x:at,y:wt,wrap:te.wrap,fullyVisible:Me})}}return le.sort((te,xe)=>te.distanceSq-xe.distanceSq).map(te=>te.tileID)}resize(t,a){this.width=t,this.height=a,this.pixelsToGLUnits=[2/t,-2/a],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(t){return Math.pow(2,t)}scaleZoom(t){return Math.log(t)/Math.LN2}project(t){const a=c.ac(t.lat,-85.051129,Hn);return new c.P(c.O(t.lng)*this.worldSize,c.Q(a)*this.worldSize)}unproject(t){return new c.Z(t.x/this.worldSize,t.y/this.worldSize).toLngLat()}get point(){return this.project(this.center)}getCameraPosition(){return{lngLat:this.pointLocation(this.getCameraPoint()),altitude:Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter+this.elevation}}recalculateZoom(t){const a=this.elevation,d=Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter,f=this.pointLocation(this.centerPoint,t),g=t.getElevationForLngLatZoom(f,this.tileZoom);if(!(this.elevation-g))return;const E=d+a-g,I=Math.cos(this._pitch)*this.cameraToCenterDistance/E/c.b5(1,f.lat),k=this.scaleZoom(I/this.tileSize);this._elevation=g,this._center=f,this.zoom=k}setLocationAtPoint(t,a){const d=this.pointCoordinate(a),f=this.pointCoordinate(this.centerPoint),g=this.locationCoordinate(t),E=new c.Z(g.x-(d.x-f.x),g.y-(d.y-f.y));this.center=this.coordinateLocation(E),this._renderWorldCopies&&(this.center=this.center.wrap())}locationPoint(t,a){return a?this.coordinatePoint(this.locationCoordinate(t),a.getElevationForLngLatZoom(t,this.tileZoom),this.pixelMatrix3D):this.coordinatePoint(this.locationCoordinate(t))}pointLocation(t,a){return this.coordinateLocation(this.pointCoordinate(t,a))}locationCoordinate(t){return c.Z.fromLngLat(t)}coordinateLocation(t){return t&&t.toLngLat()}pointCoordinate(t,a){if(a){const V=a.pointCoordinate(t);if(V!=null)return V}const d=[t.x,t.y,0,1],f=[t.x,t.y,1,1];c.af(d,d,this.pixelMatrixInverse),c.af(f,f,this.pixelMatrixInverse);const g=d[3],E=f[3],I=d[1]/g,k=f[1]/E,z=d[2]/g,L=f[2]/E,O=z===L?0:(0-z)/(L-z);return new c.Z(c.y.number(d[0]/g,f[0]/E,O)/this.worldSize,c.y.number(I,k,O)/this.worldSize)}coordinatePoint(t,a=0,d=this.pixelMatrix){const f=[t.x*this.worldSize,t.y*this.worldSize,a,1];return c.af(f,f,d),new c.P(f[0]/f[3],f[1]/f[3])}getBounds(){const t=Math.max(0,this.height/2-this.getHorizon());return new Ce().extend(this.pointLocation(new c.P(0,t))).extend(this.pointLocation(new c.P(this.width,t))).extend(this.pointLocation(new c.P(this.width,this.height))).extend(this.pointLocation(new c.P(0,this.height)))}getMaxBounds(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new Ce([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null}getHorizon(){return Math.tan(Math.PI/2-this._pitch)*this.cameraToCenterDistance*.85}setMaxBounds(t){t?(this.lngRange=[t.getWest(),t.getEast()],this.latRange=[t.getSouth(),t.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-85.051129,Hn])}calculateTileMatrix(t){const a=t.canonical,d=this.worldSize/this.zoomScale(a.z),f=a.x+Math.pow(2,a.z)*t.wrap,g=c.an(new Float64Array(16));return c.J(g,g,[f*d,a.y*d,0]),c.K(g,g,[d/c.X,d/c.X,1]),g}calculatePosMatrix(t,a=!1){const d=t.key,f=a?this._alignedPosMatrixCache:this._posMatrixCache;if(f[d])return f[d];const g=this.calculateTileMatrix(t);return c.L(g,a?this.alignedModelViewProjectionMatrix:this.modelViewProjectionMatrix,g),f[d]=new Float32Array(g),f[d]}calculateFogMatrix(t){const a=t.key,d=this._fogMatrixCache;if(d[a])return d[a];const f=this.calculateTileMatrix(t);return c.L(f,this.fogMatrix,f),d[a]=new Float32Array(f),d[a]}customLayerMatrix(){return this.mercatorMatrix.slice()}getConstrained(t,a){a=c.ac(+a,this.minZoom,this.maxZoom);const d={center:new c.N(t.lng,t.lat),zoom:a};let f=this.lngRange;if(!this._renderWorldCopies&&f===null){const te=179.9999999999;f=[-te,te]}const g=this.tileSize*this.zoomScale(d.zoom);let E=0,I=g,k=0,z=g,L=0,O=0;const{x:V,y:X}=this.size;if(this.latRange){const te=this.latRange;E=c.Q(te[1])*g,I=c.Q(te[0])*g,I-E<X&&(L=X/(I-E))}f&&(k=c.b3(c.O(f[0])*g,0,g),z=c.b3(c.O(f[1])*g,0,g),z<k&&(z+=g),z-k<V&&(O=V/(z-k)));const{x:Q,y:ie}=this.project.call({worldSize:g},t);let le,ce;const me=Math.max(O||0,L||0);if(me){const te=new c.P(O?(z+k)/2:Q,L?(I+E)/2:ie);return d.center=this.unproject.call({worldSize:g},te).wrap(),d.zoom+=this.scaleZoom(me),d}if(this.latRange){const te=X/2;ie-te<E&&(ce=E+te),ie+te>I&&(ce=I-te)}if(f){const te=(k+z)/2;let xe=Q;this._renderWorldCopies&&(xe=c.b3(Q,te-g/2,te+g/2));const be=V/2;xe-be<k&&(le=k+be),xe+be>z&&(le=z-be)}if(le!==void 0||ce!==void 0){const te=new c.P(le??Q,ce??ie);d.center=this.unproject.call({worldSize:g},te).wrap()}return d}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const t=this._unmodified,{center:a,zoom:d}=this.getConstrained(this.center,this.zoom);this.center=a,this.zoom=d,this._unmodified=t,this._constraining=!1}_calcMatrices(){if(!this.height)return;const t=this.centerOffset,a=this.point.x,d=this.point.y;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height,this._pixelPerMeter=c.b5(1,this.center.lat)*this.worldSize;let f=c.an(new Float64Array(16));c.K(f,f,[this.width/2,-this.height/2,1]),c.J(f,f,[1,-1,0]),this.labelPlaneMatrix=f,f=c.an(new Float64Array(16)),c.K(f,f,[1,-1,1]),c.J(f,f,[-1,-1,0]),c.K(f,f,[2/this.width,2/this.height,1]),this.glCoordMatrix=f;const g=this.cameraToCenterDistance+this._elevation*this._pixelPerMeter/Math.cos(this._pitch),E=Math.min(this.elevation,this.minElevationForCurrentTile),I=g-E*this._pixelPerMeter/Math.cos(this._pitch),k=E<0?I:g,z=Math.PI/2+this._pitch,L=this._fov*(.5+t.y/this.height),O=Math.sin(L)*k/Math.sin(c.ac(Math.PI-z-L,.01,Math.PI-.01)),V=this.getHorizon(),X=2*Math.atan(V/this.cameraToCenterDistance)*(.5+t.y/(2*V)),Q=Math.sin(X)*k/Math.sin(c.ac(Math.PI-z-X,.01,Math.PI-.01)),ie=Math.min(O,Q);this.farZ=1.01*(Math.cos(Math.PI/2-this._pitch)*ie+k),this.nearZ=this.height/50,f=new Float64Array(16),c.b6(f,this._fov,this.width/this.height,this.nearZ,this.farZ),f[8]=2*-t.x/this.width,f[9]=2*t.y/this.height,this.projectionMatrix=c.ae(f),c.K(f,f,[1,-1,1]),c.J(f,f,[0,0,-this.cameraToCenterDistance]),c.b7(f,f,this._pitch),c.ad(f,f,this.angle),c.J(f,f,[-a,-d,0]),this.mercatorMatrix=c.K([],f,[this.worldSize,this.worldSize,this.worldSize]),c.K(f,f,[1,1,this._pixelPerMeter]),this.pixelMatrix=c.L(new Float64Array(16),this.labelPlaneMatrix,f),c.J(f,f,[0,0,-this.elevation]),this.modelViewProjectionMatrix=f,this.invModelViewProjectionMatrix=c.as([],f),this.fogMatrix=new Float64Array(16),c.b6(this.fogMatrix,this._fov,this.width/this.height,g,this.farZ),this.fogMatrix[8]=2*-t.x/this.width,this.fogMatrix[9]=2*t.y/this.height,c.K(this.fogMatrix,this.fogMatrix,[1,-1,1]),c.J(this.fogMatrix,this.fogMatrix,[0,0,-this.cameraToCenterDistance]),c.b7(this.fogMatrix,this.fogMatrix,this._pitch),c.ad(this.fogMatrix,this.fogMatrix,this.angle),c.J(this.fogMatrix,this.fogMatrix,[-a,-d,0]),c.K(this.fogMatrix,this.fogMatrix,[1,1,this._pixelPerMeter]),c.J(this.fogMatrix,this.fogMatrix,[0,0,-this.elevation]),this.pixelMatrix3D=c.L(new Float64Array(16),this.labelPlaneMatrix,f);const le=this.width%2/2,ce=this.height%2/2,me=Math.cos(this.angle),te=Math.sin(this.angle),xe=a-Math.round(a)+me*le+te*ce,be=d-Math.round(d)+me*ce+te*le,Me=new Float64Array(f);if(c.J(Me,Me,[xe>.5?xe-1:xe,be>.5?be-1:be,0]),this.alignedModelViewProjectionMatrix=Me,f=c.as(new Float64Array(16),this.pixelMatrix),!f)throw new Error("failed to invert matrix");this.pixelMatrixInverse=f,this._posMatrixCache={},this._alignedPosMatrixCache={},this._fogMatrixCache={}}maxPitchScaleFactor(){if(!this.pixelMatrixInverse)return 1;const t=this.pointCoordinate(new c.P(0,0)),a=[t.x*this.worldSize,t.y*this.worldSize,0,1];return c.af(a,a,this.pixelMatrix)[3]/this.cameraToCenterDistance}getCameraPoint(){const t=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new c.P(0,t))}getCameraQueryGeometry(t){const a=this.getCameraPoint();if(t.length===1)return[t[0],a];{let d=a.x,f=a.y,g=a.x,E=a.y;for(const I of t)d=Math.min(d,I.x),f=Math.min(f,I.y),g=Math.max(g,I.x),E=Math.max(E,I.y);return[new c.P(d,f),new c.P(g,f),new c.P(g,E),new c.P(d,E),new c.P(d,f)]}}lngLatToCameraDepth(t,a){const d=this.locationCoordinate(t),f=[d.x*this.worldSize,d.y*this.worldSize,a,1];return c.af(f,f,this.modelViewProjectionMatrix),f[2]/f[3]}}function Xl(y,t){let a,d=!1,f=null,g=null;const E=()=>{f=null,d&&(y.apply(g,a),f=setTimeout(E,t),d=!1)};return(...I)=>(d=!0,g=this,a=I,f||E(),f)}class Ci{constructor(t){this._getCurrentHash=()=>{const a=window.location.hash.replace("#","");if(this._hashName){let d;return a.split("&").map(f=>f.split("=")).forEach(f=>{f[0]===this._hashName&&(d=f)}),(d&&d[1]||"").split("/")}return a.split("/")},this._onHashChange=()=>{const a=this._getCurrentHash();if(a.length>=3&&!a.some(d=>isNaN(d))){const d=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(a[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+a[2],+a[1]],zoom:+a[0],bearing:d,pitch:+(a[4]||0)}),!0}return!1},this._updateHashUnthrottled=()=>{const a=window.location.href.replace(/(#.*)?$/,this.getHashString());window.history.replaceState(window.history.state,null,a)},this._removeHash=()=>{const a=this._getCurrentHash();if(a.length===0)return;const d=a.join("/");let f=d;f.split("&").length>0&&(f=f.split("&")[0]),this._hashName&&(f=`${this._hashName}=${d}`);let g=window.location.hash.replace(f,"");g.startsWith("#&")?g=g.slice(0,1)+g.slice(2):g==="#"&&(g="");let E=window.location.href.replace(/(#.+)?$/,g);E=E.replace("&&","&"),window.history.replaceState(window.history.state,null,E)},this._updateHash=Xl(this._updateHashUnthrottled,300),this._hashName=t&&encodeURIComponent(t)}addTo(t){return this._map=t,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),this._removeHash(),delete this._map,this}getHashString(t){const a=this._map.getCenter(),d=Math.round(100*this._map.getZoom())/100,f=Math.ceil((d*Math.LN2+Math.log(512/360/.5))/Math.LN10),g=Math.pow(10,f),E=Math.round(a.lng*g)/g,I=Math.round(a.lat*g)/g,k=this._map.getBearing(),z=this._map.getPitch();let L="";if(L+=t?`/${E}/${I}/${d}`:`${d}/${I}/${E}`,(k||z)&&(L+="/"+Math.round(10*k)/10),z&&(L+=`/${Math.round(z)}`),this._hashName){const O=this._hashName;let V=!1;const X=window.location.hash.slice(1).split("&").map(Q=>{const ie=Q.split("=")[0];return ie===O?(V=!0,`${ie}=${L}`):Q}).filter(Q=>Q);return V||X.push(`${O}=${L}`),`#${X.join("&")}`}return`#${L}`}}const wa={linearity:.3,easing:c.b8(0,0,.3,1)},ph=c.e({deceleration:2500,maxSpeed:1400},wa),fl=c.e({deceleration:20,maxSpeed:1400},wa),Kl=c.e({deceleration:1e3,maxSpeed:360},wa),ba=c.e({deceleration:1e3,maxSpeed:90},wa);class jn{constructor(t){this._map=t,this.clear()}clear(){this._inertiaBuffer=[]}record(t){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:W.now(),settings:t})}_drainInertiaBuffer(){const t=this._inertiaBuffer,a=W.now();for(;t.length>0&&a-t[0].time>160;)t.shift()}_onMoveEnd(t){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const a={zoom:0,bearing:0,pitch:0,pan:new c.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:g}of this._inertiaBuffer)a.zoom+=g.zoomDelta||0,a.bearing+=g.bearingDelta||0,a.pitch+=g.pitchDelta||0,g.panDelta&&a.pan._add(g.panDelta),g.around&&(a.around=g.around),g.pinchAround&&(a.pinchAround=g.pinchAround);const d=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,f={};if(a.pan.mag()){const g=pl(a.pan.mag(),d,c.e({},ph,t||{}));f.offset=a.pan.mult(g.amount/a.pan.mag()),f.center=this._map.transform.center,Yl(f,g)}if(a.zoom){const g=pl(a.zoom,d,fl);f.zoom=this._map.transform.zoom+g.amount,Yl(f,g)}if(a.bearing){const g=pl(a.bearing,d,Kl);f.bearing=this._map.transform.bearing+c.ac(g.amount,-179,179),Yl(f,g)}if(a.pitch){const g=pl(a.pitch,d,ba);f.pitch=this._map.transform.pitch+g.amount,Yl(f,g)}if(f.zoom||f.bearing){const g=a.pinchAround===void 0?a.around:a.pinchAround;f.around=g?this._map.unproject(g):this._map.getCenter()}return this.clear(),c.e(f,{noMoveStart:!0})}}function Yl(y,t){(!y.duration||y.duration<t.duration)&&(y.duration=t.duration,y.easing=t.easing)}function pl(y,t,a){const{maxSpeed:d,linearity:f,deceleration:g}=a,E=c.ac(y*f/(t/1e3),-d,d),I=Math.abs(E)/(g*f);return{easing:a.easing,duration:1e3*I,amount:E*(I/2)}}class $r extends c.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,a,d,f={}){const g=q.mousePos(a.getCanvas(),d),E=a.unproject(g);super(t,c.e({point:g,lngLat:E,originalEvent:d},f)),this._defaultPrevented=!1,this.target=a}}class Sa extends c.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,a,d){const f=t==="touchend"?d.changedTouches:d.touches,g=q.touchPos(a.getCanvasContainer(),f),E=g.map(k=>a.unproject(k)),I=g.reduce((k,z,L,O)=>k.add(z.div(O.length)),new c.P(0,0));super(t,{points:g,point:I,lngLats:E,lngLat:a.unproject(I),originalEvent:d}),this._defaultPrevented=!1}}class zd extends c.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,a,d){super(t,{originalEvent:d}),this._defaultPrevented=!1}}class Dd{constructor(t,a){this._map=t,this._clickTolerance=a.clickTolerance}reset(){delete this._mousedownPos}wheel(t){return this._firePreventable(new zd(t.type,this._map,t))}mousedown(t,a){return this._mousedownPos=a,this._firePreventable(new $r(t.type,this._map,t))}mouseup(t){this._map.fire(new $r(t.type,this._map,t))}click(t,a){this._mousedownPos&&this._mousedownPos.dist(a)>=this._clickTolerance||this._map.fire(new $r(t.type,this._map,t))}dblclick(t){return this._firePreventable(new $r(t.type,this._map,t))}mouseover(t){this._map.fire(new $r(t.type,this._map,t))}mouseout(t){this._map.fire(new $r(t.type,this._map,t))}touchstart(t){return this._firePreventable(new Sa(t.type,this._map,t))}touchmove(t){this._map.fire(new Sa(t.type,this._map,t))}touchend(t){this._map.fire(new Sa(t.type,this._map,t))}touchcancel(t){this._map.fire(new Sa(t.type,this._map,t))}_firePreventable(t){if(this._map.fire(t),t.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class cr{constructor(t){this._map=t}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(t){this._map.fire(new $r(t.type,this._map,t))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new $r("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(t){this._delayContextMenu?this._contextMenuEvent=t:this._ignoreContextMenu||this._map.fire(new $r(t.type,this._map,t)),this._map.listens("contextmenu")&&t.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Jr{constructor(t){this._map=t}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(t){return this.transform.pointLocation(c.P.convert(t),this._map.terrain)}}class fi{constructor(t,a){this._map=t,this._tr=new Jr(t),this._el=t.getCanvasContainer(),this._container=t.getContainer(),this._clickTolerance=a.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(t,a){this.isEnabled()&&t.shiftKey&&t.button===0&&(q.disableDrag(),this._startPos=this._lastPos=a,this._active=!0)}mousemoveWindow(t,a){if(!this._active)return;const d=a;if(this._lastPos.equals(d)||!this._box&&d.dist(this._startPos)<this._clickTolerance)return;const f=this._startPos;this._lastPos=d,this._box||(this._box=q.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",t));const g=Math.min(f.x,d.x),E=Math.max(f.x,d.x),I=Math.min(f.y,d.y),k=Math.max(f.y,d.y);q.setTransform(this._box,`translate(${g}px,${I}px)`),this._box.style.width=E-g+"px",this._box.style.height=k-I+"px"}mouseupWindow(t,a){if(!this._active||t.button!==0)return;const d=this._startPos,f=a;if(this.reset(),q.suppressClick(),d.x!==f.x||d.y!==f.y)return this._map.fire(new c.k("boxzoomend",{originalEvent:t})),{cameraAnimation:g=>g.fitScreenCoordinates(d,f,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",t)}keydown(t){this._active&&t.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",t))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(q.remove(this._box),this._box=null),q.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(t,a){return this._map.fire(new c.k(t,{originalEvent:a}))}}function ml(y,t){if(y.length!==t.length)throw new Error(`The number of touches and points are not equal - touches ${y.length}, points ${t.length}`);const a={};for(let d=0;d<y.length;d++)a[y[d].identifier]=t[d];return a}class gl{constructor(t){this.reset(),this.numTouches=t.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(t,a,d){(this.centroid||d.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=t.timeStamp),d.length===this.numTouches&&(this.centroid=function(f){const g=new c.P(0,0);for(const E of f)g._add(E);return g.div(f.length)}(a),this.touches=ml(d,a)))}touchmove(t,a,d){if(this.aborted||!this.centroid)return;const f=ml(d,a);for(const g in this.touches){const E=f[g];(!E||E.dist(this.touches[g])>30)&&(this.aborted=!0)}}touchend(t,a,d){if((!this.centroid||t.timeStamp-this.startTime>500)&&(this.aborted=!0),d.length===0){const f=!this.aborted&&this.centroid;if(this.reset(),f)return f}}}class Jl{constructor(t){this.singleTap=new gl(t),this.numTaps=t.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(t,a,d){this.singleTap.touchstart(t,a,d)}touchmove(t,a,d){this.singleTap.touchmove(t,a,d)}touchend(t,a,d){const f=this.singleTap.touchend(t,a,d);if(f){const g=t.timeStamp-this.lastTime<500,E=!this.lastTap||this.lastTap.dist(f)<30;if(g&&E||this.reset(),this.count++,this.lastTime=t.timeStamp,this.lastTap=f,this.count===this.numTaps)return this.reset(),f}}}class Ta{constructor(t){this._tr=new Jr(t),this._zoomIn=new Jl({numTouches:1,numTaps:2}),this._zoomOut=new Jl({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(t,a,d){this._zoomIn.touchstart(t,a,d),this._zoomOut.touchstart(t,a,d)}touchmove(t,a,d){this._zoomIn.touchmove(t,a,d),this._zoomOut.touchmove(t,a,d)}touchend(t,a,d){const f=this._zoomIn.touchend(t,a,d),g=this._zoomOut.touchend(t,a,d),E=this._tr;return f?(this._active=!0,t.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:I=>I.easeTo({duration:300,zoom:E.zoom+1,around:E.unproject(f)},{originalEvent:t})}):g?(this._active=!0,t.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:I=>I.easeTo({duration:300,zoom:E.zoom-1,around:E.unproject(g)},{originalEvent:t})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class ds{constructor(t){this._enabled=!!t.enable,this._moveStateManager=t.moveStateManager,this._clickTolerance=t.clickTolerance||1,this._moveFunction=t.move,this._activateOnStart=!!t.activateOnStart,t.assignEvents(this),this.reset()}reset(t){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(t)}_move(...t){const a=this._moveFunction(...t);if(a.bearingDelta||a.pitchDelta||a.around||a.panDelta)return this._active=!0,a}dragStart(t,a){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(t)&&(this._moveStateManager.startMove(t),this._lastPoint=a.length?a[0]:a,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(t,a){if(!this.isEnabled())return;const d=this._lastPoint;if(!d)return;if(t.preventDefault(),!this._moveStateManager.isValidMoveEvent(t))return void this.reset(t);const f=a.length?a[0]:a;return!this._moved&&f.dist(d)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=f,this._move(d,f))}dragEnd(t){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(t)&&(this._moved&&q.suppressClick(),this.reset(t))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const Ju={0:1,2:2};class Xo{constructor(t){this._correctEvent=t.checkCorrectEvent}startMove(t){const a=q.mouseButton(t);this._eventButton=a}endMove(t){delete this._eventButton}isValidStartEvent(t){return this._correctEvent(t)}isValidMoveEvent(t){return!function(a,d){const f=Ju[d];return a.buttons===void 0||(a.buttons&f)!==f}(t,this._eventButton)}isValidEndEvent(t){return q.mouseButton(t)===this._eventButton}}class yo{constructor(){this._firstTouch=void 0}_isOneFingerTouch(t){return t.targetTouches.length===1}_isSameTouchEvent(t){return t.targetTouches[0].identifier===this._firstTouch}startMove(t){this._firstTouch=t.targetTouches[0].identifier}endMove(t){delete this._firstTouch}isValidStartEvent(t){return this._isOneFingerTouch(t)}isValidMoveEvent(t){return this._isOneFingerTouch(t)&&this._isSameTouchEvent(t)}isValidEndEvent(t){return this._isOneFingerTouch(t)&&this._isSameTouchEvent(t)}}const Ea=y=>{y.mousedown=y.dragStart,y.mousemoveWindow=y.dragMove,y.mouseup=y.dragEnd,y.contextmenu=t=>{t.preventDefault()}},mh=({enable:y,clickTolerance:t,bearingDegreesPerPixelMoved:a=.8})=>{const d=new Xo({checkCorrectEvent:f=>q.mouseButton(f)===0&&f.ctrlKey||q.mouseButton(f)===2});return new ds({clickTolerance:t,move:(f,g)=>({bearingDelta:(g.x-f.x)*a}),moveStateManager:d,enable:y,assignEvents:Ea})},gh=({enable:y,clickTolerance:t,pitchDegreesPerPixelMoved:a=-.5})=>{const d=new Xo({checkCorrectEvent:f=>q.mouseButton(f)===0&&f.ctrlKey||q.mouseButton(f)===2});return new ds({clickTolerance:t,move:(f,g)=>({pitchDelta:(g.y-f.y)*a}),moveStateManager:d,enable:y,assignEvents:Ea})};class Ca{constructor(t,a){this._clickTolerance=t.clickTolerance||1,this._map=a,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new c.P(0,0)}_shouldBePrevented(t){return t<(this._map.cooperativeGestures.isEnabled()?2:1)}touchstart(t,a,d){return this._calculateTransform(t,a,d)}touchmove(t,a,d){if(this._active){if(!this._shouldBePrevented(d.length))return t.preventDefault(),this._calculateTransform(t,a,d);this._map.cooperativeGestures.notifyGestureBlocked("touch_pan",t)}}touchend(t,a,d){this._calculateTransform(t,a,d),this._active&&this._shouldBePrevented(d.length)&&this.reset()}touchcancel(){this.reset()}_calculateTransform(t,a,d){d.length>0&&(this._active=!0);const f=ml(d,a),g=new c.P(0,0),E=new c.P(0,0);let I=0;for(const z in f){const L=f[z],O=this._touches[z];O&&(g._add(L),E._add(L.sub(O)),I++,f[z]=L)}if(this._touches=f,this._shouldBePrevented(I)||!E.mag())return;const k=E.div(I);return this._sum._add(k),this._sum.mag()<this._clickTolerance?void 0:{around:g.div(I),panDelta:k}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Ia{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(t,a,d){this._firstTwoTouches||d.length<2||(this._firstTwoTouches=[d[0].identifier,d[1].identifier],this._start([a[0],a[1]]))}touchmove(t,a,d){if(!this._firstTwoTouches)return;t.preventDefault();const[f,g]=this._firstTwoTouches,E=Ko(d,a,f),I=Ko(d,a,g);if(!E||!I)return;const k=this._aroundCenter?null:E.add(I).div(2);return this._move([E,I],k,t)}touchend(t,a,d){if(!this._firstTwoTouches)return;const[f,g]=this._firstTwoTouches,E=Ko(d,a,f),I=Ko(d,a,g);E&&I||(this._active&&q.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(t){this._enabled=!0,this._aroundCenter=!!t&&t.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}}function Ko(y,t,a){for(let d=0;d<y.length;d++)if(y[d].identifier===a)return t[d]}function Ql(y,t){return Math.log(y/t)/Math.LN2}class _h extends Ia{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(t){this._startDistance=this._distance=t[0].dist(t[1])}_move(t,a){const d=this._distance;if(this._distance=t[0].dist(t[1]),this._active||!(Math.abs(Ql(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Ql(this._distance,d),pinchAround:a}}}function Qu(y,t){return 180*y.angleWith(t)/Math.PI}class yh extends Ia{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(t){this._startVector=this._vector=t[0].sub(t[1]),this._minDiameter=t[0].dist(t[1])}_move(t,a,d){const f=this._vector;if(this._vector=t[0].sub(t[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:Qu(this._vector,f),pinchAround:a}}_isBelowThreshold(t){this._minDiameter=Math.min(this._minDiameter,t.mag());const a=25/(Math.PI*this._minDiameter)*360,d=Qu(t,this._startVector);return Math.abs(d)<a}}function ec(y){return Math.abs(y.y)>Math.abs(y.x)}class _r extends Ia{constructor(t){super(),this._currentTouchCount=0,this._map=t}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(t,a,d){super.touchstart(t,a,d),this._currentTouchCount=d.length}_start(t){this._lastPoints=t,ec(t[0].sub(t[1]))&&(this._valid=!1)}_move(t,a,d){if(this._map.cooperativeGestures.isEnabled()&&this._currentTouchCount<3)return;const f=t[0].sub(this._lastPoints[0]),g=t[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(f,g,d.timeStamp),this._valid?(this._lastPoints=t,this._active=!0,{pitchDelta:(f.y+g.y)/2*-.5}):void 0}gestureBeginsVertically(t,a,d){if(this._valid!==void 0)return this._valid;const f=t.mag()>=2,g=a.mag()>=2;if(!f&&!g)return;if(!f||!g)return this._firstMove===void 0&&(this._firstMove=d),d-this._firstMove<100&&void 0;const E=t.y>0==a.y>0;return ec(t)&&ec(a)&&E}}const ri={panStep:100,bearingStep:15,pitchStep:10};class fs{constructor(t){this._tr=new Jr(t);const a=ri;this._panStep=a.panStep,this._bearingStep=a.bearingStep,this._pitchStep=a.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(t){if(t.altKey||t.ctrlKey||t.metaKey)return;let a=0,d=0,f=0,g=0,E=0;switch(t.keyCode){case 61:case 107:case 171:case 187:a=1;break;case 189:case 109:case 173:a=-1;break;case 37:t.shiftKey?d=-1:(t.preventDefault(),g=-1);break;case 39:t.shiftKey?d=1:(t.preventDefault(),g=1);break;case 38:t.shiftKey?f=1:(t.preventDefault(),E=-1);break;case 40:t.shiftKey?f=-1:(t.preventDefault(),E=1);break;default:return}return this._rotationDisabled&&(d=0,f=0),{cameraAnimation:I=>{const k=this._tr;I.easeTo({duration:300,easeId:"keyboardHandler",easing:eo,zoom:a?Math.round(k.zoom)+a*(t.shiftKey?2:1):k.zoom,bearing:k.bearing+d*this._bearingStep,pitch:k.pitch+f*this._pitchStep,offset:[-g*this._panStep,-E*this._panStep],center:k.center},{originalEvent:t})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function eo(y){return y*(2-y)}const tc=4.000244140625;class Fs{constructor(t,a){this._onTimeout=d=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(d)},this._map=t,this._tr=new Jr(t),this._triggerRenderFrame=a,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222}setZoomRate(t){this._defaultZoomRate=t}setWheelZoomRate(t){this._wheelZoomRate=t}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(t){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!t&&t.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}_shouldBePrevented(t){return!!this._map.cooperativeGestures.isEnabled()&&!(t.ctrlKey||this._map.cooperativeGestures.isBypassed(t))}wheel(t){if(!this.isEnabled())return;if(this._shouldBePrevented(t))return void this._map.cooperativeGestures.notifyGestureBlocked("wheel_zoom",t);let a=t.deltaMode===WheelEvent.DOM_DELTA_LINE?40*t.deltaY:t.deltaY;const d=W.now(),f=d-(this._lastWheelEventTime||0);this._lastWheelEventTime=d,a!==0&&a%tc==0?this._type="wheel":a!==0&&Math.abs(a)<4?this._type="trackpad":f>400?(this._type=null,this._lastValue=a,this._timeout=setTimeout(this._onTimeout,40,t)):this._type||(this._type=Math.abs(f*a)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,a+=this._lastValue)),t.shiftKey&&a&&(a/=4),this._type&&(this._lastWheelEvent=t,this._delta-=a,this._active||this._start(t)),t.preventDefault()}_start(t){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const a=q.mousePos(this._map.getCanvas(),t),d=this._tr;this._around=a.y>d.transform.height/2-d.transform.getHorizon()?c.N.convert(this._aroundCenter?d.center:d.unproject(a)):c.N.convert(d.center),this._aroundPoint=d.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const t=this._tr.transform;if(this._delta!==0){const k=this._type==="wheel"&&Math.abs(this._delta)>tc?this._wheelZoomRate:this._defaultZoomRate;let z=2/(1+Math.exp(-Math.abs(this._delta*k)));this._delta<0&&z!==0&&(z=1/z);const L=typeof this._targetZoom=="number"?t.zoomScale(this._targetZoom):t.scale;this._targetZoom=Math.min(t.maxZoom,Math.max(t.minZoom,t.scaleZoom(L*z))),this._type==="wheel"&&(this._startZoom=t.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const a=typeof this._targetZoom=="number"?this._targetZoom:t.zoom,d=this._startZoom,f=this._easing;let g,E=!1;const I=W.now()-this._lastWheelEventTime;if(this._type==="wheel"&&d&&f&&I){const k=Math.min(I/200,1),z=f(k);g=c.y.number(d,a,z),k<1?this._frameId||(this._frameId=!0):E=!0}else g=a,E=!0;return this._active=!0,E&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!E,zoomDelta:g-t.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(t){let a=c.b9;if(this._prevEase){const d=this._prevEase,f=(W.now()-d.start)/d.duration,g=d.easing(f+.01)-d.easing(f),E=.27/Math.sqrt(g*g+1e-4)*.01,I=Math.sqrt(.0729-E*E);a=c.b8(E,I,.25,1)}return this._prevEase={start:W.now(),duration:t,easing:a},a}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class vo{constructor(t,a){this._clickZoom=t,this._tapZoom=a}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class eu{constructor(t){this._tr=new Jr(t),this.reset()}reset(){this._active=!1}dblclick(t,a){return t.preventDefault(),{cameraAnimation:d=>{d.easeTo({duration:300,zoom:this._tr.zoom+(t.shiftKey?-1:1),around:this._tr.unproject(a)},{originalEvent:t})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class vh{constructor(){this._tap=new Jl({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(t,a,d){if(!this._swipePoint)if(this._tapTime){const f=a[0],g=t.timeStamp-this._tapTime<500,E=this._tapPoint.dist(f)<30;g&&E?d.length>0&&(this._swipePoint=f,this._swipeTouch=d[0].identifier):this.reset()}else this._tap.touchstart(t,a,d)}touchmove(t,a,d){if(this._tapTime){if(this._swipePoint){if(d[0].identifier!==this._swipeTouch)return;const f=a[0],g=f.y-this._swipePoint.y;return this._swipePoint=f,t.preventDefault(),this._active=!0,{zoomDelta:g/128}}}else this._tap.touchmove(t,a,d)}touchend(t,a,d){if(this._tapTime)this._swipePoint&&d.length===0&&this.reset();else{const f=this._tap.touchend(t,a,d);f&&(this._tapTime=t.timeStamp,this._tapPoint=f)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class ka{constructor(t,a,d){this._el=t,this._mousePan=a,this._touchPan=d}enable(t){this._inertiaOptions=t||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class _l{constructor(t,a,d){this._pitchWithRotate=t.pitchWithRotate,this._mouseRotate=a,this._mousePitch=d}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class Pa{constructor(t,a,d,f){this._el=t,this._touchZoom=a,this._touchRotate=d,this._tapDragZoom=f,this._rotationDisabled=!1,this._enabled=!0}enable(t){this._touchZoom.enable(t),this._rotationDisabled||this._touchRotate.enable(t),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}class xo{constructor(t,a){this._bypassKey=navigator.userAgent.indexOf("Mac")!==-1?"metaKey":"ctrlKey",this._map=t,this._options=a,this._enabled=!1}isActive(){return!1}reset(){}_setupUI(){if(this._container)return;const t=this._map.getCanvasContainer();t.classList.add("maplibregl-cooperative-gestures"),this._container=q.create("div","maplibregl-cooperative-gesture-screen",t);let a=this._map._getUIString("CooperativeGesturesHandler.WindowsHelpText");this._bypassKey==="metaKey"&&(a=this._map._getUIString("CooperativeGesturesHandler.MacHelpText"));const d=this._map._getUIString("CooperativeGesturesHandler.MobileHelpText"),f=document.createElement("div");f.className="maplibregl-desktop-message",f.textContent=a,this._container.appendChild(f);const g=document.createElement("div");g.className="maplibregl-mobile-message",g.textContent=d,this._container.appendChild(g),this._container.setAttribute("aria-hidden","true")}_destroyUI(){this._container&&(q.remove(this._container),this._map.getCanvasContainer().classList.remove("maplibregl-cooperative-gestures")),delete this._container}enable(){this._setupUI(),this._enabled=!0}disable(){this._enabled=!1,this._destroyUI()}isEnabled(){return this._enabled}isBypassed(t){return t[this._bypassKey]}notifyGestureBlocked(t,a){this._enabled&&(this._map.fire(new c.k("cooperativegestureprevented",{gestureType:t,originalEvent:a})),this._container.classList.add("maplibregl-show"),setTimeout(()=>{this._container.classList.remove("maplibregl-show")},100))}}const ii=y=>y.zoom||y.drag||y.pitch||y.rotate;class vt extends c.k{}function nc(y){return y.panDelta&&y.panDelta.mag()||y.zoomDelta||y.bearingDelta||y.pitchDelta}class xh{constructor(t,a){this.handleWindowEvent=f=>{this.handleEvent(f,`${f.type}Window`)},this.handleEvent=(f,g)=>{if(f.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const E=f.type==="renderFrame"?void 0:f,I={needsRenderFrame:!1},k={},z={},L=f.touches,O=L?this._getMapTouches(L):void 0,V=O?q.touchPos(this._map.getCanvas(),O):q.mousePos(this._map.getCanvas(),f);for(const{handlerName:ie,handler:le,allowed:ce}of this._handlers){if(!le.isEnabled())continue;let me;this._blockedByActive(z,ce,ie)?le.reset():le[g||f.type]&&(me=le[g||f.type](f,V,O),this.mergeHandlerResult(I,k,me,ie,E),me&&me.needsRenderFrame&&this._triggerRenderFrame()),(me||le.isActive())&&(z[ie]=le)}const X={};for(const ie in this._previousActiveHandlers)z[ie]||(X[ie]=E);this._previousActiveHandlers=z,(Object.keys(X).length||nc(I))&&(this._changes.push([I,k,X]),this._triggerRenderFrame()),(Object.keys(z).length||nc(I))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:Q}=I;Q&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],Q(this._map))},this._map=t,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new jn(t),this._bearingSnap=a.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(a);const d=this._el;this._listeners=[[d,"touchstart",{passive:!0}],[d,"touchmove",{passive:!1}],[d,"touchend",void 0],[d,"touchcancel",void 0],[d,"mousedown",void 0],[d,"mousemove",void 0],[d,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[d,"mouseover",void 0],[d,"mouseout",void 0],[d,"dblclick",void 0],[d,"click",void 0],[d,"keydown",{capture:!1}],[d,"keyup",void 0],[d,"wheel",{passive:!1}],[d,"contextmenu",void 0],[window,"blur",void 0]];for(const[f,g,E]of this._listeners)q.addEventListener(f,g,f===document?this.handleWindowEvent:this.handleEvent,E)}destroy(){for(const[t,a,d]of this._listeners)q.removeEventListener(t,a,t===document?this.handleWindowEvent:this.handleEvent,d)}_addDefaultHandlers(t){const a=this._map,d=a.getCanvasContainer();this._add("mapEvent",new Dd(a,t));const f=a.boxZoom=new fi(a,t);this._add("boxZoom",f),t.interactive&&t.boxZoom&&f.enable();const g=a.cooperativeGestures=new xo(a,t.cooperativeGestures);this._add("cooperativeGestures",g),t.cooperativeGestures&&g.enable();const E=new Ta(a),I=new eu(a);a.doubleClickZoom=new vo(I,E),this._add("tapZoom",E),this._add("clickZoom",I),t.interactive&&t.doubleClickZoom&&a.doubleClickZoom.enable();const k=new vh;this._add("tapDragZoom",k);const z=a.touchPitch=new _r(a);this._add("touchPitch",z),t.interactive&&t.touchPitch&&a.touchPitch.enable(t.touchPitch);const L=mh(t),O=gh(t);a.dragRotate=new _l(t,L,O),this._add("mouseRotate",L,["mousePitch"]),this._add("mousePitch",O,["mouseRotate"]),t.interactive&&t.dragRotate&&a.dragRotate.enable();const V=(({enable:me,clickTolerance:te})=>{const xe=new Xo({checkCorrectEvent:be=>q.mouseButton(be)===0&&!be.ctrlKey});return new ds({clickTolerance:te,move:(be,Me)=>({around:Me,panDelta:Me.sub(be)}),activateOnStart:!0,moveStateManager:xe,enable:me,assignEvents:Ea})})(t),X=new Ca(t,a);a.dragPan=new ka(d,V,X),this._add("mousePan",V),this._add("touchPan",X,["touchZoom","touchRotate"]),t.interactive&&t.dragPan&&a.dragPan.enable(t.dragPan);const Q=new yh,ie=new _h;a.touchZoomRotate=new Pa(d,ie,Q,k),this._add("touchRotate",Q,["touchPan","touchZoom"]),this._add("touchZoom",ie,["touchPan","touchRotate"]),t.interactive&&t.touchZoomRotate&&a.touchZoomRotate.enable(t.touchZoomRotate);const le=a.scrollZoom=new Fs(a,()=>this._triggerRenderFrame());this._add("scrollZoom",le,["mousePan"]),t.interactive&&t.scrollZoom&&a.scrollZoom.enable(t.scrollZoom);const ce=a.keyboard=new fs(a);this._add("keyboard",ce),t.interactive&&t.keyboard&&a.keyboard.enable(),this._add("blockableMapEvent",new cr(a))}_add(t,a,d){this._handlers.push({handlerName:t,handler:a,allowed:d}),this._handlersById[t]=a}stop(t){if(!this._updatingCamera){for(const{handler:a}of this._handlers)a.reset();this._inertia.clear(),this._fireEvents({},{},t),this._changes=[]}}isActive(){for(const{handler:t}of this._handlers)if(t.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!ii(this._eventsInProgress)||this.isZooming()}_blockedByActive(t,a,d){for(const f in t)if(f!==d&&(!a||a.indexOf(f)<0))return!0;return!1}_getMapTouches(t){const a=[];for(const d of t)this._el.contains(d.target)&&a.push(d);return a}mergeHandlerResult(t,a,d,f,g){if(!d)return;c.e(t,d);const E={handlerName:f,originalEvent:d.originalEvent||g};d.zoomDelta!==void 0&&(a.zoom=E),d.panDelta!==void 0&&(a.drag=E),d.pitchDelta!==void 0&&(a.pitch=E),d.bearingDelta!==void 0&&(a.rotate=E)}_applyChanges(){const t={},a={},d={};for(const[f,g,E]of this._changes)f.panDelta&&(t.panDelta=(t.panDelta||new c.P(0,0))._add(f.panDelta)),f.zoomDelta&&(t.zoomDelta=(t.zoomDelta||0)+f.zoomDelta),f.bearingDelta&&(t.bearingDelta=(t.bearingDelta||0)+f.bearingDelta),f.pitchDelta&&(t.pitchDelta=(t.pitchDelta||0)+f.pitchDelta),f.around!==void 0&&(t.around=f.around),f.pinchAround!==void 0&&(t.pinchAround=f.pinchAround),f.noInertia&&(t.noInertia=f.noInertia),c.e(a,g),c.e(d,E);this._updateMapTransform(t,a,d),this._changes=[]}_updateMapTransform(t,a,d){const f=this._map,g=f._getTransformForUpdate(),E=f.terrain;if(!(nc(t)||E&&this._terrainMovement))return this._fireEvents(a,d,!0);let{panDelta:I,zoomDelta:k,bearingDelta:z,pitchDelta:L,around:O,pinchAround:V}=t;V!==void 0&&(O=V),f._stop(!0),O=O||f.transform.centerPoint;const X=g.pointLocation(I?O.sub(I):O);z&&(g.bearing+=z),L&&(g.pitch+=L),k&&(g.zoom+=k),E?this._terrainMovement||!a.drag&&!a.zoom?a.drag&&this._terrainMovement?g.center=g.pointLocation(g.centerPoint.sub(I)):g.setLocationAtPoint(X,O):(this._terrainMovement=!0,this._map._elevationFreeze=!0,g.setLocationAtPoint(X,O)):g.setLocationAtPoint(X,O),f._applyUpdatedTransform(g),this._map._update(),t.noInertia||this._inertia.record(t),this._fireEvents(a,d,!0)}_fireEvents(t,a,d){const f=ii(this._eventsInProgress),g=ii(t),E={};for(const O in t){const{originalEvent:V}=t[O];this._eventsInProgress[O]||(E[`${O}start`]=V),this._eventsInProgress[O]=t[O]}!f&&g&&this._fireEvent("movestart",g.originalEvent);for(const O in E)this._fireEvent(O,E[O]);g&&this._fireEvent("move",g.originalEvent);for(const O in t){const{originalEvent:V}=t[O];this._fireEvent(O,V)}const I={};let k;for(const O in this._eventsInProgress){const{handlerName:V,originalEvent:X}=this._eventsInProgress[O];this._handlersById[V].isActive()||(delete this._eventsInProgress[O],k=a[V]||X,I[`${O}end`]=k)}for(const O in I)this._fireEvent(O,I[O]);const z=ii(this._eventsInProgress),L=(f||g)&&!z;if(L&&this._terrainMovement){this._map._elevationFreeze=!1,this._terrainMovement=!1;const O=this._map._getTransformForUpdate();O.recalculateZoom(this._map.terrain),this._map._applyUpdatedTransform(O)}if(d&&L){this._updatingCamera=!0;const O=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),V=X=>X!==0&&-this._bearingSnap<X&&X<this._bearingSnap;!O||!O.essential&&W.prefersReducedMotion?(this._map.fire(new c.k("moveend",{originalEvent:k})),V(this._map.getBearing())&&this._map.resetNorth()):(V(O.bearing||this._map.getBearing())&&(O.bearing=0),O.freezeElevation=!0,this._map.easeTo(O,{originalEvent:k})),this._updatingCamera=!1}}_fireEvent(t,a){this._map.fire(new c.k(t,a?{originalEvent:a}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(t=>{delete this._frameId,this.handleEvent(new vt("renderFrame",{timeStamp:t})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}class Rd extends c.E{constructor(t,a){super(),this._renderFrameCallback=()=>{const d=Math.min((W.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(d)),d<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=t,this._bearingSnap=a.bearingSnap,this.on("moveend",()=>{delete this._requestedCameraState})}getCenter(){return new c.N(this.transform.center.lng,this.transform.center.lat)}setCenter(t,a){return this.jumpTo({center:t},a)}panBy(t,a,d){return t=c.P.convert(t).mult(-1),this.panTo(this.transform.center,c.e({offset:t},a),d)}panTo(t,a,d){return this.easeTo(c.e({center:t},a),d)}getZoom(){return this.transform.zoom}setZoom(t,a){return this.jumpTo({zoom:t},a),this}zoomTo(t,a,d){return this.easeTo(c.e({zoom:t},a),d)}zoomIn(t,a){return this.zoomTo(this.getZoom()+1,t,a),this}zoomOut(t,a){return this.zoomTo(this.getZoom()-1,t,a),this}getBearing(){return this.transform.bearing}setBearing(t,a){return this.jumpTo({bearing:t},a),this}getPadding(){return this.transform.padding}setPadding(t,a){return this.jumpTo({padding:t},a),this}rotateTo(t,a,d){return this.easeTo(c.e({bearing:t},a),d)}resetNorth(t,a){return this.rotateTo(0,c.e({duration:1e3},t),a),this}resetNorthPitch(t,a){return this.easeTo(c.e({bearing:0,pitch:0,duration:1e3},t),a),this}snapToNorth(t,a){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(t,a):this}getPitch(){return this.transform.pitch}setPitch(t,a){return this.jumpTo({pitch:t},a),this}cameraForBounds(t,a){t=Ce.convert(t).adjustAntiMeridian();const d=a&&a.bearing||0;return this._cameraForBoxAndBearing(t.getNorthWest(),t.getSouthEast(),d,a)}_cameraForBoxAndBearing(t,a,d,f){const g={top:0,bottom:0,right:0,left:0};if(typeof(f=c.e({padding:g,offset:[0,0],maxZoom:this.transform.maxZoom},f)).padding=="number"){const ot=f.padding;f.padding={top:ot,bottom:ot,right:ot,left:ot}}f.padding=c.e(g,f.padding);const E=this.transform,I=E.padding,k=new Ce(t,a),z=E.project(k.getNorthWest()),L=E.project(k.getNorthEast()),O=E.project(k.getSouthEast()),V=E.project(k.getSouthWest()),X=c.ba(-d),Q=z.rotate(X),ie=L.rotate(X),le=O.rotate(X),ce=V.rotate(X),me=new c.P(Math.max(Q.x,ie.x,ce.x,le.x),Math.max(Q.y,ie.y,ce.y,le.y)),te=new c.P(Math.min(Q.x,ie.x,ce.x,le.x),Math.min(Q.y,ie.y,ce.y,le.y)),xe=me.sub(te),be=(E.width-(I.left+I.right+f.padding.left+f.padding.right))/xe.x,Me=(E.height-(I.top+I.bottom+f.padding.top+f.padding.bottom))/xe.y;if(Me<0||be<0)return void c.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");const qe=Math.min(E.scaleZoom(E.scale*Math.min(be,Me)),f.maxZoom),et=c.P.convert(f.offset),lt=new c.P((f.padding.left-f.padding.right)/2,(f.padding.top-f.padding.bottom)/2).rotate(c.ba(d)),pt=et.add(lt).mult(E.scale/E.zoomScale(qe));return{center:E.unproject(z.add(O).div(2).sub(pt)),zoom:qe,bearing:d}}fitBounds(t,a,d){return this._fitInternal(this.cameraForBounds(t,a),a,d)}fitScreenCoordinates(t,a,d,f,g){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(c.P.convert(t)),this.transform.pointLocation(c.P.convert(a)),d,f),f,g)}_fitInternal(t,a,d){return t?(delete(a=c.e(t,a)).padding,a.linear?this.easeTo(a,d):this.flyTo(a,d)):this}jumpTo(t,a){this.stop();const d=this._getTransformForUpdate();let f=!1,g=!1,E=!1;return"zoom"in t&&d.zoom!==+t.zoom&&(f=!0,d.zoom=+t.zoom),t.center!==void 0&&(d.center=c.N.convert(t.center)),"bearing"in t&&d.bearing!==+t.bearing&&(g=!0,d.bearing=+t.bearing),"pitch"in t&&d.pitch!==+t.pitch&&(E=!0,d.pitch=+t.pitch),t.padding==null||d.isPaddingEqual(t.padding)||(d.padding=t.padding),this._applyUpdatedTransform(d),this.fire(new c.k("movestart",a)).fire(new c.k("move",a)),f&&this.fire(new c.k("zoomstart",a)).fire(new c.k("zoom",a)).fire(new c.k("zoomend",a)),g&&this.fire(new c.k("rotatestart",a)).fire(new c.k("rotate",a)).fire(new c.k("rotateend",a)),E&&this.fire(new c.k("pitchstart",a)).fire(new c.k("pitch",a)).fire(new c.k("pitchend",a)),this.fire(new c.k("moveend",a))}calculateCameraOptionsFromTo(t,a,d,f=0){const g=c.Z.fromLngLat(t,a),E=c.Z.fromLngLat(d,f),I=E.x-g.x,k=E.y-g.y,z=E.z-g.z,L=Math.hypot(I,k,z);if(L===0)throw new Error("Can't calculate camera options with same From and To");const O=Math.hypot(I,k),V=this.transform.scaleZoom(this.transform.cameraToCenterDistance/L/this.transform.tileSize),X=180*Math.atan2(I,-k)/Math.PI;let Q=180*Math.acos(O/L)/Math.PI;return Q=z<0?90-Q:90+Q,{center:E.toLngLat(),zoom:V,pitch:Q,bearing:X}}easeTo(t,a){var d;this._stop(!1,t.easeId),((t=c.e({offset:[0,0],duration:500,easing:c.b9},t)).animate===!1||!t.essential&&W.prefersReducedMotion)&&(t.duration=0);const f=this._getTransformForUpdate(),g=f.zoom,E=f.bearing,I=f.pitch,k=f.padding,z="bearing"in t?this._normalizeBearing(t.bearing,E):E,L="pitch"in t?+t.pitch:I,O="padding"in t?t.padding:f.padding,V=c.P.convert(t.offset);let X=f.centerPoint.add(V);const Q=f.pointLocation(X),{center:ie,zoom:le}=f.getConstrained(c.N.convert(t.center||Q),(d=t.zoom)!==null&&d!==void 0?d:g);this._normalizeCenter(ie,f);const ce=f.project(Q),me=f.project(ie).sub(ce),te=f.zoomScale(le-g);let xe,be;t.around&&(xe=c.N.convert(t.around),be=f.locationPoint(xe));const Me={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||le!==g,this._rotating=this._rotating||E!==z,this._pitching=this._pitching||L!==I,this._padding=!f.isPaddingEqual(O),this._easeId=t.easeId,this._prepareEase(a,t.noMoveStart,Me),this.terrain&&this._prepareElevation(ie),this._ease(qe=>{if(this._zooming&&(f.zoom=c.y.number(g,le,qe)),this._rotating&&(f.bearing=c.y.number(E,z,qe)),this._pitching&&(f.pitch=c.y.number(I,L,qe)),this._padding&&(f.interpolatePadding(k,O,qe),X=f.centerPoint.add(V)),this.terrain&&!t.freezeElevation&&this._updateElevation(qe),xe)f.setLocationAtPoint(xe,be);else{const et=f.zoomScale(f.zoom-g),lt=le>g?Math.min(2,te):Math.max(.5,te),pt=Math.pow(lt,1-qe),ot=f.unproject(ce.add(me.mult(qe*pt)).mult(et));f.setLocationAtPoint(f.renderWorldCopies?ot.wrap():ot,X)}this._applyUpdatedTransform(f),this._fireMoveEvents(a)},qe=>{this.terrain&&t.freezeElevation&&this._finalizeElevation(),this._afterEase(a,qe)},t),this}_prepareEase(t,a,d={}){this._moving=!0,a||d.moving||this.fire(new c.k("movestart",t)),this._zooming&&!d.zooming&&this.fire(new c.k("zoomstart",t)),this._rotating&&!d.rotating&&this.fire(new c.k("rotatestart",t)),this._pitching&&!d.pitching&&this.fire(new c.k("pitchstart",t))}_prepareElevation(t){this._elevationCenter=t,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(t,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(t){this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);const a=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(t<1&&a!==this._elevationTarget){const d=this._elevationTarget-this._elevationStart;this._elevationStart+=t*(d-(a-(d*t+this._elevationStart))/(1-t)),this._elevationTarget=a}this.transform.elevation=c.y.number(this._elevationStart,this._elevationTarget,t)}_finalizeElevation(){this._elevationFreeze=!1,this.transform.recalculateZoom(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate||this.terrain?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_elevateCameraIfInsideTerrain(t){const a=t.getCameraPosition(),d=this.terrain.getElevationForLngLatZoom(a.lngLat,t.zoom);if(a.altitude<d){const f=this.calculateCameraOptionsFromTo(a.lngLat,d,t.center,t.elevation);return{pitch:f.pitch,zoom:f.zoom}}return{}}_applyUpdatedTransform(t){const a=[];if(this.terrain&&a.push(f=>this._elevateCameraIfInsideTerrain(f)),this.transformCameraUpdate&&a.push(f=>this.transformCameraUpdate(f)),!a.length)return;const d=t.clone();for(const f of a){const g=d.clone(),{center:E,zoom:I,pitch:k,bearing:z,elevation:L}=f(g);E&&(g.center=E),I!==void 0&&(g.zoom=I),k!==void 0&&(g.pitch=k),z!==void 0&&(g.bearing=z),L!==void 0&&(g.elevation=L),d.apply(g)}this.transform.apply(d)}_fireMoveEvents(t){this.fire(new c.k("move",t)),this._zooming&&this.fire(new c.k("zoom",t)),this._rotating&&this.fire(new c.k("rotate",t)),this._pitching&&this.fire(new c.k("pitch",t))}_afterEase(t,a){if(this._easeId&&a&&this._easeId===a)return;delete this._easeId;const d=this._zooming,f=this._rotating,g=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,d&&this.fire(new c.k("zoomend",t)),f&&this.fire(new c.k("rotateend",t)),g&&this.fire(new c.k("pitchend",t)),this.fire(new c.k("moveend",t))}flyTo(t,a){var d;if(!t.essential&&W.prefersReducedMotion){const nt=c.M(t,["center","zoom","bearing","pitch","around"]);return this.jumpTo(nt,a)}this.stop(),t=c.e({offset:[0,0],speed:1.2,curve:1.42,easing:c.b9},t);const f=this._getTransformForUpdate(),g=f.zoom,E=f.bearing,I=f.pitch,k=f.padding,z="bearing"in t?this._normalizeBearing(t.bearing,E):E,L="pitch"in t?+t.pitch:I,O="padding"in t?t.padding:f.padding,V=c.P.convert(t.offset);let X=f.centerPoint.add(V);const Q=f.pointLocation(X),{center:ie,zoom:le}=f.getConstrained(c.N.convert(t.center||Q),(d=t.zoom)!==null&&d!==void 0?d:g);this._normalizeCenter(ie,f);const ce=f.zoomScale(le-g),me=f.project(Q),te=f.project(ie).sub(me);let xe=t.curve;const be=Math.max(f.width,f.height),Me=be/ce,qe=te.mag();if("minZoom"in t){const nt=c.ac(Math.min(t.minZoom,g,le),f.minZoom,f.maxZoom),jt=be/f.zoomScale(nt-g);xe=Math.sqrt(jt/qe*2)}const et=xe*xe;function lt(nt){const jt=(Me*Me-be*be+(nt?-1:1)*et*et*qe*qe)/(2*(nt?Me:be)*et*qe);return Math.log(Math.sqrt(jt*jt+1)-jt)}function pt(nt){return(Math.exp(nt)-Math.exp(-nt))/2}function ot(nt){return(Math.exp(nt)+Math.exp(-nt))/2}const at=lt(!1);let wt=function(nt){return ot(at)/ot(at+xe*nt)},Gt=function(nt){return be*((ot(at)*(pt(jt=at+xe*nt)/ot(jt))-pt(at))/et)/qe;var jt},dt=(lt(!0)-at)/xe;if(Math.abs(qe)<1e-6||!isFinite(dt)){if(Math.abs(be-Me)<1e-6)return this.easeTo(t,a);const nt=Me<be?-1:1;dt=Math.abs(Math.log(Me/be))/xe,Gt=()=>0,wt=jt=>Math.exp(nt*xe*jt)}return t.duration="duration"in t?+t.duration:1e3*dt/("screenSpeed"in t?+t.screenSpeed/xe:+t.speed),t.maxDuration&&t.duration>t.maxDuration&&(t.duration=0),this._zooming=!0,this._rotating=E!==z,this._pitching=L!==I,this._padding=!f.isPaddingEqual(O),this._prepareEase(a,!1),this.terrain&&this._prepareElevation(ie),this._ease(nt=>{const jt=nt*dt,sr=1/wt(jt);f.zoom=nt===1?le:g+f.scaleZoom(sr),this._rotating&&(f.bearing=c.y.number(E,z,nt)),this._pitching&&(f.pitch=c.y.number(I,L,nt)),this._padding&&(f.interpolatePadding(k,O,nt),X=f.centerPoint.add(V)),this.terrain&&!t.freezeElevation&&this._updateElevation(nt);const $t=nt===1?ie:f.unproject(me.add(te.mult(Gt(jt))).mult(sr));f.setLocationAtPoint(f.renderWorldCopies?$t.wrap():$t,X),this._applyUpdatedTransform(f),this._fireMoveEvents(a)},()=>{this.terrain&&t.freezeElevation&&this._finalizeElevation(),this._afterEase(a)},t),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(t,a){var d;if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const f=this._onEaseEnd;delete this._onEaseEnd,f.call(this,a)}return t||(d=this.handlers)===null||d===void 0||d.stop(!1),this}_ease(t,a,d){d.animate===!1||d.duration===0?(t(1),a()):(this._easeStart=W.now(),this._easeOptions=d,this._onEaseFrame=t,this._onEaseEnd=a,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(t,a){t=c.b3(t,-180,180);const d=Math.abs(t-a);return Math.abs(t-360-a)<d&&(t-=360),Math.abs(t+360-a)<d&&(t+=360),t}_normalizeCenter(t,a){if(!a.renderWorldCopies||a.lngRange)return;const d=t.lng-a.center.lng;t.lng+=d>180?-360:d<-180?360:0}queryTerrainElevation(t){return this.terrain?this.terrain.getElevationForLngLatZoom(c.N.convert(t),this.transform.tileZoom)-this.transform.elevation:null}}const yl={compact:!0,customAttribution:'<a href="https://maplibre.org/" target="_blank">MapLibre</a>'};class wo{constructor(t=yl){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=a=>{!a||a.sourceDataType!=="metadata"&&a.sourceDataType!=="visibility"&&a.dataType!=="style"&&a.type!=="terrain"||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=t}getDefaultPosition(){return"bottom-right"}onAdd(t){return this._map=t,this._compact=this.options.compact,this._container=q.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=q.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=q.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){q.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(t,a){const d=this._map._getUIString(`AttributionControl.${a}`);t.title=d,t.setAttribute("aria-label",d)}_updateAttributions(){if(!this._map.style)return;let t=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?t=t.concat(this.options.customAttribution.map(f=>typeof f!="string"?"":f)):typeof this.options.customAttribution=="string"&&t.push(this.options.customAttribution)),this._map.style.stylesheet){const f=this._map.style.stylesheet;this.styleOwner=f.owner,this.styleId=f.id}const a=this._map.style.sourceCaches;for(const f in a){const g=a[f];if(g.used||g.usedForTerrain){const E=g.getSource();E.attribution&&t.indexOf(E.attribution)<0&&t.push(E.attribution)}}t=t.filter(f=>String(f).trim()),t.sort((f,g)=>f.length-g.length),t=t.filter((f,g)=>{for(let E=g+1;E<t.length;E++)if(t[E].indexOf(f)>=0)return!1;return!0});const d=t.join(" | ");d!==this._attribHTML&&(this._attribHTML=d,t.length?(this._innerContainer.innerHTML=d,this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class Aa{constructor(t={}){this._updateCompact=()=>{const a=this._container.children;if(a.length){const d=a[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&d.classList.add("maplibregl-compact"):d.classList.remove("maplibregl-compact")}},this.options=t}getDefaultPosition(){return"bottom-left"}onAdd(t){this._map=t,this._compact=this.options&&this.options.compact,this._container=q.create("div","maplibregl-ctrl");const a=q.create("a","maplibregl-ctrl-logo");return a.target="_blank",a.rel="noopener nofollow",a.href="https://maplibre.org/",a.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),a.setAttribute("rel","noopener nofollow"),this._container.appendChild(a),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){q.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class mn{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(t){const a=++this._id;return this._queue.push({callback:t,id:a,cancelled:!1}),a}remove(t){const a=this._currentlyRunning,d=a?this._queue.concat(a):this._queue;for(const f of d)if(f.id===t)return void(f.cancelled=!0)}run(t=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const a=this._currentlyRunning=this._queue;this._queue=[];for(const d of a)if(!d.cancelled&&(d.callback(t),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}var H=c.Y([{name:"a_pos3d",type:"Int16",components:3}]);class vl extends c.E{constructor(t){super(),this.sourceCache=t,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.deltaZoom=1,t.usedForTerrain=!0,t.tileSize=this.tileSize*2**this.deltaZoom}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(t,a){this.sourceCache.update(t,a),this._renderableTilesKeys=[];const d={};for(const f of t.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:a}))d[f.key]=!0,this._renderableTilesKeys.push(f.key),this._tiles[f.key]||(f.posMatrix=new Float64Array(16),c.aP(f.posMatrix,0,c.X,0,c.X,0,1),this._tiles[f.key]=new Pr(f,this.tileSize));for(const f in this._tiles)d[f]||delete this._tiles[f]}freeRtt(t){for(const a in this._tiles){const d=this._tiles[a];(!t||d.tileID.equals(t)||d.tileID.isChildOf(t)||t.isChildOf(d.tileID))&&(d.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map(t=>this.getTileByID(t))}getTileByID(t){return this._tiles[t]}getTerrainCoords(t){const a={};for(const d of this._renderableTilesKeys){const f=this._tiles[d].tileID;if(f.canonical.equals(t.canonical)){const g=t.clone();g.posMatrix=new Float64Array(16),c.aP(g.posMatrix,0,c.X,0,c.X,0,1),a[d]=g}else if(f.canonical.isChildOf(t.canonical)){const g=t.clone();g.posMatrix=new Float64Array(16);const E=f.canonical.z-t.canonical.z,I=f.canonical.x-(f.canonical.x>>E<<E),k=f.canonical.y-(f.canonical.y>>E<<E),z=c.X>>E;c.aP(g.posMatrix,0,z,0,z,0,1),c.J(g.posMatrix,g.posMatrix,[-I*z,-k*z,0]),a[d]=g}else if(t.canonical.isChildOf(f.canonical)){const g=t.clone();g.posMatrix=new Float64Array(16);const E=t.canonical.z-f.canonical.z,I=t.canonical.x-(t.canonical.x>>E<<E),k=t.canonical.y-(t.canonical.y>>E<<E),z=c.X>>E;c.aP(g.posMatrix,0,c.X,0,c.X,0,1),c.J(g.posMatrix,g.posMatrix,[I*z,k*z,0]),c.K(g.posMatrix,g.posMatrix,[1/2**E,1/2**E,0]),a[d]=g}}return a}getSourceTile(t,a){const d=this.sourceCache._source;let f=t.overscaledZ-this.deltaZoom;if(f>d.maxzoom&&(f=d.maxzoom),f<d.minzoom)return null;this._sourceTileCache[t.key]||(this._sourceTileCache[t.key]=t.scaledTo(f).key);let g=this.sourceCache.getTileByID(this._sourceTileCache[t.key]);if((!g||!g.dem)&&a)for(;f>=d.minzoom&&(!g||!g.dem);)g=this.sourceCache.getTileByID(t.scaledTo(f--).key);return g}tilesAfterTime(t=Date.now()){return Object.values(this._tiles).filter(a=>a.timeAdded>=t)}}class xl{constructor(t,a,d){this.painter=t,this.sourceCache=new vl(a),this.options=d,this.exaggeration=typeof d.exaggeration=="number"?d.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(t,a,d,f=c.X){var g;if(!(a>=0&&a<f&&d>=0&&d<f))return 0;const E=this.getTerrainData(t),I=(g=E.tile)===null||g===void 0?void 0:g.dem;if(!I)return 0;const k=function(Q,ie,le){var ce=ie[0],me=ie[1];return Q[0]=le[0]*ce+le[4]*me+le[12],Q[1]=le[1]*ce+le[5]*me+le[13],Q}([],[a/f*c.X,d/f*c.X],E.u_terrain_matrix),z=[k[0]*I.dim,k[1]*I.dim],L=Math.floor(z[0]),O=Math.floor(z[1]),V=z[0]-L,X=z[1]-O;return I.get(L,O)*(1-V)*(1-X)+I.get(L+1,O)*V*(1-X)+I.get(L,O+1)*(1-V)*X+I.get(L+1,O+1)*V*X}getElevationForLngLatZoom(t,a){if(!c.bb(a,t.wrap()))return 0;const{tileID:d,mercatorX:f,mercatorY:g}=this._getOverscaledTileIDFromLngLatZoom(t,a);return this.getElevation(d,f%c.X,g%c.X,c.X)}getElevation(t,a,d,f=c.X){return this.getDEMElevation(t,a,d,f)*this.exaggeration}getTerrainData(t){if(!this._emptyDemTexture){const f=this.painter.context,g=new c.R({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new Ue(f,g,f.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new Ue(f,new c.R({width:1,height:1}),f.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(f.gl.NEAREST,f.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=c.an([])}const a=this.sourceCache.getSourceTile(t,!0);if(a&&a.dem&&(!a.demTexture||a.needsTerrainPrepare)){const f=this.painter.context;a.demTexture=this.painter.getTileTexture(a.dem.stride),a.demTexture?a.demTexture.update(a.dem.getPixels(),{premultiply:!1}):a.demTexture=new Ue(f,a.dem.getPixels(),f.gl.RGBA,{premultiply:!1}),a.demTexture.bind(f.gl.NEAREST,f.gl.CLAMP_TO_EDGE),a.needsTerrainPrepare=!1}const d=a&&a+a.tileID.key+t.key;if(d&&!this._demMatrixCache[d]){const f=this.sourceCache.sourceCache._source.maxzoom;let g=t.canonical.z-a.tileID.canonical.z;t.overscaledZ>t.canonical.z&&(t.canonical.z>=f?g=t.canonical.z-f:c.w("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const E=t.canonical.x-(t.canonical.x>>g<<g),I=t.canonical.y-(t.canonical.y>>g<<g),k=c.bc(new Float64Array(16),[1/(c.X<<g),1/(c.X<<g),0]);c.J(k,k,[E*c.X,I*c.X,0]),this._demMatrixCache[t.key]={matrix:k,coord:t}}return{u_depth:2,u_terrain:3,u_terrain_dim:a&&a.dem&&a.dem.dim||1,u_terrain_matrix:d?this._demMatrixCache[t.key].matrix:this._emptyDemMatrix,u_terrain_unpack:a&&a.dem&&a.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(a&&a.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:a}}getFramebuffer(t){const a=this.painter,d=a.width/devicePixelRatio,f=a.height/devicePixelRatio;return!this._fbo||this._fbo.width===d&&this._fbo.height===f||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new Ue(a.context,{width:d,height:f,data:null},a.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(a.context.gl.NEAREST,a.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new Ue(a.context,{width:d,height:f,data:null},a.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(a.context.gl.NEAREST,a.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=a.context.createFramebuffer(d,f,!0,!1),this._fbo.depthAttachment.set(a.context.createRenderbuffer(a.context.gl.DEPTH_COMPONENT16,d,f))),this._fbo.colorAttachment.set(t==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const t=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const a=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let g=0,E=0;g<this._coordsTextureSize;g++)for(let I=0;I<this._coordsTextureSize;I++,E+=4)a[E+0]=255&I,a[E+1]=255&g,a[E+2]=I>>8<<4|g>>8,a[E+3]=0;const d=new c.R({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(a.buffer)),f=new Ue(t,d,t.gl.RGBA,{premultiply:!1});return f.bind(t.gl.NEAREST,t.gl.CLAMP_TO_EDGE),this._coordsTexture=f,f}pointCoordinate(t){this.painter.maybeDrawDepthAndCoords(!0);const a=new Uint8Array(4),d=this.painter.context,f=d.gl,g=Math.round(t.x*this.painter.pixelRatio/devicePixelRatio),E=Math.round(t.y*this.painter.pixelRatio/devicePixelRatio),I=Math.round(this.painter.height/devicePixelRatio);d.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),f.readPixels(g,I-E-1,1,1,f.RGBA,f.UNSIGNED_BYTE,a),d.bindFramebuffer.set(null);const k=a[0]+(a[2]>>4<<8),z=a[1]+((15&a[2])<<8),L=this.coordsIndex[255-a[3]],O=L&&this.sourceCache.getTileByID(L);if(!O)return null;const V=this._coordsTextureSize,X=(1<<O.tileID.canonical.z)*V;return new c.Z((O.tileID.canonical.x*V+k)/X+O.tileID.wrap,(O.tileID.canonical.y*V+z)/X,this.getElevation(O.tileID,k,z,V))}depthAtPoint(t){const a=new Uint8Array(4),d=this.painter.context,f=d.gl;return d.bindFramebuffer.set(this.getFramebuffer("depth").framebuffer),f.readPixels(t.x,this.painter.height/devicePixelRatio-t.y-1,1,1,f.RGBA,f.UNSIGNED_BYTE,a),d.bindFramebuffer.set(null),(a[0]/16777216+a[1]/65536+a[2]/256+a[3])/256}getTerrainMesh(){if(this._mesh)return this._mesh;const t=this.painter.context,a=new c.bd,d=new c.aY,f=this.meshSize,g=c.X/f,E=f*f;for(let O=0;O<=f;O++)for(let V=0;V<=f;V++)a.emplaceBack(V*g,O*g,0);for(let O=0;O<E;O+=f+1)for(let V=0;V<f;V++)d.emplaceBack(V+O,f+V+O+1,f+V+O+2),d.emplaceBack(V+O,f+V+O+2,V+O+1);const I=a.length,k=I+2*(f+1);for(const O of[0,1])for(let V=0;V<=f;V++)for(const X of[0,1])a.emplaceBack(V*g,O*c.X,X);for(let O=0;O<2*f;O+=2)d.emplaceBack(k+O,k+O+1,k+O+3),d.emplaceBack(k+O,k+O+3,k+O+2),d.emplaceBack(I+O,I+O+3,I+O+1),d.emplaceBack(I+O,I+O+2,I+O+3);const z=a.length,L=z+2*(f+1);for(const O of[0,1])for(let V=0;V<=f;V++)for(const X of[0,1])a.emplaceBack(O*c.X,V*g,X);for(let O=0;O<2*f;O+=2)d.emplaceBack(z+O,z+O+1,z+O+3),d.emplaceBack(z+O,z+O+3,z+O+2),d.emplaceBack(L+O,L+O+3,L+O+1),d.emplaceBack(L+O,L+O+2,L+O+3);return this._mesh=new Oe(t.createVertexBuffer(a,H.members),t.createIndexBuffer(d),c.a0.simpleSegment(0,0,a.length,d.length)),this._mesh}getMeshFrameDelta(t){return 2*Math.PI*c.be/Math.pow(2,t)/5}getMinTileElevationForLngLatZoom(t,a){var d;const{tileID:f}=this._getOverscaledTileIDFromLngLatZoom(t,a);return(d=this.getMinMaxElevation(f).minElevation)!==null&&d!==void 0?d:0}getMinMaxElevation(t){const a=this.getTerrainData(t).tile,d={minElevation:null,maxElevation:null};return a&&a.dem&&(d.minElevation=a.dem.min*this.exaggeration,d.maxElevation=a.dem.max*this.exaggeration),d}_getOverscaledTileIDFromLngLatZoom(t,a){const d=c.Z.fromLngLat(t.wrap()),f=(1<<a)*c.X,g=d.x*f,E=d.y*f,I=Math.floor(g/c.X),k=Math.floor(E/c.X);return{tileID:new c.S(a,0,a,I,k),mercatorX:g,mercatorY:E}}}class ps{constructor(t,a,d){this._context=t,this._size=a,this._tileSize=d,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const t of this._objects)t.texture.destroy(),t.fbo.destroy()}_createObject(t){const a=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),d=new Ue(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return d.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),a.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),a.colorAttachment.set(d.texture),{id:t,fbo:a,texture:d,stamp:-1,inUse:!1}}getObjectForId(t){return this._objects[t]}useObject(t){t.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter(a=>t.id!==a),this._recentlyUsed.push(t.id)}stampObject(t){t.stamp=++this._stamp}getOrCreateFreeObject(){for(const a of this._recentlyUsed)if(!this._objects[a].inUse)return this._objects[a];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const t=this._createObject(this._objects.length);return this._objects.push(t),t}freeObject(t){t.inUse=!1}freeAllObjects(){for(const t of this._objects)this.freeObject(t)}isFull(){return!(this._objects.length<this._size)&&this._objects.some(t=>!t.inUse)===!1}}const ln={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0};class Ld{constructor(t,a){this.painter=t,this.terrain=a,this.pool=new ps(t.context,30,a.sourceCache.tileSize*a.qualityFactor)}destruct(){this.pool.destruct()}getTexture(t){return this.pool.getObjectForId(t.rtt[this._stacks.length-1].id).texture}prepareForRender(t,a){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=t._order.filter(d=>!t._layers[d].isHidden(a)),this._coordsDescendingInv={};for(const d in t.sourceCaches){this._coordsDescendingInv[d]={};const f=t.sourceCaches[d].getVisibleCoordinates();for(const g of f){const E=this.terrain.sourceCache.getTerrainCoords(g);for(const I in E)this._coordsDescendingInv[d][I]||(this._coordsDescendingInv[d][I]=[]),this._coordsDescendingInv[d][I].push(E[I])}}this._coordsDescendingInvStr={};for(const d of t._order){const f=t._layers[d],g=f.source;if(ln[f.type]&&!this._coordsDescendingInvStr[g]){this._coordsDescendingInvStr[g]={};for(const E in this._coordsDescendingInv[g])this._coordsDescendingInvStr[g][E]=this._coordsDescendingInv[g][E].map(I=>I.key).sort().join()}}for(const d of this._renderableTiles)for(const f in this._coordsDescendingInvStr){const g=this._coordsDescendingInvStr[f][d.tileID.key];g&&g!==d.rttCoords[f]&&(d.rtt=[])}}renderLayer(t){if(t.isHidden(this.painter.transform.zoom))return!1;const a=t.type,d=this.painter,f=this._renderableLayerIds[this._renderableLayerIds.length-1]===t.id;if(ln[a]&&(this._prevType&&ln[this._prevType]||this._stacks.push([]),this._prevType=a,this._stacks[this._stacks.length-1].push(t.id),!f))return!0;if(ln[this._prevType]||ln[a]&&f){this._prevType=a;const g=this._stacks.length-1,E=this._stacks[g]||[];for(const I of this._renderableTiles){if(this.pool.isFull()&&(Ve(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(I),I.rtt[g]){const z=this.pool.getObjectForId(I.rtt[g].id);if(z.stamp===I.rtt[g].stamp){this.pool.useObject(z);continue}}const k=this.pool.getOrCreateFreeObject();this.pool.useObject(k),this.pool.stampObject(k),I.rtt[g]={id:k.id,stamp:k.stamp},d.context.bindFramebuffer.set(k.fbo.framebuffer),d.context.clear({color:c.aM.transparent,stencil:0}),d.currentStencilSource=void 0;for(let z=0;z<E.length;z++){const L=d.style._layers[E[z]],O=L.source?this._coordsDescendingInv[L.source][I.tileID.key]:[I.tileID];d.context.viewport.set([0,0,k.fbo.width,k.fbo.height]),d._renderTileClippingMasks(L,O),d.renderLayer(d,d.style.sourceCaches[L.source],L,O),L.source&&(I.rttCoords[L.source]=this._coordsDescendingInvStr[L.source][I.tileID.key])}}return Ve(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects(),ln[a]}return!1}}const wh={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"MapLibre logo","Map.Title":"Map","Marker.Title":"Map marker","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","Popup.Close":"Close popup","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","TerrainControl.Enable":"Enable terrain","TerrainControl.Disable":"Disable terrain","CooperativeGesturesHandler.WindowsHelpText":"Use Ctrl + scroll to zoom the map","CooperativeGesturesHandler.MacHelpText":"Use  + scroll to zoom the map","CooperativeGesturesHandler.MobileHelpText":"Use two fingers to move the map"},Od=D,Ma={hash:!1,interactive:!0,bearingSnap:7,attributionControl:yl,maplibreLogo:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,refreshExpiredTiles:!0,scrollZoom:!0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,trackResize:!0,center:[0,0],zoom:0,bearing:0,pitch:0,renderWorldCopies:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:c.a.MAX_TILE_CACHE_ZOOM_LEVELS,transformRequest:null,transformCameraUpdate:null,fadeDuration:300,crossSourceCollisions:!0,clickTolerance:3,localIdeographFontFamily:"sans-serif",pitchWithRotate:!0,validateStyle:!0,maxCanvasSize:[4096,4096],cancelPendingTileRequestsWhileZooming:!0},bh=y=>{y.touchstart=y.dragStart,y.touchmoveWindow=y.dragMove,y.touchend=y.dragEnd},cp={showCompass:!0,showZoom:!0,visualizePitch:!1};class hp{constructor(t,a,d=!1){this.mousedown=E=>{this.startMouse(c.e({},E,{ctrlKey:!0,preventDefault:()=>E.preventDefault()}),q.mousePos(this.element,E)),q.addEventListener(window,"mousemove",this.mousemove),q.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=E=>{this.moveMouse(E,q.mousePos(this.element,E))},this.mouseup=E=>{this.mouseRotate.dragEnd(E),this.mousePitch&&this.mousePitch.dragEnd(E),this.offTemp()},this.touchstart=E=>{E.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=q.touchPos(this.element,E.targetTouches)[0],this.startTouch(E,this._startPos),q.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),q.addEventListener(window,"touchend",this.touchend))},this.touchmove=E=>{E.targetTouches.length!==1?this.reset():(this._lastPos=q.touchPos(this.element,E.targetTouches)[0],this.moveTouch(E,this._lastPos))},this.touchend=E=>{E.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),this.touchRotate.reset(),this.touchPitch&&this.touchPitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10;const f=t.dragRotate._mouseRotate.getClickTolerance(),g=t.dragRotate._mousePitch.getClickTolerance();this.element=a,this.mouseRotate=mh({clickTolerance:f,enable:!0}),this.touchRotate=(({enable:E,clickTolerance:I,bearingDegreesPerPixelMoved:k=.8})=>{const z=new yo;return new ds({clickTolerance:I,move:(L,O)=>({bearingDelta:(O.x-L.x)*k}),moveStateManager:z,enable:E,assignEvents:bh})})({clickTolerance:f,enable:!0}),this.map=t,d&&(this.mousePitch=gh({clickTolerance:g,enable:!0}),this.touchPitch=(({enable:E,clickTolerance:I,pitchDegreesPerPixelMoved:k=-.5})=>{const z=new yo;return new ds({clickTolerance:I,move:(L,O)=>({pitchDelta:(O.y-L.y)*k}),moveStateManager:z,enable:E,assignEvents:bh})})({clickTolerance:g,enable:!0})),q.addEventListener(a,"mousedown",this.mousedown),q.addEventListener(a,"touchstart",this.touchstart,{passive:!1}),q.addEventListener(a,"touchcancel",this.reset)}startMouse(t,a){this.mouseRotate.dragStart(t,a),this.mousePitch&&this.mousePitch.dragStart(t,a),q.disableDrag()}startTouch(t,a){this.touchRotate.dragStart(t,a),this.touchPitch&&this.touchPitch.dragStart(t,a),q.disableDrag()}moveMouse(t,a){const d=this.map,{bearingDelta:f}=this.mouseRotate.dragMove(t,a)||{};if(f&&d.setBearing(d.getBearing()+f),this.mousePitch){const{pitchDelta:g}=this.mousePitch.dragMove(t,a)||{};g&&d.setPitch(d.getPitch()+g)}}moveTouch(t,a){const d=this.map,{bearingDelta:f}=this.touchRotate.dragMove(t,a)||{};if(f&&d.setBearing(d.getBearing()+f),this.touchPitch){const{pitchDelta:g}=this.touchPitch.dragMove(t,a)||{};g&&d.setPitch(d.getPitch()+g)}}off(){const t=this.element;q.removeEventListener(t,"mousedown",this.mousedown),q.removeEventListener(t,"touchstart",this.touchstart,{passive:!1}),q.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),q.removeEventListener(window,"touchend",this.touchend),q.removeEventListener(t,"touchcancel",this.reset),this.offTemp()}offTemp(){q.enableDrag(),q.removeEventListener(window,"mousemove",this.mousemove),q.removeEventListener(window,"mouseup",this.mouseup),q.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),q.removeEventListener(window,"touchend",this.touchend)}}let Ji;function ar(y,t,a){const d=new c.N(y.lng,y.lat);if(y=new c.N(y.lng,y.lat),t){const f=new c.N(y.lng-360,y.lat),g=new c.N(y.lng+360,y.lat),E=a.locationPoint(y).distSqr(t);a.locationPoint(f).distSqr(t)<E?y=f:a.locationPoint(g).distSqr(t)<E&&(y=g)}for(;Math.abs(y.lng-a.center.lng)>180;){const f=a.locationPoint(y);if(f.x>=0&&f.y>=0&&f.x<=a.width&&f.y<=a.height)break;y.lng>a.center.lng?y.lng-=360:y.lng+=360}return y.lng!==d.lng&&a.locationPoint(y).y>a.height/2-a.getHorizon()?y:d}const Bi={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function rc(y,t,a){const d=y.classList;for(const f in Bi)d.remove(`maplibregl-${a}-anchor-${f}`);d.add(`maplibregl-${a}-anchor-${t}`)}class ic extends c.E{constructor(t){if(super(),this._onKeyPress=a=>{const d=a.code,f=a.charCode||a.keyCode;d!=="Space"&&d!=="Enter"&&f!==32&&f!==13||this.togglePopup()},this._onMapClick=a=>{const d=a.originalEvent.target,f=this._element;this._popup&&(d===f||f.contains(d))&&this.togglePopup()},this._update=a=>{var d;if(!this._map)return;const f=this._map.loaded()&&!this._map.isMoving();((a==null?void 0:a.type)==="terrain"||(a==null?void 0:a.type)==="render"&&!f)&&this._map.once("render",this._update),this._lngLat=this._map.transform.renderWorldCopies?ar(this._lngLat,this._flatPos,this._map.transform):(d=this._lngLat)===null||d===void 0?void 0:d.wrap(),this._flatPos=this._pos=this._map.project(this._lngLat)._add(this._offset),this._map.terrain&&(this._flatPos=this._map.transform.locationPoint(this._lngLat)._add(this._offset));let g="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?g=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(g=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let E="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?E="rotateX(0deg)":this._pitchAlignment==="map"&&(E=`rotateX(${this._map.getPitch()}deg)`),this._subpixelPositioning||a&&a.type!=="moveend"||(this._pos=this._pos.round()),q.setTransform(this._element,`${Bi[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${E} ${g}`),W.frameAsync(new AbortController).then(()=>{this._updateOpacity(a&&a.type==="moveend")}).catch(()=>{})},this._onMove=a=>{if(!this._isDragging){const d=this._clickTolerance||this._map._clickTolerance;this._isDragging=a.point.dist(this._pointerdownPos)>=d}this._isDragging&&(this._pos=a.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new c.k("dragstart"))),this.fire(new c.k("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new c.k("dragend")),this._state="inactive"},this._addDragHandler=a=>{this._element.contains(a.originalEvent.target)&&(a.preventDefault(),this._positionDelta=a.point.sub(this._pos).add(this._offset),this._pointerdownPos=a.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=t&&t.anchor||"center",this._color=t&&t.color||"#3FB1CE",this._scale=t&&t.scale||1,this._draggable=t&&t.draggable||!1,this._clickTolerance=t&&t.clickTolerance||0,this._subpixelPositioning=t&&t.subpixelPositioning||!1,this._isDragging=!1,this._state="inactive",this._rotation=t&&t.rotation||0,this._rotationAlignment=t&&t.rotationAlignment||"auto",this._pitchAlignment=t&&t.pitchAlignment&&t.pitchAlignment!=="auto"?t.pitchAlignment:this._rotationAlignment,this.setOpacity(),this.setOpacity(t==null?void 0:t.opacity,t==null?void 0:t.opacityWhenCovered),t&&t.element)this._element=t.element,this._offset=c.P.convert(t&&t.offset||[0,0]);else{this._defaultMarker=!0,this._element=q.create("div");const a=q.createNS("http://www.w3.org/2000/svg","svg"),d=41,f=27;a.setAttributeNS(null,"display","block"),a.setAttributeNS(null,"height",`${d}px`),a.setAttributeNS(null,"width",`${f}px`),a.setAttributeNS(null,"viewBox",`0 0 ${f} ${d}`);const g=q.createNS("http://www.w3.org/2000/svg","g");g.setAttributeNS(null,"stroke","none"),g.setAttributeNS(null,"stroke-width","1"),g.setAttributeNS(null,"fill","none"),g.setAttributeNS(null,"fill-rule","evenodd");const E=q.createNS("http://www.w3.org/2000/svg","g");E.setAttributeNS(null,"fill-rule","nonzero");const I=q.createNS("http://www.w3.org/2000/svg","g");I.setAttributeNS(null,"transform","translate(3.0, 29.0)"),I.setAttributeNS(null,"fill","#000000");const k=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const ce of k){const me=q.createNS("http://www.w3.org/2000/svg","ellipse");me.setAttributeNS(null,"opacity","0.04"),me.setAttributeNS(null,"cx","10.5"),me.setAttributeNS(null,"cy","5.80029008"),me.setAttributeNS(null,"rx",ce.rx),me.setAttributeNS(null,"ry",ce.ry),I.appendChild(me)}const z=q.createNS("http://www.w3.org/2000/svg","g");z.setAttributeNS(null,"fill",this._color);const L=q.createNS("http://www.w3.org/2000/svg","path");L.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),z.appendChild(L);const O=q.createNS("http://www.w3.org/2000/svg","g");O.setAttributeNS(null,"opacity","0.25"),O.setAttributeNS(null,"fill","#000000");const V=q.createNS("http://www.w3.org/2000/svg","path");V.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),O.appendChild(V);const X=q.createNS("http://www.w3.org/2000/svg","g");X.setAttributeNS(null,"transform","translate(6.0, 7.0)"),X.setAttributeNS(null,"fill","#FFFFFF");const Q=q.createNS("http://www.w3.org/2000/svg","g");Q.setAttributeNS(null,"transform","translate(8.0, 8.0)");const ie=q.createNS("http://www.w3.org/2000/svg","circle");ie.setAttributeNS(null,"fill","#000000"),ie.setAttributeNS(null,"opacity","0.25"),ie.setAttributeNS(null,"cx","5.5"),ie.setAttributeNS(null,"cy","5.5"),ie.setAttributeNS(null,"r","5.4999962");const le=q.createNS("http://www.w3.org/2000/svg","circle");le.setAttributeNS(null,"fill","#FFFFFF"),le.setAttributeNS(null,"cx","5.5"),le.setAttributeNS(null,"cy","5.5"),le.setAttributeNS(null,"r","5.4999962"),Q.appendChild(ie),Q.appendChild(le),E.appendChild(I),E.appendChild(z),E.appendChild(O),E.appendChild(X),E.appendChild(Q),a.appendChild(E),a.setAttributeNS(null,"height",d*this._scale+"px"),a.setAttributeNS(null,"width",f*this._scale+"px"),this._element.appendChild(a),this._offset=c.P.convert(t&&t.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",a=>{a.preventDefault()}),this._element.addEventListener("mousedown",a=>{a.preventDefault()}),rc(this._element,this._anchor,"marker"),t&&t.className)for(const a of t.className.split(" "))this._element.classList.add(a);this._popup=null}addTo(t){return this.remove(),this._map=t,this._element.setAttribute("aria-label",t._getUIString("Marker.Title")),t.getCanvasContainer().appendChild(this._element),t.on("move",this._update),t.on("moveend",this._update),t.on("terrain",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("terrain",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),q.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(t){return this._lngLat=c.N.convert(t),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(t){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),t){if(!("offset"in t.options)){const f=Math.abs(13.5)/Math.SQRT2;t.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[f,-1*(38.1-13.5+f)],"bottom-right":[-f,-1*(38.1-13.5+f)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=t,this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}setSubpixelPositioning(t){return this._subpixelPositioning=t,this}getPopup(){return this._popup}togglePopup(){const t=this._popup;return this._element.style.opacity===this._opacityWhenCovered?this:t?(t.isOpen()?t.remove():(t.setLngLat(this._lngLat),t.addTo(this._map)),this):this}_updateOpacity(t=!1){var a,d;if(!(!((a=this._map)===null||a===void 0)&&a.terrain))return void(this._element.style.opacity!==this._opacity&&(this._element.style.opacity=this._opacity));if(t)this._opacityTimeout=null;else{if(this._opacityTimeout)return;this._opacityTimeout=setTimeout(()=>{this._opacityTimeout=null},100)}const f=this._map,g=f.terrain.depthAtPoint(this._pos),E=f.terrain.getElevationForLngLatZoom(this._lngLat,f.transform.tileZoom);if(f.transform.lngLatToCameraDepth(this._lngLat,E)-g<.006)return void(this._element.style.opacity=this._opacity);const I=-this._offset.y/f.transform._pixelPerMeter,k=Math.sin(f.getPitch()*Math.PI/180)*I,z=f.terrain.depthAtPoint(new c.P(this._pos.x,this._pos.y-this._offset.y)),L=f.transform.lngLatToCameraDepth(this._lngLat,E+k)-z>.006;!((d=this._popup)===null||d===void 0)&&d.isOpen()&&L&&this._popup.remove(),this._element.style.opacity=L?this._opacityWhenCovered:this._opacity}getOffset(){return this._offset}setOffset(t){return this._offset=c.P.convert(t),this._update(),this}addClassName(t){this._element.classList.add(t)}removeClassName(t){this._element.classList.remove(t)}toggleClassName(t){return this._element.classList.toggle(t)}setDraggable(t){return this._draggable=!!t,this._map&&(t?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(t){return this._rotation=t||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(t){return this._rotationAlignment=t||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(t){return this._pitchAlignment=t&&t!=="auto"?t:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}setOpacity(t,a){return t===void 0&&a===void 0&&(this._opacity="1",this._opacityWhenCovered="0.2"),t!==void 0&&(this._opacity=t),a!==void 0&&(this._opacityWhenCovered=a),this._map&&this._updateOpacity(!0),this}}const Fd={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let tu=0,nu=!1;const Qr={maxWidth:100,unit:"metric"};function ru(y,t,a){const d=a&&a.maxWidth||100,f=y._container.clientHeight/2,g=y.unproject([0,f]),E=y.unproject([d,f]),I=g.distanceTo(E);if(a&&a.unit==="imperial"){const k=3.2808*I;k>5280?Ct(t,d,k/5280,y._getUIString("ScaleControl.Miles")):Ct(t,d,k,y._getUIString("ScaleControl.Feet"))}else a&&a.unit==="nautical"?Ct(t,d,I/1852,y._getUIString("ScaleControl.NauticalMiles")):I>=1e3?Ct(t,d,I/1e3,y._getUIString("ScaleControl.Kilometers")):Ct(t,d,I,y._getUIString("ScaleControl.Meters"))}function Ct(y,t,a,d){const f=function(g){const E=Math.pow(10,`${Math.floor(g)}`.length-1);let I=g/E;return I=I>=10?10:I>=5?5:I>=3?3:I>=2?2:I>=1?1:function(k){const z=Math.pow(10,Math.ceil(-Math.log(k)/Math.LN10));return Math.round(k*z)/z}(I),E*I}(a);y.style.width=t*(f/a)+"px",y.innerHTML=`${f}&nbsp;${d}`}const Bt={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",subpixelPositioning:!1},sc=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function oc(y){if(y){if(typeof y=="number"){const t=Math.round(Math.abs(y)/Math.SQRT2);return{center:new c.P(0,0),top:new c.P(0,y),"top-left":new c.P(t,t),"top-right":new c.P(-t,t),bottom:new c.P(0,-y),"bottom-left":new c.P(t,-t),"bottom-right":new c.P(-t,-t),left:new c.P(y,0),right:new c.P(-y,0)}}if(y instanceof c.P||Array.isArray(y)){const t=c.P.convert(y);return{center:t,top:t,"top-left":t,"top-right":t,bottom:t,"bottom-left":t,"bottom-right":t,left:t,right:t}}return{center:c.P.convert(y.center||[0,0]),top:c.P.convert(y.top||[0,0]),"top-left":c.P.convert(y["top-left"]||[0,0]),"top-right":c.P.convert(y["top-right"]||[0,0]),bottom:c.P.convert(y.bottom||[0,0]),"bottom-left":c.P.convert(y["bottom-left"]||[0,0]),"bottom-right":c.P.convert(y["bottom-right"]||[0,0]),left:c.P.convert(y.left||[0,0]),right:c.P.convert(y.right||[0,0])}}return oc(new c.P(0,0))}const bo=D;w.AJAXError=c.bh,w.Evented=c.E,w.LngLat=c.N,w.MercatorCoordinate=c.Z,w.Point=c.P,w.addProtocol=c.bi,w.config=c.a,w.removeProtocol=c.bj,w.AttributionControl=wo,w.BoxZoomHandler=fi,w.CanvasSource=rr,w.CooperativeGesturesHandler=xo,w.DoubleClickZoomHandler=vo,w.DragPanHandler=ka,w.DragRotateHandler=_l,w.EdgeInsets=gr,w.FullscreenControl=class extends c.E{constructor(y={}){super(),this._onFullscreenChange=()=>{var t;let a=window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement;for(;!((t=a==null?void 0:a.shadowRoot)===null||t===void 0)&&t.fullscreenElement;)a=a.shadowRoot.fullscreenElement;a===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,y&&y.container&&(y.container instanceof HTMLElement?this._container=y.container:c.w("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(y){return this._map=y,this._container||(this._container=this._map.getContainer()),this._controlContainer=q.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){q.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const y=this._fullscreenButton=q.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);q.create("span","maplibregl-ctrl-icon",y).setAttribute("aria-hidden","true"),y.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const y=this._getTitle();this._fullscreenButton.setAttribute("aria-label",y),this._fullscreenButton.title=y}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new c.k("fullscreenstart")),this._prevCooperativeGesturesEnabled=this._map.cooperativeGestures.isEnabled(),this._map.cooperativeGestures.disable()):(this.fire(new c.k("fullscreenend")),this._prevCooperativeGesturesEnabled&&this._map.cooperativeGestures.enable())}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},w.GeoJSONSource=Tr,w.GeolocateControl=class extends c.E{constructor(y){super(),this._onSuccess=t=>{if(this._map){if(this._isOutOfMapMaxBounds(t))return this._setErrorState(),this.fire(new c.k("outofmaxbounds",t)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=t,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(t),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(t),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new c.k("geolocate",t)),this._finish()}},this._updateCamera=t=>{const a=new c.N(t.coords.longitude,t.coords.latitude),d=t.coords.accuracy,f=this._map.getBearing(),g=c.e({bearing:f},this.options.fitBoundsOptions),E=Ce.fromLngLat(a,d);this._map.fitBounds(E,g,{geolocateSource:!0})},this._updateMarker=t=>{if(t){const a=new c.N(t.coords.longitude,t.coords.latitude);this._accuracyCircleMarker.setLngLat(a).addTo(this._map),this._userLocationDotMarker.setLngLat(a).addTo(this._map),this._accuracy=t.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onZoom=()=>{this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},this._onError=t=>{if(this._map){if(this.options.trackUserLocation)if(t.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const a=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=a,this._geolocateButton.setAttribute("aria-label",a),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(t.code===3&&nu)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new c.k("error",t)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=()=>{this._map&&(this._container.addEventListener("contextmenu",t=>t.preventDefault()),this._geolocateButton=q.create("button","maplibregl-ctrl-geolocate",this._container),q.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",this._geolocateButton.disabled=!0)},this._finishSetupUI=t=>{if(this._map){if(t===!1){c.w("Geolocation support is not available so the GeolocateControl will be disabled.");const a=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=a,this._geolocateButton.setAttribute("aria-label",a)}else{const a=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.disabled=!1,this._geolocateButton.title=a,this._geolocateButton.setAttribute("aria-label",a)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=q.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new ic({element:this._dotElement}),this._circleElement=q.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new ic({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",()=>this.trigger()),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",a=>{a.geolocateSource||this._watchState!=="ACTIVE_LOCK"||a.originalEvent&&a.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new c.k("trackuserlocationend")),this.fire(new c.k("userlocationlostfocus")))})}},this.options=c.e({},Fd,y)}onAdd(y){return this._map=y,this._container=q.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),function(){return c._(this,arguments,void 0,function*(t=!1){if(Ji!==void 0&&!t)return Ji;if(window.navigator.permissions===void 0)return Ji=!!window.navigator.geolocation,Ji;try{Ji=(yield window.navigator.permissions.query({name:"geolocation"})).state!=="denied"}catch{Ji=!!window.navigator.geolocation}return Ji})}().then(t=>this._finishSetupUI(t)),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),q.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,tu=0,nu=!1}_isOutOfMapMaxBounds(y){const t=this._map.getMaxBounds(),a=y.coords;return t&&(a.longitude<t.getWest()||a.longitude>t.getEast()||a.latitude<t.getSouth()||a.latitude>t.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadius(){const y=this._map.getBounds(),t=y.getSouthEast(),a=y.getNorthEast(),d=t.distanceTo(a),f=Math.ceil(this._accuracy/(d/this._map._container.clientHeight)*2);this._circleElement.style.width=`${f}px`,this._circleElement.style.height=`${f}px`}trigger(){if(!this._setup)return c.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new c.k("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":tu--,nu=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new c.k("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new c.k("trackuserlocationstart")),this.fire(new c.k("userlocationfocus"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let y;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),tu++,tu>1?(y={maximumAge:6e5,timeout:0},nu=!0):(y=this.options.positionOptions,nu=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,y)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},w.Hash=Ci,w.ImageSource=Hr,w.KeyboardHandler=fs,w.LngLatBounds=Ce,w.LogoControl=Aa,w.Map=class extends Rd{constructor(y){c.bf.mark(c.bg.create);const t=Object.assign(Object.assign({},Ma),y);if(t.minZoom!=null&&t.maxZoom!=null&&t.minZoom>t.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(t.minPitch!=null&&t.maxPitch!=null&&t.minPitch>t.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(t.minPitch!=null&&t.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(t.maxPitch!=null&&t.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(super(new Ho(t.minZoom,t.maxZoom,t.minPitch,t.maxPitch,t.renderWorldCopies),{bearingSnap:t.bearingSnap}),this._idleTriggered=!1,this._crossFadingFactor=1,this._renderTaskQueue=new mn,this._controls=[],this._mapId=c.a4(),this._contextLost=a=>{a.preventDefault(),this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this.fire(new c.k("webglcontextlost",{originalEvent:a}))},this._contextRestored=a=>{this._setupPainter(),this.resize(),this._update(),this.fire(new c.k("webglcontextrestored",{originalEvent:a}))},this._onMapScroll=a=>{if(a.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=t.interactive,this._maxTileCacheSize=t.maxTileCacheSize,this._maxTileCacheZoomLevels=t.maxTileCacheZoomLevels,this._failIfMajorPerformanceCaveat=t.failIfMajorPerformanceCaveat===!0,this._preserveDrawingBuffer=t.preserveDrawingBuffer===!0,this._antialias=t.antialias===!0,this._trackResize=t.trackResize===!0,this._bearingSnap=t.bearingSnap,this._refreshExpiredTiles=t.refreshExpiredTiles===!0,this._fadeDuration=t.fadeDuration,this._crossSourceCollisions=t.crossSourceCollisions===!0,this._collectResourceTiming=t.collectResourceTiming===!0,this._locale=Object.assign(Object.assign({},wh),t.locale),this._clickTolerance=t.clickTolerance,this._overridePixelRatio=t.pixelRatio,this._maxCanvasSize=t.maxCanvasSize,this.transformCameraUpdate=t.transformCameraUpdate,this.cancelPendingTileRequestsWhileZooming=t.cancelPendingTileRequestsWhileZooming===!0,this._imageQueueHandle=he.addThrottleControl(()=>this.isMoving()),this._requestManager=new De(t.transformRequest),typeof t.container=="string"){if(this._container=document.getElementById(t.container),!this._container)throw new Error(`Container '${t.container}' not found.`)}else{if(!(t.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=t.container}if(t.maxBounds&&this.setMaxBounds(t.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",()=>this._update(!1)).on("moveend",()=>this._update(!1)).on("zoom",()=>this._update(!0)).on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}).once("idle",()=>{this._idleTriggered=!0}),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let a=!1;const d=Xl(f=>{this._trackResize&&!this._removed&&(this.resize(f),this.redraw())},50);this._resizeObserver=new ResizeObserver(f=>{a?d(f):a=!0}),this._resizeObserver.observe(this._container)}this.handlers=new xh(this,t),this._hash=t.hash&&new Ci(typeof t.hash=="string"&&t.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:t.center,zoom:t.zoom,bearing:t.bearing,pitch:t.pitch}),t.bounds&&(this.resize(),this.fitBounds(t.bounds,c.e({},t.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=t.localIdeographFontFamily,this._validateStyle=t.validateStyle,t.style&&this.setStyle(t.style,{localIdeographFontFamily:t.localIdeographFontFamily}),t.attributionControl&&this.addControl(new wo(typeof t.attributionControl=="boolean"?void 0:t.attributionControl)),t.maplibreLogo&&this.addControl(new Aa,t.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",a=>{this._update(a.dataType==="style"),this.fire(new c.k(`${a.dataType}data`,a))}),this.on("dataloading",a=>{this.fire(new c.k(`${a.dataType}dataloading`,a))}),this.on("dataabort",a=>{this.fire(new c.k("sourcedataabort",a))})}_getMapId(){return this._mapId}addControl(y,t){if(t===void 0&&(t=y.getDefaultPosition?y.getDefaultPosition():"top-right"),!y||!y.onAdd)return this.fire(new c.j(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const a=y.onAdd(this);this._controls.push(y);const d=this._controlPositions[t];return t.indexOf("bottom")!==-1?d.insertBefore(a,d.firstChild):d.appendChild(a),this}removeControl(y){if(!y||!y.onRemove)return this.fire(new c.j(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const t=this._controls.indexOf(y);return t>-1&&this._controls.splice(t,1),y.onRemove(this),this}hasControl(y){return this._controls.indexOf(y)>-1}calculateCameraOptionsFromTo(y,t,a,d){return d==null&&this.terrain&&(d=this.terrain.getElevationForLngLatZoom(a,this.transform.tileZoom)),super.calculateCameraOptionsFromTo(y,t,a,d)}resize(y){var t;const a=this._containerDimensions(),d=a[0],f=a[1],g=this._getClampedPixelRatio(d,f);if(this._resizeCanvas(d,f,g),this.painter.resize(d,f,g),this.painter.overLimit()){const I=this.painter.context.gl;this._maxCanvasSize=[I.drawingBufferWidth,I.drawingBufferHeight];const k=this._getClampedPixelRatio(d,f);this._resizeCanvas(d,f,k),this.painter.resize(d,f,k)}this.transform.resize(d,f),(t=this._requestedCameraState)===null||t===void 0||t.resize(d,f);const E=!this._moving;return E&&(this.stop(),this.fire(new c.k("movestart",y)).fire(new c.k("move",y))),this.fire(new c.k("resize",y)),E&&this.fire(new c.k("moveend",y)),this}_getClampedPixelRatio(y,t){const{0:a,1:d}=this._maxCanvasSize,f=this.getPixelRatio(),g=y*f,E=t*f;return Math.min(g>a?a/g:1,E>d?d/E:1)*f}getPixelRatio(){var y;return(y=this._overridePixelRatio)!==null&&y!==void 0?y:devicePixelRatio}setPixelRatio(y){this._overridePixelRatio=y,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(y){return this.transform.setMaxBounds(Ce.convert(y)),this._update()}setMinZoom(y){if((y=y??-2)>=-2&&y<=this.transform.maxZoom)return this.transform.minZoom=y,this._update(),this.getZoom()<y&&this.setZoom(y),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(y){if((y=y??22)>=this.transform.minZoom)return this.transform.maxZoom=y,this._update(),this.getZoom()>y&&this.setZoom(y),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(y){if((y=y??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(y>=0&&y<=this.transform.maxPitch)return this.transform.minPitch=y,this._update(),this.getPitch()<y&&this.setPitch(y),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(y){if((y=y??60)>85)throw new Error("maxPitch must be less than or equal to 85");if(y>=this.transform.minPitch)return this.transform.maxPitch=y,this._update(),this.getPitch()>y&&this.setPitch(y),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(y){return this.transform.renderWorldCopies=y,this._update()}project(y){return this.transform.locationPoint(c.N.convert(y),this.style&&this.terrain)}unproject(y){return this.transform.pointLocation(c.P.convert(y),this.terrain)}isMoving(){var y;return this._moving||((y=this.handlers)===null||y===void 0?void 0:y.isMoving())}isZooming(){var y;return this._zooming||((y=this.handlers)===null||y===void 0?void 0:y.isZooming())}isRotating(){var y;return this._rotating||((y=this.handlers)===null||y===void 0?void 0:y.isRotating())}_createDelegatedListener(y,t,a){if(y==="mouseenter"||y==="mouseover"){let d=!1;return{layers:t,listener:a,delegates:{mousemove:g=>{const E=t.filter(k=>this.getLayer(k)),I=E.length!==0?this.queryRenderedFeatures(g.point,{layers:E}):[];I.length?d||(d=!0,a.call(this,new $r(y,this,g.originalEvent,{features:I}))):d=!1},mouseout:()=>{d=!1}}}}if(y==="mouseleave"||y==="mouseout"){let d=!1;return{layers:t,listener:a,delegates:{mousemove:E=>{const I=t.filter(k=>this.getLayer(k));(I.length!==0?this.queryRenderedFeatures(E.point,{layers:I}):[]).length?d=!0:d&&(d=!1,a.call(this,new $r(y,this,E.originalEvent)))},mouseout:E=>{d&&(d=!1,a.call(this,new $r(y,this,E.originalEvent)))}}}}{const d=f=>{const g=t.filter(I=>this.getLayer(I)),E=g.length!==0?this.queryRenderedFeatures(f.point,{layers:g}):[];E.length&&(f.features=E,a.call(this,f),delete f.features)};return{layers:t,listener:a,delegates:{[y]:d}}}}_saveDelegatedListener(y,t){this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[y]=this._delegatedListeners[y]||[],this._delegatedListeners[y].push(t)}_removeDelegatedListener(y,t,a){if(!this._delegatedListeners||!this._delegatedListeners[y])return;const d=this._delegatedListeners[y];for(let f=0;f<d.length;f++){const g=d[f];if(g.listener===a&&g.layers.length===t.length&&g.layers.every(E=>t.includes(E))){for(const E in g.delegates)this.off(E,g.delegates[E]);return void d.splice(f,1)}}}on(y,t,a){if(a===void 0)return super.on(y,t);const d=this._createDelegatedListener(y,typeof t=="string"?[t]:t,a);this._saveDelegatedListener(y,d);for(const f in d.delegates)this.on(f,d.delegates[f]);return this}once(y,t,a){if(a===void 0)return super.once(y,t);const d=typeof t=="string"?[t]:t,f=this._createDelegatedListener(y,d,a);for(const g in f.delegates){const E=f.delegates[g];f.delegates[g]=(...I)=>{this._removeDelegatedListener(y,d,a),E(...I)}}this._saveDelegatedListener(y,f);for(const g in f.delegates)this.once(g,f.delegates[g]);return this}off(y,t,a){return a===void 0?super.off(y,t):(this._removeDelegatedListener(y,typeof t=="string"?[t]:t,a),this)}queryRenderedFeatures(y,t){if(!this.style)return[];let a;const d=y instanceof c.P||Array.isArray(y),f=d?y:[[0,0],[this.transform.width,this.transform.height]];if(t=t||(d?{}:y)||{},f instanceof c.P||typeof f[0]=="number")a=[c.P.convert(f)];else{const g=c.P.convert(f[0]),E=c.P.convert(f[1]);a=[g,new c.P(E.x,g.y),E,new c.P(g.x,E.y),g]}return this.style.queryRenderedFeatures(a,t,this.transform)}querySourceFeatures(y,t){return this.style.querySourceFeatures(y,t)}setStyle(y,t){return(t=c.e({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},t)).diff!==!1&&t.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&y?(this._diffStyle(y,t),this):(this._localIdeographFontFamily=t.localIdeographFontFamily,this._updateStyle(y,t))}setTransformRequest(y){return this._requestManager.setTransformRequest(y),this}_getUIString(y){const t=this._locale[y];if(t==null)throw new Error(`Missing UI string '${y}'`);return t}_updateStyle(y,t){if(t.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",()=>this._updateStyle(y,t));const a=this.style&&t.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!y)),y?(this.style=new Nu(this,t||{}),this.style.setEventedParent(this,{style:this.style}),typeof y=="string"?this.style.loadURL(y,t,a):this.style.loadJSON(y,t,a),this):(delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new Nu(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(y,t){if(typeof y=="string"){const a=this._requestManager.transformRequest(y,"Style");c.h(a,new AbortController).then(d=>{this._updateDiff(d.data,t)}).catch(d=>{d&&this.fire(new c.j(d))})}else typeof y=="object"&&this._updateDiff(y,t)}_updateDiff(y,t){try{this.style.setState(y,t)&&this._update(!0)}catch(a){c.w(`Unable to perform style diff: ${a.message||a.error||a}.  Rebuilding the style from scratch.`),this._updateStyle(y,t)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():c.w("There is no style added to the map.")}addSource(y,t){return this._lazyInitEmptyStyle(),this.style.addSource(y,t),this._update(!0)}isSourceLoaded(y){const t=this.style&&this.style.sourceCaches[y];if(t!==void 0)return t.loaded();this.fire(new c.j(new Error(`There is no source with ID '${y}'`)))}setTerrain(y){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),y){const t=this.style.sourceCaches[y.source];if(!t)throw new Error(`cannot load terrain, because there exists no source with ID: ${y.source}`);this.terrain===null&&t.reload();for(const a in this.style._layers){const d=this.style._layers[a];d.type==="hillshade"&&d.source===y.source&&c.w("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new xl(this.painter,t,y),this.painter.renderToTexture=new Ld(this.painter,this.terrain),this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._terrainDataCallback=a=>{a.dataType==="style"?this.terrain.sourceCache.freeRtt():a.dataType==="source"&&a.tile&&(a.sourceId!==y.source||this._elevationFreeze||(this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.terrain.sourceCache.freeRtt(a.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform.minElevationForCurrentTile=0,this.transform.elevation=0;return this.fire(new c.k("terrain",{terrain:y})),this}getTerrain(){var y,t;return(t=(y=this.terrain)===null||y===void 0?void 0:y.options)!==null&&t!==void 0?t:null}areTilesLoaded(){const y=this.style&&this.style.sourceCaches;for(const t in y){const a=y[t]._tiles;for(const d in a){const f=a[d];if(f.state!=="loaded"&&f.state!=="errored")return!1}}return!0}removeSource(y){return this.style.removeSource(y),this._update(!0)}getSource(y){return this.style.getSource(y)}addImage(y,t,a={}){const{pixelRatio:d=1,sdf:f=!1,stretchX:g,stretchY:E,content:I,textFitWidth:k,textFitHeight:z}=a;if(this._lazyInitEmptyStyle(),!(t instanceof HTMLImageElement||c.b(t))){if(t.width===void 0||t.height===void 0)return this.fire(new c.j(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:L,height:O,data:V}=t,X=t;return this.style.addImage(y,{data:new c.R({width:L,height:O},new Uint8Array(V)),pixelRatio:d,stretchX:g,stretchY:E,content:I,textFitWidth:k,textFitHeight:z,sdf:f,version:0,userImage:X}),X.onAdd&&X.onAdd(this,y),this}}{const{width:L,height:O,data:V}=W.getImageData(t);this.style.addImage(y,{data:new c.R({width:L,height:O},V),pixelRatio:d,stretchX:g,stretchY:E,content:I,textFitWidth:k,textFitHeight:z,sdf:f,version:0})}}updateImage(y,t){const a=this.style.getImage(y);if(!a)return this.fire(new c.j(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const d=t instanceof HTMLImageElement||c.b(t)?W.getImageData(t):t,{width:f,height:g,data:E}=d;if(f===void 0||g===void 0)return this.fire(new c.j(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(f!==a.data.width||g!==a.data.height)return this.fire(new c.j(new Error("The width and height of the updated image must be that same as the previous version of the image")));const I=!(t instanceof HTMLImageElement||c.b(t));return a.data.replace(E,I),this.style.updateImage(y,a),this}getImage(y){return this.style.getImage(y)}hasImage(y){return y?!!this.style.getImage(y):(this.fire(new c.j(new Error("Missing required image id"))),!1)}removeImage(y){this.style.removeImage(y)}loadImage(y){return he.getImage(this._requestManager.transformRequest(y,"Image"),new AbortController)}listImages(){return this.style.listImages()}addLayer(y,t){return this._lazyInitEmptyStyle(),this.style.addLayer(y,t),this._update(!0)}moveLayer(y,t){return this.style.moveLayer(y,t),this._update(!0)}removeLayer(y){return this.style.removeLayer(y),this._update(!0)}getLayer(y){return this.style.getLayer(y)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(y,t,a){return this.style.setLayerZoomRange(y,t,a),this._update(!0)}setFilter(y,t,a={}){return this.style.setFilter(y,t,a),this._update(!0)}getFilter(y){return this.style.getFilter(y)}setPaintProperty(y,t,a,d={}){return this.style.setPaintProperty(y,t,a,d),this._update(!0)}getPaintProperty(y,t){return this.style.getPaintProperty(y,t)}setLayoutProperty(y,t,a,d={}){return this.style.setLayoutProperty(y,t,a,d),this._update(!0)}getLayoutProperty(y,t){return this.style.getLayoutProperty(y,t)}setGlyphs(y,t={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(y,t),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(y,t,a={}){return this._lazyInitEmptyStyle(),this.style.addSprite(y,t,a,d=>{d||this._update(!0)}),this}removeSprite(y){return this._lazyInitEmptyStyle(),this.style.removeSprite(y),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(y,t={}){return this._lazyInitEmptyStyle(),this.style.setSprite(y,t,a=>{a||this._update(!0)}),this}setLight(y,t={}){return this._lazyInitEmptyStyle(),this.style.setLight(y,t),this._update(!0)}getLight(){return this.style.getLight()}setSky(y){return this._lazyInitEmptyStyle(),this.style.setSky(y),this._update(!0)}getSky(){return this.style.getSky()}setFeatureState(y,t){return this.style.setFeatureState(y,t),this._update()}removeFeatureState(y,t){return this.style.removeFeatureState(y,t),this._update()}getFeatureState(y){return this.style.getFeatureState(y)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let y=0,t=0;return this._container&&(y=this._container.clientWidth||400,t=this._container.clientHeight||300),[y,t]}_setupContainer(){const y=this._container;y.classList.add("maplibregl-map");const t=this._canvasContainer=q.create("div","maplibregl-canvas-container",y);this._interactive&&t.classList.add("maplibregl-interactive"),this._canvas=q.create("canvas","maplibregl-canvas",t),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex",this._interactive?"0":"-1"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region");const a=this._containerDimensions(),d=this._getClampedPixelRatio(a[0],a[1]);this._resizeCanvas(a[0],a[1],d);const f=this._controlContainer=q.create("div","maplibregl-control-container",y),g=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(E=>{g[E]=q.create("div",`maplibregl-ctrl-${E} `,f)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(y,t,a){this._canvas.width=Math.floor(a*y),this._canvas.height=Math.floor(a*t),this._canvas.style.width=`${y}px`,this._canvas.style.height=`${t}px`}_setupPainter(){const y={alpha:!0,stencil:!0,depth:!0,failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1};let t=null;this._canvas.addEventListener("webglcontextcreationerror",d=>{t={requestedAttributes:y},d&&(t.statusMessage=d.statusMessage,t.type=d.type)},{once:!0});const a=this._canvas.getContext("webgl2",y)||this._canvas.getContext("webgl",y);if(!a){const d="Failed to initialize WebGL";throw t?(t.message=d,new Error(JSON.stringify(t))):new Error(d)}this.painter=new Tt(a,this.transform),Ee.testSupport(a)}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(y){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||y,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(y){return this._update(),this._renderTaskQueue.add(y)}_cancelRenderFrame(y){this._renderTaskQueue.remove(y)}_render(y){const t=this._idleTriggered?this._fadeDuration:0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(y),this._removed)return;let a=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const f=this.transform.zoom,g=W.now();this.style.zoomHistory.update(f,g);const E=new c.z(f,{now:g,fadeDuration:t,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),I=E.crossFadingFactor();I===1&&I===this._crossFadingFactor||(a=!0,this._crossFadingFactor=I),this.style.update(E)}this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.sourceCache.update(this.transform,this.terrain),this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._elevationFreeze||(this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform.minElevationForCurrentTile=0,this.transform.elevation=0),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,t,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:t,showPadding:this.showPadding}),this.fire(new c.k("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,c.bf.mark(c.bg.load),this.fire(new c.k("load"))),this.style&&(this.style.hasTransitions()||a)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const d=this._sourcesDirty||this._styleDirty||this._placementDirty;return d||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new c.k("idle")),!this._loaded||this._fullyLoaded||d||(this._fullyLoaded=!0,c.bf.mark(c.bg.fullLoad)),this}redraw(){return this.style&&(this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._render(0)),this}remove(){var y;this._hash&&this._hash.remove();for(const a of this._controls)a.onRemove(this);this._controls=[],this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),he.removeThrottleControl(this._imageQueueHandle),(y=this._resizeObserver)===null||y===void 0||y.disconnect();const t=this.painter.context.gl.getExtension("WEBGL_lose_context");t!=null&&t.loseContext&&t.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),q.remove(this._canvasContainer),q.remove(this._controlContainer),this._container.classList.remove("maplibregl-map"),c.bf.clearMetrics(),this._removed=!0,this.fire(new c.k("remove"))}triggerRepaint(){this.style&&!this._frameRequest&&(this._frameRequest=new AbortController,W.frameAsync(this._frameRequest).then(y=>{c.bf.frame(y),this._frameRequest=null,this._render(y)}).catch(()=>{}))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(y){this._showTileBoundaries!==y&&(this._showTileBoundaries=y,this._update())}get showPadding(){return!!this._showPadding}set showPadding(y){this._showPadding!==y&&(this._showPadding=y,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(y){this._showCollisionBoxes!==y&&(this._showCollisionBoxes=y,y?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(y){this._showOverdrawInspector!==y&&(this._showOverdrawInspector=y,this._update())}get repaint(){return!!this._repaint}set repaint(y){this._repaint!==y&&(this._repaint=y,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(y){this._vertices=y,this._update()}get version(){return Od}getCameraTargetElevation(){return this.transform.elevation}},w.MapMouseEvent=$r,w.MapTouchEvent=Sa,w.MapWheelEvent=zd,w.Marker=ic,w.NavigationControl=class{constructor(y){this._updateZoomButtons=()=>{const t=this._map.getZoom(),a=t===this._map.getMaxZoom(),d=t===this._map.getMinZoom();this._zoomInButton.disabled=a,this._zoomOutButton.disabled=d,this._zoomInButton.setAttribute("aria-disabled",a.toString()),this._zoomOutButton.setAttribute("aria-disabled",d.toString())},this._rotateCompassArrow=()=>{const t=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${this._map.transform.angle*(180/Math.PI)}deg)`:`rotate(${this._map.transform.angle*(180/Math.PI)}deg)`;this._compassIcon.style.transform=t},this._setButtonTitle=(t,a)=>{const d=this._map._getUIString(`NavigationControl.${a}`);t.title=d,t.setAttribute("aria-label",d)},this.options=c.e({},cp,y),this._container=q.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",t=>t.preventDefault()),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",t=>this._map.zoomIn({},{originalEvent:t})),q.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",t=>this._map.zoomOut({},{originalEvent:t})),q.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",t=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:t}):this._map.resetNorth({},{originalEvent:t})}),this._compassIcon=q.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(y){return this._map=y,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new hp(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){q.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(y,t){const a=q.create("button",y,this._container);return a.type="button",a.addEventListener("click",t),a}},w.Popup=class extends c.E{constructor(y){super(),this.remove=()=>(this._content&&q.remove(this._content),this._container&&(q.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),this._map._canvasContainer.classList.remove("maplibregl-track-pointer"),delete this._map,this.fire(new c.k("close"))),this),this._onMouseUp=t=>{this._update(t.point)},this._onMouseMove=t=>{this._update(t.point)},this._onDrag=t=>{this._update(t.point)},this._update=t=>{var a;if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=q.create("div","maplibregl-popup",this._map.getContainer()),this._tip=q.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(const I of this.options.className.split(" "))this._container.classList.add(I);this._closeButton&&this._closeButton.setAttribute("aria-label",this._map._getUIString("Popup.Close")),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._lngLat=this._map.transform.renderWorldCopies&&!this._trackPointer?ar(this._lngLat,this._flatPos,this._map.transform):(a=this._lngLat)===null||a===void 0?void 0:a.wrap(),this._trackPointer&&!t)return;const d=this._flatPos=this._pos=this._trackPointer&&t?t:this._map.project(this._lngLat);this._map.terrain&&(this._flatPos=this._trackPointer&&t?t:this._map.transform.locationPoint(this._lngLat));let f=this.options.anchor;const g=oc(this.options.offset);if(!f){const I=this._container.offsetWidth,k=this._container.offsetHeight;let z;z=d.y+g.bottom.y<k?["top"]:d.y>this._map.transform.height-k?["bottom"]:[],d.x<I/2?z.push("left"):d.x>this._map.transform.width-I/2&&z.push("right"),f=z.length===0?"bottom":z.join("-")}let E=d.add(g[f]);this.options.subpixelPositioning||(E=E.round()),q.setTransform(this._container,`${Bi[f]} translate(${E.x}px,${E.y}px)`),rc(this._container,f,"popup")},this._onClose=()=>{this.remove()},this.options=c.e(Object.create(Bt),y)}addTo(y){return this._map&&this.remove(),this._map=y,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new c.k("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(y){return this._lngLat=c.N.convert(y),this._pos=null,this._flatPos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._flatPos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(y){return this.setDOMContent(document.createTextNode(y))}setHTML(y){const t=document.createDocumentFragment(),a=document.createElement("body");let d;for(a.innerHTML=y;d=a.firstChild,d;)t.appendChild(d);return this.setDOMContent(t)}getMaxWidth(){var y;return(y=this._container)===null||y===void 0?void 0:y.style.maxWidth}setMaxWidth(y){return this.options.maxWidth=y,this._update(),this}setDOMContent(y){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=q.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(y),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(y){return this._container&&this._container.classList.add(y),this}removeClassName(y){return this._container&&this._container.classList.remove(y),this}setOffset(y){return this.options.offset=y,this._update(),this}toggleClassName(y){if(this._container)return this._container.classList.toggle(y)}setSubpixelPositioning(y){this.options.subpixelPositioning=y}_createCloseButton(){this.options.closeButton&&(this._closeButton=q.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const y=this._container.querySelector(sc);y&&y.focus()}},w.RasterDEMTileSource=Yt,w.RasterTileSource=Ot,w.ScaleControl=class{constructor(y){this._onMove=()=>{ru(this._map,this._container,this.options)},this.setUnit=t=>{this.options.unit=t,ru(this._map,this._container,this.options)},this.options=Object.assign(Object.assign({},Qr),y)}getDefaultPosition(){return"bottom-left"}onAdd(y){return this._map=y,this._container=q.create("div","maplibregl-ctrl maplibregl-ctrl-scale",y.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){q.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},w.ScrollZoomHandler=Fs,w.Style=Nu,w.TerrainControl=class{constructor(y){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.Disable")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.Enable"))},this.options=y}onAdd(y){return this._map=y,this._container=q.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=q.create("button","maplibregl-ctrl-terrain",this._container),q.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){q.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},w.TwoFingersTouchPitchHandler=_r,w.TwoFingersTouchRotateHandler=yh,w.TwoFingersTouchZoomHandler=_h,w.TwoFingersTouchZoomRotateHandler=Pa,w.VectorTileSource=bn,w.VideoSource=vr,w.addSourceType=(y,t)=>c._(void 0,void 0,void 0,function*(){if(fr(y))throw new Error(`A source type called "${y}" already exists.`);((a,d)=>{dr[a]=d})(y,t)}),w.clearPrewarmedResources=function(){const y=Nn;y&&(y.isPreloaded()&&y.numActive()===1?(y.release(Sn),Nn=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},w.getMaxParallelImageRequests=function(){return c.a.MAX_PARALLEL_IMAGE_REQUESTS},w.getRTLTextPluginStatus=function(){return jr().getRTLTextPluginStatus()},w.getVersion=function(){return bo},w.getWorkerCount=function(){return cn.workerCount},w.getWorkerUrl=function(){return c.a.WORKER_URL},w.importScriptInWorkers=function(y){return Qt().broadcast("IS",y)},w.prewarm=function(){rn().acquire(Sn)},w.setMaxParallelImageRequests=function(y){c.a.MAX_PARALLEL_IMAGE_REQUESTS=y},w.setRTLTextPlugin=function(y,t){return jr().setRTLTextPlugin(y,t)},w.setWorkerCount=function(y){cn.workerCount=y},w.setWorkerUrl=function(y){c.a.WORKER_URL=y}});var b=o;return b})})(p5);var II=p5.exports;const kI=B0(II),yw="map",PI=()=>{const[e,r]=Rt.useState(null);return Rt.useEffect(()=>{(async()=>{const o=await pw();r(o)})()},[]),e},AI="#D8F2FF",MI="#666666",R0="#ffffff",zI="#999999",DI="#08254d",g5="#6EE143",_5=0,RI={fillColor:"#6EE143",fillOpacity:0,strokeColor:"#000000",strokeOpacity:1,strokeWidth:3.5},LI={fillColor:"#6EE143",fillOpacity:0,strokeColor:"#000000",strokeOpacity:1,strokeWidth:3.5},OI={id:"43f36e14-e3f5-43c1-84c0-50a9c80dc5c7",name:"MapLibre",zoom:.8619833357855968,pitch:0,center:[17.65431710431244,32.954120326746775],glyphs:"https://demotiles.maplibre.org/font/{fontstack}/{range}.pbf",layers:[{id:"background",type:"background",paint:{"background-color":AI},filter:["all"],layout:{visibility:"visible"},maxzoom:24},{id:"coastline",type:"line",paint:{"line-blur":.5,"line-color":MI,"line-width":{stops:[[0,2],[6,6],[14,9],[22,18]]}},filter:["all"],layout:{"line-cap":"round","line-join":"round",visibility:"visible"},source:"maplibre",maxzoom:24,minzoom:0,"source-layer":"countries"},{id:"countries-fill",type:"fill",paint:{"fill-color":R0},filter:["all"],layout:{visibility:"visible"},source:"maplibre",maxzoom:24,"source-layer":"countries"},{id:"countries-boundary",type:"line",paint:{"line-color":zI,"line-width":{stops:[[1,1],[6,2],[14,6],[22,12]]},"line-opacity":{stops:[[3,.5],[6,1]]}},layout:{"line-cap":"round","line-join":"round",visibility:"visible"},source:"maplibre",maxzoom:24,"source-layer":"countries"},{id:"countries-label",type:"symbol",paint:{"text-color":DI,"text-halo-blur":{stops:[[2,.2],[6,0]]},"text-halo-color":"rgba(255, 255, 255, 1)","text-halo-width":{stops:[[2,1],[6,1.6]]}},filter:["all"],layout:{"text-font":["Open Sans Semibold"],"text-size":{stops:[[2,10],[4,12],[6,16]]},"text-field":{stops:[[2,"{ABBREV}"],[4,"{NAME}"]]},visibility:"visible","text-max-width":10,"text-transform":{stops:[[0,"uppercase"],[2,"none"]]}},source:"maplibre",maxzoom:24,minzoom:2,"source-layer":"centroids"},{id:"crimea-fill",type:"fill",source:"crimea",paint:{"fill-color":R0}}],bearing:0,sources:{maplibre:{url:"https://demotiles.maplibre.org/tiles/tiles.json",type:"vector"},crimea:{type:"geojson",data:{type:"Feature",geometry:{type:"Polygon",coordinates:[[[34.00905273547181,46.55925987559425],[33.64325260204026,46.34533545368038],[33.628682598560204,46.12569762665683],[33.64292861730951,46.10476396128129],[33.648473474905984,46.09033047763651],[33.63876482059936,46.077976784785335],[33.62782672238245,46.06747935719011],[33.62911357645072,46.05708111413949],[33.642686868727424,46.02192963417187],[33.6429723910654,46.01521185644708],[33.636224138774026,46.006705833212465],[33.63052626465907,45.99692992186792],[33.63193836679693,45.988472992911284],[33.64276684834442,45.984575360297384],[33.646928693041986,45.97981936210982],[33.638745893564305,45.96829769147004],[33.61958133326394,45.951176418494185],[33.63181380398527,45.9445404758078],[33.638921676216,45.94737012930554],[33.64561542516918,45.95403251372139],[33.65666403976448,45.95687114427736],[33.6825817382811,45.95878100879199],[33.738791807037614,45.94836945227263],[33.758180142697,45.94072970008301],[33.77735917288169,45.92923970233858],[33.75927796793485,45.92241179584471],[33.72529865009221,45.91587363154565],[33.70875012326826,45.91008760988058],[33.69378857293381,45.91480850795665],[33.69092650243843,45.89657370898402],[33.693592356906805,45.87271465766318],[33.69226765972388,45.86041392418218],[33.6704813511748,45.8584273836251],[33.65936345808916,45.85944682601249],[33.653870582376726,45.86425922279372],[33.65107345584843,45.87089907254003],[33.63067378180233,45.88040685247182],[33.61945300059696,45.88147266102649],[33.60987421595539,45.88048951126686],[33.59906957603934,45.877610457390375],[33.57828877687868,45.86810261756233],[33.55357394560386,45.84700625141778],[33.530220674480375,45.84221983655459],[33.5192297395441,45.84121682367507],[33.50832088442496,45.84313067048083],[33.48901101848409,45.85268298292175],[33.482152996405716,45.854578171799005],[33.46719955896293,45.849912739405056],[33.42447496599681,45.83075886348303],[33.40940172404095,45.82691953557702],[33.37918350072067,45.802867525073566],[33.37362145339398,45.79619281922518],[33.33805543634864,45.78577808972071],[33.26498872665803,45.75410774187094],[33.22887541283427,45.75131270772724],[33.19548267281132,45.7644887297206],[33.1789202379222,45.78010311364778],[33.1688456078636,45.78470227904205],[33.161012432811674,45.77921593899549],[33.15951585299757,45.76864464913777],[33.165962301438725,45.762685940125465],[33.1750888126426,45.759218220695715],[33.181464829753,45.75490447884948],[33.17613930782352,45.7437961960276],[33.16369168844906,45.735912015025065],[32.93692665480876,45.662114646778264],[32.86839112407645,45.63044340698664],[32.83803944575723,45.60834075026611],[32.82702772424804,45.59576101516498],[32.82433467080986,45.58705137380335],[32.82563941622885,45.579605763895614],[32.82993674258438,45.56978311819469],[32.82851940940563,45.56227808675749],[32.813310142795274,45.55930933158257],[32.80213583657516,45.560145780074464],[32.78258622159436,45.565158335073846],[32.77333922465823,45.56689313356526],[32.758306734735356,45.565030173463356],[32.750177256846115,45.55943726334968],[32.74340732630185,45.55261895849793],[32.73524549539499,45.54598788110354],[32.72031700779701,45.53735927760957],[32.70536040418847,45.53169142131733],[32.68589438933773,45.52663379187257],[32.66370583186284,45.52563107058867],[32.64312077736798,45.52188979044979],[32.525284074162556,45.45838108691365],[32.49490411219156,45.43524910229854],[32.48107654411925,45.408986638827514],[32.48514589713025,45.39458067125969],[32.51256939517424,45.34060655033625],[32.535915460470335,45.33777248012882],[32.57027153843481,45.32510892683359],[32.590830644991826,45.32038723212662],[32.66380378113439,45.320421746458976],[32.67760722618917,45.32609231279554],[32.71316246802607,45.353283572618125],[32.72817188836078,45.36074681043402],[32.750518060251466,45.36371725645313],[32.89973931692998,45.35412322462227],[32.941197846443885,45.34245505845169],[32.97701667405008,45.32596743563991],[33.04296090827762,45.2853982930032],[33.05274355585479,45.28154273654923],[33.06850284417635,45.27703461892352],[33.07825272648239,45.272210805127315],[33.089426322403455,45.25656353201492],[33.09897492343546,45.247820101667884],[33.12384611720435,45.238235755071685],[33.15767197859745,45.20755227709648],[33.172959979330074,45.19681657531794],[33.21837666514142,45.187878368659824],[33.24017433636709,45.180191106261134],[33.248571989896675,45.16588271012458],[33.259649216030766,45.155918961282026],[33.28309785485047,45.16064860772312],[33.31767999550894,45.17535522412791],[33.35458473323109,45.18598673360148],[33.39725661527919,45.18973663076909],[33.41344561756824,45.18490731877088],[33.468468576977216,45.149132412229676],[33.537128652906205,45.11719769268973],[33.56161328289443,45.094099022711475],[33.57837628774928,45.053145935448015],[33.58247744978442,45.027377243150454],[33.5851414316958,45.01816461606674],[33.6031021265521,44.993103583251695],[33.605922209331794,44.986905272229734],[33.60843524291815,44.97039962759274],[33.61943161357851,44.93184946652454],[33.619484500808824,44.90819321920554],[33.61549738593425,44.88894092276257],[33.608561183117274,44.871288478948514],[33.59889474705494,44.859790298912856],[33.55904244709464,44.850057575124595],[33.54667558363471,44.83724531175508],[33.53701832136994,44.81871953508235],[33.5303157846202,44.798338017069625],[33.5249116915937,44.78918633101301],[33.51669091675143,44.784809980590666],[33.524785531609865,44.77183212449111],[33.5302902535075,44.75724515985675],[33.53710734694323,44.73034290771247],[33.54650992495621,44.70989226909535],[33.5481286806762,44.699106546699085],[33.543995566510915,44.68230506537358],[33.53580273994743,44.6726082589706],[33.52337411931097,44.661863083605255],[33.515320778874354,44.6491266698327],[33.516377841582795,44.63464990118433],[33.52466971637648,44.62863961572572],[33.557474298027785,44.62473000923737],[33.5710648827386,44.620853511273225],[33.55105839203679,44.61506440493406],[33.499905706797676,44.61452599304897],[33.48451102966331,44.60992438254493],[33.47658499621011,44.60714391514574],[33.46705078205747,44.60616254193252],[33.44476599234898,44.607062134677875],[33.4353466482458,44.60509936890821],[33.413591053005575,44.593500212748125],[33.40543527945235,44.59055535193136],[33.37510958624222,44.58564691897425],[33.37074452434078,44.58851022190515],[33.372237834990756,44.576810695127364],[33.37913003799301,44.56412673079859],[33.48759131590526,44.51024086451031],[33.50011215135888,44.50041002882833],[33.517917009115365,44.49074142372788],[33.53836387802215,44.49164280212756],[33.56041892763031,44.4966411022441],[33.57822378538677,44.497542389459795],[33.59062975079095,44.48975808594983],[33.619577003408466,44.46229988129974],[33.62635433636015,44.45336293328907],[33.63175322871038,44.434828756313124],[33.645537634715026,44.42498521035591],[33.721007257593925,44.39946630464436],[33.74168386660085,44.39560878121904],[33.80727466517129,44.39454176175843],[33.81841706002561,44.39552670349164],[33.83909366903248,44.40143600575672],[33.85149963444792,44.40143600575945],[33.91467816197718,44.38387049706651],[33.938111652185,44.38083293528811],[33.957065210440874,44.38272116790142],[34.06614966692763,44.42019923628979],[34.088893936836286,44.42200415824283],[34.10279321289039,44.42487551014821],[34.135933345669,44.44163597968952],[34.14696087047267,44.44959070749778],[34.16058918507403,44.466287285335795],[34.170123399227776,44.48186111741296],[34.182759104731986,44.49267838558103],[34.22923417224524,44.49949719774551],[34.24301857824986,44.50744404277697],[34.263903954150294,44.53186886058606],[34.26631622520165,44.53555362837611],[34.26631622520165,44.54153064468656],[34.27033667695244,44.545378535987936],[34.2757355693048,44.54644280144541],[34.285384653508004,44.54562413743594],[34.299973149863405,44.54554227040174],[34.32260254971496,44.543577427039224],[34.3308731933177,44.54546040325087],[34.340292537420794,44.55798473830754],[34.38042135640006,44.631830317636684],[34.41495238900856,44.673669777529994],[34.424193090575585,44.68239452736094],[34.42959198292681,44.68884644523774],[34.469399167794535,44.730194532749294],[34.47376422969597,44.73011292571252],[34.47376422969597,44.72635887754967],[34.475142670296464,44.723502373339585],[34.499724861011515,44.74292382044041],[34.532800295801195,44.752620844929055],[34.61217550038418,44.76534519537847],[34.65065696715081,44.777088262503725],[34.72084256772871,44.811080759265764],[34.756796893391225,44.82094054159748],[34.82646979041766,44.81208604604609],[34.84289620758207,44.816893835303176],[34.856910353686715,44.82373813182468],[34.889648317948144,44.817871641692506],[34.90733830566026,44.820886440346584],[34.922960632465504,44.83050015059965],[34.92950822531711,44.83652826953224],[34.94179932067178,44.84019370922482],[34.95282684547897,44.841415470643284],[34.98567967978991,44.840275160795755],[35.0053224583441,44.83538786296728],[35.017958163849414,44.82219008824552],[35.02703289780189,44.80890779582285],[35.037933245998005,44.79869792240089],[35.08073333784134,44.793525442788905],[35.1080207326404,44.824553365795765],[35.130368105574235,44.86879838545747],[35.15485200090768,44.90071251697748],[35.17111229780758,44.90746386008772],[35.21522068940149,44.91421441031795],[35.233163085981715,44.925728224907715],[35.25636688416236,44.95896657181197],[35.27300098099195,44.96690119386028],[35.29748487632534,44.95605693543271],[35.30496087491386,44.96121482614441],[35.315240372954605,44.965711070514175],[35.31935217217088,44.96941359539801],[35.36757236298112,44.94362319076086],[35.36103086422793,44.97364475976596],[35.362152264014156,44.98593980935419],[35.374674561627444,44.997835734117416],[35.389439658813274,45.00180049366759],[35.42270785247763,45.00087540764923],[35.43504325012745,45.00470780964241],[35.43504325012745,45.011446929213974],[35.40631957913584,45.02015821022701],[35.40089948016896,45.025046135473445],[35.39790908073891,45.03482073400548],[35.40052568024015,45.042216617888045],[35.40631957913584,45.051328088783805],[35.40744097892215,45.06294640963205],[35.41734667704213,45.0708666385693],[35.469304867139925,45.10068964922732],[35.5070260597534,45.113341616151644],[35.54758335202416,45.12019982412133],[35.59019654390909,45.11993606213795],[35.63411803553862,45.11439677872579],[35.70669729572677,45.09480210570922],[35.771782422456766,45.06572995732262],[35.78430472007,45.057941041321754],[35.81250040352472,45.031852200991295],[35.81941570220667,45.021152336906454],[35.82763930064016,44.99895365027004],[35.848198296721705,44.99208088455586],[35.916977483614176,45.00172895661731],[35.99360646900681,44.997896355361604],[36.00893226608571,45.00926125333629],[36.02539976723364,45.03288661039673],[36.047827762958946,45.048074065419456],[36.078666257082034,45.03883000769565],[36.079137312377895,45.046610970582435],[36.135020401727616,45.02125162210126],[36.2241716847341,45.00751061631556],[36.24398308095806,45.011474706353084],[36.24828178013877,45.01649549321965],[36.25332807917695,45.03247980324494],[36.25743987839326,45.03842324279259],[36.267158676549116,45.043573724415154],[36.2783726744118,45.04555455542638],[36.36740852558336,45.04833265291825],[36.44029951169139,45.06787222615526],[36.45375630913995,45.07631970334319],[36.455251508854985,45.09202341204062],[36.44142091149291,45.10709638287736],[36.41432041665814,45.12872568311289],[36.40852651776157,45.149160473330085],[36.409997342308856,45.171615955386955],[36.418312796420764,45.23001671705953],[36.42672329481775,45.25186253492981],[36.43756477765089,45.27227491599612],[36.4497132753354,45.28542626329343],[36.45905827355429,45.28753019598713],[36.4814862692796,45.28845064200263],[36.4909554290368,45.29213135137758],[36.49637552800283,45.300940007322055],[36.49394582846682,45.305015191082816],[36.48871262946426,45.30935296803605],[36.48460083024801,45.315924724862185],[36.489647129296515,45.336413860372005],[36.502169426909745,45.34731734941451],[36.52104632331191,45.35033842661815],[36.544281237819945,45.34731734942025],[36.57455903204905,45.33601971904315],[36.585399229982954,45.333917585593355],[36.59810088537549,45.334837278577254],[36.630808379142394,45.34048649352954],[36.637536777859964,45.3511265071989],[36.63099527910589,45.3741073632589],[36.61359545390113,45.40895280985421],[36.59845655678569,45.421547717459106],[36.58331765967199,45.42731944465129],[36.566309762912795,45.42548305000767],[36.54836736633254,45.41210180010589],[36.53285466928139,45.4090840212946],[36.51565987255873,45.41957994832251],[36.49117597722616,45.44279525429408],[36.47043008117939,45.4458112314303],[36.411182792482634,45.43610707766504],[36.391371396258705,45.43991025572652],[36.35959840231365,45.45407156049933],[36.33960010612526,45.45695583486963],[36.33025510790637,45.454464879327446],[36.32053630976225,45.44856480887407],[36.31156511147125,45.4438443081136],[36.29885591389362,45.442795254299995],[36.3072664122906,45.46115087970253],[36.30016421364425,45.47320989503609],[36.283717016779036,45.476355300848866],[36.267082919949445,45.46704963343626],[36.25213092279836,45.46115087970253],[36.13681364478941,45.46219959214511],[36.11700224855986,45.45721803432335],[36.097003952371466,45.441483909606006],[36.06952965760803,45.43046741078453],[36.0655449627526,45.42553028973455],[36.05134056545904,45.39535242162091],[36.022557970944945,45.368441166003805],[35.986486277818386,45.362926059418186],[35.94723728529826,45.372380198658874],[35.87220216002379,45.404075760536614],[35.85388596351393,45.413916621802144],[35.84715756479628,45.426379251448395],[35.8524047739447,45.44386497541683],[35.85950697259193,45.45933624762881],[35.857824872912545,45.469953901705],[35.83278027768503,45.47087138287168],[35.8167068807486,45.46392436820739],[35.80362388324218,45.44963442058864],[35.79469305616038,45.42980210462429],[35.791889556694684,45.41209230278156],[35.772265060435046,45.39214572935421],[35.767405661361295,45.38873311015669],[35.75189296431793,45.386632934388984],[35.7481549650407,45.379938103368545],[35.746846665290036,45.369960021421576],[35.74423006578874,45.36076812520648],[35.71619507113218,45.34040932557082],[35.69451467527287,45.32989869277279],[35.51720627467216,45.29506847418358],[35.48038698168983,45.2979608697527],[35.33194061536096,45.371562726652314],[35.04491375777232,45.669545248704424],[35.00230056589345,45.7290693869553],[34.70631294999043,46.024929846739866],[34.35868883309806,46.106725558140795],[34.00905273547181,46.55925987559425]]]}}}},version:8,metadata:{"maptiler:copyright":"This style was generated on MapTiler Cloud. Usage is governed by the license terms in https://github.com/maplibre/demotiles/blob/gh-pages/LICENSE","openmaptiles:version":"3.x"}};let zi=null;const FI=()=>{const e=tg(),r=PI();Rt.useEffect(()=>{if(r)return zi=new kI.Map({container:yw,style:OI,center:[27,-17],zoom:2.5}),zi.on("load",async()=>{e(jl.actions.setIsMapInitialized(!0))}),()=>{e(jl.actions.setIsMapInitialized(!1)),zi.remove(),zi=null}},[r,e])},pd=()=>{const e=os(r=>r.main.isMapInitialized);return Rt.useCallback(r=>{if(!e||zi===null)return()=>null;const o=r();return typeof o=="function"?()=>{!e||zi===null||o()}:o},[e])},BI=()=>{const e=pd();return Rt.useCallback(()=>e(()=>{zi.resize()}),[e])},y5=()=>{const e=pd();return Rt.useCallback((r,o)=>e(()=>(zi.on(r,o),()=>zi.off(r,o))),[e])},NI=()=>{const e=y5();return Rt.useCallback(r=>e("click",r),[e])},r2={strokeColor:"black",strokeOpacity:1,strokeWidth:2,fillColor:"white",fillOpacity:.5},Qf=()=>{const e=pd();return Rt.useCallback((r,o=r2)=>e(()=>{const h=c=>o[c]??r2[c],_=`geo-json-${Math.random()}`,b=`${_}-fill`,w=`${_}-stroke`;return zi.addSource(_,{type:"geojson",data:r}),zi.addLayer({id:b,type:"fill",source:_,paint:{"fill-color":h("fillColor"),"fill-opacity":h("fillOpacity")}}),zi.addLayer({id:w,type:"line",source:_,paint:{"line-color":h("strokeColor"),"line-opacity":h("strokeOpacity"),"line-width":h("strokeWidth")}}),()=>{zi.removeLayer(b),zi.removeLayer(w),zi.removeSource(_)}}),[e])},UI={padding:100},jI=()=>{const e=pd();return Rt.useCallback((r,o=UI)=>e(()=>{zi.fitBounds([[r[0],r[1]],[r[2],r[3]]],o)}),[e])},$I={},VI=()=>{const e=pd();return Rt.useCallback((r,o,h,_=$I)=>e(()=>{zi.flyTo({center:[r,o],zoom:h,..._})}),[e])},qI=()=>{const e=pd();return Rt.useCallback(r=>e(()=>{zi.flyTo({zoom:r})}),[e])},ZI=()=>{const e=pd();return Rt.useCallback((r,o)=>e(()=>{const h=zi.unproject([r,o]);return[h.lng,h.lat]}),[e])},GI=()=>{const e=qI(),r=tg(),o=os(_=>_.main.focusedCountry);if(!o)return null;const h=()=>{r(jl.actions.setFocusedCountry(null)),r(jl.actions.setFocusedState(null)),e(1)};return Qe.jsx(t5,{title:o.name,extraDescriptions:[`Country Name: ${o.name}`],getDatasets:()=>G4(o.codeIso3),onClickBack:h})},v5=e=>x5(["mousemove","touchmove"],w5(e)),WI=e=>x5(["mouseup","touchend"],w5(e)),x5=(e,r)=>(e.forEach(o=>document.addEventListener(o,r)),()=>{e.forEach(o=>document.removeEventListener(o,r))}),w5=e=>r=>{var o;!r.clientX&&!r.clientY&&((o=r.touches)!=null&&o[0])&&(r.clientX=r.touches[0].clientX,r.clientY=r.touches[0].clientY),e(r)},HI="_container_16n2u_1",XI={container:HI},b5=200,KI=.5,YI=()=>Math.max(Math.min(document.body.clientWidth*.5,500),b5),JI=()=>{const[e,r]=Rt.useState(null),[o,h]=Rt.useState(null),_=os(D=>D.main.menuWidthPx),b=Rt.useCallback(D=>{h({x:D.clientX,y:D.clientY}),r(_)},[_]);Rt.useEffect(()=>WI(()=>{h(null),r(null)}),[]);const w=tg();Rt.useEffect(()=>v5(D=>{if(o!==null){const U=D.clientX-o.x;let J=e+U;const W=document.body.clientWidth*KI;J=Math.max(J,b5),J=Math.min(J,W),w(jl.actions.setMenuWidthPx(J))}}),[w,o,_,e]);const c=Rt.useCallback(()=>{const D=YI();w(jl.actions.setMenuWidthPx(D))},[w]);return Rt.useEffect(()=>{c();const D=()=>c();return window.addEventListener("resize",D),()=>window.removeEventListener("resize",D)},[c]),Qe.jsx("div",{className:XI.container,onMouseDown:b,onTouchStart:b})},QI="_attributions_3x5ia_1",ek="_attribution_3x5ia_1",tk="_attributionKey_3x5ia_13",nk="_attributionValue_3x5ia_19",rk="_attributionUrl_3x5ia_23",ik="_line_3x5ia_46",Tc={attributions:QI,attribution:ek,attributionKey:tk,attributionValue:nk,attributionUrl:rk,line:ik},sk=()=>{const e=Rt.useMemo(()=>[{key:"This data in this map was compiled by Maria Powell and her team for a forthcoming publication",value:Qe.jsxs(Qe.Fragment,{children:["Powell, M.E., Salvi Cruz, S., Farb, A., Prasad Kodibagkar, A., Ghosh, S., Rudzicz, F., Rameau, A., Bensoussan, Y., Towards Protocol Harmonization: A Scoping Review of Publicly-Accessible Speech and Voice Datasets in Three Voice-Affecting Disease Cohorts,",Qe.jsx("i",{children:"Journal of Speech, Language, and Hearing Research"}),", Forthcoming."]})},{key:"Country Borders (default)",value:"MapLibre DemoTiles",url:"https://demotiles.maplibre.org/style.json"},{key:"Country Borders (hovered / focused)",value:"World Administrative Boundaries",url:"https://public.opendatasoft.com/explore/dataset/world-administrative-boundaries"},{key:"USA State Borders",value:"US State Boundaries",url:"https://public.opendatasoft.com/explore/dataset/us-state-boundaries/"},{key:"Canada Province and Territory Borders",value:"Provinces and territories - Canada",url:"https://data.opendatasoft.com/explore/dataset/georef-canada-province%40public"},{key:"Software Dependencies",values:[{name:"MapLibre",url:"https://maplibre.org/"},{name:"React",url:"https://react.dev/"},{name:"Redux",url:"https://redux.js.org/"},{name:"Vite",url:"https://vite.dev/"},{name:"Turf.js",url:"https://turfjs.org/"},{name:"Lodash",url:"https://lodash.com/"},{name:"Font Awesome",url:"https://fontawesome.com/"}]}].map(({key:r,values:o,value:h,url:_},b)=>Qe.jsxs("div",{className:Tc.attribution,children:[o&&Qe.jsxs(Qe.Fragment,{children:[Qe.jsxs("div",{className:Tc.attributionKey,children:[r,":"]}),Qe.jsx("ul",{children:o.map(({name:w,url:c},D)=>Qe.jsxs("li",{children:[Qe.jsx("div",{children:w}),Qe.jsx("div",{className:Tc.line}),Qe.jsx("a",{href:c,target:"_",rel:"noreferrer",className:Tc.attributionUrl,children:c})]},D))})]}),h&&Qe.jsxs("div",{children:[Qe.jsxs("div",{className:Tc.attributionKey,children:[r,":"]}),Qe.jsx("div",{className:Tc.attributionValue,children:h})]}),_&&Qe.jsx("a",{href:_,target:"_",rel:"noreferrer",className:Tc.attributionUrl,children:_})]},b)),[]);return Qe.jsxs(Qe.Fragment,{children:[Qe.jsx(Bf,{title:"About",descriptions:["This map tracks publicly accessible speech and voice datasets collected for neurological, mood, and speech disorder research in different countries. Information about the institutional source of the datasets, the number of speakers, languages, and types of voice samples are included, but the focus of the map is on the governance of these voice datasets. The type of accessibility (open or safeguarded), access instructions, and licensing are detailed and can be compared between datasets, institutions, and countries/regions. This map complements a forthcoming searchable tool that can be used to find voice datasets specific to disease categories, diagnoses, or vocal tasks.","In an upcoming iteration of the map, a research ethics element will be added to the dataset information, focusing on the informed consent process that participants went through to contribute their voice data. The aim is to provide information about the research ethics process and related documentation (e.g., consent forms, IRB/REB documentation) to make these datasets more easily useable for researchers whose institutions have stringent data governance requirements."]}),Qe.jsx(Bf,{title:"Contact",descriptions:[Qe.jsxs(Qe.Fragment,{children:["You can contact us with questions or comments by emailing"," ",Qe.jsx("a",{href:"mailto:alden_blatter@sfu.ca",target:"_",rel:"noreferrer",children:"alden_blatter@sfu.ca"})]})]}),Qe.jsx(Bf,{title:"Attributions",children:Qe.jsx("div",{className:Tc.attributions,children:e})})]})},fx=e=>e==="USA"?"State":e==="CAN"?"Province / Territory":"State",ok=3,S5=()=>{const e=jI(),r=VI();return Rt.useCallback(o=>{const h=o.bbox[0];if(o.bbox[2]-h>180){const[w,c]=o.coordLonLat;r(w,c,ok)}else e(o.bbox)},[e,r])},ak=()=>{const e=tg(),r=S5(),o=os(b=>b.main.focusedCountry),h=os(b=>b.main.focusedState);if(!o||!h)return null;const _=()=>{e(jl.actions.setFocusedState(null)),r(o)};return Qe.jsx(t5,{title:`${h.name}, ${o.name}`,extraDescriptions:[`${fx(o.codeIso3)} Name: ${h.name}`,`Country Name: ${o.name}`],getDatasets:()=>K4(o.codeIso3,h.stateCode),onClickBack:_})},lk="_container_qa6c1_1",uk="_header_qa6c1_5",ck="_headerAccent_qa6c1_18",hk="_content_qa6c1_24",dk="_subheaderText_qa6c1_29",Ec={container:lk,header:uk,headerAccent:ck,content:hk,subheaderText:dk},fk=()=>{const e=os(_=>_.main.focusedCountry),r=os(_=>_.main.focusedState),o=os(_=>_.main.menuWidthPx);let h;return r?h=Qe.jsx(ak,{}):e?h=Qe.jsx(GI,{}):h=Qe.jsx(sk,{}),Qe.jsxs(N4,{className:Ec.container,style:{width:`${o}px`},children:[Qe.jsx(JI,{}),Qe.jsxs("div",{className:Ec.header,children:[Qe.jsx("div",{className:Ec.headerAccent}),Qe.jsxs("div",{className:Ec.headerTexts,children:[Qe.jsx("h1",{className:Ec.headerText,children:"Global Voice Datasets Repository Map"}),Qe.jsx("h3",{className:Ec.subheaderText,children:"Accessibility, Licensing, and Research Ethics"})]}),Qe.jsx("div",{className:Ec.headerAccent})]}),Qe.jsx("div",{className:Ec.content,children:h})]})},{min:pk,max:mk}=Math,rd=(e,r=0,o=1)=>pk(mk(r,e),o),vw=e=>{e._clipped=!1,e._unclipped=e.slice(0);for(let r=0;r<=3;r++)r<3?((e[r]<0||e[r]>255)&&(e._clipped=!0),e[r]=rd(e[r],0,255)):r===3&&(e[r]=rd(e[r],0,1));return e},T5={};for(let e of["Boolean","Number","String","Function","Array","Date","RegExp","Undefined","Null"])T5[`[object ${e}]`]=e.toLowerCase();function Dn(e){return T5[Object.prototype.toString.call(e)]||"object"}const xn=(e,r=null)=>e.length>=3?Array.prototype.slice.call(e):Dn(e[0])=="object"&&r?r.split("").filter(o=>e[0][o]!==void 0).map(o=>e[0][o]):e[0].slice(0),ep=e=>{if(e.length<2)return null;const r=e.length-1;return Dn(e[r])=="string"?e[r].toLowerCase():null},{PI:sy,min:E5,max:C5}=Math,ca=e=>Math.round(e*100)/100,px=e=>Math.round(e*100)/100,Cu=sy*2,ev=sy/3,gk=sy/180,_k=180/sy;function I5(e){return[...e.slice(0,3).reverse(),...e.slice(3)]}const vn={format:{},autodetect:[]};class ct{constructor(...r){const o=this;if(Dn(r[0])==="object"&&r[0].constructor&&r[0].constructor===this.constructor)return r[0];let h=ep(r),_=!1;if(!h){_=!0,vn.sorted||(vn.autodetect=vn.autodetect.sort((b,w)=>w.p-b.p),vn.sorted=!0);for(let b of vn.autodetect)if(h=b.test(...r),h)break}if(vn.format[h]){const b=vn.format[h].apply(null,_?r:r.slice(0,-1));o._rgb=vw(b)}else throw new Error("unknown format: "+r);o._rgb.length===3&&o._rgb.push(1)}toString(){return Dn(this.hex)=="function"?this.hex():`[${this._rgb.join(",")}]`}}const yk="3.1.2",Bn=(...e)=>new ct(...e);Bn.version=yk;const Wf={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",laserlemon:"#ffff54",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrod:"#fafad2",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",maroon2:"#7f0000",maroon3:"#b03060",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",purple2:"#7f007f",purple3:"#a020f0",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"},vk=/^#?([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$/,xk=/^#?([A-Fa-f0-9]{8}|[A-Fa-f0-9]{4})$/,k5=e=>{if(e.match(vk)){(e.length===4||e.length===7)&&(e=e.substr(1)),e.length===3&&(e=e.split(""),e=e[0]+e[0]+e[1]+e[1]+e[2]+e[2]);const r=parseInt(e,16),o=r>>16,h=r>>8&255,_=r&255;return[o,h,_,1]}if(e.match(xk)){(e.length===5||e.length===9)&&(e=e.substr(1)),e.length===4&&(e=e.split(""),e=e[0]+e[0]+e[1]+e[1]+e[2]+e[2]+e[3]+e[3]);const r=parseInt(e,16),o=r>>24&255,h=r>>16&255,_=r>>8&255,b=Math.round((r&255)/255*100)/100;return[o,h,_,b]}throw new Error(`unknown hex color: ${e}`)},{round:F_}=Math,P5=(...e)=>{let[r,o,h,_]=xn(e,"rgba"),b=ep(e)||"auto";_===void 0&&(_=1),b==="auto"&&(b=_<1?"rgba":"rgb"),r=F_(r),o=F_(o),h=F_(h);let c="000000"+(r<<16|o<<8|h).toString(16);c=c.substr(c.length-6);let D="0"+F_(_*255).toString(16);switch(D=D.substr(D.length-2),b.toLowerCase()){case"rgba":return`#${c}${D}`;case"argb":return`#${D}${c}`;default:return`#${c}`}};ct.prototype.name=function(){const e=P5(this._rgb,"rgb");for(let r of Object.keys(Wf))if(Wf[r]===e)return r.toLowerCase();return e};vn.format.named=e=>{if(e=e.toLowerCase(),Wf[e])return k5(Wf[e]);throw new Error("unknown color name: "+e)};vn.autodetect.push({p:5,test:(e,...r)=>{if(!r.length&&Dn(e)==="string"&&Wf[e.toLowerCase()])return"named"}});ct.prototype.alpha=function(e,r=!1){return e!==void 0&&Dn(e)==="number"?r?(this._rgb[3]=e,this):new ct([this._rgb[0],this._rgb[1],this._rgb[2],e],"rgb"):this._rgb[3]};ct.prototype.clipped=function(){return this._rgb._clipped||!1};const Ul={Kn:18,labWhitePoint:"d65",Xn:.95047,Yn:1,Zn:1.08883,t0:.137931034,t1:.206896552,t2:.12841855,t3:.008856452,kE:216/24389,kKE:8,kK:24389/27,RefWhiteRGB:{X:.95047,Y:1,Z:1.08883},MtxRGB2XYZ:{m00:.4124564390896922,m01:.21267285140562253,m02:.0193338955823293,m10:.357576077643909,m11:.715152155287818,m12:.11919202588130297,m20:.18043748326639894,m21:.07217499330655958,m22:.9503040785363679},MtxXYZ2RGB:{m00:3.2404541621141045,m01:-.9692660305051868,m02:.055643430959114726,m10:-1.5371385127977166,m11:1.8760108454466942,m12:-.2040259135167538,m20:-.498531409556016,m21:.041556017530349834,m22:1.0572251882231791},As:.9414285350000001,Bs:1.040417467,Cs:1.089532651,MtxAdaptMa:{m00:.8951,m01:-.7502,m02:.0389,m10:.2664,m11:1.7135,m12:-.0685,m20:-.1614,m21:.0367,m22:1.0296},MtxAdaptMaI:{m00:.9869929054667123,m01:.43230526972339456,m02:-.008528664575177328,m10:-.14705425642099013,m11:.5183602715367776,m12:.04004282165408487,m20:.15996265166373125,m21:.0492912282128556,m22:.9684866957875502}},wk=new Map([["a",[1.0985,.35585]],["b",[1.0985,.35585]],["c",[.98074,1.18232]],["d50",[.96422,.82521]],["d55",[.95682,.92149]],["d65",[.95047,1.08883]],["e",[1,1,1]],["f2",[.99186,.67393]],["f7",[.95041,1.08747]],["f11",[1.00962,.6435]],["icc",[.96422,.82521]]]);function Pu(e){const r=wk.get(String(e).toLowerCase());if(!r)throw new Error("unknown Lab illuminant "+e);Ul.labWhitePoint=e,Ul.Xn=r[0],Ul.Zn=r[1]}function Hm(){return Ul.labWhitePoint}const xw=(...e)=>{e=xn(e,"lab");const[r,o,h]=e,[_,b,w]=bk(r,o,h),[c,D,U]=A5(_,b,w);return[c,D,U,e.length>3?e[3]:1]},bk=(e,r,o)=>{const{kE:h,kK:_,kKE:b,Xn:w,Yn:c,Zn:D}=Ul,U=(e+16)/116,J=.002*r+U,W=U-.005*o,q=J*J*J,Ee=W*W*W,ze=q>h?q:(116*J-16)/_,Ne=e>b?Math.pow((e+16)/116,3):e/_,Be=Ee>h?Ee:(116*W-16)/_,se=ze*w,ue=Ne*c,he=Be*D;return[se,ue,he]},tv=e=>{const r=Math.sign(e);return e=Math.abs(e),(e<=.0031308?e*12.92:1.055*Math.pow(e,1/2.4)-.055)*r},A5=(e,r,o)=>{const{MtxAdaptMa:h,MtxAdaptMaI:_,MtxXYZ2RGB:b,RefWhiteRGB:w,Xn:c,Yn:D,Zn:U}=Ul,J=c*h.m00+D*h.m10+U*h.m20,W=c*h.m01+D*h.m11+U*h.m21,q=c*h.m02+D*h.m12+U*h.m22,Ee=w.X*h.m00+w.Y*h.m10+w.Z*h.m20,ze=w.X*h.m01+w.Y*h.m11+w.Z*h.m21,Ne=w.X*h.m02+w.Y*h.m12+w.Z*h.m22,Be=(e*h.m00+r*h.m10+o*h.m20)*(Ee/J),se=(e*h.m01+r*h.m11+o*h.m21)*(ze/W),ue=(e*h.m02+r*h.m12+o*h.m22)*(Ne/q),he=Be*_.m00+se*_.m10+ue*_.m20,De=Be*_.m01+se*_.m11+ue*_.m21,Ze=Be*_.m02+se*_.m12+ue*_.m22,je=tv(he*b.m00+De*b.m10+Ze*b.m20),ve=tv(he*b.m01+De*b.m11+Ze*b.m21),ee=tv(he*b.m02+De*b.m12+Ze*b.m22);return[je*255,ve*255,ee*255]},ww=(...e)=>{const[r,o,h,..._]=xn(e,"rgb"),[b,w,c]=M5(r,o,h),[D,U,J]=Sk(b,w,c);return[D,U,J,..._.length>0&&_[0]<1?[_[0]]:[]]};function Sk(e,r,o){const{Xn:h,Yn:_,Zn:b,kE:w,kK:c}=Ul,D=e/h,U=r/_,J=o/b,W=D>w?Math.pow(D,1/3):(c*D+16)/116,q=U>w?Math.pow(U,1/3):(c*U+16)/116,Ee=J>w?Math.pow(J,1/3):(c*J+16)/116;return[116*q-16,500*(W-q),200*(q-Ee)]}function nv(e){const r=Math.sign(e);return e=Math.abs(e),(e<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4))*r}const M5=(e,r,o)=>{e=nv(e/255),r=nv(r/255),o=nv(o/255);const{MtxRGB2XYZ:h,MtxAdaptMa:_,MtxAdaptMaI:b,Xn:w,Yn:c,Zn:D,As:U,Bs:J,Cs:W}=Ul;let q=e*h.m00+r*h.m10+o*h.m20,Ee=e*h.m01+r*h.m11+o*h.m21,ze=e*h.m02+r*h.m12+o*h.m22;const Ne=w*_.m00+c*_.m10+D*_.m20,Be=w*_.m01+c*_.m11+D*_.m21,se=w*_.m02+c*_.m12+D*_.m22;let ue=q*_.m00+Ee*_.m10+ze*_.m20,he=q*_.m01+Ee*_.m11+ze*_.m21,De=q*_.m02+Ee*_.m12+ze*_.m22;return ue*=Ne/U,he*=Be/J,De*=se/W,q=ue*b.m00+he*b.m10+De*b.m20,Ee=ue*b.m01+he*b.m11+De*b.m21,ze=ue*b.m02+he*b.m12+De*b.m22,[q,Ee,ze]};ct.prototype.lab=function(){return ww(this._rgb)};const Tk=(...e)=>new ct(...e,"lab");Object.assign(Bn,{lab:Tk,getLabWhitePoint:Hm,setLabWhitePoint:Pu});vn.format.lab=xw;vn.autodetect.push({p:2,test:(...e)=>{if(e=xn(e,"lab"),Dn(e)==="array"&&e.length===3)return"lab"}});ct.prototype.darken=function(e=1){const r=this,o=r.lab();return o[0]-=Ul.Kn*e,new ct(o,"lab").alpha(r.alpha(),!0)};ct.prototype.brighten=function(e=1){return this.darken(-e)};ct.prototype.darker=ct.prototype.darken;ct.prototype.brighter=ct.prototype.brighten;ct.prototype.get=function(e){const[r,o]=e.split("."),h=this[r]();if(o){const _=r.indexOf(o)-(r.substr(0,2)==="ok"?2:0);if(_>-1)return h[_];throw new Error(`unknown channel ${o} in mode ${r}`)}else return h};const{pow:Ek}=Math,Ck=1e-7,Ik=20;ct.prototype.luminance=function(e,r="rgb"){if(e!==void 0&&Dn(e)==="number"){if(e===0)return new ct([0,0,0,this._rgb[3]],"rgb");if(e===1)return new ct([255,255,255,this._rgb[3]],"rgb");let o=this.luminance(),h=Ik;const _=(w,c)=>{const D=w.interpolate(c,.5,r),U=D.luminance();return Math.abs(e-U)<Ck||!h--?D:U>e?_(w,D):_(D,c)},b=(o>e?_(new ct([0,0,0]),this):_(this,new ct([255,255,255]))).rgb();return new ct([...b,this._rgb[3]])}return kk(...this._rgb.slice(0,3))};const kk=(e,r,o)=>(e=rv(e),r=rv(r),o=rv(o),.2126*e+.7152*r+.0722*o),rv=e=>(e/=255,e<=.03928?e/12.92:Ek((e+.055)/1.055,2.4)),zs={},Hf=(e,r,o=.5,...h)=>{let _=h[0]||"lrgb";if(!zs[_]&&!h.length&&(_=Object.keys(zs)[0]),!zs[_])throw new Error(`interpolation mode ${_} is not defined`);return Dn(e)!=="object"&&(e=new ct(e)),Dn(r)!=="object"&&(r=new ct(r)),zs[_](e,r,o).alpha(e.alpha()+o*(r.alpha()-e.alpha()))};ct.prototype.mix=ct.prototype.interpolate=function(e,r=.5,...o){return Hf(this,e,r,...o)};ct.prototype.premultiply=function(e=!1){const r=this._rgb,o=r[3];return e?(this._rgb=[r[0]*o,r[1]*o,r[2]*o,o],this):new ct([r[0]*o,r[1]*o,r[2]*o,o],"rgb")};const{sin:Pk,cos:Ak}=Math,z5=(...e)=>{let[r,o,h]=xn(e,"lch");return isNaN(h)&&(h=0),h=h*gk,[r,Ak(h)*o,Pk(h)*o]},bw=(...e)=>{e=xn(e,"lch");const[r,o,h]=e,[_,b,w]=z5(r,o,h),[c,D,U]=xw(_,b,w);return[c,D,U,e.length>3?e[3]:1]},Mk=(...e)=>{const r=I5(xn(e,"hcl"));return bw(...r)},{sqrt:zk,atan2:Dk,round:Rk}=Math,D5=(...e)=>{const[r,o,h]=xn(e,"lab"),_=zk(o*o+h*h);let b=(Dk(h,o)*_k+360)%360;return Rk(_*1e4)===0&&(b=Number.NaN),[r,_,b]},Sw=(...e)=>{const[r,o,h,..._]=xn(e,"rgb"),[b,w,c]=ww(r,o,h),[D,U,J]=D5(b,w,c);return[D,U,J,..._.length>0&&_[0]<1?[_[0]]:[]]};ct.prototype.lch=function(){return Sw(this._rgb)};ct.prototype.hcl=function(){return I5(Sw(this._rgb))};const Lk=(...e)=>new ct(...e,"lch"),Ok=(...e)=>new ct(...e,"hcl");Object.assign(Bn,{lch:Lk,hcl:Ok});vn.format.lch=bw;vn.format.hcl=Mk;["lch","hcl"].forEach(e=>vn.autodetect.push({p:2,test:(...r)=>{if(r=xn(r,e),Dn(r)==="array"&&r.length===3)return e}}));ct.prototype.saturate=function(e=1){const r=this,o=r.lch();return o[1]+=Ul.Kn*e,o[1]<0&&(o[1]=0),new ct(o,"lch").alpha(r.alpha(),!0)};ct.prototype.desaturate=function(e=1){return this.saturate(-e)};ct.prototype.set=function(e,r,o=!1){const[h,_]=e.split("."),b=this[h]();if(_){const w=h.indexOf(_)-(h.substr(0,2)==="ok"?2:0);if(w>-1){if(Dn(r)=="string")switch(r.charAt(0)){case"+":b[w]+=+r;break;case"-":b[w]+=+r;break;case"*":b[w]*=+r.substr(1);break;case"/":b[w]/=+r.substr(1);break;default:b[w]=+r}else if(Dn(r)==="number")b[w]=r;else throw new Error("unsupported value for Color.set");const c=new ct(b,h);return o?(this._rgb=c._rgb,this):c}throw new Error(`unknown channel ${_} in mode ${h}`)}else return b};ct.prototype.tint=function(e=.5,...r){return Hf(this,"white",e,...r)};ct.prototype.shade=function(e=.5,...r){return Hf(this,"black",e,...r)};const Fk=(e,r,o)=>{const h=e._rgb,_=r._rgb;return new ct(h[0]+o*(_[0]-h[0]),h[1]+o*(_[1]-h[1]),h[2]+o*(_[2]-h[2]),"rgb")};zs.rgb=Fk;const{sqrt:iv,pow:gf}=Math,Bk=(e,r,o)=>{const[h,_,b]=e._rgb,[w,c,D]=r._rgb;return new ct(iv(gf(h,2)*(1-o)+gf(w,2)*o),iv(gf(_,2)*(1-o)+gf(c,2)*o),iv(gf(b,2)*(1-o)+gf(D,2)*o),"rgb")};zs.lrgb=Bk;const Nk=(e,r,o)=>{const h=e.lab(),_=r.lab();return new ct(h[0]+o*(_[0]-h[0]),h[1]+o*(_[1]-h[1]),h[2]+o*(_[2]-h[2]),"lab")};zs.lab=Nk;const tp=(e,r,o,h)=>{let _,b;h==="hsl"?(_=e.hsl(),b=r.hsl()):h==="hsv"?(_=e.hsv(),b=r.hsv()):h==="hcg"?(_=e.hcg(),b=r.hcg()):h==="hsi"?(_=e.hsi(),b=r.hsi()):h==="lch"||h==="hcl"?(h="hcl",_=e.hcl(),b=r.hcl()):h==="oklch"&&(_=e.oklch().reverse(),b=r.oklch().reverse());let w,c,D,U,J,W;(h.substr(0,1)==="h"||h==="oklch")&&([w,D,J]=_,[c,U,W]=b);let q,Ee,ze,Ne;return!isNaN(w)&&!isNaN(c)?(c>w&&c-w>180?Ne=c-(w+360):c<w&&w-c>180?Ne=c+360-w:Ne=c-w,Ee=w+o*Ne):isNaN(w)?isNaN(c)?Ee=Number.NaN:(Ee=c,(J==1||J==0)&&h!="hsv"&&(q=U)):(Ee=w,(W==1||W==0)&&h!="hsv"&&(q=D)),q===void 0&&(q=D+o*(U-D)),ze=J+o*(W-J),h==="oklch"?new ct([ze,q,Ee],h):new ct([Ee,q,ze],h)},R5=(e,r,o)=>tp(e,r,o,"lch");zs.lch=R5;zs.hcl=R5;const Uk=e=>{if(Dn(e)=="number"&&e>=0&&e<=16777215){const r=e>>16,o=e>>8&255,h=e&255;return[r,o,h,1]}throw new Error("unknown num color: "+e)},jk=(...e)=>{const[r,o,h]=xn(e,"rgb");return(r<<16)+(o<<8)+h};ct.prototype.num=function(){return jk(this._rgb)};const $k=(...e)=>new ct(...e,"num");Object.assign(Bn,{num:$k});vn.format.num=Uk;vn.autodetect.push({p:5,test:(...e)=>{if(e.length===1&&Dn(e[0])==="number"&&e[0]>=0&&e[0]<=16777215)return"num"}});const Vk=(e,r,o)=>{const h=e.num(),_=r.num();return new ct(h+o*(_-h),"num")};zs.num=Vk;const{floor:qk}=Math,Zk=(...e)=>{e=xn(e,"hcg");let[r,o,h]=e,_,b,w;h=h*255;const c=o*255;if(o===0)_=b=w=h;else{r===360&&(r=0),r>360&&(r-=360),r<0&&(r+=360),r/=60;const D=qk(r),U=r-D,J=h*(1-o),W=J+c*(1-U),q=J+c*U,Ee=J+c;switch(D){case 0:[_,b,w]=[Ee,q,J];break;case 1:[_,b,w]=[W,Ee,J];break;case 2:[_,b,w]=[J,Ee,q];break;case 3:[_,b,w]=[J,W,Ee];break;case 4:[_,b,w]=[q,J,Ee];break;case 5:[_,b,w]=[Ee,J,W];break}}return[_,b,w,e.length>3?e[3]:1]},Gk=(...e)=>{const[r,o,h]=xn(e,"rgb"),_=E5(r,o,h),b=C5(r,o,h),w=b-_,c=w*100/255,D=_/(255-w)*100;let U;return w===0?U=Number.NaN:(r===b&&(U=(o-h)/w),o===b&&(U=2+(h-r)/w),h===b&&(U=4+(r-o)/w),U*=60,U<0&&(U+=360)),[U,c,D]};ct.prototype.hcg=function(){return Gk(this._rgb)};const Wk=(...e)=>new ct(...e,"hcg");Bn.hcg=Wk;vn.format.hcg=Zk;vn.autodetect.push({p:1,test:(...e)=>{if(e=xn(e,"hcg"),Dn(e)==="array"&&e.length===3)return"hcg"}});const Hk=(e,r,o)=>tp(e,r,o,"hcg");zs.hcg=Hk;const{cos:_f}=Math,Xk=(...e)=>{e=xn(e,"hsi");let[r,o,h]=e,_,b,w;return isNaN(r)&&(r=0),isNaN(o)&&(o=0),r>360&&(r-=360),r<0&&(r+=360),r/=360,r<1/3?(w=(1-o)/3,_=(1+o*_f(Cu*r)/_f(ev-Cu*r))/3,b=1-(w+_)):r<2/3?(r-=1/3,_=(1-o)/3,b=(1+o*_f(Cu*r)/_f(ev-Cu*r))/3,w=1-(_+b)):(r-=2/3,b=(1-o)/3,w=(1+o*_f(Cu*r)/_f(ev-Cu*r))/3,_=1-(b+w)),_=rd(h*_*3),b=rd(h*b*3),w=rd(h*w*3),[_*255,b*255,w*255,e.length>3?e[3]:1]},{min:Kk,sqrt:Yk,acos:Jk}=Math,Qk=(...e)=>{let[r,o,h]=xn(e,"rgb");r/=255,o/=255,h/=255;let _;const b=Kk(r,o,h),w=(r+o+h)/3,c=w>0?1-b/w:0;return c===0?_=NaN:(_=(r-o+(r-h))/2,_/=Yk((r-o)*(r-o)+(r-h)*(o-h)),_=Jk(_),h>o&&(_=Cu-_),_/=Cu),[_*360,c,w]};ct.prototype.hsi=function(){return Qk(this._rgb)};const eP=(...e)=>new ct(...e,"hsi");Bn.hsi=eP;vn.format.hsi=Xk;vn.autodetect.push({p:2,test:(...e)=>{if(e=xn(e,"hsi"),Dn(e)==="array"&&e.length===3)return"hsi"}});const tP=(e,r,o)=>tp(e,r,o,"hsi");zs.hsi=tP;const mx=(...e)=>{e=xn(e,"hsl");const[r,o,h]=e;let _,b,w;if(o===0)_=b=w=h*255;else{const c=[0,0,0],D=[0,0,0],U=h<.5?h*(1+o):h+o-h*o,J=2*h-U,W=r/360;c[0]=W+1/3,c[1]=W,c[2]=W-1/3;for(let q=0;q<3;q++)c[q]<0&&(c[q]+=1),c[q]>1&&(c[q]-=1),6*c[q]<1?D[q]=J+(U-J)*6*c[q]:2*c[q]<1?D[q]=U:3*c[q]<2?D[q]=J+(U-J)*(2/3-c[q])*6:D[q]=J;[_,b,w]=[D[0]*255,D[1]*255,D[2]*255]}return e.length>3?[_,b,w,e[3]]:[_,b,w,1]},L5=(...e)=>{e=xn(e,"rgba");let[r,o,h]=e;r/=255,o/=255,h/=255;const _=E5(r,o,h),b=C5(r,o,h),w=(b+_)/2;let c,D;return b===_?(c=0,D=Number.NaN):c=w<.5?(b-_)/(b+_):(b-_)/(2-b-_),r==b?D=(o-h)/(b-_):o==b?D=2+(h-r)/(b-_):h==b&&(D=4+(r-o)/(b-_)),D*=60,D<0&&(D+=360),e.length>3&&e[3]!==void 0?[D,c,w,e[3]]:[D,c,w]};ct.prototype.hsl=function(){return L5(this._rgb)};const nP=(...e)=>new ct(...e,"hsl");Bn.hsl=nP;vn.format.hsl=mx;vn.autodetect.push({p:2,test:(...e)=>{if(e=xn(e,"hsl"),Dn(e)==="array"&&e.length===3)return"hsl"}});const rP=(e,r,o)=>tp(e,r,o,"hsl");zs.hsl=rP;const{floor:iP}=Math,sP=(...e)=>{e=xn(e,"hsv");let[r,o,h]=e,_,b,w;if(h*=255,o===0)_=b=w=h;else{r===360&&(r=0),r>360&&(r-=360),r<0&&(r+=360),r/=60;const c=iP(r),D=r-c,U=h*(1-o),J=h*(1-o*D),W=h*(1-o*(1-D));switch(c){case 0:[_,b,w]=[h,W,U];break;case 1:[_,b,w]=[J,h,U];break;case 2:[_,b,w]=[U,h,W];break;case 3:[_,b,w]=[U,J,h];break;case 4:[_,b,w]=[W,U,h];break;case 5:[_,b,w]=[h,U,J];break}}return[_,b,w,e.length>3?e[3]:1]},{min:oP,max:aP}=Math,lP=(...e)=>{e=xn(e,"rgb");let[r,o,h]=e;const _=oP(r,o,h),b=aP(r,o,h),w=b-_;let c,D,U;return U=b/255,b===0?(c=Number.NaN,D=0):(D=w/b,r===b&&(c=(o-h)/w),o===b&&(c=2+(h-r)/w),h===b&&(c=4+(r-o)/w),c*=60,c<0&&(c+=360)),[c,D,U]};ct.prototype.hsv=function(){return lP(this._rgb)};const uP=(...e)=>new ct(...e,"hsv");Bn.hsv=uP;vn.format.hsv=sP;vn.autodetect.push({p:2,test:(...e)=>{if(e=xn(e,"hsv"),Dn(e)==="array"&&e.length===3)return"hsv"}});const cP=(e,r,o)=>tp(e,r,o,"hsv");zs.hsv=cP;function L0(e,r){let o=e.length;Array.isArray(e[0])||(e=[e]),Array.isArray(r[0])||(r=r.map(w=>[w]));let h=r[0].length,_=r[0].map((w,c)=>r.map(D=>D[c])),b=e.map(w=>_.map(c=>Array.isArray(w)?w.reduce((D,U,J)=>D+U*(c[J]||0),0):c.reduce((D,U)=>D+U*w,0)));return o===1&&(b=b[0]),h===1?b.map(w=>w[0]):b}const Tw=(...e)=>{e=xn(e,"lab");const[r,o,h,..._]=e,[b,w,c]=hP([r,o,h]),[D,U,J]=A5(b,w,c);return[D,U,J,..._.length>0&&_[0]<1?[_[0]]:[]]};function hP(e){var r=[[1.2268798758459243,-.5578149944602171,.2813910456659647],[-.0405757452148008,1.112286803280317,-.0717110580655164],[-.0763729366746601,-.4214933324022432,1.5869240198367816]],o=[[1,.3963377773761749,.2158037573099136],[1,-.1055613458156586,-.0638541728258133],[1,-.0894841775298119,-1.2914855480194092]],h=L0(o,e);return L0(r,h.map(_=>_**3))}const Ew=(...e)=>{const[r,o,h,..._]=xn(e,"rgb"),b=M5(r,o,h);return[...dP(b),..._.length>0&&_[0]<1?[_[0]]:[]]};function dP(e){const r=[[.819022437996703,.3619062600528904,-.1288737815209879],[.0329836539323885,.9292868615863434,.0361446663506424],[.0481771893596242,.2642395317527308,.6335478284694309]],o=[[.210454268309314,.7936177747023054,-.0040720430116193],[1.9779985324311684,-2.42859224204858,.450593709617411],[.0259040424655478,.7827717124575296,-.8086757549230774]],h=L0(r,e);return L0(o,h.map(_=>Math.cbrt(_)))}ct.prototype.oklab=function(){return Ew(this._rgb)};const fP=(...e)=>new ct(...e,"oklab");Object.assign(Bn,{oklab:fP});vn.format.oklab=Tw;vn.autodetect.push({p:2,test:(...e)=>{if(e=xn(e,"oklab"),Dn(e)==="array"&&e.length===3)return"oklab"}});const pP=(e,r,o)=>{const h=e.oklab(),_=r.oklab();return new ct(h[0]+o*(_[0]-h[0]),h[1]+o*(_[1]-h[1]),h[2]+o*(_[2]-h[2]),"oklab")};zs.oklab=pP;const mP=(e,r,o)=>tp(e,r,o,"oklch");zs.oklch=mP;const{pow:sv,sqrt:ov,PI:av,cos:i2,sin:s2,atan2:gP}=Math,_P=(e,r="lrgb",o=null)=>{const h=e.length;o||(o=Array.from(new Array(h)).map(()=>1));const _=h/o.reduce(function(W,q){return W+q});if(o.forEach((W,q)=>{o[q]*=_}),e=e.map(W=>new ct(W)),r==="lrgb")return yP(e,o);const b=e.shift(),w=b.get(r),c=[];let D=0,U=0;for(let W=0;W<w.length;W++)if(w[W]=(w[W]||0)*o[0],c.push(isNaN(w[W])?0:o[0]),r.charAt(W)==="h"&&!isNaN(w[W])){const q=w[W]/180*av;D+=i2(q)*o[0],U+=s2(q)*o[0]}let J=b.alpha()*o[0];e.forEach((W,q)=>{const Ee=W.get(r);J+=W.alpha()*o[q+1];for(let ze=0;ze<w.length;ze++)if(!isNaN(Ee[ze]))if(c[ze]+=o[q+1],r.charAt(ze)==="h"){const Ne=Ee[ze]/180*av;D+=i2(Ne)*o[q+1],U+=s2(Ne)*o[q+1]}else w[ze]+=Ee[ze]*o[q+1]});for(let W=0;W<w.length;W++)if(r.charAt(W)==="h"){let q=gP(U/c[W],D/c[W])/av*180;for(;q<0;)q+=360;for(;q>=360;)q-=360;w[W]=q}else w[W]=w[W]/c[W];return J/=h,new ct(w,r).alpha(J>.99999?1:J,!0)},yP=(e,r)=>{const o=e.length,h=[0,0,0,0];for(let _=0;_<e.length;_++){const b=e[_],w=r[_]/o,c=b._rgb;h[0]+=sv(c[0],2)*w,h[1]+=sv(c[1],2)*w,h[2]+=sv(c[2],2)*w,h[3]+=c[3]*w}return h[0]=ov(h[0]),h[1]=ov(h[1]),h[2]=ov(h[2]),h[3]>.9999999&&(h[3]=1),new ct(vw(h))},{pow:vP}=Math;function O0(e){let r="rgb",o=Bn("#ccc"),h=0,_=[0,1],b=[],w=[0,0],c=!1,D=[],U=!1,J=0,W=1,q=!1,Ee={},ze=!0,Ne=1;const Be=function(ve){if(ve=ve||["#fff","#000"],ve&&Dn(ve)==="string"&&Bn.brewer&&Bn.brewer[ve.toLowerCase()]&&(ve=Bn.brewer[ve.toLowerCase()]),Dn(ve)==="array"){ve.length===1&&(ve=[ve[0],ve[0]]),ve=ve.slice(0);for(let ee=0;ee<ve.length;ee++)ve[ee]=Bn(ve[ee]);b.length=0;for(let ee=0;ee<ve.length;ee++)b.push(ee/(ve.length-1))}return Ze(),D=ve},se=function(ve){if(c!=null){const ee=c.length-1;let de=0;for(;de<ee&&ve>=c[de];)de++;return de-1}return 0};let ue=ve=>ve,he=ve=>ve;const De=function(ve,ee){let de,Te;if(ee==null&&(ee=!1),isNaN(ve)||ve===null)return o;ee?Te=ve:c&&c.length>2?Te=se(ve)/(c.length-2):W!==J?Te=(ve-J)/(W-J):Te=1,Te=he(Te),ee||(Te=ue(Te)),Ne!==1&&(Te=vP(Te,Ne)),Te=w[0]+Te*(1-w[0]-w[1]),Te=rd(Te,0,1);const Ue=Math.floor(Te*1e4);if(ze&&Ee[Ue])de=Ee[Ue];else{if(Dn(D)==="array")for(let Xe=0;Xe<b.length;Xe++){const mt=b[Xe];if(Te<=mt){de=D[Xe];break}if(Te>=mt&&Xe===b.length-1){de=D[Xe];break}if(Te>mt&&Te<b[Xe+1]){Te=(Te-mt)/(b[Xe+1]-mt),de=Bn.interpolate(D[Xe],D[Xe+1],Te,r);break}}else Dn(D)==="function"&&(de=D(Te));ze&&(Ee[Ue]=de)}return de};var Ze=()=>Ee={};Be(e);const je=function(ve){const ee=Bn(De(ve));return U&&ee[U]?ee[U]():ee};return je.classes=function(ve){if(ve!=null){if(Dn(ve)==="array")c=ve,_=[ve[0],ve[ve.length-1]];else{const ee=Bn.analyze(_);ve===0?c=[ee.min,ee.max]:c=Bn.limits(ee,"e",ve)}return je}return c},je.domain=function(ve){if(!arguments.length)return _;J=ve[0],W=ve[ve.length-1],b=[];const ee=D.length;if(ve.length===ee&&J!==W)for(let de of Array.from(ve))b.push((de-J)/(W-J));else{for(let de=0;de<ee;de++)b.push(de/(ee-1));if(ve.length>2){const de=ve.map((Ue,Xe)=>Xe/(ve.length-1)),Te=ve.map(Ue=>(Ue-J)/(W-J));Te.every((Ue,Xe)=>de[Xe]===Ue)||(he=Ue=>{if(Ue<=0||Ue>=1)return Ue;let Xe=0;for(;Ue>=Te[Xe+1];)Xe++;const mt=(Ue-Te[Xe])/(Te[Xe+1]-Te[Xe]);return de[Xe]+mt*(de[Xe+1]-de[Xe])})}}return _=[J,W],je},je.mode=function(ve){return arguments.length?(r=ve,Ze(),je):r},je.range=function(ve,ee){return Be(ve),je},je.out=function(ve){return U=ve,je},je.spread=function(ve){return arguments.length?(h=ve,je):h},je.correctLightness=function(ve){return ve==null&&(ve=!0),q=ve,Ze(),q?ue=function(ee){const de=De(0,!0).lab()[0],Te=De(1,!0).lab()[0],Ue=de>Te;let Xe=De(ee,!0).lab()[0];const mt=de+(Te-de)*ee;let Kt=Xe-mt,qn=0,Qn=1,zt=20;for(;Math.abs(Kt)>.01&&zt-- >0;)(function(){return Ue&&(Kt*=-1),Kt<0?(qn=ee,ee+=(Qn-ee)*.5):(Qn=ee,ee+=(qn-ee)*.5),Xe=De(ee,!0).lab()[0],Kt=Xe-mt})();return ee}:ue=ee=>ee,je},je.padding=function(ve){return ve!=null?(Dn(ve)==="number"&&(ve=[ve,ve]),w=ve,je):w},je.colors=function(ve,ee){arguments.length<2&&(ee="hex");let de=[];if(arguments.length===0)de=D.slice(0);else if(ve===1)de=[je(.5)];else if(ve>1){const Te=_[0],Ue=_[1]-Te;de=xP(0,ve).map(Xe=>je(Te+Xe/(ve-1)*Ue))}else{e=[];let Te=[];if(c&&c.length>2)for(let Ue=1,Xe=c.length,mt=1<=Xe;mt?Ue<Xe:Ue>Xe;mt?Ue++:Ue--)Te.push((c[Ue-1]+c[Ue])*.5);else Te=_;de=Te.map(Ue=>je(Ue))}return Bn[ee]&&(de=de.map(Te=>Te[ee]())),de},je.cache=function(ve){return ve!=null?(ze=ve,je):ze},je.gamma=function(ve){return ve!=null?(Ne=ve,je):Ne},je.nodata=function(ve){return ve!=null?(o=Bn(ve),je):o},je}function xP(e,r,o){let h=[],_=e<r,b=r;for(let w=e;_?w<b:w>b;_?w++:w--)h.push(w);return h}const wP=function(e){let r=[1,1];for(let o=1;o<e;o++){let h=[1];for(let _=1;_<=r.length;_++)h[_]=(r[_]||0)+r[_-1];r=h}return r},bP=function(e){let r,o,h,_;if(e=e.map(b=>new ct(b)),e.length===2)[o,h]=e.map(b=>b.lab()),r=function(b){const w=[0,1,2].map(c=>o[c]+b*(h[c]-o[c]));return new ct(w,"lab")};else if(e.length===3)[o,h,_]=e.map(b=>b.lab()),r=function(b){const w=[0,1,2].map(c=>(1-b)*(1-b)*o[c]+2*(1-b)*b*h[c]+b*b*_[c]);return new ct(w,"lab")};else if(e.length===4){let b;[o,h,_,b]=e.map(w=>w.lab()),r=function(w){const c=[0,1,2].map(D=>(1-w)*(1-w)*(1-w)*o[D]+3*(1-w)*(1-w)*w*h[D]+3*(1-w)*w*w*_[D]+w*w*w*b[D]);return new ct(c,"lab")}}else if(e.length>=5){let b,w,c;b=e.map(D=>D.lab()),c=e.length-1,w=wP(c),r=function(D){const U=1-D,J=[0,1,2].map(W=>b.reduce((q,Ee,ze)=>q+w[ze]*U**(c-ze)*D**ze*Ee[W],0));return new ct(J,"lab")}}else throw new RangeError("No point in running bezier with only one color.");return r},SP=e=>{const r=bP(e);return r.scale=()=>O0(r),r},{round:O5}=Math;ct.prototype.rgb=function(e=!0){return e===!1?this._rgb.slice(0,3):this._rgb.slice(0,3).map(O5)};ct.prototype.rgba=function(e=!0){return this._rgb.slice(0,4).map((r,o)=>o<3?e===!1?r:O5(r):r)};const TP=(...e)=>new ct(...e,"rgb");Object.assign(Bn,{rgb:TP});vn.format.rgb=(...e)=>{const r=xn(e,"rgba");return r[3]===void 0&&(r[3]=1),r};vn.autodetect.push({p:3,test:(...e)=>{if(e=xn(e,"rgba"),Dn(e)==="array"&&(e.length===3||e.length===4&&Dn(e[3])=="number"&&e[3]>=0&&e[3]<=1))return"rgb"}});const Qa=(e,r,o)=>{if(!Qa[o])throw new Error("unknown blend mode "+o);return Qa[o](e,r)},Gc=e=>(r,o)=>{const h=Bn(o).rgb(),_=Bn(r).rgb();return Bn.rgb(e(h,_))},Wc=e=>(r,o)=>{const h=[];return h[0]=e(r[0],o[0]),h[1]=e(r[1],o[1]),h[2]=e(r[2],o[2]),h},EP=e=>e,CP=(e,r)=>e*r/255,IP=(e,r)=>e>r?r:e,kP=(e,r)=>e>r?e:r,PP=(e,r)=>255*(1-(1-e/255)*(1-r/255)),AP=(e,r)=>r<128?2*e*r/255:255*(1-2*(1-e/255)*(1-r/255)),MP=(e,r)=>255*(1-(1-r/255)/(e/255)),zP=(e,r)=>e===255?255:(e=255*(r/255)/(1-e/255),e>255?255:e);Qa.normal=Gc(Wc(EP));Qa.multiply=Gc(Wc(CP));Qa.screen=Gc(Wc(PP));Qa.overlay=Gc(Wc(AP));Qa.darken=Gc(Wc(IP));Qa.lighten=Gc(Wc(kP));Qa.dodge=Gc(Wc(zP));Qa.burn=Gc(Wc(MP));const{pow:DP,sin:RP,cos:LP}=Math;function OP(e=300,r=-1.5,o=1,h=1,_=[0,1]){let b=0,w;Dn(_)==="array"?w=_[1]-_[0]:(w=0,_=[_,_]);const c=function(D){const U=Cu*((e+120)/360+r*D),J=DP(_[0]+w*D,h),q=(b!==0?o[0]+D*b:o)*J*(1-J)/2,Ee=LP(U),ze=RP(U),Ne=J+q*(-.14861*Ee+1.78277*ze),Be=J+q*(-.29227*Ee-.90649*ze),se=J+q*(1.97294*Ee);return Bn(vw([Ne*255,Be*255,se*255,1]))};return c.start=function(D){return D==null?e:(e=D,c)},c.rotations=function(D){return D==null?r:(r=D,c)},c.gamma=function(D){return D==null?h:(h=D,c)},c.hue=function(D){return D==null?o:(o=D,Dn(o)==="array"?(b=o[1]-o[0],b===0&&(o=o[1])):b=0,c)},c.lightness=function(D){return D==null?_:(Dn(D)==="array"?(_=D,w=D[1]-D[0]):(_=[D,D],w=0),c)},c.scale=()=>Bn.scale(c),c.hue(o),c}const FP="0123456789abcdef",{floor:BP,random:NP}=Math,UP=()=>{let e="#";for(let r=0;r<6;r++)e+=FP.charAt(BP(NP()*16));return new ct(e,"hex")},{log:o2,pow:jP,floor:$P,abs:VP}=Math;function F5(e,r=null){const o={min:Number.MAX_VALUE,max:Number.MAX_VALUE*-1,sum:0,values:[],count:0};return Dn(e)==="object"&&(e=Object.values(e)),e.forEach(h=>{r&&Dn(h)==="object"&&(h=h[r]),h!=null&&!isNaN(h)&&(o.values.push(h),o.sum+=h,h<o.min&&(o.min=h),h>o.max&&(o.max=h),o.count+=1)}),o.domain=[o.min,o.max],o.limits=(h,_)=>B5(o,h,_),o}function B5(e,r="equal",o=7){Dn(e)=="array"&&(e=F5(e));const{min:h,max:_}=e,b=e.values.sort((c,D)=>c-D);if(o===1)return[h,_];const w=[];if(r.substr(0,1)==="c"&&(w.push(h),w.push(_)),r.substr(0,1)==="e"){w.push(h);for(let c=1;c<o;c++)w.push(h+c/o*(_-h));w.push(_)}else if(r.substr(0,1)==="l"){if(h<=0)throw new Error("Logarithmic scales are only possible for values > 0");const c=Math.LOG10E*o2(h),D=Math.LOG10E*o2(_);w.push(h);for(let U=1;U<o;U++)w.push(jP(10,c+U/o*(D-c)));w.push(_)}else if(r.substr(0,1)==="q"){w.push(h);for(let c=1;c<o;c++){const D=(b.length-1)*c/o,U=$P(D);if(U===D)w.push(b[U]);else{const J=D-U;w.push(b[U]*(1-J)+b[U+1]*J)}}w.push(_)}else if(r.substr(0,1)==="k"){let c;const D=b.length,U=new Array(D),J=new Array(o);let W=!0,q=0,Ee=null;Ee=[],Ee.push(h);for(let Be=1;Be<o;Be++)Ee.push(h+Be/o*(_-h));for(Ee.push(_);W;){for(let se=0;se<o;se++)J[se]=0;for(let se=0;se<D;se++){const ue=b[se];let he=Number.MAX_VALUE,De;for(let Ze=0;Ze<o;Ze++){const je=VP(Ee[Ze]-ue);je<he&&(he=je,De=Ze),J[De]++,U[se]=De}}const Be=new Array(o);for(let se=0;se<o;se++)Be[se]=null;for(let se=0;se<D;se++)c=U[se],Be[c]===null?Be[c]=b[se]:Be[c]+=b[se];for(let se=0;se<o;se++)Be[se]*=1/J[se];W=!1;for(let se=0;se<o;se++)if(Be[se]!==Ee[se]){W=!0;break}Ee=Be,q++,q>200&&(W=!1)}const ze={};for(let Be=0;Be<o;Be++)ze[Be]=[];for(let Be=0;Be<D;Be++)c=U[Be],ze[c].push(b[Be]);let Ne=[];for(let Be=0;Be<o;Be++)Ne.push(ze[Be][0]),Ne.push(ze[Be][ze[Be].length-1]);Ne=Ne.sort((Be,se)=>Be-se),w.push(Ne[0]);for(let Be=1;Be<Ne.length;Be+=2){const se=Ne[Be];!isNaN(se)&&w.indexOf(se)===-1&&w.push(se)}}return w}const qP=(e,r)=>{e=new ct(e),r=new ct(r);const o=e.luminance(),h=r.luminance();return o>h?(o+.05)/(h+.05):(h+.05)/(o+.05)};/**
 * @license
 *
 * The APCA contrast prediction algorithm is based of the formulas published
 * in the APCA-1.0.98G specification by Myndex. The specification is available at:
 * https://raw.githubusercontent.com/Myndex/apca-w3/master/images/APCAw3_0.1.17_APCA0.0.98G.svg
 *
 * Note that the APCA implementation is still beta, so please update to
 * future versions of chroma.js when they become available.
 *
 * You can read more about the APCA Readability Criterion at
 * https://readtech.org/ARC/
 */const a2=.027,ZP=5e-4,GP=.1,l2=1.14,B_=.022,u2=1.414,WP=(e,r)=>{e=new ct(e),r=new ct(r),e.alpha()<1&&(e=Hf(r,e,e.alpha(),"rgb"));const o=c2(...e.rgb()),h=c2(...r.rgb()),_=o>=B_?o:o+Math.pow(B_-o,u2),b=h>=B_?h:h+Math.pow(B_-h,u2),w=Math.pow(b,.56)-Math.pow(_,.57),c=Math.pow(b,.65)-Math.pow(_,.62),D=Math.abs(b-_)<ZP?0:_<b?w*l2:c*l2;return(Math.abs(D)<GP?0:D>0?D-a2:D+a2)*100};function c2(e,r,o){return .2126729*Math.pow(e/255,2.4)+.7151522*Math.pow(r/255,2.4)+.072175*Math.pow(o/255,2.4)}const{sqrt:Su,pow:bi,min:HP,max:XP,atan2:h2,abs:d2,cos:N_,sin:f2,exp:KP,PI:p2}=Math;function YP(e,r,o=1,h=1,_=1){var b=function(St){return 360*St/(2*p2)},w=function(St){return 2*p2*St/360};e=new ct(e),r=new ct(r);const[c,D,U]=Array.from(e.lab()),[J,W,q]=Array.from(r.lab()),Ee=(c+J)/2,ze=Su(bi(D,2)+bi(U,2)),Ne=Su(bi(W,2)+bi(q,2)),Be=(ze+Ne)/2,se=.5*(1-Su(bi(Be,7)/(bi(Be,7)+bi(25,7)))),ue=D*(1+se),he=W*(1+se),De=Su(bi(ue,2)+bi(U,2)),Ze=Su(bi(he,2)+bi(q,2)),je=(De+Ze)/2,ve=b(h2(U,ue)),ee=b(h2(q,he)),de=ve>=0?ve:ve+360,Te=ee>=0?ee:ee+360,Ue=d2(de-Te)>180?(de+Te+360)/2:(de+Te)/2,Xe=1-.17*N_(w(Ue-30))+.24*N_(w(2*Ue))+.32*N_(w(3*Ue+6))-.2*N_(w(4*Ue-63));let mt=Te-de;mt=d2(mt)<=180?mt:Te<=de?mt+360:mt-360,mt=2*Su(De*Ze)*f2(w(mt)/2);const Kt=J-c,qn=Ze-De,Qn=1+.015*bi(Ee-50,2)/Su(20+bi(Ee-50,2)),zt=1+.045*je,Je=1+.015*je*Xe,rt=30*KP(-bi((Ue-275)/25,2)),ht=-(2*Su(bi(je,7)/(bi(je,7)+bi(25,7))))*f2(2*w(rt)),It=Su(bi(Kt/(o*Qn),2)+bi(qn/(h*zt),2)+bi(mt/(_*Je),2)+ht*(qn/(h*zt))*(mt/(_*Je)));return XP(0,HP(100,It))}function JP(e,r,o="lab"){e=new ct(e),r=new ct(r);const h=e.get(o),_=r.get(o);let b=0;for(let w in h){const c=(h[w]||0)-(_[w]||0);b+=c*c}return Math.sqrt(b)}const QP=(...e)=>{try{return new ct(...e),!0}catch{return!1}},eA={cool(){return O0([Bn.hsl(180,1,.9),Bn.hsl(250,.7,.4)])},hot(){return O0(["#000","#f00","#ff0","#fff"]).mode("rgb")}},gx={OrRd:["#fff7ec","#fee8c8","#fdd49e","#fdbb84","#fc8d59","#ef6548","#d7301f","#b30000","#7f0000"],PuBu:["#fff7fb","#ece7f2","#d0d1e6","#a6bddb","#74a9cf","#3690c0","#0570b0","#045a8d","#023858"],BuPu:["#f7fcfd","#e0ecf4","#bfd3e6","#9ebcda","#8c96c6","#8c6bb1","#88419d","#810f7c","#4d004b"],Oranges:["#fff5eb","#fee6ce","#fdd0a2","#fdae6b","#fd8d3c","#f16913","#d94801","#a63603","#7f2704"],BuGn:["#f7fcfd","#e5f5f9","#ccece6","#99d8c9","#66c2a4","#41ae76","#238b45","#006d2c","#00441b"],YlOrBr:["#ffffe5","#fff7bc","#fee391","#fec44f","#fe9929","#ec7014","#cc4c02","#993404","#662506"],YlGn:["#ffffe5","#f7fcb9","#d9f0a3","#addd8e","#78c679","#41ab5d","#238443","#006837","#004529"],Reds:["#fff5f0","#fee0d2","#fcbba1","#fc9272","#fb6a4a","#ef3b2c","#cb181d","#a50f15","#67000d"],RdPu:["#fff7f3","#fde0dd","#fcc5c0","#fa9fb5","#f768a1","#dd3497","#ae017e","#7a0177","#49006a"],Greens:["#f7fcf5","#e5f5e0","#c7e9c0","#a1d99b","#74c476","#41ab5d","#238b45","#006d2c","#00441b"],YlGnBu:["#ffffd9","#edf8b1","#c7e9b4","#7fcdbb","#41b6c4","#1d91c0","#225ea8","#253494","#081d58"],Purples:["#fcfbfd","#efedf5","#dadaeb","#bcbddc","#9e9ac8","#807dba","#6a51a3","#54278f","#3f007d"],GnBu:["#f7fcf0","#e0f3db","#ccebc5","#a8ddb5","#7bccc4","#4eb3d3","#2b8cbe","#0868ac","#084081"],Greys:["#ffffff","#f0f0f0","#d9d9d9","#bdbdbd","#969696","#737373","#525252","#252525","#000000"],YlOrRd:["#ffffcc","#ffeda0","#fed976","#feb24c","#fd8d3c","#fc4e2a","#e31a1c","#bd0026","#800026"],PuRd:["#f7f4f9","#e7e1ef","#d4b9da","#c994c7","#df65b0","#e7298a","#ce1256","#980043","#67001f"],Blues:["#f7fbff","#deebf7","#c6dbef","#9ecae1","#6baed6","#4292c6","#2171b5","#08519c","#08306b"],PuBuGn:["#fff7fb","#ece2f0","#d0d1e6","#a6bddb","#67a9cf","#3690c0","#02818a","#016c59","#014636"],Viridis:["#440154","#482777","#3f4a8a","#31678e","#26838f","#1f9d8a","#6cce5a","#b6de2b","#fee825"],Spectral:["#9e0142","#d53e4f","#f46d43","#fdae61","#fee08b","#ffffbf","#e6f598","#abdda4","#66c2a5","#3288bd","#5e4fa2"],RdYlGn:["#a50026","#d73027","#f46d43","#fdae61","#fee08b","#ffffbf","#d9ef8b","#a6d96a","#66bd63","#1a9850","#006837"],RdBu:["#67001f","#b2182b","#d6604d","#f4a582","#fddbc7","#f7f7f7","#d1e5f0","#92c5de","#4393c3","#2166ac","#053061"],PiYG:["#8e0152","#c51b7d","#de77ae","#f1b6da","#fde0ef","#f7f7f7","#e6f5d0","#b8e186","#7fbc41","#4d9221","#276419"],PRGn:["#40004b","#762a83","#9970ab","#c2a5cf","#e7d4e8","#f7f7f7","#d9f0d3","#a6dba0","#5aae61","#1b7837","#00441b"],RdYlBu:["#a50026","#d73027","#f46d43","#fdae61","#fee090","#ffffbf","#e0f3f8","#abd9e9","#74add1","#4575b4","#313695"],BrBG:["#543005","#8c510a","#bf812d","#dfc27d","#f6e8c3","#f5f5f5","#c7eae5","#80cdc1","#35978f","#01665e","#003c30"],RdGy:["#67001f","#b2182b","#d6604d","#f4a582","#fddbc7","#ffffff","#e0e0e0","#bababa","#878787","#4d4d4d","#1a1a1a"],PuOr:["#7f3b08","#b35806","#e08214","#fdb863","#fee0b6","#f7f7f7","#d8daeb","#b2abd2","#8073ac","#542788","#2d004b"],Set2:["#66c2a5","#fc8d62","#8da0cb","#e78ac3","#a6d854","#ffd92f","#e5c494","#b3b3b3"],Accent:["#7fc97f","#beaed4","#fdc086","#ffff99","#386cb0","#f0027f","#bf5b17","#666666"],Set1:["#e41a1c","#377eb8","#4daf4a","#984ea3","#ff7f00","#ffff33","#a65628","#f781bf","#999999"],Set3:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462","#b3de69","#fccde5","#d9d9d9","#bc80bd","#ccebc5","#ffed6f"],Dark2:["#1b9e77","#d95f02","#7570b3","#e7298a","#66a61e","#e6ab02","#a6761d","#666666"],Paired:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f","#ff7f00","#cab2d6","#6a3d9a","#ffff99","#b15928"],Pastel2:["#b3e2cd","#fdcdac","#cbd5e8","#f4cae4","#e6f5c9","#fff2ae","#f1e2cc","#cccccc"],Pastel1:["#fbb4ae","#b3cde3","#ccebc5","#decbe4","#fed9a6","#ffffcc","#e5d8bd","#fddaec","#f2f2f2"]},N5=Object.keys(gx),m2=new Map(N5.map(e=>[e.toLowerCase(),e])),tA=typeof Proxy=="function"?new Proxy(gx,{get(e,r){const o=r.toLowerCase();if(m2.has(o))return e[m2.get(o)]},getOwnPropertyNames(){return Object.getOwnPropertyNames(N5)}}):gx,nA=(...e)=>{e=xn(e,"cmyk");const[r,o,h,_]=e,b=e.length>4?e[4]:1;return _===1?[0,0,0,b]:[r>=1?0:255*(1-r)*(1-_),o>=1?0:255*(1-o)*(1-_),h>=1?0:255*(1-h)*(1-_),b]},{max:g2}=Math,rA=(...e)=>{let[r,o,h]=xn(e,"rgb");r=r/255,o=o/255,h=h/255;const _=1-g2(r,g2(o,h)),b=_<1?1/(1-_):0,w=(1-r-_)*b,c=(1-o-_)*b,D=(1-h-_)*b;return[w,c,D,_]};ct.prototype.cmyk=function(){return rA(this._rgb)};const iA=(...e)=>new ct(...e,"cmyk");Object.assign(Bn,{cmyk:iA});vn.format.cmyk=nA;vn.autodetect.push({p:2,test:(...e)=>{if(e=xn(e,"cmyk"),Dn(e)==="array"&&e.length===4)return"cmyk"}});const sA=(...e)=>{const r=xn(e,"hsla");let o=ep(e)||"lsa";return r[0]=ca(r[0]||0)+"deg",r[1]=ca(r[1]*100)+"%",r[2]=ca(r[2]*100)+"%",o==="hsla"||r.length>3&&r[3]<1?(r[3]="/ "+(r.length>3?r[3]:1),o="hsla"):r.length=3,`${o.substr(0,3)}(${r.join(" ")})`},oA=(...e)=>{const r=xn(e,"lab");let o=ep(e)||"lab";return r[0]=ca(r[0])+"%",r[1]=ca(r[1]),r[2]=ca(r[2]),o==="laba"||r.length>3&&r[3]<1?r[3]="/ "+(r.length>3?r[3]:1):r.length=3,`lab(${r.join(" ")})`},aA=(...e)=>{const r=xn(e,"lch");let o=ep(e)||"lab";return r[0]=ca(r[0])+"%",r[1]=ca(r[1]),r[2]=isNaN(r[2])?"none":ca(r[2])+"deg",o==="lcha"||r.length>3&&r[3]<1?r[3]="/ "+(r.length>3?r[3]:1):r.length=3,`lch(${r.join(" ")})`},lA=(...e)=>{const r=xn(e,"lab");return r[0]=ca(r[0]*100)+"%",r[1]=px(r[1]),r[2]=px(r[2]),r.length>3&&r[3]<1?r[3]="/ "+(r.length>3?r[3]:1):r.length=3,`oklab(${r.join(" ")})`},U5=(...e)=>{const[r,o,h,..._]=xn(e,"rgb"),[b,w,c]=Ew(r,o,h),[D,U,J]=D5(b,w,c);return[D,U,J,..._.length>0&&_[0]<1?[_[0]]:[]]},uA=(...e)=>{const r=xn(e,"lch");return r[0]=ca(r[0]*100)+"%",r[1]=px(r[1]),r[2]=isNaN(r[2])?"none":ca(r[2])+"deg",r.length>3&&r[3]<1?r[3]="/ "+(r.length>3?r[3]:1):r.length=3,`oklch(${r.join(" ")})`},{round:lv}=Math,cA=(...e)=>{const r=xn(e,"rgba");let o=ep(e)||"rgb";if(o.substr(0,3)==="hsl")return sA(L5(r),o);if(o.substr(0,3)==="lab"){const h=Hm();Pu("d50");const _=oA(ww(r),o);return Pu(h),_}if(o.substr(0,3)==="lch"){const h=Hm();Pu("d50");const _=aA(Sw(r),o);return Pu(h),_}return o.substr(0,5)==="oklab"?lA(Ew(r)):o.substr(0,5)==="oklch"?uA(U5(r)):(r[0]=lv(r[0]),r[1]=lv(r[1]),r[2]=lv(r[2]),(o==="rgba"||r.length>3&&r[3]<1)&&(r[3]="/ "+(r.length>3?r[3]:1),o="rgba"),`${o.substr(0,3)}(${r.slice(0,o==="rgb"?3:4).join(" ")})`)},j5=(...e)=>{e=xn(e,"lch");const[r,o,h,..._]=e,[b,w,c]=z5(r,o,h),[D,U,J]=Tw(b,w,c);return[D,U,J,..._.length>0&&_[0]<1?[_[0]]:[]]},Mu=/((?:-?\d+)|(?:-?\d+(?:\.\d+)?)%|none)/.source,Ya=/((?:-?(?:\d+(?:\.\d*)?|\.\d+)%?)|none)/.source,F0=/((?:-?(?:\d+(?:\.\d*)?|\.\d+)%)|none)/.source,fa=/\s*/.source,np=/\s+/.source,Cw=/\s*,\s*/.source,oy=/((?:-?(?:\d+(?:\.\d*)?|\.\d+)(?:deg)?)|none)/.source,rp=/\s*(?:\/\s*((?:[01]|[01]?\.\d+)|\d+(?:\.\d+)?%))?/.source,$5=new RegExp("^rgba?\\("+fa+[Mu,Mu,Mu].join(np)+rp+"\\)$"),V5=new RegExp("^rgb\\("+fa+[Mu,Mu,Mu].join(Cw)+fa+"\\)$"),q5=new RegExp("^rgba\\("+fa+[Mu,Mu,Mu,Ya].join(Cw)+fa+"\\)$"),Z5=new RegExp("^hsla?\\("+fa+[oy,F0,F0].join(np)+rp+"\\)$"),G5=new RegExp("^hsl?\\("+fa+[oy,F0,F0].join(Cw)+fa+"\\)$"),W5=/^hsla\(\s*(-?\d+(?:\.\d+)?),\s*(-?\d+(?:\.\d+)?)%\s*,\s*(-?\d+(?:\.\d+)?)%\s*,\s*([01]|[01]?\.\d+)\)$/,H5=new RegExp("^lab\\("+fa+[Ya,Ya,Ya].join(np)+rp+"\\)$"),X5=new RegExp("^lch\\("+fa+[Ya,Ya,oy].join(np)+rp+"\\)$"),K5=new RegExp("^oklab\\("+fa+[Ya,Ya,Ya].join(np)+rp+"\\)$"),Y5=new RegExp("^oklch\\("+fa+[Ya,Ya,oy].join(np)+rp+"\\)$"),{round:J5}=Math,yf=e=>e.map((r,o)=>o<=2?rd(J5(r),0,255):r),Si=(e,r=0,o=100,h=!1)=>(typeof e=="string"&&e.endsWith("%")&&(e=parseFloat(e.substring(0,e.length-1))/100,h?e=r+(e+1)*.5*(o-r):e=r+e*(o-r)),+e),Gs=(e,r)=>e==="none"?r:e,Iw=e=>{if(e=e.toLowerCase().trim(),e==="transparent")return[0,0,0,0];let r;if(vn.format.named)try{return vn.format.named(e)}catch{}if((r=e.match($5))||(r=e.match(V5))){let o=r.slice(1,4);for(let _=0;_<3;_++)o[_]=+Si(Gs(o[_],0),0,255);o=yf(o);const h=r[4]!==void 0?+Si(r[4],0,1):1;return o[3]=h,o}if(r=e.match(q5)){const o=r.slice(1,5);for(let h=0;h<4;h++)o[h]=+Si(o[h],0,255);return o}if((r=e.match(Z5))||(r=e.match(G5))){const o=r.slice(1,4);o[0]=+Gs(o[0].replace("deg",""),0),o[1]=+Si(Gs(o[1],0),0,100)*.01,o[2]=+Si(Gs(o[2],0),0,100)*.01;const h=yf(mx(o)),_=r[4]!==void 0?+Si(r[4],0,1):1;return h[3]=_,h}if(r=e.match(W5)){const o=r.slice(1,4);o[1]*=.01,o[2]*=.01;const h=mx(o);for(let _=0;_<3;_++)h[_]=J5(h[_]);return h[3]=+r[4],h}if(r=e.match(H5)){const o=r.slice(1,4);o[0]=Si(Gs(o[0],0),0,100),o[1]=Si(Gs(o[1],0),-125,125,!0),o[2]=Si(Gs(o[2],0),-125,125,!0);const h=Hm();Pu("d50");const _=yf(xw(o));Pu(h);const b=r[4]!==void 0?+Si(r[4],0,1):1;return _[3]=b,_}if(r=e.match(X5)){const o=r.slice(1,4);o[0]=Si(o[0],0,100),o[1]=Si(Gs(o[1],0),0,150,!1),o[2]=+Gs(o[2].replace("deg",""),0);const h=Hm();Pu("d50");const _=yf(bw(o));Pu(h);const b=r[4]!==void 0?+Si(r[4],0,1):1;return _[3]=b,_}if(r=e.match(K5)){const o=r.slice(1,4);o[0]=Si(Gs(o[0],0),0,1),o[1]=Si(Gs(o[1],0),-.4,.4,!0),o[2]=Si(Gs(o[2],0),-.4,.4,!0);const h=yf(Tw(o)),_=r[4]!==void 0?+Si(r[4],0,1):1;return h[3]=_,h}if(r=e.match(Y5)){const o=r.slice(1,4);o[0]=Si(Gs(o[0],0),0,1),o[1]=Si(Gs(o[1],0),0,.4,!1),o[2]=+Gs(o[2].replace("deg",""),0);const h=yf(j5(o)),_=r[4]!==void 0?+Si(r[4],0,1):1;return h[3]=_,h}};Iw.test=e=>$5.test(e)||Z5.test(e)||H5.test(e)||X5.test(e)||K5.test(e)||Y5.test(e)||V5.test(e)||q5.test(e)||G5.test(e)||W5.test(e)||e==="transparent";ct.prototype.css=function(e){return cA(this._rgb,e)};const hA=(...e)=>new ct(...e,"css");Bn.css=hA;vn.format.css=Iw;vn.autodetect.push({p:5,test:(e,...r)=>{if(!r.length&&Dn(e)==="string"&&Iw.test(e))return"css"}});vn.format.gl=(...e)=>{const r=xn(e,"rgba");return r[0]*=255,r[1]*=255,r[2]*=255,r};const dA=(...e)=>new ct(...e,"gl");Bn.gl=dA;ct.prototype.gl=function(){const e=this._rgb;return[e[0]/255,e[1]/255,e[2]/255,e[3]]};ct.prototype.hex=function(e){return P5(this._rgb,e)};const fA=(...e)=>new ct(...e,"hex");Bn.hex=fA;vn.format.hex=k5;vn.autodetect.push({p:4,test:(e,...r)=>{if(!r.length&&Dn(e)==="string"&&[3,4,5,6,7,8,9].indexOf(e.length)>=0)return"hex"}});const{log:U_}=Math,Q5=e=>{const r=e/100;let o,h,_;return r<66?(o=255,h=r<6?0:-155.25485562709179-.44596950469579133*(h=r-2)+104.49216199393888*U_(h),_=r<20?0:-254.76935184120902+.8274096064007395*(_=r-10)+115.67994401066147*U_(_)):(o=351.97690566805693+.114206453784165*(o=r-55)-40.25366309332127*U_(o),h=325.4494125711974+.07943456536662342*(h=r-50)-28.0852963507957*U_(h),_=255),[o,h,_,1]},{round:pA}=Math,mA=(...e)=>{const r=xn(e,"rgb"),o=r[0],h=r[2];let _=1e3,b=4e4;const w=.4;let c;for(;b-_>w;){c=(b+_)*.5;const D=Q5(c);D[2]/D[0]>=h/o?b=c:_=c}return pA(c)};ct.prototype.temp=ct.prototype.kelvin=ct.prototype.temperature=function(){return mA(this._rgb)};const uv=(...e)=>new ct(...e,"temp");Object.assign(Bn,{temp:uv,kelvin:uv,temperature:uv});vn.format.temp=vn.format.kelvin=vn.format.temperature=Q5;ct.prototype.oklch=function(){return U5(this._rgb)};const gA=(...e)=>new ct(...e,"oklch");Object.assign(Bn,{oklch:gA});vn.format.oklch=j5;vn.autodetect.push({p:2,test:(...e)=>{if(e=xn(e,"oklch"),Dn(e)==="array"&&e.length===3)return"oklch"}});Object.assign(Bn,{analyze:F5,average:_P,bezier:SP,blend:Qa,brewer:tA,Color:ct,colors:Wf,contrast:qP,contrastAPCA:WP,cubehelix:OP,deltaE:YP,distance:JP,input:vn,interpolate:Hf,limits:B5,mix:Hf,random:UP,scale:O0,scales:eA,valid:QP});const eS="#FFFF00",tS="#FF0000",Yh=.6,nS=.5,_A=Bn.scale([eS,tS]),Mf=(e,r)=>{const o=_=>Math.log2(_),h=o(e)/o(r);return _A(h).hex()},yA=()=>{const[e,r]=Rt.useState(null);Rt.useEffect(()=>{(async()=>{const h=await Z4(),_=await W4(),b={};for(const[D,U]of Object.entries(h)){const J=Mf(U,_);b[D]=J}const w={type:"FeatureCollection",features:[]},c=await dw();for(const[D,U]of Object.entries(b)){const J=c.find(W=>W.codeIso3===D);w.features.push({...J.geojson,properties:{color:U}})}r(w)})()},[]);const o=Qf();return Rt.useCallback(()=>e===null?()=>null:o(e,{fillColor:["get","color"],fillOpacity:Yh,strokeOpacity:nS}),[e,o])},vA=()=>{const e=os(_=>_.main.focusedCountry),[r,o]=Rt.useState(null);Rt.useEffect(()=>{if(!e||!ud(e.codeIso3)){o(null);return}(async()=>{const _=await X4(e.codeIso3),b=await Y4(e.codeIso3),w={};for(const[U,J]of Object.entries(_)){const W=Mf(J,b);w[U]=W}const c={type:"FeatureCollection",features:[]},D=await R4(e.codeIso3);for(const[U,J]of Object.entries(w)){const W=D.find(q=>q.stateCode===U);c.features.push({...W.geojson,properties:{color:J}})}o(c)})()},[e]);const h=Qf();return Rt.useCallback(()=>r===null?()=>null:h(r,{fillColor:["get","color"],fillOpacity:Yh,strokeOpacity:nS}),[r,h])},xA="_card_10wbz_1",wA="_title_10wbz_10",bA="_legendContent_10wbz_14",SA="_legendGradient_10wbz_18",TA="_legendGradientFill_10wbz_27",EA="_legendItems_10wbz_31",CA="_legendItem_10wbz_31",IA="_legendItemColor_10wbz_43",kA="_legendItemColorFill_10wbz_52",PA="_etc_10wbz_57",qr={card:xA,title:wA,legendContent:bA,legendGradient:SA,legendGradientFill:TA,legendItems:EA,legendItem:CA,legendItemColor:IA,legendItemColorFill:kA,etc:PA},AA=()=>{const e=os(h=>h.main.focusedCountry),[r,o]=Rt.useState(0);return Rt.useEffect(()=>{(async()=>{if(!e||!ud(e.codeIso3)){const h=await W4();o(h)}else{const h=await Y4(e.codeIso3);o(h)}})()},[e]),Rt.useMemo(()=>{let h="";for(let b=0;b<r;b++){b!==0&&(h+=", ");const w=Mf(b,r);h+=w}return h},[r]),Qe.jsxs(N4,{className:qr.card,children:[Qe.jsx("h2",{className:qr.title,children:"Legend"}),Qe.jsxs("div",{className:qr.legendContent,children:[Qe.jsx("div",{className:qr.legendGradient,style:{},children:Qe.jsx("div",{className:qr.legendGradientFill,style:{background:`linear-gradient(to top, ${R0} 5%, ${eS} 20%, ${tS}) 95%`,opacity:Yh}})}),Qe.jsxs("div",{className:qr.legendItems,children:[Qe.jsxs("div",{className:qr.legendItem,children:[Qe.jsx("div",{className:qr.legendItemColor,children:Qe.jsx("div",{className:qr.legendItemColorFill,style:{opacity:Yh,backgroundColor:Mf(r,r)}})}),Qe.jsxs("div",{className:qr.legendItemText,children:[r," Datasets"]})]}),Qe.jsx("div",{className:qr.etc}),Qe.jsxs("div",{className:qr.legendItem,children:[Qe.jsx("div",{className:qr.legendItemColor,children:Qe.jsx("div",{className:qr.legendItemColorFill,style:{opacity:Yh,backgroundColor:Mf(2,r)}})}),Qe.jsx("div",{className:qr.legendItemText,children:"2 Datasets"})]}),Qe.jsxs("div",{className:qr.legendItem,children:[Qe.jsx("div",{className:qr.legendItemColor,children:Qe.jsx("div",{className:qr.legendItemColorFill,style:{opacity:Yh,backgroundColor:Mf(1,r)}})}),Qe.jsx("div",{className:qr.legendItemText,children:"1 Dataset"})]}),Qe.jsxs("div",{className:qr.legendItem,children:[Qe.jsx("div",{className:qr.legendItemColor,children:Qe.jsx("div",{className:qr.legendItemColorFill,style:{opacity:Yh,backgroundColor:R0}})}),Qe.jsx("div",{className:qr.legendItemText,children:"0 Datasets"})]})]})]})]})},MA="_container_12pwg_1",zA="_triangle_12pwg_13",DA="_content_12pwg_23",RA="_title_12pwg_32",LA="_description_12pwg_40",pm={container:MA,triangle:zA,content:DA,title:RA,description:LA},OA=({x:e,y:r})=>{const[o,h]=Rt.useState(!1),[_,b]=Rt.useState(!1),[w,c]=Rt.useState(null),[D,U]=Rt.useState(null),J=os(Be=>Be.main.focusedCountry),W=ZI();Rt.useEffect(()=>{(async()=>{if(o||_){c(null),U(null);return}const Be=W(e,r),se=Be[0],ue=Be[1],he=await L4(se,ue);if(c(he),J&&he&&J.name===he.name&&J.statesData){const De=await O4(se,ue,J.statesData);U(De)}})()},[J,W,o,_,e,r]);const q=y5();Rt.useEffect(()=>q("movestart",()=>h(!0)),[q]),Rt.useEffect(()=>q("moveend",()=>h(!1)),[q]),Rt.useEffect(()=>q("zoomstart",()=>b(!0)),[q]),Rt.useEffect(()=>q("zoomend",()=>b(!1)),[q]);const[Ee,ze]=Rt.useState(null);Rt.useEffect(()=>{(async()=>{if(w&&D){const Be=await pC(w.codeIso3,D.stateCode);ze({title:`${D.name}, ${w.name}`,descriptions:[`Number of Datasets: ${Be}`,`${fx(w.codeIso3)} Name: ${D.name}`,`${fx(w.codeIso3)} Code: ${D.stateCode}`,`Country Name: ${w.name}`,`Country Code: ${w.codeIso3}`]})}else if(w&&!D){const Be=await fC(w.codeIso3);ze({title:`${w.name}`,descriptions:[`Number of Datasets: ${Be}`,`Country Name: ${w.name}`,`Country Code: ${w.codeIso3}`]})}else ze(null)})()},[w,D]);const Ne=Qf();return Rt.useEffect(()=>{if(D)return Ne(D.geojson,LI);if(w)return Ne(w.geojson,RI)},[w,D,Ne]),Ee===null?null:Qe.jsxs("div",{className:pm.container,style:{top:r,left:e},children:[Qe.jsx("div",{className:pm.triangle}),Qe.jsxs("div",{className:pm.content,children:[Qe.jsx("h3",{className:pm.title,children:Ee.title}),Ee.descriptions.map((Be,se)=>Qe.jsx("p",{className:pm.description,children:Be},se))]})]})};let cv=null;const FA=100,BA=()=>{const[e,r]=Rt.useState(null);return Rt.useEffect(()=>v5(o=>{cv&&clearTimeout(cv),r(null);const h=o.target.closest(`#${yw}`);if(!!h){const{top:b,left:w}=h.getBoundingClientRect(),c=o.clientX-w,D=o.clientY-b;cv=setTimeout(()=>{r(Qe.jsx(OA,{x:c,y:D}))},FA)}}),[]),e},NA="_container_12nek_1",hv={container:NA},UA=()=>{const e=os(c=>c.main.isMapInitialized);FI();const r=Rt.useRef(),o=BI(),[h,_]=Rt.useState({width:window.innerWidth/2,height:window.innerHeight/2}),b=Rt.useCallback(()=>{if(r.current){const{width:c,height:D}=r.current.getBoundingClientRect();_({width:c,height:D}),o()}},[o]);Rt.useEffect(()=>{if(r.current){b();const c=Jf.debounce(b,75,{maxWait:300,leading:!1,trailing:!0}),D=new ResizeObserver(c);return D.observe(r.current),()=>D.disconnect()}},[b]);const w=BA();return Qe.jsxs("div",{className:hv.container,ref:r,children:[Qe.jsx("div",{className:hv.map,id:yw,style:{width:`${h.width}px`,height:`${h.height}px`}}),!e&&Qe.jsx("div",{className:hv.loading,children:"Loading..."}),w]})},jA=()=>{const e=Qf(),r=os(h=>h.main.focusedCountry),o=$A();return Rt.useCallback(()=>{if(r===null)return()=>null;const h=[],_=!!r.statesData;return h.push(e(r.geojson,{fillColor:g5,fillOpacity:_?0:_5,strokeWidth:3})),h.push(o()),()=>h.forEach(b=>b())},[r,o,e])},$A=()=>{const e=Qf(),r=os(o=>o.main.focusedCountry);return Rt.useCallback(()=>{if(!(r!=null&&r.statesData))return()=>null;const o={type:"FeatureCollection",features:r.statesData.map(h=>({...h.geojson,properties:{color:"#ffffff"}}))};return e(o,{fillColor:["get","color"],fillOpacity:0,strokeOpacity:.5})},[r,e])},VA=()=>{const e=Qf(),r=os(o=>o.main.focusedState);return Rt.useCallback(()=>r?e(r.geojson,{fillColor:g5,fillOpacity:_5}):()=>null,[r,e])},qA="_container_zp99p_1",ZA={container:qA},GA=()=>{const e=tg(),r=S5(),o=NI(),h=os(U=>U.main.focusedCountry),_=os(U=>U.main.focusedState);Rt.useEffect(()=>o(async U=>{const J=U.lngLat.lng,W=U.lngLat.lat,q=await L4(J,W);let Ee=null;q&&h&&q.name===h.name&&h.statesData&&(Ee=await O4(J,W,h.statesData)),e(jl.actions.setFocusedCountry(q)),e(jl.actions.setFocusedState(Ee)),Ee?r(Ee):q&&r(q)}),[o,e,r,h]);const b=yA();Rt.useEffect(()=>{if(!h||!ud(h.codeIso3))return b()},[h,_,b]);const w=vA();Rt.useEffect(()=>{if(h&&ud(h.codeIso3))return w()},[h,_,w]);const c=jA();Rt.useEffect(()=>c(),[c]);const D=VA();return Rt.useEffect(()=>D(),[D]),Qe.jsxs("div",{className:ZA.container,children:[Qe.jsx(fk,{}),Qe.jsx(UA,{}),Qe.jsx(AA,{})]})},WA=pI({reducer:{main:jl.reducer}});dv.createRoot(document.getElementById("root")).render(Qe.jsx(Ol.StrictMode,{children:Qe.jsx(NE,{store:WA,children:Qe.jsx(GA,{})})}));
